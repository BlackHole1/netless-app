var be=Object.defineProperty,ye=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var B=(t,e,o)=>e in t?be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,z=(t,e)=>{for(var o in e||(e={}))F.call(e,o)&&B(t,o,e[o]);if(V)for(var o of V(e))Q.call(e,o)&&B(t,o,e[o]);return t},q=(t,e)=>ye(t,ke(e));var G=(t,e)=>{var o={};for(var n in t)F.call(t,n)&&e.indexOf(n)<0&&(o[n]=t[n]);if(t!=null&&V)for(var n of V(t))e.indexOf(n)<0&&Q.call(t,n)&&(o[n]=t[n]);return o};import{b as C,w as U,f as we,S as Te,i as ve,s as Ee,a as je,e as k,t as D,c as y,d as L,g as w,h as T,j as K,k as Oe,l as Ne,m as v,n as A,o as X,p as S,q as x,r as H,u as Ae,v as $,x as Ie,y as Se,z as Re,A as Pe,B as De,C as W,D as Me,E as Z,F as Ve}from"./vendor.f7331cca.js";const Ce=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=o(r);fetch(r.href,i)}};Ce();async function Le(t){var e;try{return await((e=window.navigator.clipboard)==null?void 0:e.writeText(t))}catch{const o=document.createElement("textarea");o.value=t,o.style.position="fixed",o.style.left="-999999px",o.style.top="-999999px",document.body.appendChild(o),o.focus(),o.select();const n=document.execCommand("copy");return o.remove(),n?Promise.resolve():Promise.reject()}}const Ke="modulepreload",ee={},Ze="",O=function(e,o){return!o||o.length===0?e():Promise.all(o.map(n=>{if(n=`${Ze}${n}`,n in ee)return;ee[n]=!0;const r=n.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const l=document.createElement("link");if(l.rel=r?"stylesheet":Ke,r||(l.as="script",l.crossOrigin=""),l.href=n,document.head.appendChild(l),r)return new Promise((c,a)=>{l.addEventListener("load",c),l.addEventListener("error",a)})})).then(()=>e())},te=console.log.bind(console),ze=console.debug.bind(console),Ue={"../../app-browser/playground.ts":()=>O(()=>import("./playground.57801471.js"),["assets/playground.57801471.js","assets/vendor.f7331cca.js"]),"../../app-countdown/playground.ts":()=>O(()=>import("./playground.87517f50.js"),["assets/playground.87517f50.js","assets/vendor.f7331cca.js"]),"../../app-docs-viewer/playground.ts":()=>O(()=>import("./playground.13e78b0c.js").then(function(t){return t.p}),[]),"../../app-embedded-page/playground.ts":()=>O(()=>import("./playground.bba82599.js"),["assets/playground.bba82599.js","assets/vendor.f7331cca.js"]),"../../app-geogebra/playground.ts":()=>O(()=>import("./playground.0af687f4.js"),["assets/playground.0af687f4.js","assets/vendor.f7331cca.js"]),"../../app-hello-world/playground.ts":()=>O(()=>import("./playground.e91a328a.js"),[]),"../../app-iframe-bridge/playground.ts":()=>O(()=>import("./playground.1a8a37eb.js"),["assets/playground.1a8a37eb.js","assets/vendor.f7331cca.js"]),"../../app-media-player/playground.ts":()=>O(()=>import("./playground.39f94689.js"),["assets/playground.39f94689.js","assets/vendor.f7331cca.js"]),"../../app-monaco/playground.ts":()=>O(()=>import("./playground.012ea1b1.js").then(function(t){return t.p}),[]),"../../app-vote/playground.ts":()=>O(()=>import("./playground.1e758a4b.js"),["assets/playground.1e758a4b.js","assets/vendor.f7331cca.js"])};async function xe(){const t=await Promise.all(Object.values(Ue).map(r=>r())),e=[];for(let{default:r}of t){Array.isArray(r)||(r=[r]),ze("[register]",r[0].kind);const i={kind:r[0].kind,configs:[]};for(const o of r){const n=o,{kind:l,src:c}=n,a=G(n,["kind","src"]);const u=async()=>{if(typeof c=="function"){const s=await c();return"default"in s?s.default:s}else return c};C.register({kind:l,src:u}),i.configs.push(z({kind:l},a))}e.push(i)}return window.apps=e,e}document.querySelector.bind(document);const oe=sessionStorage,J=localStorage,R={VITE_APPID:"ss4WoMf_EeqfCXcv33LmiA/izfIC88inXYJKw",VITE_ROOM_TOKEN:"NETLESSROOM_YWs9VWtNUk92M1JIN2I2Z284dCZub25jZT0xNjMzNjc5NzE2NTMxMDAmcm9sZT0wJnNpZz1kNDA3ZjZjODc1Nzc2MjM0NjhhOTk2ZjczMmQ3MTRmODA5YzQ3NzhjZmVjMDQwZDA0ZDdhOGZiYmNjODZiZTZlJnV1aWQ9MTMyMWM5NzAyODBkMTFlYzliNjg3MTIxYTU4ZjQwYjE",VITE_ROOM_UUID:"1321c970280d11ec9b687121a58f40b1",VITE_JUDGE0_KEY:"c6bf0d946amsh8a74c4b74695c0cp1d3a6ejsnb53b0567a805",BASE_URL:"",MODE:"production",DEV:!1,PROD:!0},ne=(t,e)=>fetch(`https://api.netless.link/v5/${t}`,{method:"POST",headers:{token:R.VITE_TOKEN,region:"cn-hz","Content-Type":"application/json"},body:JSON.stringify(e)}).then(o=>o.json());async function re(){const{uuid:t}=await ne("rooms",{limit:0,isRecord:!1});te("uuid = %O",t);const e=await ne(`tokens/rooms/${t}`,{lifespan:0,role:"admin"});te("roomToken = %O",e);const o=JSON.parse(J.getItem("rooms")||"[]"),n={uuid:t,roomToken:e};return o.unshift(n),J.setItem("rooms",JSON.stringify(o)),n}function ie(t){return typeof t=="object"&&t!==null&&"uuid"in t&&(t=`uuid=${t.uuid}&roomToken=${t.roomToken}`),location.origin+location.pathname+"?"+t.toString()}function We(){ae(location.origin+location.pathname)}function ae(t){t||(t=location.origin+location.pathname),history.replaceState({url:t},"",t)}const Je=new U.WhiteWebSdk({appIdentifier:R.VITE_APPID,useMobXState:!0,deviceType:U.DeviceType.Surface});async function Ye(){let t,e;const o=new URLSearchParams(location.search);if(o.has("uuid")&&o.has("roomToken")&&(t=o.get("uuid"),e=o.get("roomToken")),!t||!e){const n=JSON.parse(J.getItem("rooms")||"[]");n[0]&&({uuid:t,roomToken:e}=n[0])}if((!t||!e)&&(t=R.VITE_ROOM_UUID,e=R.VITE_ROOM_TOKEN),(!t||!e)&&R.VITE_TOKEN&&window.confirm("Not found uuid/roomToken both in query and localStorage, create a new one?")&&({uuid:t,roomToken:e}=await re(),location.reload()),!(!t||!e))return{uuid:t,roomToken:e}}async function Fe(t){const e=await Je.joinRoom(q(z({},t),{invisiblePlugins:[C],useMultiViews:!0,disableNewPencil:!1,floatBar:!0,userPayload:{nickName:we.name.firstName()}}));window.room=e;const o=oe.getItem("currentApplianceName");return o&&e.setMemberState({currentApplianceName:o}),We(),e}async function Qe({manager:t=window.manager,room:e=window.room,clearScreen:o=!1,reload:n=!1}={}){await Promise.all(Object.keys(t.apps||{}).map(r=>t.closeApp(r))),Object.keys(t.attributes).forEach(r=>{/-[-_a-zA-Z0-9]{8}$/.test(r)?t.updateAttributes([r],void 0):r==="apps"&&t.updateAttributes([r],{})}),t.mainView.moveCamera({centerX:0,centerY:0,scale:1}),o&&e.cleanCurrentScene(),n&&location.reload()}function Be(t){room.setScenePath("/init"),C.mount({room,container:t,chessboard:!1,cursor:!0,debug:!0}),window.manager=room.getInvisiblePlugin(C.kind),manager.switchMainViewToWriter()}const se=Object.values(U.ApplianceNames),{window:le}=Se;function qe(t){je(t,"svelte-fgakyb",`.tip.svelte-fgakyb{position:fixed;bottom:1em;right:1em;color:#fff;background-color:#0074d9;padding:1em;border-radius:4px;box-shadow:0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12),
      0 2px 4px -1px rgba(0, 0, 0, 0.2);z-index:9999;font-family:Arial, sans-serif;font-size:small}.tip.error.svelte-fgakyb{background-color:#ff4136}`)}function ce(t,e,o){const n=t.slice();return n[12]=e[o].kind,n[13]=e[o].configs,n}function ue(t,e,o){const n=t.slice();return n[16]=e[o],n[18]=o,n}function pe(t,e,o){const n=t.slice();return n[19]=e[o],n}function Ge(t){let e,o,n,r=t[3].split("-").map(ge).join(" ")+"",i,l,c,a,u,s,_,N,M,I,g,m,h=se,d=[];for(let p=0;p<h.length;p+=1)d[p]=fe(pe(t,h,p));let E=t[1],b=[];for(let p=0;p<E.length;p+=1)b[p]=me(ce(t,E,p));return{c(){e=k("div");for(let p=0;p<d.length;p+=1)d[p].c();o=A(),n=k("button"),i=D(r),l=A(),c=k("button"),c.textContent="RESET",a=A(),u=k("a"),u.textContent="GITHUB",s=A(),_=k("div"),N=k("div");for(let p=0;p<b.length;p+=1)b[p].c();M=A(),I=k("div"),y(n,"class","new-page-btn"),y(n,"title",`copy share url to clipboard
press ctrl/meta to clear address bar
press shift to create new room (only available with sdk token)`),y(c,"class","reset-btn"),y(c,"title",`remove all apps, reset camera
press ctrl/meta to reload page
press shift to clear screen`),y(u,"class","github-btn"),y(u,"href","https://github.com/netless-io/netless-app"),y(u,"title","View my source"),y(e,"id","tools"),y(N,"id","actions"),y(I,"id","whiteboard"),y(_,"class","two-side")},m(p,j){w(p,e,j);for(let f=0;f<d.length;f+=1)d[f].m(e,null);T(e,o),T(e,n),T(n,i),T(e,l),T(e,c),T(e,a),T(e,u),w(p,s,j),w(p,_,j),T(_,N);for(let f=0;f<b.length;f+=1)b[f].m(N,null);T(_,M),T(_,I),g||(m=[S(n,"click",t[9]),S(c,"click",ot),S(e,"click",t[5]),S(N,"click",t[6]),Me(Be.call(null,I))],g=!0)},p(p,j){if(j&4){h=se;let f;for(f=0;f<h.length;f+=1){const P=pe(p,h,f);d[f]?d[f].p(P,j):(d[f]=fe(P),d[f].c(),d[f].m(e,o))}for(;f<d.length;f+=1)d[f].d(1);d.length=h.length}if(j&8&&r!==(r=p[3].split("-").map(ge).join(" ")+"")&&K(i,r),j&2){E=p[1];let f;for(f=0;f<E.length;f+=1){const P=ce(p,E,f);b[f]?b[f].p(P,j):(b[f]=me(P),b[f].c(),b[f].m(N,null))}for(;f<b.length;f+=1)b[f].d(1);b.length=E.length}},d(p){p&&v(e),W(d,p),p&&v(s),p&&v(_),W(b,p),g=!1,$(m)}}}function Xe(t){let e;return{c(){e=k("div"),e.textContent="Joining Room..."},m(o,n){w(o,e,n)},p:Z,d(o){o&&v(e)}}}function He(t){let e;return{c(){e=k("div"),e.textContent="Registering Apps..."},m(o,n){w(o,e,n)},p:Z,d(o){o&&v(e)}}}function $e(t){let e;return{c(){e=k("div"),e.textContent="404 Not Found Room."},m(o,n){w(o,e,n)},p:Z,d(o){o&&v(e)}}}function et(t){let e;return{c(){e=k("div"),e.textContent="Preparing..."},m(o,n){w(o,e,n)},p:Z,d(o){o&&v(e)}}}function fe(t){let e,o=t[19]+"",n,r;return{c(){e=k("button"),n=D(o),y(e,"data-tool",r=t[19]),L(e,"active",t[19]===t[2])},m(i,l){w(i,e,l),T(e,n)},p(i,l){l&4&&L(e,"active",i[19]===i[2])},d(i){i&&v(e)}}}function de(t){var c;let e,o=(((c=t[16].options)==null?void 0:c.title)||`${t[16].kind} ${t[18]+1}`)+"",n,r,i,l;return{c(){e=k("button"),n=D(o),r=A(),y(e,"data-app-kind",i=t[12]),y(e,"data-app-index",l=t[18])},m(a,u){w(a,e,u),T(e,n),T(e,r)},p(a,u){var s;u&2&&o!==(o=(((s=a[16].options)==null?void 0:s.title)||`${a[16].kind} ${a[18]+1}`)+"")&&K(n,o),u&2&&i!==(i=a[12])&&y(e,"data-app-kind",i)},d(a){a&&v(e)}}}function me(t){let e,o=t[12]+"",n,r,i,l=t[13],c=[];for(let a=0;a<l.length;a+=1)c[a]=de(ue(t,l,a));return{c(){e=k("strong"),n=D(o),r=A();for(let a=0;a<c.length;a+=1)c[a].c();i=X()},m(a,u){w(a,e,u),T(e,n),w(a,r,u);for(let s=0;s<c.length;s+=1)c[s].m(a,u);w(a,i,u)},p(a,u){if(u&2&&o!==(o=a[12]+"")&&K(n,o),u&2){l=a[13];let s;for(s=0;s<l.length;s+=1){const _=ue(a,l,s);c[s]?c[s].p(_,u):(c[s]=de(_),c[s].c(),c[s].m(i.parentNode,i))}for(;s<c.length;s+=1)c[s].d(1);c.length=l.length}},d(a){a&&v(e),a&&v(r),W(c,a),a&&v(i)}}}function _e(t){let e,o,n,r,i;return{c(){e=k("div"),o=D(t[4]),y(e,"class","tip svelte-fgakyb"),L(e,"error",t[4].includes("Failed"))},m(l,c){w(l,e,c),T(e,o),i=!0},p(l,c){(!i||c&16)&&K(o,l[4]),c&16&&L(e,"error",l[4].includes("Failed"))},i(l){i||(Oe(()=>{r&&r.end(1),n=Re(e,Ve,{x:200}),n.start()}),i=!0)},o(l){n&&n.invalidate(),r=Ne(e,Pe,{}),i=!1},d(l){l&&v(e),l&&r&&r.end()}}}function tt(t){let e,o,n,r,i;function l(s,_){return s[0]==="prepare"?et:s[0]==="404"?$e:s[0]==="register-apps"?He:s[0]==="join-room"?Xe:Ge}let c=l(t),a=c(t),u=t[4]&&_e(t);return{c(){a.c(),e=A(),u&&u.c(),o=X()},m(s,_){a.m(s,_),w(s,e,_),u&&u.m(s,_),w(s,o,_),n=!0,r||(i=[S(le,"keydown",t[7]),S(le,"keyup",t[8])],r=!0)},p(s,[_]){c===(c=l(s))&&a?a.p(s,_):(a.d(1),a=c(s),a&&(a.c(),a.m(e.parentNode,e))),s[4]?u?(u.p(s,_),_&16&&x(u,1)):(u=_e(s),u.c(),x(u,1),u.m(o.parentNode,o)):u&&(De(),H(u,1,1,()=>{u=null}),Ae())},i(s){n||(x(u),n=!0)},o(s){H(u),n=!1},d(s){a.d(s),s&&v(e),u&&u.d(s),s&&v(o),r=!1,$(i)}}}let Y=0;function ot(t){Qe({clearScreen:t.shiftKey,reload:t.ctrlKey||t.metaKey})}const ge=t=>t.toUpperCase();function nt(t,e,o){let n="prepare",r,i,l,c="share",a="";Ie(async()=>{const g=await Ye();if(!g){o(0,n="404");return}o(0,n="register-apps"),o(1,r=await xe()),o(0,n="join-room"),i=await Fe(g),o(2,l=i.state.memberState.currentApplianceName),i.callbacks.on("onRoomStateChanged",m=>{m.memberState&&o(2,l=m.memberState.currentApplianceName)}),o(0,n="main")});function u(g){var h;const m=g.target;if((h=m==null?void 0:m.dataset)==null?void 0:h.tool){const d=m.dataset.tool;i.setMemberState({currentApplianceName:d}),oe.setItem("currentApplianceName",d)}}function s(g){var h,d;const m=g.target;if(((h=m==null?void 0:m.dataset)==null?void 0:h.appKind)&&((d=m==null?void 0:m.dataset)==null?void 0:d.appIndex)){const E=m.dataset.appKind,b=+m.dataset.appIndex,{configs:p}=r.find(j=>j.kind===E);window.manager.addApp(p[b])}}function _(g){g.key==="Shift"&&g.shiftKey&&R.VITE_TOKEN&&o(3,c="new-room")}function N(g){g.key==="Shift"&&!g.shiftKey&&o(3,c="share")}async function M(g){if(c==="share"){const{uuid:m,roomToken:h}=i,d=new URLSearchParams;d.set("uuid",m),d.set("roomToken",h);const E=ie(d);ae(g.ctrlKey||g.metaKey?"":E);try{await Le(E),I("Copied share url.")}catch{I("Failed to write clipboard.")}}if(c==="new-room"){const m=await re(),h=ie(m);window.open(h,"_blank"),o(3,c="share")}}function I(g){o(4,a=g),clearTimeout(Y),Y=window.setTimeout(()=>{Y=0,o(4,a="")},3e3)}return[n,r,l,c,a,u,s,_,N,M]}class rt extends Te{constructor(e){super();ve(this,e,nt,tt,Ee,{},qe)}}window.app=new rt({target:document.querySelector("#app")});var he;(he=navigator.serviceWorker)==null||he.getRegistrations().then(t=>{for(const e of t)e.unregister()}).catch(()=>{});export{O as _};
