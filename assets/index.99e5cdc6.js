var Rg=Object.defineProperty;var Qm=Object.getOwnPropertySymbols;var Ig=Object.prototype.hasOwnProperty,Lg=Object.prototype.propertyIsEnumerable,$g=Reflect.get,Kg=Reflect.set;var tg=(Re,C,S)=>C in Re?Rg(Re,C,{enumerable:!0,configurable:!0,writable:!0,value:S}):Re[C]=S,eg=(Re,C)=>{for(var S in C||(C={}))Ig.call(C,S)&&tg(Re,S,C[S]);if(Qm)for(var S of Qm(C))Lg.call(C,S)&&tg(Re,S,C[S]);return Re};import{s as zm}from"./side-effect-manager.es.5f289aa4.js";import{L as Og}from"./lazyload.esm.0a4b6d46.js";import{e as Dg}from"./ensure-attributes.2c659353.js";var ba=function(Re){var C={};function S(it){if(C[it])return C[it].exports;var j=C[it]={i:it,l:!1,exports:{}};return Re[it].call(j.exports,j,j.exports,S),j.l=!0,j.exports}return S.m=Re,S.c=C,S.d=function(it,j,dt){S.o(it,j)||Object.defineProperty(it,j,{enumerable:!0,get:dt})},S.r=function(it){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(it,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(it,"__esModule",{value:!0})},S.t=function(it,j){if(1&j&&(it=S(it)),8&j||4&j&&typeof it=="object"&&it&&it.__esModule)return it;var dt=Object.create(null);if(S.r(dt),Object.defineProperty(dt,"default",{enumerable:!0,value:it}),2&j&&typeof it!="string")for(var ot in it)S.d(dt,ot,function(X){return it[X]}.bind(null,ot));return dt},S.n=function(it){var j=it&&it.__esModule?function(){return it.default}:function(){return it};return S.d(j,"a",j),j},S.o=function(it,j){return Object.prototype.hasOwnProperty.call(it,j)},S.p="",S(S.s=31)}([function(Re,C,S){var it=Object.prototype.hasOwnProperty,j="~";function dt(){}function ot(J,lt,Ft){this.fn=J,this.context=lt,this.once=Ft||!1}function X(J,lt,Ft,jt,kt){if(typeof Ft!="function")throw new TypeError("The listener must be a function");var I=new ot(Ft,jt||J,kt),B=j?j+lt:lt;return J._events[B]?J._events[B].fn?J._events[B]=[J._events[B],I]:J._events[B].push(I):(J._events[B]=I,J._eventsCount++),J}function ft(J,lt){--J._eventsCount==0?J._events=new dt:delete J._events[lt]}function tt(){this._events=new dt,this._eventsCount=0}Object.create&&(dt.prototype=Object.create(null),new dt().__proto__||(j=!1)),tt.prototype.eventNames=function(){var J,lt,Ft=[];if(this._eventsCount===0)return Ft;for(lt in J=this._events)it.call(J,lt)&&Ft.push(j?lt.slice(1):lt);return Object.getOwnPropertySymbols?Ft.concat(Object.getOwnPropertySymbols(J)):Ft},tt.prototype.listeners=function(J){var lt=j?j+J:J,Ft=this._events[lt];if(!Ft)return[];if(Ft.fn)return[Ft.fn];for(var jt=0,kt=Ft.length,I=new Array(kt);jt<kt;jt++)I[jt]=Ft[jt].fn;return I},tt.prototype.listenerCount=function(J){var lt=j?j+J:J,Ft=this._events[lt];return Ft?Ft.fn?1:Ft.length:0},tt.prototype.emit=function(J,lt,Ft,jt,kt,I){var B=j?j+J:J;if(!this._events[B])return!1;var V,ut,F=this._events[B],Y=arguments.length;if(F.fn){switch(F.once&&this.removeListener(J,F.fn,void 0,!0),Y){case 1:return F.fn.call(F.context),!0;case 2:return F.fn.call(F.context,lt),!0;case 3:return F.fn.call(F.context,lt,Ft),!0;case 4:return F.fn.call(F.context,lt,Ft,jt),!0;case 5:return F.fn.call(F.context,lt,Ft,jt,kt),!0;case 6:return F.fn.call(F.context,lt,Ft,jt,kt,I),!0}for(ut=1,V=new Array(Y-1);ut<Y;ut++)V[ut-1]=arguments[ut];F.fn.apply(F.context,V)}else{var $,ct=F.length;for(ut=0;ut<ct;ut++)switch(F[ut].once&&this.removeListener(J,F[ut].fn,void 0,!0),Y){case 1:F[ut].fn.call(F[ut].context);break;case 2:F[ut].fn.call(F[ut].context,lt);break;case 3:F[ut].fn.call(F[ut].context,lt,Ft);break;case 4:F[ut].fn.call(F[ut].context,lt,Ft,jt);break;default:if(!V)for($=1,V=new Array(Y-1);$<Y;$++)V[$-1]=arguments[$];F[ut].fn.apply(F[ut].context,V)}}return!0},tt.prototype.on=function(J,lt,Ft){return X(this,J,lt,Ft,!1)},tt.prototype.once=function(J,lt,Ft){return X(this,J,lt,Ft,!0)},tt.prototype.removeListener=function(J,lt,Ft,jt){var kt=j?j+J:J;if(!this._events[kt])return this;if(!lt)return ft(this,kt),this;var I=this._events[kt];if(I.fn)I.fn!==lt||jt&&!I.once||Ft&&I.context!==Ft||ft(this,kt);else{for(var B=0,V=[],ut=I.length;B<ut;B++)(I[B].fn!==lt||jt&&!I[B].once||Ft&&I[B].context!==Ft)&&V.push(I[B]);V.length?this._events[kt]=V.length===1?V[0]:V:ft(this,kt)}return this},tt.prototype.removeAllListeners=function(J){var lt;return J?(lt=j?j+J:J,this._events[lt]&&ft(this,lt)):(this._events=new dt,this._eventsCount=0),this},tt.prototype.off=tt.prototype.removeListener,tt.prototype.addListener=tt.prototype.on,tt.prefixed=j,tt.EventEmitter=tt,Re.exports=tt},function(Re,C,S){(function(it,j){var dt;/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var ot="Expected a function",X="__lodash_placeholder__",ft=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],tt="[object Arguments]",J="[object Array]",lt="[object Boolean]",Ft="[object Date]",jt="[object Error]",kt="[object Function]",I="[object GeneratorFunction]",B="[object Map]",V="[object Number]",ut="[object Object]",F="[object RegExp]",Y="[object Set]",$="[object String]",ct="[object Symbol]",se="[object WeakMap]",Le="[object ArrayBuffer]",ee="[object DataView]",xt="[object Float32Array]",Zt="[object Float64Array]",$t="[object Int8Array]",Q="[object Int16Array]",Bt="[object Int32Array]",Wt="[object Uint8Array]",Kt="[object Uint16Array]",Xt="[object Uint32Array]",oe=/\b__p \+= '';/g,de=/\b(__p \+=) '' \+/g,$e=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ue=/&(?:amp|lt|gt|quot|#39);/g,Zn=/[&<>"']/g,Ke=RegExp(Ue.source),Un=RegExp(Zn.source),Hn=/<%-([\s\S]+?)%>/g,er=/<%([\s\S]+?)%>/g,bn=/<%=([\s\S]+?)%>/g,Cr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Lr=/^\w*$/,Rr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Yr=/[\\^$.*+?()[\]{}|]/g,Ar=RegExp(Yr.source),yr=/^\s+/,Ri=/\s/,Or=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Er=/\{\n\/\* \[wrapped with (.+)\] \*/,Fr=/,? & /,lo=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,_s=/[()=,{}\[\]\/\s]/,Fn=/\\(\\)?/g,_i=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ki=/\w*$/,L=/^[-+]0x[0-9a-f]+$/i,k=/^0b[01]+$/i,G=/^\[object .+?Constructor\]$/,st=/^0o[0-7]+$/i,K=/^(?:0|[1-9]\d*)$/,et=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,vt=/($^)/,wt=/['\n\r\u2028\u2029\\]/g,Ct="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",St="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ut="[\\ud800-\\udfff]",ne="["+St+"]",Vt="["+Ct+"]",fn="\\d+",We="[\\u2700-\\u27bf]",sr="[a-z\\xdf-\\xf6\\xf8-\\xff]",Ii="[^\\ud800-\\udfff"+St+fn+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",ui="\\ud83c[\\udffb-\\udfff]",Bo="[^\\ud800-\\udfff]",ho="(?:\\ud83c[\\udde6-\\uddff]){2}",Uo="[\\ud800-\\udbff][\\udc00-\\udfff]",wa="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Sa="(?:"+sr+"|"+Ii+")",ml="(?:"+wa+"|"+Ii+")",eu="(?:"+Vt+"|"+ui+")?",Jt="[\\ufe0e\\ufe0f]?"+eu+("(?:\\u200d(?:"+[Bo,ho,Uo].join("|")+")[\\ufe0e\\ufe0f]?"+eu+")*"),Nt="(?:"+[We,ho,Uo].join("|")+")"+Jt,ge="(?:"+[Bo+Vt+"?",Vt,ho,Uo,Ut].join("|")+")",Ge=RegExp("['\u2019]","g"),Qe=RegExp(Vt,"g"),hn=RegExp(ui+"(?="+ui+")|"+ge+Jt,"g"),jn=RegExp([wa+"?"+sr+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[ne,wa,"$"].join("|")+")",ml+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[ne,wa+Sa,"$"].join("|")+")",wa+"?"+Sa+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",wa+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",fn,Nt].join("|"),"g"),wn=RegExp("[\\u200d\\ud800-\\udfff"+Ct+"\\ufe0e\\ufe0f]"),Pn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,xr=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],gr=-1,ln={};ln[xt]=ln[Zt]=ln[$t]=ln[Q]=ln[Bt]=ln[Wt]=ln["[object Uint8ClampedArray]"]=ln[Kt]=ln[Xt]=!0,ln[tt]=ln[J]=ln[Le]=ln[lt]=ln[ee]=ln[Ft]=ln[jt]=ln[kt]=ln[B]=ln[V]=ln[ut]=ln[F]=ln[Y]=ln[$]=ln[se]=!1;var vn={};vn[tt]=vn[J]=vn[Le]=vn[ee]=vn[lt]=vn[Ft]=vn[xt]=vn[Zt]=vn[$t]=vn[Q]=vn[Bt]=vn[B]=vn[V]=vn[ut]=vn[F]=vn[Y]=vn[$]=vn[ct]=vn[Wt]=vn["[object Uint8ClampedArray]"]=vn[Kt]=vn[Xt]=!0,vn[jt]=vn[kt]=vn[se]=!1;var ir={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},yi=parseFloat,ar=parseInt,Br=typeof it=="object"&&it&&it.Object===Object&&it,zr=typeof self=="object"&&self&&self.Object===Object&&self,jr=Br||zr||Function("return this")(),Ur=C&&!C.nodeType&&C,nu=Ur&&typeof j=="object"&&j&&!j.nodeType&&j,ea=nu&&nu.exports===Ur,wu=ea&&Br.process,$r=function(){try{var Gt=nu&&nu.require&&nu.require("util").types;return Gt||wu&&wu.binding&&wu.binding("util")}catch{}}(),Eo=$r&&$r.isArrayBuffer,rc=$r&&$r.isDate,ic=$r&&$r.isMap,gl=$r&&$r.isRegExp,oc=$r&&$r.isSet,Su=$r&&$r.isTypedArray;function yo(Gt,fe,we){switch(we.length){case 0:return Gt.call(fe);case 1:return Gt.call(fe,we[0]);case 2:return Gt.call(fe,we[0],we[1]);case 3:return Gt.call(fe,we[0],we[1],we[2])}return Gt.apply(fe,we)}function pf(Gt,fe,we,sn){for(var en=-1,pr=Gt==null?0:Gt.length;++en<pr;){var hi=Gt[en];fe(sn,hi,we(hi),Gt)}return sn}function ko(Gt,fe){for(var we=-1,sn=Gt==null?0:Gt.length;++we<sn&&fe(Gt[we],we,Gt)!==!1;);return Gt}function vl(Gt,fe){for(var we=Gt==null?0:Gt.length;we--&&fe(Gt[we],we,Gt)!==!1;);return Gt}function fi(Gt,fe){for(var we=-1,sn=Gt==null?0:Gt.length;++we<sn;)if(!fe(Gt[we],we,Gt))return!1;return!0}function ns(Gt,fe){for(var we=-1,sn=Gt==null?0:Gt.length,en=0,pr=[];++we<sn;){var hi=Gt[we];fe(hi,we,Gt)&&(pr[en++]=hi)}return pr}function _l(Gt,fe){return!!(Gt==null?0:Gt.length)&&rs(Gt,fe,0)>-1}function sh(Gt,fe,we){for(var sn=-1,en=Gt==null?0:Gt.length;++sn<en;)if(we(fe,Gt[sn]))return!0;return!1}function Ln(Gt,fe){for(var we=-1,sn=Gt==null?0:Gt.length,en=Array(sn);++we<sn;)en[we]=fe(Gt[we],we,Gt);return en}function na(Gt,fe){for(var we=-1,sn=fe.length,en=Gt.length;++we<sn;)Gt[en+we]=fe[we];return Gt}function ah(Gt,fe,we,sn){var en=-1,pr=Gt==null?0:Gt.length;for(sn&&pr&&(we=Gt[++en]);++en<pr;)we=fe(we,Gt[en],en,Gt);return we}function yl(Gt,fe,we,sn){var en=Gt==null?0:Gt.length;for(sn&&en&&(we=Gt[--en]);en--;)we=fe(we,Gt[en],en,Gt);return we}function xl(Gt,fe){for(var we=-1,sn=Gt==null?0:Gt.length;++we<sn;)if(fe(Gt[we],we,Gt))return!0;return!1}var xi=bl("length");function Ta(Gt,fe,we){var sn;return we(Gt,function(en,pr,hi){if(fe(en,pr,hi))return sn=pr,!1}),sn}function li(Gt,fe,we,sn){for(var en=Gt.length,pr=we+(sn?1:-1);sn?pr--:++pr<en;)if(fe(Gt[pr],pr,Gt))return pr;return-1}function rs(Gt,fe,we){return fe==fe?function(sn,en,pr){for(var hi=pr-1,Hs=sn.length;++hi<Hs;)if(sn[hi]===en)return hi;return-1}(Gt,fe,we):li(Gt,Ea,we)}function ru(Gt,fe,we,sn){for(var en=we-1,pr=Gt.length;++en<pr;)if(sn(Gt[en],fe))return en;return-1}function Ea(Gt){return Gt!=Gt}function Ma(Gt,fe){var we=Gt==null?0:Gt.length;return we?Kr(Gt,fe)/we:NaN}function bl(Gt){return function(fe){return fe==null?void 0:fe[Gt]}}function uh(Gt){return function(fe){return Gt==null?void 0:Gt[fe]}}function wl(Gt,fe,we,sn,en){return en(Gt,function(pr,hi,Hs){we=sn?(sn=!1,pr):fe(we,pr,hi,Hs)}),we}function Kr(Gt,fe){for(var we,sn=-1,en=Gt.length;++sn<en;){var pr=fe(Gt[sn]);pr!==void 0&&(we=we===void 0?pr:we+pr)}return we}function Sl(Gt,fe){for(var we=-1,sn=Array(Gt);++we<Gt;)sn[we]=fe(we);return sn}function Tu(Gt){return Gt&&Gt.slice(0,fd(Gt)+1).replace(yr,"")}function Mo(Gt){return function(fe){return Gt(fe)}}function Tl(Gt,fe){return Ln(fe,function(we){return Gt[we]})}function ni(Gt,fe){return Gt.has(fe)}function lh(Gt,fe){for(var we=-1,sn=Gt.length;++we<sn&&rs(fe,Gt[we],0)>-1;);return we}function cd(Gt,fe){for(var we=Gt.length;we--&&rs(fe,Gt[we],0)>-1;);return we}function Wi(Gt,fe){for(var we=Gt.length,sn=0;we--;)Gt[we]===fe&&++sn;return sn}var dd=uh({\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"}),no=uh({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function El(Gt){return"\\"+ir[Gt]}function ks(Gt){return wn.test(Gt)}function ri(Gt){var fe=-1,we=Array(Gt.size);return Gt.forEach(function(sn,en){we[++fe]=[en,sn]}),we}function Aa(Gt,fe){return function(we){return Gt(fe(we))}}function Go(Gt,fe){for(var we=-1,sn=Gt.length,en=0,pr=[];++we<sn;){var hi=Gt[we];hi!==fe&&hi!==X||(Gt[we]=X,pr[en++]=we)}return pr}function iu(Gt){var fe=-1,we=Array(Gt.size);return Gt.forEach(function(sn){we[++fe]=sn}),we}function sc(Gt){var fe=-1,we=Array(Gt.size);return Gt.forEach(function(sn){we[++fe]=[sn,sn]}),we}function ra(Gt){return ks(Gt)?function(fe){for(var we=hn.lastIndex=0;hn.test(fe);)++we;return we}(Gt):xi(Gt)}function Gs(Gt){return ks(Gt)?function(fe){return fe.match(hn)||[]}(Gt):function(fe){return fe.split("")}(Gt)}function fd(Gt){for(var fe=Gt.length;fe--&&Ri.test(Gt.charAt(fe)););return fe}var ro=uh({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Pa=function Gt(fe){var we,sn=(fe=fe==null?jr:Pa.defaults(jr.Object(),fe,Pa.pick(jr,xr))).Array,en=fe.Date,pr=fe.Error,hi=fe.Function,Hs=fe.Math,On=fe.Object,Eu=fe.RegExp,pd=fe.String,pi=fe.TypeError,Mu=sn.prototype,md=hi.prototype,Ca=On.prototype,Ml=fe["__core-js_shared__"],Au=md.toString,Hr=Ca.hasOwnProperty,mf=0,Ao=(we=/[^.]+$/.exec(Ml&&Ml.keys&&Ml.keys.IE_PROTO||""))?"Symbol(src)_1."+we:"",ac=Ca.toString,uc=Au.call(On),gd=jr._,vd=Eu("^"+Au.call(Hr).replace(Yr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hh=ea?fe.Buffer:void 0,Nn=fe.Symbol,ys=fe.Uint8Array,Zi=hh?hh.allocUnsafe:void 0,ch=Aa(On.getPrototypeOf,On),lc=On.create,gf=Ca.propertyIsEnumerable,Gi=Mu.splice,_d=Nn?Nn.isConcatSpreadable:void 0,dh=Nn?Nn.iterator:void 0,ou=Nn?Nn.toStringTag:void 0,hc=function(){try{var c=mu(On,"defineProperty");return c({},"",{}),c}catch{}}(),yd=fe.clearTimeout!==jr.clearTimeout&&fe.clearTimeout,Ho=en&&en.now!==jr.Date.now&&en.now,io=fe.setTimeout!==jr.setTimeout&&fe.setTimeout,Ra=Hs.ceil,ia=Hs.floor,zo=On.getOwnPropertySymbols,jo=hh?hh.isBuffer:void 0,Hi=fe.isFinite,fh=Mu.join,Pu=Aa(On.keys,On),ci=Hs.max,Ji=Hs.min,xd=en.now,cc=fe.parseInt,He=Hs.random,$i=Mu.reverse,oa=mu(fe,"DataView"),zs=mu(fe,"Map"),ph=mu(fe,"Promise"),ii=mu(fe,"Set"),su=mu(fe,"WeakMap"),Ir=mu(On,"create"),Po=su&&new su,Ia={},dc=Os(oa),Xi=Os(zs),mt=Os(ph),Cu=Os(ii),bd=Os(su),co=Nn?Nn.prototype:void 0,is=co?co.valueOf:void 0,Al=co?co.toString:void 0;function nt(c){if(Ei(c)&&!cr(c)&&!(c instanceof lr)){if(c instanceof qi)return c;if(Hr.call(c,"__wrapped__"))return Ph(c)}return new qi(c)}var xs=function(){function c(){}return function(g){if(!Ti(g))return{};if(lc)return lc(g);c.prototype=g;var T=new c;return c.prototype=void 0,T}}();function sa(){}function qi(c,g){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!g,this.__index__=0,this.__values__=void 0}function lr(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Vo(c){var g=-1,T=c==null?0:c.length;for(this.clear();++g<T;){var N=c[g];this.set(N[0],N[1])}}function Ki(c){var g=-1,T=c==null?0:c.length;for(this.clear();++g<T;){var N=c[g];this.set(N[0],N[1])}}function os(c){var g=-1,T=c==null?0:c.length;for(this.clear();++g<T;){var N=c[g];this.set(N[0],N[1])}}function aa(c){var g=-1,T=c==null?0:c.length;for(this.__data__=new os;++g<T;)this.add(c[g])}function Co(c){var g=this.__data__=new Ki(c);this.size=g.size}function au(c,g){var T=cr(c),N=!T&&Ds(c),W=!T&&!N&&ka(c),ht=!T&&!N&&!W&&Yu(c),Tt=T||N||W||ht,It=Tt?Sl(c.length,pd):[],qt=It.length;for(var ve in c)!g&&!Hr.call(c,ve)||Tt&&(ve=="length"||W&&(ve=="offset"||ve=="parent")||ht&&(ve=="buffer"||ve=="byteLength"||ve=="byteOffset")||qo(ve,qt))||It.push(ve);return It}function Ru(c){var g=c.length;return g?c[Sd(0,g-1)]:void 0}function mh(c,g){return Fl(Di(c),Vs(g,0,c.length))}function ua(c){return Fl(Di(c))}function bs(c,g,T){(T!==void 0&&!Oo(c[g],T)||T===void 0&&!(g in c))&&Wo(c,g,T)}function zi(c,g,T){var N=c[g];Hr.call(c,g)&&Oo(N,T)&&(T!==void 0||g in c)||Wo(c,g,T)}function ws(c,g){for(var T=c.length;T--;)if(Oo(c[T][0],g))return T;return-1}function Ss(c,g,T,N){return Io(c,function(W,ht,Tt){g(N,W,T(W),Tt)}),N}function gh(c,g){return c&&as(g,di(g),c)}function Wo(c,g,T){g=="__proto__"&&hc?hc(c,g,{configurable:!0,enumerable:!0,value:T,writable:!0}):c[g]=T}function js(c,g){for(var T=-1,N=g.length,W=sn(N),ht=c==null;++T<N;)W[T]=ht?void 0:Ga(c,g[T]);return W}function Vs(c,g,T){return c==c&&(T!==void 0&&(c=c<=T?c:T),g!==void 0&&(c=c>=g?c:g)),c}function fo(c,g,T,N,W,ht){var Tt,It=1&g,qt=2&g,ve=4&g;if(T&&(Tt=W?T(c,N,W,ht):T(c)),Tt!==void 0)return Tt;if(!Ti(c))return c;var le=cr(c);if(le){if(Tt=function(Me){var qe=Me.length,Qn=new Me.constructor(qe);return qe&&typeof Me[0]=="string"&&Hr.call(Me,"index")&&(Qn.index=Me.index,Qn.input=Me.input),Qn}(c),!It)return Di(c,Tt)}else{var Ne=ze(c),yn=Ne==kt||Ne==I;if(ka(c))return du(c,It);if(Ne==ut||Ne==tt||yn&&!W){if(Tt=qt||yn?{}:Rd(c),!It)return qt?function(Me,qe){return as(Me,nr(Me),qe)}(c,function(Me,qe){return Me&&as(qe,so(qe),Me)}(Tt,c)):function(Me,qe){return as(Me,pa(Me),qe)}(c,gh(Tt,c))}else{if(!vn[Ne])return W?c:{};Tt=function(Me,qe,Qn){var _n=Me.constructor;switch(qe){case Le:return xo(Me);case lt:case Ft:return new _n(+Me);case ee:return function(Cn,fr){var Mn=fr?xo(Cn.buffer):Cn.buffer;return new Cn.constructor(Mn,Cn.byteOffset,Cn.byteLength)}(Me,Qn);case xt:case Zt:case $t:case Q:case Bt:case Wt:case"[object Uint8ClampedArray]":case Kt:case Xt:return Ll(Me,Qn);case B:return new _n;case V:case $:return new _n(Me);case F:return function(Cn){var fr=new Cn.constructor(Cn.source,ki.exec(Cn));return fr.lastIndex=Cn.lastIndex,fr}(Me);case Y:return new _n;case ct:return qn=Me,is?On(is.call(qn)):{}}var qn}(c,Ne,It)}}ht||(ht=new Co);var xn=ht.get(c);if(xn)return xn;ht.set(c,Tt),Xd(c)?c.forEach(function(Me){Tt.add(fo(Me,g,T,Me,c,ht))}):Vd(c)&&c.forEach(function(Me,qe){Tt.set(qe,fo(Me,g,T,qe,c,ht))});var Bn=le?void 0:(ve?qt?Pd:Th:qt?so:di)(c);return ko(Bn||c,function(Me,qe){Bn&&(Me=c[qe=Me]),zi(Tt,qe,fo(Me,g,T,qe,c,ht))}),Tt}function Pl(c,g,T){var N=T.length;if(c==null)return!N;for(c=On(c);N--;){var W=T[N],ht=g[W],Tt=c[W];if(Tt===void 0&&!(W in c)||!ht(Tt))return!1}return!0}function Ro(c,g,T){if(typeof c!="function")throw new pi(ot);return Ls(function(){c.apply(void 0,T)},g)}function Tn(c,g,T,N){var W=-1,ht=_l,Tt=!0,It=c.length,qt=[],ve=g.length;if(!It)return qt;T&&(g=Ln(g,Mo(T))),N?(ht=sh,Tt=!1):g.length>=200&&(ht=ni,Tt=!1,g=new aa(g));t:for(;++W<It;){var le=c[W],Ne=T==null?le:T(le);if(le=N||le!==0?le:0,Tt&&Ne==Ne){for(var yn=ve;yn--;)if(g[yn]===Ne)continue t;qt.push(le)}else ht(g,Ne,N)||qt.push(le)}return qt}nt.templateSettings={escape:Hn,evaluate:er,interpolate:bn,variable:"",imports:{_:nt}},nt.prototype=sa.prototype,nt.prototype.constructor=nt,qi.prototype=xs(sa.prototype),qi.prototype.constructor=qi,lr.prototype=xs(sa.prototype),lr.prototype.constructor=lr,Vo.prototype.clear=function(){this.__data__=Ir?Ir(null):{},this.size=0},Vo.prototype.delete=function(c){var g=this.has(c)&&delete this.__data__[c];return this.size-=g?1:0,g},Vo.prototype.get=function(c){var g=this.__data__;if(Ir){var T=g[c];return T==="__lodash_hash_undefined__"?void 0:T}return Hr.call(g,c)?g[c]:void 0},Vo.prototype.has=function(c){var g=this.__data__;return Ir?g[c]!==void 0:Hr.call(g,c)},Vo.prototype.set=function(c,g){var T=this.__data__;return this.size+=this.has(c)?0:1,T[c]=Ir&&g===void 0?"__lodash_hash_undefined__":g,this},Ki.prototype.clear=function(){this.__data__=[],this.size=0},Ki.prototype.delete=function(c){var g=this.__data__,T=ws(g,c);return!(T<0)&&(T==g.length-1?g.pop():Gi.call(g,T,1),--this.size,!0)},Ki.prototype.get=function(c){var g=this.__data__,T=ws(g,c);return T<0?void 0:g[T][1]},Ki.prototype.has=function(c){return ws(this.__data__,c)>-1},Ki.prototype.set=function(c,g){var T=this.__data__,N=ws(T,c);return N<0?(++this.size,T.push([c,g])):T[N][1]=g,this},os.prototype.clear=function(){this.size=0,this.__data__={hash:new Vo,map:new(zs||Ki),string:new Vo}},os.prototype.delete=function(c){var g=Fa(this,c).delete(c);return this.size-=g?1:0,g},os.prototype.get=function(c){return Fa(this,c).get(c)},os.prototype.has=function(c){return Fa(this,c).has(c)},os.prototype.set=function(c,g){var T=Fa(this,c),N=T.size;return T.set(c,g),this.size+=T.size==N?0:1,this},aa.prototype.add=aa.prototype.push=function(c){return this.__data__.set(c,"__lodash_hash_undefined__"),this},aa.prototype.has=function(c){return this.__data__.has(c)},Co.prototype.clear=function(){this.__data__=new Ki,this.size=0},Co.prototype.delete=function(c){var g=this.__data__,T=g.delete(c);return this.size=g.size,T},Co.prototype.get=function(c){return this.__data__.get(c)},Co.prototype.has=function(c){return this.__data__.has(c)},Co.prototype.set=function(c,g){var T=this.__data__;if(T instanceof Ki){var N=T.__data__;if(!zs||N.length<199)return N.push([c,g]),this.size=++T.size,this;T=this.__data__=new os(N)}return T.set(c,g),this.size=T.size,this};var Io=Ys(Xo),Ts=Ys(Ws,!0);function vf(c,g){var T=!0;return Io(c,function(N,W,ht){return T=!!g(N,W,ht)}),T}function fc(c,g,T){for(var N=-1,W=c.length;++N<W;){var ht=c[N],Tt=g(ht);if(Tt!=null&&(It===void 0?Tt==Tt&&!Zo(Tt):T(Tt,It)))var It=Tt,qt=ht}return qt}function la(c,g){var T=[];return Io(c,function(N,W,ht){g(N,W,ht)&&T.push(N)}),T}function Li(c,g,T,N,W){var ht=-1,Tt=c.length;for(T||(T=yf),W||(W=[]);++ht<Tt;){var It=c[ht];g>0&&T(It)?g>1?Li(It,g-1,T,N,W):na(W,It):N||(W[W.length]=It)}return W}var po=bc(),vh=bc(!0);function Xo(c,g){return c&&po(c,g,di)}function Ws(c,g){return c&&vh(c,g,di)}function Iu(c,g){return ns(g,function(T){return Do(c[T])})}function La(c,g){for(var T=0,N=(g=Xn(g,c)).length;c!=null&&T<N;)c=c[hs(g[T++])];return T&&T==N?c:void 0}function pc(c,g,T){var N=g(c);return cr(c)?N:na(N,T(c))}function Zr(c){return c==null?c===void 0?"[object Undefined]":"[object Null]":ou&&ou in On(c)?function(g){var T=Hr.call(g,ou),N=g[ou];try{g[ou]=void 0;var W=!0}catch{}var ht=ac.call(g);return W&&(T?g[ou]=N:delete g[ou]),ht}(c):function(g){return ac.call(g)}(c)}function Es(c,g){return c>g}function _h(c,g){return c!=null&&Hr.call(c,g)}function Lu(c,g){return c!=null&&g in On(c)}function Cl(c,g,T){for(var N=T?sh:_l,W=c[0].length,ht=c.length,Tt=ht,It=sn(ht),qt=1/0,ve=[];Tt--;){var le=c[Tt];Tt&&g&&(le=Ln(le,Mo(g))),qt=Ji(le.length,qt),It[Tt]=!T&&(g||W>=120&&le.length>=120)?new aa(Tt&&le):void 0}le=c[0];var Ne=-1,yn=It[0];t:for(;++Ne<W&&ve.length<qt;){var xn=le[Ne],Bn=g?g(xn):xn;if(xn=T||xn!==0?xn:0,!(yn?ni(yn,Bn):N(ve,Bn,T))){for(Tt=ht;--Tt;){var Me=It[Tt];if(!(Me?ni(Me,Bn):N(c[Tt],Bn,T)))continue t}yn&&yn.push(Bn),ve.push(xn)}}return ve}function uu(c,g,T){var N=(c=Od(c,g=Xn(g,c)))==null?c:c[hs(wo(g))];return N==null?void 0:yo(N,c,T)}function Rl(c){return Ei(c)&&Zr(c)==tt}function Ou(c,g,T,N,W){return c===g||(c==null||g==null||!Ei(c)&&!Ei(g)?c!=c&&g!=g:function(ht,Tt,It,qt,ve,le){var Ne=cr(ht),yn=cr(Tt),xn=Ne?J:ze(ht),Bn=yn?J:ze(Tt),Me=(xn=xn==tt?ut:xn)==ut,qe=(Bn=Bn==tt?ut:Bn)==ut,Qn=xn==Bn;if(Qn&&ka(ht)){if(!ka(Tt))return!1;Ne=!0,Me=!1}if(Qn&&!Me)return le||(le=new Co),Ne||Yu(ht)?Gu(ht,Tt,It,qt,ve,le):function(Mn,Wn,Fi,gi,Ns,Mi,$s){switch(Fi){case ee:if(Mn.byteLength!=Wn.byteLength||Mn.byteOffset!=Wn.byteOffset)return!1;Mn=Mn.buffer,Wn=Wn.buffer;case Le:return!(Mn.byteLength!=Wn.byteLength||!Mi(new ys(Mn),new ys(Wn)));case lt:case Ft:case V:return Oo(+Mn,+Wn);case jt:return Mn.name==Wn.name&&Mn.message==Wn.message;case F:case $:return Mn==Wn+"";case B:var Va=ri;case Y:var ms=1&gi;if(Va||(Va=iu),Mn.size!=Wn.size&&!ms)return!1;var yu=$s.get(Mn);if(yu)return yu==Wn;gi|=2,$s.set(Mn,Wn);var Wa=Gu(Va(Mn),Va(Wn),gi,Ns,Mi,$s);return $s.delete(Mn),Wa;case ct:if(is)return is.call(Mn)==is.call(Wn)}return!1}(ht,Tt,xn,It,qt,ve,le);if(!(1&It)){var _n=Me&&Hr.call(ht,"__wrapped__"),qn=qe&&Hr.call(Tt,"__wrapped__");if(_n||qn){var Cn=_n?ht.value():ht,fr=qn?Tt.value():Tt;return le||(le=new Co),ve(Cn,fr,It,qt,le)}}return Qn?(le||(le=new Co),function(Mn,Wn,Fi,gi,Ns,Mi){var $s=1&Fi,Va=Th(Mn),ms=Va.length,yu=Th(Wn).length;if(ms!=yu&&!$s)return!1;for(var Wa=ms;Wa--;){var va=Va[Wa];if(!($s?va in Wn:Hr.call(Wn,va)))return!1}var Jl=Mi.get(Mn),Vc=Mi.get(Wn);if(Jl&&Vc)return Jl==Wn&&Vc==Mn;var il=!0;Mi.set(Mn,Wn),Mi.set(Wn,Mn);for(var jh=$s;++Wa<ms;){va=Va[Wa];var ol=Mn[va],$l=Wn[va];if(gi)var Uf=$s?gi($l,ol,va,Wn,Mn,Mi):gi(ol,$l,va,Mn,Wn,Mi);if(!(Uf===void 0?ol===$l||Ns(ol,$l,Fi,gi,Mi):Uf)){il=!1;break}jh||(jh=va=="constructor")}if(il&&!jh){var Vh=Mn.constructor,$o=Wn.constructor;Vh==$o||!("constructor"in Mn)||!("constructor"in Wn)||typeof Vh=="function"&&Vh instanceof Vh&&typeof $o=="function"&&$o instanceof $o||(il=!1)}return Mi.delete(Mn),Mi.delete(Wn),il}(ht,Tt,It,qt,ve,le)):!1}(c,g,T,N,Ou,W))}function yh(c,g,T,N){var W=T.length,ht=W,Tt=!N;if(c==null)return!ht;for(c=On(c);W--;){var It=T[W];if(Tt&&It[2]?It[1]!==c[It[0]]:!(It[0]in c))return!1}for(;++W<ht;){var qt=(It=T[W])[0],ve=c[qt],le=It[1];if(Tt&&It[2]){if(ve===void 0&&!(qt in c))return!1}else{var Ne=new Co;if(N)var yn=N(ve,le,qt,c,g,Ne);if(!(yn===void 0?Ou(le,ve,3,N,Ne):yn))return!1}}return!0}function mc(c){return!(!Ti(c)||(g=c,Ao&&Ao in g))&&(Do(c)?vd:G).test(Os(c));var g}function gc(c){return typeof c=="function"?c:c==null?Yi:typeof c=="object"?cr(c)?Oa(c[0],c[1]):ha(c):Hh(c)}function vr(c){if(!Hu(c))return Pu(c);var g=[];for(var T in On(c))Hr.call(c,T)&&T!="constructor"&&g.push(T);return g}function Ms(c){if(!Ti(c))return function(W){var ht=[];if(W!=null)for(var Tt in On(W))ht.push(Tt);return ht}(c);var g=Hu(c),T=[];for(var N in c)(N!="constructor"||!g&&Hr.call(c,N))&&T.push(N);return T}function As(c,g){return c<g}function xh(c,g){var T=-1,N=Yo(c)?sn(c.length):[];return Io(c,function(W,ht,Tt){N[++T]=g(W,ht,Tt)}),N}function ha(c){var g=Eh(c);return g.length==1&&g[0][2]?zu(g[0][0],g[0][1]):function(T){return T===c||yh(T,c,g)}}function Oa(c,g){return Tc(c)&&Ld(g)?zu(hs(c),g):function(T){var N=Ga(T,c);return N===void 0&&N===g?Ju(T,c):Ou(g,N,3)}}function ca(c,g,T,N,W){c!==g&&po(g,function(ht,Tt){if(W||(W=new Co),Ti(ht))(function(qt,ve,le,Ne,yn,xn,Bn){var Me=gu(qt,le),qe=gu(ve,le),Qn=Bn.get(qe);if(Qn)return void bs(qt,le,Qn);var _n=xn?xn(Me,qe,le+"",qt,ve,Bn):void 0,qn=_n===void 0;if(qn){var Cn=cr(qe),fr=!Cn&&ka(qe),Mn=!Cn&&!fr&&Yu(qe);_n=qe,Cn||fr||Mn?cr(Me)?_n=Me:Si(Me)?_n=Di(Me):fr?(qn=!1,_n=du(qe,!0)):Mn?(qn=!1,_n=Ll(qe,!0)):_n=[]:qu(qe)||Ds(qe)?(_n=Me,Ds(Me)?_n=Fc(Me):Ti(Me)&&!Do(Me)||(_n=Rd(qe))):qn=!1}qn&&(Bn.set(qe,_n),yn(_n,qe,Ne,xn,Bn),Bn.delete(qe)),bs(qt,le,_n)})(c,g,Tt,T,ca,N,W);else{var It=N?N(gu(c,Tt),ht,Tt+"",c,g,W):void 0;It===void 0&&(It=ht),bs(c,Tt,It)}},so)}function wd(c,g){var T=c.length;if(T)return qo(g+=g<0?T:0,T)?c[g]:void 0}function lu(c,g,T){g=g.length?Ln(g,function(W){return cr(W)?function(ht){return La(ht,W.length===1?W[0]:W)}:W}):[Yi];var N=-1;return g=Ln(g,Mo(Vn())),function(W,ht){var Tt=W.length;for(W.sort(ht);Tt--;)W[Tt]=W[Tt].value;return W}(xh(c,function(W,ht,Tt){return{criteria:Ln(g,function(It){return It(W)}),index:++N,value:W}}),function(W,ht){return function(Tt,It,qt){for(var ve=-1,le=Tt.criteria,Ne=It.criteria,yn=le.length,xn=qt.length;++ve<yn;){var Bn=Oi(le[ve],Ne[ve]);if(Bn){if(ve>=xn)return Bn;var Me=qt[ve];return Bn*(Me=="desc"?-1:1)}}return Tt.index-It.index}(W,ht,T)})}function vc(c,g,T){for(var N=-1,W=g.length,ht={};++N<W;){var Tt=g[N],It=La(c,Tt);T(It,Tt)&&hu(ht,Xn(Tt,c),It)}return ht}function Il(c,g,T,N){var W=N?ru:rs,ht=-1,Tt=g.length,It=c;for(c===g&&(g=Di(g)),T&&(It=Ln(c,Mo(T)));++ht<Tt;)for(var qt=0,ve=g[ht],le=T?T(ve):ve;(qt=W(It,le,qt,N))>-1;)It!==c&&Gi.call(It,qt,1),Gi.call(c,qt,1);return c}function bi(c,g){for(var T=c?g.length:0,N=T-1;T--;){var W=g[T];if(T==N||W!==ht){var ht=W;qo(W)?Gi.call(c,W,1):Nu(c,W)}}return c}function Sd(c,g){return c+ia(He()*(g-c+1))}function ji(c,g){var T="";if(!c||g<1||g>9007199254740991)return T;do g%2&&(T+=c),(g=ia(g/2))&&(c+=c);while(g);return T}function br(c,g){return Nl(Ah(c,g,Yi),c+"")}function Qi(c){return Ru(ma(c))}function da(c,g){var T=ma(c);return Fl(T,Vs(g,0,T.length))}function hu(c,g,T,N){if(!Ti(c))return c;for(var W=-1,ht=(g=Xn(g,c)).length,Tt=ht-1,It=c;It!=null&&++W<ht;){var qt=hs(g[W]),ve=T;if(qt==="__proto__"||qt==="constructor"||qt==="prototype")return c;if(W!=Tt){var le=It[qt];(ve=N?N(le,qt,It):void 0)===void 0&&(ve=Ti(le)?le:qo(g[W+1])?[]:{})}zi(It,qt,ve),It=It[qt]}return c}var _c=Po?function(c,g){return Po.set(c,g),c}:Yi,Td=hc?function(c,g){return hc(c,"toString",{configurable:!0,enumerable:!1,value:Qd(g),writable:!0})}:Yi;function pn(c){return Fl(ma(c))}function Vi(c,g,T){var N=-1,W=c.length;g<0&&(g=-g>W?0:W+g),(T=T>W?W:T)<0&&(T+=W),W=g>T?0:T-g>>>0,g>>>=0;for(var ht=sn(W);++N<W;)ht[N]=c[N+g];return ht}function Qr(c,g){var T;return Io(c,function(N,W,ht){return!(T=g(N,W,ht))}),!!T}function Du(c,g,T){var N=0,W=c==null?N:c.length;if(typeof g=="number"&&g==g&&W<=2147483647){for(;N<W;){var ht=N+W>>>1,Tt=c[ht];Tt!==null&&!Zo(Tt)&&(T?Tt<=g:Tt<g)?N=ht+1:W=ht}return W}return hr(c,g,Yi,T)}function hr(c,g,T,N){var W=0,ht=c==null?0:c.length;if(ht===0)return 0;for(var Tt=(g=T(g))!=g,It=g===null,qt=Zo(g),ve=g===void 0;W<ht;){var le=ia((W+ht)/2),Ne=T(c[le]),yn=Ne!==void 0,xn=Ne===null,Bn=Ne==Ne,Me=Zo(Ne);if(Tt)var qe=N||Bn;else qe=ve?Bn&&(N||yn):It?Bn&&yn&&(N||!xn):qt?Bn&&yn&&!xn&&(N||!Me):!xn&&!Me&&(N?Ne<=g:Ne<g);qe?W=le+1:ht=le}return Ji(ht,4294967294)}function Ed(c,g){for(var T=-1,N=c.length,W=0,ht=[];++T<N;){var Tt=c[T],It=g?g(Tt):Tt;if(!T||!Oo(It,qt)){var qt=It;ht[W++]=Tt===0?0:Tt}}return ht}function zn(c){return typeof c=="number"?c:Zo(c)?NaN:+c}function Lo(c){if(typeof c=="string")return c;if(cr(c))return Ln(c,Lo)+"";if(Zo(c))return Al?Al.call(c):"";var g=c+"";return g=="0"&&1/c==-1/0?"-0":g}function Xs(c,g,T){var N=-1,W=_l,ht=c.length,Tt=!0,It=[],qt=It;if(T)Tt=!1,W=sh;else if(ht>=200){var ve=g?null:mo(c);if(ve)return iu(ve);Tt=!1,W=ni,qt=new aa}else qt=g?[]:It;t:for(;++N<ht;){var le=c[N],Ne=g?g(le):le;if(le=T||le!==0?le:0,Tt&&Ne==Ne){for(var yn=qt.length;yn--;)if(qt[yn]===Ne)continue t;g&&qt.push(Ne),It.push(le)}else W(qt,Ne,T)||(qt!==It&&qt.push(Ne),It.push(le))}return It}function Nu(c,g){return(c=Od(c,g=Xn(g,c)))==null||delete c[hs(wo(g))]}function Md(c,g,T,N){return hu(c,g,T(La(c,g)),N)}function Fu(c,g,T,N){for(var W=c.length,ht=N?W:-1;(N?ht--:++ht<W)&&g(c[ht],ht,c););return T?Vi(c,N?0:ht,N?ht+1:W):Vi(c,N?ht+1:0,N?W:ht)}function qs(c,g){var T=c;return T instanceof lr&&(T=T.value()),ah(g,function(N,W){return W.func.apply(W.thisArg,na([N],W.args))},T)}function En(c,g,T){var N=c.length;if(N<2)return N?Xs(c[0]):[];for(var W=-1,ht=sn(N);++W<N;)for(var Tt=c[W],It=-1;++It<N;)It!=W&&(ht[W]=Tn(ht[W]||Tt,c[It],g,T));return Xs(Li(ht,1),g,T)}function yc(c,g,T){for(var N=-1,W=c.length,ht=g.length,Tt={};++N<W;){var It=N<ht?g[N]:void 0;T(Tt,c[N],It)}return Tt}function ss(c){return Si(c)?c:[]}function qr(c){return typeof c=="function"?c:Yi}function Xn(c,g){return cr(c)?c:Tc(c,g)?[c]:Bl(Dr(c))}var _f=br;function Vr(c,g,T){var N=c.length;return T=T===void 0?N:T,!g&&T>=N?c:Vi(c,g,T)}var cu=yd||function(c){return jr.clearTimeout(c)};function du(c,g){if(g)return c.slice();var T=c.length,N=Zi?Zi(T):new c.constructor(T);return c.copy(N),N}function xo(c){var g=new c.constructor(c.byteLength);return new ys(g).set(new ys(c)),g}function Ll(c,g){var T=g?xo(c.buffer):c.buffer;return new c.constructor(T,c.byteOffset,c.length)}function Oi(c,g){if(c!==g){var T=c!==void 0,N=c===null,W=c==c,ht=Zo(c),Tt=g!==void 0,It=g===null,qt=g==g,ve=Zo(g);if(!It&&!ve&&!ht&&c>g||ht&&Tt&&qt&&!It&&!ve||N&&Tt&&qt||!T&&qt||!W)return 1;if(!N&&!ht&&!ve&&c<g||ve&&T&&W&&!N&&!ht||It&&T&&W||!Tt&&W||!qt)return-1}return 0}function Dn(c,g,T,N){for(var W=-1,ht=c.length,Tt=T.length,It=-1,qt=g.length,ve=ci(ht-Tt,0),le=sn(qt+ve),Ne=!N;++It<qt;)le[It]=g[It];for(;++W<Tt;)(Ne||W<ht)&&(le[T[W]]=c[W]);for(;ve--;)le[It++]=c[W++];return le}function xc(c,g,T,N){for(var W=-1,ht=c.length,Tt=-1,It=T.length,qt=-1,ve=g.length,le=ci(ht-It,0),Ne=sn(le+ve),yn=!N;++W<le;)Ne[W]=c[W];for(var xn=W;++qt<ve;)Ne[xn+qt]=g[qt];for(;++Tt<It;)(yn||W<ht)&&(Ne[xn+T[Tt]]=c[W++]);return Ne}function Di(c,g){var T=-1,N=c.length;for(g||(g=sn(N));++T<N;)g[T]=c[T];return g}function as(c,g,T,N){var W=!T;T||(T={});for(var ht=-1,Tt=g.length;++ht<Tt;){var It=g[ht],qt=N?N(T[It],c[It],It,T,c):void 0;qt===void 0&&(qt=c[It]),W?Wo(T,It,qt):zi(T,It,qt)}return T}function Ps(c,g){return function(T,N){var W=cr(T)?pf:Ss,ht=g?g():{};return W(T,c,Vn(N,2),ht)}}function wi(c){return br(function(g,T){var N=-1,W=T.length,ht=W>1?T[W-1]:void 0,Tt=W>2?T[2]:void 0;for(ht=c.length>3&&typeof ht=="function"?(W--,ht):void 0,Tt&&vo(T[0],T[1],Tt)&&(ht=W<3?void 0:ht,W=1),g=On(g);++N<W;){var It=T[N];It&&c(g,It,N,ht)}return g})}function Ys(c,g){return function(T,N){if(T==null)return T;if(!Yo(T))return c(T,N);for(var W=T.length,ht=g?W:-1,Tt=On(T);(g?ht--:++ht<W)&&N(Tt[ht],ht,Tt)!==!1;);return T}}function bc(c){return function(g,T,N){for(var W=-1,ht=On(g),Tt=N(g),It=Tt.length;It--;){var qt=Tt[c?It:++W];if(T(ht[qt],qt,ht)===!1)break}return g}}function wc(c){return function(g){var T=ks(g=Dr(g))?Gs(g):void 0,N=T?T[0]:g.charAt(0),W=T?Vr(T,1).join(""):g.slice(1);return N[c]()+W}}function fu(c){return function(g){return ah($d(Bc(g).replace(Ge,"")),c,"")}}function pu(c){return function(){var g=arguments;switch(g.length){case 0:return new c;case 1:return new c(g[0]);case 2:return new c(g[0],g[1]);case 3:return new c(g[0],g[1],g[2]);case 4:return new c(g[0],g[1],g[2],g[3]);case 5:return new c(g[0],g[1],g[2],g[3],g[4]);case 6:return new c(g[0],g[1],g[2],g[3],g[4],g[5]);case 7:return new c(g[0],g[1],g[2],g[3],g[4],g[5],g[6])}var T=xs(c.prototype),N=c.apply(T,g);return Ti(N)?N:T}}function bh(c){return function(g,T,N){var W=On(g);if(!Yo(g)){var ht=Vn(T,3);g=di(g),T=function(It){return ht(W[It],It,W)}}var Tt=c(g,T,N);return Tt>-1?W[ht?g[Tt]:Tt]:void 0}}function wh(c){return Rs(function(g){var T=g.length,N=T,W=qi.prototype.thru;for(c&&g.reverse();N--;){var ht=g[N];if(typeof ht!="function")throw new pi(ot);if(W&&!Tt&&us(ht)=="wrapper")var Tt=new qi([],!0)}for(N=Tt?N:T;++N<T;){var It=us(ht=g[N]),qt=It=="wrapper"?Cd(ht):void 0;Tt=qt&&Mh(qt[0])&&qt[1]==424&&!qt[4].length&&qt[9]==1?Tt[us(qt[0])].apply(Tt,qt[3]):ht.length==1&&Mh(ht)?Tt[It]():Tt.thru(ht)}return function(){var ve=arguments,le=ve[0];if(Tt&&ve.length==1&&cr(le))return Tt.plant(le).value();for(var Ne=0,yn=T?g[Ne].apply(this,ve):le;++Ne<T;)yn=g[Ne].call(this,yn);return yn}})}function Bu(c,g,T,N,W,ht,Tt,It,qt,ve){var le=128&g,Ne=1&g,yn=2&g,xn=24&g,Bn=512&g,Me=yn?void 0:pu(c);return function qe(){for(var Qn=arguments.length,_n=sn(Qn),qn=Qn;qn--;)_n[qn]=arguments[qn];if(xn)var Cn=ls(qe),fr=Wi(_n,Cn);if(N&&(_n=Dn(_n,N,W,xn)),ht&&(_n=xc(_n,ht,Tt,xn)),Qn-=fr,xn&&Qn<ve){var Mn=Go(_n,Cn);return fa(c,g,Bu,qe.placeholder,T,_n,Mn,It,qt,ve-Qn)}var Wn=Ne?T:this,Fi=yn?Wn[c]:c;return Qn=_n.length,It?_n=xf(_n,It):Bn&&Qn>1&&_n.reverse(),le&&qt<Qn&&(_n.length=qt),this&&this!==jr&&this instanceof qe&&(Fi=Me||pu(Fi)),Fi.apply(Wn,_n)}}function Sh(c,g){return function(T,N){return function(W,ht,Tt,It){return Xo(W,function(qt,ve,le){ht(It,Tt(qt),ve,le)}),It}(T,c,g(N),{})}}function Uu(c,g){return function(T,N){var W;if(T===void 0&&N===void 0)return g;if(T!==void 0&&(W=T),N!==void 0){if(W===void 0)return N;typeof T=="string"||typeof N=="string"?(T=Lo(T),N=Lo(N)):(T=zn(T),N=zn(N)),W=c(T,N)}return W}}function Da(c){return Rs(function(g){return g=Ln(g,Mo(Vn())),br(function(T){var N=this;return c(g,function(W){return yo(W,N,T)})})})}function Cs(c,g){var T=(g=g===void 0?" ":Lo(g)).length;if(T<2)return T?ji(g,c):g;var N=ji(g,Ra(c/ra(g)));return ks(g)?Vr(Gs(N),0,c).join(""):N.slice(0,c)}function mi(c){return function(g,T,N){return N&&typeof N!="number"&&vo(g,T,N)&&(T=N=void 0),g=fs(g),T===void 0?(T=g,g=0):T=fs(T),function(W,ht,Tt,It){for(var qt=-1,ve=ci(Ra((ht-W)/(Tt||1)),0),le=sn(ve);ve--;)le[It?ve:++qt]=W,W+=Tt;return le}(g,T,N=N===void 0?g<T?1:-1:fs(N),c)}}function ku(c){return function(g,T){return typeof g=="string"&&typeof T=="string"||(g=ps(g),T=ps(T)),c(g,T)}}function fa(c,g,T,N,W,ht,Tt,It,qt,ve){var le=8&g;g|=le?32:64,4&(g&=~(le?64:32))||(g&=-4);var Ne=[c,g,W,le?ht:void 0,le?Tt:void 0,le?void 0:ht,le?void 0:Tt,It,qt,ve],yn=T.apply(void 0,Ne);return Mh(c)&&Dl(yn,Ne),yn.placeholder=N,Dd(yn,c,g)}function Na(c){var g=Hs[c];return function(T,N){if(T=ps(T),(N=N==null?0:Ji(dr(N),292))&&Hi(T)){var W=(Dr(T)+"e").split("e");return+((W=(Dr(g(W[0]+"e"+(+W[1]+N)))+"e").split("e"))[0]+"e"+(+W[1]-N))}return g(T)}}var mo=ii&&1/iu(new ii([,-0]))[1]==1/0?function(c){return new ii(c)}:kh;function Ad(c){return function(g){var T=ze(g);return T==B?ri(g):T==Y?sc(g):function(N,W){return Ln(W,function(ht){return[ht,N[ht]]})}(g,c(g))}}function go(c,g,T,N,W,ht,Tt,It){var qt=2&g;if(!qt&&typeof c!="function")throw new pi(ot);var ve=N?N.length:0;if(ve||(g&=-97,N=W=void 0),Tt=Tt===void 0?Tt:ci(dr(Tt),0),It=It===void 0?It:dr(It),ve-=W?W.length:0,64&g){var le=N,Ne=W;N=W=void 0}var yn=qt?void 0:Cd(c),xn=[c,g,T,N,W,le,Ne,ht,Tt,It];if(yn&&function(Me,qe){var Qn=Me[1],_n=qe[1],qn=Qn|_n,Cn=qn<131,fr=_n==128&&Qn==8||_n==128&&Qn==256&&Me[7].length<=qe[8]||_n==384&&qe[7].length<=qe[8]&&Qn==8;if(!Cn&&!fr)return Me;1&_n&&(Me[2]=qe[2],qn|=1&Qn?0:4);var Mn=qe[3];if(Mn){var Wn=Me[3];Me[3]=Wn?Dn(Wn,Mn,qe[4]):Mn,Me[4]=Wn?Go(Me[3],X):qe[4]}(Mn=qe[5])&&(Wn=Me[5],Me[5]=Wn?xc(Wn,Mn,qe[6]):Mn,Me[6]=Wn?Go(Me[5],X):qe[6]),(Mn=qe[7])&&(Me[7]=Mn),128&_n&&(Me[8]=Me[8]==null?qe[8]:Ji(Me[8],qe[8])),Me[9]==null&&(Me[9]=qe[9]),Me[0]=qe[0],Me[1]=qn}(xn,yn),c=xn[0],g=xn[1],T=xn[2],N=xn[3],W=xn[4],!(It=xn[9]=xn[9]===void 0?qt?0:c.length:ci(xn[9]-ve,0))&&24&g&&(g&=-25),g&&g!=1)Bn=g==8||g==16?function(Me,qe,Qn){var _n=pu(Me);return function qn(){for(var Cn=arguments.length,fr=sn(Cn),Mn=Cn,Wn=ls(qn);Mn--;)fr[Mn]=arguments[Mn];var Fi=Cn<3&&fr[0]!==Wn&&fr[Cn-1]!==Wn?[]:Go(fr,Wn);if((Cn-=Fi.length)<Qn)return fa(Me,qe,Bu,qn.placeholder,void 0,fr,Fi,void 0,void 0,Qn-Cn);var gi=this&&this!==jr&&this instanceof qn?_n:Me;return yo(gi,this,fr)}}(c,g,It):g!=32&&g!=33||W.length?Bu.apply(void 0,xn):function(Me,qe,Qn,_n){var qn=1&qe,Cn=pu(Me);return function fr(){for(var Mn=-1,Wn=arguments.length,Fi=-1,gi=_n.length,Ns=sn(gi+Wn),Mi=this&&this!==jr&&this instanceof fr?Cn:Me;++Fi<gi;)Ns[Fi]=_n[Fi];for(;Wn--;)Ns[Fi++]=arguments[++Mn];return yo(Mi,qn?Qn:this,Ns)}}(c,g,T,N);else var Bn=function(Me,qe,Qn){var _n=1&qe,qn=pu(Me);return function Cn(){var fr=this&&this!==jr&&this instanceof Cn?qn:Me;return fr.apply(_n?Qn:this,arguments)}}(c,g,T);return Dd((yn?_c:Dl)(Bn,xn),c,g)}function Ol(c,g,T,N){return c===void 0||Oo(c,Ca[T])&&!Hr.call(N,T)?g:c}function to(c,g,T,N,W,ht){return Ti(c)&&Ti(g)&&(ht.set(g,c),ca(c,g,void 0,to,ht),ht.delete(g)),c}function Sc(c){return qu(c)?void 0:c}function Gu(c,g,T,N,W,ht){var Tt=1&T,It=c.length,qt=g.length;if(It!=qt&&!(Tt&&qt>It))return!1;var ve=ht.get(c),le=ht.get(g);if(ve&&le)return ve==g&&le==c;var Ne=-1,yn=!0,xn=2&T?new aa:void 0;for(ht.set(c,g),ht.set(g,c);++Ne<It;){var Bn=c[Ne],Me=g[Ne];if(N)var qe=Tt?N(Me,Bn,Ne,g,c,ht):N(Bn,Me,Ne,c,g,ht);if(qe!==void 0){if(qe)continue;yn=!1;break}if(xn){if(!xl(g,function(Qn,_n){if(!ni(xn,_n)&&(Bn===Qn||W(Bn,Qn,T,N,ht)))return xn.push(_n)})){yn=!1;break}}else if(Bn!==Me&&!W(Bn,Me,T,N,ht)){yn=!1;break}}return ht.delete(c),ht.delete(g),yn}function Rs(c){return Nl(Ah(c,void 0,Ec),c+"")}function Th(c){return pc(c,di,pa)}function Pd(c){return pc(c,so,nr)}var Cd=Po?function(c){return Po.get(c)}:kh;function us(c){for(var g=c.name+"",T=Ia[g],N=Hr.call(Ia,g)?T.length:0;N--;){var W=T[N],ht=W.func;if(ht==null||ht==c)return W.name}return g}function ls(c){return(Hr.call(nt,"placeholder")?nt:c).placeholder}function Vn(){var c=nt.iteratee||ga;return c=c===ga?gc:c,arguments.length?c(arguments[0],arguments[1]):c}function Fa(c,g){var T,N,W=c.__data__;return((N=typeof(T=g))=="string"||N=="number"||N=="symbol"||N=="boolean"?T!=="__proto__":T===null)?W[typeof g=="string"?"string":"hash"]:W.map}function Eh(c){for(var g=di(c),T=g.length;T--;){var N=g[T],W=c[N];g[T]=[N,W,Ld(W)]}return g}function mu(c,g){var T=function(N,W){return N==null?void 0:N[W]}(c,g);return mc(T)?T:void 0}var pa=zo?function(c){return c==null?[]:(c=On(c),ns(zo(c),function(g){return gf.call(c,g)}))}:nl,nr=zo?function(c){for(var g=[];c;)na(g,pa(c)),c=ch(c);return g}:nl,ze=Zr;function Is(c,g,T){for(var N=-1,W=(g=Xn(g,c)).length,ht=!1;++N<W;){var Tt=hs(g[N]);if(!(ht=c!=null&&T(c,Tt)))break;c=c[Tt]}return ht||++N!=W?ht:!!(W=c==null?0:c.length)&&Dh(W)&&qo(Tt,W)&&(cr(c)||Ds(c))}function Rd(c){return typeof c.constructor!="function"||Hu(c)?{}:xs(ch(c))}function yf(c){return cr(c)||Ds(c)||!!(_d&&c&&c[_d])}function qo(c,g){var T=typeof c;return!!(g=g==null?9007199254740991:g)&&(T=="number"||T!="symbol"&&K.test(c))&&c>-1&&c%1==0&&c<g}function vo(c,g,T){if(!Ti(T))return!1;var N=typeof g;return!!(N=="number"?Yo(T)&&qo(g,T.length):N=="string"&&g in T)&&Oo(T[g],c)}function Tc(c,g){if(cr(c))return!1;var T=typeof c;return!(T!="number"&&T!="symbol"&&T!="boolean"&&c!=null&&!Zo(c))||Lr.test(c)||!Cr.test(c)||g!=null&&c in On(g)}function Mh(c){var g=us(c),T=nt[g];if(typeof T!="function"||!(g in lr.prototype))return!1;if(c===T)return!0;var N=Cd(T);return!!N&&c===N[0]}(oa&&ze(new oa(new ArrayBuffer(1)))!=ee||zs&&ze(new zs)!=B||ph&&ze(ph.resolve())!="[object Promise]"||ii&&ze(new ii)!=Y||su&&ze(new su)!=se)&&(ze=function(c){var g=Zr(c),T=g==ut?c.constructor:void 0,N=T?Os(T):"";if(N)switch(N){case dc:return ee;case Xi:return B;case mt:return"[object Promise]";case Cu:return Y;case bd:return se}return g});var Id=Ml?Do:Hc;function Hu(c){var g=c&&c.constructor;return c===(typeof g=="function"&&g.prototype||Ca)}function Ld(c){return c==c&&!Ti(c)}function zu(c,g){return function(T){return T!=null&&T[c]===g&&(g!==void 0||c in On(T))}}function Ah(c,g,T){return g=ci(g===void 0?c.length-1:g,0),function(){for(var N=arguments,W=-1,ht=ci(N.length-g,0),Tt=sn(ht);++W<ht;)Tt[W]=N[g+W];W=-1;for(var It=sn(g+1);++W<g;)It[W]=N[W];return It[g]=T(Tt),yo(c,this,It)}}function Od(c,g){return g.length<2?c:La(c,Vi(g,0,-1))}function xf(c,g){for(var T=c.length,N=Ji(g.length,T),W=Di(c);N--;){var ht=g[N];c[N]=qo(ht,T)?W[ht]:void 0}return c}function gu(c,g){if((g!=="constructor"||typeof c[g]!="function")&&g!="__proto__")return c[g]}var Dl=Nd(_c),Ls=io||function(c,g){return jr.setTimeout(c,g)},Nl=Nd(Td);function Dd(c,g,T){var N=g+"";return Nl(c,function(W,ht){var Tt=ht.length;if(!Tt)return W;var It=Tt-1;return ht[It]=(Tt>1?"& ":"")+ht[It],ht=ht.join(Tt>2?", ":" "),W.replace(Or,`{
/* [wrapped with `+ht+`] */
`)}(N,function(W,ht){return ko(ft,function(Tt){var It="_."+Tt[0];ht&Tt[1]&&!_l(W,It)&&W.push(It)}),W.sort()}(function(W){var ht=W.match(Er);return ht?ht[1].split(Fr):[]}(N),T)))}function Nd(c){var g=0,T=0;return function(){var N=xd(),W=16-(N-T);if(T=N,W>0){if(++g>=800)return arguments[0]}else g=0;return c.apply(void 0,arguments)}}function Fl(c,g){var T=-1,N=c.length,W=N-1;for(g=g===void 0?N:g;++T<g;){var ht=Sd(T,W),Tt=c[ht];c[ht]=c[T],c[T]=Tt}return c.length=g,c}var Bl=function(c){var g=Gl(c,function(N){return T.size===500&&T.clear(),N}),T=g.cache;return g}(function(c){var g=[];return c.charCodeAt(0)===46&&g.push(""),c.replace(Rr,function(T,N,W,ht){g.push(W?ht.replace(Fn,"$1"):N||T)}),g});function hs(c){if(typeof c=="string"||Zo(c))return c;var g=c+"";return g=="0"&&1/c==-1/0?"-0":g}function Os(c){if(c!=null){try{return Au.call(c)}catch{}try{return c+""}catch{}}return""}function Ph(c){if(c instanceof lr)return c.clone();var g=new qi(c.__wrapped__,c.__chain__);return g.__actions__=Di(c.__actions__),g.__index__=c.__index__,g.__values__=c.__values__,g}var ju=br(function(c,g){return Si(c)?Tn(c,Li(g,1,Si,!0)):[]}),Ul=br(function(c,g){var T=wo(g);return Si(T)&&(T=void 0),Si(c)?Tn(c,Li(g,1,Si,!0),Vn(T,2)):[]}),bo=br(function(c,g){var T=wo(g);return Si(T)&&(T=void 0),Si(c)?Tn(c,Li(g,1,Si,!0),void 0,T):[]});function oo(c,g,T){var N=c==null?0:c.length;if(!N)return-1;var W=T==null?0:dr(T);return W<0&&(W=ci(N+W,0)),li(c,Vn(g,3),W)}function Fd(c,g,T){var N=c==null?0:c.length;if(!N)return-1;var W=N-1;return T!==void 0&&(W=dr(T),W=T<0?ci(N+W,0):Ji(W,N-1)),li(c,Vn(g,3),W,!0)}function Ec(c){return(c==null?0:c.length)?Li(c,1):[]}function cs(c){return c&&c.length?c[0]:void 0}var lp=br(function(c){var g=Ln(c,ss);return g.length&&g[0]===c[0]?Cl(g):[]}),bf=br(function(c){var g=wo(c),T=Ln(c,ss);return g===wo(T)?g=void 0:T.pop(),T.length&&T[0]===c[0]?Cl(T,Vn(g,2)):[]}),kl=br(function(c){var g=wo(c),T=Ln(c,ss);return(g=typeof g=="function"?g:void 0)&&T.pop(),T.length&&T[0]===c[0]?Cl(T,void 0,g):[]});function wo(c){var g=c==null?0:c.length;return g?c[g-1]:void 0}var hp=br(oi);function oi(c,g){return c&&c.length&&g&&g.length?Il(c,g):c}var wf=Rs(function(c,g){var T=c==null?0:c.length,N=js(c,g);return bi(c,Ln(g,function(W){return qo(W,T)?+W:W}).sort(Oi)),N});function Ch(c){return c==null?c:$i.call(c)}var cp=br(function(c){return Xs(Li(c,1,Si,!0))}),Vu=br(function(c){var g=wo(c);return Si(g)&&(g=void 0),Xs(Li(c,1,Si,!0),Vn(g,2))}),Sf=br(function(c){var g=wo(c);return g=typeof g=="function"?g:void 0,Xs(Li(c,1,Si,!0),void 0,g)});function Rh(c){if(!c||!c.length)return[];var g=0;return c=ns(c,function(T){if(Si(T))return g=ci(T.length,g),!0}),Sl(g,function(T){return Ln(c,bl(T))})}function Mc(c,g){if(!c||!c.length)return[];var T=Rh(c);return g==null?T:Ln(T,function(N){return yo(g,void 0,N)})}var ds=br(function(c,g){return Si(c)?Tn(c,g):[]}),Ac=br(function(c){return En(ns(c,Si))}),dp=br(function(c){var g=wo(c);return Si(g)&&(g=void 0),En(ns(c,Si),Vn(g,2))}),Pc=br(function(c){var g=wo(c);return g=typeof g=="function"?g:void 0,En(ns(c,Si),void 0,g)}),Tf=br(Rh),Ef=br(function(c){var g=c.length,T=g>1?c[g-1]:void 0;return T=typeof T=="function"?(c.pop(),T):void 0,Mc(c,T)});function Mf(c){var g=nt(c);return g.__chain__=!0,g}function Cc(c,g){return g(c)}var fp=Rs(function(c){var g=c.length,T=g?c[0]:0,N=this.__wrapped__,W=function(ht){return js(ht,c)};return!(g>1||this.__actions__.length)&&N instanceof lr&&qo(T)?((N=N.slice(T,+T+(g?1:0))).__actions__.push({func:Cc,args:[W],thisArg:void 0}),new qi(N,this.__chain__).thru(function(ht){return g&&!ht.length&&ht.push(void 0),ht})):this.thru(W)}),pp=Ps(function(c,g,T){Hr.call(c,T)?++c[T]:Wo(c,T,1)}),mp=bh(oo),gp=bh(Fd);function Af(c,g){return(cr(c)?ko:Io)(c,Vn(g,3))}function Bd(c,g){return(cr(c)?vl:Ts)(c,Vn(g,3))}var Pf=Ps(function(c,g,T){Hr.call(c,T)?c[T].push(g):Wo(c,T,[g])}),vp=br(function(c,g,T){var N=-1,W=typeof g=="function",ht=Yo(c)?sn(c.length):[];return Io(c,function(Tt){ht[++N]=W?yo(g,Tt,T):uu(Tt,g,T)}),ht}),_p=Ps(function(c,g,T){Wo(c,T,g)});function Ih(c,g){return(cr(c)?Ln:xh)(c,Vn(g,3))}var yp=Ps(function(c,g,T){c[T?0:1].push(g)},function(){return[[],[]]}),Ud=br(function(c,g){if(c==null)return[];var T=g.length;return T>1&&vo(c,g[0],g[1])?g=[]:T>2&&vo(g[0],g[1],g[2])&&(g=[g[0]]),lu(c,Li(g,1),[])}),Lh=Ho||function(){return jr.Date.now()};function kd(c,g,T){return g=T?void 0:g,go(c,128,void 0,void 0,void 0,void 0,g=c&&g==null?c.length:g)}function Rc(c,g){var T;if(typeof g!="function")throw new pi(ot);return c=dr(c),function(){return--c>0&&(T=g.apply(this,arguments)),c<=1&&(g=void 0),T}}var vu=br(function(c,g,T){var N=1;if(T.length){var W=Go(T,ls(vu));N|=32}return go(c,N,g,T,W)}),Ic=br(function(c,g,T){var N=3;if(T.length){var W=Go(T,ls(Ic));N|=32}return go(g,N,c,T,W)});function Lc(c,g,T){var N,W,ht,Tt,It,qt,ve=0,le=!1,Ne=!1,yn=!0;if(typeof c!="function")throw new pi(ot);function xn(qn){var Cn=N,fr=W;return N=W=void 0,ve=qn,Tt=c.apply(fr,Cn)}function Bn(qn){return ve=qn,It=Ls(qe,g),le?xn(qn):Tt}function Me(qn){var Cn=qn-qt;return qt===void 0||Cn>=g||Cn<0||Ne&&qn-ve>=ht}function qe(){var qn=Lh();if(Me(qn))return Qn(qn);It=Ls(qe,function(Cn){var fr=g-(Cn-qt);return Ne?Ji(fr,ht-(Cn-ve)):fr}(qn))}function Qn(qn){return It=void 0,yn&&N?xn(qn):(N=W=void 0,Tt)}function _n(){var qn=Lh(),Cn=Me(qn);if(N=arguments,W=this,qt=qn,Cn){if(It===void 0)return Bn(qt);if(Ne)return cu(It),It=Ls(qe,g),xn(qt)}return It===void 0&&(It=Ls(qe,g)),Tt}return g=ps(g)||0,Ti(T)&&(le=!!T.leading,ht=(Ne="maxWait"in T)?ci(ps(T.maxWait)||0,g):ht,yn="trailing"in T?!!T.trailing:yn),_n.cancel=function(){It!==void 0&&cu(It),ve=0,N=qt=W=It=void 0},_n.flush=function(){return It===void 0?Tt:Qn(Lh())},_n}var Oc=br(function(c,g){return Ro(c,1,g)}),Ba=br(function(c,g,T){return Ro(c,ps(g)||0,T)});function Gl(c,g){if(typeof c!="function"||g!=null&&typeof g!="function")throw new pi(ot);var T=function(){var N=arguments,W=g?g.apply(this,N):N[0],ht=T.cache;if(ht.has(W))return ht.get(W);var Tt=c.apply(this,N);return T.cache=ht.set(W,Tt)||ht,Tt};return T.cache=new(Gl.Cache||os),T}function Hl(c){if(typeof c!="function")throw new pi(ot);return function(){var g=arguments;switch(g.length){case 0:return!c.call(this);case 1:return!c.call(this,g[0]);case 2:return!c.call(this,g[0],g[1]);case 3:return!c.call(this,g[0],g[1],g[2])}return!c.apply(this,g)}}Gl.Cache=os;var Gd=_f(function(c,g){var T=(g=g.length==1&&cr(g[0])?Ln(g[0],Mo(Vn())):Ln(Li(g,1),Mo(Vn()))).length;return br(function(N){for(var W=-1,ht=Ji(N.length,T);++W<ht;)N[W]=g[W].call(this,N[W]);return yo(c,this,N)})}),zl=br(function(c,g){return go(c,32,void 0,g,Go(g,ls(zl)))}),Wu=br(function(c,g){return go(c,64,void 0,g,Go(g,ls(Wu)))}),Xu=Rs(function(c,g){return go(c,256,void 0,void 0,void 0,g)});function Oo(c,g){return c===g||c!=c&&g!=g}var Ua=ku(Es),Hd=ku(function(c,g){return c>=g}),Ds=Rl(function(){return arguments}())?Rl:function(c){return Ei(c)&&Hr.call(c,"callee")&&!gf.call(c,"callee")},cr=sn.isArray,Oh=Eo?Mo(Eo):function(c){return Ei(c)&&Zr(c)==Le};function Yo(c){return c!=null&&Dh(c.length)&&!Do(c)}function Si(c){return Ei(c)&&Yo(c)}var ka=jo||Hc,zd=rc?Mo(rc):function(c){return Ei(c)&&Zr(c)==Ft};function jd(c){if(!Ei(c))return!1;var g=Zr(c);return g==jt||g=="[object DOMException]"||typeof c.message=="string"&&typeof c.name=="string"&&!qu(c)}function Do(c){if(!Ti(c))return!1;var g=Zr(c);return g==kt||g==I||g=="[object AsyncFunction]"||g=="[object Proxy]"}function Dc(c){return typeof c=="number"&&c==dr(c)}function Dh(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=9007199254740991}function Ti(c){var g=typeof c;return c!=null&&(g=="object"||g=="function")}function Ei(c){return c!=null&&typeof c=="object"}var Vd=ic?Mo(ic):function(c){return Ei(c)&&ze(c)==B};function Wd(c){return typeof c=="number"||Ei(c)&&Zr(c)==V}function qu(c){if(!Ei(c)||Zr(c)!=ut)return!1;var g=ch(c);if(g===null)return!0;var T=Hr.call(g,"constructor")&&g.constructor;return typeof T=="function"&&T instanceof T&&Au.call(T)==uc}var Nc=gl?Mo(gl):function(c){return Ei(c)&&Zr(c)==F},Xd=oc?Mo(oc):function(c){return Ei(c)&&ze(c)==Y};function Nh(c){return typeof c=="string"||!cr(c)&&Ei(c)&&Zr(c)==$}function Zo(c){return typeof c=="symbol"||Ei(c)&&Zr(c)==ct}var Yu=Su?Mo(Su):function(c){return Ei(c)&&Dh(c.length)&&!!ln[Zr(c)]},qd=ku(As),Cf=ku(function(c,g){return c<=g});function jl(c){if(!c)return[];if(Yo(c))return Nh(c)?Gs(c):Di(c);if(dh&&c[dh])return function(T){for(var N,W=[];!(N=T.next()).done;)W.push(N.value);return W}(c[dh]());var g=ze(c);return(g==B?ri:g==Y?iu:ma)(c)}function fs(c){return c?(c=ps(c))===1/0||c===-1/0?17976931348623157e292*(c<0?-1:1):c==c?c:0:c===0?c:0}function dr(c){var g=fs(c),T=g%1;return g==g?T?g-T:g:0}function Yd(c){return c?Vs(dr(c),0,4294967295):0}function ps(c){if(typeof c=="number")return c;if(Zo(c))return NaN;if(Ti(c)){var g=typeof c.valueOf=="function"?c.valueOf():c;c=Ti(g)?g+"":g}if(typeof c!="string")return c===0?c:+c;c=Tu(c);var T=k.test(c);return T||st.test(c)?ar(c.slice(2),T?2:8):L.test(c)?NaN:+c}function Fc(c){return as(c,so(c))}function Dr(c){return c==null?"":Lo(c)}var Zs=wi(function(c,g){if(Hu(g)||Yo(g))as(g,di(g),c);else for(var T in g)Hr.call(g,T)&&zi(c,T,g[T])}),Zd=wi(function(c,g){as(g,so(g),c)}),Zu=wi(function(c,g,T,N){as(g,so(g),c,N)}),Rf=wi(function(c,g,T,N){as(g,di(g),c,N)}),If=Rs(js),Jr=br(function(c,g){c=On(c);var T=-1,N=g.length,W=N>2?g[2]:void 0;for(W&&vo(g[0],g[1],W)&&(N=1);++T<N;)for(var ht=g[T],Tt=so(ht),It=-1,qt=Tt.length;++It<qt;){var ve=Tt[It],le=c[ve];(le===void 0||Oo(le,Ca[ve])&&!Hr.call(c,ve))&&(c[ve]=ht[ve])}return c}),Lf=br(function(c){return c.push(void 0,to),yo($u,void 0,c)});function Ga(c,g,T){var N=c==null?void 0:La(c,g);return N===void 0?T:N}function Ju(c,g){return c!=null&&Is(c,g,Lu)}var Fh=Sh(function(c,g,T){g!=null&&typeof g.toString!="function"&&(g=ac.call(g)),c[g]=T},Qd(Yi)),Ha=Sh(function(c,g,T){g!=null&&typeof g.toString!="function"&&(g=ac.call(g)),Hr.call(c,g)?c[g].push(T):c[g]=[T]},Vn),Ni=br(uu);function di(c){return Yo(c)?au(c):vr(c)}function so(c){return Yo(c)?au(c,!0):Ms(c)}var Vl=wi(function(c,g,T){ca(c,g,T)}),$u=wi(function(c,g,T,N){ca(c,g,T,N)}),Wl=Rs(function(c,g){var T={};if(c==null)return T;var N=!1;g=Ln(g,function(ht){return ht=Xn(ht,c),N||(N=ht.length>1),ht}),as(c,Pd(c),T),N&&(T=fo(T,7,Sc));for(var W=g.length;W--;)Nu(T,g[W]);return T}),Ku=Rs(function(c,g){return c==null?{}:function(T,N){return vc(T,N,function(W,ht){return Ju(T,ht)})}(c,g)});function Qu(c,g){if(c==null)return{};var T=Ln(Pd(c),function(N){return[N]});return g=Vn(g),vc(c,T,function(N,W){return g(N,W[0])})}var tl=Ad(di),_u=Ad(so);function ma(c){return c==null?[]:Tl(c,di(c))}var Xl=fu(function(c,g,T){return g=g.toLowerCase(),c+(T?Bh(g):g)});function Bh(c){return kc(Dr(c).toLowerCase())}function Bc(c){return(c=Dr(c))&&c.replace(et,dd).replace(Qe,"")}var Jd=fu(function(c,g,T){return c+(T?"-":"")+g.toLowerCase()}),Of=fu(function(c,g,T){return c+(T?" ":"")+g.toLowerCase()}),Uh=wc("toLowerCase"),ql=fu(function(c,g,T){return c+(T?"_":"")+g.toLowerCase()}),Uc=fu(function(c,g,T){return c+(T?" ":"")+kc(g)}),Yl=fu(function(c,g,T){return c+(T?" ":"")+g.toUpperCase()}),kc=wc("toUpperCase");function $d(c,g,T){return c=Dr(c),(g=T?void 0:g)===void 0?function(N){return Pn.test(N)}(c)?function(N){return N.match(jn)||[]}(c):function(N){return N.match(lo)||[]}(c):c.match(g)||[]}var Kd=br(function(c,g){try{return yo(c,void 0,g)}catch(T){return jd(T)?T:new pr(T)}}),Df=Rs(function(c,g){return ko(g,function(T){T=hs(T),Wo(c,T,vu(c[T],c))}),c});function Qd(c){return function(){return c}}var Gc=wh(),el=wh(!0);function Yi(c){return c}function ga(c){return gc(typeof c=="function"?c:fo(c,1))}var Js=br(function(c,g){return function(T){return uu(T,c,g)}}),Nf=br(function(c,g){return function(T){return uu(c,T,g)}});function za(c,g,T){var N=di(g),W=Iu(g,N);T!=null||Ti(g)&&(W.length||!N.length)||(T=g,g=c,c=this,W=Iu(g,di(g)));var ht=!(Ti(T)&&"chain"in T&&!T.chain),Tt=Do(c);return ko(W,function(It){var qt=g[It];c[It]=qt,Tt&&(c.prototype[It]=function(){var ve=this.__chain__;if(ht||ve){var le=c(this.__wrapped__),Ne=le.__actions__=Di(this.__actions__);return Ne.push({func:qt,args:arguments,thisArg:c}),le.__chain__=ve,le}return qt.apply(c,na([this.value()],arguments))})}),c}function kh(){}var tf=Da(Ln),Gh=Da(fi),Zl=Da(xl);function Hh(c){return Tc(c)?bl(hs(c)):function(g){return function(T){return La(T,g)}}(c)}var ao=mi(),Ff=mi(!0);function nl(){return[]}function Hc(){return!1}var zh=Uu(function(c,g){return c+g},0),zc=Na("ceil"),ja=Uu(function(c,g){return c/g},1),Bf=Na("floor"),jc,Jo=Uu(function(c,g){return c*g},1),ef=Na("round"),rl=Uu(function(c,g){return c-g},0);return nt.after=function(c,g){if(typeof g!="function")throw new pi(ot);return c=dr(c),function(){if(--c<1)return g.apply(this,arguments)}},nt.ary=kd,nt.assign=Zs,nt.assignIn=Zd,nt.assignInWith=Zu,nt.assignWith=Rf,nt.at=If,nt.before=Rc,nt.bind=vu,nt.bindAll=Df,nt.bindKey=Ic,nt.castArray=function(){if(!arguments.length)return[];var c=arguments[0];return cr(c)?c:[c]},nt.chain=Mf,nt.chunk=function(c,g,T){g=(T?vo(c,g,T):g===void 0)?1:ci(dr(g),0);var N=c==null?0:c.length;if(!N||g<1)return[];for(var W=0,ht=0,Tt=sn(Ra(N/g));W<N;)Tt[ht++]=Vi(c,W,W+=g);return Tt},nt.compact=function(c){for(var g=-1,T=c==null?0:c.length,N=0,W=[];++g<T;){var ht=c[g];ht&&(W[N++]=ht)}return W},nt.concat=function(){var c=arguments.length;if(!c)return[];for(var g=sn(c-1),T=arguments[0],N=c;N--;)g[N-1]=arguments[N];return na(cr(T)?Di(T):[T],Li(g,1))},nt.cond=function(c){var g=c==null?0:c.length,T=Vn();return c=g?Ln(c,function(N){if(typeof N[1]!="function")throw new pi(ot);return[T(N[0]),N[1]]}):[],br(function(N){for(var W=-1;++W<g;){var ht=c[W];if(yo(ht[0],this,N))return yo(ht[1],this,N)}})},nt.conforms=function(c){return function(g){var T=di(g);return function(N){return Pl(N,g,T)}}(fo(c,1))},nt.constant=Qd,nt.countBy=pp,nt.create=function(c,g){var T=xs(c);return g==null?T:gh(T,g)},nt.curry=function c(g,T,N){var W=go(g,8,void 0,void 0,void 0,void 0,void 0,T=N?void 0:T);return W.placeholder=c.placeholder,W},nt.curryRight=function c(g,T,N){var W=go(g,16,void 0,void 0,void 0,void 0,void 0,T=N?void 0:T);return W.placeholder=c.placeholder,W},nt.debounce=Lc,nt.defaults=Jr,nt.defaultsDeep=Lf,nt.defer=Oc,nt.delay=Ba,nt.difference=ju,nt.differenceBy=Ul,nt.differenceWith=bo,nt.drop=function(c,g,T){var N=c==null?0:c.length;return N?Vi(c,(g=T||g===void 0?1:dr(g))<0?0:g,N):[]},nt.dropRight=function(c,g,T){var N=c==null?0:c.length;return N?Vi(c,0,(g=N-(g=T||g===void 0?1:dr(g)))<0?0:g):[]},nt.dropRightWhile=function(c,g){return c&&c.length?Fu(c,Vn(g,3),!0,!0):[]},nt.dropWhile=function(c,g){return c&&c.length?Fu(c,Vn(g,3),!0):[]},nt.fill=function(c,g,T,N){var W=c==null?0:c.length;return W?(T&&typeof T!="number"&&vo(c,g,T)&&(T=0,N=W),function(ht,Tt,It,qt){var ve=ht.length;for((It=dr(It))<0&&(It=-It>ve?0:ve+It),(qt=qt===void 0||qt>ve?ve:dr(qt))<0&&(qt+=ve),qt=It>qt?0:Yd(qt);It<qt;)ht[It++]=Tt;return ht}(c,g,T,N)):[]},nt.filter=function(c,g){return(cr(c)?ns:la)(c,Vn(g,3))},nt.flatMap=function(c,g){return Li(Ih(c,g),1)},nt.flatMapDeep=function(c,g){return Li(Ih(c,g),1/0)},nt.flatMapDepth=function(c,g,T){return T=T===void 0?1:dr(T),Li(Ih(c,g),T)},nt.flatten=Ec,nt.flattenDeep=function(c){return(c==null?0:c.length)?Li(c,1/0):[]},nt.flattenDepth=function(c,g){return(c==null?0:c.length)?Li(c,g=g===void 0?1:dr(g)):[]},nt.flip=function(c){return go(c,512)},nt.flow=Gc,nt.flowRight=el,nt.fromPairs=function(c){for(var g=-1,T=c==null?0:c.length,N={};++g<T;){var W=c[g];N[W[0]]=W[1]}return N},nt.functions=function(c){return c==null?[]:Iu(c,di(c))},nt.functionsIn=function(c){return c==null?[]:Iu(c,so(c))},nt.groupBy=Pf,nt.initial=function(c){return(c==null?0:c.length)?Vi(c,0,-1):[]},nt.intersection=lp,nt.intersectionBy=bf,nt.intersectionWith=kl,nt.invert=Fh,nt.invertBy=Ha,nt.invokeMap=vp,nt.iteratee=ga,nt.keyBy=_p,nt.keys=di,nt.keysIn=so,nt.map=Ih,nt.mapKeys=function(c,g){var T={};return g=Vn(g,3),Xo(c,function(N,W,ht){Wo(T,g(N,W,ht),N)}),T},nt.mapValues=function(c,g){var T={};return g=Vn(g,3),Xo(c,function(N,W,ht){Wo(T,W,g(N,W,ht))}),T},nt.matches=function(c){return ha(fo(c,1))},nt.matchesProperty=function(c,g){return Oa(c,fo(g,1))},nt.memoize=Gl,nt.merge=Vl,nt.mergeWith=$u,nt.method=Js,nt.methodOf=Nf,nt.mixin=za,nt.negate=Hl,nt.nthArg=function(c){return c=dr(c),br(function(g){return wd(g,c)})},nt.omit=Wl,nt.omitBy=function(c,g){return Qu(c,Hl(Vn(g)))},nt.once=function(c){return Rc(2,c)},nt.orderBy=function(c,g,T,N){return c==null?[]:(cr(g)||(g=g==null?[]:[g]),cr(T=N?void 0:T)||(T=T==null?[]:[T]),lu(c,g,T))},nt.over=tf,nt.overArgs=Gd,nt.overEvery=Gh,nt.overSome=Zl,nt.partial=zl,nt.partialRight=Wu,nt.partition=yp,nt.pick=Ku,nt.pickBy=Qu,nt.property=Hh,nt.propertyOf=function(c){return function(g){return c==null?void 0:La(c,g)}},nt.pull=hp,nt.pullAll=oi,nt.pullAllBy=function(c,g,T){return c&&c.length&&g&&g.length?Il(c,g,Vn(T,2)):c},nt.pullAllWith=function(c,g,T){return c&&c.length&&g&&g.length?Il(c,g,void 0,T):c},nt.pullAt=wf,nt.range=ao,nt.rangeRight=Ff,nt.rearg=Xu,nt.reject=function(c,g){return(cr(c)?ns:la)(c,Hl(Vn(g,3)))},nt.remove=function(c,g){var T=[];if(!c||!c.length)return T;var N=-1,W=[],ht=c.length;for(g=Vn(g,3);++N<ht;){var Tt=c[N];g(Tt,N,c)&&(T.push(Tt),W.push(N))}return bi(c,W),T},nt.rest=function(c,g){if(typeof c!="function")throw new pi(ot);return br(c,g=g===void 0?g:dr(g))},nt.reverse=Ch,nt.sampleSize=function(c,g,T){return g=(T?vo(c,g,T):g===void 0)?1:dr(g),(cr(c)?mh:da)(c,g)},nt.set=function(c,g,T){return c==null?c:hu(c,g,T)},nt.setWith=function(c,g,T,N){return N=typeof N=="function"?N:void 0,c==null?c:hu(c,g,T,N)},nt.shuffle=function(c){return(cr(c)?ua:pn)(c)},nt.slice=function(c,g,T){var N=c==null?0:c.length;return N?(T&&typeof T!="number"&&vo(c,g,T)?(g=0,T=N):(g=g==null?0:dr(g),T=T===void 0?N:dr(T)),Vi(c,g,T)):[]},nt.sortBy=Ud,nt.sortedUniq=function(c){return c&&c.length?Ed(c):[]},nt.sortedUniqBy=function(c,g){return c&&c.length?Ed(c,Vn(g,2)):[]},nt.split=function(c,g,T){return T&&typeof T!="number"&&vo(c,g,T)&&(g=T=void 0),(T=T===void 0?4294967295:T>>>0)?(c=Dr(c))&&(typeof g=="string"||g!=null&&!Nc(g))&&!(g=Lo(g))&&ks(c)?Vr(Gs(c),0,T):c.split(g,T):[]},nt.spread=function(c,g){if(typeof c!="function")throw new pi(ot);return g=g==null?0:ci(dr(g),0),br(function(T){var N=T[g],W=Vr(T,0,g);return N&&na(W,N),yo(c,this,W)})},nt.tail=function(c){var g=c==null?0:c.length;return g?Vi(c,1,g):[]},nt.take=function(c,g,T){return c&&c.length?Vi(c,0,(g=T||g===void 0?1:dr(g))<0?0:g):[]},nt.takeRight=function(c,g,T){var N=c==null?0:c.length;return N?Vi(c,(g=N-(g=T||g===void 0?1:dr(g)))<0?0:g,N):[]},nt.takeRightWhile=function(c,g){return c&&c.length?Fu(c,Vn(g,3),!1,!0):[]},nt.takeWhile=function(c,g){return c&&c.length?Fu(c,Vn(g,3)):[]},nt.tap=function(c,g){return g(c),c},nt.throttle=function(c,g,T){var N=!0,W=!0;if(typeof c!="function")throw new pi(ot);return Ti(T)&&(N="leading"in T?!!T.leading:N,W="trailing"in T?!!T.trailing:W),Lc(c,g,{leading:N,maxWait:g,trailing:W})},nt.thru=Cc,nt.toArray=jl,nt.toPairs=tl,nt.toPairsIn=_u,nt.toPath=function(c){return cr(c)?Ln(c,hs):Zo(c)?[c]:Di(Bl(Dr(c)))},nt.toPlainObject=Fc,nt.transform=function(c,g,T){var N=cr(c),W=N||ka(c)||Yu(c);if(g=Vn(g,4),T==null){var ht=c&&c.constructor;T=W?N?new ht:[]:Ti(c)&&Do(ht)?xs(ch(c)):{}}return(W?ko:Xo)(c,function(Tt,It,qt){return g(T,Tt,It,qt)}),T},nt.unary=function(c){return kd(c,1)},nt.union=cp,nt.unionBy=Vu,nt.unionWith=Sf,nt.uniq=function(c){return c&&c.length?Xs(c):[]},nt.uniqBy=function(c,g){return c&&c.length?Xs(c,Vn(g,2)):[]},nt.uniqWith=function(c,g){return g=typeof g=="function"?g:void 0,c&&c.length?Xs(c,void 0,g):[]},nt.unset=function(c,g){return c==null||Nu(c,g)},nt.unzip=Rh,nt.unzipWith=Mc,nt.update=function(c,g,T){return c==null?c:Md(c,g,qr(T))},nt.updateWith=function(c,g,T,N){return N=typeof N=="function"?N:void 0,c==null?c:Md(c,g,qr(T),N)},nt.values=ma,nt.valuesIn=function(c){return c==null?[]:Tl(c,so(c))},nt.without=ds,nt.words=$d,nt.wrap=function(c,g){return zl(qr(g),c)},nt.xor=Ac,nt.xorBy=dp,nt.xorWith=Pc,nt.zip=Tf,nt.zipObject=function(c,g){return yc(c||[],g||[],zi)},nt.zipObjectDeep=function(c,g){return yc(c||[],g||[],hu)},nt.zipWith=Ef,nt.entries=tl,nt.entriesIn=_u,nt.extend=Zd,nt.extendWith=Zu,za(nt,nt),nt.add=zh,nt.attempt=Kd,nt.camelCase=Xl,nt.capitalize=Bh,nt.ceil=zc,nt.clamp=function(c,g,T){return T===void 0&&(T=g,g=void 0),T!==void 0&&(T=(T=ps(T))==T?T:0),g!==void 0&&(g=(g=ps(g))==g?g:0),Vs(ps(c),g,T)},nt.clone=function(c){return fo(c,4)},nt.cloneDeep=function(c){return fo(c,5)},nt.cloneDeepWith=function(c,g){return fo(c,5,g=typeof g=="function"?g:void 0)},nt.cloneWith=function(c,g){return fo(c,4,g=typeof g=="function"?g:void 0)},nt.conformsTo=function(c,g){return g==null||Pl(c,g,di(g))},nt.deburr=Bc,nt.defaultTo=function(c,g){return c==null||c!=c?g:c},nt.divide=ja,nt.endsWith=function(c,g,T){c=Dr(c),g=Lo(g);var N=c.length,W=T=T===void 0?N:Vs(dr(T),0,N);return(T-=g.length)>=0&&c.slice(T,W)==g},nt.eq=Oo,nt.escape=function(c){return(c=Dr(c))&&Un.test(c)?c.replace(Zn,no):c},nt.escapeRegExp=function(c){return(c=Dr(c))&&Ar.test(c)?c.replace(Yr,"\\$&"):c},nt.every=function(c,g,T){var N=cr(c)?fi:vf;return T&&vo(c,g,T)&&(g=void 0),N(c,Vn(g,3))},nt.find=mp,nt.findIndex=oo,nt.findKey=function(c,g){return Ta(c,Vn(g,3),Xo)},nt.findLast=gp,nt.findLastIndex=Fd,nt.findLastKey=function(c,g){return Ta(c,Vn(g,3),Ws)},nt.floor=Bf,nt.forEach=Af,nt.forEachRight=Bd,nt.forIn=function(c,g){return c==null?c:po(c,Vn(g,3),so)},nt.forInRight=function(c,g){return c==null?c:vh(c,Vn(g,3),so)},nt.forOwn=function(c,g){return c&&Xo(c,Vn(g,3))},nt.forOwnRight=function(c,g){return c&&Ws(c,Vn(g,3))},nt.get=Ga,nt.gt=Ua,nt.gte=Hd,nt.has=function(c,g){return c!=null&&Is(c,g,_h)},nt.hasIn=Ju,nt.head=cs,nt.identity=Yi,nt.includes=function(c,g,T,N){c=Yo(c)?c:ma(c),T=T&&!N?dr(T):0;var W=c.length;return T<0&&(T=ci(W+T,0)),Nh(c)?T<=W&&c.indexOf(g,T)>-1:!!W&&rs(c,g,T)>-1},nt.indexOf=function(c,g,T){var N=c==null?0:c.length;if(!N)return-1;var W=T==null?0:dr(T);return W<0&&(W=ci(N+W,0)),rs(c,g,W)},nt.inRange=function(c,g,T){return g=fs(g),T===void 0?(T=g,g=0):T=fs(T),function(N,W,ht){return N>=Ji(W,ht)&&N<ci(W,ht)}(c=ps(c),g,T)},nt.invoke=Ni,nt.isArguments=Ds,nt.isArray=cr,nt.isArrayBuffer=Oh,nt.isArrayLike=Yo,nt.isArrayLikeObject=Si,nt.isBoolean=function(c){return c===!0||c===!1||Ei(c)&&Zr(c)==lt},nt.isBuffer=ka,nt.isDate=zd,nt.isElement=function(c){return Ei(c)&&c.nodeType===1&&!qu(c)},nt.isEmpty=function(c){if(c==null)return!0;if(Yo(c)&&(cr(c)||typeof c=="string"||typeof c.splice=="function"||ka(c)||Yu(c)||Ds(c)))return!c.length;var g=ze(c);if(g==B||g==Y)return!c.size;if(Hu(c))return!vr(c).length;for(var T in c)if(Hr.call(c,T))return!1;return!0},nt.isEqual=function(c,g){return Ou(c,g)},nt.isEqualWith=function(c,g,T){var N=(T=typeof T=="function"?T:void 0)?T(c,g):void 0;return N===void 0?Ou(c,g,void 0,T):!!N},nt.isError=jd,nt.isFinite=function(c){return typeof c=="number"&&Hi(c)},nt.isFunction=Do,nt.isInteger=Dc,nt.isLength=Dh,nt.isMap=Vd,nt.isMatch=function(c,g){return c===g||yh(c,g,Eh(g))},nt.isMatchWith=function(c,g,T){return T=typeof T=="function"?T:void 0,yh(c,g,Eh(g),T)},nt.isNaN=function(c){return Wd(c)&&c!=+c},nt.isNative=function(c){if(Id(c))throw new pr("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return mc(c)},nt.isNil=function(c){return c==null},nt.isNull=function(c){return c===null},nt.isNumber=Wd,nt.isObject=Ti,nt.isObjectLike=Ei,nt.isPlainObject=qu,nt.isRegExp=Nc,nt.isSafeInteger=function(c){return Dc(c)&&c>=-9007199254740991&&c<=9007199254740991},nt.isSet=Xd,nt.isString=Nh,nt.isSymbol=Zo,nt.isTypedArray=Yu,nt.isUndefined=function(c){return c===void 0},nt.isWeakMap=function(c){return Ei(c)&&ze(c)==se},nt.isWeakSet=function(c){return Ei(c)&&Zr(c)=="[object WeakSet]"},nt.join=function(c,g){return c==null?"":fh.call(c,g)},nt.kebabCase=Jd,nt.last=wo,nt.lastIndexOf=function(c,g,T){var N=c==null?0:c.length;if(!N)return-1;var W=N;return T!==void 0&&(W=(W=dr(T))<0?ci(N+W,0):Ji(W,N-1)),g==g?function(ht,Tt,It){for(var qt=It+1;qt--;)if(ht[qt]===Tt)return qt;return qt}(c,g,W):li(c,Ea,W,!0)},nt.lowerCase=Of,nt.lowerFirst=Uh,nt.lt=qd,nt.lte=Cf,nt.max=function(c){return c&&c.length?fc(c,Yi,Es):void 0},nt.maxBy=function(c,g){return c&&c.length?fc(c,Vn(g,2),Es):void 0},nt.mean=function(c){return Ma(c,Yi)},nt.meanBy=function(c,g){return Ma(c,Vn(g,2))},nt.min=function(c){return c&&c.length?fc(c,Yi,As):void 0},nt.minBy=function(c,g){return c&&c.length?fc(c,Vn(g,2),As):void 0},nt.stubArray=nl,nt.stubFalse=Hc,nt.stubObject=function(){return{}},nt.stubString=function(){return""},nt.stubTrue=function(){return!0},nt.multiply=Jo,nt.nth=function(c,g){return c&&c.length?wd(c,dr(g)):void 0},nt.noConflict=function(){return jr._===this&&(jr._=gd),this},nt.noop=kh,nt.now=Lh,nt.pad=function(c,g,T){c=Dr(c);var N=(g=dr(g))?ra(c):0;if(!g||N>=g)return c;var W=(g-N)/2;return Cs(ia(W),T)+c+Cs(Ra(W),T)},nt.padEnd=function(c,g,T){c=Dr(c);var N=(g=dr(g))?ra(c):0;return g&&N<g?c+Cs(g-N,T):c},nt.padStart=function(c,g,T){c=Dr(c);var N=(g=dr(g))?ra(c):0;return g&&N<g?Cs(g-N,T)+c:c},nt.parseInt=function(c,g,T){return T||g==null?g=0:g&&(g=+g),cc(Dr(c).replace(yr,""),g||0)},nt.random=function(c,g,T){if(T&&typeof T!="boolean"&&vo(c,g,T)&&(g=T=void 0),T===void 0&&(typeof g=="boolean"?(T=g,g=void 0):typeof c=="boolean"&&(T=c,c=void 0)),c===void 0&&g===void 0?(c=0,g=1):(c=fs(c),g===void 0?(g=c,c=0):g=fs(g)),c>g){var N=c;c=g,g=N}if(T||c%1||g%1){var W=He();return Ji(c+W*(g-c+yi("1e-"+((W+"").length-1))),g)}return Sd(c,g)},nt.reduce=function(c,g,T){var N=cr(c)?ah:wl,W=arguments.length<3;return N(c,Vn(g,4),T,W,Io)},nt.reduceRight=function(c,g,T){var N=cr(c)?yl:wl,W=arguments.length<3;return N(c,Vn(g,4),T,W,Ts)},nt.repeat=function(c,g,T){return g=(T?vo(c,g,T):g===void 0)?1:dr(g),ji(Dr(c),g)},nt.replace=function(){var c=arguments,g=Dr(c[0]);return c.length<3?g:g.replace(c[1],c[2])},nt.result=function(c,g,T){var N=-1,W=(g=Xn(g,c)).length;for(W||(W=1,c=void 0);++N<W;){var ht=c==null?void 0:c[hs(g[N])];ht===void 0&&(N=W,ht=T),c=Do(ht)?ht.call(c):ht}return c},nt.round=ef,nt.runInContext=Gt,nt.sample=function(c){return(cr(c)?Ru:Qi)(c)},nt.size=function(c){if(c==null)return 0;if(Yo(c))return Nh(c)?ra(c):c.length;var g=ze(c);return g==B||g==Y?c.size:vr(c).length},nt.snakeCase=ql,nt.some=function(c,g,T){var N=cr(c)?xl:Qr;return T&&vo(c,g,T)&&(g=void 0),N(c,Vn(g,3))},nt.sortedIndex=function(c,g){return Du(c,g)},nt.sortedIndexBy=function(c,g,T){return hr(c,g,Vn(T,2))},nt.sortedIndexOf=function(c,g){var T=c==null?0:c.length;if(T){var N=Du(c,g);if(N<T&&Oo(c[N],g))return N}return-1},nt.sortedLastIndex=function(c,g){return Du(c,g,!0)},nt.sortedLastIndexBy=function(c,g,T){return hr(c,g,Vn(T,2),!0)},nt.sortedLastIndexOf=function(c,g){if(c==null?0:c.length){var T=Du(c,g,!0)-1;if(Oo(c[T],g))return T}return-1},nt.startCase=Uc,nt.startsWith=function(c,g,T){return c=Dr(c),T=T==null?0:Vs(dr(T),0,c.length),g=Lo(g),c.slice(T,T+g.length)==g},nt.subtract=rl,nt.sum=function(c){return c&&c.length?Kr(c,Yi):0},nt.sumBy=function(c,g){return c&&c.length?Kr(c,Vn(g,2)):0},nt.template=function(c,g,T){var N=nt.templateSettings;T&&vo(c,g,T)&&(g=void 0),c=Dr(c),g=Zu({},g,N,Ol);var W,ht,Tt=Zu({},g.imports,N.imports,Ol),It=di(Tt),qt=Tl(Tt,It),ve=0,le=g.interpolate||vt,Ne="__p += '",yn=Eu((g.escape||vt).source+"|"+le.source+"|"+(le===bn?_i:vt).source+"|"+(g.evaluate||vt).source+"|$","g"),xn="//# sourceURL="+(Hr.call(g,"sourceURL")?(g.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++gr+"]")+`
`;c.replace(yn,function(qe,Qn,_n,qn,Cn,fr){return _n||(_n=qn),Ne+=c.slice(ve,fr).replace(wt,El),Qn&&(W=!0,Ne+=`' +
__e(`+Qn+`) +
'`),Cn&&(ht=!0,Ne+=`';
`+Cn+`;
__p += '`),_n&&(Ne+=`' +
((__t = (`+_n+`)) == null ? '' : __t) +
'`),ve=fr+qe.length,qe}),Ne+=`';
`;var Bn=Hr.call(g,"variable")&&g.variable;if(Bn){if(_s.test(Bn))throw new pr("Invalid `variable` option passed into `_.template`")}else Ne=`with (obj) {
`+Ne+`
}
`;Ne=(ht?Ne.replace(oe,""):Ne).replace(de,"$1").replace($e,"$1;"),Ne="function("+(Bn||"obj")+`) {
`+(Bn?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(W?", __e = _.escape":"")+(ht?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Ne+`return __p
}`;var Me=Kd(function(){return hi(It,xn+"return "+Ne).apply(void 0,qt)});if(Me.source=Ne,jd(Me))throw Me;return Me},nt.times=function(c,g){if((c=dr(c))<1||c>9007199254740991)return[];var T=4294967295,N=Ji(c,4294967295);c-=4294967295;for(var W=Sl(N,g=Vn(g));++T<c;)g(T);return W},nt.toFinite=fs,nt.toInteger=dr,nt.toLength=Yd,nt.toLower=function(c){return Dr(c).toLowerCase()},nt.toNumber=ps,nt.toSafeInteger=function(c){return c?Vs(dr(c),-9007199254740991,9007199254740991):c===0?c:0},nt.toString=Dr,nt.toUpper=function(c){return Dr(c).toUpperCase()},nt.trim=function(c,g,T){if((c=Dr(c))&&(T||g===void 0))return Tu(c);if(!c||!(g=Lo(g)))return c;var N=Gs(c),W=Gs(g);return Vr(N,lh(N,W),cd(N,W)+1).join("")},nt.trimEnd=function(c,g,T){if((c=Dr(c))&&(T||g===void 0))return c.slice(0,fd(c)+1);if(!c||!(g=Lo(g)))return c;var N=Gs(c);return Vr(N,0,cd(N,Gs(g))+1).join("")},nt.trimStart=function(c,g,T){if((c=Dr(c))&&(T||g===void 0))return c.replace(yr,"");if(!c||!(g=Lo(g)))return c;var N=Gs(c);return Vr(N,lh(N,Gs(g))).join("")},nt.truncate=function(c,g){var T=30,N="...";if(Ti(g)){var W="separator"in g?g.separator:W;T="length"in g?dr(g.length):T,N="omission"in g?Lo(g.omission):N}var ht=(c=Dr(c)).length;if(ks(c)){var Tt=Gs(c);ht=Tt.length}if(T>=ht)return c;var It=T-ra(N);if(It<1)return N;var qt=Tt?Vr(Tt,0,It).join(""):c.slice(0,It);if(W===void 0)return qt+N;if(Tt&&(It+=qt.length-It),Nc(W)){if(c.slice(It).search(W)){var ve,le=qt;for(W.global||(W=Eu(W.source,Dr(ki.exec(W))+"g")),W.lastIndex=0;ve=W.exec(le);)var Ne=ve.index;qt=qt.slice(0,Ne===void 0?It:Ne)}}else if(c.indexOf(Lo(W),It)!=It){var yn=qt.lastIndexOf(W);yn>-1&&(qt=qt.slice(0,yn))}return qt+N},nt.unescape=function(c){return(c=Dr(c))&&Ke.test(c)?c.replace(Ue,ro):c},nt.uniqueId=function(c){var g=++mf;return Dr(c)+g},nt.upperCase=Yl,nt.upperFirst=kc,nt.each=Af,nt.eachRight=Bd,nt.first=cs,za(nt,(jc={},Xo(nt,function(c,g){Hr.call(nt.prototype,g)||(jc[g]=c)}),jc),{chain:!1}),nt.VERSION="4.17.21",ko(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){nt[c].placeholder=nt}),ko(["drop","take"],function(c,g){lr.prototype[c]=function(T){T=T===void 0?1:ci(dr(T),0);var N=this.__filtered__&&!g?new lr(this):this.clone();return N.__filtered__?N.__takeCount__=Ji(T,N.__takeCount__):N.__views__.push({size:Ji(T,4294967295),type:c+(N.__dir__<0?"Right":"")}),N},lr.prototype[c+"Right"]=function(T){return this.reverse()[c](T).reverse()}}),ko(["filter","map","takeWhile"],function(c,g){var T=g+1,N=T==1||T==3;lr.prototype[c]=function(W){var ht=this.clone();return ht.__iteratees__.push({iteratee:Vn(W,3),type:T}),ht.__filtered__=ht.__filtered__||N,ht}}),ko(["head","last"],function(c,g){var T="take"+(g?"Right":"");lr.prototype[c]=function(){return this[T](1).value()[0]}}),ko(["initial","tail"],function(c,g){var T="drop"+(g?"":"Right");lr.prototype[c]=function(){return this.__filtered__?new lr(this):this[T](1)}}),lr.prototype.compact=function(){return this.filter(Yi)},lr.prototype.find=function(c){return this.filter(c).head()},lr.prototype.findLast=function(c){return this.reverse().find(c)},lr.prototype.invokeMap=br(function(c,g){return typeof c=="function"?new lr(this):this.map(function(T){return uu(T,c,g)})}),lr.prototype.reject=function(c){return this.filter(Hl(Vn(c)))},lr.prototype.slice=function(c,g){c=dr(c);var T=this;return T.__filtered__&&(c>0||g<0)?new lr(T):(c<0?T=T.takeRight(-c):c&&(T=T.drop(c)),g!==void 0&&(T=(g=dr(g))<0?T.dropRight(-g):T.take(g-c)),T)},lr.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},lr.prototype.toArray=function(){return this.take(4294967295)},Xo(lr.prototype,function(c,g){var T=/^(?:filter|find|map|reject)|While$/.test(g),N=/^(?:head|last)$/.test(g),W=nt[N?"take"+(g=="last"?"Right":""):g],ht=N||/^find/.test(g);W&&(nt.prototype[g]=function(){var Tt=this.__wrapped__,It=N?[1]:arguments,qt=Tt instanceof lr,ve=It[0],le=qt||cr(Tt),Ne=function(Qn){var _n=W.apply(nt,na([Qn],It));return N&&yn?_n[0]:_n};le&&T&&typeof ve=="function"&&ve.length!=1&&(qt=le=!1);var yn=this.__chain__,xn=!!this.__actions__.length,Bn=ht&&!yn,Me=qt&&!xn;if(!ht&&le){Tt=Me?Tt:new lr(this);var qe=c.apply(Tt,It);return qe.__actions__.push({func:Cc,args:[Ne],thisArg:void 0}),new qi(qe,yn)}return Bn&&Me?c.apply(this,It):(qe=this.thru(Ne),Bn?N?qe.value()[0]:qe.value():qe)})}),ko(["pop","push","shift","sort","splice","unshift"],function(c){var g=Mu[c],T=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",N=/^(?:pop|shift)$/.test(c);nt.prototype[c]=function(){var W=arguments;if(N&&!this.__chain__){var ht=this.value();return g.apply(cr(ht)?ht:[],W)}return this[T](function(Tt){return g.apply(cr(Tt)?Tt:[],W)})}}),Xo(lr.prototype,function(c,g){var T=nt[g];if(T){var N=T.name+"";Hr.call(Ia,N)||(Ia[N]=[]),Ia[N].push({name:g,func:T})}}),Ia[Bu(void 0,2).name]=[{name:"wrapper",func:void 0}],lr.prototype.clone=function(){var c=new lr(this.__wrapped__);return c.__actions__=Di(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=Di(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=Di(this.__views__),c},lr.prototype.reverse=function(){if(this.__filtered__){var c=new lr(this);c.__dir__=-1,c.__filtered__=!0}else(c=this.clone()).__dir__*=-1;return c},lr.prototype.value=function(){var c=this.__wrapped__.value(),g=this.__dir__,T=cr(c),N=g<0,W=T?c.length:0,ht=function(fr,Mn,Wn){for(var Fi=-1,gi=Wn.length;++Fi<gi;){var Ns=Wn[Fi],Mi=Ns.size;switch(Ns.type){case"drop":fr+=Mi;break;case"dropRight":Mn-=Mi;break;case"take":Mn=Ji(Mn,fr+Mi);break;case"takeRight":fr=ci(fr,Mn-Mi)}}return{start:fr,end:Mn}}(0,W,this.__views__),Tt=ht.start,It=ht.end,qt=It-Tt,ve=N?It:Tt-1,le=this.__iteratees__,Ne=le.length,yn=0,xn=Ji(qt,this.__takeCount__);if(!T||!N&&W==qt&&xn==qt)return qs(c,this.__actions__);var Bn=[];t:for(;qt--&&yn<xn;){for(var Me=-1,qe=c[ve+=g];++Me<Ne;){var Qn=le[Me],_n=Qn.iteratee,qn=Qn.type,Cn=_n(qe);if(qn==2)qe=Cn;else if(!Cn){if(qn==1)continue t;break t}}Bn[yn++]=qe}return Bn},nt.prototype.at=fp,nt.prototype.chain=function(){return Mf(this)},nt.prototype.commit=function(){return new qi(this.value(),this.__chain__)},nt.prototype.next=function(){this.__values__===void 0&&(this.__values__=jl(this.value()));var c=this.__index__>=this.__values__.length;return{done:c,value:c?void 0:this.__values__[this.__index__++]}},nt.prototype.plant=function(c){for(var g,T=this;T instanceof sa;){var N=Ph(T);N.__index__=0,N.__values__=void 0,g?W.__wrapped__=N:g=N;var W=N;T=T.__wrapped__}return W.__wrapped__=c,g},nt.prototype.reverse=function(){var c=this.__wrapped__;if(c instanceof lr){var g=c;return this.__actions__.length&&(g=new lr(this)),(g=g.reverse()).__actions__.push({func:Cc,args:[Ch],thisArg:void 0}),new qi(g,this.__chain__)}return this.thru(Ch)},nt.prototype.toJSON=nt.prototype.valueOf=nt.prototype.value=function(){return qs(this.__wrapped__,this.__actions__)},nt.prototype.first=nt.prototype.head,dh&&(nt.prototype[dh]=function(){return this}),nt}();jr._=Pa,(dt=function(){return Pa}.call(C,S,C,j))===void 0||(j.exports=dt)}).call(this)}).call(this,S(4),S(11)(Re))},function(Re,C,S){Object.defineProperty(C,"__esModule",{value:!0});var it=function(){function ft(tt,J){for(var lt=0;lt<J.length;lt++){var Ft=J[lt];Ft.enumerable=Ft.enumerable||!1,Ft.configurable=!0,"value"in Ft&&(Ft.writable=!0),Object.defineProperty(tt,Ft.key,Ft)}}return function(tt,J,lt){return J&&ft(tt.prototype,J),lt&&ft(tt,lt),tt}}();function j(ft,tt){if(!(ft instanceof tt))throw new TypeError("Cannot call a class as a function")}var dt=function(){function ft(tt,J,lt){J===void 0&&(J=!1),j(this,ft),this._fn=tt,this._once=J,this._thisArg=lt,this._next=this._prev=this._owner=null}return it(ft,[{key:"detach",value:function(){return this._owner!==null&&(this._owner.detach(this),!0)}}]),ft}();function ot(ft,tt){return ft._head?(ft._tail._next=tt,tt._prev=ft._tail,ft._tail=tt):(ft._head=tt,ft._tail=tt),tt._owner=ft,tt}var X=function(){function ft(){j(this,ft),this._head=this._tail=void 0}return it(ft,[{key:"handlers",value:function(){var tt=!(arguments.length<=0||arguments[0]===void 0)&&arguments[0],J=this._head;if(tt)return!!J;for(var lt=[];J;)lt.push(J),J=J._next;return lt}},{key:"has",value:function(tt){if(!(tt instanceof dt))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return tt._owner===this}},{key:"dispatch",value:function(){var tt=this._head;if(!tt)return!1;for(;tt;)tt._once&&this.detach(tt),tt._fn.apply(tt._thisArg,arguments),tt=tt._next;return!0}},{key:"add",value:function(tt){var J=arguments.length<=1||arguments[1]===void 0?null:arguments[1];if(typeof tt!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return ot(this,new dt(tt,!1,J))}},{key:"once",value:function(tt){var J=arguments.length<=1||arguments[1]===void 0?null:arguments[1];if(typeof tt!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return ot(this,new dt(tt,!0,J))}},{key:"detach",value:function(tt){if(!(tt instanceof dt))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return tt._owner!==this||(tt._prev&&(tt._prev._next=tt._next),tt._next&&(tt._next._prev=tt._prev),tt===this._head?(this._head=tt._next,tt._next===null&&(this._tail=null)):tt===this._tail&&(this._tail=tt._prev,this._tail._next=null),tt._owner=null),this}},{key:"detachAll",value:function(){var tt=this._head;if(!tt)return this;for(this._head=this._tail=null;tt;)tt._owner=null,tt=tt._next;return this}}]),ft}();X.MiniSignalBinding=dt,C.default=X,Re.exports=C.default},function(Re,C,S){var it;(function(j){function dt(F,Y){var $=(65535&F)+(65535&Y);return(F>>16)+(Y>>16)+($>>16)<<16|65535&$}function ot(F,Y,$,ct,se,Le){return dt((ee=dt(dt(Y,F),dt(ct,Le)))<<(xt=se)|ee>>>32-xt,$);var ee,xt}function X(F,Y,$,ct,se,Le,ee){return ot(Y&$|~Y&ct,F,Y,se,Le,ee)}function ft(F,Y,$,ct,se,Le,ee){return ot(Y&ct|$&~ct,F,Y,se,Le,ee)}function tt(F,Y,$,ct,se,Le,ee){return ot(Y^$^ct,F,Y,se,Le,ee)}function J(F,Y,$,ct,se,Le,ee){return ot($^(Y|~ct),F,Y,se,Le,ee)}function lt(F,Y){var $,ct,se,Le,ee;F[Y>>5]|=128<<Y%32,F[14+(Y+64>>>9<<4)]=Y;var xt=1732584193,Zt=-271733879,$t=-1732584194,Q=271733878;for($=0;$<F.length;$+=16)ct=xt,se=Zt,Le=$t,ee=Q,xt=X(xt,Zt,$t,Q,F[$],7,-680876936),Q=X(Q,xt,Zt,$t,F[$+1],12,-389564586),$t=X($t,Q,xt,Zt,F[$+2],17,606105819),Zt=X(Zt,$t,Q,xt,F[$+3],22,-1044525330),xt=X(xt,Zt,$t,Q,F[$+4],7,-176418897),Q=X(Q,xt,Zt,$t,F[$+5],12,1200080426),$t=X($t,Q,xt,Zt,F[$+6],17,-1473231341),Zt=X(Zt,$t,Q,xt,F[$+7],22,-45705983),xt=X(xt,Zt,$t,Q,F[$+8],7,1770035416),Q=X(Q,xt,Zt,$t,F[$+9],12,-1958414417),$t=X($t,Q,xt,Zt,F[$+10],17,-42063),Zt=X(Zt,$t,Q,xt,F[$+11],22,-1990404162),xt=X(xt,Zt,$t,Q,F[$+12],7,1804603682),Q=X(Q,xt,Zt,$t,F[$+13],12,-40341101),$t=X($t,Q,xt,Zt,F[$+14],17,-1502002290),xt=ft(xt,Zt=X(Zt,$t,Q,xt,F[$+15],22,1236535329),$t,Q,F[$+1],5,-165796510),Q=ft(Q,xt,Zt,$t,F[$+6],9,-1069501632),$t=ft($t,Q,xt,Zt,F[$+11],14,643717713),Zt=ft(Zt,$t,Q,xt,F[$],20,-373897302),xt=ft(xt,Zt,$t,Q,F[$+5],5,-701558691),Q=ft(Q,xt,Zt,$t,F[$+10],9,38016083),$t=ft($t,Q,xt,Zt,F[$+15],14,-660478335),Zt=ft(Zt,$t,Q,xt,F[$+4],20,-405537848),xt=ft(xt,Zt,$t,Q,F[$+9],5,568446438),Q=ft(Q,xt,Zt,$t,F[$+14],9,-1019803690),$t=ft($t,Q,xt,Zt,F[$+3],14,-187363961),Zt=ft(Zt,$t,Q,xt,F[$+8],20,1163531501),xt=ft(xt,Zt,$t,Q,F[$+13],5,-1444681467),Q=ft(Q,xt,Zt,$t,F[$+2],9,-51403784),$t=ft($t,Q,xt,Zt,F[$+7],14,1735328473),xt=tt(xt,Zt=ft(Zt,$t,Q,xt,F[$+12],20,-1926607734),$t,Q,F[$+5],4,-378558),Q=tt(Q,xt,Zt,$t,F[$+8],11,-2022574463),$t=tt($t,Q,xt,Zt,F[$+11],16,1839030562),Zt=tt(Zt,$t,Q,xt,F[$+14],23,-35309556),xt=tt(xt,Zt,$t,Q,F[$+1],4,-1530992060),Q=tt(Q,xt,Zt,$t,F[$+4],11,1272893353),$t=tt($t,Q,xt,Zt,F[$+7],16,-155497632),Zt=tt(Zt,$t,Q,xt,F[$+10],23,-1094730640),xt=tt(xt,Zt,$t,Q,F[$+13],4,681279174),Q=tt(Q,xt,Zt,$t,F[$],11,-358537222),$t=tt($t,Q,xt,Zt,F[$+3],16,-722521979),Zt=tt(Zt,$t,Q,xt,F[$+6],23,76029189),xt=tt(xt,Zt,$t,Q,F[$+9],4,-640364487),Q=tt(Q,xt,Zt,$t,F[$+12],11,-421815835),$t=tt($t,Q,xt,Zt,F[$+15],16,530742520),xt=J(xt,Zt=tt(Zt,$t,Q,xt,F[$+2],23,-995338651),$t,Q,F[$],6,-198630844),Q=J(Q,xt,Zt,$t,F[$+7],10,1126891415),$t=J($t,Q,xt,Zt,F[$+14],15,-1416354905),Zt=J(Zt,$t,Q,xt,F[$+5],21,-57434055),xt=J(xt,Zt,$t,Q,F[$+12],6,1700485571),Q=J(Q,xt,Zt,$t,F[$+3],10,-1894986606),$t=J($t,Q,xt,Zt,F[$+10],15,-1051523),Zt=J(Zt,$t,Q,xt,F[$+1],21,-2054922799),xt=J(xt,Zt,$t,Q,F[$+8],6,1873313359),Q=J(Q,xt,Zt,$t,F[$+15],10,-30611744),$t=J($t,Q,xt,Zt,F[$+6],15,-1560198380),Zt=J(Zt,$t,Q,xt,F[$+13],21,1309151649),xt=J(xt,Zt,$t,Q,F[$+4],6,-145523070),Q=J(Q,xt,Zt,$t,F[$+11],10,-1120210379),$t=J($t,Q,xt,Zt,F[$+2],15,718787259),Zt=J(Zt,$t,Q,xt,F[$+9],21,-343485551),xt=dt(xt,ct),Zt=dt(Zt,se),$t=dt($t,Le),Q=dt(Q,ee);return[xt,Zt,$t,Q]}function Ft(F){var Y,$="",ct=32*F.length;for(Y=0;Y<ct;Y+=8)$+=String.fromCharCode(F[Y>>5]>>>Y%32&255);return $}function jt(F){var Y,$=[];for($[(F.length>>2)-1]=void 0,Y=0;Y<$.length;Y+=1)$[Y]=0;var ct=8*F.length;for(Y=0;Y<ct;Y+=8)$[Y>>5]|=(255&F.charCodeAt(Y/8))<<Y%32;return $}function kt(F){var Y,$,ct="";for($=0;$<F.length;$+=1)Y=F.charCodeAt($),ct+="0123456789abcdef".charAt(Y>>>4&15)+"0123456789abcdef".charAt(15&Y);return ct}function I(F){return unescape(encodeURIComponent(F))}function B(F){return function(Y){return Ft(lt(jt(Y),8*Y.length))}(I(F))}function V(F,Y){return function($,ct){var se,Le,ee=jt($),xt=[],Zt=[];for(xt[15]=Zt[15]=void 0,ee.length>16&&(ee=lt(ee,8*$.length)),se=0;se<16;se+=1)xt[se]=909522486^ee[se],Zt[se]=1549556828^ee[se];return Le=lt(xt.concat(jt(ct)),512+8*ct.length),Ft(lt(Zt.concat(Le),640))}(I(F),I(Y))}function ut(F,Y,$){return Y?$?V(Y,F):kt(V(Y,F)):$?B(F):kt(B(F))}(it=function(){return ut}.call(C,S,C,Re))===void 0||(Re.exports=it)})()},function(Re,C){var S;S=function(){return this}();try{S=S||new Function("return this")()}catch{typeof window=="object"&&(S=window)}Re.exports=S},function(Re,C,S){S.r(C),S.d(C,"ACESFilmicToneMapping",function(){return Fn}),S.d(C,"AddEquation",function(){return ee}),S.d(C,"AddOperation",function(){return Or}),S.d(C,"AdditiveAnimationBlendMode",function(){return sc}),S.d(C,"AdditiveBlending",function(){return $}),S.d(C,"AlphaFormat",function(){return jn}),S.d(C,"AlwaysDepth",function(){return er}),S.d(C,"AlwaysStencilFunc",function(){return Nn}),S.d(C,"AmbientLight",function(){return Up}),S.d(C,"AmbientLightProbe",function(){return _o}),S.d(C,"AnimationClip",function(){return Qc}),S.d(C,"AnimationLoader",function(){return ed}),S.d(C,"AnimationMixer",function(){return Vp}),S.d(C,"AnimationObjectGroup",function(){return tc}),S.d(C,"AnimationUtils",function(){return vi}),S.d(C,"ArcCurve",function(){return Mn}),S.d(C,"ArrayCamera",function(){return Dr}),S.d(C,"ArrowHelper",function(){return an}),S.d(C,"Audio",function(){return ip}),S.d(C,"AudioAnalyser",function(){return op}),S.d(C,"AudioContext",function(){return bu}),S.d(C,"AudioListener",function(){return Lm}),S.d(C,"AudioLoader",function(){return ul}),S.d(C,"AxesHelper",function(){return Dt}),S.d(C,"AxisHelper",function(){return yg}),S.d(C,"BackSide",function(){return I}),S.d(C,"BasicDepthPacking",function(){return hi}),S.d(C,"BasicShadowMap",function(){return J}),S.d(C,"BinaryTextureLoader",function(){return Tg}),S.d(C,"Bone",function(){return Yi}),S.d(C,"BooleanKeyframeTrack",function(){return Qs}),S.d(C,"BoundingBoxHelper",function(){return xg}),S.d(C,"Box2",function(){return ud}),S.d(C,"Box3",function(){return co}),S.d(C,"Box3Helper",function(){return at}),S.d(C,"BoxBufferGeometry",function(){return fa}),S.d(C,"BoxGeometry",function(){return fa}),S.d(C,"BoxHelper",function(){return q}),S.d(C,"BufferAttribute",function(){return hr}),S.d(C,"BufferGeometry",function(){return Dn}),S.d(C,"BufferGeometryLoader",function(){return id}),S.d(C,"ByteType",function(){return Uo}),S.d(C,"Cache",function(){return Za}),S.d(C,"Camera",function(){return Ol}),S.d(C,"CameraHelper",function(){return R}),S.d(C,"CanvasRenderer",function(){return Mg}),S.d(C,"CanvasTexture",function(){return qt}),S.d(C,"CatmullRomCurve3",function(){return $s}),S.d(C,"CineonToneMapping",function(){return _s}),S.d(C,"CircleBufferGeometry",function(){return le}),S.d(C,"CircleGeometry",function(){return le}),S.d(C,"ClampToEdgeWrapping",function(){return wt}),S.d(C,"Clock",function(){return zp}),S.d(C,"Color",function(){return pn}),S.d(C,"ColorKeyframeTrack",function(){return Yf}),S.d(C,"CompressedTexture",function(){return It}),S.d(C,"CompressedTextureLoader",function(){return am}),S.d(C,"ConeBufferGeometry",function(){return yn}),S.d(C,"ConeGeometry",function(){return yn}),S.d(C,"CubeCamera",function(){return Sc}),S.d(C,"CubeReflectionMapping",function(){return L}),S.d(C,"CubeRefractionMapping",function(){return k}),S.d(C,"CubeTexture",function(){return Gu}),S.d(C,"CubeTextureLoader",function(){return Ip}),S.d(C,"CubeUVReflectionMapping",function(){return K}),S.d(C,"CubeUVRefractionMapping",function(){return et}),S.d(C,"CubicBezierCurve",function(){return Wa}),S.d(C,"CubicBezierCurve3",function(){return va}),S.d(C,"CubicInterpolant",function(){return Ya}),S.d(C,"CullFaceBack",function(){return X}),S.d(C,"CullFaceFront",function(){return ft}),S.d(C,"CullFaceFrontBack",function(){return tt}),S.d(C,"CullFaceNone",function(){return ot}),S.d(C,"Curve",function(){return Cn}),S.d(C,"CurvePath",function(){return lm}),S.d(C,"CustomBlending",function(){return Le}),S.d(C,"CustomToneMapping",function(){return _i}),S.d(C,"CylinderBufferGeometry",function(){return Ne}),S.d(C,"CylinderGeometry",function(){return Ne}),S.d(C,"Cylindrical",function(){return Yp}),S.d(C,"DataTexture",function(){return ga}),S.d(C,"DataTexture2DArray",function(){return Dl}),S.d(C,"DataTexture3D",function(){return Ls}),S.d(C,"DataTextureLoader",function(){return um}),S.d(C,"DataUtils",function(){return he}),S.d(C,"DecrementStencilOp",function(){return Ca}),S.d(C,"DecrementWrapStencilOp",function(){return Au}),S.d(C,"DefaultLoadingManager",function(){return Rp}),S.d(C,"DepthFormat",function(){return vn}),S.d(C,"DepthStencilFormat",function(){return ir}),S.d(C,"DepthTexture",function(){return ve}),S.d(C,"DirectionalLight",function(){return Bp}),S.d(C,"DirectionalLightHelper",function(){return x}),S.d(C,"DiscreteInterpolant",function(){return om}),S.d(C,"DodecahedronBufferGeometry",function(){return Bn}),S.d(C,"DodecahedronGeometry",function(){return Bn}),S.d(C,"DoubleSide",function(){return B}),S.d(C,"DstAlphaFactor",function(){return $e}),S.d(C,"DstColorFactor",function(){return Zn}),S.d(C,"DynamicBufferAttribute",function(){return lg}),S.d(C,"DynamicCopyUsage",function(){return dh}),S.d(C,"DynamicDrawUsage",function(){return Zi}),S.d(C,"DynamicReadUsage",function(){return gf}),S.d(C,"EdgesGeometry",function(){return qn}),S.d(C,"EdgesHelper",function(){return bg}),S.d(C,"EllipseCurve",function(){return fr}),S.d(C,"EqualDepth",function(){return Lr}),S.d(C,"EqualStencilFunc",function(){return ac}),S.d(C,"EquirectangularReflectionMapping",function(){return G}),S.d(C,"EquirectangularRefractionMapping",function(){return st}),S.d(C,"Euler",function(){return Ws}),S.d(C,"EventDispatcher",function(){return Ho}),S.d(C,"ExtrudeBufferGeometry",function(){return Xa}),S.d(C,"ExtrudeGeometry",function(){return Xa}),S.d(C,"FaceColors",function(){return up}),S.d(C,"FileLoader",function(){return uo}),S.d(C,"FlatShading",function(){return V}),S.d(C,"Float16BufferAttribute",function(){return qs}),S.d(C,"Float32Attribute",function(){return vg}),S.d(C,"Float32BufferAttribute",function(){return En}),S.d(C,"Float64Attribute",function(){return _g}),S.d(C,"Float64BufferAttribute",function(){return yc}),S.d(C,"FloatType",function(){return Jt}),S.d(C,"Fog",function(){return Ju}),S.d(C,"FogExp2",function(){return Ga}),S.d(C,"Font",function(){return sd}),S.d(C,"FontLoader",function(){return $a}),S.d(C,"FrontSide",function(){return kt}),S.d(C,"Frustum",function(){return Fa}),S.d(C,"GLBufferAttribute",function(){return Wp}),S.d(C,"GLSL1",function(){return hc}),S.d(C,"GLSL3",function(){return yd}),S.d(C,"GammaEncoding",function(){return Gt}),S.d(C,"GreaterDepth",function(){return Yr}),S.d(C,"GreaterEqualDepth",function(){return Rr}),S.d(C,"GreaterEqualStencilFunc",function(){return hh}),S.d(C,"GreaterStencilFunc",function(){return gd}),S.d(C,"GridHelper",function(){return r}),S.d(C,"Group",function(){return Zs}),S.d(C,"HalfFloatType",function(){return Nt}),S.d(C,"HemisphereLight",function(){return Op}),S.d(C,"HemisphereLightHelper",function(){return e}),S.d(C,"HemisphereLightProbe",function(){return ll}),S.d(C,"IcosahedronBufferGeometry",function(){return qa}),S.d(C,"IcosahedronGeometry",function(){return qa}),S.d(C,"ImageBitmapLoader",function(){return ep}),S.d(C,"ImageLoader",function(){return nd}),S.d(C,"ImageUtils",function(){return zs}),S.d(C,"ImmediateRenderObject",function(){return xm}),S.d(C,"IncrementStencilOp",function(){return md}),S.d(C,"IncrementWrapStencilOp",function(){return Ml}),S.d(C,"InstancedBufferAttribute",function(){return tp}),S.d(C,"InstancedBufferGeometry",function(){return rh}),S.d(C,"InstancedInterleavedBuffer",function(){return ap}),S.d(C,"InstancedMesh",function(){return Hh}),S.d(C,"Int16Attribute",function(){return fg}),S.d(C,"Int16BufferAttribute",function(){return Xs}),S.d(C,"Int32Attribute",function(){return mg}),S.d(C,"Int32BufferAttribute",function(){return Md}),S.d(C,"Int8Attribute",function(){return hg}),S.d(C,"Int8BufferAttribute",function(){return Ed}),S.d(C,"IntType",function(){return ml}),S.d(C,"InterleavedBuffer",function(){return Ha}),S.d(C,"InterleavedBufferAttribute",function(){return di}),S.d(C,"Interpolant",function(){return al}),S.d(C,"InterpolateDiscrete",function(){return no}),S.d(C,"InterpolateLinear",function(){return El}),S.d(C,"InterpolateSmooth",function(){return ks}),S.d(C,"InvertStencilOp",function(){return Hr}),S.d(C,"JSONLoader",function(){return Ag}),S.d(C,"KeepStencilOp",function(){return pi}),S.d(C,"KeyframeTrack",function(){return vs}),S.d(C,"LOD",function(){return kc}),S.d(C,"LatheBufferGeometry",function(){return xu}),S.d(C,"LatheGeometry",function(){return xu}),S.d(C,"Layers",function(){return Iu}),S.d(C,"LensFlare",function(){return Cg}),S.d(C,"LessDepth",function(){return bn}),S.d(C,"LessEqualDepth",function(){return Cr}),S.d(C,"LessEqualStencilFunc",function(){return uc}),S.d(C,"LessStencilFunc",function(){return Ao}),S.d(C,"Light",function(){return _a}),S.d(C,"LightProbe",function(){return uf}),S.d(C,"Line",function(){return ja}),S.d(C,"Line3",function(){return df}),S.d(C,"LineBasicMaterial",function(){return ao}),S.d(C,"LineCurve",function(){return Jl}),S.d(C,"LineCurve3",function(){return Vc}),S.d(C,"LineDashedMaterial",function(){return Cp}),S.d(C,"LineLoop",function(){return ef}),S.d(C,"LinePieces",function(){return dl}),S.d(C,"LineSegments",function(){return Jo}),S.d(C,"LineStrip",function(){return eo}),S.d(C,"LinearEncoding",function(){return ro}),S.d(C,"LinearFilter",function(){return We}),S.d(C,"LinearInterpolant",function(){return wr}),S.d(C,"LinearMipMapLinearFilter",function(){return Bo}),S.d(C,"LinearMipMapNearestFilter",function(){return Ii}),S.d(C,"LinearMipmapLinearFilter",function(){return ui}),S.d(C,"LinearMipmapNearestFilter",function(){return sr}),S.d(C,"LinearToneMapping",function(){return Fr}),S.d(C,"Loader",function(){return ts}),S.d(C,"LoaderUtils",function(){return Qf}),S.d(C,"LoadingManager",function(){return td}),S.d(C,"LogLuvEncoding",function(){return we}),S.d(C,"LoopOnce",function(){return cd}),S.d(C,"LoopPingPong",function(){return dd}),S.d(C,"LoopRepeat",function(){return Wi}),S.d(C,"LuminanceAlphaFormat",function(){return gr}),S.d(C,"LuminanceFormat",function(){return xr}),S.d(C,"MOUSE",function(){return j}),S.d(C,"Material",function(){return ji}),S.d(C,"MaterialLoader",function(){return dm}),S.d(C,"Math",function(){return cc}),S.d(C,"MathUtils",function(){return cc}),S.d(C,"Matrix3",function(){return $i}),S.d(C,"Matrix4",function(){return Tn}),S.d(C,"MaxEquation",function(){return Q}),S.d(C,"Mesh",function(){return mi}),S.d(C,"MeshBasicMaterial",function(){return Vi}),S.d(C,"MeshDepthMaterial",function(){return jl}),S.d(C,"MeshDistanceMaterial",function(){return fs}),S.d(C,"MeshFaceMaterial",function(){return Tm}),S.d(C,"MeshLambertMaterial",function(){return Xf}),S.d(C,"MeshMatcapMaterial",function(){return qf}),S.d(C,"MeshNormalMaterial",function(){return Pp}),S.d(C,"MeshPhongMaterial",function(){return Mp}),S.d(C,"MeshPhysicalMaterial",function(){return Ep}),S.d(C,"MeshStandardMaterial",function(){return Wf}),S.d(C,"MeshToonMaterial",function(){return Ap}),S.d(C,"MinEquation",function(){return $t}),S.d(C,"MirroredRepeatWrapping",function(){return Ct}),S.d(C,"MixOperation",function(){return Ri}),S.d(C,"MultiMaterial",function(){return Em}),S.d(C,"MultiplyBlending",function(){return se}),S.d(C,"MultiplyOperation",function(){return yr}),S.d(C,"NearestFilter",function(){return St}),S.d(C,"NearestMipMapLinearFilter",function(){return fn}),S.d(C,"NearestMipMapNearestFilter",function(){return ne}),S.d(C,"NearestMipmapLinearFilter",function(){return Vt}),S.d(C,"NearestMipmapNearestFilter",function(){return Ut}),S.d(C,"NeverDepth",function(){return Hn}),S.d(C,"NeverStencilFunc",function(){return mf}),S.d(C,"NoBlending",function(){return F}),S.d(C,"NoColors",function(){return hd}),S.d(C,"NoToneMapping",function(){return Er}),S.d(C,"NormalAnimationBlendMode",function(){return iu}),S.d(C,"NormalBlending",function(){return Y}),S.d(C,"NotEqualDepth",function(){return Ar}),S.d(C,"NotEqualStencilFunc",function(){return vd}),S.d(C,"NumberKeyframeTrack",function(){return Jh}),S.d(C,"Object3D",function(){return vr}),S.d(C,"ObjectLoader",function(){return Oe}),S.d(C,"ObjectSpaceNormalMap",function(){return Eu}),S.d(C,"OctahedronBufferGeometry",function(){return Wh}),S.d(C,"OctahedronGeometry",function(){return Wh}),S.d(C,"OneFactor",function(){return Wt}),S.d(C,"OneMinusDstAlphaFactor",function(){return Ue}),S.d(C,"OneMinusDstColorFactor",function(){return Ke}),S.d(C,"OneMinusSrcAlphaFactor",function(){return de}),S.d(C,"OneMinusSrcColorFactor",function(){return Xt}),S.d(C,"OrthographicCamera",function(){return nh}),S.d(C,"PCFShadowMap",function(){return lt}),S.d(C,"PCFSoftShadowMap",function(){return Ft}),S.d(C,"PMREMGenerator",function(){return si}),S.d(C,"ParametricBufferGeometry",function(){return jf}),S.d(C,"ParametricGeometry",function(){return jf}),S.d(C,"Particle",function(){return rg}),S.d(C,"ParticleBasicMaterial",function(){return sg}),S.d(C,"ParticleSystem",function(){return ig}),S.d(C,"ParticleSystemMaterial",function(){return ag}),S.d(C,"Path",function(){return rd}),S.d(C,"PerspectiveCamera",function(){return to}),S.d(C,"Plane",function(){return us}),S.d(C,"PlaneBufferGeometry",function(){return pa}),S.d(C,"PlaneGeometry",function(){return pa}),S.d(C,"PlaneHelper",function(){return _t}),S.d(C,"PointCloud",function(){return ng}),S.d(C,"PointCloudMaterial",function(){return og}),S.d(C,"PointLight",function(){return Kf}),S.d(C,"PointLightHelper",function(){return ya}),S.d(C,"Points",function(){return W}),S.d(C,"PointsMaterial",function(){return rl}),S.d(C,"PolarGridHelper",function(){return s}),S.d(C,"PolyhedronBufferGeometry",function(){return xn}),S.d(C,"PolyhedronGeometry",function(){return xn}),S.d(C,"PositionalAudio",function(){return gm}),S.d(C,"PropertyBinding",function(){return kr}),S.d(C,"PropertyMixer",function(){return vm}),S.d(C,"QuadraticBezierCurve",function(){return il}),S.d(C,"QuadraticBezierCurve3",function(){return jh}),S.d(C,"Quaternion",function(){return Xi}),S.d(C,"QuaternionKeyframeTrack",function(){return Kc}),S.d(C,"QuaternionLinearInterpolant",function(){return Ql}),S.d(C,"REVISION",function(){return it}),S.d(C,"RGBADepthPacking",function(){return Hs}),S.d(C,"RGBAFormat",function(){return Pn}),S.d(C,"RGBAIntegerFormat",function(){return Ur}),S.d(C,"RGBA_ASTC_10x10_Format",function(){return xl}),S.d(C,"RGBA_ASTC_10x5_Format",function(){return na}),S.d(C,"RGBA_ASTC_10x6_Format",function(){return ah}),S.d(C,"RGBA_ASTC_10x8_Format",function(){return yl}),S.d(C,"RGBA_ASTC_12x10_Format",function(){return xi}),S.d(C,"RGBA_ASTC_12x12_Format",function(){return Ta}),S.d(C,"RGBA_ASTC_4x4_Format",function(){return pf}),S.d(C,"RGBA_ASTC_5x4_Format",function(){return ko}),S.d(C,"RGBA_ASTC_5x5_Format",function(){return vl}),S.d(C,"RGBA_ASTC_6x5_Format",function(){return fi}),S.d(C,"RGBA_ASTC_6x6_Format",function(){return ns}),S.d(C,"RGBA_ASTC_8x5_Format",function(){return _l}),S.d(C,"RGBA_ASTC_8x6_Format",function(){return sh}),S.d(C,"RGBA_ASTC_8x8_Format",function(){return Ln}),S.d(C,"RGBA_BPTC_Format",function(){return li}),S.d(C,"RGBA_ETC2_EAC_Format",function(){return yo}),S.d(C,"RGBA_PVRTC_2BPPV1_Format",function(){return gl}),S.d(C,"RGBA_PVRTC_4BPPV1_Format",function(){return ic}),S.d(C,"RGBA_S3TC_DXT1_Format",function(){return ea}),S.d(C,"RGBA_S3TC_DXT3_Format",function(){return wu}),S.d(C,"RGBA_S3TC_DXT5_Format",function(){return $r}),S.d(C,"RGBDEncoding",function(){return pr}),S.d(C,"RGBEEncoding",function(){return fe}),S.d(C,"RGBEFormat",function(){return ln}),S.d(C,"RGBFormat",function(){return wn}),S.d(C,"RGBIntegerFormat",function(){return jr}),S.d(C,"RGBM16Encoding",function(){return en}),S.d(C,"RGBM7Encoding",function(){return sn}),S.d(C,"RGB_ETC1_Format",function(){return oc}),S.d(C,"RGB_ETC2_Format",function(){return Su}),S.d(C,"RGB_PVRTC_2BPPV1_Format",function(){return rc}),S.d(C,"RGB_PVRTC_4BPPV1_Format",function(){return Eo}),S.d(C,"RGB_S3TC_DXT1_Format",function(){return nu}),S.d(C,"RGFormat",function(){return Br}),S.d(C,"RGIntegerFormat",function(){return zr}),S.d(C,"RawShaderMaterial",function(){return Yh}),S.d(C,"Ray",function(){return Ro}),S.d(C,"Raycaster",function(){return Xp}),S.d(C,"RectAreaLight",function(){return kp}),S.d(C,"RedFormat",function(){return yi}),S.d(C,"RedIntegerFormat",function(){return ar}),S.d(C,"ReinhardToneMapping",function(){return lo}),S.d(C,"RepeatWrapping",function(){return vt}),S.d(C,"ReplaceStencilOp",function(){return Mu}),S.d(C,"ReverseSubtractEquation",function(){return Zt}),S.d(C,"RingBufferGeometry",function(){return gs}),S.d(C,"RingGeometry",function(){return gs}),S.d(C,"SRGB8_ALPHA8_ASTC_10x10_Format",function(){return Tl}),S.d(C,"SRGB8_ALPHA8_ASTC_10x5_Format",function(){return Sl}),S.d(C,"SRGB8_ALPHA8_ASTC_10x6_Format",function(){return Tu}),S.d(C,"SRGB8_ALPHA8_ASTC_10x8_Format",function(){return Mo}),S.d(C,"SRGB8_ALPHA8_ASTC_12x10_Format",function(){return ni}),S.d(C,"SRGB8_ALPHA8_ASTC_12x12_Format",function(){return lh}),S.d(C,"SRGB8_ALPHA8_ASTC_4x4_Format",function(){return rs}),S.d(C,"SRGB8_ALPHA8_ASTC_5x4_Format",function(){return ru}),S.d(C,"SRGB8_ALPHA8_ASTC_5x5_Format",function(){return Ea}),S.d(C,"SRGB8_ALPHA8_ASTC_6x5_Format",function(){return Ma}),S.d(C,"SRGB8_ALPHA8_ASTC_6x6_Format",function(){return bl}),S.d(C,"SRGB8_ALPHA8_ASTC_8x5_Format",function(){return uh}),S.d(C,"SRGB8_ALPHA8_ASTC_8x6_Format",function(){return wl}),S.d(C,"SRGB8_ALPHA8_ASTC_8x8_Format",function(){return Kr}),S.d(C,"Scene",function(){return Fh}),S.d(C,"SceneUtils",function(){return Pg}),S.d(C,"ShaderChunk",function(){return nr}),S.d(C,"ShaderLib",function(){return Is}),S.d(C,"ShaderMaterial",function(){return go}),S.d(C,"ShadowMaterial",function(){return Tp}),S.d(C,"Shape",function(){return eh}),S.d(C,"ShapeBufferGeometry",function(){return Fs}),S.d(C,"ShapeGeometry",function(){return Fs}),S.d(C,"ShapePath",function(){return Hp}),S.d(C,"ShapeUtils",function(){return Ks}),S.d(C,"ShortType",function(){return wa}),S.d(C,"Skeleton",function(){return za}),S.d(C,"SkeletonHelper",function(){return wm}),S.d(C,"SkinnedMesh",function(){return el}),S.d(C,"SmoothShading",function(){return ut}),S.d(C,"Sphere",function(){return ws}),S.d(C,"SphereBufferGeometry",function(){return Xh}),S.d(C,"SphereGeometry",function(){return Xh}),S.d(C,"Spherical",function(){return ad}),S.d(C,"SphericalHarmonics3",function(){return Gp}),S.d(C,"SplineCurve",function(){return ol}),S.d(C,"SpotLight",function(){return of}),S.d(C,"SpotLightHelper",function(){return Um}),S.d(C,"Sprite",function(){return Uh}),S.d(C,"SpriteMaterial",function(){return so}),S.d(C,"SrcAlphaFactor",function(){return oe}),S.d(C,"SrcAlphaSaturateFactor",function(){return Un}),S.d(C,"SrcColorFactor",function(){return Kt}),S.d(C,"StaticCopyUsage",function(){return _d}),S.d(C,"StaticDrawUsage",function(){return ys}),S.d(C,"StaticReadUsage",function(){return lc}),S.d(C,"StereoCamera",function(){return Kh}),S.d(C,"StreamCopyUsage",function(){return ou}),S.d(C,"StreamDrawUsage",function(){return ch}),S.d(C,"StreamReadUsage",function(){return Gi}),S.d(C,"StringKeyframeTrack",function(){return th}),S.d(C,"SubtractEquation",function(){return xt}),S.d(C,"SubtractiveBlending",function(){return ct}),S.d(C,"TOUCH",function(){return dt}),S.d(C,"TangentSpaceNormalMap",function(){return On}),S.d(C,"TetrahedronBufferGeometry",function(){return qh}),S.d(C,"TetrahedronGeometry",function(){return qh}),S.d(C,"TextBufferGeometry",function(){return Vf}),S.d(C,"TextGeometry",function(){return Vf}),S.d(C,"Texture",function(){return ii}),S.d(C,"TextureLoader",function(){return Lp}),S.d(C,"TorusBufferGeometry",function(){return Zc}),S.d(C,"TorusGeometry",function(){return Zc}),S.d(C,"TorusKnotBufferGeometry",function(){return Jc}),S.d(C,"TorusKnotGeometry",function(){return Jc}),S.d(C,"Triangle",function(){return bi}),S.d(C,"TriangleFanDrawMode",function(){return fd}),S.d(C,"TriangleStripDrawMode",function(){return Gs}),S.d(C,"TrianglesDrawMode",function(){return ra}),S.d(C,"TubeBufferGeometry",function(){return $c}),S.d(C,"TubeGeometry",function(){return $c}),S.d(C,"UVMapping",function(){return ki}),S.d(C,"Uint16Attribute",function(){return pg}),S.d(C,"Uint16BufferAttribute",function(){return Nu}),S.d(C,"Uint32Attribute",function(){return gg}),S.d(C,"Uint32BufferAttribute",function(){return Fu}),S.d(C,"Uint8Attribute",function(){return cg}),S.d(C,"Uint8BufferAttribute",function(){return zn}),S.d(C,"Uint8ClampedAttribute",function(){return dg}),S.d(C,"Uint8ClampedBufferAttribute",function(){return Lo}),S.d(C,"Uniform",function(){return ti}),S.d(C,"UniformsLib",function(){return ze}),S.d(C,"UniformsUtils",function(){return Ad}),S.d(C,"UnsignedByteType",function(){return ho}),S.d(C,"UnsignedInt248Type",function(){return hn}),S.d(C,"UnsignedIntType",function(){return eu}),S.d(C,"UnsignedShort4444Type",function(){return ge}),S.d(C,"UnsignedShort5551Type",function(){return Ge}),S.d(C,"UnsignedShort565Type",function(){return Qe}),S.d(C,"UnsignedShortType",function(){return Sa}),S.d(C,"VSMShadowMap",function(){return jt}),S.d(C,"Vector2",function(){return He}),S.d(C,"Vector3",function(){return mt}),S.d(C,"Vector4",function(){return Ir}),S.d(C,"VectorKeyframeTrack",function(){return $h}),S.d(C,"Vertex",function(){return ug}),S.d(C,"VertexColors",function(){return Sm}),S.d(C,"VideoTexture",function(){return Tt}),S.d(C,"WebGL1Renderer",function(){return Lf}),S.d(C,"WebGLCubeRenderTarget",function(){return Rs}),S.d(C,"WebGLMultipleRenderTargets",function(){return Ia}),S.d(C,"WebGLMultisampleRenderTarget",function(){return dc}),S.d(C,"WebGLRenderTarget",function(){return Po}),S.d(C,"WebGLRenderTargetCube",function(){return Eg}),S.d(C,"WebGLRenderer",function(){return Jr}),S.d(C,"WebGLUtils",function(){return Fc}),S.d(C,"WireframeGeometry",function(){return Sp}),S.d(C,"WireframeHelper",function(){return wg}),S.d(C,"WrapAroundEnding",function(){return Go}),S.d(C,"XHRLoader",function(){return Sg}),S.d(C,"ZeroCurvatureEnding",function(){return ri}),S.d(C,"ZeroFactor",function(){return Bt}),S.d(C,"ZeroSlopeEnding",function(){return Aa}),S.d(C,"ZeroStencilOp",function(){return pd}),S.d(C,"sRGBEncoding",function(){return Pa});/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const it="130",j={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},dt={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},ot=0,X=1,ft=2,tt=3,J=0,lt=1,Ft=2,jt=3,kt=0,I=1,B=2,V=1,ut=2,F=0,Y=1,$=2,ct=3,se=4,Le=5,ee=100,xt=101,Zt=102,$t=103,Q=104,Bt=200,Wt=201,Kt=202,Xt=203,oe=204,de=205,$e=206,Ue=207,Zn=208,Ke=209,Un=210,Hn=0,er=1,bn=2,Cr=3,Lr=4,Rr=5,Yr=6,Ar=7,yr=0,Ri=1,Or=2,Er=0,Fr=1,lo=2,_s=3,Fn=4,_i=5,ki=300,L=301,k=302,G=303,st=304,K=306,et=307,vt=1e3,wt=1001,Ct=1002,St=1003,Ut=1004,ne=1004,Vt=1005,fn=1005,We=1006,sr=1007,Ii=1007,ui=1008,Bo=1008,ho=1009,Uo=1010,wa=1011,Sa=1012,ml=1013,eu=1014,Jt=1015,Nt=1016,ge=1017,Ge=1018,Qe=1019,hn=1020,jn=1021,wn=1022,Pn=1023,xr=1024,gr=1025,ln=Pn,vn=1026,ir=1027,yi=1028,ar=1029,Br=1030,zr=1031,jr=1032,Ur=1033,nu=33776,ea=33777,wu=33778,$r=33779,Eo=35840,rc=35841,ic=35842,gl=35843,oc=36196,Su=37492,yo=37496,pf=37808,ko=37809,vl=37810,fi=37811,ns=37812,_l=37813,sh=37814,Ln=37815,na=37816,ah=37817,yl=37818,xl=37819,xi=37820,Ta=37821,li=36492,rs=37840,ru=37841,Ea=37842,Ma=37843,bl=37844,uh=37845,wl=37846,Kr=37847,Sl=37848,Tu=37849,Mo=37850,Tl=37851,ni=37852,lh=37853,cd=2200,Wi=2201,dd=2202,no=2300,El=2301,ks=2302,ri=2400,Aa=2401,Go=2402,iu=2500,sc=2501,ra=0,Gs=1,fd=2,ro=3e3,Pa=3001,Gt=3007,fe=3002,we=3003,sn=3004,en=3005,pr=3006,hi=3200,Hs=3201,On=0,Eu=1,pd=0,pi=7680,Mu=7681,md=7682,Ca=7683,Ml=34055,Au=34056,Hr=5386,mf=512,Ao=513,ac=514,uc=515,gd=516,vd=517,hh=518,Nn=519,ys=35044,Zi=35048,ch=35040,lc=35045,gf=35049,Gi=35041,_d=35046,dh=35050,ou=35042,hc="100",yd="300 es";class Ho{addEventListener(t,i){this._listeners===void 0&&(this._listeners={});const a=this._listeners;a[t]===void 0&&(a[t]=[]),a[t].indexOf(i)===-1&&a[t].push(i)}hasEventListener(t,i){if(this._listeners===void 0)return!1;const a=this._listeners;return a[t]!==void 0&&a[t].indexOf(i)!==-1}removeEventListener(t,i){if(this._listeners===void 0)return;const a=this._listeners[t];if(a!==void 0){const u=a.indexOf(i);u!==-1&&a.splice(u,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const i=this._listeners[t.type];if(i!==void 0){t.target=this;const a=i.slice(0);for(let u=0,d=a.length;u<d;u++)a[u].call(this,t);t.target=null}}}const io=[];for(let m=0;m<256;m++)io[m]=(m<16?"0":"")+m.toString(16);let Ra=1234567;const ia=Math.PI/180,zo=180/Math.PI;function jo(){const m=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,a=4294967295*Math.random()|0;return(io[255&m]+io[m>>8&255]+io[m>>16&255]+io[m>>24&255]+"-"+io[255&t]+io[t>>8&255]+"-"+io[t>>16&15|64]+io[t>>24&255]+"-"+io[63&i|128]+io[i>>8&255]+"-"+io[i>>16&255]+io[i>>24&255]+io[255&a]+io[a>>8&255]+io[a>>16&255]+io[a>>24&255]).toUpperCase()}function Hi(m,t,i){return Math.max(t,Math.min(i,m))}function fh(m,t){return(m%t+t)%t}function Pu(m,t,i){return(1-i)*m+i*t}function ci(m){return(m&m-1)==0&&m!==0}function Ji(m){return Math.pow(2,Math.ceil(Math.log(m)/Math.LN2))}function xd(m){return Math.pow(2,Math.floor(Math.log(m)/Math.LN2))}var cc=Object.freeze({__proto__:null,DEG2RAD:ia,RAD2DEG:zo,generateUUID:jo,clamp:Hi,euclideanModulo:fh,mapLinear:function(m,t,i,a,u){return a+(m-t)*(u-a)/(i-t)},inverseLerp:function(m,t,i){return m!==t?(i-m)/(t-m):0},lerp:Pu,damp:function(m,t,i,a){return Pu(m,t,1-Math.exp(-i*a))},pingpong:function(m,t=1){return t-Math.abs(fh(m,2*t)-t)},smoothstep:function(m,t,i){return m<=t?0:m>=i?1:(m=(m-t)/(i-t))*m*(3-2*m)},smootherstep:function(m,t,i){return m<=t?0:m>=i?1:(m=(m-t)/(i-t))*m*m*(m*(6*m-15)+10)},randInt:function(m,t){return m+Math.floor(Math.random()*(t-m+1))},randFloat:function(m,t){return m+Math.random()*(t-m)},randFloatSpread:function(m){return m*(.5-Math.random())},seededRandom:function(m){return m!==void 0&&(Ra=m%2147483647),Ra=16807*Ra%2147483647,(Ra-1)/2147483646},degToRad:function(m){return m*ia},radToDeg:function(m){return m*zo},isPowerOfTwo:ci,ceilPowerOfTwo:Ji,floorPowerOfTwo:xd,setQuaternionFromProperEuler:function(m,t,i,a,u){const d=Math.cos,f=Math.sin,v=d(i/2),_=f(i/2),y=d((t+a)/2),E=f((t+a)/2),A=d((t-a)/2),M=f((t-a)/2),P=d((a-t)/2),O=f((a-t)/2);switch(u){case"XYX":m.set(v*E,_*A,_*M,v*y);break;case"YZY":m.set(_*M,v*E,_*A,v*y);break;case"ZXZ":m.set(_*A,_*M,v*E,v*y);break;case"XZX":m.set(v*E,_*O,_*P,v*y);break;case"YXY":m.set(_*P,v*E,_*O,v*y);break;case"ZYZ":m.set(_*O,_*P,v*E,v*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+u)}}});class He{constructor(t=0,i=0){this.x=t,this.y=i}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,i){return this.x=t,this.y=i,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,i){return i!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this}sub(t,i){return i!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const i=this.x,a=this.y,u=t.elements;return this.x=u[0]*i+u[3]*a+u[6],this.y=u[1]*i+u[4]*a+u[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this}clampLength(t,i){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(t,Math.min(i,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const i=this.x-t.x,a=this.y-t.y;return i*i+a*a}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this}lerpVectors(t,i,a){return this.x=t.x+(i.x-t.x)*a,this.y=t.y+(i.y-t.y)*a,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t}fromBufferAttribute(t,i,a){return a!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this}rotateAround(t,i){const a=Math.cos(i),u=Math.sin(i),d=this.x-t.x,f=this.y-t.y;return this.x=d*a-f*u+t.x,this.y=d*u+f*a+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}He.prototype.isVector2=!0;class $i{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,i,a,u,d,f,v,_,y){const E=this.elements;return E[0]=t,E[1]=u,E[2]=v,E[3]=i,E[4]=d,E[5]=_,E[6]=a,E[7]=f,E[8]=y,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const i=this.elements,a=t.elements;return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],this}extractBasis(t,i,a){return t.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),a.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const i=t.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,i){const a=t.elements,u=i.elements,d=this.elements,f=a[0],v=a[3],_=a[6],y=a[1],E=a[4],A=a[7],M=a[2],P=a[5],O=a[8],U=u[0],D=u[3],Z=u[6],rt=u[1],gt=u[4],pt=u[7],Mt=u[2],At=u[5],Et=u[8];return d[0]=f*U+v*rt+_*Mt,d[3]=f*D+v*gt+_*At,d[6]=f*Z+v*pt+_*Et,d[1]=y*U+E*rt+A*Mt,d[4]=y*D+E*gt+A*At,d[7]=y*Z+E*pt+A*Et,d[2]=M*U+P*rt+O*Mt,d[5]=M*D+P*gt+O*At,d[8]=M*Z+P*pt+O*Et,this}multiplyScalar(t){const i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this}determinant(){const t=this.elements,i=t[0],a=t[1],u=t[2],d=t[3],f=t[4],v=t[5],_=t[6],y=t[7],E=t[8];return i*f*E-i*v*y-a*d*E+a*v*_+u*d*y-u*f*_}invert(){const t=this.elements,i=t[0],a=t[1],u=t[2],d=t[3],f=t[4],v=t[5],_=t[6],y=t[7],E=t[8],A=E*f-v*y,M=v*_-E*d,P=y*d-f*_,O=i*A+a*M+u*P;if(O===0)return this.set(0,0,0,0,0,0,0,0,0);const U=1/O;return t[0]=A*U,t[1]=(u*y-E*a)*U,t[2]=(v*a-u*f)*U,t[3]=M*U,t[4]=(E*i-u*_)*U,t[5]=(u*d-v*i)*U,t[6]=P*U,t[7]=(a*_-y*i)*U,t[8]=(f*i-a*d)*U,this}transpose(){let t;const i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this}setUvTransform(t,i,a,u,d,f,v){const _=Math.cos(d),y=Math.sin(d);return this.set(a*_,a*y,-a*(_*f+y*v)+f+t,-u*y,u*_,-u*(-y*f+_*v)+v+i,0,0,1),this}scale(t,i){const a=this.elements;return a[0]*=t,a[3]*=t,a[6]*=t,a[1]*=i,a[4]*=i,a[7]*=i,this}rotate(t){const i=Math.cos(t),a=Math.sin(t),u=this.elements,d=u[0],f=u[3],v=u[6],_=u[1],y=u[4],E=u[7];return u[0]=i*d+a*_,u[3]=i*f+a*y,u[6]=i*v+a*E,u[1]=-a*d+i*_,u[4]=-a*f+i*y,u[7]=-a*v+i*E,this}translate(t,i){const a=this.elements;return a[0]+=t*a[2],a[3]+=t*a[5],a[6]+=t*a[8],a[1]+=i*a[2],a[4]+=i*a[5],a[7]+=i*a[8],this}equals(t){const i=this.elements,a=t.elements;for(let u=0;u<9;u++)if(i[u]!==a[u])return!1;return!0}fromArray(t,i=0){for(let a=0;a<9;a++)this.elements[a]=t[a+i];return this}toArray(t=[],i=0){const a=this.elements;return t[i]=a[0],t[i+1]=a[1],t[i+2]=a[2],t[i+3]=a[3],t[i+4]=a[4],t[i+5]=a[5],t[i+6]=a[6],t[i+7]=a[7],t[i+8]=a[8],t}clone(){return new this.constructor().fromArray(this.elements)}}let oa;$i.prototype.isMatrix3=!0;class zs{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let i;if(t instanceof HTMLCanvasElement)i=t;else{oa===void 0&&(oa=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),oa.width=t.width,oa.height=t.height;const a=oa.getContext("2d");t instanceof ImageData?a.putImageData(t,0,0):a.drawImage(t,0,0,t.width,t.height),i=oa}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}}let ph=0;class ii extends Ho{constructor(t=ii.DEFAULT_IMAGE,i=ii.DEFAULT_MAPPING,a=wt,u=wt,d=We,f=ui,v=Pn,_=ho,y=1,E=ro){super(),Object.defineProperty(this,"id",{value:ph++}),this.uuid=jo(),this.name="",this.image=t,this.mipmaps=[],this.mapping=i,this.wrapS=a,this.wrapT=u,this.magFilter=d,this.minFilter=f,this.anisotropy=y,this.format=v,this.internalFormat=null,this.type=_,this.offset=new He(0,0),this.repeat=new He(1,1),this.center=new He(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new $i,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=E,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this}toJSON(t){const i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const a={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const u=this.image;if(u.uuid===void 0&&(u.uuid=jo()),!i&&t.images[u.uuid]===void 0){let d;if(Array.isArray(u)){d=[];for(let f=0,v=u.length;f<v;f++)u[f].isDataTexture?d.push(su(u[f].image)):d.push(su(u[f]))}else d=su(u);t.images[u.uuid]={uuid:u.uuid,url:d}}a.image=u.uuid}return i||(t.textures[this.uuid]=a),a}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==ki)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case vt:t.x=t.x-Math.floor(t.x);break;case wt:t.x=t.x<0?0:1;break;case Ct:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case vt:t.y=t.y-Math.floor(t.y);break;case wt:t.y=t.y<0?0:1;break;case Ct:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&this.version++}}function su(m){return typeof HTMLImageElement!="undefined"&&m instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&m instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&m instanceof ImageBitmap?zs.getDataURL(m):m.data?{data:Array.prototype.slice.call(m.data),width:m.width,height:m.height,type:m.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}ii.DEFAULT_IMAGE=void 0,ii.DEFAULT_MAPPING=ki,ii.prototype.isTexture=!0;class Ir{constructor(t=0,i=0,a=0,u=1){this.x=t,this.y=i,this.z=a,this.w=u}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,i,a,u){return this.x=t,this.y=i,this.z=a,this.w=u,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t,i){return i!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this.w+=t.w*i,this}sub(t,i){return i!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const i=this.x,a=this.y,u=this.z,d=this.w,f=t.elements;return this.x=f[0]*i+f[4]*a+f[8]*u+f[12]*d,this.y=f[1]*i+f[5]*a+f[9]*u+f[13]*d,this.z=f[2]*i+f[6]*a+f[10]*u+f[14]*d,this.w=f[3]*i+f[7]*a+f[11]*u+f[15]*d,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this}setAxisAngleFromRotationMatrix(t){let i,a,u,d;const f=t.elements,v=f[0],_=f[4],y=f[8],E=f[1],A=f[5],M=f[9],P=f[2],O=f[6],U=f[10];if(Math.abs(_-E)<.01&&Math.abs(y-P)<.01&&Math.abs(M-O)<.01){if(Math.abs(_+E)<.1&&Math.abs(y+P)<.1&&Math.abs(M+O)<.1&&Math.abs(v+A+U-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const Z=(v+1)/2,rt=(A+1)/2,gt=(U+1)/2,pt=(_+E)/4,Mt=(y+P)/4,At=(M+O)/4;return Z>rt&&Z>gt?Z<.01?(a=0,u=.707106781,d=.707106781):(a=Math.sqrt(Z),u=pt/a,d=Mt/a):rt>gt?rt<.01?(a=.707106781,u=0,d=.707106781):(u=Math.sqrt(rt),a=pt/u,d=At/u):gt<.01?(a=.707106781,u=.707106781,d=0):(d=Math.sqrt(gt),a=Mt/d,u=At/d),this.set(a,u,d,i),this}let D=Math.sqrt((O-M)*(O-M)+(y-P)*(y-P)+(E-_)*(E-_));return Math.abs(D)<.001&&(D=1),this.x=(O-M)/D,this.y=(y-P)/D,this.z=(E-_)/D,this.w=Math.acos((v+A+U-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this.w=Math.max(t.w,Math.min(i.w,this.w)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this.w=Math.max(t,Math.min(i,this.w)),this}clampLength(t,i){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(t,Math.min(i,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this}lerpVectors(t,i,a){return this.x=t.x+(i.x-t.x)*a,this.y=t.y+(i.y-t.y)*a,this.z=t.z+(i.z-t.z)*a,this.w=t.w+(i.w-t.w)*a,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t}fromBufferAttribute(t,i,a){return a!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this.w=t.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Ir.prototype.isVector4=!0;class Po extends Ho{constructor(t,i,a={}){super(),this.width=t,this.height=i,this.depth=1,this.scissor=new Ir(0,0,t,i),this.scissorTest=!1,this.viewport=new Ir(0,0,t,i),this.texture=new ii(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),this.texture.image={width:t,height:i,depth:1},this.texture.generateMipmaps=a.generateMipmaps!==void 0&&a.generateMipmaps,this.texture.minFilter=a.minFilter!==void 0?a.minFilter:We,this.depthBuffer=a.depthBuffer===void 0||a.depthBuffer,this.stencilBuffer=a.stencilBuffer!==void 0&&a.stencilBuffer,this.depthTexture=a.depthTexture!==void 0?a.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,i,a=1){this.width===t&&this.height===i&&this.depth===a||(this.width=t,this.height=i,this.depth=a,this.texture.image.width=t,this.texture.image.height=i,this.texture.image.depth=a,this.dispose()),this.viewport.set(0,0,t,i),this.scissor.set(0,0,t,i)}clone(){return new this.constructor().copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image=eg({},this.texture.image),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Po.prototype.isWebGLRenderTarget=!0;class Ia extends Po{constructor(t,i,a){super(t,i);const u=this.texture;this.texture=[];for(let d=0;d<a;d++)this.texture[d]=u.clone()}setSize(t,i,a=1){if(this.width!==t||this.height!==i||this.depth!==a){this.width=t,this.height=i,this.depth=a;for(let u=0,d=this.texture.length;u<d;u++)this.texture[u].image.width=t,this.texture[u].image.height=i,this.texture[u].image.depth=a;this.dispose()}return this.viewport.set(0,0,t,i),this.scissor.set(0,0,t,i),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let i=0,a=t.texture.length;i<a;i++)this.texture[i]=t.texture[i].clone();return this}}Ia.prototype.isWebGLMultipleRenderTargets=!0;class dc extends Po{constructor(t,i,a){super(t,i,a),this.samples=4}copy(t){return super.copy.call(this,t),this.samples=t.samples,this}}dc.prototype.isWebGLMultisampleRenderTarget=!0;class Xi{constructor(t=0,i=0,a=0,u=1){this._x=t,this._y=i,this._z=a,this._w=u}static slerp(t,i,a,u){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),a.slerpQuaternions(t,i,u)}static slerpFlat(t,i,a,u,d,f,v){let _=a[u+0],y=a[u+1],E=a[u+2],A=a[u+3];const M=d[f+0],P=d[f+1],O=d[f+2],U=d[f+3];if(v===0)return t[i+0]=_,t[i+1]=y,t[i+2]=E,void(t[i+3]=A);if(v===1)return t[i+0]=M,t[i+1]=P,t[i+2]=O,void(t[i+3]=U);if(A!==U||_!==M||y!==P||E!==O){let D=1-v;const Z=_*M+y*P+E*O+A*U,rt=Z>=0?1:-1,gt=1-Z*Z;if(gt>Number.EPSILON){const Mt=Math.sqrt(gt),At=Math.atan2(Mt,Z*rt);D=Math.sin(D*At)/Mt,v=Math.sin(v*At)/Mt}const pt=v*rt;if(_=_*D+M*pt,y=y*D+P*pt,E=E*D+O*pt,A=A*D+U*pt,D===1-v){const Mt=1/Math.sqrt(_*_+y*y+E*E+A*A);_*=Mt,y*=Mt,E*=Mt,A*=Mt}}t[i]=_,t[i+1]=y,t[i+2]=E,t[i+3]=A}static multiplyQuaternionsFlat(t,i,a,u,d,f){const v=a[u],_=a[u+1],y=a[u+2],E=a[u+3],A=d[f],M=d[f+1],P=d[f+2],O=d[f+3];return t[i]=v*O+E*A+_*P-y*M,t[i+1]=_*O+E*M+y*A-v*P,t[i+2]=y*O+E*P+v*M-_*A,t[i+3]=E*O-v*A-_*M-y*P,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,i,a,u){return this._x=t,this._y=i,this._z=a,this._w=u,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,i){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const a=t._x,u=t._y,d=t._z,f=t._order,v=Math.cos,_=Math.sin,y=v(a/2),E=v(u/2),A=v(d/2),M=_(a/2),P=_(u/2),O=_(d/2);switch(f){case"XYZ":this._x=M*E*A+y*P*O,this._y=y*P*A-M*E*O,this._z=y*E*O+M*P*A,this._w=y*E*A-M*P*O;break;case"YXZ":this._x=M*E*A+y*P*O,this._y=y*P*A-M*E*O,this._z=y*E*O-M*P*A,this._w=y*E*A+M*P*O;break;case"ZXY":this._x=M*E*A-y*P*O,this._y=y*P*A+M*E*O,this._z=y*E*O+M*P*A,this._w=y*E*A-M*P*O;break;case"ZYX":this._x=M*E*A-y*P*O,this._y=y*P*A+M*E*O,this._z=y*E*O-M*P*A,this._w=y*E*A+M*P*O;break;case"YZX":this._x=M*E*A+y*P*O,this._y=y*P*A+M*E*O,this._z=y*E*O-M*P*A,this._w=y*E*A-M*P*O;break;case"XZY":this._x=M*E*A-y*P*O,this._y=y*P*A-M*E*O,this._z=y*E*O+M*P*A,this._w=y*E*A+M*P*O;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+f)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,i){const a=i/2,u=Math.sin(a);return this._x=t.x*u,this._y=t.y*u,this._z=t.z*u,this._w=Math.cos(a),this._onChangeCallback(),this}setFromRotationMatrix(t){const i=t.elements,a=i[0],u=i[4],d=i[8],f=i[1],v=i[5],_=i[9],y=i[2],E=i[6],A=i[10],M=a+v+A;if(M>0){const P=.5/Math.sqrt(M+1);this._w=.25/P,this._x=(E-_)*P,this._y=(d-y)*P,this._z=(f-u)*P}else if(a>v&&a>A){const P=2*Math.sqrt(1+a-v-A);this._w=(E-_)/P,this._x=.25*P,this._y=(u+f)/P,this._z=(d+y)/P}else if(v>A){const P=2*Math.sqrt(1+v-a-A);this._w=(d-y)/P,this._x=(u+f)/P,this._y=.25*P,this._z=(_+E)/P}else{const P=2*Math.sqrt(1+A-a-v);this._w=(f-u)/P,this._x=(d+y)/P,this._y=(_+E)/P,this._z=.25*P}return this._onChangeCallback(),this}setFromUnitVectors(t,i){let a=t.dot(i)+1;return a<Number.EPSILON?(a=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=a):(this._x=0,this._y=-t.z,this._z=t.y,this._w=a)):(this._x=t.y*i.z-t.z*i.y,this._y=t.z*i.x-t.x*i.z,this._z=t.x*i.y-t.y*i.x,this._w=a),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Hi(this.dot(t),-1,1)))}rotateTowards(t,i){const a=this.angleTo(t);if(a===0)return this;const u=Math.min(1,i/a);return this.slerp(t,u),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,i){return i!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,i){const a=t._x,u=t._y,d=t._z,f=t._w,v=i._x,_=i._y,y=i._z,E=i._w;return this._x=a*E+f*v+u*y-d*_,this._y=u*E+f*_+d*v-a*y,this._z=d*E+f*y+a*_-u*v,this._w=f*E-a*v-u*_-d*y,this._onChangeCallback(),this}slerp(t,i){if(i===0)return this;if(i===1)return this.copy(t);const a=this._x,u=this._y,d=this._z,f=this._w;let v=f*t._w+a*t._x+u*t._y+d*t._z;if(v<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,v=-v):this.copy(t),v>=1)return this._w=f,this._x=a,this._y=u,this._z=d,this;const _=1-v*v;if(_<=Number.EPSILON){const P=1-i;return this._w=P*f+i*this._w,this._x=P*a+i*this._x,this._y=P*u+i*this._y,this._z=P*d+i*this._z,this.normalize(),this._onChangeCallback(),this}const y=Math.sqrt(_),E=Math.atan2(y,v),A=Math.sin((1-i)*E)/y,M=Math.sin(i*E)/y;return this._w=f*A+this._w*M,this._x=a*A+this._x*M,this._y=u*A+this._y*M,this._z=d*A+this._z*M,this._onChangeCallback(),this}slerpQuaternions(t,i,a){this.copy(t).slerp(i,a)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,i=0){return this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t}fromBufferAttribute(t,i){return this._x=t.getX(i),this._y=t.getY(i),this._z=t.getZ(i),this._w=t.getW(i),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Xi.prototype.isQuaternion=!0;class mt{constructor(t=0,i=0,a=0){this.x=t,this.y=i,this.z=a}set(t,i,a){return a===void 0&&(a=this.z),this.x=t,this.y=i,this.z=a,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,i){return i!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this}sub(t,i){return i!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}multiply(t,i){return i!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(bd.setFromEuler(t))}applyAxisAngle(t,i){return this.applyQuaternion(bd.setFromAxisAngle(t,i))}applyMatrix3(t){const i=this.x,a=this.y,u=this.z,d=t.elements;return this.x=d[0]*i+d[3]*a+d[6]*u,this.y=d[1]*i+d[4]*a+d[7]*u,this.z=d[2]*i+d[5]*a+d[8]*u,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const i=this.x,a=this.y,u=this.z,d=t.elements,f=1/(d[3]*i+d[7]*a+d[11]*u+d[15]);return this.x=(d[0]*i+d[4]*a+d[8]*u+d[12])*f,this.y=(d[1]*i+d[5]*a+d[9]*u+d[13])*f,this.z=(d[2]*i+d[6]*a+d[10]*u+d[14])*f,this}applyQuaternion(t){const i=this.x,a=this.y,u=this.z,d=t.x,f=t.y,v=t.z,_=t.w,y=_*i+f*u-v*a,E=_*a+v*i-d*u,A=_*u+d*a-f*i,M=-d*i-f*a-v*u;return this.x=y*_+M*-d+E*-v-A*-f,this.y=E*_+M*-f+A*-d-y*-v,this.z=A*_+M*-v+y*-f-E*-d,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const i=this.x,a=this.y,u=this.z,d=t.elements;return this.x=d[0]*i+d[4]*a+d[8]*u,this.y=d[1]*i+d[5]*a+d[9]*u,this.z=d[2]*i+d[6]*a+d[10]*u,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this}clampLength(t,i){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(t,Math.min(i,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this}lerpVectors(t,i,a){return this.x=t.x+(i.x-t.x)*a,this.y=t.y+(i.y-t.y)*a,this.z=t.z+(i.z-t.z)*a,this}cross(t,i){return i!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i)):this.crossVectors(this,t)}crossVectors(t,i){const a=t.x,u=t.y,d=t.z,f=i.x,v=i.y,_=i.z;return this.x=u*_-d*v,this.y=d*f-a*_,this.z=a*v-u*f,this}projectOnVector(t){const i=t.lengthSq();if(i===0)return this.set(0,0,0);const a=t.dot(this)/i;return this.copy(t).multiplyScalar(a)}projectOnPlane(t){return Cu.copy(this).projectOnVector(t),this.sub(Cu)}reflect(t){return this.sub(Cu.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const i=Math.sqrt(this.lengthSq()*t.lengthSq());if(i===0)return Math.PI/2;const a=this.dot(t)/i;return Math.acos(Hi(a,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const i=this.x-t.x,a=this.y-t.y,u=this.z-t.z;return i*i+a*a+u*u}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,i,a){const u=Math.sin(i)*t;return this.x=u*Math.sin(a),this.y=Math.cos(i)*t,this.z=u*Math.cos(a),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,i,a){return this.x=t*Math.sin(i),this.y=a,this.z=t*Math.cos(i),this}setFromMatrixPosition(t){const i=t.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(t){const i=this.setFromMatrixColumn(t,0).length(),a=this.setFromMatrixColumn(t,1).length(),u=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=a,this.z=u,this}setFromMatrixColumn(t,i){return this.fromArray(t.elements,4*i)}setFromMatrix3Column(t,i){return this.fromArray(t.elements,3*i)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}fromBufferAttribute(t,i,a){return a!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}mt.prototype.isVector3=!0;const Cu=new mt,bd=new Xi;class co{constructor(t=new mt(1/0,1/0,1/0),i=new mt(-1/0,-1/0,-1/0)){this.min=t,this.max=i}set(t,i){return this.min.copy(t),this.max.copy(i),this}setFromArray(t){let i=1/0,a=1/0,u=1/0,d=-1/0,f=-1/0,v=-1/0;for(let _=0,y=t.length;_<y;_+=3){const E=t[_],A=t[_+1],M=t[_+2];E<i&&(i=E),A<a&&(a=A),M<u&&(u=M),E>d&&(d=E),A>f&&(f=A),M>v&&(v=M)}return this.min.set(i,a,u),this.max.set(d,f,v),this}setFromBufferAttribute(t){let i=1/0,a=1/0,u=1/0,d=-1/0,f=-1/0,v=-1/0;for(let _=0,y=t.count;_<y;_++){const E=t.getX(_),A=t.getY(_),M=t.getZ(_);E<i&&(i=E),A<a&&(a=A),M<u&&(u=M),E>d&&(d=E),A>f&&(f=A),M>v&&(v=M)}return this.min.set(i,a,u),this.max.set(d,f,v),this}setFromPoints(t){this.makeEmpty();for(let i=0,a=t.length;i<a;i++)this.expandByPoint(t[i]);return this}setFromCenterAndSize(t,i){const a=Al.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(a),this.max.copy(t).add(a),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const i=t.geometry;i!==void 0&&(i.boundingBox===null&&i.computeBoundingBox(),nt.copy(i.boundingBox),nt.applyMatrix4(t.matrixWorld),this.union(nt));const a=t.children;for(let u=0,d=a.length;u<d;u++)this.expandByObject(a[u]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,i){return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Al),Al.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let i,a;return t.normal.x>0?(i=t.normal.x*this.min.x,a=t.normal.x*this.max.x):(i=t.normal.x*this.max.x,a=t.normal.x*this.min.x),t.normal.y>0?(i+=t.normal.y*this.min.y,a+=t.normal.y*this.max.y):(i+=t.normal.y*this.max.y,a+=t.normal.y*this.min.y),t.normal.z>0?(i+=t.normal.z*this.min.z,a+=t.normal.z*this.max.z):(i+=t.normal.z*this.max.z,a+=t.normal.z*this.min.z),i<=-t.constant&&a>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(os),aa.subVectors(this.max,os),xs.subVectors(t.a,os),sa.subVectors(t.b,os),qi.subVectors(t.c,os),lr.subVectors(sa,xs),Vo.subVectors(qi,sa),Ki.subVectors(xs,qi);let i=[0,-lr.z,lr.y,0,-Vo.z,Vo.y,0,-Ki.z,Ki.y,lr.z,0,-lr.x,Vo.z,0,-Vo.x,Ki.z,0,-Ki.x,-lr.y,lr.x,0,-Vo.y,Vo.x,0,-Ki.y,Ki.x,0];return!!Ru(i,xs,sa,qi,aa)&&(i=[1,0,0,0,1,0,0,0,1],!!Ru(i,xs,sa,qi,aa)&&(Co.crossVectors(lr,Vo),i=[Co.x,Co.y,Co.z],Ru(i,xs,sa,qi,aa)))}clampPoint(t,i){return i.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Al.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(Al).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(is[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),is[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),is[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),is[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),is[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),is[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),is[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),is[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(is)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}co.prototype.isBox3=!0;const is=[new mt,new mt,new mt,new mt,new mt,new mt,new mt,new mt],Al=new mt,nt=new co,xs=new mt,sa=new mt,qi=new mt,lr=new mt,Vo=new mt,Ki=new mt,os=new mt,aa=new mt,Co=new mt,au=new mt;function Ru(m,t,i,a,u){for(let d=0,f=m.length-3;d<=f;d+=3){au.fromArray(m,d);const v=u.x*Math.abs(au.x)+u.y*Math.abs(au.y)+u.z*Math.abs(au.z),_=t.dot(au),y=i.dot(au),E=a.dot(au);if(Math.max(-Math.max(_,y,E),Math.min(_,y,E))>v)return!1}return!0}const mh=new co,ua=new mt,bs=new mt,zi=new mt;class ws{constructor(t=new mt,i=-1){this.center=t,this.radius=i}set(t,i){return this.center.copy(t),this.radius=i,this}setFromPoints(t,i){const a=this.center;i!==void 0?a.copy(i):mh.setFromPoints(t).getCenter(a);let u=0;for(let d=0,f=t.length;d<f;d++)u=Math.max(u,a.distanceToSquared(t[d]));return this.radius=Math.sqrt(u),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const i=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=i*i}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,i){const a=this.center.distanceToSquared(t);return i.copy(t),a>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){zi.subVectors(t,this.center);const i=zi.lengthSq();if(i>this.radius*this.radius){const a=Math.sqrt(i),u=.5*(a-this.radius);this.center.add(zi.multiplyScalar(u/a)),this.radius+=u}return this}union(t){return bs.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(ua.copy(t.center).add(bs)),this.expandByPoint(ua.copy(t.center).sub(bs)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Ss=new mt,gh=new mt,Wo=new mt,js=new mt,Vs=new mt,fo=new mt,Pl=new mt;class Ro{constructor(t=new mt,i=new mt(0,0,-1)){this.origin=t,this.direction=i}set(t,i){return this.origin.copy(t),this.direction.copy(i),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,i){return i.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Ss)),this}closestPointToPoint(t,i){i.subVectors(t,this.origin);const a=i.dot(this.direction);return a<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(a).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const i=Ss.subVectors(t,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(t):(Ss.copy(this.direction).multiplyScalar(i).add(this.origin),Ss.distanceToSquared(t))}distanceSqToSegment(t,i,a,u){gh.copy(t).add(i).multiplyScalar(.5),Wo.copy(i).sub(t).normalize(),js.copy(this.origin).sub(gh);const d=.5*t.distanceTo(i),f=-this.direction.dot(Wo),v=js.dot(this.direction),_=-js.dot(Wo),y=js.lengthSq(),E=Math.abs(1-f*f);let A,M,P,O;if(E>0)if(A=f*_-v,M=f*v-_,O=d*E,A>=0)if(M>=-O)if(M<=O){const U=1/E;A*=U,M*=U,P=A*(A+f*M+2*v)+M*(f*A+M+2*_)+y}else M=d,A=Math.max(0,-(f*M+v)),P=-A*A+M*(M+2*_)+y;else M=-d,A=Math.max(0,-(f*M+v)),P=-A*A+M*(M+2*_)+y;else M<=-O?(A=Math.max(0,-(-f*d+v)),M=A>0?-d:Math.min(Math.max(-d,-_),d),P=-A*A+M*(M+2*_)+y):M<=O?(A=0,M=Math.min(Math.max(-d,-_),d),P=M*(M+2*_)+y):(A=Math.max(0,-(f*d+v)),M=A>0?d:Math.min(Math.max(-d,-_),d),P=-A*A+M*(M+2*_)+y);else M=f>0?-d:d,A=Math.max(0,-(f*M+v)),P=-A*A+M*(M+2*_)+y;return a&&a.copy(this.direction).multiplyScalar(A).add(this.origin),u&&u.copy(Wo).multiplyScalar(M).add(gh),P}intersectSphere(t,i){Ss.subVectors(t.center,this.origin);const a=Ss.dot(this.direction),u=Ss.dot(Ss)-a*a,d=t.radius*t.radius;if(u>d)return null;const f=Math.sqrt(d-u),v=a-f,_=a+f;return v<0&&_<0?null:v<0?this.at(_,i):this.at(v,i)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const i=t.normal.dot(this.direction);if(i===0)return t.distanceToPoint(this.origin)===0?0:null;const a=-(this.origin.dot(t.normal)+t.constant)/i;return a>=0?a:null}intersectPlane(t,i){const a=this.distanceToPlane(t);return a===null?null:this.at(a,i)}intersectsPlane(t){const i=t.distanceToPoint(this.origin);return i===0?!0:t.normal.dot(this.direction)*i<0}intersectBox(t,i){let a,u,d,f,v,_;const y=1/this.direction.x,E=1/this.direction.y,A=1/this.direction.z,M=this.origin;return y>=0?(a=(t.min.x-M.x)*y,u=(t.max.x-M.x)*y):(a=(t.max.x-M.x)*y,u=(t.min.x-M.x)*y),E>=0?(d=(t.min.y-M.y)*E,f=(t.max.y-M.y)*E):(d=(t.max.y-M.y)*E,f=(t.min.y-M.y)*E),a>f||d>u?null:((d>a||a!=a)&&(a=d),(f<u||u!=u)&&(u=f),A>=0?(v=(t.min.z-M.z)*A,_=(t.max.z-M.z)*A):(v=(t.max.z-M.z)*A,_=(t.min.z-M.z)*A),a>_||v>u?null:((v>a||a!=a)&&(a=v),(_<u||u!=u)&&(u=_),u<0?null:this.at(a>=0?a:u,i)))}intersectsBox(t){return this.intersectBox(t,Ss)!==null}intersectTriangle(t,i,a,u,d){Vs.subVectors(i,t),fo.subVectors(a,t),Pl.crossVectors(Vs,fo);let f,v=this.direction.dot(Pl);if(v>0){if(u)return null;f=1}else{if(!(v<0))return null;f=-1,v=-v}js.subVectors(this.origin,t);const _=f*this.direction.dot(fo.crossVectors(js,fo));if(_<0)return null;const y=f*this.direction.dot(Vs.cross(js));if(y<0||_+y>v)return null;const E=-f*js.dot(Pl);return E<0?null:this.at(E/v,d)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Tn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,i,a,u,d,f,v,_,y,E,A,M,P,O,U,D){const Z=this.elements;return Z[0]=t,Z[4]=i,Z[8]=a,Z[12]=u,Z[1]=d,Z[5]=f,Z[9]=v,Z[13]=_,Z[2]=y,Z[6]=E,Z[10]=A,Z[14]=M,Z[3]=P,Z[7]=O,Z[11]=U,Z[15]=D,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Tn().fromArray(this.elements)}copy(t){const i=this.elements,a=t.elements;return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],i[9]=a[9],i[10]=a[10],i[11]=a[11],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15],this}copyPosition(t){const i=this.elements,a=t.elements;return i[12]=a[12],i[13]=a[13],i[14]=a[14],this}setFromMatrix3(t){const i=t.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(t,i,a){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),a.setFromMatrixColumn(this,2),this}makeBasis(t,i,a){return this.set(t.x,i.x,a.x,0,t.y,i.y,a.y,0,t.z,i.z,a.z,0,0,0,0,1),this}extractRotation(t){const i=this.elements,a=t.elements,u=1/Io.setFromMatrixColumn(t,0).length(),d=1/Io.setFromMatrixColumn(t,1).length(),f=1/Io.setFromMatrixColumn(t,2).length();return i[0]=a[0]*u,i[1]=a[1]*u,i[2]=a[2]*u,i[3]=0,i[4]=a[4]*d,i[5]=a[5]*d,i[6]=a[6]*d,i[7]=0,i[8]=a[8]*f,i[9]=a[9]*f,i[10]=a[10]*f,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const i=this.elements,a=t.x,u=t.y,d=t.z,f=Math.cos(a),v=Math.sin(a),_=Math.cos(u),y=Math.sin(u),E=Math.cos(d),A=Math.sin(d);if(t.order==="XYZ"){const M=f*E,P=f*A,O=v*E,U=v*A;i[0]=_*E,i[4]=-_*A,i[8]=y,i[1]=P+O*y,i[5]=M-U*y,i[9]=-v*_,i[2]=U-M*y,i[6]=O+P*y,i[10]=f*_}else if(t.order==="YXZ"){const M=_*E,P=_*A,O=y*E,U=y*A;i[0]=M+U*v,i[4]=O*v-P,i[8]=f*y,i[1]=f*A,i[5]=f*E,i[9]=-v,i[2]=P*v-O,i[6]=U+M*v,i[10]=f*_}else if(t.order==="ZXY"){const M=_*E,P=_*A,O=y*E,U=y*A;i[0]=M-U*v,i[4]=-f*A,i[8]=O+P*v,i[1]=P+O*v,i[5]=f*E,i[9]=U-M*v,i[2]=-f*y,i[6]=v,i[10]=f*_}else if(t.order==="ZYX"){const M=f*E,P=f*A,O=v*E,U=v*A;i[0]=_*E,i[4]=O*y-P,i[8]=M*y+U,i[1]=_*A,i[5]=U*y+M,i[9]=P*y-O,i[2]=-y,i[6]=v*_,i[10]=f*_}else if(t.order==="YZX"){const M=f*_,P=f*y,O=v*_,U=v*y;i[0]=_*E,i[4]=U-M*A,i[8]=O*A+P,i[1]=A,i[5]=f*E,i[9]=-v*E,i[2]=-y*E,i[6]=P*A+O,i[10]=M-U*A}else if(t.order==="XZY"){const M=f*_,P=f*y,O=v*_,U=v*y;i[0]=_*E,i[4]=-A,i[8]=y*E,i[1]=M*A+U,i[5]=f*E,i[9]=P*A-O,i[2]=O*A-P,i[6]=v*E,i[10]=U*A+M}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(t){return this.compose(vf,t,fc)}lookAt(t,i,a){const u=this.elements;return po.subVectors(t,i),po.lengthSq()===0&&(po.z=1),po.normalize(),la.crossVectors(a,po),la.lengthSq()===0&&(Math.abs(a.z)===1?po.x+=1e-4:po.z+=1e-4,po.normalize(),la.crossVectors(a,po)),la.normalize(),Li.crossVectors(po,la),u[0]=la.x,u[4]=Li.x,u[8]=po.x,u[1]=la.y,u[5]=Li.y,u[9]=po.y,u[2]=la.z,u[6]=Li.z,u[10]=po.z,this}multiply(t,i){return i!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,i)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,i){const a=t.elements,u=i.elements,d=this.elements,f=a[0],v=a[4],_=a[8],y=a[12],E=a[1],A=a[5],M=a[9],P=a[13],O=a[2],U=a[6],D=a[10],Z=a[14],rt=a[3],gt=a[7],pt=a[11],Mt=a[15],At=u[0],Et=u[4],Lt=u[8],Ie=u[12],_e=u[1],ye=u[5],me=u[9],Ht=u[13],ae=u[2],Ze=u[6],Xe=u[10],je=u[14],gn=u[3],Sn=u[7],In=u[11],Rn=u[15];return d[0]=f*At+v*_e+_*ae+y*gn,d[4]=f*Et+v*ye+_*Ze+y*Sn,d[8]=f*Lt+v*me+_*Xe+y*In,d[12]=f*Ie+v*Ht+_*je+y*Rn,d[1]=E*At+A*_e+M*ae+P*gn,d[5]=E*Et+A*ye+M*Ze+P*Sn,d[9]=E*Lt+A*me+M*Xe+P*In,d[13]=E*Ie+A*Ht+M*je+P*Rn,d[2]=O*At+U*_e+D*ae+Z*gn,d[6]=O*Et+U*ye+D*Ze+Z*Sn,d[10]=O*Lt+U*me+D*Xe+Z*In,d[14]=O*Ie+U*Ht+D*je+Z*Rn,d[3]=rt*At+gt*_e+pt*ae+Mt*gn,d[7]=rt*Et+gt*ye+pt*Ze+Mt*Sn,d[11]=rt*Lt+gt*me+pt*Xe+Mt*In,d[15]=rt*Ie+gt*Ht+pt*je+Mt*Rn,this}multiplyScalar(t){const i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this}determinant(){const t=this.elements,i=t[0],a=t[4],u=t[8],d=t[12],f=t[1],v=t[5],_=t[9],y=t[13],E=t[2],A=t[6],M=t[10],P=t[14];return t[3]*(+d*_*A-u*y*A-d*v*M+a*y*M+u*v*P-a*_*P)+t[7]*(+i*_*P-i*y*M+d*f*M-u*f*P+u*y*E-d*_*E)+t[11]*(+i*y*A-i*v*P-d*f*A+a*f*P+d*v*E-a*y*E)+t[15]*(-u*v*E-i*_*A+i*v*M+u*f*A-a*f*M+a*_*E)}transpose(){const t=this.elements;let i;return i=t[1],t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i,this}setPosition(t,i,a){const u=this.elements;return t.isVector3?(u[12]=t.x,u[13]=t.y,u[14]=t.z):(u[12]=t,u[13]=i,u[14]=a),this}invert(){const t=this.elements,i=t[0],a=t[1],u=t[2],d=t[3],f=t[4],v=t[5],_=t[6],y=t[7],E=t[8],A=t[9],M=t[10],P=t[11],O=t[12],U=t[13],D=t[14],Z=t[15],rt=A*D*y-U*M*y+U*_*P-v*D*P-A*_*Z+v*M*Z,gt=O*M*y-E*D*y-O*_*P+f*D*P+E*_*Z-f*M*Z,pt=E*U*y-O*A*y+O*v*P-f*U*P-E*v*Z+f*A*Z,Mt=O*A*_-E*U*_-O*v*M+f*U*M+E*v*D-f*A*D,At=i*rt+a*gt+u*pt+d*Mt;if(At===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Et=1/At;return t[0]=rt*Et,t[1]=(U*M*d-A*D*d-U*u*P+a*D*P+A*u*Z-a*M*Z)*Et,t[2]=(v*D*d-U*_*d+U*u*y-a*D*y-v*u*Z+a*_*Z)*Et,t[3]=(A*_*d-v*M*d-A*u*y+a*M*y+v*u*P-a*_*P)*Et,t[4]=gt*Et,t[5]=(E*D*d-O*M*d+O*u*P-i*D*P-E*u*Z+i*M*Z)*Et,t[6]=(O*_*d-f*D*d-O*u*y+i*D*y+f*u*Z-i*_*Z)*Et,t[7]=(f*M*d-E*_*d+E*u*y-i*M*y-f*u*P+i*_*P)*Et,t[8]=pt*Et,t[9]=(O*A*d-E*U*d-O*a*P+i*U*P+E*a*Z-i*A*Z)*Et,t[10]=(f*U*d-O*v*d+O*a*y-i*U*y-f*a*Z+i*v*Z)*Et,t[11]=(E*v*d-f*A*d-E*a*y+i*A*y+f*a*P-i*v*P)*Et,t[12]=Mt*Et,t[13]=(E*U*u-O*A*u+O*a*M-i*U*M-E*a*D+i*A*D)*Et,t[14]=(O*v*u-f*U*u-O*a*_+i*U*_+f*a*D-i*v*D)*Et,t[15]=(f*A*u-E*v*u+E*a*_-i*A*_-f*a*M+i*v*M)*Et,this}scale(t){const i=this.elements,a=t.x,u=t.y,d=t.z;return i[0]*=a,i[4]*=u,i[8]*=d,i[1]*=a,i[5]*=u,i[9]*=d,i[2]*=a,i[6]*=u,i[10]*=d,i[3]*=a,i[7]*=u,i[11]*=d,this}getMaxScaleOnAxis(){const t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],a=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],u=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,a,u))}makeTranslation(t,i,a){return this.set(1,0,0,t,0,1,0,i,0,0,1,a,0,0,0,1),this}makeRotationX(t){const i=Math.cos(t),a=Math.sin(t);return this.set(1,0,0,0,0,i,-a,0,0,a,i,0,0,0,0,1),this}makeRotationY(t){const i=Math.cos(t),a=Math.sin(t);return this.set(i,0,a,0,0,1,0,0,-a,0,i,0,0,0,0,1),this}makeRotationZ(t){const i=Math.cos(t),a=Math.sin(t);return this.set(i,-a,0,0,a,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,i){const a=Math.cos(i),u=Math.sin(i),d=1-a,f=t.x,v=t.y,_=t.z,y=d*f,E=d*v;return this.set(y*f+a,y*v-u*_,y*_+u*v,0,y*v+u*_,E*v+a,E*_-u*f,0,y*_-u*v,E*_+u*f,d*_*_+a,0,0,0,0,1),this}makeScale(t,i,a){return this.set(t,0,0,0,0,i,0,0,0,0,a,0,0,0,0,1),this}makeShear(t,i,a,u,d,f){return this.set(1,a,d,0,t,1,f,0,i,u,1,0,0,0,0,1),this}compose(t,i,a){const u=this.elements,d=i._x,f=i._y,v=i._z,_=i._w,y=d+d,E=f+f,A=v+v,M=d*y,P=d*E,O=d*A,U=f*E,D=f*A,Z=v*A,rt=_*y,gt=_*E,pt=_*A,Mt=a.x,At=a.y,Et=a.z;return u[0]=(1-(U+Z))*Mt,u[1]=(P+pt)*Mt,u[2]=(O-gt)*Mt,u[3]=0,u[4]=(P-pt)*At,u[5]=(1-(M+Z))*At,u[6]=(D+rt)*At,u[7]=0,u[8]=(O+gt)*Et,u[9]=(D-rt)*Et,u[10]=(1-(M+U))*Et,u[11]=0,u[12]=t.x,u[13]=t.y,u[14]=t.z,u[15]=1,this}decompose(t,i,a){const u=this.elements;let d=Io.set(u[0],u[1],u[2]).length();const f=Io.set(u[4],u[5],u[6]).length(),v=Io.set(u[8],u[9],u[10]).length();this.determinant()<0&&(d=-d),t.x=u[12],t.y=u[13],t.z=u[14],Ts.copy(this);const _=1/d,y=1/f,E=1/v;return Ts.elements[0]*=_,Ts.elements[1]*=_,Ts.elements[2]*=_,Ts.elements[4]*=y,Ts.elements[5]*=y,Ts.elements[6]*=y,Ts.elements[8]*=E,Ts.elements[9]*=E,Ts.elements[10]*=E,i.setFromRotationMatrix(Ts),a.x=d,a.y=f,a.z=v,this}makePerspective(t,i,a,u,d,f){f===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const v=this.elements,_=2*d/(i-t),y=2*d/(a-u),E=(i+t)/(i-t),A=(a+u)/(a-u),M=-(f+d)/(f-d),P=-2*f*d/(f-d);return v[0]=_,v[4]=0,v[8]=E,v[12]=0,v[1]=0,v[5]=y,v[9]=A,v[13]=0,v[2]=0,v[6]=0,v[10]=M,v[14]=P,v[3]=0,v[7]=0,v[11]=-1,v[15]=0,this}makeOrthographic(t,i,a,u,d,f){const v=this.elements,_=1/(i-t),y=1/(a-u),E=1/(f-d),A=(i+t)*_,M=(a+u)*y,P=(f+d)*E;return v[0]=2*_,v[4]=0,v[8]=0,v[12]=-A,v[1]=0,v[5]=2*y,v[9]=0,v[13]=-M,v[2]=0,v[6]=0,v[10]=-2*E,v[14]=-P,v[3]=0,v[7]=0,v[11]=0,v[15]=1,this}equals(t){const i=this.elements,a=t.elements;for(let u=0;u<16;u++)if(i[u]!==a[u])return!1;return!0}fromArray(t,i=0){for(let a=0;a<16;a++)this.elements[a]=t[a+i];return this}toArray(t=[],i=0){const a=this.elements;return t[i]=a[0],t[i+1]=a[1],t[i+2]=a[2],t[i+3]=a[3],t[i+4]=a[4],t[i+5]=a[5],t[i+6]=a[6],t[i+7]=a[7],t[i+8]=a[8],t[i+9]=a[9],t[i+10]=a[10],t[i+11]=a[11],t[i+12]=a[12],t[i+13]=a[13],t[i+14]=a[14],t[i+15]=a[15],t}}Tn.prototype.isMatrix4=!0;const Io=new mt,Ts=new Tn,vf=new mt(0,0,0),fc=new mt(1,1,1),la=new mt,Li=new mt,po=new mt,vh=new Tn,Xo=new Xi;class Ws{constructor(t=0,i=0,a=0,u=Ws.DefaultOrder){this._x=t,this._y=i,this._z=a,this._order=u}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,a,u=this._order){return this._x=t,this._y=i,this._z=a,this._order=u,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,a=!0){const u=t.elements,d=u[0],f=u[4],v=u[8],_=u[1],y=u[5],E=u[9],A=u[2],M=u[6],P=u[10];switch(i){case"XYZ":this._y=Math.asin(Hi(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(-E,P),this._z=Math.atan2(-f,d)):(this._x=Math.atan2(M,y),this._z=0);break;case"YXZ":this._x=Math.asin(-Hi(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(v,P),this._z=Math.atan2(_,y)):(this._y=Math.atan2(-A,d),this._z=0);break;case"ZXY":this._x=Math.asin(Hi(M,-1,1)),Math.abs(M)<.9999999?(this._y=Math.atan2(-A,P),this._z=Math.atan2(-f,y)):(this._y=0,this._z=Math.atan2(_,d));break;case"ZYX":this._y=Math.asin(-Hi(A,-1,1)),Math.abs(A)<.9999999?(this._x=Math.atan2(M,P),this._z=Math.atan2(_,d)):(this._x=0,this._z=Math.atan2(-f,y));break;case"YZX":this._z=Math.asin(Hi(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(-E,y),this._y=Math.atan2(-A,d)):(this._x=0,this._y=Math.atan2(v,P));break;case"XZY":this._z=Math.asin(-Hi(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(M,y),this._y=Math.atan2(v,d)):(this._x=Math.atan2(-E,P),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,a===!0&&this._onChangeCallback(),this}setFromQuaternion(t,i,a){return vh.makeRotationFromQuaternion(t),this.setFromRotationMatrix(vh,i,a)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return Xo.setFromEuler(this),this.setFromQuaternion(Xo,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new mt(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Ws.prototype.isEuler=!0,Ws.DefaultOrder="XYZ",Ws.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Iu{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!=0}}let La=0;const pc=new mt,Zr=new Xi,Es=new Tn,_h=new mt,Lu=new mt,Cl=new mt,uu=new Xi,Rl=new mt(1,0,0),Ou=new mt(0,1,0),yh=new mt(0,0,1),mc={type:"added"},gc={type:"removed"};class vr extends Ho{constructor(){super(),Object.defineProperty(this,"id",{value:La++}),this.uuid=jo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=vr.DefaultUp.clone();const t=new mt,i=new Ws,a=new Xi,u=new mt(1,1,1);i._onChange(function(){a.setFromEuler(i,!1)}),a._onChange(function(){i.setFromQuaternion(a,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:u},modelViewMatrix:{value:new Tn},normalMatrix:{value:new $i}}),this.matrix=new Tn,this.matrixWorld=new Tn,this.matrixAutoUpdate=vr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Iu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Zr.setFromAxisAngle(t,i),this.quaternion.multiply(Zr),this}rotateOnWorldAxis(t,i){return Zr.setFromAxisAngle(t,i),this.quaternion.premultiply(Zr),this}rotateX(t){return this.rotateOnAxis(Rl,t)}rotateY(t){return this.rotateOnAxis(Ou,t)}rotateZ(t){return this.rotateOnAxis(yh,t)}translateOnAxis(t,i){return pc.copy(t).applyQuaternion(this.quaternion),this.position.add(pc.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(Rl,t)}translateY(t){return this.translateOnAxis(Ou,t)}translateZ(t){return this.translateOnAxis(yh,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Es.copy(this.matrixWorld).invert())}lookAt(t,i,a){t.isVector3?_h.copy(t):_h.set(t,i,a);const u=this.parent;this.updateWorldMatrix(!0,!1),Lu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Es.lookAt(Lu,_h,this.up):Es.lookAt(_h,Lu,this.up),this.quaternion.setFromRotationMatrix(Es),u&&(Es.extractRotation(u.matrixWorld),Zr.setFromRotationMatrix(Es),this.quaternion.premultiply(Zr.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(mc)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}const i=this.children.indexOf(t);return i!==-1&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(gc)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(gc)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Es.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Es.multiply(t.parent.matrixWorld)),t.applyMatrix4(Es),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let a=0,u=this.children.length;a<u;a++){const d=this.children[a].getObjectByProperty(t,i);if(d!==void 0)return d}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Lu,t,Cl),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Lu,uu,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let a=0,u=i.length;a<u;a++)i[a].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const i=this.children;for(let a=0,u=i.length;a<u;a++)i[a].traverseVisible(t)}traverseAncestors(t){const i=this.parent;i!==null&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let a=0,u=i.length;a<u;a++)i[a].updateMatrixWorld(t)}updateWorldMatrix(t,i){const a=this.parent;if(t===!0&&a!==null&&a.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const u=this.children;for(let d=0,f=u.length;d<f;d++)u[d].updateWorldMatrix(!1,!0)}}toJSON(t){const i=t===void 0||typeof t=="string",a={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},a.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const u={};function d(v,_){return v[_.uuid]===void 0&&(v[_.uuid]=_.toJSON(t)),_.uuid}if(u.uuid=this.uuid,u.type=this.type,this.name!==""&&(u.name=this.name),this.castShadow===!0&&(u.castShadow=!0),this.receiveShadow===!0&&(u.receiveShadow=!0),this.visible===!1&&(u.visible=!1),this.frustumCulled===!1&&(u.frustumCulled=!1),this.renderOrder!==0&&(u.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(u.userData=this.userData),u.layers=this.layers.mask,u.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(u.matrixAutoUpdate=!1),this.isInstancedMesh&&(u.type="InstancedMesh",u.count=this.count,u.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(u.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?u.background=this.background.toJSON():this.background.isTexture&&(u.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(u.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){u.geometry=d(t.geometries,this.geometry);const v=this.geometry.parameters;if(v!==void 0&&v.shapes!==void 0){const _=v.shapes;if(Array.isArray(_))for(let y=0,E=_.length;y<E;y++){const A=_[y];d(t.shapes,A)}else d(t.shapes,_)}}if(this.isSkinnedMesh&&(u.bindMode=this.bindMode,u.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(d(t.skeletons,this.skeleton),u.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const v=[];for(let _=0,y=this.material.length;_<y;_++)v.push(d(t.materials,this.material[_]));u.material=v}else u.material=d(t.materials,this.material);if(this.children.length>0){u.children=[];for(let v=0;v<this.children.length;v++)u.children.push(this.children[v].toJSON(t).object)}if(this.animations.length>0){u.animations=[];for(let v=0;v<this.animations.length;v++){const _=this.animations[v];u.animations.push(d(t.animations,_))}}if(i){const v=f(t.geometries),_=f(t.materials),y=f(t.textures),E=f(t.images),A=f(t.shapes),M=f(t.skeletons),P=f(t.animations);v.length>0&&(a.geometries=v),_.length>0&&(a.materials=_),y.length>0&&(a.textures=y),E.length>0&&(a.images=E),A.length>0&&(a.shapes=A),M.length>0&&(a.skeletons=M),P.length>0&&(a.animations=P)}return a.object=u,a;function f(v){const _=[];for(const y in v){const E=v[y];delete E.metadata,_.push(E)}return _}}clone(t){return new this.constructor().copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),i===!0)for(let a=0;a<t.children.length;a++){const u=t.children[a];this.add(u.clone())}return this}}vr.DefaultUp=new mt(0,1,0),vr.DefaultMatrixAutoUpdate=!0,vr.prototype.isObject3D=!0;const Ms=new mt,As=new mt,xh=new mt,ha=new mt,Oa=new mt,ca=new mt,wd=new mt,lu=new mt,vc=new mt,Il=new mt;class bi{constructor(t=new mt,i=new mt,a=new mt){this.a=t,this.b=i,this.c=a}static getNormal(t,i,a,u){u.subVectors(a,i),Ms.subVectors(t,i),u.cross(Ms);const d=u.lengthSq();return d>0?u.multiplyScalar(1/Math.sqrt(d)):u.set(0,0,0)}static getBarycoord(t,i,a,u,d){Ms.subVectors(u,i),As.subVectors(a,i),xh.subVectors(t,i);const f=Ms.dot(Ms),v=Ms.dot(As),_=Ms.dot(xh),y=As.dot(As),E=As.dot(xh),A=f*y-v*v;if(A===0)return d.set(-2,-1,-1);const M=1/A,P=(y*_-v*E)*M,O=(f*E-v*_)*M;return d.set(1-P-O,O,P)}static containsPoint(t,i,a,u){return this.getBarycoord(t,i,a,u,ha),ha.x>=0&&ha.y>=0&&ha.x+ha.y<=1}static getUV(t,i,a,u,d,f,v,_){return this.getBarycoord(t,i,a,u,ha),_.set(0,0),_.addScaledVector(d,ha.x),_.addScaledVector(f,ha.y),_.addScaledVector(v,ha.z),_}static isFrontFacing(t,i,a,u){return Ms.subVectors(a,i),As.subVectors(t,i),Ms.cross(As).dot(u)<0}set(t,i,a){return this.a.copy(t),this.b.copy(i),this.c.copy(a),this}setFromPointsAndIndices(t,i,a,u){return this.a.copy(t[i]),this.b.copy(t[a]),this.c.copy(t[u]),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Ms.subVectors(this.c,this.b),As.subVectors(this.a,this.b),.5*Ms.cross(As).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return bi.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,i){return bi.getBarycoord(t,this.a,this.b,this.c,i)}getUV(t,i,a,u,d){return bi.getUV(t,this.a,this.b,this.c,i,a,u,d)}containsPoint(t){return bi.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return bi.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,i){const a=this.a,u=this.b,d=this.c;let f,v;Oa.subVectors(u,a),ca.subVectors(d,a),lu.subVectors(t,a);const _=Oa.dot(lu),y=ca.dot(lu);if(_<=0&&y<=0)return i.copy(a);vc.subVectors(t,u);const E=Oa.dot(vc),A=ca.dot(vc);if(E>=0&&A<=E)return i.copy(u);const M=_*A-E*y;if(M<=0&&_>=0&&E<=0)return f=_/(_-E),i.copy(a).addScaledVector(Oa,f);Il.subVectors(t,d);const P=Oa.dot(Il),O=ca.dot(Il);if(O>=0&&P<=O)return i.copy(d);const U=P*y-_*O;if(U<=0&&y>=0&&O<=0)return v=y/(y-O),i.copy(a).addScaledVector(ca,v);const D=E*O-P*A;if(D<=0&&A-E>=0&&P-O>=0)return wd.subVectors(d,u),v=(A-E)/(A-E+(P-O)),i.copy(u).addScaledVector(wd,v);const Z=1/(D+U+M);return f=U*Z,v=M*Z,i.copy(a).addScaledVector(Oa,f).addScaledVector(ca,v)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let Sd=0;class ji extends Ho{constructor(){super(),Object.defineProperty(this,"id",{value:Sd++}),this.uuid=jo(),this.name="",this.type="Material",this.fog=!0,this.blending=Y,this.side=kt,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=oe,this.blendDst=de,this.blendEquation=ee,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Cr,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Nn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=pi,this.stencilZFail=pi,this.stencilZPass=pi,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const i in t){const a=t[i];if(a===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if(i==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=a===V;continue}const u=this[i];u!==void 0?u&&u.isColor?u.set(a):u&&u.isVector3&&a&&a.isVector3?u.copy(a):this[i]=a:console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.")}}toJSON(t){const i=t===void 0||typeof t=="string";i&&(t={textures:{},images:{}});const a={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function u(d){const f=[];for(const v in d){const _=d[v];delete _.metadata,f.push(_)}return f}if(a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.color&&this.color.isColor&&(a.color=this.color.getHex()),this.roughness!==void 0&&(a.roughness=this.roughness),this.metalness!==void 0&&(a.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(a.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(a.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(a.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(a.specular=this.specular.getHex()),this.shininess!==void 0&&(a.shininess=this.shininess),this.clearcoat!==void 0&&(a.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(a.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(a.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(a.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(a.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,a.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(a.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(a.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(a.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(a.lightMap=this.lightMap.toJSON(t).uuid,a.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(a.aoMap=this.aoMap.toJSON(t).uuid,a.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(a.bumpMap=this.bumpMap.toJSON(t).uuid,a.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(a.normalMap=this.normalMap.toJSON(t).uuid,a.normalMapType=this.normalMapType,a.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(a.displacementMap=this.displacementMap.toJSON(t).uuid,a.displacementScale=this.displacementScale,a.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(a.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(a.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(a.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(a.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(a.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(a.combine=this.combine)),this.envMapIntensity!==void 0&&(a.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(a.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(a.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(a.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(a.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(a.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(a.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(a.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&(a.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(a.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(a.size=this.size),this.shadowSide!==null&&(a.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(a.sizeAttenuation=this.sizeAttenuation),this.blending!==Y&&(a.blending=this.blending),this.side!==kt&&(a.side=this.side),this.vertexColors&&(a.vertexColors=!0),this.opacity<1&&(a.opacity=this.opacity),this.transparent===!0&&(a.transparent=this.transparent),a.depthFunc=this.depthFunc,a.depthTest=this.depthTest,a.depthWrite=this.depthWrite,a.colorWrite=this.colorWrite,a.stencilWrite=this.stencilWrite,a.stencilWriteMask=this.stencilWriteMask,a.stencilFunc=this.stencilFunc,a.stencilRef=this.stencilRef,a.stencilFuncMask=this.stencilFuncMask,a.stencilFail=this.stencilFail,a.stencilZFail=this.stencilZFail,a.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(a.rotation=this.rotation),this.polygonOffset===!0&&(a.polygonOffset=!0),this.polygonOffsetFactor!==0&&(a.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(a.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(a.linewidth=this.linewidth),this.dashSize!==void 0&&(a.dashSize=this.dashSize),this.gapSize!==void 0&&(a.gapSize=this.gapSize),this.scale!==void 0&&(a.scale=this.scale),this.dithering===!0&&(a.dithering=!0),this.alphaTest>0&&(a.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(a.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(a.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(a.wireframe=this.wireframe),this.wireframeLinewidth>1&&(a.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(a.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(a.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(a.morphTargets=!0),this.morphNormals===!0&&(a.morphNormals=!0),this.flatShading===!0&&(a.flatShading=this.flatShading),this.visible===!1&&(a.visible=!1),this.toneMapped===!1&&(a.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(a.userData=this.userData),i){const d=u(t.textures),f=u(t.images);d.length>0&&(a.textures=d),f.length>0&&(a.images=f)}return a}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const i=t.clippingPlanes;let a=null;if(i!==null){const u=i.length;a=new Array(u);for(let d=0;d!==u;++d)a[d]=i[d].clone()}return this.clippingPlanes=a,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}ji.prototype.isMaterial=!0;const br={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Qi={h:0,s:0,l:0},da={h:0,s:0,l:0};function hu(m,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?m+6*(t-m)*i:i<.5?t:i<2/3?m+6*(t-m)*(2/3-i):m}function _c(m){return m<.04045?.0773993808*m:Math.pow(.9478672986*m+.0521327014,2.4)}function Td(m){return m<.0031308?12.92*m:1.055*Math.pow(m,.41666)-.055}class pn{constructor(t,i,a){return i===void 0&&a===void 0?this.set(t):this.setRGB(t,i,a)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,i,a){return this.r=t,this.g=i,this.b=a,this}setHSL(t,i,a){if(t=fh(t,1),i=Hi(i,0,1),a=Hi(a,0,1),i===0)this.r=this.g=this.b=a;else{const u=a<=.5?a*(1+i):a+i-a*i,d=2*a-u;this.r=hu(d,u,t+1/3),this.g=hu(d,u,t),this.b=hu(d,u,t-1/3)}return this}setStyle(t){function i(u){u!==void 0&&parseFloat(u)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let a;if(a=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let u;const d=a[1],f=a[2];switch(d){case"rgb":case"rgba":if(u=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return this.r=Math.min(255,parseInt(u[1],10))/255,this.g=Math.min(255,parseInt(u[2],10))/255,this.b=Math.min(255,parseInt(u[3],10))/255,i(u[4]),this;if(u=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return this.r=Math.min(100,parseInt(u[1],10))/100,this.g=Math.min(100,parseInt(u[2],10))/100,this.b=Math.min(100,parseInt(u[3],10))/100,i(u[4]),this;break;case"hsl":case"hsla":if(u=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f)){const v=parseFloat(u[1])/360,_=parseInt(u[2],10)/100,y=parseInt(u[3],10)/100;return i(u[4]),this.setHSL(v,_,y)}}}else if(a=/^\#([A-Fa-f\d]+)$/.exec(t)){const u=a[1],d=u.length;if(d===3)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(d===6)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const i=br[t.toLowerCase()];return i!==void 0?this.setHex(i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,i=2){return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this}copyLinearToGamma(t,i=2){const a=i>0?1/i:1;return this.r=Math.pow(t.r,a),this.g=Math.pow(t.g,a),this.b=Math.pow(t.b,a),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=_c(t.r),this.g=_c(t.g),this.b=_c(t.b),this}copyLinearToSRGB(t){return this.r=Td(t.r),this.g=Td(t.g),this.b=Td(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const i=this.r,a=this.g,u=this.b,d=Math.max(i,a,u),f=Math.min(i,a,u);let v,_;const y=(f+d)/2;if(f===d)v=0,_=0;else{const E=d-f;switch(_=y<=.5?E/(d+f):E/(2-d-f),d){case i:v=(a-u)/E+(a<u?6:0);break;case a:v=(u-i)/E+2;break;case u:v=(i-a)/E+4}v/=6}return t.h=v,t.s=_,t.l=y,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,i,a){return this.getHSL(Qi),Qi.h+=t,Qi.s+=i,Qi.l+=a,this.setHSL(Qi.h,Qi.s,Qi.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,a){return this.r=t.r+(i.r-t.r)*a,this.g=t.g+(i.g-t.g)*a,this.b=t.b+(i.b-t.b)*a,this}lerpHSL(t,i){this.getHSL(Qi),t.getHSL(da);const a=Pu(Qi.h,da.h,i),u=Pu(Qi.s,da.s,i),d=Pu(Qi.l,da.l,i);return this.setHSL(a,u,d),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}pn.NAMES=br,pn.prototype.isColor=!0,pn.prototype.r=1,pn.prototype.g=1,pn.prototype.b=1;class Vi extends ji{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=yr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this}}Vi.prototype.isMeshBasicMaterial=!0;const Qr=new mt,Du=new He;class hr{constructor(t,i,a){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=i,this.count=t!==void 0?t.length/i:0,this.normalized=a===!0,this.usage=ys,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,i,a){t*=this.itemSize,a*=i.itemSize;for(let u=0,d=this.itemSize;u<d;u++)this.array[t+u]=i.array[a+u];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const i=this.array;let a=0;for(let u=0,d=t.length;u<d;u++){let f=t[u];f===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",u),f=new pn),i[a++]=f.r,i[a++]=f.g,i[a++]=f.b}return this}copyVector2sArray(t){const i=this.array;let a=0;for(let u=0,d=t.length;u<d;u++){let f=t[u];f===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",u),f=new He),i[a++]=f.x,i[a++]=f.y}return this}copyVector3sArray(t){const i=this.array;let a=0;for(let u=0,d=t.length;u<d;u++){let f=t[u];f===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",u),f=new mt),i[a++]=f.x,i[a++]=f.y,i[a++]=f.z}return this}copyVector4sArray(t){const i=this.array;let a=0;for(let u=0,d=t.length;u<d;u++){let f=t[u];f===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",u),f=new Ir),i[a++]=f.x,i[a++]=f.y,i[a++]=f.z,i[a++]=f.w}return this}applyMatrix3(t){if(this.itemSize===2)for(let i=0,a=this.count;i<a;i++)Du.fromBufferAttribute(this,i),Du.applyMatrix3(t),this.setXY(i,Du.x,Du.y);else if(this.itemSize===3)for(let i=0,a=this.count;i<a;i++)Qr.fromBufferAttribute(this,i),Qr.applyMatrix3(t),this.setXYZ(i,Qr.x,Qr.y,Qr.z);return this}applyMatrix4(t){for(let i=0,a=this.count;i<a;i++)Qr.x=this.getX(i),Qr.y=this.getY(i),Qr.z=this.getZ(i),Qr.applyMatrix4(t),this.setXYZ(i,Qr.x,Qr.y,Qr.z);return this}applyNormalMatrix(t){for(let i=0,a=this.count;i<a;i++)Qr.x=this.getX(i),Qr.y=this.getY(i),Qr.z=this.getZ(i),Qr.applyNormalMatrix(t),this.setXYZ(i,Qr.x,Qr.y,Qr.z);return this}transformDirection(t){for(let i=0,a=this.count;i<a;i++)Qr.x=this.getX(i),Qr.y=this.getY(i),Qr.z=this.getZ(i),Qr.transformDirection(t),this.setXYZ(i,Qr.x,Qr.y,Qr.z);return this}set(t,i=0){return this.array.set(t,i),this}getX(t){return this.array[t*this.itemSize]}setX(t,i){return this.array[t*this.itemSize]=i,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,i){return this.array[t*this.itemSize+1]=i,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,i){return this.array[t*this.itemSize+2]=i,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,i){return this.array[t*this.itemSize+3]=i,this}setXY(t,i,a){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=a,this}setXYZ(t,i,a,u){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=a,this.array[t+2]=u,this}setXYZW(t,i,a,u,d){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=a,this.array[t+2]=u,this.array[t+3]=d,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==ys&&(t.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(t.updateRange=this.updateRange),t}}hr.prototype.isBufferAttribute=!0;class Ed extends hr{constructor(t,i,a){super(new Int8Array(t),i,a)}}class zn extends hr{constructor(t,i,a){super(new Uint8Array(t),i,a)}}class Lo extends hr{constructor(t,i,a){super(new Uint8ClampedArray(t),i,a)}}class Xs extends hr{constructor(t,i,a){super(new Int16Array(t),i,a)}}class Nu extends hr{constructor(t,i,a){super(new Uint16Array(t),i,a)}}class Md extends hr{constructor(t,i,a){super(new Int32Array(t),i,a)}}class Fu extends hr{constructor(t,i,a){super(new Uint32Array(t),i,a)}}class qs extends hr{constructor(t,i,a){super(new Uint16Array(t),i,a)}}qs.prototype.isFloat16BufferAttribute=!0;class En extends hr{constructor(t,i,a){super(new Float32Array(t),i,a)}}class yc extends hr{constructor(t,i,a){super(new Float64Array(t),i,a)}}function ss(m){if(m.length===0)return-1/0;let t=m[0];for(let i=1,a=m.length;i<a;++i)m[i]>t&&(t=m[i]);return t}const qr={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Xn(m,t){return new qr[m](t)}let _f=0;const Vr=new Tn,cu=new vr,du=new mt,xo=new co,Ll=new co,Oi=new mt;class Dn extends Ho{constructor(){super(),Object.defineProperty(this,"id",{value:_f++}),this.uuid=jo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(ss(t)>65535?Fu:Nu)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,i){return this.attributes[t]=i,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,i,a=0){this.groups.push({start:t,count:i,materialIndex:a})}clearGroups(){this.groups=[]}setDrawRange(t,i){this.drawRange.start=t,this.drawRange.count=i}applyMatrix4(t){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(t),i.needsUpdate=!0);const a=this.attributes.normal;if(a!==void 0){const d=new $i().getNormalMatrix(t);a.applyNormalMatrix(d),a.needsUpdate=!0}const u=this.attributes.tangent;return u!==void 0&&(u.transformDirection(t),u.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Vr.makeRotationFromQuaternion(t),this.applyMatrix4(Vr),this}rotateX(t){return Vr.makeRotationX(t),this.applyMatrix4(Vr),this}rotateY(t){return Vr.makeRotationY(t),this.applyMatrix4(Vr),this}rotateZ(t){return Vr.makeRotationZ(t),this.applyMatrix4(Vr),this}translate(t,i,a){return Vr.makeTranslation(t,i,a),this.applyMatrix4(Vr),this}scale(t,i,a){return Vr.makeScale(t,i,a),this.applyMatrix4(Vr),this}lookAt(t){return cu.lookAt(t),cu.updateMatrix(),this.applyMatrix4(cu.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(du).negate(),this.translate(du.x,du.y,du.z),this}setFromPoints(t){const i=[];for(let a=0,u=t.length;a<u;a++){const d=t[a];i.push(d.x,d.y,d.z||0)}return this.setAttribute("position",new En(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new co);const t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new mt(-1/0,-1/0,-1/0),new mt(1/0,1/0,1/0));if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),i)for(let a=0,u=i.length;a<u;a++){const d=i[a];xo.setFromBufferAttribute(d),this.morphTargetsRelative?(Oi.addVectors(this.boundingBox.min,xo.min),this.boundingBox.expandByPoint(Oi),Oi.addVectors(this.boundingBox.max,xo.max),this.boundingBox.expandByPoint(Oi)):(this.boundingBox.expandByPoint(xo.min),this.boundingBox.expandByPoint(xo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ws);const t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new mt,1/0);if(t){const a=this.boundingSphere.center;if(xo.setFromBufferAttribute(t),i)for(let d=0,f=i.length;d<f;d++){const v=i[d];Ll.setFromBufferAttribute(v),this.morphTargetsRelative?(Oi.addVectors(xo.min,Ll.min),xo.expandByPoint(Oi),Oi.addVectors(xo.max,Ll.max),xo.expandByPoint(Oi)):(xo.expandByPoint(Ll.min),xo.expandByPoint(Ll.max))}xo.getCenter(a);let u=0;for(let d=0,f=t.count;d<f;d++)Oi.fromBufferAttribute(t,d),u=Math.max(u,a.distanceToSquared(Oi));if(i)for(let d=0,f=i.length;d<f;d++){const v=i[d],_=this.morphTargetsRelative;for(let y=0,E=v.count;y<E;y++)Oi.fromBufferAttribute(v,y),_&&(du.fromBufferAttribute(t,y),Oi.add(du)),u=Math.max(u,a.distanceToSquared(Oi))}this.boundingSphere.radius=Math.sqrt(u),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeFaceNormals(){}computeTangents(){const t=this.index,i=this.attributes;if(t===null||i.position===void 0||i.normal===void 0||i.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const a=t.array,u=i.position.array,d=i.normal.array,f=i.uv.array,v=u.length/3;i.tangent===void 0&&this.setAttribute("tangent",new hr(new Float32Array(4*v),4));const _=i.tangent.array,y=[],E=[];for(let _e=0;_e<v;_e++)y[_e]=new mt,E[_e]=new mt;const A=new mt,M=new mt,P=new mt,O=new He,U=new He,D=new He,Z=new mt,rt=new mt;function gt(_e,ye,me){A.fromArray(u,3*_e),M.fromArray(u,3*ye),P.fromArray(u,3*me),O.fromArray(f,2*_e),U.fromArray(f,2*ye),D.fromArray(f,2*me),M.sub(A),P.sub(A),U.sub(O),D.sub(O);const Ht=1/(U.x*D.y-D.x*U.y);isFinite(Ht)&&(Z.copy(M).multiplyScalar(D.y).addScaledVector(P,-U.y).multiplyScalar(Ht),rt.copy(P).multiplyScalar(U.x).addScaledVector(M,-D.x).multiplyScalar(Ht),y[_e].add(Z),y[ye].add(Z),y[me].add(Z),E[_e].add(rt),E[ye].add(rt),E[me].add(rt))}let pt=this.groups;pt.length===0&&(pt=[{start:0,count:a.length}]);for(let _e=0,ye=pt.length;_e<ye;++_e){const me=pt[_e],Ht=me.start;for(let ae=Ht,Ze=Ht+me.count;ae<Ze;ae+=3)gt(a[ae+0],a[ae+1],a[ae+2])}const Mt=new mt,At=new mt,Et=new mt,Lt=new mt;function Ie(_e){Et.fromArray(d,3*_e),Lt.copy(Et);const ye=y[_e];Mt.copy(ye),Mt.sub(Et.multiplyScalar(Et.dot(ye))).normalize(),At.crossVectors(Lt,ye);const me=At.dot(E[_e])<0?-1:1;_[4*_e]=Mt.x,_[4*_e+1]=Mt.y,_[4*_e+2]=Mt.z,_[4*_e+3]=me}for(let _e=0,ye=pt.length;_e<ye;++_e){const me=pt[_e],Ht=me.start;for(let ae=Ht,Ze=Ht+me.count;ae<Ze;ae+=3)Ie(a[ae+0]),Ie(a[ae+1]),Ie(a[ae+2])}}computeVertexNormals(){const t=this.index,i=this.getAttribute("position");if(i!==void 0){let a=this.getAttribute("normal");if(a===void 0)a=new hr(new Float32Array(3*i.count),3),this.setAttribute("normal",a);else for(let M=0,P=a.count;M<P;M++)a.setXYZ(M,0,0,0);const u=new mt,d=new mt,f=new mt,v=new mt,_=new mt,y=new mt,E=new mt,A=new mt;if(t)for(let M=0,P=t.count;M<P;M+=3){const O=t.getX(M+0),U=t.getX(M+1),D=t.getX(M+2);u.fromBufferAttribute(i,O),d.fromBufferAttribute(i,U),f.fromBufferAttribute(i,D),E.subVectors(f,d),A.subVectors(u,d),E.cross(A),v.fromBufferAttribute(a,O),_.fromBufferAttribute(a,U),y.fromBufferAttribute(a,D),v.add(E),_.add(E),y.add(E),a.setXYZ(O,v.x,v.y,v.z),a.setXYZ(U,_.x,_.y,_.z),a.setXYZ(D,y.x,y.y,y.z)}else for(let M=0,P=i.count;M<P;M+=3)u.fromBufferAttribute(i,M+0),d.fromBufferAttribute(i,M+1),f.fromBufferAttribute(i,M+2),E.subVectors(f,d),A.subVectors(u,d),E.cross(A),a.setXYZ(M+0,E.x,E.y,E.z),a.setXYZ(M+1,E.x,E.y,E.z),a.setXYZ(M+2,E.x,E.y,E.z);this.normalizeNormals(),a.needsUpdate=!0}}merge(t,i){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);i===void 0&&(i=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const a=this.attributes;for(const u in a){if(t.attributes[u]===void 0)continue;const d=a[u].array,f=t.attributes[u],v=f.array,_=f.itemSize*i,y=Math.min(v.length,d.length-_);for(let E=0,A=_;E<y;E++,A++)d[A]=v[E]}return this}normalizeNormals(){const t=this.attributes.normal;for(let i=0,a=t.count;i<a;i++)Oi.fromBufferAttribute(t,i),Oi.normalize(),t.setXYZ(i,Oi.x,Oi.y,Oi.z)}toNonIndexed(){function t(v,_){const y=v.array,E=v.itemSize,A=v.normalized,M=new y.constructor(_.length*E);let P=0,O=0;for(let U=0,D=_.length;U<D;U++){P=v.isInterleavedBufferAttribute?_[U]*v.data.stride+v.offset:_[U]*E;for(let Z=0;Z<E;Z++)M[O++]=y[P++]}return new hr(M,E,A)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new Dn,a=this.index.array,u=this.attributes;for(const v in u){const _=t(u[v],a);i.setAttribute(v,_)}const d=this.morphAttributes;for(const v in d){const _=[],y=d[v];for(let E=0,A=y.length;E<A;E++){const M=t(y[E],a);_.push(M)}i.morphAttributes[v]=_}i.morphTargetsRelative=this.morphTargetsRelative;const f=this.groups;for(let v=0,_=f.length;v<_;v++){const y=f[v];i.addGroup(y.start,y.count,y.materialIndex)}return i}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const _=this.parameters;for(const y in _)_[y]!==void 0&&(t[y]=_[y]);return t}t.data={attributes:{}};const i=this.index;i!==null&&(t.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const a=this.attributes;for(const _ in a){const y=a[_];t.data.attributes[_]=y.toJSON(t.data)}const u={};let d=!1;for(const _ in this.morphAttributes){const y=this.morphAttributes[_],E=[];for(let A=0,M=y.length;A<M;A++){const P=y[A];E.push(P.toJSON(t.data))}E.length>0&&(u[_]=E,d=!0)}d&&(t.data.morphAttributes=u,t.data.morphTargetsRelative=this.morphTargetsRelative);const f=this.groups;f.length>0&&(t.data.groups=JSON.parse(JSON.stringify(f)));const v=this.boundingSphere;return v!==null&&(t.data.boundingSphere={center:v.center.toArray(),radius:v.radius}),t}clone(){return new Dn().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=t.name;const a=t.index;a!==null&&this.setIndex(a.clone(i));const u=t.attributes;for(const y in u){const E=u[y];this.setAttribute(y,E.clone(i))}const d=t.morphAttributes;for(const y in d){const E=[],A=d[y];for(let M=0,P=A.length;M<P;M++)E.push(A[M].clone(i));this.morphAttributes[y]=E}this.morphTargetsRelative=t.morphTargetsRelative;const f=t.groups;for(let y=0,E=f.length;y<E;y++){const A=f[y];this.addGroup(A.start,A.count,A.materialIndex)}const v=t.boundingBox;v!==null&&(this.boundingBox=v.clone());const _=t.boundingSphere;return _!==null&&(this.boundingSphere=_.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}Dn.prototype.isBufferGeometry=!0;const xc=new Tn,Di=new Ro,as=new ws,Ps=new mt,wi=new mt,Ys=new mt,bc=new mt,wc=new mt,fu=new mt,pu=new mt,bh=new mt,wh=new mt,Bu=new He,Sh=new He,Uu=new He,Da=new mt,Cs=new mt;class mi extends vr{constructor(t=new Dn,i=new Vi){super(),this.type="Mesh",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t){return super.copy(t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const i=t.morphAttributes,a=Object.keys(i);if(a.length>0){const u=i[a[0]];if(u!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,f=u.length;d<f;d++){const v=u[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=d}}}}else{const i=t.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,i){const a=this.geometry,u=this.material,d=this.matrixWorld;if(u===void 0||(a.boundingSphere===null&&a.computeBoundingSphere(),as.copy(a.boundingSphere),as.applyMatrix4(d),t.ray.intersectsSphere(as)===!1)||(xc.copy(d).invert(),Di.copy(t.ray).applyMatrix4(xc),a.boundingBox!==null&&Di.intersectsBox(a.boundingBox)===!1))return;let f;if(a.isBufferGeometry){const v=a.index,_=a.attributes.position,y=a.morphAttributes.position,E=a.morphTargetsRelative,A=a.attributes.uv,M=a.attributes.uv2,P=a.groups,O=a.drawRange;if(v!==null)if(Array.isArray(u))for(let U=0,D=P.length;U<D;U++){const Z=P[U],rt=u[Z.materialIndex];for(let gt=Math.max(Z.start,O.start),pt=Math.min(Z.start+Z.count,O.start+O.count);gt<pt;gt+=3){const Mt=v.getX(gt),At=v.getX(gt+1),Et=v.getX(gt+2);f=ku(this,rt,t,Di,_,y,E,A,M,Mt,At,Et),f&&(f.faceIndex=Math.floor(gt/3),f.face.materialIndex=Z.materialIndex,i.push(f))}}else for(let U=Math.max(0,O.start),D=Math.min(v.count,O.start+O.count);U<D;U+=3){const Z=v.getX(U),rt=v.getX(U+1),gt=v.getX(U+2);f=ku(this,u,t,Di,_,y,E,A,M,Z,rt,gt),f&&(f.faceIndex=Math.floor(U/3),i.push(f))}else if(_!==void 0)if(Array.isArray(u))for(let U=0,D=P.length;U<D;U++){const Z=P[U],rt=u[Z.materialIndex];for(let gt=Math.max(Z.start,O.start),pt=Math.min(Z.start+Z.count,O.start+O.count);gt<pt;gt+=3)f=ku(this,rt,t,Di,_,y,E,A,M,gt,gt+1,gt+2),f&&(f.faceIndex=Math.floor(gt/3),f.face.materialIndex=Z.materialIndex,i.push(f))}else for(let U=Math.max(0,O.start),D=Math.min(_.count,O.start+O.count);U<D;U+=3)f=ku(this,u,t,Di,_,y,E,A,M,U,U+1,U+2),f&&(f.faceIndex=Math.floor(U/3),i.push(f))}else a.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function ku(m,t,i,a,u,d,f,v,_,y,E,A){Ps.fromBufferAttribute(u,y),wi.fromBufferAttribute(u,E),Ys.fromBufferAttribute(u,A);const M=m.morphTargetInfluences;if(t.morphTargets&&d&&M){pu.set(0,0,0),bh.set(0,0,0),wh.set(0,0,0);for(let O=0,U=d.length;O<U;O++){const D=M[O],Z=d[O];D!==0&&(bc.fromBufferAttribute(Z,y),wc.fromBufferAttribute(Z,E),fu.fromBufferAttribute(Z,A),f?(pu.addScaledVector(bc,D),bh.addScaledVector(wc,D),wh.addScaledVector(fu,D)):(pu.addScaledVector(bc.sub(Ps),D),bh.addScaledVector(wc.sub(wi),D),wh.addScaledVector(fu.sub(Ys),D)))}Ps.add(pu),wi.add(bh),Ys.add(wh)}m.isSkinnedMesh&&(m.boneTransform(y,Ps),m.boneTransform(E,wi),m.boneTransform(A,Ys));const P=function(O,U,D,Z,rt,gt,pt,Mt){let At;if(At=U.side===I?Z.intersectTriangle(pt,gt,rt,!0,Mt):Z.intersectTriangle(rt,gt,pt,U.side!==B,Mt),At===null)return null;Cs.copy(Mt),Cs.applyMatrix4(O.matrixWorld);const Et=D.ray.origin.distanceTo(Cs);return Et<D.near||Et>D.far?null:{distance:Et,point:Cs.clone(),object:O}}(m,t,i,a,Ps,wi,Ys,Da);if(P){v&&(Bu.fromBufferAttribute(v,y),Sh.fromBufferAttribute(v,E),Uu.fromBufferAttribute(v,A),P.uv=bi.getUV(Da,Ps,wi,Ys,Bu,Sh,Uu,new He)),_&&(Bu.fromBufferAttribute(_,y),Sh.fromBufferAttribute(_,E),Uu.fromBufferAttribute(_,A),P.uv2=bi.getUV(Da,Ps,wi,Ys,Bu,Sh,Uu,new He));const O={a:y,b:E,c:A,normal:new mt,materialIndex:0};bi.getNormal(Ps,wi,Ys,O.normal),P.face=O}return P}mi.prototype.isMesh=!0;class fa extends Dn{constructor(t=1,i=1,a=1,u=1,d=1,f=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:i,depth:a,widthSegments:u,heightSegments:d,depthSegments:f};const v=this;u=Math.floor(u),d=Math.floor(d),f=Math.floor(f);const _=[],y=[],E=[],A=[];let M=0,P=0;function O(U,D,Z,rt,gt,pt,Mt,At,Et,Lt,Ie){const _e=pt/Et,ye=Mt/Lt,me=pt/2,Ht=Mt/2,ae=At/2,Ze=Et+1,Xe=Lt+1;let je=0,gn=0;const Sn=new mt;for(let In=0;In<Xe;In++){const Rn=In*ye-Ht;for(let Pt=0;Pt<Ze;Pt++){const Ot=Pt*_e-me;Sn[U]=Ot*rt,Sn[D]=Rn*gt,Sn[Z]=ae,y.push(Sn.x,Sn.y,Sn.z),Sn[U]=0,Sn[D]=0,Sn[Z]=At>0?1:-1,E.push(Sn.x,Sn.y,Sn.z),A.push(Pt/Et),A.push(1-In/Lt),je+=1}}for(let In=0;In<Lt;In++)for(let Rn=0;Rn<Et;Rn++){const Pt=M+Rn+Ze*In,Ot=M+Rn+Ze*(In+1),Fe=M+(Rn+1)+Ze*(In+1),Be=M+(Rn+1)+Ze*In;_.push(Pt,Ot,Be),_.push(Ot,Fe,Be),gn+=6}v.addGroup(P,gn,Ie),P+=gn,M+=je}O("z","y","x",-1,-1,a,i,t,f,d,0),O("z","y","x",1,-1,a,i,-t,f,d,1),O("x","z","y",1,1,t,a,i,u,f,2),O("x","z","y",1,-1,t,a,-i,u,f,3),O("x","y","z",1,-1,t,i,a,u,d,4),O("x","y","z",-1,-1,t,i,-a,u,d,5),this.setIndex(_),this.setAttribute("position",new En(y,3)),this.setAttribute("normal",new En(E,3)),this.setAttribute("uv",new En(A,2))}static fromJSON(t){return new fa(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Na(m){const t={};for(const i in m){t[i]={};for(const a in m[i]){const u=m[i][a];u&&(u.isColor||u.isMatrix3||u.isMatrix4||u.isVector2||u.isVector3||u.isVector4||u.isTexture||u.isQuaternion)?t[i][a]=u.clone():Array.isArray(u)?t[i][a]=u.slice():t[i][a]=u}}return t}function mo(m){const t={};for(let i=0;i<m.length;i++){const a=Na(m[i]);for(const u in a)t[u]=a[u]}return t}const Ad={clone:Na,merge:mo};class go extends ji{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Na(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const i=super.toJSON(t);i.glslVersion=this.glslVersion,i.uniforms={};for(const u in this.uniforms){const d=this.uniforms[u].value;d&&d.isTexture?i.uniforms[u]={type:"t",value:d.toJSON(t).uuid}:d&&d.isColor?i.uniforms[u]={type:"c",value:d.getHex()}:d&&d.isVector2?i.uniforms[u]={type:"v2",value:d.toArray()}:d&&d.isVector3?i.uniforms[u]={type:"v3",value:d.toArray()}:d&&d.isVector4?i.uniforms[u]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?i.uniforms[u]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?i.uniforms[u]={type:"m4",value:d.toArray()}:i.uniforms[u]={value:d}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader;const a={};for(const u in this.extensions)this.extensions[u]===!0&&(a[u]=!0);return Object.keys(a).length>0&&(i.extensions=a),i}}go.prototype.isShaderMaterial=!0;class Ol extends vr{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Tn,this.projectionMatrix=new Tn,this.projectionMatrixInverse=new Tn}copy(t,i){return super.copy(t,i),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(-i[8],-i[9],-i[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,i){super.updateWorldMatrix(t,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}Ol.prototype.isCamera=!0;class to extends Ol{constructor(t=50,i=1,a=.1,u=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=a,this.far=u,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,i){return super.copy(t,i),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const i=.5*this.getFilmHeight()/t;this.fov=2*zo*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*ia*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*zo*Math.atan(Math.tan(.5*ia*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,i,a,u,d,f){this.aspect=t/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=a,this.view.offsetY=u,this.view.width=d,this.view.height=f,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let i=t*Math.tan(.5*ia*this.fov)/this.zoom,a=2*i,u=this.aspect*a,d=-.5*u;const f=this.view;if(this.view!==null&&this.view.enabled){const _=f.fullWidth,y=f.fullHeight;d+=f.offsetX*u/_,i-=f.offsetY*a/y,u*=f.width/_,a*=f.height/y}const v=this.filmOffset;v!==0&&(d+=t*v/this.getFilmWidth()),this.projectionMatrix.makePerspective(d,d+u,i,i-a,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const i=super.toJSON(t);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}to.prototype.isPerspectiveCamera=!0;class Sc extends vr{constructor(t,i,a){if(super(),this.type="CubeCamera",a.isWebGLCubeRenderTarget!==!0)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=a;const u=new to(90,1,t,i);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new mt(1,0,0)),this.add(u);const d=new to(90,1,t,i);d.layers=this.layers,d.up.set(0,-1,0),d.lookAt(new mt(-1,0,0)),this.add(d);const f=new to(90,1,t,i);f.layers=this.layers,f.up.set(0,0,1),f.lookAt(new mt(0,1,0)),this.add(f);const v=new to(90,1,t,i);v.layers=this.layers,v.up.set(0,0,-1),v.lookAt(new mt(0,-1,0)),this.add(v);const _=new to(90,1,t,i);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new mt(0,0,1)),this.add(_);const y=new to(90,1,t,i);y.layers=this.layers,y.up.set(0,-1,0),y.lookAt(new mt(0,0,-1)),this.add(y)}update(t,i){this.parent===null&&this.updateMatrixWorld();const a=this.renderTarget,[u,d,f,v,_,y]=this.children,E=t.xr.enabled,A=t.getRenderTarget();t.xr.enabled=!1;const M=a.texture.generateMipmaps;a.texture.generateMipmaps=!1,t.setRenderTarget(a,0),t.render(i,u),t.setRenderTarget(a,1),t.render(i,d),t.setRenderTarget(a,2),t.render(i,f),t.setRenderTarget(a,3),t.render(i,v),t.setRenderTarget(a,4),t.render(i,_),a.texture.generateMipmaps=M,t.setRenderTarget(a,5),t.render(i,y),t.setRenderTarget(A),t.xr.enabled=E}}class Gu extends ii{constructor(t,i,a,u,d,f,v,_,y,E){super(t=t!==void 0?t:[],i=i!==void 0?i:L,a,u,d,f,v=v!==void 0?v:wn,_,y,E),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}Gu.prototype.isCubeTexture=!0;class Rs extends Po{constructor(t,i,a){Number.isInteger(i)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),i=a),super(t,t,i),i=i||{},this.texture=new Gu(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.generateMipmaps=i.generateMipmaps!==void 0&&i.generateMipmaps,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:We,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,i){this.texture.type=i.type,this.texture.format=Pn,this.texture.encoding=i.encoding,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const a={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},u=new fa(5,5,5),d=new go({name:"CubemapFromEquirect",uniforms:Na(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,side:I,blending:F});d.uniforms.tEquirect.value=i;const f=new mi(u,d),v=i.minFilter;return i.minFilter===ui&&(i.minFilter=We),new Sc(1,10,this).update(t,f),i.minFilter=v,f.geometry.dispose(),f.material.dispose(),this}clear(t,i,a,u){const d=t.getRenderTarget();for(let f=0;f<6;f++)t.setRenderTarget(this,f),t.clear(i,a,u);t.setRenderTarget(d)}}Rs.prototype.isWebGLCubeRenderTarget=!0;const Th=new mt,Pd=new mt,Cd=new $i;class us{constructor(t=new mt(1,0,0),i=0){this.normal=t,this.constant=i}set(t,i){return this.normal.copy(t),this.constant=i,this}setComponents(t,i,a,u){return this.normal.set(t,i,a),this.constant=u,this}setFromNormalAndCoplanarPoint(t,i){return this.normal.copy(t),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(t,i,a){const u=Th.subVectors(a,i).cross(Pd.subVectors(t,i)).normalize();return this.setFromNormalAndCoplanarPoint(u,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,i){return i.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,i){const a=t.delta(Th),u=this.normal.dot(a);if(u===0)return this.distanceToPoint(t.start)===0?i.copy(t.start):null;const d=-(t.start.dot(this.normal)+this.constant)/u;return d<0||d>1?null:i.copy(a).multiplyScalar(d).add(t.start)}intersectsLine(t){const i=this.distanceToPoint(t.start),a=this.distanceToPoint(t.end);return i<0&&a>0||a<0&&i>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,i){const a=i||Cd.getNormalMatrix(t),u=this.coplanarPoint(Th).applyMatrix4(t),d=this.normal.applyMatrix3(a).normalize();return this.constant=-u.dot(d),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}us.prototype.isPlane=!0;const ls=new ws,Vn=new mt;class Fa{constructor(t=new us,i=new us,a=new us,u=new us,d=new us,f=new us){this.planes=[t,i,a,u,d,f]}set(t,i,a,u,d,f){const v=this.planes;return v[0].copy(t),v[1].copy(i),v[2].copy(a),v[3].copy(u),v[4].copy(d),v[5].copy(f),this}copy(t){const i=this.planes;for(let a=0;a<6;a++)i[a].copy(t.planes[a]);return this}setFromProjectionMatrix(t){const i=this.planes,a=t.elements,u=a[0],d=a[1],f=a[2],v=a[3],_=a[4],y=a[5],E=a[6],A=a[7],M=a[8],P=a[9],O=a[10],U=a[11],D=a[12],Z=a[13],rt=a[14],gt=a[15];return i[0].setComponents(v-u,A-_,U-M,gt-D).normalize(),i[1].setComponents(v+u,A+_,U+M,gt+D).normalize(),i[2].setComponents(v+d,A+y,U+P,gt+Z).normalize(),i[3].setComponents(v-d,A-y,U-P,gt-Z).normalize(),i[4].setComponents(v-f,A-E,U-O,gt-rt).normalize(),i[5].setComponents(v+f,A+E,U+O,gt+rt).normalize(),this}intersectsObject(t){const i=t.geometry;return i.boundingSphere===null&&i.computeBoundingSphere(),ls.copy(i.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(ls)}intersectsSprite(t){return ls.center.set(0,0,0),ls.radius=.7071067811865476,ls.applyMatrix4(t.matrixWorld),this.intersectsSphere(ls)}intersectsSphere(t){const i=this.planes,a=t.center,u=-t.radius;for(let d=0;d<6;d++)if(i[d].distanceToPoint(a)<u)return!1;return!0}intersectsBox(t){const i=this.planes;for(let a=0;a<6;a++){const u=i[a];if(Vn.x=u.normal.x>0?t.max.x:t.min.x,Vn.y=u.normal.y>0?t.max.y:t.min.y,Vn.z=u.normal.z>0?t.max.z:t.min.z,u.distanceToPoint(Vn)<0)return!1}return!0}containsPoint(t){const i=this.planes;for(let a=0;a<6;a++)if(i[a].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Eh(){let m=null,t=!1,i=null,a=null;function u(d,f){i(d,f),a=m.requestAnimationFrame(u)}return{start:function(){t!==!0&&i!==null&&(a=m.requestAnimationFrame(u),t=!0)},stop:function(){m.cancelAnimationFrame(a),t=!1},setAnimationLoop:function(d){i=d},setContext:function(d){m=d}}}function mu(m,t){const i=t.isWebGL2,a=new WeakMap;return{get:function(u){return u.isInterleavedBufferAttribute&&(u=u.data),a.get(u)},remove:function(u){u.isInterleavedBufferAttribute&&(u=u.data);const d=a.get(u);d&&(m.deleteBuffer(d.buffer),a.delete(u))},update:function(u,d){if(u.isGLBufferAttribute){const v=a.get(u);return void((!v||v.version<u.version)&&a.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version}))}u.isInterleavedBufferAttribute&&(u=u.data);const f=a.get(u);f===void 0?a.set(u,function(v,_){const y=v.array,E=v.usage,A=m.createBuffer();m.bindBuffer(_,A),m.bufferData(_,y,E),v.onUploadCallback();let M=5126;return y instanceof Float32Array?M=5126:y instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):y instanceof Uint16Array?v.isFloat16BufferAttribute?i?M=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):M=5123:y instanceof Int16Array?M=5122:y instanceof Uint32Array?M=5125:y instanceof Int32Array?M=5124:y instanceof Int8Array?M=5120:(y instanceof Uint8Array||y instanceof Uint8ClampedArray)&&(M=5121),{buffer:A,type:M,bytesPerElement:y.BYTES_PER_ELEMENT,version:v.version}}(u,d)):f.version<u.version&&(function(v,_,y){const E=_.array,A=_.updateRange;m.bindBuffer(y,v),A.count===-1?m.bufferSubData(y,0,E):(i?m.bufferSubData(y,A.offset*E.BYTES_PER_ELEMENT,E,A.offset,A.count):m.bufferSubData(y,A.offset*E.BYTES_PER_ELEMENT,E.subarray(A.offset,A.offset+A.count)),A.count=-1)}(f.buffer,u,d),f.version=u.version)}}}class pa extends Dn{constructor(t=1,i=1,a=1,u=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:i,widthSegments:a,heightSegments:u};const d=t/2,f=i/2,v=Math.floor(a),_=Math.floor(u),y=v+1,E=_+1,A=t/v,M=i/_,P=[],O=[],U=[],D=[];for(let Z=0;Z<E;Z++){const rt=Z*M-f;for(let gt=0;gt<y;gt++){const pt=gt*A-d;O.push(pt,-rt,0),U.push(0,0,1),D.push(gt/v),D.push(1-Z/_)}}for(let Z=0;Z<_;Z++)for(let rt=0;rt<v;rt++){const gt=rt+y*Z,pt=rt+y*(Z+1),Mt=rt+1+y*(Z+1),At=rt+1+y*Z;P.push(gt,pt,At),P.push(pt,Mt,At)}this.setIndex(P),this.setAttribute("position",new En(O,3)),this.setAttribute("normal",new En(U,3)),this.setAttribute("uv",new En(D,2))}static fromJSON(t){return new pa(t.width,t.height,t.widthSegments,t.heightSegments)}}const nr={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotVH ) {
	float fresnel = exp2( ( -5.55473 * dotVH - 6.98316 ) * dotVH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment:`#ifdef USE_TRANSMISSION
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSNMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition.xyz / vWorldPosition.w;
	vec3 v = normalize( cameraPosition - pos );
	float ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );
	vec3 transmission = transmissionFactor * getIBLVolumeRefraction(
		normal, v, roughnessFactor, material.diffuseColor, totalSpecular,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission, transmissionFactor );
#endif`,transmission_pars_fragment:`#ifdef USE_TRANSMISSION
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec4 vWorldPosition;
	vec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {
		vec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);
		vec3 modelScale;
		modelScale.x = length(vec3(modelMatrix[0].xyz));
		modelScale.y = length(vec3(modelMatrix[1].xyz));
		modelScale.z = length(vec3(modelMatrix[2].xyz));
		return normalize(refractionVector) * thickness * modelScale;
	}
	float applyIorToRoughness(float roughness, float ior) {
		return roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);
	}
	vec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {
		float framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);
		return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;
	}
	vec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {
		if (attenuationDistance == 0.0) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;
			vec3 transmittance = exp(-attenuationCoefficient * transmissionDistance);			return transmittance * radiance;
		}
	}
	vec3 getIBLVolumeRefraction(vec3 n, vec3 v, float perceptualRoughness, vec3 baseColor, vec3 specularColor,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance) {
		vec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);
		vec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);
		return (1.0 - specularColor) * attenuatedColor * baseColor;
	}
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform vec3 attenuationColor;
	uniform float attenuationDistance;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <transmission_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#ifdef USE_TRANSMISSION
	varying vec4 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition;
#endif
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},ze={common:{diffuse:{value:new pn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new $i},uv2Transform:{value:new $i},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new He(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new pn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new $i}},sprite:{diffuse:{value:new pn(16777215)},opacity:{value:1},center:{value:new He(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new $i}}},Is={basic:{uniforms:mo([ze.common,ze.specularmap,ze.envmap,ze.aomap,ze.lightmap,ze.fog]),vertexShader:nr.meshbasic_vert,fragmentShader:nr.meshbasic_frag},lambert:{uniforms:mo([ze.common,ze.specularmap,ze.envmap,ze.aomap,ze.lightmap,ze.emissivemap,ze.fog,ze.lights,{emissive:{value:new pn(0)}}]),vertexShader:nr.meshlambert_vert,fragmentShader:nr.meshlambert_frag},phong:{uniforms:mo([ze.common,ze.specularmap,ze.envmap,ze.aomap,ze.lightmap,ze.emissivemap,ze.bumpmap,ze.normalmap,ze.displacementmap,ze.fog,ze.lights,{emissive:{value:new pn(0)},specular:{value:new pn(1118481)},shininess:{value:30}}]),vertexShader:nr.meshphong_vert,fragmentShader:nr.meshphong_frag},standard:{uniforms:mo([ze.common,ze.envmap,ze.aomap,ze.lightmap,ze.emissivemap,ze.bumpmap,ze.normalmap,ze.displacementmap,ze.roughnessmap,ze.metalnessmap,ze.fog,ze.lights,{emissive:{value:new pn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:nr.meshphysical_vert,fragmentShader:nr.meshphysical_frag},toon:{uniforms:mo([ze.common,ze.aomap,ze.lightmap,ze.emissivemap,ze.bumpmap,ze.normalmap,ze.displacementmap,ze.gradientmap,ze.fog,ze.lights,{emissive:{value:new pn(0)}}]),vertexShader:nr.meshtoon_vert,fragmentShader:nr.meshtoon_frag},matcap:{uniforms:mo([ze.common,ze.bumpmap,ze.normalmap,ze.displacementmap,ze.fog,{matcap:{value:null}}]),vertexShader:nr.meshmatcap_vert,fragmentShader:nr.meshmatcap_frag},points:{uniforms:mo([ze.points,ze.fog]),vertexShader:nr.points_vert,fragmentShader:nr.points_frag},dashed:{uniforms:mo([ze.common,ze.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:nr.linedashed_vert,fragmentShader:nr.linedashed_frag},depth:{uniforms:mo([ze.common,ze.displacementmap]),vertexShader:nr.depth_vert,fragmentShader:nr.depth_frag},normal:{uniforms:mo([ze.common,ze.bumpmap,ze.normalmap,ze.displacementmap,{opacity:{value:1}}]),vertexShader:nr.normal_vert,fragmentShader:nr.normal_frag},sprite:{uniforms:mo([ze.sprite,ze.fog]),vertexShader:nr.sprite_vert,fragmentShader:nr.sprite_frag},background:{uniforms:{uvTransform:{value:new $i},t2D:{value:null}},vertexShader:nr.background_vert,fragmentShader:nr.background_frag},cube:{uniforms:mo([ze.envmap,{opacity:{value:1}}]),vertexShader:nr.cube_vert,fragmentShader:nr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:nr.equirect_vert,fragmentShader:nr.equirect_frag},distanceRGBA:{uniforms:mo([ze.common,ze.displacementmap,{referencePosition:{value:new mt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:nr.distanceRGBA_vert,fragmentShader:nr.distanceRGBA_frag},shadow:{uniforms:mo([ze.lights,ze.fog,{color:{value:new pn(0)},opacity:{value:1}}]),vertexShader:nr.shadow_vert,fragmentShader:nr.shadow_frag}};function Rd(m,t,i,a,u){const d=new pn(0);let f,v,_=0,y=null,E=0,A=null;function M(P,O){i.buffers.color.setClear(P.r,P.g,P.b,O,u)}return{getClearColor:function(){return d},setClearColor:function(P,O=1){d.set(P),_=O,M(d,_)},getClearAlpha:function(){return _},setClearAlpha:function(P){_=P,M(d,_)},render:function(P,O){let U=!1,D=O.isScene===!0?O.background:null;D&&D.isTexture&&(D=t.get(D));const Z=m.xr,rt=Z.getSession&&Z.getSession();rt&&rt.environmentBlendMode==="additive"&&(D=null),D===null?M(d,_):D&&D.isColor&&(M(D,1),U=!0),(m.autoClear||U)&&m.clear(m.autoClearColor,m.autoClearDepth,m.autoClearStencil),D&&(D.isCubeTexture||D.mapping===K)?(v===void 0&&(v=new mi(new fa(1,1,1),new go({name:"BackgroundCubeMaterial",uniforms:Na(Is.cube.uniforms),vertexShader:Is.cube.vertexShader,fragmentShader:Is.cube.fragmentShader,side:I,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(gt,pt,Mt){this.matrixWorld.copyPosition(Mt.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(v)),v.material.uniforms.envMap.value=D,v.material.uniforms.flipEnvMap.value=D.isCubeTexture&&D._needsFlipEnvMap?-1:1,y===D&&E===D.version&&A===m.toneMapping||(v.material.needsUpdate=!0,y=D,E=D.version,A=m.toneMapping),P.unshift(v,v.geometry,v.material,0,0,null)):D&&D.isTexture&&(f===void 0&&(f=new mi(new pa(2,2),new go({name:"BackgroundMaterial",uniforms:Na(Is.background.uniforms),vertexShader:Is.background.vertexShader,fragmentShader:Is.background.fragmentShader,side:kt,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),Object.defineProperty(f.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(f)),f.material.uniforms.t2D.value=D,D.matrixAutoUpdate===!0&&D.updateMatrix(),f.material.uniforms.uvTransform.value.copy(D.matrix),y===D&&E===D.version&&A===m.toneMapping||(f.material.needsUpdate=!0,y=D,E=D.version,A=m.toneMapping),P.unshift(f,f.geometry,f.material,0,0,null))}}}function yf(m,t,i,a){const u=m.getParameter(34921),d=a.isWebGL2?null:t.get("OES_vertex_array_object"),f=a.isWebGL2||d!==null,v={},_=M(null);let y=_;function E(pt){return a.isWebGL2?m.bindVertexArray(pt):d.bindVertexArrayOES(pt)}function A(pt){return a.isWebGL2?m.deleteVertexArray(pt):d.deleteVertexArrayOES(pt)}function M(pt){const Mt=[],At=[],Et=[];for(let Lt=0;Lt<u;Lt++)Mt[Lt]=0,At[Lt]=0,Et[Lt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Mt,enabledAttributes:At,attributeDivisors:Et,object:pt,attributes:{},index:null}}function P(){const pt=y.newAttributes;for(let Mt=0,At=pt.length;Mt<At;Mt++)pt[Mt]=0}function O(pt){U(pt,0)}function U(pt,Mt){const At=y.newAttributes,Et=y.enabledAttributes,Lt=y.attributeDivisors;At[pt]=1,Et[pt]===0&&(m.enableVertexAttribArray(pt),Et[pt]=1),Lt[pt]!==Mt&&((a.isWebGL2?m:t.get("ANGLE_instanced_arrays"))[a.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](pt,Mt),Lt[pt]=Mt)}function D(){const pt=y.newAttributes,Mt=y.enabledAttributes;for(let At=0,Et=Mt.length;At<Et;At++)Mt[At]!==pt[At]&&(m.disableVertexAttribArray(At),Mt[At]=0)}function Z(pt,Mt,At,Et,Lt,Ie){a.isWebGL2!==!0||At!==5124&&At!==5125?m.vertexAttribPointer(pt,Mt,At,Et,Lt,Ie):m.vertexAttribIPointer(pt,Mt,At,Lt,Ie)}function rt(){gt(),y!==_&&(y=_,E(y.object))}function gt(){_.geometry=null,_.program=null,_.wireframe=!1}return{setup:function(pt,Mt,At,Et,Lt){let Ie=!1;if(f){const _e=function(ye,me,Ht){const ae=Ht.wireframe===!0;let Ze=v[ye.id];Ze===void 0&&(Ze={},v[ye.id]=Ze);let Xe=Ze[me.id];Xe===void 0&&(Xe={},Ze[me.id]=Xe);let je=Xe[ae];return je===void 0&&(je=M(a.isWebGL2?m.createVertexArray():d.createVertexArrayOES()),Xe[ae]=je),je}(Et,At,Mt);y!==_e&&(y=_e,E(y.object)),Ie=function(ye,me){const Ht=y.attributes,ae=ye.attributes;let Ze=0;for(const Xe in ae){const je=Ht[Xe],gn=ae[Xe];if(je===void 0||je.attribute!==gn||je.data!==gn.data)return!0;Ze++}return y.attributesNum!==Ze||y.index!==me}(Et,Lt),Ie&&function(ye,me){const Ht={},ae=ye.attributes;let Ze=0;for(const Xe in ae){const je=ae[Xe],gn={};gn.attribute=je,je.data&&(gn.data=je.data),Ht[Xe]=gn,Ze++}y.attributes=Ht,y.attributesNum=Ze,y.index=me}(Et,Lt)}else{const _e=Mt.wireframe===!0;y.geometry===Et.id&&y.program===At.id&&y.wireframe===_e||(y.geometry=Et.id,y.program=At.id,y.wireframe=_e,Ie=!0)}pt.isInstancedMesh===!0&&(Ie=!0),Lt!==null&&i.update(Lt,34963),Ie&&(function(_e,ye,me,Ht){if(a.isWebGL2===!1&&(_e.isInstancedMesh||Ht.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;P();const ae=Ht.attributes,Ze=me.getAttributes(),Xe=ye.defaultAttributeValues;for(const je in Ze){const gn=Ze[je];if(gn>=0){const Sn=ae[je];if(Sn!==void 0){const In=Sn.normalized,Rn=Sn.itemSize,Pt=i.get(Sn);if(Pt===void 0)continue;const Ot=Pt.buffer,Fe=Pt.type,Be=Pt.bytesPerElement;if(Sn.isInterleavedBufferAttribute){const ce=Sn.data,on=ce.stride,un=Sn.offset;ce&&ce.isInstancedInterleavedBuffer?(U(gn,ce.meshPerAttribute),Ht._maxInstanceCount===void 0&&(Ht._maxInstanceCount=ce.meshPerAttribute*ce.count)):O(gn),m.bindBuffer(34962,Ot),Z(gn,Rn,Fe,In,on*Be,un*Be)}else Sn.isInstancedBufferAttribute?(U(gn,Sn.meshPerAttribute),Ht._maxInstanceCount===void 0&&(Ht._maxInstanceCount=Sn.meshPerAttribute*Sn.count)):O(gn),m.bindBuffer(34962,Ot),Z(gn,Rn,Fe,In,0,0)}else if(je==="instanceMatrix"){const In=i.get(_e.instanceMatrix);if(In===void 0)continue;const Rn=In.buffer,Pt=In.type;U(gn+0,1),U(gn+1,1),U(gn+2,1),U(gn+3,1),m.bindBuffer(34962,Rn),m.vertexAttribPointer(gn+0,4,Pt,!1,64,0),m.vertexAttribPointer(gn+1,4,Pt,!1,64,16),m.vertexAttribPointer(gn+2,4,Pt,!1,64,32),m.vertexAttribPointer(gn+3,4,Pt,!1,64,48)}else if(je==="instanceColor"){const In=i.get(_e.instanceColor);if(In===void 0)continue;const Rn=In.buffer,Pt=In.type;U(gn,1),m.bindBuffer(34962,Rn),m.vertexAttribPointer(gn,3,Pt,!1,12,0)}else if(Xe!==void 0){const In=Xe[je];if(In!==void 0)switch(In.length){case 2:m.vertexAttrib2fv(gn,In);break;case 3:m.vertexAttrib3fv(gn,In);break;case 4:m.vertexAttrib4fv(gn,In);break;default:m.vertexAttrib1fv(gn,In)}}}}D()}(pt,Mt,At,Et),Lt!==null&&m.bindBuffer(34963,i.get(Lt).buffer))},reset:rt,resetDefaultState:gt,dispose:function(){rt();for(const pt in v){const Mt=v[pt];for(const At in Mt){const Et=Mt[At];for(const Lt in Et)A(Et[Lt].object),delete Et[Lt];delete Mt[At]}delete v[pt]}},releaseStatesOfGeometry:function(pt){if(v[pt.id]===void 0)return;const Mt=v[pt.id];for(const At in Mt){const Et=Mt[At];for(const Lt in Et)A(Et[Lt].object),delete Et[Lt];delete Mt[At]}delete v[pt.id]},releaseStatesOfProgram:function(pt){for(const Mt in v){const At=v[Mt];if(At[pt.id]===void 0)continue;const Et=At[pt.id];for(const Lt in Et)A(Et[Lt].object),delete Et[Lt];delete At[pt.id]}},initAttributes:P,enableAttribute:O,disableUnusedAttributes:D}}function qo(m,t,i,a){const u=a.isWebGL2;let d;this.setMode=function(f){d=f},this.render=function(f,v){m.drawArrays(d,f,v),i.update(v,d,1)},this.renderInstances=function(f,v,_){if(_===0)return;let y,E;if(u)y=m,E="drawArraysInstanced";else if(y=t.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",y===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");y[E](d,f,v,_),i.update(v,d,_)}}function vo(m,t,i){let a;function u(pt){if(pt==="highp"){if(m.getShaderPrecisionFormat(35633,36338).precision>0&&m.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";pt="mediump"}return pt==="mediump"&&m.getShaderPrecisionFormat(35633,36337).precision>0&&m.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const d=typeof WebGL2RenderingContext!="undefined"&&m instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&m instanceof WebGL2ComputeRenderingContext;let f=i.precision!==void 0?i.precision:"highp";const v=u(f);v!==f&&(console.warn("THREE.WebGLRenderer:",f,"not supported, using",v,"instead."),f=v);const _=d||t.has("WEBGL_draw_buffers"),y=i.logarithmicDepthBuffer===!0,E=m.getParameter(34930),A=m.getParameter(35660),M=m.getParameter(3379),P=m.getParameter(34076),O=m.getParameter(34921),U=m.getParameter(36347),D=m.getParameter(36348),Z=m.getParameter(36349),rt=A>0,gt=d||t.has("OES_texture_float");return{isWebGL2:d,drawBuffers:_,getMaxAnisotropy:function(){if(a!==void 0)return a;if(t.has("EXT_texture_filter_anisotropic")===!0){const pt=t.get("EXT_texture_filter_anisotropic");a=m.getParameter(pt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a},getMaxPrecision:u,precision:f,logarithmicDepthBuffer:y,maxTextures:E,maxVertexTextures:A,maxTextureSize:M,maxCubemapSize:P,maxAttributes:O,maxVertexUniforms:U,maxVaryings:D,maxFragmentUniforms:Z,vertexTextures:rt,floatFragmentTextures:gt,floatVertexTextures:rt&&gt,maxSamples:d?m.getParameter(36183):0}}function Tc(m){const t=this;let i=null,a=0,u=!1,d=!1;const f=new us,v=new $i,_={value:null,needsUpdate:!1};function y(){_.value!==i&&(_.value=i,_.needsUpdate=a>0),t.numPlanes=a,t.numIntersection=0}function E(A,M,P,O){const U=A!==null?A.length:0;let D=null;if(U!==0){if(D=_.value,O!==!0||D===null){const Z=P+4*U,rt=M.matrixWorldInverse;v.getNormalMatrix(rt),(D===null||D.length<Z)&&(D=new Float32Array(Z));for(let gt=0,pt=P;gt!==U;++gt,pt+=4)f.copy(A[gt]).applyMatrix4(rt,v),f.normal.toArray(D,pt),D[pt+3]=f.constant}_.value=D,_.needsUpdate=!0}return t.numPlanes=U,t.numIntersection=0,D}this.uniform=_,this.numPlanes=0,this.numIntersection=0,this.init=function(A,M,P){const O=A.length!==0||M||a!==0||u;return u=M,i=E(A,P,0),a=A.length,O},this.beginShadows=function(){d=!0,E(null)},this.endShadows=function(){d=!1,y()},this.setState=function(A,M,P){const O=A.clippingPlanes,U=A.clipIntersection,D=A.clipShadows,Z=m.get(A);if(!u||O===null||O.length===0||d&&!D)d?E(null):y();else{const rt=d?0:a,gt=4*rt;let pt=Z.clippingState||null;_.value=pt,pt=E(O,M,gt,P);for(let Mt=0;Mt!==gt;++Mt)pt[Mt]=i[Mt];Z.clippingState=pt,this.numIntersection=U?this.numPlanes:0,this.numPlanes+=rt}}}function Mh(m){let t=new WeakMap;function i(u,d){return d===G?u.mapping=L:d===st&&(u.mapping=k),u}function a(u){const d=u.target;d.removeEventListener("dispose",a);const f=t.get(d);f!==void 0&&(t.delete(d),f.dispose())}return{get:function(u){if(u&&u.isTexture){const d=u.mapping;if(d===G||d===st){if(t.has(u))return i(t.get(u).texture,u.mapping);{const f=u.image;if(f&&f.height>0){const v=m.getRenderTarget(),_=new Rs(f.height/2);return _.fromEquirectangularTexture(m,u),t.set(u,_),m.setRenderTarget(v),u.addEventListener("dispose",a),i(_.texture,u.mapping)}return null}}}return u},dispose:function(){t=new WeakMap}}}function Id(m){const t={};function i(a){if(t[a]!==void 0)return t[a];let u;switch(a){case"WEBGL_depth_texture":u=m.getExtension("WEBGL_depth_texture")||m.getExtension("MOZ_WEBGL_depth_texture")||m.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":u=m.getExtension("EXT_texture_filter_anisotropic")||m.getExtension("MOZ_EXT_texture_filter_anisotropic")||m.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":u=m.getExtension("WEBGL_compressed_texture_s3tc")||m.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||m.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":u=m.getExtension("WEBGL_compressed_texture_pvrtc")||m.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:u=m.getExtension(a)}return t[a]=u,u}return{has:function(a){return i(a)!==null},init:function(a){a.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float")},get:function(a){const u=i(a);return u===null&&console.warn("THREE.WebGLRenderer: "+a+" extension not supported."),u}}}function Hu(m,t,i,a){const u={},d=new WeakMap;function f(_){const y=_.target;y.index!==null&&t.remove(y.index);for(const A in y.attributes)t.remove(y.attributes[A]);y.removeEventListener("dispose",f),delete u[y.id];const E=d.get(y);E&&(t.remove(E),d.delete(y)),a.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,i.memory.geometries--}function v(_){const y=[],E=_.index,A=_.attributes.position;let M=0;if(E!==null){const U=E.array;M=E.version;for(let D=0,Z=U.length;D<Z;D+=3){const rt=U[D+0],gt=U[D+1],pt=U[D+2];y.push(rt,gt,gt,pt,pt,rt)}}else{const U=A.array;M=A.version;for(let D=0,Z=U.length/3-1;D<Z;D+=3){const rt=D+0,gt=D+1,pt=D+2;y.push(rt,gt,gt,pt,pt,rt)}}const P=new(ss(y)>65535?Fu:Nu)(y,1);P.version=M;const O=d.get(_);O&&t.remove(O),d.set(_,P)}return{get:function(_,y){return u[y.id]===!0||(y.addEventListener("dispose",f),u[y.id]=!0,i.memory.geometries++),y},update:function(_){const y=_.attributes;for(const A in y)t.update(y[A],34962);const E=_.morphAttributes;for(const A in E){const M=E[A];for(let P=0,O=M.length;P<O;P++)t.update(M[P],34962)}},getWireframeAttribute:function(_){const y=d.get(_);if(y){const E=_.index;E!==null&&y.version<E.version&&v(_)}else v(_);return d.get(_)}}}function Ld(m,t,i,a){const u=a.isWebGL2;let d,f,v;this.setMode=function(_){d=_},this.setIndex=function(_){f=_.type,v=_.bytesPerElement},this.render=function(_,y){m.drawElements(d,y,f,_*v),i.update(y,d,1)},this.renderInstances=function(_,y,E){if(E===0)return;let A,M;if(u)A=m,M="drawElementsInstanced";else if(A=t.get("ANGLE_instanced_arrays"),M="drawElementsInstancedANGLE",A===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");A[M](d,y,f,_*v,E),i.update(y,d,E)}}function zu(m){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(i,a,u){switch(t.calls++,a){case 4:t.triangles+=u*(i/3);break;case 1:t.lines+=u*(i/2);break;case 3:t.lines+=u*(i-1);break;case 2:t.lines+=u*i;break;case 0:t.points+=u*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}}function Ah(m,t){return m[0]-t[0]}function Od(m,t){return Math.abs(t[1])-Math.abs(m[1])}function xf(m){const t={},i=new Float32Array(8),a=[];for(let u=0;u<8;u++)a[u]=[u,0];return{update:function(u,d,f,v){const _=u.morphTargetInfluences,y=_===void 0?0:_.length;let E=t[d.id];if(E===void 0||E.length!==y){E=[];for(let U=0;U<y;U++)E[U]=[U,0];t[d.id]=E}for(let U=0;U<y;U++){const D=E[U];D[0]=U,D[1]=_[U]}E.sort(Od);for(let U=0;U<8;U++)U<y&&E[U][1]?(a[U][0]=E[U][0],a[U][1]=E[U][1]):(a[U][0]=Number.MAX_SAFE_INTEGER,a[U][1]=0);a.sort(Ah);const A=f.morphTargets&&d.morphAttributes.position,M=f.morphNormals&&d.morphAttributes.normal;let P=0;for(let U=0;U<8;U++){const D=a[U],Z=D[0],rt=D[1];Z!==Number.MAX_SAFE_INTEGER&&rt?(A&&d.getAttribute("morphTarget"+U)!==A[Z]&&d.setAttribute("morphTarget"+U,A[Z]),M&&d.getAttribute("morphNormal"+U)!==M[Z]&&d.setAttribute("morphNormal"+U,M[Z]),i[U]=rt,P+=rt):(A&&d.hasAttribute("morphTarget"+U)===!0&&d.deleteAttribute("morphTarget"+U),M&&d.hasAttribute("morphNormal"+U)===!0&&d.deleteAttribute("morphNormal"+U),i[U]=0)}const O=d.morphTargetsRelative?1:1-P;v.getUniforms().setValue(m,"morphTargetBaseInfluence",O),v.getUniforms().setValue(m,"morphTargetInfluences",i)}}}function gu(m,t,i,a){let u=new WeakMap;function d(f){const v=f.target;v.removeEventListener("dispose",d),i.remove(v.instanceMatrix),v.instanceColor!==null&&i.remove(v.instanceColor)}return{update:function(f){const v=a.render.frame,_=f.geometry,y=t.get(f,_);return u.get(y)!==v&&(t.update(y),u.set(y,v)),f.isInstancedMesh&&(f.hasEventListener("dispose",d)===!1&&f.addEventListener("dispose",d),i.update(f.instanceMatrix,34962),f.instanceColor!==null&&i.update(f.instanceColor,34962)),y},dispose:function(){u=new WeakMap}}}Is.physical={uniforms:mo([Is.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new He(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new pn(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new He},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new pn(0)}}]),vertexShader:nr.meshphysical_vert,fragmentShader:nr.meshphysical_frag};class Dl extends ii{constructor(t=null,i=1,a=1,u=1){super(null),this.image={data:t,width:i,height:a,depth:u},this.magFilter=St,this.minFilter=St,this.wrapR=wt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Dl.prototype.isDataTexture2DArray=!0;class Ls extends ii{constructor(t=null,i=1,a=1,u=1){super(null),this.image={data:t,width:i,height:a,depth:u},this.magFilter=St,this.minFilter=St,this.wrapR=wt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Ls.prototype.isDataTexture3D=!0;const Nl=new ii,Dd=new Dl,Nd=new Ls,Fl=new Gu,Bl=[],hs=[],Os=new Float32Array(16),Ph=new Float32Array(9),ju=new Float32Array(4);function Ul(m,t,i){const a=m[0];if(a<=0||a>0)return m;const u=t*i;let d=Bl[u];if(d===void 0&&(d=new Float32Array(u),Bl[u]=d),t!==0){a.toArray(d,0);for(let f=1,v=0;f!==t;++f)v+=i,m[f].toArray(d,v)}return d}function bo(m,t){if(m.length!==t.length)return!1;for(let i=0,a=m.length;i<a;i++)if(m[i]!==t[i])return!1;return!0}function oo(m,t){for(let i=0,a=t.length;i<a;i++)m[i]=t[i]}function Fd(m,t){let i=hs[t];i===void 0&&(i=new Int32Array(t),hs[t]=i);for(let a=0;a!==t;++a)i[a]=m.allocateTextureUnit();return i}function Ec(m,t){const i=this.cache;i[0]!==t&&(m.uniform1f(this.addr,t),i[0]=t)}function cs(m,t){const i=this.cache;if(t.x!==void 0)i[0]===t.x&&i[1]===t.y||(m.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(bo(i,t))return;m.uniform2fv(this.addr,t),oo(i,t)}}function lp(m,t){const i=this.cache;if(t.x!==void 0)i[0]===t.x&&i[1]===t.y&&i[2]===t.z||(m.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)i[0]===t.r&&i[1]===t.g&&i[2]===t.b||(m.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(bo(i,t))return;m.uniform3fv(this.addr,t),oo(i,t)}}function bf(m,t){const i=this.cache;if(t.x!==void 0)i[0]===t.x&&i[1]===t.y&&i[2]===t.z&&i[3]===t.w||(m.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(bo(i,t))return;m.uniform4fv(this.addr,t),oo(i,t)}}function kl(m,t){const i=this.cache,a=t.elements;if(a===void 0){if(bo(i,t))return;m.uniformMatrix2fv(this.addr,!1,t),oo(i,t)}else{if(bo(i,a))return;ju.set(a),m.uniformMatrix2fv(this.addr,!1,ju),oo(i,a)}}function wo(m,t){const i=this.cache,a=t.elements;if(a===void 0){if(bo(i,t))return;m.uniformMatrix3fv(this.addr,!1,t),oo(i,t)}else{if(bo(i,a))return;Ph.set(a),m.uniformMatrix3fv(this.addr,!1,Ph),oo(i,a)}}function hp(m,t){const i=this.cache,a=t.elements;if(a===void 0){if(bo(i,t))return;m.uniformMatrix4fv(this.addr,!1,t),oo(i,t)}else{if(bo(i,a))return;Os.set(a),m.uniformMatrix4fv(this.addr,!1,Os),oo(i,a)}}function oi(m,t){const i=this.cache;i[0]!==t&&(m.uniform1i(this.addr,t),i[0]=t)}function wf(m,t){const i=this.cache;bo(i,t)||(m.uniform2iv(this.addr,t),oo(i,t))}function Ch(m,t){const i=this.cache;bo(i,t)||(m.uniform3iv(this.addr,t),oo(i,t))}function cp(m,t){const i=this.cache;bo(i,t)||(m.uniform4iv(this.addr,t),oo(i,t))}function Vu(m,t){const i=this.cache;i[0]!==t&&(m.uniform1ui(this.addr,t),i[0]=t)}function Sf(m,t){const i=this.cache;bo(i,t)||(m.uniform2uiv(this.addr,t),oo(i,t))}function Rh(m,t){const i=this.cache;bo(i,t)||(m.uniform3uiv(this.addr,t),oo(i,t))}function Mc(m,t){const i=this.cache;bo(i,t)||(m.uniform4uiv(this.addr,t),oo(i,t))}function ds(m,t,i){const a=this.cache,u=i.allocateTextureUnit();a[0]!==u&&(m.uniform1i(this.addr,u),a[0]=u),i.safeSetTexture2D(t||Nl,u)}function Ac(m,t,i){const a=this.cache,u=i.allocateTextureUnit();a[0]!==u&&(m.uniform1i(this.addr,u),a[0]=u),i.setTexture3D(t||Nd,u)}function dp(m,t,i){const a=this.cache,u=i.allocateTextureUnit();a[0]!==u&&(m.uniform1i(this.addr,u),a[0]=u),i.safeSetTextureCube(t||Fl,u)}function Pc(m,t,i){const a=this.cache,u=i.allocateTextureUnit();a[0]!==u&&(m.uniform1i(this.addr,u),a[0]=u),i.setTexture2DArray(t||Dd,u)}function Tf(m,t){m.uniform1fv(this.addr,t)}function Ef(m,t){const i=Ul(t,this.size,2);m.uniform2fv(this.addr,i)}function Mf(m,t){const i=Ul(t,this.size,3);m.uniform3fv(this.addr,i)}function Cc(m,t){const i=Ul(t,this.size,4);m.uniform4fv(this.addr,i)}function fp(m,t){const i=Ul(t,this.size,4);m.uniformMatrix2fv(this.addr,!1,i)}function pp(m,t){const i=Ul(t,this.size,9);m.uniformMatrix3fv(this.addr,!1,i)}function mp(m,t){const i=Ul(t,this.size,16);m.uniformMatrix4fv(this.addr,!1,i)}function gp(m,t){m.uniform1iv(this.addr,t)}function Af(m,t){m.uniform2iv(this.addr,t)}function Bd(m,t){m.uniform3iv(this.addr,t)}function Pf(m,t){m.uniform4iv(this.addr,t)}function vp(m,t){m.uniform1uiv(this.addr,t)}function _p(m,t){m.uniform2uiv(this.addr,t)}function Ih(m,t){m.uniform3uiv(this.addr,t)}function yp(m,t){m.uniform4uiv(this.addr,t)}function Ud(m,t,i){const a=t.length,u=Fd(i,a);m.uniform1iv(this.addr,u);for(let d=0;d!==a;++d)i.safeSetTexture2D(t[d]||Nl,u[d])}function Lh(m,t,i){const a=t.length,u=Fd(i,a);m.uniform1iv(this.addr,u);for(let d=0;d!==a;++d)i.safeSetTextureCube(t[d]||Fl,u[d])}function kd(m,t,i){this.id=m,this.addr=i,this.cache=[],this.setValue=function(a){switch(a){case 5126:return Ec;case 35664:return cs;case 35665:return lp;case 35666:return bf;case 35674:return kl;case 35675:return wo;case 35676:return hp;case 5124:case 35670:return oi;case 35667:case 35671:return wf;case 35668:case 35672:return Ch;case 35669:case 35673:return cp;case 5125:return Vu;case 36294:return Sf;case 36295:return Rh;case 36296:return Mc;case 35678:case 36198:case 36298:case 36306:case 35682:return ds;case 35679:case 36299:case 36307:return Ac;case 35680:case 36300:case 36308:case 36293:return dp;case 36289:case 36303:case 36311:case 36292:return Pc}}(t.type)}function Rc(m,t,i){this.id=m,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function(a){switch(a){case 5126:return Tf;case 35664:return Ef;case 35665:return Mf;case 35666:return Cc;case 35674:return fp;case 35675:return pp;case 35676:return mp;case 5124:case 35670:return gp;case 35667:case 35671:return Af;case 35668:case 35672:return Bd;case 35669:case 35673:return Pf;case 5125:return vp;case 36294:return _p;case 36295:return Ih;case 36296:return yp;case 35678:case 36198:case 36298:case 36306:case 35682:return Ud;case 35680:case 36300:case 36308:case 36293:return Lh}}(t.type)}function vu(m){this.id=m,this.seq=[],this.map={}}Rc.prototype.updateCache=function(m){const t=this.cache;m instanceof Float32Array&&t.length!==m.length&&(this.cache=new Float32Array(m.length)),oo(t,m)},vu.prototype.setValue=function(m,t,i){const a=this.seq;for(let u=0,d=a.length;u!==d;++u){const f=a[u];f.setValue(m,t[f.id],i)}};const Ic=/(\w+)(\])?(\[|\.)?/g;function Lc(m,t){m.seq.push(t),m.map[t.id]=t}function Oc(m,t,i){const a=m.name,u=a.length;for(Ic.lastIndex=0;;){const d=Ic.exec(a),f=Ic.lastIndex;let v=d[1];const _=d[2]==="]",y=d[3];if(_&&(v|=0),y===void 0||y==="["&&f+2===u){Lc(i,y===void 0?new kd(v,m,t):new Rc(v,m,t));break}{let E=i.map[v];E===void 0&&(E=new vu(v),Lc(i,E)),i=E}}}function Ba(m,t){this.seq=[],this.map={};const i=m.getProgramParameter(t,35718);for(let a=0;a<i;++a){const u=m.getActiveUniform(t,a);Oc(u,m.getUniformLocation(t,u.name),this)}}function Gl(m,t,i){const a=m.createShader(t);return m.shaderSource(a,i),m.compileShader(a),a}Ba.prototype.setValue=function(m,t,i,a){const u=this.map[t];u!==void 0&&u.setValue(m,i,a)},Ba.prototype.setOptional=function(m,t,i){const a=t[i];a!==void 0&&this.setValue(m,i,a)},Ba.upload=function(m,t,i,a){for(let u=0,d=t.length;u!==d;++u){const f=t[u],v=i[f.id];v.needsUpdate!==!1&&f.setValue(m,v.value,a)}},Ba.seqWithValue=function(m,t){const i=[];for(let a=0,u=m.length;a!==u;++a){const d=m[a];d.id in t&&i.push(d)}return i};let Hl=0;function Gd(m){switch(m){case ro:return["Linear","( value )"];case Pa:return["sRGB","( value )"];case fe:return["RGBE","( value )"];case sn:return["RGBM","( value, 7.0 )"];case en:return["RGBM","( value, 16.0 )"];case pr:return["RGBD","( value, 256.0 )"];case Gt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case we:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",m),["Linear","( value )"]}}function zl(m,t,i){const a=m.getShaderParameter(t,35713),u=m.getShaderInfoLog(t).trim();return a&&u===""?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+i+`
`+u+function(d){const f=d.split(`
`);for(let v=0;v<f.length;v++)f[v]=v+1+": "+f[v];return f.join(`
`)}(m.getShaderSource(t))}function Wu(m,t){const i=Gd(t);return"vec4 "+m+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function Xu(m,t){const i=Gd(t);return"vec4 "+m+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function Oo(m,t){let i;switch(t){case Fr:i="Linear";break;case lo:i="Reinhard";break;case _s:i="OptimizedCineon";break;case Fn:i="ACESFilmic";break;case _i:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+m+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Ua(m){return m!==""}function Hd(m,t){return m.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Ds(m,t){return m.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const cr=/^[ \t]*#include +<([\w\d./]+)>/gm;function Oh(m){return m.replace(cr,Yo)}function Yo(m,t){const i=nr[t];if(i===void 0)throw new Error("Can not resolve #include <"+t+">");return Oh(i)}const Si=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,ka=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function zd(m){return m.replace(ka,Do).replace(Si,jd)}function jd(m,t,i,a){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Do(m,t,i,a)}function Do(m,t,i,a){let u="";for(let d=parseInt(t);d<parseInt(i);d++)u+=a.replace(/\[\s*i\s*\]/g,"[ "+d+" ]").replace(/UNROLLED_LOOP_INDEX/g,d);return u}function Dc(m){let t="precision "+m.precision+` float;
precision `+m.precision+" int;";return m.precision==="highp"?t+=`
#define HIGH_PRECISION`:m.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:m.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function Dh(m,t,i,a){const u=m.getContext(),d=i.defines;let f=i.vertexShader,v=i.fragmentShader;const _=function(Lt){let Ie="SHADOWMAP_TYPE_BASIC";return Lt.shadowMapType===lt?Ie="SHADOWMAP_TYPE_PCF":Lt.shadowMapType===Ft?Ie="SHADOWMAP_TYPE_PCF_SOFT":Lt.shadowMapType===jt&&(Ie="SHADOWMAP_TYPE_VSM"),Ie}(i),y=function(Lt){let Ie="ENVMAP_TYPE_CUBE";if(Lt.envMap)switch(Lt.envMapMode){case L:case k:Ie="ENVMAP_TYPE_CUBE";break;case K:case et:Ie="ENVMAP_TYPE_CUBE_UV"}return Ie}(i),E=function(Lt){let Ie="ENVMAP_MODE_REFLECTION";if(Lt.envMap)switch(Lt.envMapMode){case k:case et:Ie="ENVMAP_MODE_REFRACTION"}return Ie}(i),A=function(Lt){let Ie="ENVMAP_BLENDING_NONE";if(Lt.envMap)switch(Lt.combine){case yr:Ie="ENVMAP_BLENDING_MULTIPLY";break;case Ri:Ie="ENVMAP_BLENDING_MIX";break;case Or:Ie="ENVMAP_BLENDING_ADD"}return Ie}(i),M=m.gammaFactor>0?m.gammaFactor:1,P=i.isWebGL2?"":function(Lt){return[Lt.extensionDerivatives||Lt.envMapCubeUV||Lt.bumpMap||Lt.tangentSpaceNormalMap||Lt.clearcoatNormalMap||Lt.flatShading||Lt.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(Lt.extensionFragDepth||Lt.logarithmicDepthBuffer)&&Lt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",Lt.extensionDrawBuffers&&Lt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(Lt.extensionShaderTextureLOD||Lt.envMap||Lt.transmission>0)&&Lt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ua).join(`
`)}(i),O=function(Lt){const Ie=[];for(const _e in Lt){const ye=Lt[_e];ye!==!1&&Ie.push("#define "+_e+" "+ye)}return Ie.join(`
`)}(d),U=u.createProgram();let D,Z,rt=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(D=[O].filter(Ua).join(`
`),D.length>0&&(D+=`
`),Z=[P,O].filter(Ua).join(`
`),Z.length>0&&(Z+=`
`)):(D=[Dc(i),"#define SHADER_NAME "+i.shaderName,O,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+M,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+E:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+_:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ua).join(`
`),Z=[P,Dc(i),"#define SHADER_NAME "+i.shaderName,O,i.alphaTest?"#define ALPHATEST "+i.alphaTest+(i.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+M,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+y:"",i.envMap?"#define "+E:"",i.envMap?"#define "+A:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.sheen?"#define USE_SHEEN":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+_:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Er?"#define TONE_MAPPING":"",i.toneMapping!==Er?nr.tonemapping_pars_fragment:"",i.toneMapping!==Er?Oo("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",nr.encodings_pars_fragment,i.map?Wu("mapTexelToLinear",i.mapEncoding):"",i.matcap?Wu("matcapTexelToLinear",i.matcapEncoding):"",i.envMap?Wu("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMap?Wu("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.lightMap?Wu("lightMapTexelToLinear",i.lightMapEncoding):"",Xu("linearToOutputTexel",i.outputEncoding),i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Ua).join(`
`)),f=Oh(f),f=Hd(f,i),f=Ds(f,i),v=Oh(v),v=Hd(v,i),v=Ds(v,i),f=zd(f),v=zd(v),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(rt=`#version 300 es
`,D=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+D,Z=["#define varying in",i.glslVersion===yd?"":"out highp vec4 pc_fragColor;",i.glslVersion===yd?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+Z);const gt=rt+Z+v,pt=Gl(u,35633,rt+D+f),Mt=Gl(u,35632,gt);if(u.attachShader(U,pt),u.attachShader(U,Mt),i.index0AttributeName!==void 0?u.bindAttribLocation(U,0,i.index0AttributeName):i.morphTargets===!0&&u.bindAttribLocation(U,0,"position"),u.linkProgram(U),m.debug.checkShaderErrors){const Lt=u.getProgramInfoLog(U).trim(),Ie=u.getShaderInfoLog(pt).trim(),_e=u.getShaderInfoLog(Mt).trim();let ye=!0,me=!0;if(u.getProgramParameter(U,35714)===!1){ye=!1;const Ht=zl(u,pt,"vertex"),ae=zl(u,Mt,"fragment");console.error("THREE.WebGLProgram: shader error: ",u.getError(),"35715",u.getProgramParameter(U,35715),"gl.getProgramInfoLog",Lt,Ht,ae)}else Lt!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",Lt):Ie!==""&&_e!==""||(me=!1);me&&(this.diagnostics={runnable:ye,programLog:Lt,vertexShader:{log:Ie,prefix:D},fragmentShader:{log:_e,prefix:Z}})}let At,Et;return u.deleteShader(pt),u.deleteShader(Mt),this.getUniforms=function(){return At===void 0&&(At=new Ba(u,U)),At},this.getAttributes=function(){return Et===void 0&&(Et=function(Lt,Ie){const _e={},ye=Lt.getProgramParameter(Ie,35721);for(let me=0;me<ye;me++){const Ht=Lt.getActiveAttrib(Ie,me).name;_e[Ht]=Lt.getAttribLocation(Ie,Ht)}return _e}(u,U)),Et},this.destroy=function(){a.releaseStatesOfProgram(this),u.deleteProgram(U),this.program=void 0},this.name=i.shaderName,this.id=Hl++,this.cacheKey=t,this.usedTimes=1,this.program=U,this.vertexShader=pt,this.fragmentShader=Mt,this}function Ti(m,t,i,a,u,d){const f=[],v=a.isWebGL2,_=a.logarithmicDepthBuffer,y=a.floatVertexTextures,E=a.maxVertexUniforms,A=a.vertexTextures;let M=a.precision;const P={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},O=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmission","transmissionMap","thicknessMap"];function U(D){let Z;return D&&D.isTexture?Z=D.encoding:D&&D.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),Z=D.texture.encoding):Z=ro,Z}return{getParameters:function(D,Z,rt,gt,pt){const Mt=gt.fog,At=D.isMeshStandardMaterial?gt.environment:null,Et=t.get(D.envMap||At),Lt=P[D.type],Ie=pt.isSkinnedMesh?function(Ht){const ae=Ht.skeleton.bones;if(y)return 1024;{const Ze=E,Xe=Math.floor((Ze-20)/4),je=Math.min(Xe,ae.length);return je<ae.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+ae.length+" bones. This GPU supports "+je+"."),0):je}}(pt):0;let _e,ye;if(D.precision!==null&&(M=a.getMaxPrecision(D.precision),M!==D.precision&&console.warn("THREE.WebGLProgram.getParameters:",D.precision,"not supported, using",M,"instead.")),Lt){const Ht=Is[Lt];_e=Ht.vertexShader,ye=Ht.fragmentShader}else _e=D.vertexShader,ye=D.fragmentShader;const me=m.getRenderTarget();return{isWebGL2:v,shaderID:Lt,shaderName:D.type,vertexShader:_e,fragmentShader:ye,defines:D.defines,isRawShaderMaterial:D.isRawShaderMaterial===!0,glslVersion:D.glslVersion,precision:M,instancing:pt.isInstancedMesh===!0,instancingColor:pt.isInstancedMesh===!0&&pt.instanceColor!==null,supportsVertexTextures:A,outputEncoding:me!==null?U(me.texture):m.outputEncoding,map:!!D.map,mapEncoding:U(D.map),matcap:!!D.matcap,matcapEncoding:U(D.matcap),envMap:!!Et,envMapMode:Et&&Et.mapping,envMapEncoding:U(Et),envMapCubeUV:!!Et&&(Et.mapping===K||Et.mapping===et),lightMap:!!D.lightMap,lightMapEncoding:U(D.lightMap),aoMap:!!D.aoMap,emissiveMap:!!D.emissiveMap,emissiveMapEncoding:U(D.emissiveMap),bumpMap:!!D.bumpMap,normalMap:!!D.normalMap,objectSpaceNormalMap:D.normalMapType===Eu,tangentSpaceNormalMap:D.normalMapType===On,clearcoatMap:!!D.clearcoatMap,clearcoatRoughnessMap:!!D.clearcoatRoughnessMap,clearcoatNormalMap:!!D.clearcoatNormalMap,displacementMap:!!D.displacementMap,roughnessMap:!!D.roughnessMap,metalnessMap:!!D.metalnessMap,specularMap:!!D.specularMap,alphaMap:!!D.alphaMap,gradientMap:!!D.gradientMap,sheen:!!D.sheen,transmission:!!D.transmission,transmissionMap:!!D.transmissionMap,thicknessMap:!!D.thicknessMap,combine:D.combine,vertexTangents:D.normalMap&&D.vertexTangents,vertexColors:D.vertexColors,vertexAlphas:D.vertexColors===!0&&pt.geometry&&pt.geometry.attributes.color&&pt.geometry.attributes.color.itemSize===4,vertexUvs:!!(D.map||D.bumpMap||D.normalMap||D.specularMap||D.alphaMap||D.emissiveMap||D.roughnessMap||D.metalnessMap||D.clearcoatMap||D.clearcoatRoughnessMap||D.clearcoatNormalMap||D.displacementMap||D.transmissionMap||D.thicknessMap),uvsVertexOnly:!(D.map||D.bumpMap||D.normalMap||D.specularMap||D.alphaMap||D.emissiveMap||D.roughnessMap||D.metalnessMap||D.clearcoatNormalMap||D.transmission||D.transmissionMap||D.thicknessMap||!D.displacementMap),fog:!!Mt,useFog:D.fog,fogExp2:Mt&&Mt.isFogExp2,flatShading:!!D.flatShading,sizeAttenuation:D.sizeAttenuation,logarithmicDepthBuffer:_,skinning:pt.isSkinnedMesh===!0&&Ie>0,maxBones:Ie,useVertexTexture:y,morphTargets:D.morphTargets,morphNormals:D.morphNormals,numDirLights:Z.directional.length,numPointLights:Z.point.length,numSpotLights:Z.spot.length,numRectAreaLights:Z.rectArea.length,numHemiLights:Z.hemi.length,numDirLightShadows:Z.directionalShadowMap.length,numPointLightShadows:Z.pointShadowMap.length,numSpotLightShadows:Z.spotShadowMap.length,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:D.dithering,shadowMapEnabled:m.shadowMap.enabled&&rt.length>0,shadowMapType:m.shadowMap.type,toneMapping:D.toneMapped?m.toneMapping:Er,physicallyCorrectLights:m.physicallyCorrectLights,premultipliedAlpha:D.premultipliedAlpha,alphaTest:D.alphaTest,doubleSided:D.side===B,flipSided:D.side===I,depthPacking:D.depthPacking!==void 0&&D.depthPacking,index0AttributeName:D.index0AttributeName,extensionDerivatives:D.extensions&&D.extensions.derivatives,extensionFragDepth:D.extensions&&D.extensions.fragDepth,extensionDrawBuffers:D.extensions&&D.extensions.drawBuffers,extensionShaderTextureLOD:D.extensions&&D.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||i.has("EXT_shader_texture_lod"),customProgramCacheKey:D.customProgramCacheKey()}},getProgramCacheKey:function(D){const Z=[];if(D.shaderID?Z.push(D.shaderID):(Z.push(D.fragmentShader),Z.push(D.vertexShader)),D.defines!==void 0)for(const rt in D.defines)Z.push(rt),Z.push(D.defines[rt]);if(D.isRawShaderMaterial===!1){for(let rt=0;rt<O.length;rt++)Z.push(D[O[rt]]);Z.push(m.outputEncoding),Z.push(m.gammaFactor)}return Z.push(D.customProgramCacheKey),Z.join()},getUniforms:function(D){const Z=P[D.type];let rt;if(Z){const gt=Is[Z];rt=Ad.clone(gt.uniforms)}else rt=D.uniforms;return rt},acquireProgram:function(D,Z){let rt;for(let gt=0,pt=f.length;gt<pt;gt++){const Mt=f[gt];if(Mt.cacheKey===Z){rt=Mt,++rt.usedTimes;break}}return rt===void 0&&(rt=new Dh(m,Z,D,u),f.push(rt)),rt},releaseProgram:function(D){if(--D.usedTimes==0){const Z=f.indexOf(D);f[Z]=f[f.length-1],f.pop(),D.destroy()}},programs:f}}function Ei(){let m=new WeakMap;return{get:function(t){let i=m.get(t);return i===void 0&&(i={},m.set(t,i)),i},remove:function(t){m.delete(t)},update:function(t,i,a){m.get(t)[i]=a},dispose:function(){m=new WeakMap}}}function Vd(m,t){return m.groupOrder!==t.groupOrder?m.groupOrder-t.groupOrder:m.renderOrder!==t.renderOrder?m.renderOrder-t.renderOrder:m.program!==t.program?m.program.id-t.program.id:m.material.id!==t.material.id?m.material.id-t.material.id:m.z!==t.z?m.z-t.z:m.id-t.id}function Wd(m,t){return m.groupOrder!==t.groupOrder?m.groupOrder-t.groupOrder:m.renderOrder!==t.renderOrder?m.renderOrder-t.renderOrder:m.z!==t.z?t.z-m.z:m.id-t.id}function qu(m){const t=[];let i=0;const a=[],u=[],d=[],f={id:-1};function v(_,y,E,A,M,P){let O=t[i];const U=m.get(E);return O===void 0?(O={id:_.id,object:_,geometry:y,material:E,program:U.program||f,groupOrder:A,renderOrder:_.renderOrder,z:M,group:P},t[i]=O):(O.id=_.id,O.object=_,O.geometry=y,O.material=E,O.program=U.program||f,O.groupOrder=A,O.renderOrder=_.renderOrder,O.z=M,O.group=P),i++,O}return{opaque:a,transmissive:u,transparent:d,init:function(){i=0,a.length=0,u.length=0,d.length=0},push:function(_,y,E,A,M,P){const O=v(_,y,E,A,M,P);E.transmission>0?u.push(O):E.transparent===!0?d.push(O):a.push(O)},unshift:function(_,y,E,A,M,P){const O=v(_,y,E,A,M,P);E.transmission>0?u.unshift(O):E.transparent===!0?d.unshift(O):a.unshift(O)},finish:function(){for(let _=i,y=t.length;_<y;_++){const E=t[_];if(E.id===null)break;E.id=null,E.object=null,E.geometry=null,E.material=null,E.program=null,E.group=null}},sort:function(_,y){a.length>1&&a.sort(_||Vd),u.length>1&&u.sort(y||Wd),d.length>1&&d.sort(y||Wd)}}}function Nc(m){let t=new WeakMap;return{get:function(i,a){let u;return t.has(i)===!1?(u=new qu(m),t.set(i,[u])):a>=t.get(i).length?(u=new qu(m),t.get(i).push(u)):u=t.get(i)[a],u},dispose:function(){t=new WeakMap}}}function Xd(){const m={};return{get:function(t){if(m[t.id]!==void 0)return m[t.id];let i;switch(t.type){case"DirectionalLight":i={direction:new mt,color:new pn};break;case"SpotLight":i={position:new mt,direction:new mt,color:new pn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new mt,color:new pn,distance:0,decay:0};break;case"HemisphereLight":i={direction:new mt,skyColor:new pn,groundColor:new pn};break;case"RectAreaLight":i={color:new pn,position:new mt,halfWidth:new mt,halfHeight:new mt}}return m[t.id]=i,i}}}let Nh=0;function Zo(m,t){return(t.castShadow?1:0)-(m.castShadow?1:0)}function Yu(m,t){const i=new Xd,a=function(){const _={};return{get:function(y){if(_[y.id]!==void 0)return _[y.id];let E;switch(y.type){case"DirectionalLight":case"SpotLight":E={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new He};break;case"PointLight":E={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new He,shadowCameraNear:1,shadowCameraFar:1e3}}return _[y.id]=E,E}}}(),u={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let _=0;_<9;_++)u.probe.push(new mt);const d=new mt,f=new Tn,v=new Tn;return{setup:function(_){let y=0,E=0,A=0;for(let Mt=0;Mt<9;Mt++)u.probe[Mt].set(0,0,0);let M=0,P=0,O=0,U=0,D=0,Z=0,rt=0,gt=0;_.sort(Zo);for(let Mt=0,At=_.length;Mt<At;Mt++){const Et=_[Mt],Lt=Et.color,Ie=Et.intensity,_e=Et.distance,ye=Et.shadow&&Et.shadow.map?Et.shadow.map.texture:null;if(Et.isAmbientLight)y+=Lt.r*Ie,E+=Lt.g*Ie,A+=Lt.b*Ie;else if(Et.isLightProbe)for(let me=0;me<9;me++)u.probe[me].addScaledVector(Et.sh.coefficients[me],Ie);else if(Et.isDirectionalLight){const me=i.get(Et);if(me.color.copy(Et.color).multiplyScalar(Et.intensity),Et.castShadow){const Ht=Et.shadow,ae=a.get(Et);ae.shadowBias=Ht.bias,ae.shadowNormalBias=Ht.normalBias,ae.shadowRadius=Ht.radius,ae.shadowMapSize=Ht.mapSize,u.directionalShadow[M]=ae,u.directionalShadowMap[M]=ye,u.directionalShadowMatrix[M]=Et.shadow.matrix,Z++}u.directional[M]=me,M++}else if(Et.isSpotLight){const me=i.get(Et);if(me.position.setFromMatrixPosition(Et.matrixWorld),me.color.copy(Lt).multiplyScalar(Ie),me.distance=_e,me.coneCos=Math.cos(Et.angle),me.penumbraCos=Math.cos(Et.angle*(1-Et.penumbra)),me.decay=Et.decay,Et.castShadow){const Ht=Et.shadow,ae=a.get(Et);ae.shadowBias=Ht.bias,ae.shadowNormalBias=Ht.normalBias,ae.shadowRadius=Ht.radius,ae.shadowMapSize=Ht.mapSize,u.spotShadow[O]=ae,u.spotShadowMap[O]=ye,u.spotShadowMatrix[O]=Et.shadow.matrix,gt++}u.spot[O]=me,O++}else if(Et.isRectAreaLight){const me=i.get(Et);me.color.copy(Lt).multiplyScalar(Ie),me.halfWidth.set(.5*Et.width,0,0),me.halfHeight.set(0,.5*Et.height,0),u.rectArea[U]=me,U++}else if(Et.isPointLight){const me=i.get(Et);if(me.color.copy(Et.color).multiplyScalar(Et.intensity),me.distance=Et.distance,me.decay=Et.decay,Et.castShadow){const Ht=Et.shadow,ae=a.get(Et);ae.shadowBias=Ht.bias,ae.shadowNormalBias=Ht.normalBias,ae.shadowRadius=Ht.radius,ae.shadowMapSize=Ht.mapSize,ae.shadowCameraNear=Ht.camera.near,ae.shadowCameraFar=Ht.camera.far,u.pointShadow[P]=ae,u.pointShadowMap[P]=ye,u.pointShadowMatrix[P]=Et.shadow.matrix,rt++}u.point[P]=me,P++}else if(Et.isHemisphereLight){const me=i.get(Et);me.skyColor.copy(Et.color).multiplyScalar(Ie),me.groundColor.copy(Et.groundColor).multiplyScalar(Ie),u.hemi[D]=me,D++}}U>0&&(t.isWebGL2||m.has("OES_texture_float_linear")===!0?(u.rectAreaLTC1=ze.LTC_FLOAT_1,u.rectAreaLTC2=ze.LTC_FLOAT_2):m.has("OES_texture_half_float_linear")===!0?(u.rectAreaLTC1=ze.LTC_HALF_1,u.rectAreaLTC2=ze.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),u.ambient[0]=y,u.ambient[1]=E,u.ambient[2]=A;const pt=u.hash;pt.directionalLength===M&&pt.pointLength===P&&pt.spotLength===O&&pt.rectAreaLength===U&&pt.hemiLength===D&&pt.numDirectionalShadows===Z&&pt.numPointShadows===rt&&pt.numSpotShadows===gt||(u.directional.length=M,u.spot.length=O,u.rectArea.length=U,u.point.length=P,u.hemi.length=D,u.directionalShadow.length=Z,u.directionalShadowMap.length=Z,u.pointShadow.length=rt,u.pointShadowMap.length=rt,u.spotShadow.length=gt,u.spotShadowMap.length=gt,u.directionalShadowMatrix.length=Z,u.pointShadowMatrix.length=rt,u.spotShadowMatrix.length=gt,pt.directionalLength=M,pt.pointLength=P,pt.spotLength=O,pt.rectAreaLength=U,pt.hemiLength=D,pt.numDirectionalShadows=Z,pt.numPointShadows=rt,pt.numSpotShadows=gt,u.version=Nh++)},setupView:function(_,y){let E=0,A=0,M=0,P=0,O=0;const U=y.matrixWorldInverse;for(let D=0,Z=_.length;D<Z;D++){const rt=_[D];if(rt.isDirectionalLight){const gt=u.directional[E];gt.direction.setFromMatrixPosition(rt.matrixWorld),d.setFromMatrixPosition(rt.target.matrixWorld),gt.direction.sub(d),gt.direction.transformDirection(U),E++}else if(rt.isSpotLight){const gt=u.spot[M];gt.position.setFromMatrixPosition(rt.matrixWorld),gt.position.applyMatrix4(U),gt.direction.setFromMatrixPosition(rt.matrixWorld),d.setFromMatrixPosition(rt.target.matrixWorld),gt.direction.sub(d),gt.direction.transformDirection(U),M++}else if(rt.isRectAreaLight){const gt=u.rectArea[P];gt.position.setFromMatrixPosition(rt.matrixWorld),gt.position.applyMatrix4(U),v.identity(),f.copy(rt.matrixWorld),f.premultiply(U),v.extractRotation(f),gt.halfWidth.set(.5*rt.width,0,0),gt.halfHeight.set(0,.5*rt.height,0),gt.halfWidth.applyMatrix4(v),gt.halfHeight.applyMatrix4(v),P++}else if(rt.isPointLight){const gt=u.point[A];gt.position.setFromMatrixPosition(rt.matrixWorld),gt.position.applyMatrix4(U),A++}else if(rt.isHemisphereLight){const gt=u.hemi[O];gt.direction.setFromMatrixPosition(rt.matrixWorld),gt.direction.transformDirection(U),gt.direction.normalize(),O++}}},state:u}}function qd(m,t){const i=new Yu(m,t),a=[],u=[];return{init:function(){a.length=0,u.length=0},state:{lightsArray:a,shadowsArray:u,lights:i},setupLights:function(){i.setup(a)},setupLightsView:function(d){i.setupView(a,d)},pushLight:function(d){a.push(d)},pushShadow:function(d){u.push(d)}}}function Cf(m,t){let i=new WeakMap;return{get:function(a,u=0){let d;return i.has(a)===!1?(d=new qd(m,t),i.set(a,[d])):u>=i.get(a).length?(d=new qd(m,t),i.get(a).push(d)):d=i.get(a)[u],d},dispose:function(){i=new WeakMap}}}class jl extends ji{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=hi,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}jl.prototype.isMeshDepthMaterial=!0;class fs extends ji{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new mt,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}fs.prototype.isMeshDistanceMaterial=!0;function dr(m,t,i){let a=new Fa;const u=new He,d=new He,f=new Ir,v=[],_=[],y={},E=i.maxTextureSize,A={0:I,1:kt,2:B},M=new go({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new He},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),P=M.clone();P.defines.HORIZONTAL_PASS=1;const O=new Dn;O.setAttribute("position",new hr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const U=new mi(O,M),D=this;function Z(At,Et){const Lt=t.update(U);M.uniforms.shadow_pass.value=At.map.texture,M.uniforms.resolution.value=At.mapSize,M.uniforms.radius.value=At.radius,m.setRenderTarget(At.mapPass),m.clear(),m.renderBufferDirect(Et,null,Lt,M,U,null),P.uniforms.shadow_pass.value=At.mapPass.texture,P.uniforms.resolution.value=At.mapSize,P.uniforms.radius.value=At.radius,m.setRenderTarget(At.map),m.clear(),m.renderBufferDirect(Et,null,Lt,P,U,null)}function rt(At){const Et=At<<0;let Lt=v[Et];return Lt===void 0&&(Lt=new jl({depthPacking:Hs,morphTargets:At}),v[Et]=Lt),Lt}function gt(At){const Et=At<<0;let Lt=_[Et];return Lt===void 0&&(Lt=new fs({morphTargets:At}),_[Et]=Lt),Lt}function pt(At,Et,Lt,Ie,_e,ye,me){let Ht=null,ae=rt,Ze=At.customDepthMaterial;if(Ie.isPointLight===!0&&(ae=gt,Ze=At.customDistanceMaterial),Ze===void 0){let Xe=!1;Lt.morphTargets===!0&&(Xe=Et.morphAttributes&&Et.morphAttributes.position&&Et.morphAttributes.position.length>0),Ht=ae(Xe)}else Ht=Ze;if(m.localClippingEnabled&&Lt.clipShadows===!0&&Lt.clippingPlanes.length!==0){const Xe=Ht.uuid,je=Lt.uuid;let gn=y[Xe];gn===void 0&&(gn={},y[Xe]=gn);let Sn=gn[je];Sn===void 0&&(Sn=Ht.clone(),gn[je]=Sn),Ht=Sn}return Ht.visible=Lt.visible,Ht.wireframe=Lt.wireframe,Ht.side=me===jt?Lt.shadowSide!==null?Lt.shadowSide:Lt.side:Lt.shadowSide!==null?Lt.shadowSide:A[Lt.side],Ht.clipShadows=Lt.clipShadows,Ht.clippingPlanes=Lt.clippingPlanes,Ht.clipIntersection=Lt.clipIntersection,Ht.wireframeLinewidth=Lt.wireframeLinewidth,Ht.linewidth=Lt.linewidth,Ie.isPointLight===!0&&Ht.isMeshDistanceMaterial===!0&&(Ht.referencePosition.setFromMatrixPosition(Ie.matrixWorld),Ht.nearDistance=_e,Ht.farDistance=ye),Ht}function Mt(At,Et,Lt,Ie,_e){if(At.visible===!1)return;if(At.layers.test(Et.layers)&&(At.isMesh||At.isLine||At.isPoints)&&(At.castShadow||At.receiveShadow&&_e===jt)&&(!At.frustumCulled||a.intersectsObject(At))){At.modelViewMatrix.multiplyMatrices(Lt.matrixWorldInverse,At.matrixWorld);const me=t.update(At),Ht=At.material;if(Array.isArray(Ht)){const ae=me.groups;for(let Ze=0,Xe=ae.length;Ze<Xe;Ze++){const je=ae[Ze],gn=Ht[je.materialIndex];if(gn&&gn.visible){const Sn=pt(At,me,gn,Ie,Lt.near,Lt.far,_e);m.renderBufferDirect(Lt,null,me,Sn,At,je)}}}else if(Ht.visible){const ae=pt(At,me,Ht,Ie,Lt.near,Lt.far,_e);m.renderBufferDirect(Lt,null,me,ae,At,null)}}const ye=At.children;for(let me=0,Ht=ye.length;me<Ht;me++)Mt(ye[me],Et,Lt,Ie,_e)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=lt,this.render=function(At,Et,Lt){if(D.enabled===!1||D.autoUpdate===!1&&D.needsUpdate===!1||At.length===0)return;const Ie=m.getRenderTarget(),_e=m.getActiveCubeFace(),ye=m.getActiveMipmapLevel(),me=m.state;me.setBlending(F),me.buffers.color.setClear(1,1,1,1),me.buffers.depth.setTest(!0),me.setScissorTest(!1);for(let Ht=0,ae=At.length;Ht<ae;Ht++){const Ze=At[Ht],Xe=Ze.shadow;if(Xe===void 0){console.warn("THREE.WebGLShadowMap:",Ze,"has no shadow.");continue}if(Xe.autoUpdate===!1&&Xe.needsUpdate===!1)continue;u.copy(Xe.mapSize);const je=Xe.getFrameExtents();if(u.multiply(je),d.copy(Xe.mapSize),(u.x>E||u.y>E)&&(u.x>E&&(d.x=Math.floor(E/je.x),u.x=d.x*je.x,Xe.mapSize.x=d.x),u.y>E&&(d.y=Math.floor(E/je.y),u.y=d.y*je.y,Xe.mapSize.y=d.y)),Xe.map===null&&!Xe.isPointLightShadow&&this.type===jt){const Sn={minFilter:We,magFilter:We,format:Pn};Xe.map=new Po(u.x,u.y,Sn),Xe.map.texture.name=Ze.name+".shadowMap",Xe.mapPass=new Po(u.x,u.y,Sn),Xe.camera.updateProjectionMatrix()}if(Xe.map===null){const Sn={minFilter:St,magFilter:St,format:Pn};Xe.map=new Po(u.x,u.y,Sn),Xe.map.texture.name=Ze.name+".shadowMap",Xe.camera.updateProjectionMatrix()}m.setRenderTarget(Xe.map),m.clear();const gn=Xe.getViewportCount();for(let Sn=0;Sn<gn;Sn++){const In=Xe.getViewport(Sn);f.set(d.x*In.x,d.y*In.y,d.x*In.z,d.y*In.w),me.viewport(f),Xe.updateMatrices(Ze,Sn),a=Xe.getFrustum(),Mt(Et,Lt,Xe.camera,Ze,this.type)}Xe.isPointLightShadow||this.type!==jt||Z(Xe,Lt),Xe.needsUpdate=!1}D.needsUpdate=!1,m.setRenderTarget(Ie,_e,ye)}}function Yd(m,t,i){const a=i.isWebGL2,u=new function(){let yt=!1;const Yt=new Ir;let Se=null;const Ae=new Ir(0,0,0,0);return{setMask:function(be){Se===be||yt||(m.colorMask(be,be,be,be),Se=be)},setLocked:function(be){yt=be},setClear:function(be,An,Yn,Gn,Sr){Sr===!0&&(be*=Gn,An*=Gn,Yn*=Gn),Yt.set(be,An,Yn,Gn),Ae.equals(Yt)===!1&&(m.clearColor(be,An,Yn,Gn),Ae.copy(Yt))},reset:function(){yt=!1,Se=null,Ae.set(-1,0,0,0)}}},d=new function(){let yt=!1,Yt=null,Se=null,Ae=null;return{setTest:function(be){be?Rn(2929):Pt(2929)},setMask:function(be){Yt===be||yt||(m.depthMask(be),Yt=be)},setFunc:function(be){if(Se!==be){if(be)switch(be){case Hn:m.depthFunc(512);break;case er:m.depthFunc(519);break;case bn:m.depthFunc(513);break;case Cr:m.depthFunc(515);break;case Lr:m.depthFunc(514);break;case Rr:m.depthFunc(518);break;case Yr:m.depthFunc(516);break;case Ar:m.depthFunc(517);break;default:m.depthFunc(515)}else m.depthFunc(515);Se=be}},setLocked:function(be){yt=be},setClear:function(be){Ae!==be&&(m.clearDepth(be),Ae=be)},reset:function(){yt=!1,Yt=null,Se=null,Ae=null}}},f=new function(){let yt=!1,Yt=null,Se=null,Ae=null,be=null,An=null,Yn=null,Gn=null,Sr=null;return{setTest:function(Mr){yt||(Mr?Rn(2960):Pt(2960))},setMask:function(Mr){Yt===Mr||yt||(m.stencilMask(Mr),Yt=Mr)},setFunc:function(Mr,No,Pi){Se===Mr&&Ae===No&&be===Pi||(m.stencilFunc(Mr,No,Pi),Se=Mr,Ae=No,be=Pi)},setOp:function(Mr,No,Pi){An===Mr&&Yn===No&&Gn===Pi||(m.stencilOp(Mr,No,Pi),An=Mr,Yn=No,Gn=Pi)},setLocked:function(Mr){yt=Mr},setClear:function(Mr){Sr!==Mr&&(m.clearStencil(Mr),Sr=Mr)},reset:function(){yt=!1,Yt=null,Se=null,Ae=null,be=null,An=null,Yn=null,Gn=null,Sr=null}}};let v={},_=null,y={},E=null,A=!1,M=null,P=null,O=null,U=null,D=null,Z=null,rt=null,gt=!1,pt=null,Mt=null,At=null,Et=null,Lt=null;const Ie=m.getParameter(35661);let _e=!1,ye=0;const me=m.getParameter(7938);me.indexOf("WebGL")!==-1?(ye=parseFloat(/^WebGL (\d)/.exec(me)[1]),_e=ye>=1):me.indexOf("OpenGL ES")!==-1&&(ye=parseFloat(/^OpenGL ES (\d)/.exec(me)[1]),_e=ye>=2);let Ht=null,ae={};const Ze=m.getParameter(3088),Xe=m.getParameter(2978),je=new Ir().fromArray(Ze),gn=new Ir().fromArray(Xe);function Sn(yt,Yt,Se){const Ae=new Uint8Array(4),be=m.createTexture();m.bindTexture(yt,be),m.texParameteri(yt,10241,9728),m.texParameteri(yt,10240,9728);for(let An=0;An<Se;An++)m.texImage2D(Yt+An,0,6408,1,1,0,6408,5121,Ae);return be}const In={};function Rn(yt){v[yt]!==!0&&(m.enable(yt),v[yt]=!0)}function Pt(yt){v[yt]!==!1&&(m.disable(yt),v[yt]=!1)}In[3553]=Sn(3553,3553,1),In[34067]=Sn(34067,34069,6),u.setClear(0,0,0,1),d.setClear(1),f.setClear(0),Rn(2929),d.setFunc(Cr),ce(!1),on(X),Rn(2884),Be(F);const Ot={[ee]:32774,[xt]:32778,[Zt]:32779};if(a)Ot[$t]=32775,Ot[Q]=32776;else{const yt=t.get("EXT_blend_minmax");yt!==null&&(Ot[$t]=yt.MIN_EXT,Ot[Q]=yt.MAX_EXT)}const Fe={[Bt]:0,[Wt]:1,[Kt]:768,[oe]:770,[Un]:776,[Zn]:774,[$e]:772,[Xt]:769,[de]:771,[Ke]:775,[Ue]:773};function Be(yt,Yt,Se,Ae,be,An,Yn,Gn){if(yt!==F){if(A===!1&&(Rn(3042),A=!0),yt===Le)be=be||Yt,An=An||Se,Yn=Yn||Ae,Yt===P&&be===D||(m.blendEquationSeparate(Ot[Yt],Ot[be]),P=Yt,D=be),Se===O&&Ae===U&&An===Z&&Yn===rt||(m.blendFuncSeparate(Fe[Se],Fe[Ae],Fe[An],Fe[Yn]),O=Se,U=Ae,Z=An,rt=Yn),M=yt,gt=null;else if(yt!==M||Gn!==gt){if(P===ee&&D===ee||(m.blendEquation(32774),P=ee,D=ee),Gn)switch(yt){case Y:m.blendFuncSeparate(1,771,1,771);break;case $:m.blendFunc(1,1);break;case ct:m.blendFuncSeparate(0,0,769,771);break;case se:m.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",yt)}else switch(yt){case Y:m.blendFuncSeparate(770,771,1,771);break;case $:m.blendFunc(770,1);break;case ct:m.blendFunc(0,769);break;case se:m.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",yt)}O=null,U=null,Z=null,rt=null,M=yt,gt=Gn}}else A===!0&&(Pt(3042),A=!1)}function ce(yt){pt!==yt&&(yt?m.frontFace(2304):m.frontFace(2305),pt=yt)}function on(yt){yt!==ot?(Rn(2884),yt!==Mt&&(yt===X?m.cullFace(1029):yt===ft?m.cullFace(1028):m.cullFace(1032))):Pt(2884),Mt=yt}function un(yt,Yt,Se){yt?(Rn(32823),Et===Yt&&Lt===Se||(m.polygonOffset(Yt,Se),Et=Yt,Lt=Se)):Pt(32823)}function xe(yt){yt===void 0&&(yt=33984+Ie-1),Ht!==yt&&(m.activeTexture(yt),Ht=yt)}return{buffers:{color:u,depth:d,stencil:f},enable:Rn,disable:Pt,bindFramebuffer:function(yt,Yt){return Yt===null&&_!==null&&(Yt=_),y[yt]!==Yt&&(m.bindFramebuffer(yt,Yt),y[yt]=Yt,a&&(yt===36009&&(y[36160]=Yt),yt===36160&&(y[36009]=Yt)),!0)},bindXRFramebuffer:function(yt){yt!==_&&(m.bindFramebuffer(36160,yt),_=yt)},useProgram:function(yt){return E!==yt&&(m.useProgram(yt),E=yt,!0)},setBlending:Be,setMaterial:function(yt,Yt){yt.side===B?Pt(2884):Rn(2884);let Se=yt.side===I;Yt&&(Se=!Se),ce(Se),yt.blending===Y&&yt.transparent===!1?Be(F):Be(yt.blending,yt.blendEquation,yt.blendSrc,yt.blendDst,yt.blendEquationAlpha,yt.blendSrcAlpha,yt.blendDstAlpha,yt.premultipliedAlpha),d.setFunc(yt.depthFunc),d.setTest(yt.depthTest),d.setMask(yt.depthWrite),u.setMask(yt.colorWrite);const Ae=yt.stencilWrite;f.setTest(Ae),Ae&&(f.setMask(yt.stencilWriteMask),f.setFunc(yt.stencilFunc,yt.stencilRef,yt.stencilFuncMask),f.setOp(yt.stencilFail,yt.stencilZFail,yt.stencilZPass)),un(yt.polygonOffset,yt.polygonOffsetFactor,yt.polygonOffsetUnits),yt.alphaToCoverage===!0?Rn(32926):Pt(32926)},setFlipSided:ce,setCullFace:on,setLineWidth:function(yt){yt!==At&&(_e&&m.lineWidth(yt),At=yt)},setPolygonOffset:un,setScissorTest:function(yt){yt?Rn(3089):Pt(3089)},activeTexture:xe,bindTexture:function(yt,Yt){Ht===null&&xe();let Se=ae[Ht];Se===void 0&&(Se={type:void 0,texture:void 0},ae[Ht]=Se),Se.type===yt&&Se.texture===Yt||(m.bindTexture(yt,Yt||In[yt]),Se.type=yt,Se.texture=Yt)},unbindTexture:function(){const yt=ae[Ht];yt!==void 0&&yt.type!==void 0&&(m.bindTexture(yt.type,null),yt.type=void 0,yt.texture=void 0)},compressedTexImage2D:function(){try{m.compressedTexImage2D.apply(m,arguments)}catch(yt){console.error("THREE.WebGLState:",yt)}},texImage2D:function(){try{m.texImage2D.apply(m,arguments)}catch(yt){console.error("THREE.WebGLState:",yt)}},texImage3D:function(){try{m.texImage3D.apply(m,arguments)}catch(yt){console.error("THREE.WebGLState:",yt)}},scissor:function(yt){je.equals(yt)===!1&&(m.scissor(yt.x,yt.y,yt.z,yt.w),je.copy(yt))},viewport:function(yt){gn.equals(yt)===!1&&(m.viewport(yt.x,yt.y,yt.z,yt.w),gn.copy(yt))},reset:function(){m.disable(3042),m.disable(2884),m.disable(2929),m.disable(32823),m.disable(3089),m.disable(2960),m.disable(32926),m.blendEquation(32774),m.blendFunc(1,0),m.blendFuncSeparate(1,0,1,0),m.colorMask(!0,!0,!0,!0),m.clearColor(0,0,0,0),m.depthMask(!0),m.depthFunc(513),m.clearDepth(1),m.stencilMask(4294967295),m.stencilFunc(519,0,4294967295),m.stencilOp(7680,7680,7680),m.clearStencil(0),m.cullFace(1029),m.frontFace(2305),m.polygonOffset(0,0),m.activeTexture(33984),m.bindFramebuffer(36160,null),a===!0&&(m.bindFramebuffer(36009,null),m.bindFramebuffer(36008,null)),m.useProgram(null),m.lineWidth(1),m.scissor(0,0,m.canvas.width,m.canvas.height),m.viewport(0,0,m.canvas.width,m.canvas.height),v={},Ht=null,ae={},_=null,y={},E=null,A=!1,M=null,P=null,O=null,U=null,D=null,Z=null,rt=null,gt=!1,pt=null,Mt=null,At=null,Et=null,Lt=null,je.set(0,0,m.canvas.width,m.canvas.height),gn.set(0,0,m.canvas.width,m.canvas.height),u.reset(),d.reset(),f.reset()}}}function ps(m,t,i,a,u,d,f){const v=u.isWebGL2,_=u.maxTextures,y=u.maxCubemapSize,E=u.maxTextureSize,A=u.maxSamples,M=new WeakMap;let P,O=!1;try{O=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function U(Pt,Ot){return O?new OffscreenCanvas(Pt,Ot):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function D(Pt,Ot,Fe,Be){let ce=1;if((Pt.width>Be||Pt.height>Be)&&(ce=Be/Math.max(Pt.width,Pt.height)),ce<1||Ot===!0){if(typeof HTMLImageElement!="undefined"&&Pt instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&Pt instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&Pt instanceof ImageBitmap){const on=Ot?xd:Math.floor,un=on(ce*Pt.width),xe=on(ce*Pt.height);P===void 0&&(P=U(un,xe));const yt=Fe?U(un,xe):P;return yt.width=un,yt.height=xe,yt.getContext("2d").drawImage(Pt,0,0,un,xe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Pt.width+"x"+Pt.height+") to ("+un+"x"+xe+")."),yt}return"data"in Pt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Pt.width+"x"+Pt.height+")."),Pt}return Pt}function Z(Pt){return ci(Pt.width)&&ci(Pt.height)}function rt(Pt,Ot){return Pt.generateMipmaps&&Ot&&Pt.minFilter!==St&&Pt.minFilter!==We}function gt(Pt,Ot,Fe,Be,ce=1){m.generateMipmap(Pt),a.get(Ot).__maxMipLevel=Math.log2(Math.max(Fe,Be,ce))}function pt(Pt,Ot,Fe){if(v===!1)return Ot;if(Pt!==null){if(m[Pt]!==void 0)return m[Pt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Pt+"'")}let Be=Ot;return Ot===6403&&(Fe===5126&&(Be=33326),Fe===5131&&(Be=33325),Fe===5121&&(Be=33321)),Ot===6407&&(Fe===5126&&(Be=34837),Fe===5131&&(Be=34843),Fe===5121&&(Be=32849)),Ot===6408&&(Fe===5126&&(Be=34836),Fe===5131&&(Be=34842),Fe===5121&&(Be=32856)),Be!==33325&&Be!==33326&&Be!==34842&&Be!==34836||t.get("EXT_color_buffer_float"),Be}function Mt(Pt){return Pt===St||Pt===Ut||Pt===Vt?9728:9729}function At(Pt){const Ot=Pt.target;Ot.removeEventListener("dispose",At),function(Fe){const Be=a.get(Fe);Be.__webglInit!==void 0&&(m.deleteTexture(Be.__webglTexture),a.remove(Fe))}(Ot),Ot.isVideoTexture&&M.delete(Ot),f.memory.textures--}function Et(Pt){const Ot=Pt.target;Ot.removeEventListener("dispose",Et),function(Fe){const Be=Fe.texture,ce=a.get(Fe),on=a.get(Be);if(!!Fe){if(on.__webglTexture!==void 0&&(m.deleteTexture(on.__webglTexture),f.memory.textures--),Fe.depthTexture&&Fe.depthTexture.dispose(),Fe.isWebGLCubeRenderTarget)for(let un=0;un<6;un++)m.deleteFramebuffer(ce.__webglFramebuffer[un]),ce.__webglDepthbuffer&&m.deleteRenderbuffer(ce.__webglDepthbuffer[un]);else m.deleteFramebuffer(ce.__webglFramebuffer),ce.__webglDepthbuffer&&m.deleteRenderbuffer(ce.__webglDepthbuffer),ce.__webglMultisampledFramebuffer&&m.deleteFramebuffer(ce.__webglMultisampledFramebuffer),ce.__webglColorRenderbuffer&&m.deleteRenderbuffer(ce.__webglColorRenderbuffer),ce.__webglDepthRenderbuffer&&m.deleteRenderbuffer(ce.__webglDepthRenderbuffer);if(Fe.isWebGLMultipleRenderTargets)for(let un=0,xe=Be.length;un<xe;un++){const yt=a.get(Be[un]);yt.__webglTexture&&(m.deleteTexture(yt.__webglTexture),f.memory.textures--),a.remove(Be[un])}a.remove(Be),a.remove(Fe)}}(Ot)}let Lt=0;function Ie(Pt,Ot){const Fe=a.get(Pt);if(Pt.isVideoTexture&&function(Be){const ce=f.render.frame;M.get(Be)!==ce&&(M.set(Be,ce),Be.update())}(Pt),Pt.version>0&&Fe.__version!==Pt.version){const Be=Pt.image;if(Be===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(Be.complete!==!1)return void Ze(Fe,Pt,Ot);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.activeTexture(33984+Ot),i.bindTexture(3553,Fe.__webglTexture)}function _e(Pt,Ot){const Fe=a.get(Pt);Pt.version>0&&Fe.__version!==Pt.version?function(Be,ce,on){if(ce.image.length!==6)return;ae(Be,ce),i.activeTexture(33984+on),i.bindTexture(34067,Be.__webglTexture),m.pixelStorei(37440,ce.flipY),m.pixelStorei(37441,ce.premultiplyAlpha),m.pixelStorei(3317,ce.unpackAlignment),m.pixelStorei(37443,0);const un=ce&&(ce.isCompressedTexture||ce.image[0].isCompressedTexture),xe=ce.image[0]&&ce.image[0].isDataTexture,yt=[];for(let Gn=0;Gn<6;Gn++)yt[Gn]=un||xe?xe?ce.image[Gn].image:ce.image[Gn]:D(ce.image[Gn],!1,!0,y);const Yt=yt[0],Se=Z(Yt)||v,Ae=d.convert(ce.format),be=d.convert(ce.type),An=pt(ce.internalFormat,Ae,be);let Yn;if(Ht(34067,ce,Se),un){for(let Gn=0;Gn<6;Gn++){Yn=yt[Gn].mipmaps;for(let Sr=0;Sr<Yn.length;Sr++){const Mr=Yn[Sr];ce.format!==Pn&&ce.format!==wn?Ae!==null?i.compressedTexImage2D(34069+Gn,Sr,An,Mr.width,Mr.height,0,Mr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+Gn,Sr,An,Mr.width,Mr.height,0,Ae,be,Mr.data)}}Be.__maxMipLevel=Yn.length-1}else{Yn=ce.mipmaps;for(let Gn=0;Gn<6;Gn++)if(xe){i.texImage2D(34069+Gn,0,An,yt[Gn].width,yt[Gn].height,0,Ae,be,yt[Gn].data);for(let Sr=0;Sr<Yn.length;Sr++){const Mr=Yn[Sr].image[Gn].image;i.texImage2D(34069+Gn,Sr+1,An,Mr.width,Mr.height,0,Ae,be,Mr.data)}}else{i.texImage2D(34069+Gn,0,An,Ae,be,yt[Gn]);for(let Sr=0;Sr<Yn.length;Sr++){const Mr=Yn[Sr];i.texImage2D(34069+Gn,Sr+1,An,Ae,be,Mr.image[Gn])}}Be.__maxMipLevel=Yn.length}rt(ce,Se)&&gt(34067,ce,Yt.width,Yt.height),Be.__version=ce.version,ce.onUpdate&&ce.onUpdate(ce)}(Fe,Pt,Ot):(i.activeTexture(33984+Ot),i.bindTexture(34067,Fe.__webglTexture))}const ye={[vt]:10497,[wt]:33071,[Ct]:33648},me={[St]:9728,[Ut]:9984,[Vt]:9986,[We]:9729,[sr]:9985,[ui]:9987};function Ht(Pt,Ot,Fe){if(Fe?(m.texParameteri(Pt,10242,ye[Ot.wrapS]),m.texParameteri(Pt,10243,ye[Ot.wrapT]),Pt!==32879&&Pt!==35866||m.texParameteri(Pt,32882,ye[Ot.wrapR]),m.texParameteri(Pt,10240,me[Ot.magFilter]),m.texParameteri(Pt,10241,me[Ot.minFilter])):(m.texParameteri(Pt,10242,33071),m.texParameteri(Pt,10243,33071),Pt!==32879&&Pt!==35866||m.texParameteri(Pt,32882,33071),Ot.wrapS===wt&&Ot.wrapT===wt||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),m.texParameteri(Pt,10240,Mt(Ot.magFilter)),m.texParameteri(Pt,10241,Mt(Ot.minFilter)),Ot.minFilter!==St&&Ot.minFilter!==We&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){const Be=t.get("EXT_texture_filter_anisotropic");if(Ot.type===Jt&&t.has("OES_texture_float_linear")===!1||v===!1&&Ot.type===Nt&&t.has("OES_texture_half_float_linear")===!1)return;(Ot.anisotropy>1||a.get(Ot).__currentAnisotropy)&&(m.texParameterf(Pt,Be.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ot.anisotropy,u.getMaxAnisotropy())),a.get(Ot).__currentAnisotropy=Ot.anisotropy)}}function ae(Pt,Ot){Pt.__webglInit===void 0&&(Pt.__webglInit=!0,Ot.addEventListener("dispose",At),Pt.__webglTexture=m.createTexture(),f.memory.textures++)}function Ze(Pt,Ot,Fe){let Be=3553;Ot.isDataTexture2DArray&&(Be=35866),Ot.isDataTexture3D&&(Be=32879),ae(Pt,Ot),i.activeTexture(33984+Fe),i.bindTexture(Be,Pt.__webglTexture),m.pixelStorei(37440,Ot.flipY),m.pixelStorei(37441,Ot.premultiplyAlpha),m.pixelStorei(3317,Ot.unpackAlignment),m.pixelStorei(37443,0);const ce=function(be){return!v&&(be.wrapS!==wt||be.wrapT!==wt||be.minFilter!==St&&be.minFilter!==We)}(Ot)&&Z(Ot.image)===!1,on=D(Ot.image,ce,!1,E),un=Z(on)||v,xe=d.convert(Ot.format);let yt,Yt=d.convert(Ot.type),Se=pt(Ot.internalFormat,xe,Yt);Ht(Be,Ot,un);const Ae=Ot.mipmaps;if(Ot.isDepthTexture)Se=6402,v?Se=Ot.type===Jt?36012:Ot.type===eu?33190:Ot.type===hn?35056:33189:Ot.type===Jt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Ot.format===vn&&Se===6402&&Ot.type!==Sa&&Ot.type!==eu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Ot.type=Sa,Yt=d.convert(Ot.type)),Ot.format===ir&&Se===6402&&(Se=34041,Ot.type!==hn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Ot.type=hn,Yt=d.convert(Ot.type))),i.texImage2D(3553,0,Se,on.width,on.height,0,xe,Yt,null);else if(Ot.isDataTexture)if(Ae.length>0&&un){for(let be=0,An=Ae.length;be<An;be++)yt=Ae[be],i.texImage2D(3553,be,Se,yt.width,yt.height,0,xe,Yt,yt.data);Ot.generateMipmaps=!1,Pt.__maxMipLevel=Ae.length-1}else i.texImage2D(3553,0,Se,on.width,on.height,0,xe,Yt,on.data),Pt.__maxMipLevel=0;else if(Ot.isCompressedTexture){for(let be=0,An=Ae.length;be<An;be++)yt=Ae[be],Ot.format!==Pn&&Ot.format!==wn?xe!==null?i.compressedTexImage2D(3553,be,Se,yt.width,yt.height,0,yt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,be,Se,yt.width,yt.height,0,xe,Yt,yt.data);Pt.__maxMipLevel=Ae.length-1}else if(Ot.isDataTexture2DArray)i.texImage3D(35866,0,Se,on.width,on.height,on.depth,0,xe,Yt,on.data),Pt.__maxMipLevel=0;else if(Ot.isDataTexture3D)i.texImage3D(32879,0,Se,on.width,on.height,on.depth,0,xe,Yt,on.data),Pt.__maxMipLevel=0;else if(Ae.length>0&&un){for(let be=0,An=Ae.length;be<An;be++)yt=Ae[be],i.texImage2D(3553,be,Se,xe,Yt,yt);Ot.generateMipmaps=!1,Pt.__maxMipLevel=Ae.length-1}else i.texImage2D(3553,0,Se,xe,Yt,on),Pt.__maxMipLevel=0;rt(Ot,un)&&gt(Be,Ot,on.width,on.height),Pt.__version=Ot.version,Ot.onUpdate&&Ot.onUpdate(Ot)}function Xe(Pt,Ot,Fe,Be,ce){const on=d.convert(Fe.format),un=d.convert(Fe.type),xe=pt(Fe.internalFormat,on,un);ce===32879||ce===35866?i.texImage3D(ce,0,xe,Ot.width,Ot.height,Ot.depth,0,on,un,null):i.texImage2D(ce,0,xe,Ot.width,Ot.height,0,on,un,null),i.bindFramebuffer(36160,Pt),m.framebufferTexture2D(36160,Be,ce,a.get(Fe).__webglTexture,0),i.bindFramebuffer(36160,null)}function je(Pt,Ot,Fe){if(m.bindRenderbuffer(36161,Pt),Ot.depthBuffer&&!Ot.stencilBuffer){let Be=33189;if(Fe){const ce=Ot.depthTexture;ce&&ce.isDepthTexture&&(ce.type===Jt?Be=36012:ce.type===eu&&(Be=33190));const on=Sn(Ot);m.renderbufferStorageMultisample(36161,on,Be,Ot.width,Ot.height)}else m.renderbufferStorage(36161,Be,Ot.width,Ot.height);m.framebufferRenderbuffer(36160,36096,36161,Pt)}else if(Ot.depthBuffer&&Ot.stencilBuffer){if(Fe){const Be=Sn(Ot);m.renderbufferStorageMultisample(36161,Be,35056,Ot.width,Ot.height)}else m.renderbufferStorage(36161,34041,Ot.width,Ot.height);m.framebufferRenderbuffer(36160,33306,36161,Pt)}else{const Be=Ot.isWebGLMultipleRenderTargets===!0?Ot.texture[0]:Ot.texture,ce=d.convert(Be.format),on=d.convert(Be.type),un=pt(Be.internalFormat,ce,on);if(Fe){const xe=Sn(Ot);m.renderbufferStorageMultisample(36161,xe,un,Ot.width,Ot.height)}else m.renderbufferStorage(36161,un,Ot.width,Ot.height)}m.bindRenderbuffer(36161,null)}function gn(Pt){const Ot=a.get(Pt),Fe=Pt.isWebGLCubeRenderTarget===!0;if(Pt.depthTexture){if(Fe)throw new Error("target.depthTexture not supported in Cube render targets");(function(Be,ce){if(ce&&ce.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,Be),!ce.depthTexture||!ce.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");a.get(ce.depthTexture).__webglTexture&&ce.depthTexture.image.width===ce.width&&ce.depthTexture.image.height===ce.height||(ce.depthTexture.image.width=ce.width,ce.depthTexture.image.height=ce.height,ce.depthTexture.needsUpdate=!0),Ie(ce.depthTexture,0);const on=a.get(ce.depthTexture).__webglTexture;if(ce.depthTexture.format===vn)m.framebufferTexture2D(36160,36096,3553,on,0);else{if(ce.depthTexture.format!==ir)throw new Error("Unknown depthTexture format");m.framebufferTexture2D(36160,33306,3553,on,0)}})(Ot.__webglFramebuffer,Pt)}else if(Fe){Ot.__webglDepthbuffer=[];for(let Be=0;Be<6;Be++)i.bindFramebuffer(36160,Ot.__webglFramebuffer[Be]),Ot.__webglDepthbuffer[Be]=m.createRenderbuffer(),je(Ot.__webglDepthbuffer[Be],Pt,!1)}else i.bindFramebuffer(36160,Ot.__webglFramebuffer),Ot.__webglDepthbuffer=m.createRenderbuffer(),je(Ot.__webglDepthbuffer,Pt,!1);i.bindFramebuffer(36160,null)}function Sn(Pt){return v&&Pt.isWebGLMultisampleRenderTarget?Math.min(A,Pt.samples):0}let In=!1,Rn=!1;this.allocateTextureUnit=function(){const Pt=Lt;return Pt>=_&&console.warn("THREE.WebGLTextures: Trying to use "+Pt+" texture units while this GPU supports only "+_),Lt+=1,Pt},this.resetTextureUnits=function(){Lt=0},this.setTexture2D=Ie,this.setTexture2DArray=function(Pt,Ot){const Fe=a.get(Pt);Pt.version>0&&Fe.__version!==Pt.version?Ze(Fe,Pt,Ot):(i.activeTexture(33984+Ot),i.bindTexture(35866,Fe.__webglTexture))},this.setTexture3D=function(Pt,Ot){const Fe=a.get(Pt);Pt.version>0&&Fe.__version!==Pt.version?Ze(Fe,Pt,Ot):(i.activeTexture(33984+Ot),i.bindTexture(32879,Fe.__webglTexture))},this.setTextureCube=_e,this.setupRenderTarget=function(Pt){const Ot=Pt.texture,Fe=a.get(Pt),Be=a.get(Ot);Pt.addEventListener("dispose",Et),Pt.isWebGLMultipleRenderTargets!==!0&&(Be.__webglTexture=m.createTexture(),Be.__version=Ot.version,f.memory.textures++);const ce=Pt.isWebGLCubeRenderTarget===!0,on=Pt.isWebGLMultipleRenderTargets===!0,un=Pt.isWebGLMultisampleRenderTarget===!0,xe=Ot.isDataTexture3D||Ot.isDataTexture2DArray,yt=Z(Pt)||v;if(!v||Ot.format!==wn||Ot.type!==Jt&&Ot.type!==Nt||(Ot.format=Pn,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),ce){Fe.__webglFramebuffer=[];for(let Yt=0;Yt<6;Yt++)Fe.__webglFramebuffer[Yt]=m.createFramebuffer()}else if(Fe.__webglFramebuffer=m.createFramebuffer(),on)if(u.drawBuffers){const Yt=Pt.texture;for(let Se=0,Ae=Yt.length;Se<Ae;Se++){const be=a.get(Yt[Se]);be.__webglTexture===void 0&&(be.__webglTexture=m.createTexture(),f.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(un)if(v){Fe.__webglMultisampledFramebuffer=m.createFramebuffer(),Fe.__webglColorRenderbuffer=m.createRenderbuffer(),m.bindRenderbuffer(36161,Fe.__webglColorRenderbuffer);const Yt=d.convert(Ot.format),Se=d.convert(Ot.type),Ae=pt(Ot.internalFormat,Yt,Se),be=Sn(Pt);m.renderbufferStorageMultisample(36161,be,Ae,Pt.width,Pt.height),i.bindFramebuffer(36160,Fe.__webglMultisampledFramebuffer),m.framebufferRenderbuffer(36160,36064,36161,Fe.__webglColorRenderbuffer),m.bindRenderbuffer(36161,null),Pt.depthBuffer&&(Fe.__webglDepthRenderbuffer=m.createRenderbuffer(),je(Fe.__webglDepthRenderbuffer,Pt,!0)),i.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(ce){i.bindTexture(34067,Be.__webglTexture),Ht(34067,Ot,yt);for(let Yt=0;Yt<6;Yt++)Xe(Fe.__webglFramebuffer[Yt],Pt,Ot,36064,34069+Yt);rt(Ot,yt)&&gt(34067,Ot,Pt.width,Pt.height),i.bindTexture(34067,null)}else if(on){const Yt=Pt.texture;for(let Se=0,Ae=Yt.length;Se<Ae;Se++){const be=Yt[Se],An=a.get(be);i.bindTexture(3553,An.__webglTexture),Ht(3553,be,yt),Xe(Fe.__webglFramebuffer,Pt,be,36064+Se,3553),rt(be,yt)&&gt(3553,be,Pt.width,Pt.height)}i.bindTexture(3553,null)}else{let Yt=3553;xe&&(v?Yt=Ot.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),i.bindTexture(Yt,Be.__webglTexture),Ht(Yt,Ot,yt),Xe(Fe.__webglFramebuffer,Pt,Ot,36064,Yt),rt(Ot,yt)&&gt(Yt,Ot,Pt.width,Pt.height,Pt.depth),i.bindTexture(Yt,null)}Pt.depthBuffer&&gn(Pt)},this.updateRenderTargetMipmap=function(Pt){const Ot=Z(Pt)||v,Fe=Pt.isWebGLMultipleRenderTargets===!0?Pt.texture:[Pt.texture];for(let Be=0,ce=Fe.length;Be<ce;Be++){const on=Fe[Be];if(rt(on,Ot)){const un=Pt.isWebGLCubeRenderTarget?34067:3553,xe=a.get(on).__webglTexture;i.bindTexture(un,xe),gt(un,on,Pt.width,Pt.height),i.bindTexture(un,null)}}},this.updateMultisampleRenderTarget=function(Pt){if(Pt.isWebGLMultisampleRenderTarget)if(v){const Ot=Pt.width,Fe=Pt.height;let Be=16384;Pt.depthBuffer&&(Be|=256),Pt.stencilBuffer&&(Be|=1024);const ce=a.get(Pt);i.bindFramebuffer(36008,ce.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,ce.__webglFramebuffer),m.blitFramebuffer(0,0,Ot,Fe,0,0,Ot,Fe,Be,9728),i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,ce.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Pt,Ot){Pt&&Pt.isWebGLRenderTarget&&(In===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),In=!0),Pt=Pt.texture),Ie(Pt,Ot)},this.safeSetTextureCube=function(Pt,Ot){Pt&&Pt.isWebGLCubeRenderTarget&&(Rn===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Rn=!0),Pt=Pt.texture),_e(Pt,Ot)}}function Fc(m,t,i){const a=i.isWebGL2;return{convert:function(u){let d;if(u===ho)return 5121;if(u===ge)return 32819;if(u===Ge)return 32820;if(u===Qe)return 33635;if(u===Uo)return 5120;if(u===wa)return 5122;if(u===Sa)return 5123;if(u===ml)return 5124;if(u===eu)return 5125;if(u===Jt)return 5126;if(u===Nt)return a?5131:(d=t.get("OES_texture_half_float"),d!==null?d.HALF_FLOAT_OES:null);if(u===jn)return 6406;if(u===wn)return 6407;if(u===Pn)return 6408;if(u===xr)return 6409;if(u===gr)return 6410;if(u===vn)return 6402;if(u===ir)return 34041;if(u===yi)return 6403;if(u===ar)return 36244;if(u===Br)return 33319;if(u===zr)return 33320;if(u===jr)return 36248;if(u===Ur)return 36249;if(u===nu||u===ea||u===wu||u===$r){if(d=t.get("WEBGL_compressed_texture_s3tc"),d===null)return null;if(u===nu)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(u===ea)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(u===wu)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(u===$r)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(u===Eo||u===rc||u===ic||u===gl){if(d=t.get("WEBGL_compressed_texture_pvrtc"),d===null)return null;if(u===Eo)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(u===rc)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(u===ic)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(u===gl)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(u===oc)return d=t.get("WEBGL_compressed_texture_etc1"),d!==null?d.COMPRESSED_RGB_ETC1_WEBGL:null;if((u===Su||u===yo)&&(d=t.get("WEBGL_compressed_texture_etc"),d!==null)){if(u===Su)return d.COMPRESSED_RGB8_ETC2;if(u===yo)return d.COMPRESSED_RGBA8_ETC2_EAC}return u===pf||u===ko||u===vl||u===fi||u===ns||u===_l||u===sh||u===Ln||u===na||u===ah||u===yl||u===xl||u===xi||u===Ta||u===rs||u===ru||u===Ea||u===Ma||u===bl||u===uh||u===wl||u===Kr||u===Sl||u===Tu||u===Mo||u===Tl||u===ni||u===lh?(d=t.get("WEBGL_compressed_texture_astc"),d!==null?u:null):u===li?(d=t.get("EXT_texture_compression_bptc"),d!==null?u:null):u===hn?a?34042:(d=t.get("WEBGL_depth_texture"),d!==null?d.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class Dr extends to{constructor(t=[]){super(),this.cameras=t}}Dr.prototype.isArrayCamera=!0;class Zs extends vr{constructor(){super(),this.type="Group"}}Zs.prototype.isGroup=!0;const Zd={type:"move"};class Zu{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Zs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Zs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new mt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new mt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Zs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new mt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new mt),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,i,a){let u=null,d=null,f=null;const v=this._targetRay,_=this._grip,y=this._hand;if(t&&i.session.visibilityState!=="visible-blurred")if(v!==null&&(u=i.getPose(t.targetRaySpace,a),u!==null&&(v.matrix.fromArray(u.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),u.linearVelocity?(v.hasLinearVelocity=!0,v.linearVelocity.copy(u.linearVelocity)):v.hasLinearVelocity=!1,u.angularVelocity?(v.hasAngularVelocity=!0,v.angularVelocity.copy(u.angularVelocity)):v.hasAngularVelocity=!1,this.dispatchEvent(Zd))),y&&t.hand){f=!0;for(const U of t.hand.values()){const D=i.getJointPose(U,a);if(y.joints[U.jointName]===void 0){const rt=new Zs;rt.matrixAutoUpdate=!1,rt.visible=!1,y.joints[U.jointName]=rt,y.add(rt)}const Z=y.joints[U.jointName];D!==null&&(Z.matrix.fromArray(D.transform.matrix),Z.matrix.decompose(Z.position,Z.rotation,Z.scale),Z.jointRadius=D.radius),Z.visible=D!==null}const E=y.joints["index-finger-tip"],A=y.joints["thumb-tip"],M=E.position.distanceTo(A.position),P=.02,O=.005;y.inputState.pinching&&M>P+O?(y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!y.inputState.pinching&&M<=P-O&&(y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else _!==null&&t.gripSpace&&(d=i.getPose(t.gripSpace,a),d!==null&&(_.matrix.fromArray(d.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),d.linearVelocity?(_.hasLinearVelocity=!0,_.linearVelocity.copy(d.linearVelocity)):_.hasLinearVelocity=!1,d.angularVelocity?(_.hasAngularVelocity=!0,_.angularVelocity.copy(d.angularVelocity)):_.hasAngularVelocity=!1));return v!==null&&(v.visible=u!==null),_!==null&&(_.visible=d!==null),y!==null&&(y.visible=f!==null),this}}class Rf extends Ho{constructor(t,i){super();const a=this,u=t.state;let d=null,f=1,v=null,_="local-floor",y=null,E=null,A=null,M=null;const P=[],O=new Map,U=new to;U.layers.enable(1),U.viewport=new Ir;const D=new to;D.layers.enable(2),D.viewport=new Ir;const Z=[U,D],rt=new Dr;rt.layers.enable(1),rt.layers.enable(2);let gt=null,pt=null;function Mt(Ht){const ae=O.get(Ht.inputSource);ae&&ae.dispatchEvent({type:Ht.type,data:Ht.inputSource})}function At(){O.forEach(function(Ht,ae){Ht.disconnect(ae)}),O.clear(),gt=null,pt=null,u.bindXRFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),me.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function Et(Ht){const ae=d.inputSources;for(let Ze=0;Ze<P.length;Ze++)O.set(ae[Ze],P[Ze]);for(let Ze=0;Ze<Ht.removed.length;Ze++){const Xe=Ht.removed[Ze],je=O.get(Xe);je&&(je.dispatchEvent({type:"disconnected",data:Xe}),O.delete(Xe))}for(let Ze=0;Ze<Ht.added.length;Ze++){const Xe=Ht.added[Ze],je=O.get(Xe);je&&je.dispatchEvent({type:"connected",data:Xe})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ht){let ae=P[Ht];return ae===void 0&&(ae=new Zu,P[Ht]=ae),ae.getTargetRaySpace()},this.getControllerGrip=function(Ht){let ae=P[Ht];return ae===void 0&&(ae=new Zu,P[Ht]=ae),ae.getGripSpace()},this.getHand=function(Ht){let ae=P[Ht];return ae===void 0&&(ae=new Zu,P[Ht]=ae),ae.getHandSpace()},this.setFramebufferScaleFactor=function(Ht){f=Ht,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ht){_=Ht,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return v},this.getSession=function(){return d},this.setSession=async function(Ht){if(d=Ht,d!==null){d.addEventListener("select",Mt),d.addEventListener("selectstart",Mt),d.addEventListener("selectend",Mt),d.addEventListener("squeeze",Mt),d.addEventListener("squeezestart",Mt),d.addEventListener("squeezeend",Mt),d.addEventListener("end",At),d.addEventListener("inputsourceschange",Et);const ae=i.getContextAttributes();if(ae.xrCompatible!==!0&&await i.makeXRCompatible(),d.renderState.layers===void 0){const Ze={antialias:ae.antialias,alpha:ae.alpha,depth:ae.depth,stencil:ae.stencil,framebufferScaleFactor:f},Xe=new XRWebGLLayer(d,i,Ze);d.updateRenderState({baseLayer:Xe})}else{let Ze=0;ae.depth&&(Ze=ae.stencil?34041:6402);const Xe={colorFormat:ae.alpha?6408:6407,depthFormat:Ze,scaleFactor:f};E=new XRWebGLBinding(d,i),M=E.createProjectionLayer(Xe),A=i.createFramebuffer(),d.updateRenderState({layers:[M]})}v=await d.requestReferenceSpace(_),me.setContext(d),me.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}};const Lt=new mt,Ie=new mt;function _e(Ht,ae){ae===null?Ht.matrixWorld.copy(Ht.matrix):Ht.matrixWorld.multiplyMatrices(ae.matrixWorld,Ht.matrix),Ht.matrixWorldInverse.copy(Ht.matrixWorld).invert()}this.updateCamera=function(Ht){if(d===null)return;rt.near=D.near=U.near=Ht.near,rt.far=D.far=U.far=Ht.far,gt===rt.near&&pt===rt.far||(d.updateRenderState({depthNear:rt.near,depthFar:rt.far}),gt=rt.near,pt=rt.far);const ae=Ht.parent,Ze=rt.cameras;_e(rt,ae);for(let je=0;je<Ze.length;je++)_e(Ze[je],ae);rt.matrixWorld.decompose(rt.position,rt.quaternion,rt.scale),Ht.position.copy(rt.position),Ht.quaternion.copy(rt.quaternion),Ht.scale.copy(rt.scale),Ht.matrix.copy(rt.matrix),Ht.matrixWorld.copy(rt.matrixWorld);const Xe=Ht.children;for(let je=0,gn=Xe.length;je<gn;je++)Xe[je].updateMatrixWorld(!0);Ze.length===2?function(je,gn,Sn){Lt.setFromMatrixPosition(gn.matrixWorld),Ie.setFromMatrixPosition(Sn.matrixWorld);const In=Lt.distanceTo(Ie),Rn=gn.projectionMatrix.elements,Pt=Sn.projectionMatrix.elements,Ot=Rn[14]/(Rn[10]-1),Fe=Rn[14]/(Rn[10]+1),Be=(Rn[9]+1)/Rn[5],ce=(Rn[9]-1)/Rn[5],on=(Rn[8]-1)/Rn[0],un=(Pt[8]+1)/Pt[0],xe=Ot*on,yt=Ot*un,Yt=In/(-on+un),Se=Yt*-on;gn.matrixWorld.decompose(je.position,je.quaternion,je.scale),je.translateX(Se),je.translateZ(Yt),je.matrixWorld.compose(je.position,je.quaternion,je.scale),je.matrixWorldInverse.copy(je.matrixWorld).invert();const Ae=Ot+Yt,be=Fe+Yt,An=xe-Se,Yn=yt+(In-Se),Gn=Be*Fe/be*Ae,Sr=ce*Fe/be*Ae;je.projectionMatrix.makePerspective(An,Yn,Gn,Sr,Ae,be)}(rt,U,D):rt.projectionMatrix.copy(U.projectionMatrix)},this.getCamera=function(){return rt};let ye=null;const me=new Eh;me.setAnimationLoop(function(Ht,ae){if(y=ae.getViewerPose(v),y!==null){const Xe=y.views,je=d.renderState.baseLayer;d.renderState.layers===void 0&&u.bindXRFramebuffer(je.framebuffer);let gn=!1;Xe.length!==rt.cameras.length&&(rt.cameras.length=0,gn=!0);for(let Sn=0;Sn<Xe.length;Sn++){const In=Xe[Sn];let Rn=null;if(d.renderState.layers===void 0)Rn=je.getViewport(In);else{const Ot=E.getViewSubImage(M,In);u.bindXRFramebuffer(A),i.framebufferTexture2D(36160,36064,3553,Ot.colorTexture,0),Ot.depthStencilTexture!==void 0&&i.framebufferTexture2D(36160,36096,3553,Ot.depthStencilTexture,0),Rn=Ot.viewport}const Pt=Z[Sn];Pt.matrix.fromArray(In.transform.matrix),Pt.projectionMatrix.fromArray(In.projectionMatrix),Pt.viewport.set(Rn.x,Rn.y,Rn.width,Rn.height),Sn===0&&rt.matrix.copy(Pt.matrix),gn===!0&&rt.cameras.push(Pt)}}const Ze=d.inputSources;for(let Xe=0;Xe<P.length;Xe++){const je=P[Xe],gn=Ze[Xe];je.update(gn,ae,v)}ye&&ye(Ht,ae)}),this.setAnimationLoop=function(Ht){ye=Ht},this.dispose=function(){}}}function If(m){function t(a,u){a.opacity.value=u.opacity,u.color&&a.diffuse.value.copy(u.color),u.emissive&&a.emissive.value.copy(u.emissive).multiplyScalar(u.emissiveIntensity),u.map&&(a.map.value=u.map),u.alphaMap&&(a.alphaMap.value=u.alphaMap),u.specularMap&&(a.specularMap.value=u.specularMap);const d=m.get(u).envMap;if(d){a.envMap.value=d,a.flipEnvMap.value=d.isCubeTexture&&d._needsFlipEnvMap?-1:1,a.reflectivity.value=u.reflectivity,a.refractionRatio.value=u.refractionRatio;const _=m.get(d).__maxMipLevel;_!==void 0&&(a.maxMipLevel.value=_)}let f,v;u.lightMap&&(a.lightMap.value=u.lightMap,a.lightMapIntensity.value=u.lightMapIntensity),u.aoMap&&(a.aoMap.value=u.aoMap,a.aoMapIntensity.value=u.aoMapIntensity),u.map?f=u.map:u.specularMap?f=u.specularMap:u.displacementMap?f=u.displacementMap:u.normalMap?f=u.normalMap:u.bumpMap?f=u.bumpMap:u.roughnessMap?f=u.roughnessMap:u.metalnessMap?f=u.metalnessMap:u.alphaMap?f=u.alphaMap:u.emissiveMap?f=u.emissiveMap:u.clearcoatMap?f=u.clearcoatMap:u.clearcoatNormalMap?f=u.clearcoatNormalMap:u.clearcoatRoughnessMap&&(f=u.clearcoatRoughnessMap),f!==void 0&&(f.isWebGLRenderTarget&&(f=f.texture),f.matrixAutoUpdate===!0&&f.updateMatrix(),a.uvTransform.value.copy(f.matrix)),u.aoMap?v=u.aoMap:u.lightMap&&(v=u.lightMap),v!==void 0&&(v.isWebGLRenderTarget&&(v=v.texture),v.matrixAutoUpdate===!0&&v.updateMatrix(),a.uv2Transform.value.copy(v.matrix))}function i(a,u){a.roughness.value=u.roughness,a.metalness.value=u.metalness,u.roughnessMap&&(a.roughnessMap.value=u.roughnessMap),u.metalnessMap&&(a.metalnessMap.value=u.metalnessMap),u.emissiveMap&&(a.emissiveMap.value=u.emissiveMap),u.bumpMap&&(a.bumpMap.value=u.bumpMap,a.bumpScale.value=u.bumpScale,u.side===I&&(a.bumpScale.value*=-1)),u.normalMap&&(a.normalMap.value=u.normalMap,a.normalScale.value.copy(u.normalScale),u.side===I&&a.normalScale.value.negate()),u.displacementMap&&(a.displacementMap.value=u.displacementMap,a.displacementScale.value=u.displacementScale,a.displacementBias.value=u.displacementBias),m.get(u).envMap&&(a.envMapIntensity.value=u.envMapIntensity)}return{refreshFogUniforms:function(a,u){a.fogColor.value.copy(u.color),u.isFog?(a.fogNear.value=u.near,a.fogFar.value=u.far):u.isFogExp2&&(a.fogDensity.value=u.density)},refreshMaterialUniforms:function(a,u,d,f,v){u.isMeshBasicMaterial?t(a,u):u.isMeshLambertMaterial?(t(a,u),function(_,y){y.emissiveMap&&(_.emissiveMap.value=y.emissiveMap)}(a,u)):u.isMeshToonMaterial?(t(a,u),function(_,y){y.gradientMap&&(_.gradientMap.value=y.gradientMap),y.emissiveMap&&(_.emissiveMap.value=y.emissiveMap),y.bumpMap&&(_.bumpMap.value=y.bumpMap,_.bumpScale.value=y.bumpScale,y.side===I&&(_.bumpScale.value*=-1)),y.normalMap&&(_.normalMap.value=y.normalMap,_.normalScale.value.copy(y.normalScale),y.side===I&&_.normalScale.value.negate()),y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias)}(a,u)):u.isMeshPhongMaterial?(t(a,u),function(_,y){_.specular.value.copy(y.specular),_.shininess.value=Math.max(y.shininess,1e-4),y.emissiveMap&&(_.emissiveMap.value=y.emissiveMap),y.bumpMap&&(_.bumpMap.value=y.bumpMap,_.bumpScale.value=y.bumpScale,y.side===I&&(_.bumpScale.value*=-1)),y.normalMap&&(_.normalMap.value=y.normalMap,_.normalScale.value.copy(y.normalScale),y.side===I&&_.normalScale.value.negate()),y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias)}(a,u)):u.isMeshStandardMaterial?(t(a,u),u.isMeshPhysicalMaterial?function(_,y,E){i(_,y),_.reflectivity.value=y.reflectivity,_.clearcoat.value=y.clearcoat,_.clearcoatRoughness.value=y.clearcoatRoughness,y.sheen&&_.sheen.value.copy(y.sheen),y.clearcoatMap&&(_.clearcoatMap.value=y.clearcoatMap),y.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap),y.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),_.clearcoatNormalMap.value=y.clearcoatNormalMap,y.side===I&&_.clearcoatNormalScale.value.negate()),_.transmission.value=y.transmission,y.transmissionMap&&(_.transmissionMap.value=y.transmissionMap),y.transmission>0&&(_.transmissionSamplerMap.value=E.texture,_.transmissionSamplerSize.value.set(E.width,E.height)),_.thickness.value=y.thickness,y.thicknessMap&&(_.thicknessMap.value=y.thicknessMap),_.attenuationDistance.value=y.attenuationDistance,_.attenuationColor.value.copy(y.attenuationColor)}(a,u,v):i(a,u)):u.isMeshMatcapMaterial?(t(a,u),function(_,y){y.matcap&&(_.matcap.value=y.matcap),y.bumpMap&&(_.bumpMap.value=y.bumpMap,_.bumpScale.value=y.bumpScale,y.side===I&&(_.bumpScale.value*=-1)),y.normalMap&&(_.normalMap.value=y.normalMap,_.normalScale.value.copy(y.normalScale),y.side===I&&_.normalScale.value.negate()),y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias)}(a,u)):u.isMeshDepthMaterial?(t(a,u),function(_,y){y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias)}(a,u)):u.isMeshDistanceMaterial?(t(a,u),function(_,y){y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias),_.referencePosition.value.copy(y.referencePosition),_.nearDistance.value=y.nearDistance,_.farDistance.value=y.farDistance}(a,u)):u.isMeshNormalMaterial?(t(a,u),function(_,y){y.bumpMap&&(_.bumpMap.value=y.bumpMap,_.bumpScale.value=y.bumpScale,y.side===I&&(_.bumpScale.value*=-1)),y.normalMap&&(_.normalMap.value=y.normalMap,_.normalScale.value.copy(y.normalScale),y.side===I&&_.normalScale.value.negate()),y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias)}(a,u)):u.isLineBasicMaterial?(function(_,y){_.diffuse.value.copy(y.color),_.opacity.value=y.opacity}(a,u),u.isLineDashedMaterial&&function(_,y){_.dashSize.value=y.dashSize,_.totalSize.value=y.dashSize+y.gapSize,_.scale.value=y.scale}(a,u)):u.isPointsMaterial?function(_,y,E,A){_.diffuse.value.copy(y.color),_.opacity.value=y.opacity,_.size.value=y.size*E,_.scale.value=.5*A,y.map&&(_.map.value=y.map),y.alphaMap&&(_.alphaMap.value=y.alphaMap);let M;y.map?M=y.map:y.alphaMap&&(M=y.alphaMap),M!==void 0&&(M.matrixAutoUpdate===!0&&M.updateMatrix(),_.uvTransform.value.copy(M.matrix))}(a,u,d,f):u.isSpriteMaterial?function(_,y){_.diffuse.value.copy(y.color),_.opacity.value=y.opacity,_.rotation.value=y.rotation,y.map&&(_.map.value=y.map),y.alphaMap&&(_.alphaMap.value=y.alphaMap);let E;y.map?E=y.map:y.alphaMap&&(E=y.alphaMap),E!==void 0&&(E.matrixAutoUpdate===!0&&E.updateMatrix(),_.uvTransform.value.copy(E.matrix))}(a,u):u.isShadowMaterial?(a.color.value.copy(u.color),a.opacity.value=u.opacity):u.isShaderMaterial&&(u.uniformsNeedUpdate=!1)}}}function Jr(m={}){const t=m.canvas!==void 0?m.canvas:function(){const Rt=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return Rt.style.display="block",Rt}(),i=m.context!==void 0?m.context:null,a=m.alpha!==void 0&&m.alpha,u=m.depth===void 0||m.depth,d=m.stencil===void 0||m.stencil,f=m.antialias!==void 0&&m.antialias,v=m.premultipliedAlpha===void 0||m.premultipliedAlpha,_=m.preserveDrawingBuffer!==void 0&&m.preserveDrawingBuffer,y=m.powerPreference!==void 0?m.powerPreference:"default",E=m.failIfMajorPerformanceCaveat!==void 0&&m.failIfMajorPerformanceCaveat;let A=null,M=null;const P=[],O=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=ro,this.physicallyCorrectLights=!1,this.toneMapping=Er,this.toneMappingExposure=1;const U=this;let D=!1,Z=0,rt=0,gt=null,pt=-1,Mt=null;const At=new Ir,Et=new Ir;let Lt=null,Ie=t.width,_e=t.height,ye=1,me=null,Ht=null;const ae=new Ir(0,0,Ie,_e),Ze=new Ir(0,0,Ie,_e);let Xe=!1;const je=[],gn=new Fa;let Sn=!1,In=!1,Rn=null;const Pt=new Tn,Ot=new mt,Fe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Be(){return gt===null?ye:1}let ce,on,un,xe,yt,Yt,Se,Ae,be,An,Yn,Gn,Sr,Mr,No,Pi,fl,Jp,$p,Kp,ta,xa,Je=i;function jm(Rt,Te){for(let re=0;re<Rt.length;re++){const Ee=Rt[re],nn=t.getContext(Ee,Te);if(nn!==null)return nn}return null}try{const Rt={alpha:a,depth:u,stencil:d,antialias:f,premultipliedAlpha:v,preserveDrawingBuffer:_,powerPreference:y,failIfMajorPerformanceCaveat:E};if(t.addEventListener("webglcontextlost",Wm,!1),t.addEventListener("webglcontextrestored",Xm,!1),Je===null){const Te=["webgl2","webgl","experimental-webgl"];if(U.isWebGL1Renderer===!0&&Te.shift(),Je=jm(Te,Rt),Je===null)throw jm(Te)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Je.getShaderPrecisionFormat===void 0&&(Je.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Rt){throw console.error("THREE.WebGLRenderer: "+Rt.message),Rt}function Vm(){ce=new Id(Je),on=new vo(Je,ce,m),ce.init(on),ta=new Fc(Je,ce,on),un=new Yd(Je,ce,on),je[0]=1029,xe=new zu(Je),yt=new Ei,Yt=new ps(Je,ce,un,yt,on,ta,xe),Se=new Mh(U),Ae=new mu(Je,on),xa=new yf(Je,ce,Ae,on),be=new Hu(Je,Ae,xe,xa),An=new gu(Je,be,Ae,xe),Jp=new xf(Je),No=new Tc(yt),Yn=new Ti(U,Se,ce,on,xa,No),Gn=new If(yt),Sr=new Nc(yt),Mr=new Cf(ce,on),fl=new Rd(U,Se,un,An,v),Pi=new dr(U,An,on),$p=new qo(Je,ce,xe,on),Kp=new Ld(Je,ce,xe,on),xe.programs=Yn.programs,U.capabilities=on,U.extensions=ce,U.properties=yt,U.renderLists=Sr,U.shadowMap=Pi,U.state=un,U.info=xe}Vm();const Qa=new Rf(U,Je);function Wm(Rt){Rt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function Xm(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1;const Rt=xe.autoReset,Te=Pi.enabled,re=Pi.autoUpdate,Ee=Pi.needsUpdate,nn=Pi.type;Vm(),xe.autoReset=Rt,Pi.enabled=Te,Pi.autoUpdate=re,Pi.needsUpdate=Ee,Pi.type=nn}function qm(Rt){const Te=Rt.target;Te.removeEventListener("dispose",qm),function(re){(function(Ee){const nn=yt.get(Ee).programs;nn!==void 0&&nn.forEach(function(Xr){Yn.releaseProgram(Xr)})})(re),yt.remove(re)}(Te)}this.xr=Qa,this.getContext=function(){return Je},this.getContextAttributes=function(){return Je.getContextAttributes()},this.forceContextLoss=function(){const Rt=ce.get("WEBGL_lose_context");Rt&&Rt.loseContext()},this.forceContextRestore=function(){const Rt=ce.get("WEBGL_lose_context");Rt&&Rt.restoreContext()},this.getPixelRatio=function(){return ye},this.setPixelRatio=function(Rt){Rt!==void 0&&(ye=Rt,this.setSize(Ie,_e,!1))},this.getSize=function(Rt){return Rt.set(Ie,_e)},this.setSize=function(Rt,Te,re){Qa.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Ie=Rt,_e=Te,t.width=Math.floor(Rt*ye),t.height=Math.floor(Te*ye),re!==!1&&(t.style.width=Rt+"px",t.style.height=Te+"px"),this.setViewport(0,0,Rt,Te))},this.getDrawingBufferSize=function(Rt){return Rt.set(Ie*ye,_e*ye).floor()},this.setDrawingBufferSize=function(Rt,Te,re){Ie=Rt,_e=Te,ye=re,t.width=Math.floor(Rt*re),t.height=Math.floor(Te*re),this.setViewport(0,0,Rt,Te)},this.getCurrentViewport=function(Rt){return Rt.copy(At)},this.getViewport=function(Rt){return Rt.copy(ae)},this.setViewport=function(Rt,Te,re,Ee){Rt.isVector4?ae.set(Rt.x,Rt.y,Rt.z,Rt.w):ae.set(Rt,Te,re,Ee),un.viewport(At.copy(ae).multiplyScalar(ye).floor())},this.getScissor=function(Rt){return Rt.copy(Ze)},this.setScissor=function(Rt,Te,re,Ee){Rt.isVector4?Ze.set(Rt.x,Rt.y,Rt.z,Rt.w):Ze.set(Rt,Te,re,Ee),un.scissor(Et.copy(Ze).multiplyScalar(ye).floor())},this.getScissorTest=function(){return Xe},this.setScissorTest=function(Rt){un.setScissorTest(Xe=Rt)},this.setOpaqueSort=function(Rt){me=Rt},this.setTransparentSort=function(Rt){Ht=Rt},this.getClearColor=function(Rt){return Rt.copy(fl.getClearColor())},this.setClearColor=function(){fl.setClearColor.apply(fl,arguments)},this.getClearAlpha=function(){return fl.getClearAlpha()},this.setClearAlpha=function(){fl.setClearAlpha.apply(fl,arguments)},this.clear=function(Rt,Te,re){let Ee=0;(Rt===void 0||Rt)&&(Ee|=16384),(Te===void 0||Te)&&(Ee|=256),(re===void 0||re)&&(Ee|=1024),Je.clear(Ee)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Wm,!1),t.removeEventListener("webglcontextrestored",Xm,!1),Sr.dispose(),Mr.dispose(),yt.dispose(),Se.dispose(),An.dispose(),xa.dispose(),Qa.dispose(),Qa.removeEventListener("sessionstart",Ym),Qa.removeEventListener("sessionend",Zm),Rn&&(Rn.dispose(),Rn=null),ff.stop()},this.renderBufferImmediate=function(Rt,Te){xa.initAttributes();const re=yt.get(Rt);Rt.hasPositions&&!re.position&&(re.position=Je.createBuffer()),Rt.hasNormals&&!re.normal&&(re.normal=Je.createBuffer()),Rt.hasUvs&&!re.uv&&(re.uv=Je.createBuffer()),Rt.hasColors&&!re.color&&(re.color=Je.createBuffer());const Ee=Te.getAttributes();Rt.hasPositions&&(Je.bindBuffer(34962,re.position),Je.bufferData(34962,Rt.positionArray,35048),xa.enableAttribute(Ee.position),Je.vertexAttribPointer(Ee.position,3,5126,!1,0,0)),Rt.hasNormals&&(Je.bindBuffer(34962,re.normal),Je.bufferData(34962,Rt.normalArray,35048),xa.enableAttribute(Ee.normal),Je.vertexAttribPointer(Ee.normal,3,5126,!1,0,0)),Rt.hasUvs&&(Je.bindBuffer(34962,re.uv),Je.bufferData(34962,Rt.uvArray,35048),xa.enableAttribute(Ee.uv),Je.vertexAttribPointer(Ee.uv,2,5126,!1,0,0)),Rt.hasColors&&(Je.bindBuffer(34962,re.color),Je.bufferData(34962,Rt.colorArray,35048),xa.enableAttribute(Ee.color),Je.vertexAttribPointer(Ee.color,3,5126,!1,0,0)),xa.disableUnusedAttributes(),Je.drawArrays(4,0,Rt.count),Rt.count=0},this.renderBufferDirect=function(Rt,Te,re,Ee,nn,Xr){Te===null&&(Te=Fe);const mr=nn.isMesh&&nn.matrixWorld.determinant()<0,dn=Km(Rt,Te,Ee,nn);un.setMaterial(Ee,mr);let Pr=re.index;const Kn=re.attributes.position;if(Pr===null){if(Kn===void 0||Kn.count===0)return}else if(Pr.count===0)return;let Gr,ur=1;Ee.wireframe===!0&&(Pr=be.getWireframeAttribute(re),ur=2),(Ee.morphTargets||Ee.morphNormals)&&Jp.update(nn,re,Ee,dn),xa.setup(nn,Ee,dn,re,Pr);let Nr=$p;Pr!==null&&(Gr=Ae.get(Pr),Nr=Kp,Nr.setIndex(Gr));const To=Pr!==null?Pr.count:Kn.count,Ui=re.drawRange.start*ur,pl=re.drawRange.count*ur,Ci=Xr!==null?Xr.start*ur:0,oh=Xr!==null?Xr.count*ur:1/0,Fo=Math.max(Ui,Ci),tu=Math.min(To,Ui+pl,Ci+oh)-1,Us=Math.max(0,tu-Fo+1);if(Us!==0){if(nn.isMesh)Ee.wireframe===!0?(un.setLineWidth(Ee.wireframeLinewidth*Be()),Nr.setMode(1)):Nr.setMode(4);else if(nn.isLine){let Qp=Ee.linewidth;Qp===void 0&&(Qp=1),un.setLineWidth(Qp*Be()),nn.isLineSegments?Nr.setMode(1):nn.isLineLoop?Nr.setMode(2):Nr.setMode(3)}else nn.isPoints?Nr.setMode(0):nn.isSprite&&Nr.setMode(4);if(nn.isInstancedMesh)Nr.renderInstances(Fo,Us,nn.count);else if(re.isInstancedBufferGeometry){const Qp=Math.min(re.instanceCount,re._maxInstanceCount);Nr.renderInstances(Fo,Us,Qp)}else Nr.render(Fo,Us)}},this.compile=function(Rt,Te){M=Mr.get(Rt),M.init(),Rt.traverseVisible(function(re){re.isLight&&re.layers.test(Te.layers)&&(M.pushLight(re),re.castShadow&&M.pushShadow(re))}),M.setupLights(),Rt.traverse(function(re){const Ee=re.material;if(Ee)if(Array.isArray(Ee))for(let nn=0;nn<Ee.length;nn++)Hm(Ee[nn],Rt,re);else Hm(Ee,Rt,re)})};let Gm=null;function Ym(){ff.stop()}function Zm(){ff.start()}const ff=new Eh;function Mm(Rt,Te,re){const Ee=Te.isScene===!0?Te.overrideMaterial:null;for(let nn=0,Xr=Rt.length;nn<Xr;nn++){const mr=Rt[nn],dn=mr.object,Pr=mr.geometry,Kn=Ee===null?mr.material:Ee,Gr=mr.group;if(re.isArrayCamera){const ur=re.cameras;for(let Nr=0,To=ur.length;Nr<To;Nr++){const Ui=ur[Nr];dn.layers.test(Ui.layers)&&(un.viewport(At.copy(Ui.viewport)),M.setupLightsView(Ui),Jm(dn,Te,Ui,Pr,Kn,Gr))}}else Jm(dn,Te,re,Pr,Kn,Gr)}}function Jm(Rt,Te,re,Ee,nn,Xr){if(Rt.onBeforeRender(U,Te,re,Ee,nn,Xr),Rt.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,Rt.matrixWorld),Rt.normalMatrix.getNormalMatrix(Rt.modelViewMatrix),Rt.isImmediateRenderObject){const mr=Km(re,Te,nn,Rt);un.setMaterial(nn),xa.reset(),function(dn,Pr){dn.render(function(Kn){U.renderBufferImmediate(Kn,Pr)})}(Rt,mr)}else nn.transparent===!0&&nn.side===B?(nn.side=I,nn.needsUpdate=!0,U.renderBufferDirect(re,Te,Ee,nn,Rt,Xr),nn.side=kt,nn.needsUpdate=!0,U.renderBufferDirect(re,Te,Ee,nn,Rt,Xr),nn.side=B):U.renderBufferDirect(re,Te,Ee,nn,Rt,Xr);Rt.onAfterRender(U,Te,re,Ee,nn,Xr)}function Hm(Rt,Te,re){Te.isScene!==!0&&(Te=Fe);const Ee=yt.get(Rt),nn=M.state.lights,Xr=M.state.shadowsArray,mr=nn.state.version,dn=Yn.getParameters(Rt,nn.state,Xr,Te,re),Pr=Yn.getProgramCacheKey(dn);let Kn=Ee.programs;Ee.environment=Rt.isMeshStandardMaterial?Te.environment:null,Ee.fog=Te.fog,Ee.envMap=Se.get(Rt.envMap||Ee.environment),Kn===void 0&&(Rt.addEventListener("dispose",qm),Kn=new Map,Ee.programs=Kn);let Gr=Kn.get(Pr);if(Gr!==void 0){if(Ee.currentProgram===Gr&&Ee.lightsStateVersion===mr)return $m(Rt,dn),Gr}else dn.uniforms=Yn.getUniforms(Rt),Rt.onBuild(dn,U),Rt.onBeforeCompile(dn,U),Gr=Yn.acquireProgram(dn,Pr),Kn.set(Pr,Gr),Ee.uniforms=dn.uniforms;const ur=Ee.uniforms;(Rt.isShaderMaterial||Rt.isRawShaderMaterial)&&Rt.clipping!==!0||(ur.clippingPlanes=No.uniform),$m(Rt,dn),Ee.needsLights=function(Ui){return Ui.isMeshLambertMaterial||Ui.isMeshToonMaterial||Ui.isMeshPhongMaterial||Ui.isMeshStandardMaterial||Ui.isShadowMaterial||Ui.isShaderMaterial&&Ui.lights===!0}(Rt),Ee.lightsStateVersion=mr,Ee.needsLights&&(ur.ambientLightColor.value=nn.state.ambient,ur.lightProbe.value=nn.state.probe,ur.directionalLights.value=nn.state.directional,ur.directionalLightShadows.value=nn.state.directionalShadow,ur.spotLights.value=nn.state.spot,ur.spotLightShadows.value=nn.state.spotShadow,ur.rectAreaLights.value=nn.state.rectArea,ur.ltc_1.value=nn.state.rectAreaLTC1,ur.ltc_2.value=nn.state.rectAreaLTC2,ur.pointLights.value=nn.state.point,ur.pointLightShadows.value=nn.state.pointShadow,ur.hemisphereLights.value=nn.state.hemi,ur.directionalShadowMap.value=nn.state.directionalShadowMap,ur.directionalShadowMatrix.value=nn.state.directionalShadowMatrix,ur.spotShadowMap.value=nn.state.spotShadowMap,ur.spotShadowMatrix.value=nn.state.spotShadowMatrix,ur.pointShadowMap.value=nn.state.pointShadowMap,ur.pointShadowMatrix.value=nn.state.pointShadowMatrix);const Nr=Gr.getUniforms(),To=Ba.seqWithValue(Nr.seq,ur);return Ee.currentProgram=Gr,Ee.uniformsList=To,Gr}function $m(Rt,Te){const re=yt.get(Rt);re.outputEncoding=Te.outputEncoding,re.instancing=Te.instancing,re.skinning=Te.skinning,re.numClippingPlanes=Te.numClippingPlanes,re.numIntersection=Te.numClipIntersection,re.vertexAlphas=Te.vertexAlphas}function Km(Rt,Te,re,Ee){Te.isScene!==!0&&(Te=Fe),Yt.resetTextureUnits();const nn=Te.fog,Xr=re.isMeshStandardMaterial?Te.environment:null,mr=gt===null?U.outputEncoding:gt.texture.encoding,dn=Se.get(re.envMap||Xr),Pr=re.vertexColors===!0&&Ee.geometry&&Ee.geometry.attributes.color&&Ee.geometry.attributes.color.itemSize===4,Kn=yt.get(re),Gr=M.state.lights;if(Sn===!0&&(In===!0||Rt!==Mt)){const Us=Rt===Mt&&re.id===pt;No.setState(re,Rt,Us)}let ur=!1;re.version===Kn.__version?Kn.needsLights&&Kn.lightsStateVersion!==Gr.state.version||Kn.outputEncoding!==mr||Ee.isInstancedMesh&&Kn.instancing===!1?ur=!0:Ee.isInstancedMesh||Kn.instancing!==!0?Ee.isSkinnedMesh&&Kn.skinning===!1?ur=!0:Ee.isSkinnedMesh||Kn.skinning!==!0?Kn.envMap!==dn||re.fog&&Kn.fog!==nn?ur=!0:Kn.numClippingPlanes===void 0||Kn.numClippingPlanes===No.numPlanes&&Kn.numIntersection===No.numIntersection?Kn.vertexAlphas!==Pr&&(ur=!0):ur=!0:ur=!0:ur=!0:(ur=!0,Kn.__version=re.version);let Nr=Kn.currentProgram;ur===!0&&(Nr=Hm(re,Te,Ee));let To=!1,Ui=!1,pl=!1;const Ci=Nr.getUniforms(),oh=Kn.uniforms;if(un.useProgram(Nr.program)&&(To=!0,Ui=!0,pl=!0),re.id!==pt&&(pt=re.id,Ui=!0),To||Mt!==Rt){if(Ci.setValue(Je,"projectionMatrix",Rt.projectionMatrix),on.logarithmicDepthBuffer&&Ci.setValue(Je,"logDepthBufFC",2/(Math.log(Rt.far+1)/Math.LN2)),Mt!==Rt&&(Mt=Rt,Ui=!0,pl=!0),re.isShaderMaterial||re.isMeshPhongMaterial||re.isMeshToonMaterial||re.isMeshStandardMaterial||re.envMap){const Us=Ci.map.cameraPosition;Us!==void 0&&Us.setValue(Je,Ot.setFromMatrixPosition(Rt.matrixWorld))}(re.isMeshPhongMaterial||re.isMeshToonMaterial||re.isMeshLambertMaterial||re.isMeshBasicMaterial||re.isMeshStandardMaterial||re.isShaderMaterial)&&Ci.setValue(Je,"isOrthographic",Rt.isOrthographicCamera===!0),(re.isMeshPhongMaterial||re.isMeshToonMaterial||re.isMeshLambertMaterial||re.isMeshBasicMaterial||re.isMeshStandardMaterial||re.isShaderMaterial||re.isShadowMaterial||Ee.isSkinnedMesh)&&Ci.setValue(Je,"viewMatrix",Rt.matrixWorldInverse)}if(Ee.isSkinnedMesh){Ci.setOptional(Je,Ee,"bindMatrix"),Ci.setOptional(Je,Ee,"bindMatrixInverse");const Us=Ee.skeleton;Us&&(on.floatVertexTextures?(Us.boneTexture===null&&Us.computeBoneTexture(),Ci.setValue(Je,"boneTexture",Us.boneTexture,Yt),Ci.setValue(Je,"boneTextureSize",Us.boneTextureSize)):Ci.setOptional(Je,Us,"boneMatrices"))}var Fo,tu;return(Ui||Kn.receiveShadow!==Ee.receiveShadow)&&(Kn.receiveShadow=Ee.receiveShadow,Ci.setValue(Je,"receiveShadow",Ee.receiveShadow)),Ui&&(Ci.setValue(Je,"toneMappingExposure",U.toneMappingExposure),Kn.needsLights&&(tu=pl,(Fo=oh).ambientLightColor.needsUpdate=tu,Fo.lightProbe.needsUpdate=tu,Fo.directionalLights.needsUpdate=tu,Fo.directionalLightShadows.needsUpdate=tu,Fo.pointLights.needsUpdate=tu,Fo.pointLightShadows.needsUpdate=tu,Fo.spotLights.needsUpdate=tu,Fo.spotLightShadows.needsUpdate=tu,Fo.rectAreaLights.needsUpdate=tu,Fo.hemisphereLights.needsUpdate=tu),nn&&re.fog&&Gn.refreshFogUniforms(oh,nn),Gn.refreshMaterialUniforms(oh,re,ye,_e,Rn),Ba.upload(Je,Kn.uniformsList,oh,Yt)),re.isShaderMaterial&&re.uniformsNeedUpdate===!0&&(Ba.upload(Je,Kn.uniformsList,oh,Yt),re.uniformsNeedUpdate=!1),re.isSpriteMaterial&&Ci.setValue(Je,"center",Ee.center),Ci.setValue(Je,"modelViewMatrix",Ee.modelViewMatrix),Ci.setValue(Je,"normalMatrix",Ee.normalMatrix),Ci.setValue(Je,"modelMatrix",Ee.matrixWorld),Nr}ff.setAnimationLoop(function(Rt){Gm&&Gm(Rt)}),typeof window!="undefined"&&ff.setContext(window),this.setAnimationLoop=function(Rt){Gm=Rt,Qa.setAnimationLoop(Rt),Rt===null?ff.stop():ff.start()},Qa.addEventListener("sessionstart",Ym),Qa.addEventListener("sessionend",Zm),this.render=function(Rt,Te){if(Te!==void 0&&Te.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(D===!0)return;Rt.autoUpdate===!0&&Rt.updateMatrixWorld(),Te.parent===null&&Te.updateMatrixWorld(),Qa.enabled===!0&&Qa.isPresenting===!0&&(Qa.cameraAutoUpdate===!0&&Qa.updateCamera(Te),Te=Qa.getCamera()),Rt.isScene===!0&&Rt.onBeforeRender(U,Rt,Te,gt),M=Mr.get(Rt,O.length),M.init(),O.push(M),Pt.multiplyMatrices(Te.projectionMatrix,Te.matrixWorldInverse),gn.setFromProjectionMatrix(Pt),In=this.localClippingEnabled,Sn=No.init(this.clippingPlanes,In,Te),A=Sr.get(Rt,P.length),A.init(),P.push(A),function mr(dn,Pr,Kn,Gr){if(dn.visible===!1)return;if(dn.layers.test(Pr.layers)){if(dn.isGroup)Kn=dn.renderOrder;else if(dn.isLOD)dn.autoUpdate===!0&&dn.update(Pr);else if(dn.isLight)M.pushLight(dn),dn.castShadow&&M.pushShadow(dn);else if(dn.isSprite){if(!dn.frustumCulled||gn.intersectsSprite(dn)){Gr&&Ot.setFromMatrixPosition(dn.matrixWorld).applyMatrix4(Pt);const Nr=An.update(dn),To=dn.material;To.visible&&A.push(dn,Nr,To,Kn,Ot.z,null)}}else if(dn.isImmediateRenderObject)Gr&&Ot.setFromMatrixPosition(dn.matrixWorld).applyMatrix4(Pt),A.push(dn,null,dn.material,Kn,Ot.z,null);else if((dn.isMesh||dn.isLine||dn.isPoints)&&(dn.isSkinnedMesh&&dn.skeleton.frame!==xe.render.frame&&(dn.skeleton.update(),dn.skeleton.frame=xe.render.frame),!dn.frustumCulled||gn.intersectsObject(dn))){Gr&&Ot.setFromMatrixPosition(dn.matrixWorld).applyMatrix4(Pt);const Nr=An.update(dn),To=dn.material;if(Array.isArray(To)){const Ui=Nr.groups;for(let pl=0,Ci=Ui.length;pl<Ci;pl++){const oh=Ui[pl],Fo=To[oh.materialIndex];Fo&&Fo.visible&&A.push(dn,Nr,Fo,Kn,Ot.z,oh)}}else To.visible&&A.push(dn,Nr,To,Kn,Ot.z,null)}}const ur=dn.children;for(let Nr=0,To=ur.length;Nr<To;Nr++)mr(ur[Nr],Pr,Kn,Gr)}(Rt,Te,0,U.sortObjects),A.finish(),U.sortObjects===!0&&A.sort(me,Ht),Sn===!0&&No.beginShadows();const re=M.state.shadowsArray;Pi.render(re,Rt,Te),M.setupLights(),M.setupLightsView(Te),Sn===!0&&No.endShadows(),this.info.autoReset===!0&&this.info.reset(),fl.render(A,Rt);const Ee=A.opaque,nn=A.transmissive,Xr=A.transparent;Ee.length>0&&Mm(Ee,Rt,Te),nn.length>0&&function(mr,dn,Pr,Kn){if(Rn===null){const Nr=f===!0&&on.isWebGL2===!0;Rn=new(Nr?dc:Po)(1024,1024,{generateMipmaps:!0,type:ta.convert(Nt)!==null?Nt:ho,minFilter:ui,magFilter:St,wrapS:wt,wrapT:wt})}const Gr=U.getRenderTarget();U.setRenderTarget(Rn),U.clear();const ur=U.toneMapping;U.toneMapping=Er,Mm(mr,Pr,Kn),U.toneMapping=ur,Yt.updateMultisampleRenderTarget(Rn),Yt.updateRenderTargetMipmap(Rn),U.setRenderTarget(Gr),Mm(dn,Pr,Kn)}(Ee,nn,Rt,Te),Xr.length>0&&Mm(Xr,Rt,Te),gt!==null&&(Yt.updateMultisampleRenderTarget(gt),Yt.updateRenderTargetMipmap(gt)),Rt.isScene===!0&&Rt.onAfterRender(U,Rt,Te),un.buffers.depth.setTest(!0),un.buffers.depth.setMask(!0),un.buffers.color.setMask(!0),un.setPolygonOffset(!1),xa.resetDefaultState(),pt=-1,Mt=null,O.pop(),M=O.length>0?O[O.length-1]:null,P.pop(),A=P.length>0?P[P.length-1]:null},this.getActiveCubeFace=function(){return Z},this.getActiveMipmapLevel=function(){return rt},this.getRenderTarget=function(){return gt},this.setRenderTarget=function(Rt,Te=0,re=0){gt=Rt,Z=Te,rt=re,Rt&&yt.get(Rt).__webglFramebuffer===void 0&&Yt.setupRenderTarget(Rt);let Ee=null,nn=!1,Xr=!1;if(Rt){const mr=Rt.texture;(mr.isDataTexture3D||mr.isDataTexture2DArray)&&(Xr=!0);const dn=yt.get(Rt).__webglFramebuffer;Rt.isWebGLCubeRenderTarget?(Ee=dn[Te],nn=!0):Ee=Rt.isWebGLMultisampleRenderTarget?yt.get(Rt).__webglMultisampledFramebuffer:dn,At.copy(Rt.viewport),Et.copy(Rt.scissor),Lt=Rt.scissorTest}else At.copy(ae).multiplyScalar(ye).floor(),Et.copy(Ze).multiplyScalar(ye).floor(),Lt=Xe;if(un.bindFramebuffer(36160,Ee)&&on.drawBuffers){let mr=!1;if(Rt)if(Rt.isWebGLMultipleRenderTargets){const dn=Rt.texture;if(je.length!==dn.length||je[0]!==36064){for(let Pr=0,Kn=dn.length;Pr<Kn;Pr++)je[Pr]=36064+Pr;je.length=dn.length,mr=!0}}else je.length===1&&je[0]===36064||(je[0]=36064,je.length=1,mr=!0);else je.length===1&&je[0]===1029||(je[0]=1029,je.length=1,mr=!0);mr&&(on.isWebGL2?Je.drawBuffers(je):ce.get("WEBGL_draw_buffers").drawBuffersWEBGL(je))}if(un.viewport(At),un.scissor(Et),un.setScissorTest(Lt),nn){const mr=yt.get(Rt.texture);Je.framebufferTexture2D(36160,36064,34069+Te,mr.__webglTexture,re)}else if(Xr){const mr=yt.get(Rt.texture),dn=Te||0;Je.framebufferTextureLayer(36160,36064,mr.__webglTexture,re||0,dn)}},this.readRenderTargetPixels=function(Rt,Te,re,Ee,nn,Xr,mr){if(!Rt||!Rt.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let dn=yt.get(Rt).__webglFramebuffer;if(Rt.isWebGLCubeRenderTarget&&mr!==void 0&&(dn=dn[mr]),dn){un.bindFramebuffer(36160,dn);try{const Pr=Rt.texture,Kn=Pr.format,Gr=Pr.type;if(Kn!==Pn&&ta.convert(Kn)!==Je.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ur=Gr===Nt&&(ce.has("EXT_color_buffer_half_float")||on.isWebGL2&&ce.has("EXT_color_buffer_float"));if(!(Gr===ho||ta.convert(Gr)===Je.getParameter(35738)||Gr===Jt&&(on.isWebGL2||ce.has("OES_texture_float")||ce.has("WEBGL_color_buffer_float"))||ur))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Je.checkFramebufferStatus(36160)===36053?Te>=0&&Te<=Rt.width-Ee&&re>=0&&re<=Rt.height-nn&&Je.readPixels(Te,re,Ee,nn,ta.convert(Kn),ta.convert(Gr),Xr):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Pr=gt!==null?yt.get(gt).__webglFramebuffer:null;un.bindFramebuffer(36160,Pr)}}},this.copyFramebufferToTexture=function(Rt,Te,re=0){const Ee=Math.pow(2,-re),nn=Math.floor(Te.image.width*Ee),Xr=Math.floor(Te.image.height*Ee);let mr=ta.convert(Te.format);on.isWebGL2&&(mr===6407&&(mr=32849),mr===6408&&(mr=32856)),Yt.setTexture2D(Te,0),Je.copyTexImage2D(3553,re,mr,Rt.x,Rt.y,nn,Xr,0),un.unbindTexture()},this.copyTextureToTexture=function(Rt,Te,re,Ee=0){const nn=Te.image.width,Xr=Te.image.height,mr=ta.convert(re.format),dn=ta.convert(re.type);Yt.setTexture2D(re,0),Je.pixelStorei(37440,re.flipY),Je.pixelStorei(37441,re.premultiplyAlpha),Je.pixelStorei(3317,re.unpackAlignment),Te.isDataTexture?Je.texSubImage2D(3553,Ee,Rt.x,Rt.y,nn,Xr,mr,dn,Te.image.data):Te.isCompressedTexture?Je.compressedTexSubImage2D(3553,Ee,Rt.x,Rt.y,Te.mipmaps[0].width,Te.mipmaps[0].height,mr,Te.mipmaps[0].data):Je.texSubImage2D(3553,Ee,Rt.x,Rt.y,mr,dn,Te.image),Ee===0&&re.generateMipmaps&&Je.generateMipmap(3553),un.unbindTexture()},this.copyTextureToTexture3D=function(Rt,Te,re,Ee,nn=0){if(U.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Xr=Rt.max.x-Rt.min.x+1,mr=Rt.max.y-Rt.min.y+1,dn=Rt.max.z-Rt.min.z+1,Pr=ta.convert(Ee.format),Kn=ta.convert(Ee.type);let Gr;if(Ee.isDataTexture3D)Yt.setTexture3D(Ee,0),Gr=32879;else{if(!Ee.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Yt.setTexture2DArray(Ee,0),Gr=35866}Je.pixelStorei(37440,Ee.flipY),Je.pixelStorei(37441,Ee.premultiplyAlpha),Je.pixelStorei(3317,Ee.unpackAlignment);const ur=Je.getParameter(3314),Nr=Je.getParameter(32878),To=Je.getParameter(3316),Ui=Je.getParameter(3315),pl=Je.getParameter(32877),Ci=re.isCompressedTexture?re.mipmaps[0]:re.image;Je.pixelStorei(3314,Ci.width),Je.pixelStorei(32878,Ci.height),Je.pixelStorei(3316,Rt.min.x),Je.pixelStorei(3315,Rt.min.y),Je.pixelStorei(32877,Rt.min.z),re.isDataTexture||re.isDataTexture3D?Je.texSubImage3D(Gr,nn,Te.x,Te.y,Te.z,Xr,mr,dn,Pr,Kn,Ci.data):re.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Je.compressedTexSubImage3D(Gr,nn,Te.x,Te.y,Te.z,Xr,mr,dn,Pr,Ci.data)):Je.texSubImage3D(Gr,nn,Te.x,Te.y,Te.z,Xr,mr,dn,Pr,Kn,Ci),Je.pixelStorei(3314,ur),Je.pixelStorei(32878,Nr),Je.pixelStorei(3316,To),Je.pixelStorei(3315,Ui),Je.pixelStorei(32877,pl),nn===0&&Ee.generateMipmaps&&Je.generateMipmap(Gr),un.unbindTexture()},this.initTexture=function(Rt){Yt.setTexture2D(Rt,0),un.unbindTexture()},this.resetState=function(){Z=0,rt=0,gt=null,un.reset(),xa.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class Lf extends Jr{}Lf.prototype.isWebGL1Renderer=!0;class Ga{constructor(t,i=25e-5){this.name="",this.color=new pn(t),this.density=i}clone(){return new Ga(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Ga.prototype.isFogExp2=!0;class Ju{constructor(t,i=1,a=1e3){this.name="",this.color=new pn(t),this.near=i,this.far=a}clone(){return new Ju(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Ju.prototype.isFog=!0;class Fh extends vr{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,i){return super.copy(t,i),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const i=super.toJSON(t);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),i}}Fh.prototype.isScene=!0;class Ha{constructor(t,i){this.array=t,this.stride=i,this.count=t!==void 0?t.length/i:0,this.usage=ys,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=jo()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,i,a){t*=this.stride,a*=i.stride;for(let u=0,d=this.stride;u<d;u++)this.array[t+u]=i.array[a+u];return this}set(t,i=0){return this.array.set(t,i),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=jo()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),a=new this.constructor(i,this.stride);return a.setUsage(this.usage),a}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=jo()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Ha.prototype.isInterleavedBuffer=!0;const Ni=new mt;class di{constructor(t,i,a,u=!1){this.name="",this.data=t,this.itemSize=i,this.offset=a,this.normalized=u===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let i=0,a=this.data.count;i<a;i++)Ni.x=this.getX(i),Ni.y=this.getY(i),Ni.z=this.getZ(i),Ni.applyMatrix4(t),this.setXYZ(i,Ni.x,Ni.y,Ni.z);return this}applyNormalMatrix(t){for(let i=0,a=this.count;i<a;i++)Ni.x=this.getX(i),Ni.y=this.getY(i),Ni.z=this.getZ(i),Ni.applyNormalMatrix(t),this.setXYZ(i,Ni.x,Ni.y,Ni.z);return this}transformDirection(t){for(let i=0,a=this.count;i<a;i++)Ni.x=this.getX(i),Ni.y=this.getY(i),Ni.z=this.getZ(i),Ni.transformDirection(t),this.setXYZ(i,Ni.x,Ni.y,Ni.z);return this}setX(t,i){return this.data.array[t*this.data.stride+this.offset]=i,this}setY(t,i){return this.data.array[t*this.data.stride+this.offset+1]=i,this}setZ(t,i){return this.data.array[t*this.data.stride+this.offset+2]=i,this}setW(t,i){return this.data.array[t*this.data.stride+this.offset+3]=i,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,i,a){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=a,this}setXYZ(t,i,a,u){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=a,this.data.array[t+2]=u,this}setXYZW(t,i,a,u,d){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=a,this.data.array[t+2]=u,this.data.array[t+3]=d,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let a=0;a<this.count;a++){const u=a*this.data.stride+this.offset;for(let d=0;d<this.itemSize;d++)i.push(this.data.array[u+d])}return new hr(new this.array.constructor(i),this.itemSize,this.normalized)}return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new di(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let a=0;a<this.count;a++){const u=a*this.data.stride+this.offset;for(let d=0;d<this.itemSize;d++)i.push(this.data.array[u+d])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}di.prototype.isInterleavedBufferAttribute=!0;class so extends ji{constructor(t){super(),this.type="SpriteMaterial",this.color=new pn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let Vl;so.prototype.isSpriteMaterial=!0;const $u=new mt,Wl=new mt,Ku=new mt,Qu=new He,tl=new He,_u=new Tn,ma=new mt,Xl=new mt,Bh=new mt,Bc=new He,Jd=new He,Of=new He;class Uh extends vr{constructor(t){if(super(),this.type="Sprite",Vl===void 0){Vl=new Dn;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),a=new Ha(i,5);Vl.setIndex([0,1,2,0,2,3]),Vl.setAttribute("position",new di(a,3,0,!1)),Vl.setAttribute("uv",new di(a,2,3,!1))}this.geometry=Vl,this.material=t!==void 0?t:new so,this.center=new He(.5,.5)}raycast(t,i){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Wl.setFromMatrixScale(this.matrixWorld),_u.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Ku.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Wl.multiplyScalar(-Ku.z);const a=this.material.rotation;let u,d;a!==0&&(d=Math.cos(a),u=Math.sin(a));const f=this.center;ql(ma.set(-.5,-.5,0),Ku,f,Wl,u,d),ql(Xl.set(.5,-.5,0),Ku,f,Wl,u,d),ql(Bh.set(.5,.5,0),Ku,f,Wl,u,d),Bc.set(0,0),Jd.set(1,0),Of.set(1,1);let v=t.ray.intersectTriangle(ma,Xl,Bh,!1,$u);if(v===null&&(ql(Xl.set(-.5,.5,0),Ku,f,Wl,u,d),Jd.set(0,1),v=t.ray.intersectTriangle(ma,Bh,Xl,!1,$u),v===null))return;const _=t.ray.origin.distanceTo($u);_<t.near||_>t.far||i.push({distance:_,point:$u.clone(),uv:bi.getUV($u,ma,Xl,Bh,Bc,Jd,Of,new He),face:null,object:this})}copy(t){return super.copy(t),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}}function ql(m,t,i,a,u,d){Qu.subVectors(m,i).addScalar(.5).multiply(a),u!==void 0?(tl.x=d*Qu.x-u*Qu.y,tl.y=u*Qu.x+d*Qu.y):tl.copy(Qu),m.copy(t),m.x+=tl.x,m.y+=tl.y,m.applyMatrix4(_u)}Uh.prototype.isSprite=!0;const Uc=new mt,Yl=new mt;class kc extends vr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const i=t.levels;for(let a=0,u=i.length;a<u;a++){const d=i[a];this.addLevel(d.object.clone(),d.distance)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,i=0){i=Math.abs(i);const a=this.levels;let u;for(u=0;u<a.length&&!(i<a[u].distance);u++);return a.splice(u,0,{distance:i,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const i=this.levels;if(i.length>0){let a,u;for(a=1,u=i.length;a<u&&!(t<i[a].distance);a++);return i[a-1].object}return null}raycast(t,i){if(this.levels.length>0){Uc.setFromMatrixPosition(this.matrixWorld);const a=t.ray.origin.distanceTo(Uc);this.getObjectForDistance(a).raycast(t,i)}}update(t){const i=this.levels;if(i.length>1){Uc.setFromMatrixPosition(t.matrixWorld),Yl.setFromMatrixPosition(this.matrixWorld);const a=Uc.distanceTo(Yl)/t.zoom;let u,d;for(i[0].object.visible=!0,u=1,d=i.length;u<d&&a>=i[u].distance;u++)i[u-1].object.visible=!1,i[u].object.visible=!0;for(this._currentLevel=u-1;u<d;u++)i[u].object.visible=!1}}toJSON(t){const i=super.toJSON(t);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const a=this.levels;for(let u=0,d=a.length;u<d;u++){const f=a[u];i.object.levels.push({object:f.object.uuid,distance:f.distance})}return i}}const $d=new mt,Kd=new Ir,Df=new Ir,Qd=new mt,Gc=new Tn;class el extends mi{constructor(t,i){super(t,i),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Tn,this.bindMatrixInverse=new Tn}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,i){this.skeleton=t,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Ir,i=this.geometry.attributes.skinWeight;for(let a=0,u=i.count;a<u;a++){t.x=i.getX(a),t.y=i.getY(a),t.z=i.getZ(a),t.w=i.getW(a);const d=1/t.manhattanLength();d!==1/0?t.multiplyScalar(d):t.set(1,0,0,0),i.setXYZW(a,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,i){const a=this.skeleton,u=this.geometry;Kd.fromBufferAttribute(u.attributes.skinIndex,t),Df.fromBufferAttribute(u.attributes.skinWeight,t),$d.fromBufferAttribute(u.attributes.position,t).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let d=0;d<4;d++){const f=Df.getComponent(d);if(f!==0){const v=Kd.getComponent(d);Gc.multiplyMatrices(a.bones[v].matrixWorld,a.boneInverses[v]),i.addScaledVector(Qd.copy($d).applyMatrix4(Gc),f)}}return i.applyMatrix4(this.bindMatrixInverse)}}el.prototype.isSkinnedMesh=!0;class Yi extends vr{constructor(){super(),this.type="Bone"}}Yi.prototype.isBone=!0;class ga extends ii{constructor(t=null,i=1,a=1,u,d,f,v,_,y=St,E=St,A,M){super(null,f,v,_,y,E,u,d,A,M),this.image={data:t,width:i,height:a},this.magFilter=y,this.minFilter=E,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}ga.prototype.isDataTexture=!0;const Js=new Tn,Nf=new Tn;class za{constructor(t=[],i=[]){this.uuid=jo(),this.bones=t.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),i.length===0)this.calculateInverses();else if(t.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let a=0,u=this.bones.length;a<u;a++)this.boneInverses.push(new Tn)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,i=this.bones.length;t<i;t++){const a=new Tn;this.bones[t]&&a.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(a)}}pose(){for(let t=0,i=this.bones.length;t<i;t++){const a=this.bones[t];a&&a.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,i=this.bones.length;t<i;t++){const a=this.bones[t];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}update(){const t=this.bones,i=this.boneInverses,a=this.boneMatrices,u=this.boneTexture;for(let d=0,f=t.length;d<f;d++){const v=t[d]?t[d].matrixWorld:Nf;Js.multiplyMatrices(v,i[d]),Js.toArray(a,16*d)}u!==null&&(u.needsUpdate=!0)}clone(){return new za(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=Ji(t),t=Math.max(t,4);const i=new Float32Array(t*t*4);i.set(this.boneMatrices);const a=new ga(i,t,t,Pn,Jt);return this.boneMatrices=i,this.boneTexture=a,this.boneTextureSize=t,this}getBoneByName(t){for(let i=0,a=this.bones.length;i<a;i++){const u=this.bones[i];if(u.name===t)return u}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,i){this.uuid=t.uuid;for(let a=0,u=t.bones.length;a<u;a++){const d=t.bones[a];let f=i[d];f===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",d),f=new Yi),this.bones.push(f),this.boneInverses.push(new Tn().fromArray(t.boneInverses[a]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const i=this.bones,a=this.boneInverses;for(let u=0,d=i.length;u<d;u++){const f=i[u];t.bones.push(f.uuid);const v=a[u];t.boneInverses.push(v.toArray())}return t}}const kh=new Tn,tf=new Tn,Gh=[],Zl=new mi;class Hh extends mi{constructor(t,i,a){super(t,i),this.instanceMatrix=new hr(new Float32Array(16*a),16),this.instanceColor=null,this.count=a,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,i){i.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,i){i.fromArray(this.instanceMatrix.array,16*t)}raycast(t,i){const a=this.matrixWorld,u=this.count;if(Zl.geometry=this.geometry,Zl.material=this.material,Zl.material!==void 0)for(let d=0;d<u;d++){this.getMatrixAt(d,kh),tf.multiplyMatrices(a,kh),Zl.matrixWorld=tf,Zl.raycast(t,Gh);for(let f=0,v=Gh.length;f<v;f++){const _=Gh[f];_.instanceId=d,_.object=this,i.push(_)}Gh.length=0}}setColorAt(t,i){this.instanceColor===null&&(this.instanceColor=new hr(new Float32Array(3*this.count),3)),i.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,i){i.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Hh.prototype.isInstancedMesh=!0;class ao extends ji{constructor(t){super(),this.type="LineBasicMaterial",this.color=new pn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this}}ao.prototype.isLineBasicMaterial=!0;const Ff=new mt,nl=new mt,Hc=new Tn,zh=new Ro,zc=new ws;class ja extends vr{constructor(t=new Dn,i=new ao){super(),this.type="Line",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const i=t.attributes.position,a=[0];for(let u=1,d=i.count;u<d;u++)Ff.fromBufferAttribute(i,u-1),nl.fromBufferAttribute(i,u),a[u]=a[u-1],a[u]+=Ff.distanceTo(nl);t.setAttribute("lineDistance",new En(a,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,i){const a=this.geometry,u=this.matrixWorld,d=t.params.Line.threshold,f=a.drawRange;if(a.boundingSphere===null&&a.computeBoundingSphere(),zc.copy(a.boundingSphere),zc.applyMatrix4(u),zc.radius+=d,t.ray.intersectsSphere(zc)===!1)return;Hc.copy(u).invert(),zh.copy(t.ray).applyMatrix4(Hc);const v=d/((this.scale.x+this.scale.y+this.scale.z)/3),_=v*v,y=new mt,E=new mt,A=new mt,M=new mt,P=this.isLineSegments?2:1;if(a.isBufferGeometry){const O=a.index,U=a.attributes.position;if(O!==null)for(let D=Math.max(0,f.start),Z=Math.min(O.count,f.start+f.count)-1;D<Z;D+=P){const rt=O.getX(D),gt=O.getX(D+1);if(y.fromBufferAttribute(U,rt),E.fromBufferAttribute(U,gt),zh.distanceSqToSegment(y,E,M,A)>_)continue;M.applyMatrix4(this.matrixWorld);const pt=t.ray.origin.distanceTo(M);pt<t.near||pt>t.far||i.push({distance:pt,point:A.clone().applyMatrix4(this.matrixWorld),index:D,face:null,faceIndex:null,object:this})}else for(let D=Math.max(0,f.start),Z=Math.min(U.count,f.start+f.count)-1;D<Z;D+=P){if(y.fromBufferAttribute(U,D),E.fromBufferAttribute(U,D+1),zh.distanceSqToSegment(y,E,M,A)>_)continue;M.applyMatrix4(this.matrixWorld);const rt=t.ray.origin.distanceTo(M);rt<t.near||rt>t.far||i.push({distance:rt,point:A.clone().applyMatrix4(this.matrixWorld),index:D,face:null,faceIndex:null,object:this})}}else a.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const i=t.morphAttributes,a=Object.keys(i);if(a.length>0){const u=i[a[0]];if(u!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,f=u.length;d<f;d++){const v=u[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=d}}}}else{const i=t.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}ja.prototype.isLine=!0;const Bf=new mt,jc=new mt;class Jo extends ja{constructor(t,i){super(t,i),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const i=t.attributes.position,a=[];for(let u=0,d=i.count;u<d;u+=2)Bf.fromBufferAttribute(i,u),jc.fromBufferAttribute(i,u+1),a[u]=u===0?0:a[u-1],a[u+1]=a[u]+Bf.distanceTo(jc);t.setAttribute("lineDistance",new En(a,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Jo.prototype.isLineSegments=!0;class ef extends ja{constructor(t,i){super(t,i),this.type="LineLoop"}}ef.prototype.isLineLoop=!0;class rl extends ji{constructor(t){super(),this.type="PointsMaterial",this.color=new pn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this}}rl.prototype.isPointsMaterial=!0;const c=new Tn,g=new Ro,T=new ws,N=new mt;class W extends vr{constructor(t=new Dn,i=new rl){super(),this.type="Points",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,i){const a=this.geometry,u=this.matrixWorld,d=t.params.Points.threshold,f=a.drawRange;if(a.boundingSphere===null&&a.computeBoundingSphere(),T.copy(a.boundingSphere),T.applyMatrix4(u),T.radius+=d,t.ray.intersectsSphere(T)===!1)return;c.copy(u).invert(),g.copy(t.ray).applyMatrix4(c);const v=d/((this.scale.x+this.scale.y+this.scale.z)/3),_=v*v;if(a.isBufferGeometry){const y=a.index,E=a.attributes.position;if(y!==null)for(let A=Math.max(0,f.start),M=Math.min(y.count,f.start+f.count);A<M;A++){const P=y.getX(A);N.fromBufferAttribute(E,P),ht(N,P,_,u,t,i,this)}else for(let A=Math.max(0,f.start),M=Math.min(E.count,f.start+f.count);A<M;A++)N.fromBufferAttribute(E,A),ht(N,A,_,u,t,i,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const i=t.morphAttributes,a=Object.keys(i);if(a.length>0){const u=i[a[0]];if(u!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,f=u.length;d<f;d++){const v=u[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=d}}}}else{const i=t.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function ht(m,t,i,a,u,d,f){const v=g.distanceSqToPoint(m);if(v<i){const _=new mt;g.closestPointToPoint(m,_),_.applyMatrix4(a);const y=u.ray.origin.distanceTo(_);if(y<u.near||y>u.far)return;d.push({distance:y,distanceToRay:Math.sqrt(v),point:_,index:t,face:null,object:f})}}W.prototype.isPoints=!0;class Tt extends ii{constructor(t,i,a,u,d,f,v,_,y){super(t,i,a,u,d,f,v,_,y),this.format=v!==void 0?v:wn,this.minFilter=f!==void 0?f:We,this.magFilter=d!==void 0?d:We,this.generateMipmaps=!1;const E=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function A(){E.needsUpdate=!0,t.requestVideoFrameCallback(A)})}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}Tt.prototype.isVideoTexture=!0;class It extends ii{constructor(t,i,a,u,d,f,v,_,y,E,A,M){super(null,f,v,_,y,E,u,d,A,M),this.image={width:i,height:a},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}It.prototype.isCompressedTexture=!0;class qt extends ii{constructor(t,i,a,u,d,f,v,_,y){super(t,i,a,u,d,f,v,_,y),this.needsUpdate=!0}}qt.prototype.isCanvasTexture=!0;class ve extends ii{constructor(t,i,a,u,d,f,v,_,y,E){if((E=E!==void 0?E:vn)!==vn&&E!==ir)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");a===void 0&&E===vn&&(a=Sa),a===void 0&&E===ir&&(a=hn),super(null,u,d,f,v,_,E,a,y),this.image={width:t,height:i},this.magFilter=v!==void 0?v:St,this.minFilter=_!==void 0?_:St,this.flipY=!1,this.generateMipmaps=!1}}ve.prototype.isDepthTexture=!0;class le extends Dn{constructor(t=1,i=8,a=0,u=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:i,thetaStart:a,thetaLength:u},i=Math.max(3,i);const d=[],f=[],v=[],_=[],y=new mt,E=new He;f.push(0,0,0),v.push(0,0,1),_.push(.5,.5);for(let A=0,M=3;A<=i;A++,M+=3){const P=a+A/i*u;y.x=t*Math.cos(P),y.y=t*Math.sin(P),f.push(y.x,y.y,y.z),v.push(0,0,1),E.x=(f[M]/t+1)/2,E.y=(f[M+1]/t+1)/2,_.push(E.x,E.y)}for(let A=1;A<=i;A++)d.push(A,A+1,0);this.setIndex(d),this.setAttribute("position",new En(f,3)),this.setAttribute("normal",new En(v,3)),this.setAttribute("uv",new En(_,2))}static fromJSON(t){return new le(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class Ne extends Dn{constructor(t=1,i=1,a=1,u=8,d=1,f=!1,v=0,_=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:i,height:a,radialSegments:u,heightSegments:d,openEnded:f,thetaStart:v,thetaLength:_};const y=this;u=Math.floor(u),d=Math.floor(d);const E=[],A=[],M=[],P=[];let O=0;const U=[],D=a/2;let Z=0;function rt(gt){const pt=O,Mt=new He,At=new mt;let Et=0;const Lt=gt===!0?t:i,Ie=gt===!0?1:-1;for(let ye=1;ye<=u;ye++)A.push(0,D*Ie,0),M.push(0,Ie,0),P.push(.5,.5),O++;const _e=O;for(let ye=0;ye<=u;ye++){const me=ye/u*_+v,Ht=Math.cos(me),ae=Math.sin(me);At.x=Lt*ae,At.y=D*Ie,At.z=Lt*Ht,A.push(At.x,At.y,At.z),M.push(0,Ie,0),Mt.x=.5*Ht+.5,Mt.y=.5*ae*Ie+.5,P.push(Mt.x,Mt.y),O++}for(let ye=0;ye<u;ye++){const me=pt+ye,Ht=_e+ye;gt===!0?E.push(Ht,Ht+1,me):E.push(Ht+1,Ht,me),Et+=3}y.addGroup(Z,Et,gt===!0?1:2),Z+=Et}(function(){const gt=new mt,pt=new mt;let Mt=0;const At=(i-t)/a;for(let Et=0;Et<=d;Et++){const Lt=[],Ie=Et/d,_e=Ie*(i-t)+t;for(let ye=0;ye<=u;ye++){const me=ye/u,Ht=me*_+v,ae=Math.sin(Ht),Ze=Math.cos(Ht);pt.x=_e*ae,pt.y=-Ie*a+D,pt.z=_e*Ze,A.push(pt.x,pt.y,pt.z),gt.set(ae,At,Ze).normalize(),M.push(gt.x,gt.y,gt.z),P.push(me,1-Ie),Lt.push(O++)}U.push(Lt)}for(let Et=0;Et<u;Et++)for(let Lt=0;Lt<d;Lt++){const Ie=U[Lt][Et],_e=U[Lt+1][Et],ye=U[Lt+1][Et+1],me=U[Lt][Et+1];E.push(Ie,_e,me),E.push(_e,ye,me),Mt+=6}y.addGroup(Z,Mt,0),Z+=Mt})(),f===!1&&(t>0&&rt(!0),i>0&&rt(!1)),this.setIndex(E),this.setAttribute("position",new En(A,3)),this.setAttribute("normal",new En(M,3)),this.setAttribute("uv",new En(P,2))}static fromJSON(t){return new Ne(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class yn extends Ne{constructor(t=1,i=1,a=8,u=1,d=!1,f=0,v=2*Math.PI){super(0,t,i,a,u,d,f,v),this.type="ConeGeometry",this.parameters={radius:t,height:i,radialSegments:a,heightSegments:u,openEnded:d,thetaStart:f,thetaLength:v}}static fromJSON(t){return new yn(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class xn extends Dn{constructor(t,i,a=1,u=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:i,radius:a,detail:u};const d=[],f=[];function v(M,P,O,U){const D=U+1,Z=[];for(let rt=0;rt<=D;rt++){Z[rt]=[];const gt=M.clone().lerp(O,rt/D),pt=P.clone().lerp(O,rt/D),Mt=D-rt;for(let At=0;At<=Mt;At++)Z[rt][At]=At===0&&rt===D?gt:gt.clone().lerp(pt,At/Mt)}for(let rt=0;rt<D;rt++)for(let gt=0;gt<2*(D-rt)-1;gt++){const pt=Math.floor(gt/2);gt%2==0?(_(Z[rt][pt+1]),_(Z[rt+1][pt]),_(Z[rt][pt])):(_(Z[rt][pt+1]),_(Z[rt+1][pt+1]),_(Z[rt+1][pt]))}}function _(M){d.push(M.x,M.y,M.z)}function y(M,P){const O=3*M;P.x=t[O+0],P.y=t[O+1],P.z=t[O+2]}function E(M,P,O,U){U<0&&M.x===1&&(f[P]=M.x-1),O.x===0&&O.z===0&&(f[P]=U/2/Math.PI+.5)}function A(M){return Math.atan2(M.z,-M.x)}(function(M){const P=new mt,O=new mt,U=new mt;for(let D=0;D<i.length;D+=3)y(i[D+0],P),y(i[D+1],O),y(i[D+2],U),v(P,O,U,M)})(u),function(M){const P=new mt;for(let O=0;O<d.length;O+=3)P.x=d[O+0],P.y=d[O+1],P.z=d[O+2],P.normalize().multiplyScalar(M),d[O+0]=P.x,d[O+1]=P.y,d[O+2]=P.z}(a),function(){const M=new mt;for(let O=0;O<d.length;O+=3){M.x=d[O+0],M.y=d[O+1],M.z=d[O+2];const U=A(M)/2/Math.PI+.5,D=(P=M,Math.atan2(-P.y,Math.sqrt(P.x*P.x+P.z*P.z))/Math.PI+.5);f.push(U,1-D)}var P;(function(){const O=new mt,U=new mt,D=new mt,Z=new mt,rt=new He,gt=new He,pt=new He;for(let Mt=0,At=0;Mt<d.length;Mt+=9,At+=6){O.set(d[Mt+0],d[Mt+1],d[Mt+2]),U.set(d[Mt+3],d[Mt+4],d[Mt+5]),D.set(d[Mt+6],d[Mt+7],d[Mt+8]),rt.set(f[At+0],f[At+1]),gt.set(f[At+2],f[At+3]),pt.set(f[At+4],f[At+5]),Z.copy(O).add(U).add(D).divideScalar(3);const Et=A(Z);E(rt,At+0,O,Et),E(gt,At+2,U,Et),E(pt,At+4,D,Et)}})(),function(){for(let O=0;O<f.length;O+=6){const U=f[O+0],D=f[O+2],Z=f[O+4],rt=Math.max(U,D,Z),gt=Math.min(U,D,Z);rt>.9&&gt<.1&&(U<.2&&(f[O+0]+=1),D<.2&&(f[O+2]+=1),Z<.2&&(f[O+4]+=1))}}()}(),this.setAttribute("position",new En(d,3)),this.setAttribute("normal",new En(d.slice(),3)),this.setAttribute("uv",new En(f,2)),u===0?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(t){return new xn(t.vertices,t.indices,t.radius,t.details)}}class Bn extends xn{constructor(t=1,i=0){const a=(1+Math.sqrt(5))/2,u=1/a;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-u,-a,0,-u,a,0,u,-a,0,u,a,-u,-a,0,-u,a,0,u,-a,0,u,a,0,-a,0,-u,a,0,-u,-a,0,u,a,0,u],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,i),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new Bn(t.radius,t.detail)}}const Me=new mt,qe=new mt,Qn=new mt,_n=new bi;class qn extends Dn{constructor(t,i){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:i},i=i!==void 0?i:1,t.isGeometry===!0)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const a=Math.pow(10,4),u=Math.cos(ia*i),d=t.getIndex(),f=t.getAttribute("position"),v=d?d.count:f.count,_=[0,0,0],y=["a","b","c"],E=new Array(3),A={},M=[];for(let P=0;P<v;P+=3){d?(_[0]=d.getX(P),_[1]=d.getX(P+1),_[2]=d.getX(P+2)):(_[0]=P,_[1]=P+1,_[2]=P+2);const{a:O,b:U,c:D}=_n;if(O.fromBufferAttribute(f,_[0]),U.fromBufferAttribute(f,_[1]),D.fromBufferAttribute(f,_[2]),_n.getNormal(Qn),E[0]=`${Math.round(O.x*a)},${Math.round(O.y*a)},${Math.round(O.z*a)}`,E[1]=`${Math.round(U.x*a)},${Math.round(U.y*a)},${Math.round(U.z*a)}`,E[2]=`${Math.round(D.x*a)},${Math.round(D.y*a)},${Math.round(D.z*a)}`,E[0]!==E[1]&&E[1]!==E[2]&&E[2]!==E[0])for(let Z=0;Z<3;Z++){const rt=(Z+1)%3,gt=E[Z],pt=E[rt],Mt=_n[y[Z]],At=_n[y[rt]],Et=`${gt}_${pt}`,Lt=`${pt}_${gt}`;Lt in A&&A[Lt]?(Qn.dot(A[Lt].normal)<=u&&(M.push(Mt.x,Mt.y,Mt.z),M.push(At.x,At.y,At.z)),A[Lt]=null):Et in A||(A[Et]={index0:_[Z],index1:_[rt],normal:Qn.clone()})}}for(const P in A)if(A[P]){const{index0:O,index1:U}=A[P];Me.fromBufferAttribute(f,O),qe.fromBufferAttribute(f,U),M.push(Me.x,Me.y,Me.z),M.push(qe.x,qe.y,qe.z)}this.setAttribute("position",new En(M,3))}}class Cn{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,i){const a=this.getUtoTmapping(t);return this.getPoint(a,i)}getPoints(t=5){const i=[];for(let a=0;a<=t;a++)i.push(this.getPoint(a/t));return i}getSpacedPoints(t=5){const i=[];for(let a=0;a<=t;a++)i.push(this.getPointAt(a/t));return i}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let a,u=this.getPoint(0),d=0;i.push(0);for(let f=1;f<=t;f++)a=this.getPoint(f/t),d+=a.distanceTo(u),i.push(d),u=a;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,i){const a=this.getLengths();let u=0;const d=a.length;let f;f=i||t*a[d-1];let v,_=0,y=d-1;for(;_<=y;)if(u=Math.floor(_+(y-_)/2),v=a[u]-f,v<0)_=u+1;else{if(!(v>0)){y=u;break}y=u-1}if(u=y,a[u]===f)return u/(d-1);const E=a[u];return(u+(f-E)/(a[u+1]-E))/(d-1)}getTangent(t,i){let a=t-1e-4,u=t+1e-4;a<0&&(a=0),u>1&&(u=1);const d=this.getPoint(a),f=this.getPoint(u),v=i||(d.isVector2?new He:new mt);return v.copy(f).sub(d).normalize(),v}getTangentAt(t,i){const a=this.getUtoTmapping(t);return this.getTangent(a,i)}computeFrenetFrames(t,i){const a=new mt,u=[],d=[],f=[],v=new mt,_=new Tn;for(let P=0;P<=t;P++){const O=P/t;u[P]=this.getTangentAt(O,new mt),u[P].normalize()}d[0]=new mt,f[0]=new mt;let y=Number.MAX_VALUE;const E=Math.abs(u[0].x),A=Math.abs(u[0].y),M=Math.abs(u[0].z);E<=y&&(y=E,a.set(1,0,0)),A<=y&&(y=A,a.set(0,1,0)),M<=y&&a.set(0,0,1),v.crossVectors(u[0],a).normalize(),d[0].crossVectors(u[0],v),f[0].crossVectors(u[0],d[0]);for(let P=1;P<=t;P++){if(d[P]=d[P-1].clone(),f[P]=f[P-1].clone(),v.crossVectors(u[P-1],u[P]),v.length()>Number.EPSILON){v.normalize();const O=Math.acos(Hi(u[P-1].dot(u[P]),-1,1));d[P].applyMatrix4(_.makeRotationAxis(v,O))}f[P].crossVectors(u[P],d[P])}if(i===!0){let P=Math.acos(Hi(d[0].dot(d[t]),-1,1));P/=t,u[0].dot(v.crossVectors(d[0],d[t]))>0&&(P=-P);for(let O=1;O<=t;O++)d[O].applyMatrix4(_.makeRotationAxis(u[O],P*O)),f[O].crossVectors(u[O],d[O])}return{tangents:u,normals:d,binormals:f}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class fr extends Cn{constructor(t=0,i=0,a=1,u=1,d=0,f=2*Math.PI,v=!1,_=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=i,this.xRadius=a,this.yRadius=u,this.aStartAngle=d,this.aEndAngle=f,this.aClockwise=v,this.aRotation=_}getPoint(t,i){const a=i||new He,u=2*Math.PI;let d=this.aEndAngle-this.aStartAngle;const f=Math.abs(d)<Number.EPSILON;for(;d<0;)d+=u;for(;d>u;)d-=u;d<Number.EPSILON&&(d=f?0:u),this.aClockwise!==!0||f||(d===u?d=-u:d-=u);const v=this.aStartAngle+t*d;let _=this.aX+this.xRadius*Math.cos(v),y=this.aY+this.yRadius*Math.sin(v);if(this.aRotation!==0){const E=Math.cos(this.aRotation),A=Math.sin(this.aRotation),M=_-this.aX,P=y-this.aY;_=M*E-P*A+this.aX,y=M*A+P*E+this.aY}return a.set(_,y)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}fr.prototype.isEllipseCurve=!0;class Mn extends fr{constructor(t,i,a,u,d,f){super(t,i,a,a,u,d,f),this.type="ArcCurve"}}function Wn(){let m=0,t=0,i=0,a=0;function u(d,f,v,_){m=d,t=v,i=-3*d+3*f-2*v-_,a=2*d-2*f+v+_}return{initCatmullRom:function(d,f,v,_,y){u(f,v,y*(v-d),y*(_-f))},initNonuniformCatmullRom:function(d,f,v,_,y,E,A){let M=(f-d)/y-(v-d)/(y+E)+(v-f)/E,P=(v-f)/E-(_-f)/(E+A)+(_-v)/A;M*=E,P*=E,u(f,v,M,P)},calc:function(d){const f=d*d;return m+t*d+i*f+a*(f*d)}}}Mn.prototype.isArcCurve=!0;const Fi=new mt,gi=new Wn,Ns=new Wn,Mi=new Wn;class $s extends Cn{constructor(t=[],i=!1,a="centripetal",u=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=i,this.curveType=a,this.tension=u}getPoint(t,i=new mt){const a=i,u=this.points,d=u.length,f=(d-(this.closed?0:1))*t;let v,_,y=Math.floor(f),E=f-y;this.closed?y+=y>0?0:(Math.floor(Math.abs(y)/d)+1)*d:E===0&&y===d-1&&(y=d-2,E=1),this.closed||y>0?v=u[(y-1)%d]:(Fi.subVectors(u[0],u[1]).add(u[0]),v=Fi);const A=u[y%d],M=u[(y+1)%d];if(this.closed||y+2<d?_=u[(y+2)%d]:(Fi.subVectors(u[d-1],u[d-2]).add(u[d-1]),_=Fi),this.curveType==="centripetal"||this.curveType==="chordal"){const P=this.curveType==="chordal"?.5:.25;let O=Math.pow(v.distanceToSquared(A),P),U=Math.pow(A.distanceToSquared(M),P),D=Math.pow(M.distanceToSquared(_),P);U<1e-4&&(U=1),O<1e-4&&(O=U),D<1e-4&&(D=U),gi.initNonuniformCatmullRom(v.x,A.x,M.x,_.x,O,U,D),Ns.initNonuniformCatmullRom(v.y,A.y,M.y,_.y,O,U,D),Mi.initNonuniformCatmullRom(v.z,A.z,M.z,_.z,O,U,D)}else this.curveType==="catmullrom"&&(gi.initCatmullRom(v.x,A.x,M.x,_.x,this.tension),Ns.initCatmullRom(v.y,A.y,M.y,_.y,this.tension),Mi.initCatmullRom(v.z,A.z,M.z,_.z,this.tension));return a.set(gi.calc(E),Ns.calc(E),Mi.calc(E)),a}copy(t){super.copy(t),this.points=[];for(let i=0,a=t.points.length;i<a;i++){const u=t.points[i];this.points.push(u.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let i=0,a=this.points.length;i<a;i++){const u=this.points[i];t.points.push(u.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let i=0,a=t.points.length;i<a;i++){const u=t.points[i];this.points.push(new mt().fromArray(u))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Va(m,t,i,a,u){const d=.5*(a-t),f=.5*(u-i),v=m*m;return(2*i-2*a+d+f)*(m*v)+(-3*i+3*a-2*d-f)*v+d*m+i}function ms(m,t,i,a){return function(u,d){const f=1-u;return f*f*d}(m,t)+function(u,d){return 2*(1-u)*u*d}(m,i)+function(u,d){return u*u*d}(m,a)}function yu(m,t,i,a,u){return function(d,f){const v=1-d;return v*v*v*f}(m,t)+function(d,f){const v=1-d;return 3*v*v*d*f}(m,i)+function(d,f){return 3*(1-d)*d*d*f}(m,a)+function(d,f){return d*d*d*f}(m,u)}$s.prototype.isCatmullRomCurve3=!0;class Wa extends Cn{constructor(t=new He,i=new He,a=new He,u=new He){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=i,this.v2=a,this.v3=u}getPoint(t,i=new He){const a=i,u=this.v0,d=this.v1,f=this.v2,v=this.v3;return a.set(yu(t,u.x,d.x,f.x,v.x),yu(t,u.y,d.y,f.y,v.y)),a}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Wa.prototype.isCubicBezierCurve=!0;class va extends Cn{constructor(t=new mt,i=new mt,a=new mt,u=new mt){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=i,this.v2=a,this.v3=u}getPoint(t,i=new mt){const a=i,u=this.v0,d=this.v1,f=this.v2,v=this.v3;return a.set(yu(t,u.x,d.x,f.x,v.x),yu(t,u.y,d.y,f.y,v.y),yu(t,u.z,d.z,f.z,v.z)),a}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}va.prototype.isCubicBezierCurve3=!0;class Jl extends Cn{constructor(t=new He,i=new He){super(),this.type="LineCurve",this.v1=t,this.v2=i}getPoint(t,i=new He){const a=i;return t===1?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(t).add(this.v1)),a}getPointAt(t,i){return this.getPoint(t,i)}getTangent(t,i){const a=i||new He;return a.copy(this.v2).sub(this.v1).normalize(),a}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Jl.prototype.isLineCurve=!0;class Vc extends Cn{constructor(t=new mt,i=new mt){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=i}getPoint(t,i=new mt){const a=i;return t===1?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(t).add(this.v1)),a}getPointAt(t,i){return this.getPoint(t,i)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class il extends Cn{constructor(t=new He,i=new He,a=new He){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=i,this.v2=a}getPoint(t,i=new He){const a=i,u=this.v0,d=this.v1,f=this.v2;return a.set(ms(t,u.x,d.x,f.x),ms(t,u.y,d.y,f.y)),a}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}il.prototype.isQuadraticBezierCurve=!0;class jh extends Cn{constructor(t=new mt,i=new mt,a=new mt){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=i,this.v2=a}getPoint(t,i=new mt){const a=i,u=this.v0,d=this.v1,f=this.v2;return a.set(ms(t,u.x,d.x,f.x),ms(t,u.y,d.y,f.y),ms(t,u.z,d.z,f.z)),a}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}jh.prototype.isQuadraticBezierCurve3=!0;class ol extends Cn{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,i=new He){const a=i,u=this.points,d=(u.length-1)*t,f=Math.floor(d),v=d-f,_=u[f===0?f:f-1],y=u[f],E=u[f>u.length-2?u.length-1:f+1],A=u[f>u.length-3?u.length-1:f+2];return a.set(Va(v,_.x,y.x,E.x,A.x),Va(v,_.y,y.y,E.y,A.y)),a}copy(t){super.copy(t),this.points=[];for(let i=0,a=t.points.length;i<a;i++){const u=t.points[i];this.points.push(u.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let i=0,a=this.points.length;i<a;i++){const u=this.points[i];t.points.push(u.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let i=0,a=t.points.length;i<a;i++){const u=t.points[i];this.points.push(new He().fromArray(u))}return this}}ol.prototype.isSplineCurve=!0;var $l=Object.freeze({__proto__:null,ArcCurve:Mn,CatmullRomCurve3:$s,CubicBezierCurve:Wa,CubicBezierCurve3:va,EllipseCurve:fr,LineCurve:Jl,LineCurve3:Vc,QuadraticBezierCurve:il,QuadraticBezierCurve3:jh,SplineCurve:ol});const Uf=function(m,t,i=2){const a=t&&t.length,u=a?t[0]*i:m.length;let d=Vh(m,0,u,i,!0);const f=[];if(!d||d.next===d.prev)return f;let v,_,y,E,A,M,P;if(a&&(d=function(O,U,D,Z){const rt=[];let gt,pt,Mt,At,Et;for(gt=0,pt=U.length;gt<pt;gt++)Mt=U[gt]*Z,At=gt<pt-1?U[gt+1]*Z:O.length,Et=Vh(O,Mt,At,Z,!1),Et===Et.next&&(Et.steiner=!0),rt.push(rm(Et));for(rt.sort(Pm),gt=0;gt<rt.length;gt++)Wc(rt[gt],D),D=$o(D,D.next);return D}(m,t,d,i)),m.length>80*i){v=y=m[0],_=E=m[1];for(let O=i;O<u;O+=i)A=m[O],M=m[O+1],A<v&&(v=A),M<_&&(_=M),A>y&&(y=A),M>E&&(E=M);P=Math.max(y-v,E-_),P=P!==0?1/P:0}return nf(d,f,i,v,_,P),f};function Vh(m,t,i,a,u){let d,f;if(u===function(v,_,y,E){let A=0;for(let M=_,P=y-E;M<y;M+=E)A+=(v[P]-v[M])*(v[M+1]+v[P+1]),P=M;return A}(m,t,i,a)>0)for(d=t;d<i;d+=a)f=Qo(d,m[d],m[d+1],f);else for(d=i-a;d>=t;d-=a)f=Qo(d,m[d],m[d+1],f);return f&&kf(f,f.next)&&(Kl(f),f=f.next),f}function $o(m,t){if(!m)return m;t||(t=m);let i,a=m;do if(i=!1,a.steiner||!kf(a,a.next)&&Ai(a.prev,a,a.next)!==0)a=a.next;else{if(Kl(a),a=t=a.prev,a===a.next)break;i=!0}while(i||a!==t);return t}function nf(m,t,i,a,u,d,f){if(!m)return;!f&&d&&function(E,A,M,P){let O=E;do O.z===null&&(O.z=bp(O.x,O.y,A,M,P)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==E);O.prevZ.nextZ=null,O.prevZ=null,function(U){let D,Z,rt,gt,pt,Mt,At,Et,Lt=1;do{for(Z=U,U=null,pt=null,Mt=0;Z;){for(Mt++,rt=Z,At=0,D=0;D<Lt&&(At++,rt=rt.nextZ,rt);D++);for(Et=Lt;At>0||Et>0&&rt;)At!==0&&(Et===0||!rt||Z.z<=rt.z)?(gt=Z,Z=Z.nextZ,At--):(gt=rt,rt=rt.nextZ,Et--),pt?pt.nextZ=gt:U=gt,gt.prevZ=pt,pt=gt;Z=rt}pt.nextZ=null,Lt*=2}while(Mt>1)}(O)}(m,a,u,d);let v,_,y=m;for(;m.prev!==m.next;)if(v=m.prev,_=m.next,d?tm(m,a,u,d):Am(m))t.push(v.i/i),t.push(m.i/i),t.push(_.i/i),Kl(m),m=_.next,y=_.next;else if((m=_)===y){f?f===1?nf(m=em($o(m),t,i),t,i,a,u,d,2):f===2&&xp(m,t,i,a,u,d):nf($o(m),t,i,a,u,d,1);break}}function Am(m){const t=m.prev,i=m,a=m.next;if(Ai(t,i,a)>=0)return!1;let u=m.next.next;for(;u!==m.prev;){if(Xc(t.x,t.y,i.x,i.y,a.x,a.y,u.x,u.y)&&Ai(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function tm(m,t,i,a){const u=m.prev,d=m,f=m.next;if(Ai(u,d,f)>=0)return!1;const v=u.x<d.x?u.x<f.x?u.x:f.x:d.x<f.x?d.x:f.x,_=u.y<d.y?u.y<f.y?u.y:f.y:d.y<f.y?d.y:f.y,y=u.x>d.x?u.x>f.x?u.x:f.x:d.x>f.x?d.x:f.x,E=u.y>d.y?u.y>f.y?u.y:f.y:d.y>f.y?d.y:f.y,A=bp(v,_,t,i,a),M=bp(y,E,t,i,a);let P=m.prevZ,O=m.nextZ;for(;P&&P.z>=A&&O&&O.z<=M;){if(P!==m.prev&&P!==m.next&&Xc(u.x,u.y,d.x,d.y,f.x,f.y,P.x,P.y)&&Ai(P.prev,P,P.next)>=0||(P=P.prevZ,O!==m.prev&&O!==m.next&&Xc(u.x,u.y,d.x,d.y,f.x,f.y,O.x,O.y)&&Ai(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;P&&P.z>=A;){if(P!==m.prev&&P!==m.next&&Xc(u.x,u.y,d.x,d.y,f.x,f.y,P.x,P.y)&&Ai(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;O&&O.z<=M;){if(O!==m.prev&&O!==m.next&&Xc(u.x,u.y,d.x,d.y,f.x,f.y,O.x,O.y)&&Ai(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function em(m,t,i){let a=m;do{const u=a.prev,d=a.next.next;!kf(u,d)&&qc(u,a,a.next,d)&&Yc(u,d)&&Yc(d,u)&&(t.push(u.i/i),t.push(a.i/i),t.push(d.i/i),Kl(a),Kl(a.next),a=m=d),a=a.next}while(a!==m);return $o(a)}function xp(m,t,i,a,u,d){let f=m;do{let v=f.next.next;for(;v!==f.prev;){if(f.i!==v.i&&Ko(f,v)){let _=wp(f,v);return f=$o(f,f.next),_=$o(_,_.next),nf(f,t,i,a,u,d),void nf(_,t,i,a,u,d)}v=v.next}f=f.next}while(f!==m)}function Pm(m,t){return m.x-t.x}function Wc(m,t){if(t=function(i,a){let u=a;const d=i.x,f=i.y;let v,_=-1/0;do{if(f<=u.y&&f>=u.next.y&&u.next.y!==u.y){const O=u.x+(f-u.y)*(u.next.x-u.x)/(u.next.y-u.y);if(O<=d&&O>_){if(_=O,O===d){if(f===u.y)return u;if(f===u.next.y)return u.next}v=u.x<u.next.x?u:u.next}}u=u.next}while(u!==a);if(!v)return null;if(d===_)return v;const y=v,E=v.x,A=v.y;let M,P=1/0;u=v;do d>=u.x&&u.x>=E&&d!==u.x&&Xc(f<A?d:_,f,E,A,f<A?_:d,f,u.x,u.y)&&(M=Math.abs(f-u.y)/(d-u.x),Yc(u,i)&&(M<P||M===P&&(u.x>v.x||u.x===v.x&&nm(v,u)))&&(v=u,P=M)),u=u.next;while(u!==y);return v}(m,t)){const i=wp(t,m);$o(t,t.next),$o(i,i.next)}}function nm(m,t){return Ai(m.prev,m,t.prev)<0&&Ai(t.next,m,m.next)<0}function bp(m,t,i,a,u){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m=32767*(m-i)*u)|m<<8))|m<<4))|m<<2))|m<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-a)*u)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function rm(m){let t=m,i=m;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==m);return i}function Xc(m,t,i,a,u,d,f,v){return(u-f)*(t-v)-(m-f)*(d-v)>=0&&(m-f)*(a-v)-(i-f)*(t-v)>=0&&(i-f)*(d-v)-(u-f)*(a-v)>=0}function Ko(m,t){return m.next.i!==t.i&&m.prev.i!==t.i&&!function(i,a){let u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==a.i&&u.next.i!==a.i&&qc(u,u.next,i,a))return!0;u=u.next}while(u!==i);return!1}(m,t)&&(Yc(m,t)&&Yc(t,m)&&function(i,a){let u=i,d=!1;const f=(i.x+a.x)/2,v=(i.y+a.y)/2;do u.y>v!=u.next.y>v&&u.next.y!==u.y&&f<(u.next.x-u.x)*(v-u.y)/(u.next.y-u.y)+u.x&&(d=!d),u=u.next;while(u!==i);return d}(m,t)&&(Ai(m.prev,m,t.prev)||Ai(m,t.prev,t))||kf(m,t)&&Ai(m.prev,m,m.next)>0&&Ai(t.prev,t,t.next)>0)}function Ai(m,t,i){return(t.y-m.y)*(i.x-t.x)-(t.x-m.x)*(i.y-t.y)}function kf(m,t){return m.x===t.x&&m.y===t.y}function qc(m,t,i,a){const u=rf(Ai(m,t,i)),d=rf(Ai(m,t,a)),f=rf(Ai(i,a,m)),v=rf(Ai(i,a,t));return u!==d&&f!==v||!(u!==0||!sl(m,i,t))||!(d!==0||!sl(m,a,t))||!(f!==0||!sl(i,m,a))||!(v!==0||!sl(i,t,a))}function sl(m,t,i){return t.x<=Math.max(m.x,i.x)&&t.x>=Math.min(m.x,i.x)&&t.y<=Math.max(m.y,i.y)&&t.y>=Math.min(m.y,i.y)}function rf(m){return m>0?1:m<0?-1:0}function Yc(m,t){return Ai(m.prev,m,m.next)<0?Ai(m,t,m.next)>=0&&Ai(m,m.prev,t)>=0:Ai(m,t,m.prev)<0||Ai(m,m.next,t)<0}function wp(m,t){const i=new Gf(m.i,m.x,m.y),a=new Gf(t.i,t.x,t.y),u=m.next,d=t.prev;return m.next=t,t.prev=m,i.next=u,u.prev=i,a.next=i,i.prev=a,d.next=a,a.prev=d,a}function Qo(m,t,i,a){const u=new Gf(m,t,i);return a?(u.next=a.next,u.prev=a,a.next.prev=u,a.next=u):(u.prev=u,u.next=u),u}function Kl(m){m.next.prev=m.prev,m.prev.next=m.next,m.prevZ&&(m.prevZ.nextZ=m.nextZ),m.nextZ&&(m.nextZ.prevZ=m.prevZ)}function Gf(m,t,i){this.i=m,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ks{static area(t){const i=t.length;let a=0;for(let u=i-1,d=0;d<i;u=d++)a+=t[u].x*t[d].y-t[d].x*t[u].y;return .5*a}static isClockWise(t){return Ks.area(t)<0}static triangulateShape(t,i){const a=[],u=[],d=[];Hf(t),zf(a,t);let f=t.length;i.forEach(Hf);for(let _=0;_<i.length;_++)u.push(f),f+=i[_].length,zf(a,i[_]);const v=Uf(a,u);for(let _=0;_<v.length;_+=3)d.push(v.slice(_,_+3));return d}}function Hf(m){const t=m.length;t>2&&m[t-1].equals(m[0])&&m.pop()}function zf(m,t){for(let i=0;i<t.length;i++)m.push(t[i].x),m.push(t[i].y)}class Xa extends Dn{constructor(t,i){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:i},t=Array.isArray(t)?t:[t];const a=this,u=[],d=[];for(let v=0,_=t.length;v<_;v++)f(t[v]);function f(v){const _=[],y=i.curveSegments!==void 0?i.curveSegments:12,E=i.steps!==void 0?i.steps:1;let A=i.depth!==void 0?i.depth:100,M=i.bevelEnabled===void 0||i.bevelEnabled,P=i.bevelThickness!==void 0?i.bevelThickness:6,O=i.bevelSize!==void 0?i.bevelSize:P-2,U=i.bevelOffset!==void 0?i.bevelOffset:0,D=i.bevelSegments!==void 0?i.bevelSegments:3;const Z=i.extrudePath,rt=i.UVGenerator!==void 0?i.UVGenerator:Cm;i.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),A=i.amount);let gt,pt,Mt,At,Et,Lt=!1;Z&&(gt=Z.getSpacedPoints(E),Lt=!0,M=!1,pt=Z.computeFrenetFrames(E,!1),Mt=new mt,At=new mt,Et=new mt),M||(D=0,P=0,O=0,U=0);const Ie=v.extractPoints(y);let _e=Ie.shape;const ye=Ie.holes;if(!Ks.isClockWise(_e)){_e=_e.reverse();for(let xe=0,yt=ye.length;xe<yt;xe++){const Yt=ye[xe];Ks.isClockWise(Yt)&&(ye[xe]=Yt.reverse())}}const me=Ks.triangulateShape(_e,ye),Ht=_e;for(let xe=0,yt=ye.length;xe<yt;xe++){const Yt=ye[xe];_e=_e.concat(Yt)}function ae(xe,yt,Yt){return yt||console.error("THREE.ExtrudeGeometry: vec does not exist"),yt.clone().multiplyScalar(Yt).add(xe)}const Ze=_e.length,Xe=me.length;function je(xe,yt,Yt){let Se,Ae,be;const An=xe.x-yt.x,Yn=xe.y-yt.y,Gn=Yt.x-xe.x,Sr=Yt.y-xe.y,Mr=An*An+Yn*Yn,No=An*Sr-Yn*Gn;if(Math.abs(No)>Number.EPSILON){const Pi=Math.sqrt(Mr),fl=Math.sqrt(Gn*Gn+Sr*Sr),Jp=yt.x-Yn/Pi,$p=yt.y+An/Pi,Kp=((Yt.x-Sr/fl-Jp)*Sr-(Yt.y+Gn/fl-$p)*Gn)/(An*Sr-Yn*Gn);Se=Jp+An*Kp-xe.x,Ae=$p+Yn*Kp-xe.y;const ta=Se*Se+Ae*Ae;if(ta<=2)return new He(Se,Ae);be=Math.sqrt(ta/2)}else{let Pi=!1;An>Number.EPSILON?Gn>Number.EPSILON&&(Pi=!0):An<-Number.EPSILON?Gn<-Number.EPSILON&&(Pi=!0):Math.sign(Yn)===Math.sign(Sr)&&(Pi=!0),Pi?(Se=-Yn,Ae=An,be=Math.sqrt(Mr)):(Se=An,Ae=Yn,be=Math.sqrt(Mr/2))}return new He(Se/be,Ae/be)}const gn=[];for(let xe=0,yt=Ht.length,Yt=yt-1,Se=xe+1;xe<yt;xe++,Yt++,Se++)Yt===yt&&(Yt=0),Se===yt&&(Se=0),gn[xe]=je(Ht[xe],Ht[Yt],Ht[Se]);const Sn=[];let In,Rn=gn.concat();for(let xe=0,yt=ye.length;xe<yt;xe++){const Yt=ye[xe];In=[];for(let Se=0,Ae=Yt.length,be=Ae-1,An=Se+1;Se<Ae;Se++,be++,An++)be===Ae&&(be=0),An===Ae&&(An=0),In[Se]=je(Yt[Se],Yt[be],Yt[An]);Sn.push(In),Rn=Rn.concat(In)}for(let xe=0;xe<D;xe++){const yt=xe/D,Yt=P*Math.cos(yt*Math.PI/2),Se=O*Math.sin(yt*Math.PI/2)+U;for(let Ae=0,be=Ht.length;Ae<be;Ae++){const An=ae(Ht[Ae],gn[Ae],Se);Fe(An.x,An.y,-Yt)}for(let Ae=0,be=ye.length;Ae<be;Ae++){const An=ye[Ae];In=Sn[Ae];for(let Yn=0,Gn=An.length;Yn<Gn;Yn++){const Sr=ae(An[Yn],In[Yn],Se);Fe(Sr.x,Sr.y,-Yt)}}}const Pt=O+U;for(let xe=0;xe<Ze;xe++){const yt=M?ae(_e[xe],Rn[xe],Pt):_e[xe];Lt?(At.copy(pt.normals[0]).multiplyScalar(yt.x),Mt.copy(pt.binormals[0]).multiplyScalar(yt.y),Et.copy(gt[0]).add(At).add(Mt),Fe(Et.x,Et.y,Et.z)):Fe(yt.x,yt.y,0)}for(let xe=1;xe<=E;xe++)for(let yt=0;yt<Ze;yt++){const Yt=M?ae(_e[yt],Rn[yt],Pt):_e[yt];Lt?(At.copy(pt.normals[xe]).multiplyScalar(Yt.x),Mt.copy(pt.binormals[xe]).multiplyScalar(Yt.y),Et.copy(gt[xe]).add(At).add(Mt),Fe(Et.x,Et.y,Et.z)):Fe(Yt.x,Yt.y,A/E*xe)}for(let xe=D-1;xe>=0;xe--){const yt=xe/D,Yt=P*Math.cos(yt*Math.PI/2),Se=O*Math.sin(yt*Math.PI/2)+U;for(let Ae=0,be=Ht.length;Ae<be;Ae++){const An=ae(Ht[Ae],gn[Ae],Se);Fe(An.x,An.y,A+Yt)}for(let Ae=0,be=ye.length;Ae<be;Ae++){const An=ye[Ae];In=Sn[Ae];for(let Yn=0,Gn=An.length;Yn<Gn;Yn++){const Sr=ae(An[Yn],In[Yn],Se);Lt?Fe(Sr.x,Sr.y+gt[E-1].y,gt[E-1].x+Yt):Fe(Sr.x,Sr.y,A+Yt)}}}function Ot(xe,yt){let Yt=xe.length;for(;--Yt>=0;){const Se=Yt;let Ae=Yt-1;Ae<0&&(Ae=xe.length-1);for(let be=0,An=E+2*D;be<An;be++){const Yn=Ze*be,Gn=Ze*(be+1);ce(yt+Se+Yn,yt+Ae+Yn,yt+Ae+Gn,yt+Se+Gn)}}}function Fe(xe,yt,Yt){_.push(xe),_.push(yt),_.push(Yt)}function Be(xe,yt,Yt){on(xe),on(yt),on(Yt);const Se=u.length/3,Ae=rt.generateTopUV(a,u,Se-3,Se-2,Se-1);un(Ae[0]),un(Ae[1]),un(Ae[2])}function ce(xe,yt,Yt,Se){on(xe),on(yt),on(Se),on(yt),on(Yt),on(Se);const Ae=u.length/3,be=rt.generateSideWallUV(a,u,Ae-6,Ae-3,Ae-2,Ae-1);un(be[0]),un(be[1]),un(be[3]),un(be[1]),un(be[2]),un(be[3])}function on(xe){u.push(_[3*xe+0]),u.push(_[3*xe+1]),u.push(_[3*xe+2])}function un(xe){d.push(xe.x),d.push(xe.y)}(function(){const xe=u.length/3;if(M){let yt=0,Yt=Ze*yt;for(let Se=0;Se<Xe;Se++){const Ae=me[Se];Be(Ae[2]+Yt,Ae[1]+Yt,Ae[0]+Yt)}yt=E+2*D,Yt=Ze*yt;for(let Se=0;Se<Xe;Se++){const Ae=me[Se];Be(Ae[0]+Yt,Ae[1]+Yt,Ae[2]+Yt)}}else{for(let yt=0;yt<Xe;yt++){const Yt=me[yt];Be(Yt[2],Yt[1],Yt[0])}for(let yt=0;yt<Xe;yt++){const Yt=me[yt];Be(Yt[0]+Ze*E,Yt[1]+Ze*E,Yt[2]+Ze*E)}}a.addGroup(xe,u.length/3-xe,0)})(),function(){const xe=u.length/3;let yt=0;Ot(Ht,yt),yt+=Ht.length;for(let Yt=0,Se=ye.length;Yt<Se;Yt++){const Ae=ye[Yt];Ot(Ae,yt),yt+=Ae.length}a.addGroup(xe,u.length/3-xe,1)}()}this.setAttribute("position",new En(u,3)),this.setAttribute("uv",new En(d,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(i,a,u){if(u.shapes=[],Array.isArray(i))for(let d=0,f=i.length;d<f;d++){const v=i[d];u.shapes.push(v.uuid)}else u.shapes.push(i.uuid);return a.extrudePath!==void 0&&(u.options.extrudePath=a.extrudePath.toJSON()),u}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,i){const a=[];for(let d=0,f=t.shapes.length;d<f;d++){const v=i[t.shapes[d]];a.push(v)}const u=t.options.extrudePath;return u!==void 0&&(t.options.extrudePath=new $l[u.type]().fromJSON(u)),new Xa(a,t.options)}}const Cm={generateTopUV:function(m,t,i,a,u){const d=t[3*i],f=t[3*i+1],v=t[3*a],_=t[3*a+1],y=t[3*u],E=t[3*u+1];return[new He(d,f),new He(v,_),new He(y,E)]},generateSideWallUV:function(m,t,i,a,u,d){const f=t[3*i],v=t[3*i+1],_=t[3*i+2],y=t[3*a],E=t[3*a+1],A=t[3*a+2],M=t[3*u],P=t[3*u+1],O=t[3*u+2],U=t[3*d],D=t[3*d+1],Z=t[3*d+2];return Math.abs(v-E)<Math.abs(f-y)?[new He(f,1-_),new He(y,1-A),new He(M,1-O),new He(U,1-Z)]:[new He(v,1-_),new He(E,1-A),new He(P,1-O),new He(D,1-Z)]}};class qa extends xn{constructor(t=1,i=0){const a=(1+Math.sqrt(5))/2;super([-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,i),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new qa(t.radius,t.detail)}}class xu extends Dn{constructor(t,i=12,a=0,u=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:t,segments:i,phiStart:a,phiLength:u},i=Math.floor(i),u=Hi(u,0,2*Math.PI);const d=[],f=[],v=[],_=1/i,y=new mt,E=new He;for(let A=0;A<=i;A++){const M=a+A*_*u,P=Math.sin(M),O=Math.cos(M);for(let U=0;U<=t.length-1;U++)y.x=t[U].x*P,y.y=t[U].y,y.z=t[U].x*O,f.push(y.x,y.y,y.z),E.x=A/i,E.y=U/(t.length-1),v.push(E.x,E.y)}for(let A=0;A<i;A++)for(let M=0;M<t.length-1;M++){const P=M+A*t.length,O=P,U=P+t.length,D=P+t.length+1,Z=P+1;d.push(O,U,Z),d.push(U,D,Z)}if(this.setIndex(d),this.setAttribute("position",new En(f,3)),this.setAttribute("uv",new En(v,2)),this.computeVertexNormals(),u===2*Math.PI){const A=this.attributes.normal.array,M=new mt,P=new mt,O=new mt,U=i*t.length*3;for(let D=0,Z=0;D<t.length;D++,Z+=3)M.x=A[Z+0],M.y=A[Z+1],M.z=A[Z+2],P.x=A[U+Z+0],P.y=A[U+Z+1],P.z=A[U+Z+2],O.addVectors(M,P).normalize(),A[Z+0]=A[U+Z+0]=O.x,A[Z+1]=A[U+Z+1]=O.y,A[Z+2]=A[U+Z+2]=O.z}}static fromJSON(t){return new xu(t.points,t.segments,t.phiStart,t.phiLength)}}class Wh extends xn{constructor(t=1,i=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,i),this.type="OctahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new Wh(t.radius,t.detail)}}class jf extends Dn{constructor(t,i,a){super(),this.type="ParametricGeometry",this.parameters={func:t,slices:i,stacks:a};const u=[],d=[],f=[],v=[],_=1e-5,y=new mt,E=new mt,A=new mt,M=new mt,P=new mt;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const O=i+1;for(let U=0;U<=a;U++){const D=U/a;for(let Z=0;Z<=i;Z++){const rt=Z/i;t(rt,D,E),d.push(E.x,E.y,E.z),rt-_>=0?(t(rt-_,D,A),M.subVectors(E,A)):(t(rt+_,D,A),M.subVectors(A,E)),D-_>=0?(t(rt,D-_,A),P.subVectors(E,A)):(t(rt,D+_,A),P.subVectors(A,E)),y.crossVectors(M,P).normalize(),f.push(y.x,y.y,y.z),v.push(rt,D)}}for(let U=0;U<a;U++)for(let D=0;D<i;D++){const Z=U*O+D,rt=U*O+D+1,gt=(U+1)*O+D+1,pt=(U+1)*O+D;u.push(Z,rt,pt),u.push(rt,gt,pt)}this.setIndex(u),this.setAttribute("position",new En(d,3)),this.setAttribute("normal",new En(f,3)),this.setAttribute("uv",new En(v,2))}}class gs extends Dn{constructor(t=.5,i=1,a=8,u=1,d=0,f=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:i,thetaSegments:a,phiSegments:u,thetaStart:d,thetaLength:f},a=Math.max(3,a);const v=[],_=[],y=[],E=[];let A=t;const M=(i-t)/(u=Math.max(1,u)),P=new mt,O=new He;for(let U=0;U<=u;U++){for(let D=0;D<=a;D++){const Z=d+D/a*f;P.x=A*Math.cos(Z),P.y=A*Math.sin(Z),_.push(P.x,P.y,P.z),y.push(0,0,1),O.x=(P.x/i+1)/2,O.y=(P.y/i+1)/2,E.push(O.x,O.y)}A+=M}for(let U=0;U<u;U++){const D=U*(a+1);for(let Z=0;Z<a;Z++){const rt=Z+D,gt=rt,pt=rt+a+1,Mt=rt+a+2,At=rt+1;v.push(gt,pt,At),v.push(pt,Mt,At)}}this.setIndex(v),this.setAttribute("position",new En(_,3)),this.setAttribute("normal",new En(y,3)),this.setAttribute("uv",new En(E,2))}static fromJSON(t){return new gs(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class Fs extends Dn{constructor(t,i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:i};const a=[],u=[],d=[],f=[];let v=0,_=0;if(Array.isArray(t)===!1)y(t);else for(let E=0;E<t.length;E++)y(t[E]),this.addGroup(v,_,E),v+=_,_=0;function y(E){const A=u.length/3,M=E.extractPoints(i);let P=M.shape;const O=M.holes;Ks.isClockWise(P)===!1&&(P=P.reverse());for(let D=0,Z=O.length;D<Z;D++){const rt=O[D];Ks.isClockWise(rt)===!0&&(O[D]=rt.reverse())}const U=Ks.triangulateShape(P,O);for(let D=0,Z=O.length;D<Z;D++){const rt=O[D];P=P.concat(rt)}for(let D=0,Z=P.length;D<Z;D++){const rt=P[D];u.push(rt.x,rt.y,0),d.push(0,0,1),f.push(rt.x,rt.y)}for(let D=0,Z=U.length;D<Z;D++){const rt=U[D],gt=rt[0]+A,pt=rt[1]+A,Mt=rt[2]+A;a.push(gt,pt,Mt),_+=3}}this.setIndex(a),this.setAttribute("position",new En(u,3)),this.setAttribute("normal",new En(d,3)),this.setAttribute("uv",new En(f,2))}toJSON(){const t=super.toJSON();return function(i,a){if(a.shapes=[],Array.isArray(i))for(let u=0,d=i.length;u<d;u++){const f=i[u];a.shapes.push(f.uuid)}else a.shapes.push(i.uuid);return a}(this.parameters.shapes,t)}static fromJSON(t,i){const a=[];for(let u=0,d=t.shapes.length;u<d;u++){const f=i[t.shapes[u]];a.push(f)}return new Fs(a,t.curveSegments)}}class Xh extends Dn{constructor(t=1,i=8,a=6,u=0,d=2*Math.PI,f=0,v=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:i,heightSegments:a,phiStart:u,phiLength:d,thetaStart:f,thetaLength:v},i=Math.max(3,Math.floor(i)),a=Math.max(2,Math.floor(a));const _=Math.min(f+v,Math.PI);let y=0;const E=[],A=new mt,M=new mt,P=[],O=[],U=[],D=[];for(let Z=0;Z<=a;Z++){const rt=[],gt=Z/a;let pt=0;Z==0&&f==0?pt=.5/i:Z==a&&_==Math.PI&&(pt=-.5/i);for(let Mt=0;Mt<=i;Mt++){const At=Mt/i;A.x=-t*Math.cos(u+At*d)*Math.sin(f+gt*v),A.y=t*Math.cos(f+gt*v),A.z=t*Math.sin(u+At*d)*Math.sin(f+gt*v),O.push(A.x,A.y,A.z),M.copy(A).normalize(),U.push(M.x,M.y,M.z),D.push(At+pt,1-gt),rt.push(y++)}E.push(rt)}for(let Z=0;Z<a;Z++)for(let rt=0;rt<i;rt++){const gt=E[Z][rt+1],pt=E[Z][rt],Mt=E[Z+1][rt],At=E[Z+1][rt+1];(Z!==0||f>0)&&P.push(gt,pt,At),(Z!==a-1||_<Math.PI)&&P.push(pt,Mt,At)}this.setIndex(P),this.setAttribute("position",new En(O,3)),this.setAttribute("normal",new En(U,3)),this.setAttribute("uv",new En(D,2))}static fromJSON(t){return new Xh(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class qh extends xn{constructor(t=1,i=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,i),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new qh(t.radius,t.detail)}}class Vf extends Xa{constructor(t,i={}){const a=i.font;if(!a||!a.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Dn;const u=a.generateShapes(t,i.size);i.depth=i.height!==void 0?i.height:50,i.bevelThickness===void 0&&(i.bevelThickness=10),i.bevelSize===void 0&&(i.bevelSize=8),i.bevelEnabled===void 0&&(i.bevelEnabled=!1),super(u,i),this.type="TextGeometry"}}class Zc extends Dn{constructor(t=1,i=.4,a=8,u=6,d=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:i,radialSegments:a,tubularSegments:u,arc:d},a=Math.floor(a),u=Math.floor(u);const f=[],v=[],_=[],y=[],E=new mt,A=new mt,M=new mt;for(let P=0;P<=a;P++)for(let O=0;O<=u;O++){const U=O/u*d,D=P/a*Math.PI*2;A.x=(t+i*Math.cos(D))*Math.cos(U),A.y=(t+i*Math.cos(D))*Math.sin(U),A.z=i*Math.sin(D),v.push(A.x,A.y,A.z),E.x=t*Math.cos(U),E.y=t*Math.sin(U),M.subVectors(A,E).normalize(),_.push(M.x,M.y,M.z),y.push(O/u),y.push(P/a)}for(let P=1;P<=a;P++)for(let O=1;O<=u;O++){const U=(u+1)*P+O-1,D=(u+1)*(P-1)+O-1,Z=(u+1)*(P-1)+O,rt=(u+1)*P+O;f.push(U,D,rt),f.push(D,Z,rt)}this.setIndex(f),this.setAttribute("position",new En(v,3)),this.setAttribute("normal",new En(_,3)),this.setAttribute("uv",new En(y,2))}static fromJSON(t){return new Zc(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class Jc extends Dn{constructor(t=1,i=.4,a=64,u=8,d=2,f=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:i,tubularSegments:a,radialSegments:u,p:d,q:f},a=Math.floor(a),u=Math.floor(u);const v=[],_=[],y=[],E=[],A=new mt,M=new mt,P=new mt,O=new mt,U=new mt,D=new mt,Z=new mt;for(let gt=0;gt<=a;++gt){const pt=gt/a*d*Math.PI*2;rt(pt,d,f,t,P),rt(pt+.01,d,f,t,O),D.subVectors(O,P),Z.addVectors(O,P),U.crossVectors(D,Z),Z.crossVectors(U,D),U.normalize(),Z.normalize();for(let Mt=0;Mt<=u;++Mt){const At=Mt/u*Math.PI*2,Et=-i*Math.cos(At),Lt=i*Math.sin(At);A.x=P.x+(Et*Z.x+Lt*U.x),A.y=P.y+(Et*Z.y+Lt*U.y),A.z=P.z+(Et*Z.z+Lt*U.z),_.push(A.x,A.y,A.z),M.subVectors(A,P).normalize(),y.push(M.x,M.y,M.z),E.push(gt/a),E.push(Mt/u)}}for(let gt=1;gt<=a;gt++)for(let pt=1;pt<=u;pt++){const Mt=(u+1)*(gt-1)+(pt-1),At=(u+1)*gt+(pt-1),Et=(u+1)*gt+pt,Lt=(u+1)*(gt-1)+pt;v.push(Mt,At,Lt),v.push(At,Et,Lt)}function rt(gt,pt,Mt,At,Et){const Lt=Math.cos(gt),Ie=Math.sin(gt),_e=Mt/pt*gt,ye=Math.cos(_e);Et.x=At*(2+ye)*.5*Lt,Et.y=At*(2+ye)*Ie*.5,Et.z=At*Math.sin(_e)*.5}this.setIndex(v),this.setAttribute("position",new En(_,3)),this.setAttribute("normal",new En(y,3)),this.setAttribute("uv",new En(E,2))}static fromJSON(t){return new Jc(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class $c extends Dn{constructor(t,i=64,a=1,u=8,d=!1){super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:i,radius:a,radialSegments:u,closed:d};const f=t.computeFrenetFrames(i,d);this.tangents=f.tangents,this.normals=f.normals,this.binormals=f.binormals;const v=new mt,_=new mt,y=new He;let E=new mt;const A=[],M=[],P=[],O=[];function U(D){E=t.getPointAt(D/i,E);const Z=f.normals[D],rt=f.binormals[D];for(let gt=0;gt<=u;gt++){const pt=gt/u*Math.PI*2,Mt=Math.sin(pt),At=-Math.cos(pt);_.x=At*Z.x+Mt*rt.x,_.y=At*Z.y+Mt*rt.y,_.z=At*Z.z+Mt*rt.z,_.normalize(),M.push(_.x,_.y,_.z),v.x=E.x+a*_.x,v.y=E.y+a*_.y,v.z=E.z+a*_.z,A.push(v.x,v.y,v.z)}}(function(){for(let D=0;D<i;D++)U(D);U(d===!1?i:0),function(){for(let D=0;D<=i;D++)for(let Z=0;Z<=u;Z++)y.x=D/i,y.y=Z/u,P.push(y.x,y.y)}(),function(){for(let D=1;D<=i;D++)for(let Z=1;Z<=u;Z++){const rt=(u+1)*(D-1)+(Z-1),gt=(u+1)*D+(Z-1),pt=(u+1)*D+Z,Mt=(u+1)*(D-1)+Z;O.push(rt,gt,Mt),O.push(gt,pt,Mt)}}()})(),this.setIndex(O),this.setAttribute("position",new En(A,3)),this.setAttribute("normal",new En(M,3)),this.setAttribute("uv",new En(P,2))}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new $c(new $l[t.path.type]().fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class Sp extends Dn{constructor(t){if(super(),this.type="WireframeGeometry",t.isGeometry===!0)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const i=[],a=[0,0],u={},d=new mt;if(t.index!==null){const f=t.attributes.position,v=t.index;let _=t.groups;_.length===0&&(_=[{start:0,count:v.count,materialIndex:0}]);for(let y=0,E=_.length;y<E;++y){const A=_[y],M=A.start;for(let P=M,O=M+A.count;P<O;P+=3)for(let U=0;U<3;U++){const D=v.getX(P+U),Z=v.getX(P+(U+1)%3);a[0]=Math.min(D,Z),a[1]=Math.max(D,Z);const rt=a[0]+","+a[1];u[rt]===void 0&&(u[rt]={index1:a[0],index2:a[1]})}}for(const y in u){const E=u[y];d.fromBufferAttribute(f,E.index1),i.push(d.x,d.y,d.z),d.fromBufferAttribute(f,E.index2),i.push(d.x,d.y,d.z)}}else{const f=t.attributes.position;for(let v=0,_=f.count/3;v<_;v++)for(let y=0;y<3;y++){const E=3*v+y;d.fromBufferAttribute(f,E),i.push(d.x,d.y,d.z);const A=3*v+(y+1)%3;d.fromBufferAttribute(f,A),i.push(d.x,d.y,d.z)}}this.setAttribute("position",new En(i,3))}}var im=Object.freeze({__proto__:null,BoxGeometry:fa,BoxBufferGeometry:fa,CircleGeometry:le,CircleBufferGeometry:le,ConeGeometry:yn,ConeBufferGeometry:yn,CylinderGeometry:Ne,CylinderBufferGeometry:Ne,DodecahedronGeometry:Bn,DodecahedronBufferGeometry:Bn,EdgesGeometry:qn,ExtrudeGeometry:Xa,ExtrudeBufferGeometry:Xa,IcosahedronGeometry:qa,IcosahedronBufferGeometry:qa,LatheGeometry:xu,LatheBufferGeometry:xu,OctahedronGeometry:Wh,OctahedronBufferGeometry:Wh,ParametricGeometry:jf,ParametricBufferGeometry:jf,PlaneGeometry:pa,PlaneBufferGeometry:pa,PolyhedronGeometry:xn,PolyhedronBufferGeometry:xn,RingGeometry:gs,RingBufferGeometry:gs,ShapeGeometry:Fs,ShapeBufferGeometry:Fs,SphereGeometry:Xh,SphereBufferGeometry:Xh,TetrahedronGeometry:qh,TetrahedronBufferGeometry:qh,TextGeometry:Vf,TextBufferGeometry:Vf,TorusGeometry:Zc,TorusBufferGeometry:Zc,TorusKnotGeometry:Jc,TorusKnotBufferGeometry:Jc,TubeGeometry:$c,TubeBufferGeometry:$c,WireframeGeometry:Sp});class Tp extends ji{constructor(t){super(),this.type="ShadowMaterial",this.color=new pn(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}Tp.prototype.isShadowMaterial=!0;class Yh extends go{constructor(t){super(t),this.type="RawShaderMaterial"}}Yh.prototype.isRawShaderMaterial=!0;class Wf extends ji{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new pn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=On,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this}}Wf.prototype.isMeshStandardMaterial=!0;class Ep extends Wf{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new He(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(i){this.reflectivity=Hi(2.5*(i-1)/(i+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new pn(1,1,1),this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new pn).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this}}Ep.prototype.isMeshPhysicalMaterial=!0;class Mp extends ji{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new pn(16777215),this.specular=new pn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=On,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=yr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}Mp.prototype.isMeshPhongMaterial=!0;class Ap extends ji{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new pn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=On,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}Ap.prototype.isMeshToonMaterial=!0;class Pp extends ji{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=On,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}Pp.prototype.isMeshNormalMaterial=!0;class Xf extends ji{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=yr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}Xf.prototype.isMeshLambertMaterial=!0;class qf extends ji{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new pn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=On,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}qf.prototype.isMeshMatcapMaterial=!0;class Cp extends ao{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}Cp.prototype.isLineDashedMaterial=!0;var Zh=Object.freeze({__proto__:null,ShadowMaterial:Tp,SpriteMaterial:so,RawShaderMaterial:Yh,ShaderMaterial:go,PointsMaterial:rl,MeshPhysicalMaterial:Ep,MeshStandardMaterial:Wf,MeshPhongMaterial:Mp,MeshToonMaterial:Ap,MeshNormalMaterial:Pp,MeshLambertMaterial:Xf,MeshDepthMaterial:jl,MeshDistanceMaterial:fs,MeshBasicMaterial:Vi,MeshMatcapMaterial:qf,LineDashedMaterial:Cp,LineBasicMaterial:ao,Material:ji});const vi={arraySlice:function(m,t,i){return vi.isTypedArray(m)?new m.constructor(m.subarray(t,i!==void 0?i:m.length)):m.slice(t,i)},convertArray:function(m,t,i){return!m||!i&&m.constructor===t?m:typeof t.BYTES_PER_ELEMENT=="number"?new t(m):Array.prototype.slice.call(m)},isTypedArray:function(m){return ArrayBuffer.isView(m)&&!(m instanceof DataView)},getKeyframeOrder:function(m){const t=m.length,i=new Array(t);for(let a=0;a!==t;++a)i[a]=a;return i.sort(function(a,u){return m[a]-m[u]}),i},sortedArray:function(m,t,i){const a=m.length,u=new m.constructor(a);for(let d=0,f=0;f!==a;++d){const v=i[d]*t;for(let _=0;_!==t;++_)u[f++]=m[v+_]}return u},flattenJSON:function(m,t,i,a){let u=1,d=m[0];for(;d!==void 0&&d[a]===void 0;)d=m[u++];if(d===void 0)return;let f=d[a];if(f!==void 0)if(Array.isArray(f))do f=d[a],f!==void 0&&(t.push(d.time),i.push.apply(i,f)),d=m[u++];while(d!==void 0);else if(f.toArray!==void 0)do f=d[a],f!==void 0&&(t.push(d.time),f.toArray(i,i.length)),d=m[u++];while(d!==void 0);else do f=d[a],f!==void 0&&(t.push(d.time),i.push(f)),d=m[u++];while(d!==void 0)},subclip:function(m,t,i,a,u=30){const d=m.clone();d.name=t;const f=[];for(let _=0;_<d.tracks.length;++_){const y=d.tracks[_],E=y.getValueSize(),A=[],M=[];for(let P=0;P<y.times.length;++P){const O=y.times[P]*u;if(!(O<i||O>=a)){A.push(y.times[P]);for(let U=0;U<E;++U)M.push(y.values[P*E+U])}}A.length!==0&&(y.times=vi.convertArray(A,y.times.constructor),y.values=vi.convertArray(M,y.values.constructor),f.push(y))}d.tracks=f;let v=1/0;for(let _=0;_<d.tracks.length;++_)v>d.tracks[_].times[0]&&(v=d.tracks[_].times[0]);for(let _=0;_<d.tracks.length;++_)d.tracks[_].shift(-1*v);return d.resetDuration(),d},makeClipAdditive:function(m,t=0,i=m,a=30){a<=0&&(a=30);const u=i.tracks.length,d=t/a;for(let f=0;f<u;++f){const v=i.tracks[f],_=v.ValueTypeName;if(_==="bool"||_==="string")continue;const y=m.tracks.find(function(Z){return Z.name===v.name&&Z.ValueTypeName===_});if(y===void 0)continue;let E=0;const A=v.getValueSize();v.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(E=A/3);let M=0;const P=y.getValueSize();y.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(M=P/3);const O=v.times.length-1;let U;if(d<=v.times[0]){const Z=E,rt=A-E;U=vi.arraySlice(v.values,Z,rt)}else if(d>=v.times[O]){const Z=O*A+E,rt=Z+A-E;U=vi.arraySlice(v.values,Z,rt)}else{const Z=v.createInterpolant(),rt=E,gt=A-E;Z.evaluate(d),U=vi.arraySlice(Z.resultBuffer,rt,gt)}_==="quaternion"&&new Xi().fromArray(U).normalize().conjugate().toArray(U);const D=y.times.length;for(let Z=0;Z<D;++Z){const rt=Z*P+M;if(_==="quaternion")Xi.multiplyQuaternionsFlat(y.values,rt,U,0,y.values,rt);else{const gt=P-2*M;for(let pt=0;pt<gt;++pt)y.values[rt+pt]-=U[pt]}}}return m.blendMode=sc,m}};class al{constructor(t,i,a,u){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=u!==void 0?u:new i.constructor(a),this.sampleValues=i,this.valueSize=a,this.settings=null,this.DefaultSettings_={}}evaluate(t){const i=this.parameterPositions;let a=this._cachedIndex,u=i[a],d=i[a-1];t:{e:{let f;n:{r:if(!(t<u)){for(let v=a+2;;){if(u===void 0){if(t<d)break r;return a=i.length,this._cachedIndex=a,this.afterEnd_(a-1,t,d)}if(a===v)break;if(d=u,u=i[++a],t<u)break e}f=i.length;break n}if(t>=d)break t;{const v=i[1];t<v&&(a=2,d=v);for(let _=a-2;;){if(d===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,u);if(a===_)break;if(u=d,d=i[--a-1],t>=d)break e}f=a,a=0}}for(;a<f;){const v=a+f>>>1;t<i[v]?f=v:a=v+1}if(u=i[a],d=i[a-1],d===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,u);if(u===void 0)return a=i.length,this._cachedIndex=a,this.afterEnd_(a-1,d,t)}this._cachedIndex=a,this.intervalChanged_(a,d,u)}return this.interpolate_(a,d,t,u)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const i=this.resultBuffer,a=this.sampleValues,u=this.valueSize,d=t*u;for(let f=0;f!==u;++f)i[f]=a[d+f];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}al.prototype.beforeStart_=al.prototype.copySampleValue_,al.prototype.afterEnd_=al.prototype.copySampleValue_;class Ya extends al{constructor(t,i,a,u){super(t,i,a,u),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ri,endingEnd:ri}}intervalChanged_(t,i,a){const u=this.parameterPositions;let d=t-2,f=t+1,v=u[d],_=u[f];if(v===void 0)switch(this.getSettings_().endingStart){case Aa:d=t,v=2*i-a;break;case Go:d=u.length-2,v=i+u[d]-u[d+1];break;default:d=t,v=a}if(_===void 0)switch(this.getSettings_().endingEnd){case Aa:f=t,_=2*a-i;break;case Go:f=1,_=a+u[1]-u[0];break;default:f=t-1,_=i}const y=.5*(a-i),E=this.valueSize;this._weightPrev=y/(i-v),this._weightNext=y/(_-a),this._offsetPrev=d*E,this._offsetNext=f*E}interpolate_(t,i,a,u){const d=this.resultBuffer,f=this.sampleValues,v=this.valueSize,_=t*v,y=_-v,E=this._offsetPrev,A=this._offsetNext,M=this._weightPrev,P=this._weightNext,O=(a-i)/(u-i),U=O*O,D=U*O,Z=-M*D+2*M*U-M*O,rt=(1+M)*D+(-1.5-2*M)*U+(-.5+M)*O+1,gt=(-1-P)*D+(1.5+P)*U+.5*O,pt=P*D-P*U;for(let Mt=0;Mt!==v;++Mt)d[Mt]=Z*f[E+Mt]+rt*f[y+Mt]+gt*f[_+Mt]+pt*f[A+Mt];return d}}class wr extends al{constructor(t,i,a,u){super(t,i,a,u)}interpolate_(t,i,a,u){const d=this.resultBuffer,f=this.sampleValues,v=this.valueSize,_=t*v,y=_-v,E=(a-i)/(u-i),A=1-E;for(let M=0;M!==v;++M)d[M]=f[y+M]*A+f[_+M]*E;return d}}class om extends al{constructor(t,i,a,u){super(t,i,a,u)}interpolate_(t){return this.copySampleValue_(t-1)}}class vs{constructor(t,i,a,u){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=vi.convertArray(i,this.TimeBufferType),this.values=vi.convertArray(a,this.ValueBufferType),this.setInterpolation(u||this.DefaultInterpolation)}static toJSON(t){const i=t.constructor;let a;if(i.toJSON!==this.toJSON)a=i.toJSON(t);else{a={name:t.name,times:vi.convertArray(t.times,Array),values:vi.convertArray(t.values,Array)};const u=t.getInterpolation();u!==t.DefaultInterpolation&&(a.interpolation=u)}return a.type=t.ValueTypeName,a}InterpolantFactoryMethodDiscrete(t){return new om(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new wr(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Ya(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let i;switch(t){case no:i=this.InterpolantFactoryMethodDiscrete;break;case El:i=this.InterpolantFactoryMethodLinear;break;case ks:i=this.InterpolantFactoryMethodSmooth}if(i===void 0){const a="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(t===this.DefaultInterpolation)throw new Error(a);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",a),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return no;case this.InterpolantFactoryMethodLinear:return El;case this.InterpolantFactoryMethodSmooth:return ks}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const i=this.times;for(let a=0,u=i.length;a!==u;++a)i[a]+=t}return this}scale(t){if(t!==1){const i=this.times;for(let a=0,u=i.length;a!==u;++a)i[a]*=t}return this}trim(t,i){const a=this.times,u=a.length;let d=0,f=u-1;for(;d!==u&&a[d]<t;)++d;for(;f!==-1&&a[f]>i;)--f;if(++f,d!==0||f!==u){d>=f&&(f=Math.max(f,1),d=f-1);const v=this.getValueSize();this.times=vi.arraySlice(a,d,f),this.values=vi.arraySlice(this.values,d*v,f*v)}return this}validate(){let t=!0;const i=this.getValueSize();i-Math.floor(i)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const a=this.times,u=this.values,d=a.length;d===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let f=null;for(let v=0;v!==d;v++){const _=a[v];if(typeof _=="number"&&isNaN(_)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,v,_),t=!1;break}if(f!==null&&f>_){console.error("THREE.KeyframeTrack: Out of order keys.",this,v,_,f),t=!1;break}f=_}if(u!==void 0&&vi.isTypedArray(u))for(let v=0,_=u.length;v!==_;++v){const y=u[v];if(isNaN(y)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,v,y),t=!1;break}}return t}optimize(){const t=vi.arraySlice(this.times),i=vi.arraySlice(this.values),a=this.getValueSize(),u=this.getInterpolation()===ks,d=t.length-1;let f=1;for(let v=1;v<d;++v){let _=!1;const y=t[v];if(y!==t[v+1]&&(v!==1||y!==t[0]))if(u)_=!0;else{const E=v*a,A=E-a,M=E+a;for(let P=0;P!==a;++P){const O=i[E+P];if(O!==i[A+P]||O!==i[M+P]){_=!0;break}}}if(_){if(v!==f){t[f]=t[v];const E=v*a,A=f*a;for(let M=0;M!==a;++M)i[A+M]=i[E+M]}++f}}if(d>0){t[f]=t[d];for(let v=d*a,_=f*a,y=0;y!==a;++y)i[_+y]=i[v+y];++f}return f!==t.length?(this.times=vi.arraySlice(t,0,f),this.values=vi.arraySlice(i,0,f*a)):(this.times=t,this.values=i),this}clone(){const t=vi.arraySlice(this.times,0),i=vi.arraySlice(this.values,0),a=new this.constructor(this.name,t,i);return a.createInterpolant=this.createInterpolant,a}}vs.prototype.TimeBufferType=Float32Array,vs.prototype.ValueBufferType=Float32Array,vs.prototype.DefaultInterpolation=El;class Qs extends vs{}Qs.prototype.ValueTypeName="bool",Qs.prototype.ValueBufferType=Array,Qs.prototype.DefaultInterpolation=no,Qs.prototype.InterpolantFactoryMethodLinear=void 0,Qs.prototype.InterpolantFactoryMethodSmooth=void 0;class Yf extends vs{}Yf.prototype.ValueTypeName="color";class Jh extends vs{}Jh.prototype.ValueTypeName="number";class Ql extends al{constructor(t,i,a,u){super(t,i,a,u)}interpolate_(t,i,a,u){const d=this.resultBuffer,f=this.sampleValues,v=this.valueSize,_=(a-i)/(u-i);let y=t*v;for(let E=y+v;y!==E;y+=4)Xi.slerpFlat(d,0,f,y-v,f,y,_);return d}}class Kc extends vs{InterpolantFactoryMethodLinear(t){return new Ql(this.times,this.values,this.getValueSize(),t)}}Kc.prototype.ValueTypeName="quaternion",Kc.prototype.DefaultInterpolation=El,Kc.prototype.InterpolantFactoryMethodSmooth=void 0;class th extends vs{}th.prototype.ValueTypeName="string",th.prototype.ValueBufferType=Array,th.prototype.DefaultInterpolation=no,th.prototype.InterpolantFactoryMethodLinear=void 0,th.prototype.InterpolantFactoryMethodSmooth=void 0;class $h extends vs{}$h.prototype.ValueTypeName="vector";class Qc{constructor(t,i=-1,a,u=iu){this.name=t,this.tracks=a,this.duration=i,this.blendMode=u,this.uuid=jo(),this.duration<0&&this.resetDuration()}static parse(t){const i=[],a=t.tracks,u=1/(t.fps||1);for(let f=0,v=a.length;f!==v;++f)i.push(sm(a[f]).scale(u));const d=new this(t.name,t.duration,i,t.blendMode);return d.uuid=t.uuid,d}static toJSON(t){const i=[],a=t.tracks,u={name:t.name,duration:t.duration,tracks:i,uuid:t.uuid,blendMode:t.blendMode};for(let d=0,f=a.length;d!==f;++d)i.push(vs.toJSON(a[d]));return u}static CreateFromMorphTargetSequence(t,i,a,u){const d=i.length,f=[];for(let v=0;v<d;v++){let _=[],y=[];_.push((v+d-1)%d,v,(v+1)%d),y.push(0,1,0);const E=vi.getKeyframeOrder(_);_=vi.sortedArray(_,1,E),y=vi.sortedArray(y,1,E),u||_[0]!==0||(_.push(d),y.push(y[0])),f.push(new Jh(".morphTargetInfluences["+i[v].name+"]",_,y).scale(1/a))}return new this(t,-1,f)}static findByName(t,i){let a=t;if(!Array.isArray(t)){const u=t;a=u.geometry&&u.geometry.animations||u.animations}for(let u=0;u<a.length;u++)if(a[u].name===i)return a[u];return null}static CreateClipsFromMorphTargetSequences(t,i,a){const u={},d=/^([\w-]*?)([\d]+)$/;for(let v=0,_=t.length;v<_;v++){const y=t[v],E=y.name.match(d);if(E&&E.length>1){const A=E[1];let M=u[A];M||(u[A]=M=[]),M.push(y)}}const f=[];for(const v in u)f.push(this.CreateFromMorphTargetSequence(v,u[v],i,a));return f}static parseAnimation(t,i){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const a=function(E,A,M,P,O){if(M.length!==0){const U=[],D=[];vi.flattenJSON(M,U,D,P),U.length!==0&&O.push(new E(A,U,D))}},u=[],d=t.name||"default",f=t.fps||30,v=t.blendMode;let _=t.length||-1;const y=t.hierarchy||[];for(let E=0;E<y.length;E++){const A=y[E].keys;if(A&&A.length!==0)if(A[0].morphTargets){const M={};let P;for(P=0;P<A.length;P++)if(A[P].morphTargets)for(let O=0;O<A[P].morphTargets.length;O++)M[A[P].morphTargets[O]]=-1;for(const O in M){const U=[],D=[];for(let Z=0;Z!==A[P].morphTargets.length;++Z){const rt=A[P];U.push(rt.time),D.push(rt.morphTarget===O?1:0)}u.push(new Jh(".morphTargetInfluence["+O+"]",U,D))}_=M.length*(f||1)}else{const M=".bones["+i[E].name+"]";a($h,M+".position",A,"pos",u),a(Kc,M+".quaternion",A,"rot",u),a($h,M+".scale",A,"scl",u)}}return u.length===0?null:new this(d,_,u,v)}resetDuration(){let t=0;for(let i=0,a=this.tracks.length;i!==a;++i){const u=this.tracks[i];t=Math.max(t,u.times[u.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let i=0;i<this.tracks.length;i++)t=t&&this.tracks[i].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let i=0;i<this.tracks.length;i++)t.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function sm(m){if(m.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Jh;case"vector":case"vector2":case"vector3":case"vector4":return $h;case"color":return Yf;case"quaternion":return Kc;case"bool":case"boolean":return Qs;case"string":return th}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(m.type);if(m.times===void 0){const i=[],a=[];vi.flattenJSON(m.keys,i,a,"value"),m.times=i,m.values=a}return t.parse!==void 0?t.parse(m):new t(m.name,m.times,m.values,m.interpolation)}const Za={enabled:!1,files:{},add:function(m,t){this.enabled!==!1&&(this.files[m]=t)},get:function(m){if(this.enabled!==!1)return this.files[m]},remove:function(m){delete this.files[m]},clear:function(){this.files={}}};class td{constructor(t,i,a){const u=this;let d=!1,f=0,v=0,_;const y=[];this.onStart=void 0,this.onLoad=t,this.onProgress=i,this.onError=a,this.itemStart=function(E){v++,d===!1&&u.onStart!==void 0&&u.onStart(E,f,v),d=!0},this.itemEnd=function(E){f++,u.onProgress!==void 0&&u.onProgress(E,f,v),f===v&&(d=!1,u.onLoad!==void 0&&u.onLoad())},this.itemError=function(E){u.onError!==void 0&&u.onError(E)},this.resolveURL=function(E){return _?_(E):E},this.setURLModifier=function(E){return _=E,this},this.addHandler=function(E,A){return y.push(E,A),this},this.removeHandler=function(E){const A=y.indexOf(E);return A!==-1&&y.splice(A,2),this},this.getHandler=function(E){for(let A=0,M=y.length;A<M;A+=2){const P=y[A],O=y[A+1];if(P.global&&(P.lastIndex=0),P.test(E))return O}return null}}}const Rp=new td;class ts{constructor(t){this.manager=t!==void 0?t:Rp,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const a=this;return new Promise(function(u,d){a.load(t,u,i,d)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Ja={};class uo extends ts{constructor(t){super(t)}load(t,i,a,u){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const d=this,f=Za.get(t);if(f!==void 0)return d.manager.itemStart(t),setTimeout(function(){i&&i(f),d.manager.itemEnd(t)},0),f;if(Ja[t]!==void 0)return void Ja[t].push({onLoad:i,onProgress:a,onError:u});const v=t.match(/^data:(.*?)(;base64)?,(.*)$/);let _;if(v){const y=v[1],E=!!v[2];let A=v[3];A=decodeURIComponent(A),E&&(A=atob(A));try{let M;const P=(this.responseType||"").toLowerCase();switch(P){case"arraybuffer":case"blob":const O=new Uint8Array(A.length);for(let D=0;D<A.length;D++)O[D]=A.charCodeAt(D);M=P==="blob"?new Blob([O.buffer],{type:y}):O.buffer;break;case"document":M=new DOMParser().parseFromString(A,y);break;case"json":M=JSON.parse(A);break;default:M=A}setTimeout(function(){i&&i(M),d.manager.itemEnd(t)},0)}catch(M){setTimeout(function(){u&&u(M),d.manager.itemError(t),d.manager.itemEnd(t)},0)}}else{Ja[t]=[],Ja[t].push({onLoad:i,onProgress:a,onError:u}),_=new XMLHttpRequest,_.open("GET",t,!0),_.addEventListener("load",function(y){const E=this.response,A=Ja[t];if(delete Ja[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Za.add(t,E);for(let M=0,P=A.length;M<P;M++){const O=A[M];O.onLoad&&O.onLoad(E)}d.manager.itemEnd(t)}else{for(let M=0,P=A.length;M<P;M++){const O=A[M];O.onError&&O.onError(y)}d.manager.itemError(t),d.manager.itemEnd(t)}},!1),_.addEventListener("progress",function(y){const E=Ja[t];for(let A=0,M=E.length;A<M;A++){const P=E[A];P.onProgress&&P.onProgress(y)}},!1),_.addEventListener("error",function(y){const E=Ja[t];delete Ja[t];for(let A=0,M=E.length;A<M;A++){const P=E[A];P.onError&&P.onError(y)}d.manager.itemError(t),d.manager.itemEnd(t)},!1),_.addEventListener("abort",function(y){const E=Ja[t];delete Ja[t];for(let A=0,M=E.length;A<M;A++){const P=E[A];P.onError&&P.onError(y)}d.manager.itemError(t),d.manager.itemEnd(t)},!1),this.responseType!==void 0&&(_.responseType=this.responseType),this.withCredentials!==void 0&&(_.withCredentials=this.withCredentials),_.overrideMimeType&&_.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const y in this.requestHeader)_.setRequestHeader(y,this.requestHeader[y]);_.send(null)}return d.manager.itemStart(t),_}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class ed extends ts{constructor(t){super(t)}load(t,i,a,u){const d=this,f=new uo(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(t,function(v){try{i(d.parse(JSON.parse(v)))}catch(_){u?u(_):console.error(_),d.manager.itemError(t)}},a,u)}parse(t){const i=[];for(let a=0;a<t.length;a++){const u=Qc.parse(t[a]);i.push(u)}return i}}class am extends ts{constructor(t){super(t)}load(t,i,a,u){const d=this,f=[],v=new It,_=new uo(this.manager);_.setPath(this.path),_.setResponseType("arraybuffer"),_.setRequestHeader(this.requestHeader),_.setWithCredentials(d.withCredentials);let y=0;function E(A){_.load(t[A],function(M){const P=d.parse(M,!0);f[A]={width:P.width,height:P.height,format:P.format,mipmaps:P.mipmaps},y+=1,y===6&&(P.mipmapCount===1&&(v.minFilter=We),v.image=f,v.format=P.format,v.needsUpdate=!0,i&&i(v))},a,u)}if(Array.isArray(t))for(let A=0,M=t.length;A<M;++A)E(A);else _.load(t,function(A){const M=d.parse(A,!0);if(M.isCubemap){const P=M.mipmaps.length/M.mipmapCount;for(let O=0;O<P;O++){f[O]={mipmaps:[]};for(let U=0;U<M.mipmapCount;U++)f[O].mipmaps.push(M.mipmaps[O*M.mipmapCount+U]),f[O].format=M.format,f[O].width=M.width,f[O].height=M.height}v.image=f}else v.image.width=M.width,v.image.height=M.height,v.mipmaps=M.mipmaps;M.mipmapCount===1&&(v.minFilter=We),v.format=M.format,v.needsUpdate=!0,i&&i(v)},a,u);return v}}class nd extends ts{constructor(t){super(t)}load(t,i,a,u){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const d=this,f=Za.get(t);if(f!==void 0)return d.manager.itemStart(t),setTimeout(function(){i&&i(f),d.manager.itemEnd(t)},0),f;const v=document.createElementNS("http://www.w3.org/1999/xhtml","img");function _(){v.removeEventListener("load",_,!1),v.removeEventListener("error",y,!1),Za.add(t,this),i&&i(this),d.manager.itemEnd(t)}function y(E){v.removeEventListener("load",_,!1),v.removeEventListener("error",y,!1),u&&u(E),d.manager.itemError(t),d.manager.itemEnd(t)}return v.addEventListener("load",_,!1),v.addEventListener("error",y,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(v.crossOrigin=this.crossOrigin),d.manager.itemStart(t),v.src=t,v}}class Ip extends ts{constructor(t){super(t)}load(t,i,a,u){const d=new Gu,f=new nd(this.manager);f.setCrossOrigin(this.crossOrigin),f.setPath(this.path);let v=0;function _(y){f.load(t[y],function(E){d.images[y]=E,v++,v===6&&(d.needsUpdate=!0,i&&i(d))},void 0,u)}for(let y=0;y<t.length;++y)_(y);return d}}class um extends ts{constructor(t){super(t)}load(t,i,a,u){const d=this,f=new ga,v=new uo(this.manager);return v.setResponseType("arraybuffer"),v.setRequestHeader(this.requestHeader),v.setPath(this.path),v.setWithCredentials(d.withCredentials),v.load(t,function(_){const y=d.parse(_);y&&(y.image!==void 0?f.image=y.image:y.data!==void 0&&(f.image.width=y.width,f.image.height=y.height,f.image.data=y.data),f.wrapS=y.wrapS!==void 0?y.wrapS:wt,f.wrapT=y.wrapT!==void 0?y.wrapT:wt,f.magFilter=y.magFilter!==void 0?y.magFilter:We,f.minFilter=y.minFilter!==void 0?y.minFilter:We,f.anisotropy=y.anisotropy!==void 0?y.anisotropy:1,y.encoding!==void 0&&(f.encoding=y.encoding),y.flipY!==void 0&&(f.flipY=y.flipY),y.format!==void 0&&(f.format=y.format),y.type!==void 0&&(f.type=y.type),y.mipmaps!==void 0&&(f.mipmaps=y.mipmaps,f.minFilter=ui),y.mipmapCount===1&&(f.minFilter=We),y.generateMipmaps!==void 0&&(f.generateMipmaps=y.generateMipmaps),f.needsUpdate=!0,i&&i(f,y))},a,u),f}}class Lp extends ts{constructor(t){super(t)}load(t,i,a,u){const d=new ii,f=new nd(this.manager);return f.setCrossOrigin(this.crossOrigin),f.setPath(this.path),f.load(t,function(v){d.image=v;const _=t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0;d.format=_?wn:Pn,d.needsUpdate=!0,i!==void 0&&i(d)},a,u),d}}class lm extends Cn{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);t.equals(i)||this.curves.push(new Jl(i,t))}getPoint(t){const i=t*this.getLength(),a=this.getCurveLengths();let u=0;for(;u<a.length;){if(a[u]>=i){const d=a[u]-i,f=this.curves[u],v=f.getLength(),_=v===0?0:1-d/v;return f.getPointAt(_)}u++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let i=0;for(let a=0,u=this.curves.length;a<u;a++)i+=this.curves[a].getLength(),t.push(i);return this.cacheLengths=t,t}getSpacedPoints(t=40){const i=[];for(let a=0;a<=t;a++)i.push(this.getPoint(a/t));return this.autoClose&&i.push(i[0]),i}getPoints(t=12){const i=[];let a;for(let u=0,d=this.curves;u<d.length;u++){const f=d[u],v=f&&f.isEllipseCurve?2*t:f&&(f.isLineCurve||f.isLineCurve3)?1:f&&f.isSplineCurve?t*f.points.length:t,_=f.getPoints(v);for(let y=0;y<_.length;y++){const E=_[y];a&&a.equals(E)||(i.push(E),a=E)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(t){super.copy(t),this.curves=[];for(let i=0,a=t.curves.length;i<a;i++){const u=t.curves[i];this.curves.push(u.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let i=0,a=this.curves.length;i<a;i++){const u=this.curves[i];t.curves.push(u.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let i=0,a=t.curves.length;i<a;i++){const u=t.curves[i];this.curves.push(new $l[u.type]().fromJSON(u))}return this}}class rd extends lm{constructor(t){super(),this.type="Path",this.currentPoint=new He,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let i=1,a=t.length;i<a;i++)this.lineTo(t[i].x,t[i].y);return this}moveTo(t,i){return this.currentPoint.set(t,i),this}lineTo(t,i){const a=new Jl(this.currentPoint.clone(),new He(t,i));return this.curves.push(a),this.currentPoint.set(t,i),this}quadraticCurveTo(t,i,a,u){const d=new il(this.currentPoint.clone(),new He(t,i),new He(a,u));return this.curves.push(d),this.currentPoint.set(a,u),this}bezierCurveTo(t,i,a,u,d,f){const v=new Wa(this.currentPoint.clone(),new He(t,i),new He(a,u),new He(d,f));return this.curves.push(v),this.currentPoint.set(d,f),this}splineThru(t){const i=[this.currentPoint.clone()].concat(t),a=new ol(i);return this.curves.push(a),this.currentPoint.copy(t[t.length-1]),this}arc(t,i,a,u,d,f){const v=this.currentPoint.x,_=this.currentPoint.y;return this.absarc(t+v,i+_,a,u,d,f),this}absarc(t,i,a,u,d,f){return this.absellipse(t,i,a,a,u,d,f),this}ellipse(t,i,a,u,d,f,v,_){const y=this.currentPoint.x,E=this.currentPoint.y;return this.absellipse(t+y,i+E,a,u,d,f,v,_),this}absellipse(t,i,a,u,d,f,v,_){const y=new fr(t,i,a,u,d,f,v,_);if(this.curves.length>0){const A=y.getPoint(0);A.equals(this.currentPoint)||this.lineTo(A.x,A.y)}this.curves.push(y);const E=y.getPoint(1);return this.currentPoint.copy(E),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class eh extends rd{constructor(t){super(t),this.uuid=jo(),this.type="Shape",this.holes=[]}getPointsHoles(t){const i=[];for(let a=0,u=this.holes.length;a<u;a++)i[a]=this.holes[a].getPoints(t);return i}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let i=0,a=t.holes.length;i<a;i++){const u=t.holes[i];this.holes.push(u.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let i=0,a=this.holes.length;i<a;i++){const u=this.holes[i];t.holes.push(u.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let i=0,a=t.holes.length;i<a;i++){const u=t.holes[i];this.holes.push(new rd().fromJSON(u))}return this}}class _a extends vr{constructor(t,i=1){super(),this.type="Light",this.color=new pn(t),this.intensity=i}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const i=super.toJSON(t);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}_a.prototype.isLight=!0;class Op extends _a{constructor(t,i,a){super(t,a),this.type="HemisphereLight",this.position.copy(vr.DefaultUp),this.updateMatrix(),this.groundColor=new pn(i)}copy(t){return _a.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}Op.prototype.isHemisphereLight=!0;const Zf=new Tn,hm=new mt,Dp=new mt;class Jf{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new He(512,512),this.map=null,this.mapPass=null,this.matrix=new Tn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Fa,this._frameExtents=new He(1,1),this._viewportCount=1,this._viewports=[new Ir(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const i=this.camera,a=this.matrix;hm.setFromMatrixPosition(t.matrixWorld),i.position.copy(hm),Dp.setFromMatrixPosition(t.target.matrixWorld),i.lookAt(Dp),i.updateMatrixWorld(),Zf.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Zf),a.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),a.multiply(i.projectionMatrix),a.multiply(i.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class $f extends Jf{constructor(){super(new to(50,1,.5,500)),this.focus=1}updateMatrices(t){const i=this.camera,a=2*zo*t.angle*this.focus,u=this.mapSize.width/this.mapSize.height,d=t.distance||i.far;a===i.fov&&u===i.aspect&&d===i.far||(i.fov=a,i.aspect=u,i.far=d,i.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}$f.prototype.isSpotLightShadow=!0;class of extends _a{constructor(t,i,a=0,u=Math.PI/3,d=0,f=1){super(t,i),this.type="SpotLight",this.position.copy(vr.DefaultUp),this.updateMatrix(),this.target=new vr,this.distance=a,this.angle=u,this.penumbra=d,this.decay=f,this.shadow=new $f}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}of.prototype.isSpotLight=!0;const Np=new Tn,sf=new mt,Fp=new mt;class af extends Jf{constructor(){super(new to(90,1,.5,500)),this._frameExtents=new He(4,2),this._viewportCount=6,this._viewports=[new Ir(2,1,1,1),new Ir(0,1,1,1),new Ir(3,1,1,1),new Ir(1,1,1,1),new Ir(3,0,1,1),new Ir(1,0,1,1)],this._cubeDirections=[new mt(1,0,0),new mt(-1,0,0),new mt(0,0,1),new mt(0,0,-1),new mt(0,1,0),new mt(0,-1,0)],this._cubeUps=[new mt(0,1,0),new mt(0,1,0),new mt(0,1,0),new mt(0,1,0),new mt(0,0,1),new mt(0,0,-1)]}updateMatrices(t,i=0){const a=this.camera,u=this.matrix,d=t.distance||a.far;d!==a.far&&(a.far=d,a.updateProjectionMatrix()),sf.setFromMatrixPosition(t.matrixWorld),a.position.copy(sf),Fp.copy(a.position),Fp.add(this._cubeDirections[i]),a.up.copy(this._cubeUps[i]),a.lookAt(Fp),a.updateMatrixWorld(),u.makeTranslation(-sf.x,-sf.y,-sf.z),Np.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Np)}}af.prototype.isPointLightShadow=!0;class Kf extends _a{constructor(t,i,a=0,u=1){super(t,i),this.type="PointLight",this.distance=a,this.decay=u,this.shadow=new af}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}Kf.prototype.isPointLight=!0;class nh extends Ol{constructor(t=-1,i=1,a=1,u=-1,d=.1,f=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=i,this.top=a,this.bottom=u,this.near=d,this.far=f,this.updateProjectionMatrix()}copy(t,i){return super.copy(t,i),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,i,a,u,d,f){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=a,this.view.offsetY=u,this.view.width=d,this.view.height=f,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),a=(this.right+this.left)/2,u=(this.top+this.bottom)/2;let d=a-t,f=a+t,v=u+i,_=u-i;if(this.view!==null&&this.view.enabled){const y=(this.right-this.left)/this.view.fullWidth/this.zoom,E=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=y*this.view.offsetX,f=d+y*this.view.width,v-=E*this.view.offsetY,_=v-E*this.view.height}this.projectionMatrix.makeOrthographic(d,f,v,_,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const i=super.toJSON(t);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}nh.prototype.isOrthographicCamera=!0;class cm extends Jf{constructor(){super(new nh(-5,5,5,-5,.5,500))}}cm.prototype.isDirectionalLightShadow=!0;class Bp extends _a{constructor(t,i){super(t,i),this.type="DirectionalLight",this.position.copy(vr.DefaultUp),this.updateMatrix(),this.target=new vr,this.shadow=new cm}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}Bp.prototype.isDirectionalLight=!0;class Up extends _a{constructor(t,i){super(t,i),this.type="AmbientLight"}}Up.prototype.isAmbientLight=!0;class kp extends _a{constructor(t,i,a=10,u=10){super(t,i),this.type="RectAreaLight",this.width=a,this.height=u}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const i=super.toJSON(t);return i.object.width=this.width,i.object.height=this.height,i}}kp.prototype.isRectAreaLight=!0;class Gp{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new mt)}set(t){for(let i=0;i<9;i++)this.coefficients[i].copy(t[i]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,i){const a=t.x,u=t.y,d=t.z,f=this.coefficients;return i.copy(f[0]).multiplyScalar(.282095),i.addScaledVector(f[1],.488603*u),i.addScaledVector(f[2],.488603*d),i.addScaledVector(f[3],.488603*a),i.addScaledVector(f[4],a*u*1.092548),i.addScaledVector(f[5],u*d*1.092548),i.addScaledVector(f[6],.315392*(3*d*d-1)),i.addScaledVector(f[7],a*d*1.092548),i.addScaledVector(f[8],.546274*(a*a-u*u)),i}getIrradianceAt(t,i){const a=t.x,u=t.y,d=t.z,f=this.coefficients;return i.copy(f[0]).multiplyScalar(.886227),i.addScaledVector(f[1],1.023328*u),i.addScaledVector(f[2],1.023328*d),i.addScaledVector(f[3],1.023328*a),i.addScaledVector(f[4],.858086*a*u),i.addScaledVector(f[5],.858086*u*d),i.addScaledVector(f[6],.743125*d*d-.247708),i.addScaledVector(f[7],.858086*a*d),i.addScaledVector(f[8],.429043*(a*a-u*u)),i}add(t){for(let i=0;i<9;i++)this.coefficients[i].add(t.coefficients[i]);return this}addScaledSH(t,i){for(let a=0;a<9;a++)this.coefficients[a].addScaledVector(t.coefficients[a],i);return this}scale(t){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(t);return this}lerp(t,i){for(let a=0;a<9;a++)this.coefficients[a].lerp(t.coefficients[a],i);return this}equals(t){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(t.coefficients[i]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,i=0){const a=this.coefficients;for(let u=0;u<9;u++)a[u].fromArray(t,i+3*u);return this}toArray(t=[],i=0){const a=this.coefficients;for(let u=0;u<9;u++)a[u].toArray(t,i+3*u);return t}static getBasisAt(t,i){const a=t.x,u=t.y,d=t.z;i[0]=.282095,i[1]=.488603*u,i[2]=.488603*d,i[3]=.488603*a,i[4]=1.092548*a*u,i[5]=1.092548*u*d,i[6]=.315392*(3*d*d-1),i[7]=1.092548*a*d,i[8]=.546274*(a*a-u*u)}}Gp.prototype.isSphericalHarmonics3=!0;class uf extends _a{constructor(t=new Gp,i=1){super(void 0,i),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const i=super.toJSON(t);return i.object.sh=this.sh.toArray(),i}}uf.prototype.isLightProbe=!0;class dm extends ts{constructor(t){super(t),this.textures={}}load(t,i,a,u){const d=this,f=new uo(d.manager);f.setPath(d.path),f.setRequestHeader(d.requestHeader),f.setWithCredentials(d.withCredentials),f.load(t,function(v){try{i(d.parse(JSON.parse(v)))}catch(_){u?u(_):console.error(_),d.manager.itemError(t)}},a,u)}parse(t){const i=this.textures;function a(d){return i[d]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",d),i[d]}const u=new Zh[t.type];if(t.uuid!==void 0&&(u.uuid=t.uuid),t.name!==void 0&&(u.name=t.name),t.color!==void 0&&u.color!==void 0&&u.color.setHex(t.color),t.roughness!==void 0&&(u.roughness=t.roughness),t.metalness!==void 0&&(u.metalness=t.metalness),t.sheen!==void 0&&(u.sheen=new pn().setHex(t.sheen)),t.emissive!==void 0&&u.emissive!==void 0&&u.emissive.setHex(t.emissive),t.specular!==void 0&&u.specular!==void 0&&u.specular.setHex(t.specular),t.shininess!==void 0&&(u.shininess=t.shininess),t.clearcoat!==void 0&&(u.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(u.clearcoatRoughness=t.clearcoatRoughness),t.transmission!==void 0&&(u.transmission=t.transmission),t.thickness!==void 0&&(u.thickness=t.thickness),t.attenuationDistance!==void 0&&(u.attenuationDistance=t.attenuationDistance),t.attenuationColor!==void 0&&u.attenuationColor!==void 0&&u.attenuationColor.setHex(t.attenuationColor),t.fog!==void 0&&(u.fog=t.fog),t.flatShading!==void 0&&(u.flatShading=t.flatShading),t.blending!==void 0&&(u.blending=t.blending),t.combine!==void 0&&(u.combine=t.combine),t.side!==void 0&&(u.side=t.side),t.shadowSide!==void 0&&(u.shadowSide=t.shadowSide),t.opacity!==void 0&&(u.opacity=t.opacity),t.transparent!==void 0&&(u.transparent=t.transparent),t.alphaTest!==void 0&&(u.alphaTest=t.alphaTest),t.depthTest!==void 0&&(u.depthTest=t.depthTest),t.depthWrite!==void 0&&(u.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(u.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(u.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(u.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(u.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(u.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(u.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(u.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(u.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(u.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(u.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(u.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(u.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(u.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(u.rotation=t.rotation),t.linewidth!==1&&(u.linewidth=t.linewidth),t.dashSize!==void 0&&(u.dashSize=t.dashSize),t.gapSize!==void 0&&(u.gapSize=t.gapSize),t.scale!==void 0&&(u.scale=t.scale),t.polygonOffset!==void 0&&(u.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(u.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(u.polygonOffsetUnits=t.polygonOffsetUnits),t.morphTargets!==void 0&&(u.morphTargets=t.morphTargets),t.morphNormals!==void 0&&(u.morphNormals=t.morphNormals),t.dithering!==void 0&&(u.dithering=t.dithering),t.alphaToCoverage!==void 0&&(u.alphaToCoverage=t.alphaToCoverage),t.premultipliedAlpha!==void 0&&(u.premultipliedAlpha=t.premultipliedAlpha),t.vertexTangents!==void 0&&(u.vertexTangents=t.vertexTangents),t.visible!==void 0&&(u.visible=t.visible),t.toneMapped!==void 0&&(u.toneMapped=t.toneMapped),t.userData!==void 0&&(u.userData=t.userData),t.vertexColors!==void 0&&(typeof t.vertexColors=="number"?u.vertexColors=t.vertexColors>0:u.vertexColors=t.vertexColors),t.uniforms!==void 0)for(const d in t.uniforms){const f=t.uniforms[d];switch(u.uniforms[d]={},f.type){case"t":u.uniforms[d].value=a(f.value);break;case"c":u.uniforms[d].value=new pn().setHex(f.value);break;case"v2":u.uniforms[d].value=new He().fromArray(f.value);break;case"v3":u.uniforms[d].value=new mt().fromArray(f.value);break;case"v4":u.uniforms[d].value=new Ir().fromArray(f.value);break;case"m3":u.uniforms[d].value=new $i().fromArray(f.value);break;case"m4":u.uniforms[d].value=new Tn().fromArray(f.value);break;default:u.uniforms[d].value=f.value}}if(t.defines!==void 0&&(u.defines=t.defines),t.vertexShader!==void 0&&(u.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(u.fragmentShader=t.fragmentShader),t.extensions!==void 0)for(const d in t.extensions)u.extensions[d]=t.extensions[d];if(t.shading!==void 0&&(u.flatShading=t.shading===1),t.size!==void 0&&(u.size=t.size),t.sizeAttenuation!==void 0&&(u.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(u.map=a(t.map)),t.matcap!==void 0&&(u.matcap=a(t.matcap)),t.alphaMap!==void 0&&(u.alphaMap=a(t.alphaMap)),t.bumpMap!==void 0&&(u.bumpMap=a(t.bumpMap)),t.bumpScale!==void 0&&(u.bumpScale=t.bumpScale),t.normalMap!==void 0&&(u.normalMap=a(t.normalMap)),t.normalMapType!==void 0&&(u.normalMapType=t.normalMapType),t.normalScale!==void 0){let d=t.normalScale;Array.isArray(d)===!1&&(d=[d,d]),u.normalScale=new He().fromArray(d)}return t.displacementMap!==void 0&&(u.displacementMap=a(t.displacementMap)),t.displacementScale!==void 0&&(u.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(u.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(u.roughnessMap=a(t.roughnessMap)),t.metalnessMap!==void 0&&(u.metalnessMap=a(t.metalnessMap)),t.emissiveMap!==void 0&&(u.emissiveMap=a(t.emissiveMap)),t.emissiveIntensity!==void 0&&(u.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(u.specularMap=a(t.specularMap)),t.envMap!==void 0&&(u.envMap=a(t.envMap)),t.envMapIntensity!==void 0&&(u.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(u.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(u.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(u.lightMap=a(t.lightMap)),t.lightMapIntensity!==void 0&&(u.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(u.aoMap=a(t.aoMap)),t.aoMapIntensity!==void 0&&(u.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(u.gradientMap=a(t.gradientMap)),t.clearcoatMap!==void 0&&(u.clearcoatMap=a(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(u.clearcoatRoughnessMap=a(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(u.clearcoatNormalMap=a(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(u.clearcoatNormalScale=new He().fromArray(t.clearcoatNormalScale)),t.transmissionMap!==void 0&&(u.transmissionMap=a(t.transmissionMap)),t.thicknessMap!==void 0&&(u.thicknessMap=a(t.thicknessMap)),u}setTextures(t){return this.textures=t,this}}class Qf{static decodeText(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);let i="";for(let a=0,u=t.length;a<u;a++)i+=String.fromCharCode(t[a]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(t){const i=t.lastIndexOf("/");return i===-1?"./":t.substr(0,i+1)}}class rh extends Dn{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}rh.prototype.isInstancedBufferGeometry=!0;class tp extends hr{constructor(t,i,a,u=1){typeof a=="number"&&(u=a,a=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,i,a),this.meshPerAttribute=u}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}tp.prototype.isInstancedBufferAttribute=!0;class id extends ts{constructor(t){super(t)}load(t,i,a,u){const d=this,f=new uo(d.manager);f.setPath(d.path),f.setRequestHeader(d.requestHeader),f.setWithCredentials(d.withCredentials),f.load(t,function(v){try{i(d.parse(JSON.parse(v)))}catch(_){u?u(_):console.error(_),d.manager.itemError(t)}},a,u)}parse(t){const i={},a={};function u(A,M){if(i[M]!==void 0)return i[M];const P=A.interleavedBuffers[M],O=function(Z,rt){if(a[rt]!==void 0)return a[rt];const gt=Z.arrayBuffers[rt],pt=new Uint32Array(gt).buffer;return a[rt]=pt,pt}(A,P.buffer),U=Xn(P.type,O),D=new Ha(U,P.stride);return D.uuid=P.uuid,i[M]=D,D}const d=t.isInstancedBufferGeometry?new rh:new Dn,f=t.data.index;if(f!==void 0){const A=Xn(f.type,f.array);d.setIndex(new hr(A,1))}const v=t.data.attributes;for(const A in v){const M=v[A];let P;if(M.isInterleavedBufferAttribute){const O=u(t.data,M.data);P=new di(O,M.itemSize,M.offset,M.normalized)}else{const O=Xn(M.type,M.array);P=new(M.isInstancedBufferAttribute?tp:hr)(O,M.itemSize,M.normalized)}M.name!==void 0&&(P.name=M.name),M.usage!==void 0&&P.setUsage(M.usage),M.updateRange!==void 0&&(P.updateRange.offset=M.updateRange.offset,P.updateRange.count=M.updateRange.count),d.setAttribute(A,P)}const _=t.data.morphAttributes;if(_)for(const A in _){const M=_[A],P=[];for(let O=0,U=M.length;O<U;O++){const D=M[O];let Z;if(D.isInterleavedBufferAttribute){const rt=u(t.data,D.data);Z=new di(rt,D.itemSize,D.offset,D.normalized)}else{const rt=Xn(D.type,D.array);Z=new hr(rt,D.itemSize,D.normalized)}D.name!==void 0&&(Z.name=D.name),P.push(Z)}d.morphAttributes[A]=P}t.data.morphTargetsRelative&&(d.morphTargetsRelative=!0);const y=t.data.groups||t.data.drawcalls||t.data.offsets;if(y!==void 0)for(let A=0,M=y.length;A!==M;++A){const P=y[A];d.addGroup(P.start,P.count,P.materialIndex)}const E=t.data.boundingSphere;if(E!==void 0){const A=new mt;E.center!==void 0&&A.fromArray(E.center),d.boundingSphere=new ws(A,E.radius)}return t.name&&(d.name=t.name),t.userData&&(d.userData=t.userData),d}}class Oe extends ts{constructor(t){super(t)}load(t,i,a,u){const d=this,f=this.path===""?Qf.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||f;const v=new uo(this.manager);v.setPath(this.path),v.setRequestHeader(this.requestHeader),v.setWithCredentials(this.withCredentials),v.load(t,function(_){let y=null;try{y=JSON.parse(_)}catch(A){return u!==void 0&&u(A),void console.error("THREE:ObjectLoader: Can't parse "+t+".",A.message)}const E=y.metadata;E!==void 0&&E.type!==void 0&&E.type.toLowerCase()!=="geometry"?d.parse(y,i):console.error("THREE.ObjectLoader: Can't load "+t)},a,u)}async loadAsync(t,i){const a=this.path===""?Qf.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||a;const u=new uo(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials);const d=await u.loadAsync(t,i),f=JSON.parse(d),v=f.metadata;if(v===void 0||v.type===void 0||v.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+t);return await this.parseAsync(f)}parse(t,i){const a=this.parseAnimations(t.animations),u=this.parseShapes(t.shapes),d=this.parseGeometries(t.geometries,u),f=this.parseImages(t.images,function(){i!==void 0&&i(y)}),v=this.parseTextures(t.textures,f),_=this.parseMaterials(t.materials,v),y=this.parseObject(t.object,d,_,v,a),E=this.parseSkeletons(t.skeletons,y);if(this.bindSkeletons(y,E),i!==void 0){let A=!1;for(const M in f)if(f[M]instanceof HTMLImageElement){A=!0;break}A===!1&&i(y)}return y}async parseAsync(t){const i=this.parseAnimations(t.animations),a=this.parseShapes(t.shapes),u=this.parseGeometries(t.geometries,a),d=await this.parseImagesAsync(t.images),f=this.parseTextures(t.textures,d),v=this.parseMaterials(t.materials,f),_=this.parseObject(t.object,u,v,f,i),y=this.parseSkeletons(t.skeletons,_);return this.bindSkeletons(_,y),_}parseShapes(t){const i={};if(t!==void 0)for(let a=0,u=t.length;a<u;a++){const d=new eh().fromJSON(t[a]);i[d.uuid]=d}return i}parseSkeletons(t,i){const a={},u={};if(i.traverse(function(d){d.isBone&&(u[d.uuid]=d)}),t!==void 0)for(let d=0,f=t.length;d<f;d++){const v=new za().fromJSON(t[d],u);a[v.uuid]=v}return a}parseGeometries(t,i){const a={};if(t!==void 0){const u=new id;for(let d=0,f=t.length;d<f;d++){let v;const _=t[d];switch(_.type){case"BufferGeometry":case"InstancedBufferGeometry":v=u.parse(_);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:_.type in im?v=im[_.type].fromJSON(_,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${_.type}"`)}v.uuid=_.uuid,_.name!==void 0&&(v.name=_.name),v.isBufferGeometry===!0&&_.userData!==void 0&&(v.userData=_.userData),a[_.uuid]=v}}return a}parseMaterials(t,i){const a={},u={};if(t!==void 0){const d=new dm;d.setTextures(i);for(let f=0,v=t.length;f<v;f++){const _=t[f];if(_.type==="MultiMaterial"){const y=[];for(let E=0;E<_.materials.length;E++){const A=_.materials[E];a[A.uuid]===void 0&&(a[A.uuid]=d.parse(A)),y.push(a[A.uuid])}u[_.uuid]=y}else a[_.uuid]===void 0&&(a[_.uuid]=d.parse(_)),u[_.uuid]=a[_.uuid]}}return u}parseAnimations(t){const i={};if(t!==void 0)for(let a=0;a<t.length;a++){const u=t[a],d=Qc.parse(u);i[d.uuid]=d}return i}parseImages(t,i){const a=this,u={};let d;function f(v){if(typeof v=="string"){const _=v;return function(y){return a.manager.itemStart(y),d.load(y,function(){a.manager.itemEnd(y)},void 0,function(){a.manager.itemError(y),a.manager.itemEnd(y)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(_)?_:a.resourcePath+_)}return v.data?{data:Xn(v.type,v.data),width:v.width,height:v.height}:null}if(t!==void 0&&t.length>0){const v=new td(i);d=new nd(v),d.setCrossOrigin(this.crossOrigin);for(let _=0,y=t.length;_<y;_++){const E=t[_],A=E.url;if(Array.isArray(A)){u[E.uuid]=[];for(let M=0,P=A.length;M<P;M++){const O=f(A[M]);O!==null&&(O instanceof HTMLImageElement?u[E.uuid].push(O):u[E.uuid].push(new ga(O.data,O.width,O.height)))}}else{const M=f(E.url);M!==null&&(u[E.uuid]=M)}}}return u}async parseImagesAsync(t){const i=this,a={};let u;async function d(f){if(typeof f=="string"){const v=f,_=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(v)?v:i.resourcePath+v;return await u.loadAsync(_)}return f.data?{data:Xn(f.type,f.data),width:f.width,height:f.height}:null}if(t!==void 0&&t.length>0){u=new nd(this.manager),u.setCrossOrigin(this.crossOrigin);for(let f=0,v=t.length;f<v;f++){const _=t[f],y=_.url;if(Array.isArray(y)){a[_.uuid]=[];for(let E=0,A=y.length;E<A;E++){const M=y[E],P=await d(M);P!==null&&(P instanceof HTMLImageElement?a[_.uuid].push(P):a[_.uuid].push(new ga(P.data,P.width,P.height)))}}else{const E=await d(_.url);E!==null&&(a[_.uuid]=E)}}}return a}parseTextures(t,i){function a(d,f){return typeof d=="number"?d:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",d),f[d])}const u={};if(t!==void 0)for(let d=0,f=t.length;d<f;d++){const v=t[d];let _;v.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',v.uuid),i[v.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",v.image);const y=i[v.image];Array.isArray(y)?(_=new Gu(y),y.length===6&&(_.needsUpdate=!0)):(_=y&&y.data?new ga(y.data,y.width,y.height):new ii(y),y&&(_.needsUpdate=!0)),_.uuid=v.uuid,v.name!==void 0&&(_.name=v.name),v.mapping!==void 0&&(_.mapping=a(v.mapping,Rm)),v.offset!==void 0&&_.offset.fromArray(v.offset),v.repeat!==void 0&&_.repeat.fromArray(v.repeat),v.center!==void 0&&_.center.fromArray(v.center),v.rotation!==void 0&&(_.rotation=v.rotation),v.wrap!==void 0&&(_.wrapS=a(v.wrap[0],od),_.wrapT=a(v.wrap[1],od)),v.format!==void 0&&(_.format=v.format),v.type!==void 0&&(_.type=v.type),v.encoding!==void 0&&(_.encoding=v.encoding),v.minFilter!==void 0&&(_.minFilter=a(v.minFilter,lf)),v.magFilter!==void 0&&(_.magFilter=a(v.magFilter,lf)),v.anisotropy!==void 0&&(_.anisotropy=v.anisotropy),v.flipY!==void 0&&(_.flipY=v.flipY),v.premultiplyAlpha!==void 0&&(_.premultiplyAlpha=v.premultiplyAlpha),v.unpackAlignment!==void 0&&(_.unpackAlignment=v.unpackAlignment),u[v.uuid]=_}return u}parseObject(t,i,a,u,d){let f,v,_;function y(M){return i[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",M),i[M]}function E(M){if(M!==void 0){if(Array.isArray(M)){const P=[];for(let O=0,U=M.length;O<U;O++){const D=M[O];a[D]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",D),P.push(a[D])}return P}return a[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",M),a[M]}}function A(M){return u[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",M),u[M]}switch(t.type){case"Scene":f=new Fh,t.background!==void 0&&(Number.isInteger(t.background)?f.background=new pn(t.background):f.background=A(t.background)),t.environment!==void 0&&(f.environment=A(t.environment)),t.fog!==void 0&&(t.fog.type==="Fog"?f.fog=new Ju(t.fog.color,t.fog.near,t.fog.far):t.fog.type==="FogExp2"&&(f.fog=new Ga(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":f=new to(t.fov,t.aspect,t.near,t.far),t.focus!==void 0&&(f.focus=t.focus),t.zoom!==void 0&&(f.zoom=t.zoom),t.filmGauge!==void 0&&(f.filmGauge=t.filmGauge),t.filmOffset!==void 0&&(f.filmOffset=t.filmOffset),t.view!==void 0&&(f.view=Object.assign({},t.view));break;case"OrthographicCamera":f=new nh(t.left,t.right,t.top,t.bottom,t.near,t.far),t.zoom!==void 0&&(f.zoom=t.zoom),t.view!==void 0&&(f.view=Object.assign({},t.view));break;case"AmbientLight":f=new Up(t.color,t.intensity);break;case"DirectionalLight":f=new Bp(t.color,t.intensity);break;case"PointLight":f=new Kf(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":f=new kp(t.color,t.intensity,t.width,t.height);break;case"SpotLight":f=new of(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":f=new Op(t.color,t.groundColor,t.intensity);break;case"LightProbe":f=new uf().fromJSON(t);break;case"SkinnedMesh":v=y(t.geometry),_=E(t.material),f=new el(v,_),t.bindMode!==void 0&&(f.bindMode=t.bindMode),t.bindMatrix!==void 0&&f.bindMatrix.fromArray(t.bindMatrix),t.skeleton!==void 0&&(f.skeleton=t.skeleton);break;case"Mesh":v=y(t.geometry),_=E(t.material),f=new mi(v,_);break;case"InstancedMesh":v=y(t.geometry),_=E(t.material);const M=t.count,P=t.instanceMatrix,O=t.instanceColor;f=new Hh(v,_,M),f.instanceMatrix=new hr(new Float32Array(P.array),16),O!==void 0&&(f.instanceColor=new hr(new Float32Array(O.array),O.itemSize));break;case"LOD":f=new kc;break;case"Line":f=new ja(y(t.geometry),E(t.material));break;case"LineLoop":f=new ef(y(t.geometry),E(t.material));break;case"LineSegments":f=new Jo(y(t.geometry),E(t.material));break;case"PointCloud":case"Points":f=new W(y(t.geometry),E(t.material));break;case"Sprite":f=new Uh(E(t.material));break;case"Group":f=new Zs;break;case"Bone":f=new Yi;break;default:f=new vr}if(f.uuid=t.uuid,t.name!==void 0&&(f.name=t.name),t.matrix!==void 0?(f.matrix.fromArray(t.matrix),t.matrixAutoUpdate!==void 0&&(f.matrixAutoUpdate=t.matrixAutoUpdate),f.matrixAutoUpdate&&f.matrix.decompose(f.position,f.quaternion,f.scale)):(t.position!==void 0&&f.position.fromArray(t.position),t.rotation!==void 0&&f.rotation.fromArray(t.rotation),t.quaternion!==void 0&&f.quaternion.fromArray(t.quaternion),t.scale!==void 0&&f.scale.fromArray(t.scale)),t.castShadow!==void 0&&(f.castShadow=t.castShadow),t.receiveShadow!==void 0&&(f.receiveShadow=t.receiveShadow),t.shadow&&(t.shadow.bias!==void 0&&(f.shadow.bias=t.shadow.bias),t.shadow.normalBias!==void 0&&(f.shadow.normalBias=t.shadow.normalBias),t.shadow.radius!==void 0&&(f.shadow.radius=t.shadow.radius),t.shadow.mapSize!==void 0&&f.shadow.mapSize.fromArray(t.shadow.mapSize),t.shadow.camera!==void 0&&(f.shadow.camera=this.parseObject(t.shadow.camera))),t.visible!==void 0&&(f.visible=t.visible),t.frustumCulled!==void 0&&(f.frustumCulled=t.frustumCulled),t.renderOrder!==void 0&&(f.renderOrder=t.renderOrder),t.userData!==void 0&&(f.userData=t.userData),t.layers!==void 0&&(f.layers.mask=t.layers),t.children!==void 0){const M=t.children;for(let P=0;P<M.length;P++)f.add(this.parseObject(M[P],i,a,u,d))}if(t.animations!==void 0){const M=t.animations;for(let P=0;P<M.length;P++){const O=M[P];f.animations.push(d[O])}}if(t.type==="LOD"){t.autoUpdate!==void 0&&(f.autoUpdate=t.autoUpdate);const M=t.levels;for(let P=0;P<M.length;P++){const O=M[P],U=f.getObjectByProperty("uuid",O.object);U!==void 0&&f.addLevel(U,O.distance)}}return f}bindSkeletons(t,i){Object.keys(i).length!==0&&t.traverse(function(a){if(a.isSkinnedMesh===!0&&a.skeleton!==void 0){const u=i[a.skeleton];u===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",a.skeleton):a.bind(u,a.bindMatrix)}})}setTexturePath(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}const Rm={UVMapping:ki,CubeReflectionMapping:L,CubeRefractionMapping:k,EquirectangularReflectionMapping:G,EquirectangularRefractionMapping:st,CubeUVReflectionMapping:K,CubeUVRefractionMapping:et},od={RepeatWrapping:vt,ClampToEdgeWrapping:wt,MirroredRepeatWrapping:Ct},lf={NearestFilter:St,NearestMipmapNearestFilter:Ut,NearestMipmapLinearFilter:Vt,LinearFilter:We,LinearMipmapNearestFilter:sr,LinearMipmapLinearFilter:ui};class ep extends ts{constructor(t){super(t),typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,i,a,u){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const d=this,f=Za.get(t);if(f!==void 0)return d.manager.itemStart(t),setTimeout(function(){i&&i(f),d.manager.itemEnd(t)},0),f;const v={};v.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",v.headers=this.requestHeader,fetch(t,v).then(function(_){return _.blob()}).then(function(_){return createImageBitmap(_,Object.assign(d.options,{colorSpaceConversion:"none"}))}).then(function(_){Za.add(t,_),i&&i(_),d.manager.itemEnd(t)}).catch(function(_){u&&u(_),d.manager.itemError(t),d.manager.itemEnd(t)}),d.manager.itemStart(t)}}ep.prototype.isImageBitmapLoader=!0;class Hp{constructor(){this.type="ShapePath",this.color=new pn,this.subPaths=[],this.currentPath=null}moveTo(t,i){return this.currentPath=new rd,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,i),this}lineTo(t,i){return this.currentPath.lineTo(t,i),this}quadraticCurveTo(t,i,a,u){return this.currentPath.quadraticCurveTo(t,i,a,u),this}bezierCurveTo(t,i,a,u,d,f){return this.currentPath.bezierCurveTo(t,i,a,u,d,f),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t,i){function a(rt){const gt=[];for(let pt=0,Mt=rt.length;pt<Mt;pt++){const At=rt[pt],Et=new eh;Et.curves=At.curves,gt.push(Et)}return gt}function u(rt,gt){const pt=gt.length;let Mt=!1;for(let At=pt-1,Et=0;Et<pt;At=Et++){let Lt=gt[At],Ie=gt[Et],_e=Ie.x-Lt.x,ye=Ie.y-Lt.y;if(Math.abs(ye)>Number.EPSILON){if(ye<0&&(Lt=gt[Et],_e=-_e,Ie=gt[At],ye=-ye),rt.y<Lt.y||rt.y>Ie.y)continue;if(rt.y===Lt.y){if(rt.x===Lt.x)return!0}else{const me=ye*(rt.x-Lt.x)-_e*(rt.y-Lt.y);if(me===0)return!0;if(me<0)continue;Mt=!Mt}}else{if(rt.y!==Lt.y)continue;if(Ie.x<=rt.x&&rt.x<=Lt.x||Lt.x<=rt.x&&rt.x<=Ie.x)return!0}}return Mt}const d=Ks.isClockWise,f=this.subPaths;if(f.length===0)return[];if(i===!0)return a(f);let v,_,y;const E=[];if(f.length===1)return _=f[0],y=new eh,y.curves=_.curves,E.push(y),E;let A=!d(f[0].getPoints());A=t?!A:A;const M=[],P=[];let O,U,D=[],Z=0;P[Z]=void 0,D[Z]=[];for(let rt=0,gt=f.length;rt<gt;rt++)_=f[rt],O=_.getPoints(),v=d(O),v=t?!v:v,v?(!A&&P[Z]&&Z++,P[Z]={s:new eh,p:O},P[Z].s.curves=_.curves,A&&Z++,D[Z]=[]):D[Z].push({h:_,p:O[0]});if(!P[0])return a(f);if(P.length>1){let rt=!1;const gt=[];for(let pt=0,Mt=P.length;pt<Mt;pt++)M[pt]=[];for(let pt=0,Mt=P.length;pt<Mt;pt++){const At=D[pt];for(let Et=0;Et<At.length;Et++){const Lt=At[Et];let Ie=!0;for(let _e=0;_e<P.length;_e++)u(Lt.p,P[_e].p)&&(pt!==_e&&gt.push({froms:pt,tos:_e,hole:Et}),Ie?(Ie=!1,M[_e].push(Lt)):rt=!0);Ie&&M[pt].push(Lt)}}gt.length>0&&(rt||(D=M))}for(let rt=0,gt=P.length;rt<gt;rt++){y=P[rt].s,E.push(y),U=D[rt];for(let pt=0,Mt=U.length;pt<Mt;pt++)y.holes.push(U[pt].h)}return E}}class sd{constructor(t){this.type="Font",this.data=t}generateShapes(t,i=100){const a=[],u=function(d,f,v){const _=Array.from(d),y=f/v.resolution,E=(v.boundingBox.yMax-v.boundingBox.yMin+v.underlineThickness)*y,A=[];let M=0,P=0;for(let O=0;O<_.length;O++){const U=_[O];if(U===`
`)M=0,P-=E;else{const D=Im(U,y,M,P,v);M+=D.offsetX,A.push(D.path)}}return A}(t,i,this.data);for(let d=0,f=u.length;d<f;d++)Array.prototype.push.apply(a,u[d].toShapes());return a}}function Im(m,t,i,a,u){const d=u.glyphs[m]||u.glyphs["?"];if(!d)return void console.error('THREE.Font: character "'+m+'" does not exists in font family '+u.familyName+".");const f=new Hp;let v,_,y,E,A,M,P,O;if(d.o){const U=d._cachedOutline||(d._cachedOutline=d.o.split(" "));for(let D=0,Z=U.length;D<Z;)switch(U[D++]){case"m":v=U[D++]*t+i,_=U[D++]*t+a,f.moveTo(v,_);break;case"l":v=U[D++]*t+i,_=U[D++]*t+a,f.lineTo(v,_);break;case"q":y=U[D++]*t+i,E=U[D++]*t+a,A=U[D++]*t+i,M=U[D++]*t+a,f.quadraticCurveTo(A,M,y,E);break;case"b":y=U[D++]*t+i,E=U[D++]*t+a,A=U[D++]*t+i,M=U[D++]*t+a,P=U[D++]*t+i,O=U[D++]*t+a,f.bezierCurveTo(A,M,P,O,y,E)}}return{offsetX:d.ha*t,path:f}}sd.prototype.isFont=!0;class $a extends ts{constructor(t){super(t)}load(t,i,a,u){const d=this,f=new uo(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(d.withCredentials),f.load(t,function(v){let _;try{_=JSON.parse(v)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),_=JSON.parse(v.substring(65,v.length-2))}const y=d.parse(_);i&&i(y)},a,u)}parse(t){return new sd(t)}}let Bs;const bu={getContext:function(){return Bs===void 0&&(Bs=new(window.AudioContext||window.webkitAudioContext)),Bs},setContext:function(m){Bs=m}};class ul extends ts{constructor(t){super(t)}load(t,i,a,u){const d=this,f=new uo(this.manager);f.setResponseType("arraybuffer"),f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(t,function(v){try{const _=v.slice(0);bu.getContext().decodeAudioData(_,function(y){i(y)})}catch(_){u?u(_):console.error(_),d.manager.itemError(t)}},a,u)}}class ll extends uf{constructor(t,i,a=1){super(void 0,a);const u=new pn().set(t),d=new pn().set(i),f=new mt(u.r,u.g,u.b),v=new mt(d.r,d.g,d.b),_=Math.sqrt(Math.PI),y=_*Math.sqrt(.75);this.sh.coefficients[0].copy(f).add(v).multiplyScalar(_),this.sh.coefficients[1].copy(f).sub(v).multiplyScalar(y)}}ll.prototype.isHemisphereLightProbe=!0;class _o extends uf{constructor(t,i=1){super(void 0,i);const a=new pn().set(t);this.sh.coefficients[0].set(a.r,a.g,a.b).multiplyScalar(2*Math.sqrt(Math.PI))}}_o.prototype.isAmbientLightProbe=!0;const np=new Tn,rp=new Tn;class Kh{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new to,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new to,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const i=this._cache;if(i.focus!==t.focus||i.fov!==t.fov||i.aspect!==t.aspect*this.aspect||i.near!==t.near||i.far!==t.far||i.zoom!==t.zoom||i.eyeSep!==this.eyeSep){i.focus=t.focus,i.fov=t.fov,i.aspect=t.aspect*this.aspect,i.near=t.near,i.far=t.far,i.zoom=t.zoom,i.eyeSep=this.eyeSep;const a=t.projectionMatrix.clone(),u=i.eyeSep/2,d=u*i.near/i.focus,f=i.near*Math.tan(ia*i.fov*.5)/i.zoom;let v,_;rp.elements[12]=-u,np.elements[12]=u,v=-f*i.aspect+d,_=f*i.aspect+d,a.elements[0]=2*i.near/(_-v),a.elements[8]=(_+v)/(_-v),this.cameraL.projectionMatrix.copy(a),v=-f*i.aspect-d,_=f*i.aspect-d,a.elements[0]=2*i.near/(_-v),a.elements[8]=(_+v)/(_-v),this.cameraR.projectionMatrix.copy(a)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(rp),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(np)}}class zp{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=fm(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=fm();t=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=t}return t}}function fm(){return(typeof performance=="undefined"?Date:performance).now()}const es=new mt,Qt=new Xi,pm=new mt,Qh=new mt;class Lm extends vr{constructor(){super(),this.type="AudioListener",this.context=bu.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new zp}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const i=this.context.listener,a=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(es,Qt,pm),Qh.set(0,0,-1).applyQuaternion(Qt),i.positionX){const u=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(es.x,u),i.positionY.linearRampToValueAtTime(es.y,u),i.positionZ.linearRampToValueAtTime(es.z,u),i.forwardX.linearRampToValueAtTime(Qh.x,u),i.forwardY.linearRampToValueAtTime(Qh.y,u),i.forwardZ.linearRampToValueAtTime(Qh.z,u),i.upX.linearRampToValueAtTime(a.x,u),i.upY.linearRampToValueAtTime(a.y,u),i.upZ.linearRampToValueAtTime(a.z,u)}else i.setPosition(es.x,es.y,es.z),i.setOrientation(Qh.x,Qh.y,Qh.z,a.x,a.y,a.z)}}class ip extends vr{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,i=this.filters.length;t<i;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,i=this.filters.length;t<i;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),this._connected===!0?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl!==!1)return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(this.hasPlaybackControl!==!1)return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const ih=new mt,hf=new Xi,mm=new mt,hl=new mt;class gm extends ip{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,i,a){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=a,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(ih,hf,mm),hl.set(0,0,1).applyQuaternion(hf);const i=this.panner;if(i.positionX){const a=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(ih.x,a),i.positionY.linearRampToValueAtTime(ih.y,a),i.positionZ.linearRampToValueAtTime(ih.z,a),i.orientationX.linearRampToValueAtTime(hl.x,a),i.orientationY.linearRampToValueAtTime(hl.y,a),i.orientationZ.linearRampToValueAtTime(hl.z,a)}else i.setPosition(ih.x,ih.y,ih.z),i.setOrientation(hl.x,hl.y,hl.z)}}class op{constructor(t,i=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const i=this.getFrequencyData();for(let a=0;a<i.length;a++)t+=i[a];return t/i.length}}class vm{constructor(t,i,a){let u,d,f;switch(this.binding=t,this.valueSize=a,i){case"quaternion":u=this._slerp,d=this._slerpAdditive,f=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*a),this._workIndex=5;break;case"string":case"bool":u=this._select,d=this._select,f=this._setAdditiveIdentityOther,this.buffer=new Array(5*a);break;default:u=this._lerp,d=this._lerpAdditive,f=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*a)}this._mixBufferRegion=u,this._mixBufferRegionAdditive=d,this._setIdentity=f,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,i){const a=this.buffer,u=this.valueSize,d=t*u+u;let f=this.cumulativeWeight;if(f===0){for(let v=0;v!==u;++v)a[d+v]=a[v];f=i}else{f+=i;const v=i/f;this._mixBufferRegion(a,d,0,v,u)}this.cumulativeWeight=f}accumulateAdditive(t){const i=this.buffer,a=this.valueSize,u=a*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,u,0,t,a),this.cumulativeWeightAdditive+=t}apply(t){const i=this.valueSize,a=this.buffer,u=t*i+i,d=this.cumulativeWeight,f=this.cumulativeWeightAdditive,v=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,d<1){const _=i*this._origIndex;this._mixBufferRegion(a,u,_,1-d,i)}f>0&&this._mixBufferRegionAdditive(a,u,this._addIndex*i,1,i);for(let _=i,y=i+i;_!==y;++_)if(a[_]!==a[_+i]){v.setValue(a,u);break}}saveOriginalState(){const t=this.binding,i=this.buffer,a=this.valueSize,u=a*this._origIndex;t.getValue(i,u);for(let d=a,f=u;d!==f;++d)i[d]=i[u+d%a];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,i=t+this.valueSize;for(let a=t;a<i;a++)this.buffer[a]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let a=0;a<this.valueSize;a++)this.buffer[i+a]=this.buffer[t+a]}_select(t,i,a,u,d){if(u>=.5)for(let f=0;f!==d;++f)t[i+f]=t[a+f]}_slerp(t,i,a,u){Xi.slerpFlat(t,i,t,i,t,a,u)}_slerpAdditive(t,i,a,u,d){const f=this._workIndex*d;Xi.multiplyQuaternionsFlat(t,f,t,i,t,a),Xi.slerpFlat(t,i,t,i,t,f,u)}_lerp(t,i,a,u,d){const f=1-u;for(let v=0;v!==d;++v){const _=i+v;t[_]=t[_]*f+t[a+v]*u}}_lerpAdditive(t,i,a,u,d){for(let f=0;f!==d;++f){const v=i+f;t[v]=t[v]+t[a+f]*u}}}const _m=new RegExp("[\\[\\]\\.:\\/]","g"),Om="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Dm=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Nm=/(WCOD+)?/.source.replace("WCOD",Om),Fm=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Bm=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),cf=new RegExp("^"+Dm+Nm+Fm+Bm+"$"),sp=["material","materials","bones"];class kr{constructor(t,i,a){this.path=i,this.parsedPath=a||kr.parseTrackName(i),this.node=kr.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,a){return t&&t.isAnimationObjectGroup?new kr.Composite(t,i,a):new kr(t,i,a)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(_m,"")}static parseTrackName(t){const i=cf.exec(t);if(!i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const a={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},u=a.nodeName&&a.nodeName.lastIndexOf(".");if(u!==void 0&&u!==-1){const d=a.nodeName.substring(u+1);sp.indexOf(d)!==-1&&(a.nodeName=a.nodeName.substring(0,u),a.objectName=d)}if(a.propertyName===null||a.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return a}static findNode(t,i){if(!i||i===""||i==="."||i===-1||i===t.name||i===t.uuid)return t;if(t.skeleton){const a=t.skeleton.getBoneByName(i);if(a!==void 0)return a}if(t.children){const a=function(d){for(let f=0;f<d.length;f++){const v=d[f];if(v.name===i||v.uuid===i)return v;const _=a(v.children);if(_)return _}return null},u=a(t.children);if(u)return u}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.node[this.propertyName]}_getValue_array(t,i){const a=this.resolvedProperty;for(let u=0,d=a.length;u!==d;++u)t[i++]=a[u]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const a=this.resolvedProperty;for(let u=0,d=a.length;u!==d;++u)a[u]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const a=this.resolvedProperty;for(let u=0,d=a.length;u!==d;++u)a[u]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const a=this.resolvedProperty;for(let u=0,d=a.length;u!==d;++u)a[u]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,a=i.objectName,u=i.propertyName;let d=i.propertyIndex;if(t||(t=kr.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(a){let y=i.objectIndex;switch(a){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let E=0;E<t.length;E++)if(t[E].name===y){y=E;break}break;default:if(t[a]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[a]}if(y!==void 0){if(t[y]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[y]}}const f=t[u];if(f===void 0){const y=i.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+y+"."+u+" but it wasn't found.",t)}let v=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?v=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(v=this.Versioning.MatrixWorldNeedsUpdate);let _=this.BindingType.Direct;if(d!==void 0){if(u==="morphTargetInfluences"){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);t.morphTargetDictionary[d]!==void 0&&(d=t.morphTargetDictionary[d])}_=this.BindingType.ArrayElement,this.resolvedProperty=f,this.propertyIndex=d}else f.fromArray!==void 0&&f.toArray!==void 0?(_=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(_=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=u;this.getValue=this.GetterByBindingType[_],this.setValue=this.SetterByBindingTypeAndVersioning[_][v]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}kr.Composite=class{constructor(m,t,i){const a=i||kr.parseTrackName(t);this._targetGroup=m,this._bindings=m.subscribe_(t,a)}getValue(m,t){this.bind();const i=this._targetGroup.nCachedObjects_,a=this._bindings[i];a!==void 0&&a.getValue(m,t)}setValue(m,t){const i=this._bindings;for(let a=this._targetGroup.nCachedObjects_,u=i.length;a!==u;++a)i[a].setValue(m,t)}bind(){const m=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=m.length;t!==i;++t)m[t].bind()}unbind(){const m=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=m.length;t!==i;++t)m[t].unbind()}},kr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},kr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},kr.prototype.GetterByBindingType=[kr.prototype._getValue_direct,kr.prototype._getValue_array,kr.prototype._getValue_arrayElement,kr.prototype._getValue_toArray],kr.prototype.SetterByBindingTypeAndVersioning=[[kr.prototype._setValue_direct,kr.prototype._setValue_direct_setNeedsUpdate,kr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[kr.prototype._setValue_array,kr.prototype._setValue_array_setNeedsUpdate,kr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[kr.prototype._setValue_arrayElement,kr.prototype._setValue_arrayElement_setNeedsUpdate,kr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[kr.prototype._setValue_fromArray,kr.prototype._setValue_fromArray_setNeedsUpdate,kr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class tc{constructor(){this.uuid=jo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let a=0,u=arguments.length;a!==u;++a)t[arguments[a].uuid]=a;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const t=this._objects,i=this._indicesByUUID,a=this._paths,u=this._parsedPaths,d=this._bindings,f=d.length;let v,_=t.length,y=this.nCachedObjects_;for(let E=0,A=arguments.length;E!==A;++E){const M=arguments[E],P=M.uuid;let O=i[P];if(O===void 0){O=_++,i[P]=O,t.push(M);for(let U=0,D=f;U!==D;++U)d[U].push(new kr(M,a[U],u[U]))}else if(O<y){v=t[O];const U=--y,D=t[U];i[D.uuid]=O,t[O]=D,i[P]=U,t[U]=M;for(let Z=0,rt=f;Z!==rt;++Z){const gt=d[Z],pt=gt[U];let Mt=gt[O];gt[O]=pt,Mt===void 0&&(Mt=new kr(M,a[Z],u[Z])),gt[U]=Mt}}else t[O]!==v&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=y}remove(){const t=this._objects,i=this._indicesByUUID,a=this._bindings,u=a.length;let d=this.nCachedObjects_;for(let f=0,v=arguments.length;f!==v;++f){const _=arguments[f],y=_.uuid,E=i[y];if(E!==void 0&&E>=d){const A=d++,M=t[A];i[M.uuid]=E,t[E]=M,i[y]=A,t[A]=_;for(let P=0,O=u;P!==O;++P){const U=a[P],D=U[A],Z=U[E];U[E]=D,U[A]=Z}}}this.nCachedObjects_=d}uncache(){const t=this._objects,i=this._indicesByUUID,a=this._bindings,u=a.length;let d=this.nCachedObjects_,f=t.length;for(let v=0,_=arguments.length;v!==_;++v){const y=arguments[v].uuid,E=i[y];if(E!==void 0)if(delete i[y],E<d){const A=--d,M=t[A],P=--f,O=t[P];i[M.uuid]=E,t[E]=M,i[O.uuid]=A,t[A]=O,t.pop();for(let U=0,D=u;U!==D;++U){const Z=a[U],rt=Z[A],gt=Z[P];Z[E]=rt,Z[A]=gt,Z.pop()}}else{const A=--f,M=t[A];A>0&&(i[M.uuid]=E),t[E]=M,t.pop();for(let P=0,O=u;P!==O;++P){const U=a[P];U[E]=U[A],U.pop()}}}this.nCachedObjects_=d}subscribe_(t,i){const a=this._bindingsIndicesByPath;let u=a[t];const d=this._bindings;if(u!==void 0)return d[u];const f=this._paths,v=this._parsedPaths,_=this._objects,y=_.length,E=this.nCachedObjects_,A=new Array(y);u=d.length,a[t]=u,f.push(t),v.push(i),d.push(A);for(let M=E,P=_.length;M!==P;++M){const O=_[M];A[M]=new kr(O,t,i)}return A}unsubscribe_(t){const i=this._bindingsIndicesByPath,a=i[t];if(a!==void 0){const u=this._paths,d=this._parsedPaths,f=this._bindings,v=f.length-1,_=f[v];i[t[v]]=a,f[a]=_,f.pop(),d[a]=d[v],d.pop(),u[a]=u[v],u.pop()}}}tc.prototype.isAnimationObjectGroup=!0;class jp{constructor(t,i,a=null,u=i.blendMode){this._mixer=t,this._clip=i,this._localRoot=a,this.blendMode=u;const d=i.tracks,f=d.length,v=new Array(f),_={endingStart:ri,endingEnd:ri};for(let y=0;y!==f;++y){const E=d[y].createInterpolant(null);v[y]=E,E.settings=_}this._interpolantSettings=_,this._interpolants=v,this._propertyBindings=new Array(f),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Wi,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,i){return this.loop=t,this.repetitions=i,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,i,a){if(t.fadeOut(i),this.fadeIn(i),a){const u=this._clip.duration,d=t._clip.duration,f=d/u,v=u/d;t.warp(1,f,i),this.warp(v,1,i)}return this}crossFadeTo(t,i,a){return t.crossFadeFrom(this,i,a)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,i,a){const u=this._mixer,d=u.time,f=this.timeScale;let v=this._timeScaleInterpolant;v===null&&(v=u._lendControlInterpolant(),this._timeScaleInterpolant=v);const _=v.parameterPositions,y=v.sampleValues;return _[0]=d,_[1]=d+a,y[0]=t/f,y[1]=i/f,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,i,a,u){if(!this.enabled)return void this._updateWeight(t);const d=this._startTime;if(d!==null){const _=(t-d)*a;if(_<0||a===0)return;this._startTime=null,i=a*_}i*=this._updateTimeScale(t);const f=this._updateTime(i),v=this._updateWeight(t);if(v>0){const _=this._interpolants,y=this._propertyBindings;switch(this.blendMode){case sc:for(let E=0,A=_.length;E!==A;++E)_[E].evaluate(f),y[E].accumulateAdditive(v);break;case iu:default:for(let E=0,A=_.length;E!==A;++E)_[E].evaluate(f),y[E].accumulate(u,v)}}}_updateWeight(t){let i=0;if(this.enabled){i=this.weight;const a=this._weightInterpolant;if(a!==null){const u=a.evaluate(t)[0];i*=u,t>a.parameterPositions[1]&&(this.stopFading(),u===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(t){let i=0;if(!this.paused){i=this.timeScale;const a=this._timeScaleInterpolant;a!==null&&(i*=a.evaluate(t)[0],t>a.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i))}return this._effectiveTimeScale=i,i}_updateTime(t){const i=this._clip.duration,a=this.loop;let u=this.time+t,d=this._loopCount;const f=a===dd;if(t===0)return d===-1?u:f&&(1&d)==1?i-u:u;if(a===cd){d===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(u>=i)u=i;else{if(!(u<0)){this.time=u;break t}u=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=u,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(d===-1&&(t>=0?(d=0,this._setEndings(!0,this.repetitions===0,f)):this._setEndings(this.repetitions===0,!0,f)),u>=i||u<0){const v=Math.floor(u/i);u-=i*v,d+=Math.abs(v);const _=this.repetitions-d;if(_<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,u=t>0?i:0,this.time=u,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(_===1){const y=t<0;this._setEndings(y,!y,f)}else this._setEndings(!1,!1,f);this._loopCount=d,this.time=u,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:v})}}else this.time=u;if(f&&(1&d)==1)return i-u}return u}_setEndings(t,i,a){const u=this._interpolantSettings;a?(u.endingStart=Aa,u.endingEnd=Aa):(u.endingStart=t?this.zeroSlopeAtStart?Aa:ri:Go,u.endingEnd=i?this.zeroSlopeAtEnd?Aa:ri:Go)}_scheduleFading(t,i,a){const u=this._mixer,d=u.time;let f=this._weightInterpolant;f===null&&(f=u._lendControlInterpolant(),this._weightInterpolant=f);const v=f.parameterPositions,_=f.sampleValues;return v[0]=d,_[0]=i,v[1]=d+t,_[1]=a,this}}class Vp extends Ho{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,i){const a=t._localRoot||this._root,u=t._clip.tracks,d=u.length,f=t._propertyBindings,v=t._interpolants,_=a.uuid,y=this._bindingsByRootAndName;let E=y[_];E===void 0&&(E={},y[_]=E);for(let A=0;A!==d;++A){const M=u[A],P=M.name;let O=E[P];if(O!==void 0)f[A]=O;else{if(O=f[A],O!==void 0){O._cacheIndex===null&&(++O.referenceCount,this._addInactiveBinding(O,_,P));continue}const U=i&&i._propertyBindings[A].binding.parsedPath;O=new vm(kr.create(a,P,U),M.ValueTypeName,M.getValueSize()),++O.referenceCount,this._addInactiveBinding(O,_,P),f[A]=O}v[A].resultBuffer=O.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){const a=(t._localRoot||this._root).uuid,u=t._clip.uuid,d=this._actionsByClip[u];this._bindAction(t,d&&d.knownActions[0]),this._addInactiveAction(t,u,a)}const i=t._propertyBindings;for(let a=0,u=i.length;a!==u;++a){const d=i[a];d.useCount++==0&&(this._lendBinding(d),d.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const i=t._propertyBindings;for(let a=0,u=i.length;a!==u;++a){const d=i[a];--d.useCount==0&&(d.restoreOriginalState(),this._takeBackBinding(d))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const i=t._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(t,i,a){const u=this._actions,d=this._actionsByClip;let f=d[i];if(f===void 0)f={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,d[i]=f;else{const v=f.knownActions;t._byClipCacheIndex=v.length,v.push(t)}t._cacheIndex=u.length,u.push(t),f.actionByRoot[a]=t}_removeInactiveAction(t){const i=this._actions,a=i[i.length-1],u=t._cacheIndex;a._cacheIndex=u,i[u]=a,i.pop(),t._cacheIndex=null;const d=t._clip.uuid,f=this._actionsByClip,v=f[d],_=v.knownActions,y=_[_.length-1],E=t._byClipCacheIndex;y._byClipCacheIndex=E,_[E]=y,_.pop(),t._byClipCacheIndex=null,delete v.actionByRoot[(t._localRoot||this._root).uuid],_.length===0&&delete f[d],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const i=t._propertyBindings;for(let a=0,u=i.length;a!==u;++a){const d=i[a];--d.referenceCount==0&&this._removeInactiveBinding(d)}}_lendAction(t){const i=this._actions,a=t._cacheIndex,u=this._nActiveActions++,d=i[u];t._cacheIndex=u,i[u]=t,d._cacheIndex=a,i[a]=d}_takeBackAction(t){const i=this._actions,a=t._cacheIndex,u=--this._nActiveActions,d=i[u];t._cacheIndex=u,i[u]=t,d._cacheIndex=a,i[a]=d}_addInactiveBinding(t,i,a){const u=this._bindingsByRootAndName,d=this._bindings;let f=u[i];f===void 0&&(f={},u[i]=f),f[a]=t,t._cacheIndex=d.length,d.push(t)}_removeInactiveBinding(t){const i=this._bindings,a=t.binding,u=a.rootNode.uuid,d=a.path,f=this._bindingsByRootAndName,v=f[u],_=i[i.length-1],y=t._cacheIndex;_._cacheIndex=y,i[y]=_,i.pop(),delete v[d],Object.keys(v).length===0&&delete f[u]}_lendBinding(t){const i=this._bindings,a=t._cacheIndex,u=this._nActiveBindings++,d=i[u];t._cacheIndex=u,i[u]=t,d._cacheIndex=a,i[a]=d}_takeBackBinding(t){const i=this._bindings,a=t._cacheIndex,u=--this._nActiveBindings,d=i[u];t._cacheIndex=u,i[u]=t,d._cacheIndex=a,i[a]=d}_lendControlInterpolant(){const t=this._controlInterpolants,i=this._nActiveControlInterpolants++;let a=t[i];return a===void 0&&(a=new wr(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),a.__cacheIndex=i,t[i]=a),a}_takeBackControlInterpolant(t){const i=this._controlInterpolants,a=t.__cacheIndex,u=--this._nActiveControlInterpolants,d=i[u];t.__cacheIndex=u,i[u]=t,d.__cacheIndex=a,i[a]=d}clipAction(t,i,a){const u=i||this._root,d=u.uuid;let f=typeof t=="string"?Qc.findByName(u,t):t;const v=f!==null?f.uuid:t,_=this._actionsByClip[v];let y=null;if(a===void 0&&(a=f!==null?f.blendMode:iu),_!==void 0){const A=_.actionByRoot[d];if(A!==void 0&&A.blendMode===a)return A;y=_.knownActions[0],f===null&&(f=y._clip)}if(f===null)return null;const E=new jp(this,f,i,a);return this._bindAction(E,y),this._addInactiveAction(E,v,d),E}existingAction(t,i){const a=i||this._root,u=a.uuid,d=typeof t=="string"?Qc.findByName(a,t):t,f=d?d.uuid:t,v=this._actionsByClip[f];return v!==void 0&&v.actionByRoot[u]||null}stopAllAction(){const t=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)t[i].stop();return this}update(t){t*=this.timeScale;const i=this._actions,a=this._nActiveActions,u=this.time+=t,d=Math.sign(t),f=this._accuIndex^=1;for(let y=0;y!==a;++y)i[y]._update(u,t,d,f);const v=this._bindings,_=this._nActiveBindings;for(let y=0;y!==_;++y)v[y].apply(f);return this}setTime(t){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const i=this._actions,a=t.uuid,u=this._actionsByClip,d=u[a];if(d!==void 0){const f=d.knownActions;for(let v=0,_=f.length;v!==_;++v){const y=f[v];this._deactivateAction(y);const E=y._cacheIndex,A=i[i.length-1];y._cacheIndex=null,y._byClipCacheIndex=null,A._cacheIndex=E,i[E]=A,i.pop(),this._removeInactiveBindingsForAction(y)}delete u[a]}}uncacheRoot(t){const i=t.uuid,a=this._actionsByClip;for(const d in a){const f=a[d].actionByRoot[i];f!==void 0&&(this._deactivateAction(f),this._removeInactiveAction(f))}const u=this._bindingsByRootAndName[i];if(u!==void 0)for(const d in u){const f=u[d];f.restoreOriginalState(),this._removeInactiveBinding(f)}}uncacheAction(t,i){const a=this.existingAction(t,i);a!==null&&(this._deactivateAction(a),this._removeInactiveAction(a))}}Vp.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class ti{constructor(t){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new ti(this.value.clone===void 0?this.value:this.value.clone())}}class ap extends Ha{constructor(t,i,a=1){super(t,i),this.meshPerAttribute=a}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const i=super.clone(t);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(t){const i=super.toJSON(t);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}ap.prototype.isInstancedInterleavedBuffer=!0;class Wp{constructor(t,i,a,u,d){this.buffer=t,this.type=i,this.itemSize=a,this.elementSize=u,this.count=d,this.version=0}set needsUpdate(t){t===!0&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,i){return this.type=t,this.elementSize=i,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}Wp.prototype.isGLBufferAttribute=!0;class Xp{constructor(t,i,a=0,u=1/0){this.ray=new Ro(t,i),this.near=a,this.far=u,this.camera=null,this.layers=new Iu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,i){this.ray.set(t,i)}setFromCamera(t,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(t,i=!1,a=[]){return ec(t,this,a,i),a.sort(qp),a}intersectObjects(t,i=!1,a=[]){for(let u=0,d=t.length;u<d;u++)ec(t[u],this,a,i);return a.sort(qp),a}}function qp(m,t){return m.distance-t.distance}function ec(m,t,i,a){if(m.layers.test(t.layers)&&m.raycast(t,i),a===!0){const u=m.children;for(let d=0,f=u.length;d<f;d++)ec(u[d],t,i,!0)}}class ad{constructor(t=1,i=0,a=0){return this.radius=t,this.phi=i,this.theta=a,this}set(t,i,a){return this.radius=t,this.phi=i,this.theta=a,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,i,a){return this.radius=Math.sqrt(t*t+i*i+a*a),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,a),this.phi=Math.acos(Hi(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Yp{constructor(t=1,i=0,a=0){return this.radius=t,this.theta=i,this.y=a,this}set(t,i,a){return this.radius=t,this.theta=i,this.y=a,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,i,a){return this.radius=Math.sqrt(t*t+a*a),this.theta=Math.atan2(t,a),this.y=i,this}clone(){return new this.constructor().copy(this)}}const Zp=new He;class ud{constructor(t=new He(1/0,1/0),i=new He(-1/0,-1/0)){this.min=t,this.max=i}set(t,i){return this.min.copy(t),this.max.copy(i),this}setFromPoints(t){this.makeEmpty();for(let i=0,a=t.length;i<a;i++)this.expandByPoint(t[i]);return this}setFromCenterAndSize(t,i){const a=Zp.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(a),this.max.copy(t).add(a),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,i){return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,i){return i.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Zp.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}ud.prototype.isBox2=!0;const ym=new mt,ld=new mt;class df{constructor(t=new mt,i=new mt){this.start=t,this.end=i}set(t,i){return this.start.copy(t),this.end.copy(i),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,i){return this.delta(i).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,i){ym.subVectors(t,this.start),ld.subVectors(this.end,this.start);const a=ld.dot(ld);let u=ld.dot(ym)/a;return i&&(u=Hi(u,0,1)),u}closestPointToPoint(t,i,a){const u=this.closestPointToPointParameter(t,i);return this.delta(a).multiplyScalar(u).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class xm extends vr{constructor(t){super(),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}xm.prototype.isImmediateRenderObject=!0;const bm=new mt;class Um extends vr{constructor(t,i){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;const a=new Dn,u=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let f=0,v=1,_=32;f<_;f++,v++){const y=f/_*Math.PI*2,E=v/_*Math.PI*2;u.push(Math.cos(y),Math.sin(y),1,Math.cos(E),Math.sin(E),1)}a.setAttribute("position",new En(u,3));const d=new ao({fog:!1,toneMapped:!1});this.cone=new Jo(a,d),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,i=t*Math.tan(this.light.angle);this.cone.scale.set(i,i,t),bm.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(bm),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ka=new mt,nc=new Tn,cl=new Tn;class wm extends Jo{constructor(t){const i=function _(y){const E=[];y&&y.isBone&&E.push(y);for(let A=0;A<y.children.length;A++)E.push.apply(E,_(y.children[A]));return E}(t),a=new Dn,u=[],d=[],f=new pn(0,0,1),v=new pn(0,1,0);for(let _=0;_<i.length;_++){const y=i[_];y.parent&&y.parent.isBone&&(u.push(0,0,0),u.push(0,0,0),d.push(f.r,f.g,f.b),d.push(v.r,v.g,v.b))}a.setAttribute("position",new En(u,3)),a.setAttribute("color",new En(d,3)),super(a,new ao({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=i,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const i=this.bones,a=this.geometry,u=a.getAttribute("position");cl.copy(this.root.matrixWorld).invert();for(let d=0,f=0;d<i.length;d++){const v=i[d];v.parent&&v.parent.isBone&&(nc.multiplyMatrices(cl,v.matrixWorld),Ka.setFromMatrixPosition(nc),u.setXYZ(f,Ka.x,Ka.y,Ka.z),nc.multiplyMatrices(cl,v.parent.matrixWorld),Ka.setFromMatrixPosition(nc),u.setXYZ(f+1,Ka.x,Ka.y,Ka.z),f+=2)}a.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}class ya extends mi{constructor(t,i,a){super(new Xh(i,4,2),new Vi({wireframe:!0,fog:!1,toneMapped:!1})),this.light=t,this.light.updateMatrixWorld(),this.color=a,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const km=new mt,o=new pn,n=new pn;class e extends vr{constructor(t,i,a){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=a;const u=new Wh(i);u.rotateY(.5*Math.PI),this.material=new Vi({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const d=u.getAttribute("position"),f=new Float32Array(3*d.count);u.setAttribute("color",new hr(f,3)),this.add(new mi(u,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=t.geometry.getAttribute("color");o.copy(this.light.color),n.copy(this.light.groundColor);for(let a=0,u=i.count;a<u;a++){const d=a<u/2?o:n;i.setXYZ(a,d.r,d.g,d.b)}i.needsUpdate=!0}t.lookAt(km.setFromMatrixPosition(this.light.matrixWorld).negate())}}class r extends Jo{constructor(t=10,i=10,a=4473924,u=8947848){a=new pn(a),u=new pn(u);const d=i/2,f=t/i,v=t/2,_=[],y=[];for(let A=0,M=0,P=-v;A<=i;A++,P+=f){_.push(-v,0,P,v,0,P),_.push(P,0,-v,P,0,v);const O=A===d?a:u;O.toArray(y,M),M+=3,O.toArray(y,M),M+=3,O.toArray(y,M),M+=3,O.toArray(y,M),M+=3}const E=new Dn;E.setAttribute("position",new En(_,3)),E.setAttribute("color",new En(y,3)),super(E,new ao({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class s extends Jo{constructor(t=10,i=16,a=8,u=64,d=4473924,f=8947848){d=new pn(d),f=new pn(f);const v=[],_=[];for(let E=0;E<=i;E++){const A=E/i*(2*Math.PI),M=Math.sin(A)*t,P=Math.cos(A)*t;v.push(0,0,0),v.push(M,0,P);const O=1&E?d:f;_.push(O.r,O.g,O.b),_.push(O.r,O.g,O.b)}for(let E=0;E<=a;E++){const A=1&E?d:f,M=t-t/a*E;for(let P=0;P<u;P++){let O=P/u*(2*Math.PI),U=Math.sin(O)*M,D=Math.cos(O)*M;v.push(U,0,D),_.push(A.r,A.g,A.b),O=(P+1)/u*(2*Math.PI),U=Math.sin(O)*M,D=Math.cos(O)*M,v.push(U,0,D),_.push(A.r,A.g,A.b)}}const y=new Dn;y.setAttribute("position",new En(v,3)),y.setAttribute("color",new En(_,3)),super(y,new ao({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const l=new mt,h=new mt,p=new mt;class x extends vr{constructor(t,i,a){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,i===void 0&&(i=1);let u=new Dn;u.setAttribute("position",new En([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const d=new ao({fog:!1,toneMapped:!1});this.lightPlane=new ja(u,d),this.add(this.lightPlane),u=new Dn,u.setAttribute("position",new En([0,0,0,0,0,1],3)),this.targetLine=new ja(u,d),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){l.setFromMatrixPosition(this.light.matrixWorld),h.setFromMatrixPosition(this.light.target.matrixWorld),p.subVectors(h,l),this.lightPlane.lookAt(h),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(h),this.targetLine.scale.z=p.length()}}const b=new mt,w=new Ol;class R extends Jo{constructor(t){const i=new Dn,a=new ao({color:16777215,vertexColors:!0,toneMapped:!1}),u=[],d=[],f={},v=new pn(16755200),_=new pn(16711680),y=new pn(43775),E=new pn(16777215),A=new pn(3355443);function M(O,U,D){P(O,D),P(U,D)}function P(O,U){u.push(0,0,0),d.push(U.r,U.g,U.b),f[O]===void 0&&(f[O]=[]),f[O].push(u.length/3-1)}M("n1","n2",v),M("n2","n4",v),M("n4","n3",v),M("n3","n1",v),M("f1","f2",v),M("f2","f4",v),M("f4","f3",v),M("f3","f1",v),M("n1","f1",v),M("n2","f2",v),M("n3","f3",v),M("n4","f4",v),M("p","n1",_),M("p","n2",_),M("p","n3",_),M("p","n4",_),M("u1","u2",y),M("u2","u3",y),M("u3","u1",y),M("c","t",E),M("p","c",A),M("cn1","cn2",A),M("cn3","cn4",A),M("cf1","cf2",A),M("cf3","cf4",A),i.setAttribute("position",new En(u,3)),i.setAttribute("color",new En(d,3)),super(i,a),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=f,this.update()}update(){const t=this.geometry,i=this.pointMap;w.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),H("c",i,t,w,0,0,-1),H("t",i,t,w,0,0,1),H("n1",i,t,w,-1,-1,-1),H("n2",i,t,w,1,-1,-1),H("n3",i,t,w,-1,1,-1),H("n4",i,t,w,1,1,-1),H("f1",i,t,w,-1,-1,1),H("f2",i,t,w,1,-1,1),H("f3",i,t,w,-1,1,1),H("f4",i,t,w,1,1,1),H("u1",i,t,w,.7,1.1,-1),H("u2",i,t,w,-.7,1.1,-1),H("u3",i,t,w,0,2,-1),H("cf1",i,t,w,-1,0,1),H("cf2",i,t,w,1,0,1),H("cf3",i,t,w,0,-1,1),H("cf4",i,t,w,0,1,1),H("cn1",i,t,w,-1,0,-1),H("cn2",i,t,w,1,0,-1),H("cn3",i,t,w,0,-1,-1),H("cn4",i,t,w,0,1,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function H(m,t,i,a,u,d,f){b.set(u,d,f).unproject(a);const v=t[m];if(v!==void 0){const _=i.getAttribute("position");for(let y=0,E=v.length;y<E;y++)_.setXYZ(v[y],b.x,b.y,b.z)}}const z=new co;class q extends Jo{constructor(t,i=16776960){const a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),u=new Float32Array(24),d=new Dn;d.setIndex(new hr(a,1)),d.setAttribute("position",new hr(u,3)),super(d,new ao({color:i,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(t!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&z.setFromObject(this.object),z.isEmpty())return;const i=z.min,a=z.max,u=this.geometry.attributes.position,d=u.array;d[0]=a.x,d[1]=a.y,d[2]=a.z,d[3]=i.x,d[4]=a.y,d[5]=a.z,d[6]=i.x,d[7]=i.y,d[8]=a.z,d[9]=a.x,d[10]=i.y,d[11]=a.z,d[12]=a.x,d[13]=a.y,d[14]=i.z,d[15]=i.x,d[16]=a.y,d[17]=i.z,d[18]=i.x,d[19]=i.y,d[20]=i.z,d[21]=a.x,d[22]=i.y,d[23]=i.z,u.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t){return Jo.prototype.copy.call(this,t),this.object=t.object,this}}class at extends Jo{constructor(t,i=16776960){const a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),u=new Dn;u.setIndex(new hr(a,1)),u.setAttribute("position",new En([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(u,new ao({color:i,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}}class _t extends ja{constructor(t,i=1,a=16776960){const u=a,d=new Dn;d.setAttribute("position",new En([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),d.computeBoundingSphere(),super(d,new ao({color:u,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=i;const f=new Dn;f.setAttribute("position",new En([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),f.computeBoundingSphere(),this.add(new mi(f,new Vi({color:u,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){let i=-this.plane.constant;Math.abs(i)<1e-8&&(i=1e-8),this.scale.set(.5*this.size,.5*this.size,i),this.children[0].material.side=i<0?I:kt,this.lookAt(this.plane.normal),super.updateMatrixWorld(t)}}const bt=new mt;let zt,De;class an extends vr{constructor(t=new mt(0,0,1),i=new mt(0,0,0),a=1,u=16776960,d=.2*a,f=.2*d){super(),this.type="ArrowHelper",zt===void 0&&(zt=new Dn,zt.setAttribute("position",new En([0,0,0,0,1,0],3)),De=new Ne(0,.5,1,5,1),De.translate(0,-.5,0)),this.position.copy(i),this.line=new ja(zt,new ao({color:u,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new mi(De,new Vi({color:u,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(a,d,f)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{bt.set(t.z,0,-t.x).normalize();const i=Math.acos(t.y);this.quaternion.setFromAxisAngle(bt,i)}}setLength(t,i=.2*t,a=.2*i){this.line.scale.set(1,Math.max(1e-4,t-i),1),this.line.updateMatrix(),this.cone.scale.set(a,i,a),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}}class Dt extends Jo{constructor(t=1){const i=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],a=new Dn;a.setAttribute("position",new En(i,3)),a.setAttribute("color",new En([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(a,new ao({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,i,a){const u=new pn,d=this.geometry.attributes.color.array;return u.set(t),u.toArray(d,0),u.toArray(d,3),u.set(i),u.toArray(d,6),u.toArray(d,9),u.set(a),u.toArray(d,12),u.toArray(d,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const ue=new Float32Array(1),te=new Int32Array(ue.buffer);class he{static toHalfFloat(t){ue[0]=t;const i=te[0];let a=i>>16&32768,u=i>>12&2047;const d=i>>23&255;return d<103?a:d>142?(a|=31744,a|=(d==255?0:1)&&8388607&i,a):d<113?(u|=2048,a|=(u>>114-d)+(u>>113-d&1),a):(a|=d-112<<10|u>>1,a+=1&u,a)}}const Ve=Math.pow(2,8),Pe=[.125,.215,.35,.446,.526,.582],ie=5+Pe.length,pe={[ro]:0,[Pa]:1,[fe]:2,[sn]:3,[en]:4,[pr]:5,[Gt]:6},rn=new Vi({side:I,depthWrite:!1,depthTest:!1}),Ye=new mi(new fa,rn),tn=new nh,{_lodPlanes:cn,_sizeLods:ke,_sigmas:Ce}=Bi(),mn=new pn;let kn=null;const Jn=(1+Math.sqrt(5))/2,_r=1/Jn,or=[new mt(1,1,1),new mt(-1,1,1),new mt(1,1,-1),new mt(-1,1,-1),new mt(0,Jn,_r),new mt(0,Jn,-_r),new mt(_r,0,Jn),new mt(-_r,0,Jn),new mt(Jn,_r,0),new mt(-Jn,_r,0)];function Tr(m){const t=Math.max(m.r,m.g,m.b),i=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);return m.multiplyScalar(Math.pow(2,-i)),(i+128)/255}class si{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function(i){const a=new Float32Array(i),u=new mt(0,1,0);return new Yh({name:"SphericalGaussianBlur",defines:{n:i},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:a},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:u},inputEncoding:{value:pe[ro]},outputEncoding:{value:pe[ro]}},vertexShader:rr(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			${$n()}

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:F,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(t,i=0,a=.1,u=100){kn=this._renderer.getRenderTarget();const d=this._allocateTargets();return this._sceneToCubeUV(t,a,u,d),i>0&&this._blur(d,0,0,i),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(t){return this._fromTexture(t)}fromCubemap(t){return this._fromTexture(t)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=Wr(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=ei(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let t=0;t<cn.length;t++)cn[t].dispose()}_cleanup(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(kn),t.scissorTest=!1,tr(t,0,0,t.width,t.height)}_fromTexture(t){kn=this._renderer.getRenderTarget();const i=this._allocateTargets(t);return this._textureToCubeUV(t,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(t){const i={magFilter:St,minFilter:St,generateMipmaps:!1,type:ho,format:ln,encoding:ai(t)?t.encoding:fe,depthBuffer:!1},a=So(i);return a.depthBuffer=!t,this._pingPongRenderTarget=So(i),a}_compileMaterial(t){const i=new mi(cn[0],t);this._renderer.compile(i,tn)}_sceneToCubeUV(t,i,a,u){const d=new to(90,1,i,a),f=[1,-1,1,1,1,1],v=[1,1,1,-1,-1,-1],_=this._renderer,y=_.autoClear,E=_.outputEncoding,A=_.toneMapping;_.getClearColor(mn),_.toneMapping=Er,_.outputEncoding=ro,_.autoClear=!1;let M=!1;const P=t.background;if(P){if(P.isColor){rn.color.copy(P).convertSRGBToLinear(),t.background=null;const O=Tr(rn.color);rn.opacity=O,M=!0}}else{rn.color.copy(mn).convertSRGBToLinear();const O=Tr(rn.color);rn.opacity=O,M=!0}for(let O=0;O<6;O++){const U=O%3;U==0?(d.up.set(0,f[O],0),d.lookAt(v[O],0,0)):U==1?(d.up.set(0,0,f[O]),d.lookAt(0,v[O],0)):(d.up.set(0,f[O],0),d.lookAt(0,0,v[O])),tr(u,U*Ve,O>2?Ve:0,Ve,Ve),_.setRenderTarget(u),M&&_.render(Ye,d),_.render(t,d)}_.toneMapping=A,_.outputEncoding=E,_.autoClear=y}_textureToCubeUV(t,i){const a=this._renderer;t.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=Wr()):this._equirectShader==null&&(this._equirectShader=ei());const u=t.isCubeTexture?this._cubemapShader:this._equirectShader,d=new mi(cn[0],u),f=u.uniforms;f.envMap.value=t,t.isCubeTexture||f.texelSize.value.set(1/t.image.width,1/t.image.height),f.inputEncoding.value=pe[t.encoding],f.outputEncoding.value=pe[i.texture.encoding],tr(i,0,0,3*Ve,2*Ve),a.setRenderTarget(i),a.render(d,tn)}_applyPMREM(t){const i=this._renderer,a=i.autoClear;i.autoClear=!1;for(let u=1;u<ie;u++){const d=Math.sqrt(Ce[u]*Ce[u]-Ce[u-1]*Ce[u-1]),f=or[(u-1)%or.length];this._blur(t,u-1,u,d,f)}i.autoClear=a}_blur(t,i,a,u,d){const f=this._pingPongRenderTarget;this._halfBlur(t,f,i,a,u,"latitudinal",d),this._halfBlur(f,t,a,a,u,"longitudinal",d)}_halfBlur(t,i,a,u,d,f,v){const _=this._renderer,y=this._blurMaterial;f!=="latitudinal"&&f!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const E=new mi(cn[u],y),A=y.uniforms,M=ke[a]-1,P=isFinite(d)?Math.PI/(2*M):2*Math.PI/39,O=d/P,U=isFinite(d)?1+Math.floor(3*O):20;U>20&&console.warn(`sigmaRadians, ${d}, is too large and will clip, as it requested ${U} samples when the maximum is set to 20`);const D=[];let Z=0;for(let gt=0;gt<20;++gt){const pt=gt/O,Mt=Math.exp(-pt*pt/2);D.push(Mt),gt==0?Z+=Mt:gt<U&&(Z+=2*Mt)}for(let gt=0;gt<D.length;gt++)D[gt]=D[gt]/Z;A.envMap.value=t.texture,A.samples.value=U,A.weights.value=D,A.latitudinal.value=f==="latitudinal",v&&(A.poleAxis.value=v),A.dTheta.value=P,A.mipInt.value=8-a,A.inputEncoding.value=pe[t.texture.encoding],A.outputEncoding.value=pe[t.texture.encoding];const rt=ke[u];tr(i,3*Math.max(0,Ve-2*rt),(u===0?0:2*Ve)+2*rt*(u>4?u-8+4:0),3*rt,2*rt),_.setRenderTarget(i),_.render(E,tn)}}function ai(m){return m!==void 0&&m.type===ho&&(m.encoding===ro||m.encoding===Pa||m.encoding===Gt)}function Bi(){const m=[],t=[],i=[];let a=8;for(let u=0;u<ie;u++){const d=Math.pow(2,a);t.push(d);let f=1/d;u>4?f=Pe[u-8+4-1]:u==0&&(f=0),i.push(f);const v=1/(d-1),_=-v/2,y=1+v/2,E=[_,_,y,_,y,y,_,_,y,y,_,y],A=6,M=6,P=3,O=2,U=1,D=new Float32Array(P*M*A),Z=new Float32Array(O*M*A),rt=new Float32Array(U*M*A);for(let pt=0;pt<A;pt++){const Mt=pt%3*2/3-1,At=pt>2?0:-1,Et=[Mt,At,0,Mt+2/3,At,0,Mt+2/3,At+1,0,Mt,At,0,Mt+2/3,At+1,0,Mt,At+1,0];D.set(Et,P*M*pt),Z.set(E,O*M*pt);const Lt=[pt,pt,pt,pt,pt,pt];rt.set(Lt,U*M*pt)}const gt=new Dn;gt.setAttribute("position",new hr(D,P)),gt.setAttribute("uv",new hr(Z,O)),gt.setAttribute("faceIndex",new hr(rt,U)),m.push(gt),a>4&&a--}return{_lodPlanes:m,_sizeLods:t,_sigmas:i}}function So(m){const t=new Po(3*Ve,3*Ve,m);return t.texture.mapping=K,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function tr(m,t,i,a,u){m.viewport.set(t,i,a,u),m.scissor.set(t,i,a,u)}function ei(){const m=new He(1,1);return new Yh({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:m},inputEncoding:{value:pe[ro]},outputEncoding:{value:pe[ro]}},vertexShader:rr(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${$n()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:F,depthTest:!1,depthWrite:!1})}function Wr(){return new Yh({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:pe[ro]},outputEncoding:{value:pe[ro]}},vertexShader:rr(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${$n()}

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:F,depthTest:!1,depthWrite:!1})}function rr(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function $n(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}const eo=0,dl=1,hd=0,up=1,Sm=2;function Tm(m){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),m}function Em(m=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),m.isMultiMaterial=!0,m.materials=m,m.clone=function(){return m.slice()},m}function ng(m,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new W(m,t)}function rg(m){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Uh(m)}function ig(m,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new W(m,t)}function og(m){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new rl(m)}function sg(m){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new rl(m)}function ag(m){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new rl(m)}function ug(m,t,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new mt(m,t,i)}function lg(m,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new hr(m,t).setUsage(Zi)}function hg(m,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Ed(m,t)}function cg(m,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new zn(m,t)}function dg(m,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Lo(m,t)}function fg(m,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Xs(m,t)}function pg(m,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Nu(m,t)}function mg(m,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Md(m,t)}function gg(m,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Fu(m,t)}function vg(m,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new En(m,t)}function _g(m,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new yc(m,t)}function yg(m){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Dt(m)}function xg(m,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new q(m,t)}function bg(m,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Jo(new qn(m.geometry),new ao({color:t!==void 0?t:16777215}))}function wg(m,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Jo(new Sp(m.geometry),new ao({color:t!==void 0?t:16777215}))}function Sg(m){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new uo(m)}function Tg(m){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new um(m)}function Eg(m,t,i){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Rs(m,i)}function Mg(){console.error("THREE.CanvasRenderer has been removed")}function Ag(){console.error("THREE.JSONLoader has been removed.")}Cn.create=function(m,t){return console.log("THREE.Curve.create() has been deprecated"),m.prototype=Object.create(Cn.prototype),m.prototype.constructor=m,m.prototype.getPoint=t,m},rd.prototype.fromPoints=function(m){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(m)},r.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},wm.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},ts.prototype.extractUrlBase=function(m){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Qf.extractUrlBase(m)},ts.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},ud.prototype.center=function(m){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(m)},ud.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ud.prototype.isIntersectionBox=function(m){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(m)},ud.prototype.size=function(m){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(m)},co.prototype.center=function(m){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(m)},co.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},co.prototype.isIntersectionBox=function(m){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(m)},co.prototype.isIntersectionSphere=function(m){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(m)},co.prototype.size=function(m){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(m)},ws.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Fa.prototype.setFromMatrix=function(m){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(m)},df.prototype.center=function(m){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(m)},$i.prototype.flattenToArrayOffset=function(m,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(m,t)},$i.prototype.multiplyVector3=function(m){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),m.applyMatrix3(this)},$i.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},$i.prototype.applyToBufferAttribute=function(m){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),m.applyMatrix3(this)},$i.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},$i.prototype.getInverse=function(m){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(m).invert()},Tn.prototype.extractPosition=function(m){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(m)},Tn.prototype.flattenToArrayOffset=function(m,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(m,t)},Tn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new mt().setFromMatrixColumn(this,3)},Tn.prototype.setRotationFromQuaternion=function(m){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(m)},Tn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Tn.prototype.multiplyVector3=function(m){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),m.applyMatrix4(this)},Tn.prototype.multiplyVector4=function(m){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),m.applyMatrix4(this)},Tn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Tn.prototype.rotateAxis=function(m){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),m.transformDirection(this)},Tn.prototype.crossVector=function(m){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),m.applyMatrix4(this)},Tn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Tn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Tn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Tn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Tn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Tn.prototype.applyToBufferAttribute=function(m){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),m.applyMatrix4(this)},Tn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Tn.prototype.makeFrustum=function(m,t,i,a,u,d){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(m,t,a,i,u,d)},Tn.prototype.getInverse=function(m){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(m).invert()},us.prototype.isIntersectionLine=function(m){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(m)},Xi.prototype.multiplyVector3=function(m){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),m.applyQuaternion(this)},Xi.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ro.prototype.isIntersectionBox=function(m){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(m)},Ro.prototype.isIntersectionPlane=function(m){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(m)},Ro.prototype.isIntersectionSphere=function(m){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(m)},bi.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},bi.prototype.barycoordFromPoint=function(m,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(m,t)},bi.prototype.midpoint=function(m){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(m)},bi.prototypenormal=function(m){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(m)},bi.prototype.plane=function(m){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(m)},bi.barycoordFromPoint=function(m,t,i,a,u){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),bi.getBarycoord(m,t,i,a,u)},bi.normal=function(m,t,i,a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),bi.getNormal(m,t,i,a)},eh.prototype.extractAllPoints=function(m){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(m)},eh.prototype.extrude=function(m){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Xa(this,m)},eh.prototype.makeGeometry=function(m){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Fs(this,m)},He.prototype.fromAttribute=function(m,t,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(m,t,i)},He.prototype.distanceToManhattan=function(m){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(m)},He.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},mt.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},mt.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},mt.prototype.getPositionFromMatrix=function(m){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(m)},mt.prototype.getScaleFromMatrix=function(m){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(m)},mt.prototype.getColumnFromMatrix=function(m,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,m)},mt.prototype.applyProjection=function(m){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(m)},mt.prototype.fromAttribute=function(m,t,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(m,t,i)},mt.prototype.distanceToManhattan=function(m){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(m)},mt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ir.prototype.fromAttribute=function(m,t,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(m,t,i)},Ir.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},vr.prototype.getChildByName=function(m){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(m)},vr.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},vr.prototype.translate=function(m,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,m)},vr.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},vr.prototype.applyMatrix=function(m){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(m)},Object.defineProperties(vr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(m){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=m}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),mi.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(mi.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),ra},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),el.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},to.prototype.setLens=function(m,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(m)},Object.defineProperties(_a.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(m){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=m}},shadowCameraLeft:{set:function(m){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=m}},shadowCameraRight:{set:function(m){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=m}},shadowCameraTop:{set:function(m){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=m}},shadowCameraBottom:{set:function(m){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=m}},shadowCameraNear:{set:function(m){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=m}},shadowCameraFar:{set:function(m){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=m}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(m){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=m}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(m){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=m}},shadowMapHeight:{set:function(m){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=m}}}),Object.defineProperties(hr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Zi},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Zi)}}}),hr.prototype.setDynamic=function(m){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(m===!0?Zi:ys),this},hr.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},hr.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Dn.prototype.addIndex=function(m){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(m)},Dn.prototype.addAttribute=function(m,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?m==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(m,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(m,new hr(arguments[1],arguments[2])))},Dn.prototype.addDrawCall=function(m,t,i){i!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(m,t)},Dn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Dn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Dn.prototype.removeAttribute=function(m){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(m)},Dn.prototype.applyMatrix=function(m){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(m)},Object.defineProperties(Dn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Ha.prototype.setDynamic=function(m){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(m===!0?Zi:ys),this},Ha.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Xa.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Xa.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Xa.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Fh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},ti.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(ji.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new pn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(m){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=m===V}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(m){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=m}}}),Object.defineProperties(go.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(m){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=m}}}),Jr.prototype.clearTarget=function(m,t,i,a){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(m),this.clear(t,i,a)},Jr.prototype.animate=function(m){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(m)},Jr.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Jr.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Jr.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Jr.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Jr.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Jr.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Jr.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Jr.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Jr.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Jr.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Jr.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Jr.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Jr.prototype.enableScissorTest=function(m){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(m)},Jr.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Jr.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Jr.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Jr.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Jr.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Jr.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Jr.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Jr.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Jr.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Jr.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Jr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(m){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=m}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(m){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=m}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(m){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=m===!0?Pa:ro}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(dr.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Po.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(m){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=m}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(m){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=m}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(m){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=m}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(m){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=m}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(m){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=m}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(m){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=m}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(m){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=m}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(m){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=m}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(m){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=m}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(m){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=m}}}),ip.prototype.load=function(m){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return new ul().load(m,function(i){t.setBuffer(i)}),this},op.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Sc.prototype.updateCubeMap=function(m,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(m,t)},Sc.prototype.clear=function(m,t,i,a){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(m,t,i,a)},zs.crossOrigin=void 0,zs.loadTexture=function(m,t,i,a){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const u=new Lp;u.setCrossOrigin(this.crossOrigin);const d=u.load(m,i,void 0,a);return t&&(d.mapping=t),d},zs.loadTextureCube=function(m,t,i,a){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const u=new Ip;u.setCrossOrigin(this.crossOrigin);const d=u.load(m,i,void 0,a);return t&&(d.mapping=t),d},zs.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},zs.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Pg={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Cg(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:it}})),typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=it)},function(Re,C,S){var it=S(25),j=S(26);function dt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}C.parse=F,C.resolve=function(Y,$){return F(Y,!1,!0).resolve($)},C.resolveObject=function(Y,$){return Y?F(Y,!1,!0).resolveObject($):$},C.format=function(Y){return j.isString(Y)&&(Y=F(Y)),Y instanceof dt?Y.format():dt.prototype.format.call(Y)},C.Url=dt;var ot=/^([a-z0-9.+-]+:)/i,X=/:[0-9]*$/,ft=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,tt=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),J=["'"].concat(tt),lt=["%","/","?",";","#"].concat(J),Ft=["/","?","#"],jt=/^[+a-z0-9A-Z_-]{0,63}$/,kt=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,I={javascript:!0,"javascript:":!0},B={javascript:!0,"javascript:":!0},V={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},ut=S(27);function F(Y,$,ct){if(Y&&j.isObject(Y)&&Y instanceof dt)return Y;var se=new dt;return se.parse(Y,$,ct),se}dt.prototype.parse=function(Y,$,ct){if(!j.isString(Y))throw new TypeError("Parameter 'url' must be a string, not "+typeof Y);var se=Y.indexOf("?"),Le=se!==-1&&se<Y.indexOf("#")?"?":"#",ee=Y.split(Le);ee[0]=ee[0].replace(/\\/g,"/");var xt=Y=ee.join(Le);if(xt=xt.trim(),!ct&&Y.split("#").length===1){var Zt=ft.exec(xt);if(Zt)return this.path=xt,this.href=xt,this.pathname=Zt[1],Zt[2]?(this.search=Zt[2],this.query=$?ut.parse(this.search.substr(1)):this.search.substr(1)):$&&(this.search="",this.query={}),this}var $t=ot.exec(xt);if($t){var Q=($t=$t[0]).toLowerCase();this.protocol=Q,xt=xt.substr($t.length)}if(ct||$t||xt.match(/^\/\/[^@\/]+@[^@\/]+/)){var Bt=xt.substr(0,2)==="//";!Bt||$t&&B[$t]||(xt=xt.substr(2),this.slashes=!0)}if(!B[$t]&&(Bt||$t&&!V[$t])){for(var Wt,Kt,Xt=-1,oe=0;oe<Ft.length;oe++)(de=xt.indexOf(Ft[oe]))!==-1&&(Xt===-1||de<Xt)&&(Xt=de);for((Kt=Xt===-1?xt.lastIndexOf("@"):xt.lastIndexOf("@",Xt))!==-1&&(Wt=xt.slice(0,Kt),xt=xt.slice(Kt+1),this.auth=decodeURIComponent(Wt)),Xt=-1,oe=0;oe<lt.length;oe++){var de;(de=xt.indexOf(lt[oe]))!==-1&&(Xt===-1||de<Xt)&&(Xt=de)}Xt===-1&&(Xt=xt.length),this.host=xt.slice(0,Xt),xt=xt.slice(Xt),this.parseHost(),this.hostname=this.hostname||"";var $e=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!$e)for(var Ue=this.hostname.split(/\./),Zn=(oe=0,Ue.length);oe<Zn;oe++){var Ke=Ue[oe];if(Ke&&!Ke.match(jt)){for(var Un="",Hn=0,er=Ke.length;Hn<er;Hn++)Ke.charCodeAt(Hn)>127?Un+="x":Un+=Ke[Hn];if(!Un.match(jt)){var bn=Ue.slice(0,oe),Cr=Ue.slice(oe+1),Lr=Ke.match(kt);Lr&&(bn.push(Lr[1]),Cr.unshift(Lr[2])),Cr.length&&(xt="/"+Cr.join(".")+xt),this.hostname=bn.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),$e||(this.hostname=it.toASCII(this.hostname));var Rr=this.port?":"+this.port:"",Yr=this.hostname||"";this.host=Yr+Rr,this.href+=this.host,$e&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),xt[0]!=="/"&&(xt="/"+xt))}if(!I[Q])for(oe=0,Zn=J.length;oe<Zn;oe++){var Ar=J[oe];if(xt.indexOf(Ar)!==-1){var yr=encodeURIComponent(Ar);yr===Ar&&(yr=escape(Ar)),xt=xt.split(Ar).join(yr)}}var Ri=xt.indexOf("#");Ri!==-1&&(this.hash=xt.substr(Ri),xt=xt.slice(0,Ri));var Or=xt.indexOf("?");if(Or!==-1?(this.search=xt.substr(Or),this.query=xt.substr(Or+1),$&&(this.query=ut.parse(this.query)),xt=xt.slice(0,Or)):$&&(this.search="",this.query={}),xt&&(this.pathname=xt),V[Q]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){Rr=this.pathname||"";var Er=this.search||"";this.path=Rr+Er}return this.href=this.format(),this},dt.prototype.format=function(){var Y=this.auth||"";Y&&(Y=(Y=encodeURIComponent(Y)).replace(/%3A/i,":"),Y+="@");var $=this.protocol||"",ct=this.pathname||"",se=this.hash||"",Le=!1,ee="";this.host?Le=Y+this.host:this.hostname&&(Le=Y+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(Le+=":"+this.port)),this.query&&j.isObject(this.query)&&Object.keys(this.query).length&&(ee=ut.stringify(this.query));var xt=this.search||ee&&"?"+ee||"";return $&&$.substr(-1)!==":"&&($+=":"),this.slashes||(!$||V[$])&&Le!==!1?(Le="//"+(Le||""),ct&&ct.charAt(0)!=="/"&&(ct="/"+ct)):Le||(Le=""),se&&se.charAt(0)!=="#"&&(se="#"+se),xt&&xt.charAt(0)!=="?"&&(xt="?"+xt),$+Le+(ct=ct.replace(/[?#]/g,function(Zt){return encodeURIComponent(Zt)}))+(xt=xt.replace("#","%23"))+se},dt.prototype.resolve=function(Y){return this.resolveObject(F(Y,!1,!0)).format()},dt.prototype.resolveObject=function(Y){if(j.isString(Y)){var $=new dt;$.parse(Y,!1,!0),Y=$}for(var ct=new dt,se=Object.keys(this),Le=0;Le<se.length;Le++){var ee=se[Le];ct[ee]=this[ee]}if(ct.hash=Y.hash,Y.href==="")return ct.href=ct.format(),ct;if(Y.slashes&&!Y.protocol){for(var xt=Object.keys(Y),Zt=0;Zt<xt.length;Zt++){var $t=xt[Zt];$t!=="protocol"&&(ct[$t]=Y[$t])}return V[ct.protocol]&&ct.hostname&&!ct.pathname&&(ct.path=ct.pathname="/"),ct.href=ct.format(),ct}if(Y.protocol&&Y.protocol!==ct.protocol){if(!V[Y.protocol]){for(var Q=Object.keys(Y),Bt=0;Bt<Q.length;Bt++){var Wt=Q[Bt];ct[Wt]=Y[Wt]}return ct.href=ct.format(),ct}if(ct.protocol=Y.protocol,Y.host||B[Y.protocol])ct.pathname=Y.pathname;else{for(var Kt=(Y.pathname||"").split("/");Kt.length&&!(Y.host=Kt.shift()););Y.host||(Y.host=""),Y.hostname||(Y.hostname=""),Kt[0]!==""&&Kt.unshift(""),Kt.length<2&&Kt.unshift(""),ct.pathname=Kt.join("/")}if(ct.search=Y.search,ct.query=Y.query,ct.host=Y.host||"",ct.auth=Y.auth,ct.hostname=Y.hostname||Y.host,ct.port=Y.port,ct.pathname||ct.search){var Xt=ct.pathname||"",oe=ct.search||"";ct.path=Xt+oe}return ct.slashes=ct.slashes||Y.slashes,ct.href=ct.format(),ct}var de=ct.pathname&&ct.pathname.charAt(0)==="/",$e=Y.host||Y.pathname&&Y.pathname.charAt(0)==="/",Ue=$e||de||ct.host&&Y.pathname,Zn=Ue,Ke=ct.pathname&&ct.pathname.split("/")||[],Un=(Kt=Y.pathname&&Y.pathname.split("/")||[],ct.protocol&&!V[ct.protocol]);if(Un&&(ct.hostname="",ct.port=null,ct.host&&(Ke[0]===""?Ke[0]=ct.host:Ke.unshift(ct.host)),ct.host="",Y.protocol&&(Y.hostname=null,Y.port=null,Y.host&&(Kt[0]===""?Kt[0]=Y.host:Kt.unshift(Y.host)),Y.host=null),Ue=Ue&&(Kt[0]===""||Ke[0]==="")),$e)ct.host=Y.host||Y.host===""?Y.host:ct.host,ct.hostname=Y.hostname||Y.hostname===""?Y.hostname:ct.hostname,ct.search=Y.search,ct.query=Y.query,Ke=Kt;else if(Kt.length)Ke||(Ke=[]),Ke.pop(),Ke=Ke.concat(Kt),ct.search=Y.search,ct.query=Y.query;else if(!j.isNullOrUndefined(Y.search))return Un&&(ct.hostname=ct.host=Ke.shift(),(Lr=!!(ct.host&&ct.host.indexOf("@")>0)&&ct.host.split("@"))&&(ct.auth=Lr.shift(),ct.host=ct.hostname=Lr.shift())),ct.search=Y.search,ct.query=Y.query,j.isNull(ct.pathname)&&j.isNull(ct.search)||(ct.path=(ct.pathname?ct.pathname:"")+(ct.search?ct.search:"")),ct.href=ct.format(),ct;if(!Ke.length)return ct.pathname=null,ct.search?ct.path="/"+ct.search:ct.path=null,ct.href=ct.format(),ct;for(var Hn=Ke.slice(-1)[0],er=(ct.host||Y.host||Ke.length>1)&&(Hn==="."||Hn==="..")||Hn==="",bn=0,Cr=Ke.length;Cr>=0;Cr--)(Hn=Ke[Cr])==="."?Ke.splice(Cr,1):Hn===".."?(Ke.splice(Cr,1),bn++):bn&&(Ke.splice(Cr,1),bn--);if(!Ue&&!Zn)for(;bn--;bn)Ke.unshift("..");!Ue||Ke[0]===""||Ke[0]&&Ke[0].charAt(0)==="/"||Ke.unshift(""),er&&Ke.join("/").substr(-1)!=="/"&&Ke.push("");var Lr,Rr=Ke[0]===""||Ke[0]&&Ke[0].charAt(0)==="/";return Un&&(ct.hostname=ct.host=Rr?"":Ke.length?Ke.shift():"",(Lr=!!(ct.host&&ct.host.indexOf("@")>0)&&ct.host.split("@"))&&(ct.auth=Lr.shift(),ct.host=ct.hostname=Lr.shift())),(Ue=Ue||ct.host&&Ke.length)&&!Rr&&Ke.unshift(""),Ke.length?ct.pathname=Ke.join("/"):(ct.pathname=null,ct.path=null),j.isNull(ct.pathname)&&j.isNull(ct.search)||(ct.path=(ct.pathname?ct.pathname:"")+(ct.search?ct.search:"")),ct.auth=Y.auth||ct.auth,ct.slashes=ct.slashes||Y.slashes,ct.href=ct.format(),ct},dt.prototype.parseHost=function(){var Y=this.host,$=X.exec(Y);$&&(($=$[0])!==":"&&(this.port=$.substr(1)),Y=Y.substr(0,Y.length-$.length)),Y&&(this.hostname=Y)}},function(Re,C,S){(function(it){Re.exports=function j(dt,ot,X){function ft(lt,Ft){if(!ot[lt]){if(!dt[lt]){if(tt)return tt(lt,!0);var jt=new Error("Cannot find module '"+lt+"'");throw jt.code="MODULE_NOT_FOUND",jt}var kt=ot[lt]={exports:{}};dt[lt][0].call(kt.exports,function(I){var B=dt[lt][1][I];return ft(B||I)},kt,kt.exports,j,dt,ot,X)}return ot[lt].exports}for(var tt=!1,J=0;J<X.length;J++)ft(X[J]);return ft}({1:[function(j,dt,ot){(function(X){var ft,tt,J=X.MutationObserver||X.WebKitMutationObserver;if(J){var lt=0,Ft=new J(B),jt=X.document.createTextNode("");Ft.observe(jt,{characterData:!0}),ft=function(){jt.data=lt=++lt%2}}else if(X.setImmediate||X.MessageChannel===void 0)ft="document"in X&&"onreadystatechange"in X.document.createElement("script")?function(){var V=X.document.createElement("script");V.onreadystatechange=function(){B(),V.onreadystatechange=null,V.parentNode.removeChild(V),V=null},X.document.documentElement.appendChild(V)}:function(){setTimeout(B,0)};else{var kt=new X.MessageChannel;kt.port1.onmessage=B,ft=function(){kt.port2.postMessage(0)}}var I=[];function B(){var V,ut;tt=!0;for(var F=I.length;F;){for(ut=I,I=[],V=-1;++V<F;)ut[V]();F=I.length}tt=!1}dt.exports=function(V){I.push(V)!==1||tt||ft()}}).call(this,it!==void 0?it:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(j,dt,ot){var X=j(1);function ft(){}var tt={},J=["REJECTED"],lt=["FULFILLED"],Ft=["PENDING"];function jt(F){if(typeof F!="function")throw new TypeError("resolver must be a function");this.state=Ft,this.queue=[],this.outcome=void 0,F!==ft&&V(this,F)}function kt(F,Y,$){this.promise=F,typeof Y=="function"&&(this.onFulfilled=Y,this.callFulfilled=this.otherCallFulfilled),typeof $=="function"&&(this.onRejected=$,this.callRejected=this.otherCallRejected)}function I(F,Y,$){X(function(){var ct;try{ct=Y($)}catch(se){return tt.reject(F,se)}ct===F?tt.reject(F,new TypeError("Cannot resolve promise with itself")):tt.resolve(F,ct)})}function B(F){var Y=F&&F.then;if(F&&(typeof F=="object"||typeof F=="function")&&typeof Y=="function")return function(){Y.apply(F,arguments)}}function V(F,Y){var $=!1;function ct(ee){$||($=!0,tt.reject(F,ee))}function se(ee){$||($=!0,tt.resolve(F,ee))}var Le=ut(function(){Y(se,ct)});Le.status==="error"&&ct(Le.value)}function ut(F,Y){var $={};try{$.value=F(Y),$.status="success"}catch(ct){$.status="error",$.value=ct}return $}dt.exports=jt,jt.prototype.catch=function(F){return this.then(null,F)},jt.prototype.then=function(F,Y){if(typeof F!="function"&&this.state===lt||typeof Y!="function"&&this.state===J)return this;var $=new this.constructor(ft);return this.state!==Ft?I($,this.state===lt?F:Y,this.outcome):this.queue.push(new kt($,F,Y)),$},kt.prototype.callFulfilled=function(F){tt.resolve(this.promise,F)},kt.prototype.otherCallFulfilled=function(F){I(this.promise,this.onFulfilled,F)},kt.prototype.callRejected=function(F){tt.reject(this.promise,F)},kt.prototype.otherCallRejected=function(F){I(this.promise,this.onRejected,F)},tt.resolve=function(F,Y){var $=ut(B,Y);if($.status==="error")return tt.reject(F,$.value);var ct=$.value;if(ct)V(F,ct);else{F.state=lt,F.outcome=Y;for(var se=-1,Le=F.queue.length;++se<Le;)F.queue[se].callFulfilled(Y)}return F},tt.reject=function(F,Y){F.state=J,F.outcome=Y;for(var $=-1,ct=F.queue.length;++$<ct;)F.queue[$].callRejected(Y);return F},jt.resolve=function(F){return F instanceof this?F:tt.resolve(new this(ft),F)},jt.reject=function(F){var Y=new this(ft);return tt.reject(Y,F)},jt.all=function(F){var Y=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var $=F.length,ct=!1;if(!$)return this.resolve([]);for(var se=new Array($),Le=0,ee=-1,xt=new this(ft);++ee<$;)Zt(F[ee],ee);return xt;function Zt($t,Q){Y.resolve($t).then(function(Bt){se[Q]=Bt,++Le!==$||ct||(ct=!0,tt.resolve(xt,se))},function(Bt){ct||(ct=!0,tt.reject(xt,Bt))})}},jt.race=function(F){var Y=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var $=F.length,ct=!1;if(!$)return this.resolve([]);for(var se,Le=-1,ee=new this(ft);++Le<$;)se=F[Le],Y.resolve(se).then(function(xt){ct||(ct=!0,tt.resolve(ee,xt))},function(xt){ct||(ct=!0,tt.reject(ee,xt))});return ee}},{1:1}],3:[function(j,dt,ot){(function(X){typeof X.Promise!="function"&&(X.Promise=j(2))}).call(this,it!==void 0?it:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(j,dt,ot){var X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},ft=function(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch{return}}();function tt(L,k){L=L||[],k=k||{};try{return new Blob(L,k)}catch(K){if(K.name!=="TypeError")throw K;for(var G=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder),st=0;st<L.length;st+=1)G.append(L[st]);return G.getBlob(k.type)}}typeof Promise=="undefined"&&j(3);var J=Promise;function lt(L,k){k&&L.then(function(G){k(null,G)},function(G){k(G)})}function Ft(L,k,G){typeof k=="function"&&L.then(k),typeof G=="function"&&L.catch(G)}function jt(L){return typeof L!="string"&&(console.warn(L+" used as a key, but it is not a string."),L=String(L)),L}function kt(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var I=void 0,B={},V=Object.prototype.toString;function ut(L){return typeof I=="boolean"?J.resolve(I):function(k){return new J(function(G){var st=k.transaction("local-forage-detect-blob-support","readwrite"),K=tt([""]);st.objectStore("local-forage-detect-blob-support").put(K,"key"),st.onabort=function(et){et.preventDefault(),et.stopPropagation(),G(!1)},st.oncomplete=function(){var et=navigator.userAgent.match(/Chrome\/(\d+)/),vt=navigator.userAgent.match(/Edge\//);G(vt||!et||parseInt(et[1],10)>=43)}}).catch(function(){return!1})}(L).then(function(k){return I=k})}function F(L){var k=B[L.name],G={};G.promise=new J(function(st,K){G.resolve=st,G.reject=K}),k.deferredOperations.push(G),k.dbReady?k.dbReady=k.dbReady.then(function(){return G.promise}):k.dbReady=G.promise}function Y(L){var k=B[L.name].deferredOperations.pop();if(k)return k.resolve(),k.promise}function $(L,k){var G=B[L.name].deferredOperations.pop();if(G)return G.reject(k),G.promise}function ct(L,k){return new J(function(G,st){if(B[L.name]=B[L.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},L.db){if(!k)return G(L.db);F(L),L.db.close()}var K=[L.name];k&&K.push(L.version);var et=ft.open.apply(ft,K);k&&(et.onupgradeneeded=function(vt){var wt=et.result;try{wt.createObjectStore(L.storeName),vt.oldVersion<=1&&wt.createObjectStore("local-forage-detect-blob-support")}catch(Ct){if(Ct.name!=="ConstraintError")throw Ct;console.warn('The database "'+L.name+'" has been upgraded from version '+vt.oldVersion+" to version "+vt.newVersion+', but the storage "'+L.storeName+'" already exists.')}}),et.onerror=function(vt){vt.preventDefault(),st(et.error)},et.onsuccess=function(){var vt=et.result;vt.onversionchange=function(wt){wt.target.close()},G(vt),Y(L)}})}function se(L){return ct(L,!1)}function Le(L){return ct(L,!0)}function ee(L,k){if(!L.db)return!0;var G=!L.db.objectStoreNames.contains(L.storeName),st=L.version<L.db.version,K=L.version>L.db.version;if(st&&(L.version!==k&&console.warn('The database "'+L.name+`" can't be downgraded from version `+L.db.version+" to version "+L.version+"."),L.version=L.db.version),K||G){if(G){var et=L.db.version+1;et>L.version&&(L.version=et)}return!0}return!1}function xt(L){return tt([function(k){for(var G=k.length,st=new ArrayBuffer(G),K=new Uint8Array(st),et=0;et<G;et++)K[et]=k.charCodeAt(et);return st}(atob(L.data))],{type:L.type})}function Zt(L){return L&&L.__local_forage_encoded_blob}function $t(L){var k=this,G=k._initReady().then(function(){var st=B[k._dbInfo.name];if(st&&st.dbReady)return st.dbReady});return Ft(G,L,L),G}function Q(L,k,G,st){st===void 0&&(st=1);try{var K=L.db.transaction(L.storeName,k);G(null,K)}catch(et){if(st>0&&(!L.db||et.name==="InvalidStateError"||et.name==="NotFoundError"))return J.resolve().then(function(){if(!L.db||et.name==="NotFoundError"&&!L.db.objectStoreNames.contains(L.storeName)&&L.version<=L.db.version)return L.db&&(L.version=L.db.version+1),Le(L)}).then(function(){return function(vt){F(vt);for(var wt=B[vt.name],Ct=wt.forages,St=0;St<Ct.length;St++){var Ut=Ct[St];Ut._dbInfo.db&&(Ut._dbInfo.db.close(),Ut._dbInfo.db=null)}return vt.db=null,se(vt).then(function(ne){return vt.db=ne,ee(vt)?Le(vt):ne}).then(function(ne){vt.db=wt.db=ne;for(var Vt=0;Vt<Ct.length;Vt++)Ct[Vt]._dbInfo.db=ne}).catch(function(ne){throw $(vt,ne),ne})}(L).then(function(){Q(L,k,G,st-1)})}).catch(G);G(et)}}var Bt={_driver:"asyncStorage",_initStorage:function(L){var k=this,G={db:null};if(L)for(var st in L)G[st]=L[st];var K=B[G.name];K||(K={forages:[],db:null,dbReady:null,deferredOperations:[]},B[G.name]=K),K.forages.push(k),k._initReady||(k._initReady=k.ready,k.ready=$t);var et=[];function vt(){return J.resolve()}for(var wt=0;wt<K.forages.length;wt++){var Ct=K.forages[wt];Ct!==k&&et.push(Ct._initReady().catch(vt))}var St=K.forages.slice(0);return J.all(et).then(function(){return G.db=K.db,se(G)}).then(function(Ut){return G.db=Ut,ee(G,k._defaultConfig.version)?Le(G):Ut}).then(function(Ut){G.db=K.db=Ut,k._dbInfo=G;for(var ne=0;ne<St.length;ne++){var Vt=St[ne];Vt!==k&&(Vt._dbInfo.db=G.db,Vt._dbInfo.version=G.version)}})},_support:function(){try{if(!ft||!ft.open)return!1;var L=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),k=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!L||k)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch{return!1}}(),iterate:function(L,k){var G=this,st=new J(function(K,et){G.ready().then(function(){Q(G._dbInfo,"readonly",function(vt,wt){if(vt)return et(vt);try{var Ct=wt.objectStore(G._dbInfo.storeName).openCursor(),St=1;Ct.onsuccess=function(){var Ut=Ct.result;if(Ut){var ne=Ut.value;Zt(ne)&&(ne=xt(ne));var Vt=L(ne,Ut.key,St++);Vt!==void 0?K(Vt):Ut.continue()}else K()},Ct.onerror=function(){et(Ct.error)}}catch(Ut){et(Ut)}})}).catch(et)});return lt(st,k),st},getItem:function(L,k){var G=this;L=jt(L);var st=new J(function(K,et){G.ready().then(function(){Q(G._dbInfo,"readonly",function(vt,wt){if(vt)return et(vt);try{var Ct=wt.objectStore(G._dbInfo.storeName).get(L);Ct.onsuccess=function(){var St=Ct.result;St===void 0&&(St=null),Zt(St)&&(St=xt(St)),K(St)},Ct.onerror=function(){et(Ct.error)}}catch(St){et(St)}})}).catch(et)});return lt(st,k),st},setItem:function(L,k,G){var st=this;L=jt(L);var K=new J(function(et,vt){var wt;st.ready().then(function(){return wt=st._dbInfo,V.call(k)==="[object Blob]"?ut(wt.db).then(function(Ct){return Ct?k:(St=k,new J(function(Ut,ne){var Vt=new FileReader;Vt.onerror=ne,Vt.onloadend=function(fn){var We=btoa(fn.target.result||"");Ut({__local_forage_encoded_blob:!0,data:We,type:St.type})},Vt.readAsBinaryString(St)}));var St}):k}).then(function(Ct){Q(st._dbInfo,"readwrite",function(St,Ut){if(St)return vt(St);try{var ne=Ut.objectStore(st._dbInfo.storeName);Ct===null&&(Ct=void 0);var Vt=ne.put(Ct,L);Ut.oncomplete=function(){Ct===void 0&&(Ct=null),et(Ct)},Ut.onabort=Ut.onerror=function(){var fn=Vt.error?Vt.error:Vt.transaction.error;vt(fn)}}catch(fn){vt(fn)}})}).catch(vt)});return lt(K,G),K},removeItem:function(L,k){var G=this;L=jt(L);var st=new J(function(K,et){G.ready().then(function(){Q(G._dbInfo,"readwrite",function(vt,wt){if(vt)return et(vt);try{var Ct=wt.objectStore(G._dbInfo.storeName).delete(L);wt.oncomplete=function(){K()},wt.onerror=function(){et(Ct.error)},wt.onabort=function(){var St=Ct.error?Ct.error:Ct.transaction.error;et(St)}}catch(St){et(St)}})}).catch(et)});return lt(st,k),st},clear:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){Q(k._dbInfo,"readwrite",function(et,vt){if(et)return K(et);try{var wt=vt.objectStore(k._dbInfo.storeName).clear();vt.oncomplete=function(){st()},vt.onabort=vt.onerror=function(){var Ct=wt.error?wt.error:wt.transaction.error;K(Ct)}}catch(Ct){K(Ct)}})}).catch(K)});return lt(G,L),G},length:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){Q(k._dbInfo,"readonly",function(et,vt){if(et)return K(et);try{var wt=vt.objectStore(k._dbInfo.storeName).count();wt.onsuccess=function(){st(wt.result)},wt.onerror=function(){K(wt.error)}}catch(Ct){K(Ct)}})}).catch(K)});return lt(G,L),G},key:function(L,k){var G=this,st=new J(function(K,et){L<0?K(null):G.ready().then(function(){Q(G._dbInfo,"readonly",function(vt,wt){if(vt)return et(vt);try{var Ct=wt.objectStore(G._dbInfo.storeName),St=!1,Ut=Ct.openKeyCursor();Ut.onsuccess=function(){var ne=Ut.result;ne?L===0||St?K(ne.key):(St=!0,ne.advance(L)):K(null)},Ut.onerror=function(){et(Ut.error)}}catch(ne){et(ne)}})}).catch(et)});return lt(st,k),st},keys:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){Q(k._dbInfo,"readonly",function(et,vt){if(et)return K(et);try{var wt=vt.objectStore(k._dbInfo.storeName).openKeyCursor(),Ct=[];wt.onsuccess=function(){var St=wt.result;St?(Ct.push(St.key),St.continue()):st(Ct)},wt.onerror=function(){K(wt.error)}}catch(St){K(St)}})}).catch(K)});return lt(G,L),G},dropInstance:function(L,k){k=kt.apply(this,arguments);var G=this.config();(L=typeof L!="function"&&L||{}).name||(L.name=L.name||G.name,L.storeName=L.storeName||G.storeName);var st,K=this;if(L.name){var et=L.name===G.name&&K._dbInfo.db,vt=et?J.resolve(K._dbInfo.db):se(L).then(function(wt){var Ct=B[L.name],St=Ct.forages;Ct.db=wt;for(var Ut=0;Ut<St.length;Ut++)St[Ut]._dbInfo.db=wt;return wt});st=L.storeName?vt.then(function(wt){if(wt.objectStoreNames.contains(L.storeName)){var Ct=wt.version+1;F(L);var St=B[L.name],Ut=St.forages;wt.close();for(var ne=0;ne<Ut.length;ne++){var Vt=Ut[ne];Vt._dbInfo.db=null,Vt._dbInfo.version=Ct}return new J(function(fn,We){var sr=ft.open(L.name,Ct);sr.onerror=function(Ii){sr.result.close(),We(Ii)},sr.onupgradeneeded=function(){sr.result.deleteObjectStore(L.storeName)},sr.onsuccess=function(){var Ii=sr.result;Ii.close(),fn(Ii)}}).then(function(fn){St.db=fn;for(var We=0;We<Ut.length;We++){var sr=Ut[We];sr._dbInfo.db=fn,Y(sr._dbInfo)}}).catch(function(fn){throw($(L,fn)||J.resolve()).catch(function(){}),fn})}}):vt.then(function(wt){F(L);var Ct=B[L.name],St=Ct.forages;wt.close();for(var Ut=0;Ut<St.length;Ut++)St[Ut]._dbInfo.db=null;return new J(function(ne,Vt){var fn=ft.deleteDatabase(L.name);fn.onerror=function(){var We=fn.result;We&&We.close(),Vt(fn.error)},fn.onblocked=function(){console.warn('dropInstance blocked for database "'+L.name+'" until all open connections are closed')},fn.onsuccess=function(){var We=fn.result;We&&We.close(),ne(We)}}).then(function(ne){Ct.db=ne;for(var Vt=0;Vt<St.length;Vt++)Y(St[Vt]._dbInfo)}).catch(function(ne){throw($(L,ne)||J.resolve()).catch(function(){}),ne})})}else st=J.reject("Invalid arguments");return lt(st,k),st}},Wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Kt=/^~~local_forage_type~([^~]+)~/,Xt="__lfsc__:".length,oe=Xt+"arbf".length,de=Object.prototype.toString;function $e(L){var k,G,st,K,et,vt=.75*L.length,wt=L.length,Ct=0;L[L.length-1]==="="&&(vt--,L[L.length-2]==="="&&vt--);var St=new ArrayBuffer(vt),Ut=new Uint8Array(St);for(k=0;k<wt;k+=4)G=Wt.indexOf(L[k]),st=Wt.indexOf(L[k+1]),K=Wt.indexOf(L[k+2]),et=Wt.indexOf(L[k+3]),Ut[Ct++]=G<<2|st>>4,Ut[Ct++]=(15&st)<<4|K>>2,Ut[Ct++]=(3&K)<<6|63&et;return St}function Ue(L){var k,G=new Uint8Array(L),st="";for(k=0;k<G.length;k+=3)st+=Wt[G[k]>>2],st+=Wt[(3&G[k])<<4|G[k+1]>>4],st+=Wt[(15&G[k+1])<<2|G[k+2]>>6],st+=Wt[63&G[k+2]];return G.length%3==2?st=st.substring(0,st.length-1)+"=":G.length%3==1&&(st=st.substring(0,st.length-2)+"=="),st}var Zn={serialize:function(L,k){var G="";if(L&&(G=de.call(L)),L&&(G==="[object ArrayBuffer]"||L.buffer&&de.call(L.buffer)==="[object ArrayBuffer]")){var st,K="__lfsc__:";L instanceof ArrayBuffer?(st=L,K+="arbf"):(st=L.buffer,G==="[object Int8Array]"?K+="si08":G==="[object Uint8Array]"?K+="ui08":G==="[object Uint8ClampedArray]"?K+="uic8":G==="[object Int16Array]"?K+="si16":G==="[object Uint16Array]"?K+="ur16":G==="[object Int32Array]"?K+="si32":G==="[object Uint32Array]"?K+="ui32":G==="[object Float32Array]"?K+="fl32":G==="[object Float64Array]"?K+="fl64":k(new Error("Failed to get type for BinaryArray"))),k(K+Ue(st))}else if(G==="[object Blob]"){var et=new FileReader;et.onload=function(){var vt="~~local_forage_type~"+L.type+"~"+Ue(this.result);k("__lfsc__:blob"+vt)},et.readAsArrayBuffer(L)}else try{k(JSON.stringify(L))}catch(vt){console.error("Couldn't convert value into a JSON string: ",L),k(null,vt)}},deserialize:function(L){if(L.substring(0,Xt)!=="__lfsc__:")return JSON.parse(L);var k,G=L.substring(oe),st=L.substring(Xt,oe);if(st==="blob"&&Kt.test(G)){var K=G.match(Kt);k=K[1],G=G.substring(K[0].length)}var et=$e(G);switch(st){case"arbf":return et;case"blob":return tt([et],{type:k});case"si08":return new Int8Array(et);case"ui08":return new Uint8Array(et);case"uic8":return new Uint8ClampedArray(et);case"si16":return new Int16Array(et);case"ur16":return new Uint16Array(et);case"si32":return new Int32Array(et);case"ui32":return new Uint32Array(et);case"fl32":return new Float32Array(et);case"fl64":return new Float64Array(et);default:throw new Error("Unkown type: "+st)}},stringToBuffer:$e,bufferToString:Ue};function Ke(L,k,G,st){L.executeSql("CREATE TABLE IF NOT EXISTS "+k.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],G,st)}function Un(L,k,G,st,K,et){L.executeSql(G,st,K,function(vt,wt){wt.code===wt.SYNTAX_ERR?vt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[k.storeName],function(Ct,St){St.rows.length?et(Ct,wt):Ke(Ct,k,function(){Ct.executeSql(G,st,K,et)},et)},et):et(vt,wt)},et)}function Hn(L,k,G,st){var K=this;L=jt(L);var et=new J(function(vt,wt){K.ready().then(function(){k===void 0&&(k=null);var Ct=k,St=K._dbInfo;St.serializer.serialize(k,function(Ut,ne){ne?wt(ne):St.db.transaction(function(Vt){Un(Vt,St,"INSERT OR REPLACE INTO "+St.storeName+" (key, value) VALUES (?, ?)",[L,Ut],function(){vt(Ct)},function(fn,We){wt(We)})},function(Vt){if(Vt.code===Vt.QUOTA_ERR){if(st>0)return void vt(Hn.apply(K,[L,Ct,G,st-1]));wt(Vt)}})})}).catch(wt)});return lt(et,G),et}function er(L){return new J(function(k,G){L.transaction(function(st){st.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(K,et){for(var vt=[],wt=0;wt<et.rows.length;wt++)vt.push(et.rows.item(wt).name);k({db:L,storeNames:vt})},function(K,et){G(et)})},function(st){G(st)})})}var bn={_driver:"webSQLStorage",_initStorage:function(L){var k=this,G={db:null};if(L)for(var st in L)G[st]=typeof L[st]!="string"?L[st].toString():L[st];var K=new J(function(et,vt){try{G.db=openDatabase(G.name,String(G.version),G.description,G.size)}catch(wt){return vt(wt)}G.db.transaction(function(wt){Ke(wt,G,function(){k._dbInfo=G,et()},function(Ct,St){vt(St)})},vt)});return G.serializer=Zn,K},_support:typeof openDatabase=="function",iterate:function(L,k){var G=this,st=new J(function(K,et){G.ready().then(function(){var vt=G._dbInfo;vt.db.transaction(function(wt){Un(wt,vt,"SELECT * FROM "+vt.storeName,[],function(Ct,St){for(var Ut=St.rows,ne=Ut.length,Vt=0;Vt<ne;Vt++){var fn=Ut.item(Vt),We=fn.value;if(We&&(We=vt.serializer.deserialize(We)),(We=L(We,fn.key,Vt+1))!==void 0)return void K(We)}K()},function(Ct,St){et(St)})})}).catch(et)});return lt(st,k),st},getItem:function(L,k){var G=this;L=jt(L);var st=new J(function(K,et){G.ready().then(function(){var vt=G._dbInfo;vt.db.transaction(function(wt){Un(wt,vt,"SELECT * FROM "+vt.storeName+" WHERE key = ? LIMIT 1",[L],function(Ct,St){var Ut=St.rows.length?St.rows.item(0).value:null;Ut&&(Ut=vt.serializer.deserialize(Ut)),K(Ut)},function(Ct,St){et(St)})})}).catch(et)});return lt(st,k),st},setItem:function(L,k,G){return Hn.apply(this,[L,k,G,1])},removeItem:function(L,k){var G=this;L=jt(L);var st=new J(function(K,et){G.ready().then(function(){var vt=G._dbInfo;vt.db.transaction(function(wt){Un(wt,vt,"DELETE FROM "+vt.storeName+" WHERE key = ?",[L],function(){K()},function(Ct,St){et(St)})})}).catch(et)});return lt(st,k),st},clear:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){var et=k._dbInfo;et.db.transaction(function(vt){Un(vt,et,"DELETE FROM "+et.storeName,[],function(){st()},function(wt,Ct){K(Ct)})})}).catch(K)});return lt(G,L),G},length:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){var et=k._dbInfo;et.db.transaction(function(vt){Un(vt,et,"SELECT COUNT(key) as c FROM "+et.storeName,[],function(wt,Ct){var St=Ct.rows.item(0).c;st(St)},function(wt,Ct){K(Ct)})})}).catch(K)});return lt(G,L),G},key:function(L,k){var G=this,st=new J(function(K,et){G.ready().then(function(){var vt=G._dbInfo;vt.db.transaction(function(wt){Un(wt,vt,"SELECT key FROM "+vt.storeName+" WHERE id = ? LIMIT 1",[L+1],function(Ct,St){var Ut=St.rows.length?St.rows.item(0).key:null;K(Ut)},function(Ct,St){et(St)})})}).catch(et)});return lt(st,k),st},keys:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){var et=k._dbInfo;et.db.transaction(function(vt){Un(vt,et,"SELECT key FROM "+et.storeName,[],function(wt,Ct){for(var St=[],Ut=0;Ut<Ct.rows.length;Ut++)St.push(Ct.rows.item(Ut).key);st(St)},function(wt,Ct){K(Ct)})})}).catch(K)});return lt(G,L),G},dropInstance:function(L,k){k=kt.apply(this,arguments);var G=this.config();(L=typeof L!="function"&&L||{}).name||(L.name=L.name||G.name,L.storeName=L.storeName||G.storeName);var st,K=this;return lt(st=L.name?new J(function(et){var vt;vt=L.name===G.name?K._dbInfo.db:openDatabase(L.name,"","",0),L.storeName?et({db:vt,storeNames:[L.storeName]}):et(er(vt))}).then(function(et){return new J(function(vt,wt){et.db.transaction(function(Ct){function St(fn){return new J(function(We,sr){Ct.executeSql("DROP TABLE IF EXISTS "+fn,[],function(){We()},function(Ii,ui){sr(ui)})})}for(var Ut=[],ne=0,Vt=et.storeNames.length;ne<Vt;ne++)Ut.push(St(et.storeNames[ne]));J.all(Ut).then(function(){vt()}).catch(function(fn){wt(fn)})},function(Ct){wt(Ct)})})}):J.reject("Invalid arguments"),k),st}};function Cr(L,k){var G=L.name+"/";return L.storeName!==k.storeName&&(G+=L.storeName+"/"),G}function Lr(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch{return!0}}()||localStorage.length>0}var Rr={_driver:"localStorageWrapper",_initStorage:function(L){var k={};if(L)for(var G in L)k[G]=L[G];return k.keyPrefix=Cr(L,this._defaultConfig),Lr()?(this._dbInfo=k,k.serializer=Zn,J.resolve()):J.reject()},_support:function(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function(L,k){var G=this,st=G.ready().then(function(){for(var K=G._dbInfo,et=K.keyPrefix,vt=et.length,wt=localStorage.length,Ct=1,St=0;St<wt;St++){var Ut=localStorage.key(St);if(Ut.indexOf(et)===0){var ne=localStorage.getItem(Ut);if(ne&&(ne=K.serializer.deserialize(ne)),(ne=L(ne,Ut.substring(vt),Ct++))!==void 0)return ne}}});return lt(st,k),st},getItem:function(L,k){var G=this;L=jt(L);var st=G.ready().then(function(){var K=G._dbInfo,et=localStorage.getItem(K.keyPrefix+L);return et&&(et=K.serializer.deserialize(et)),et});return lt(st,k),st},setItem:function(L,k,G){var st=this;L=jt(L);var K=st.ready().then(function(){k===void 0&&(k=null);var et=k;return new J(function(vt,wt){var Ct=st._dbInfo;Ct.serializer.serialize(k,function(St,Ut){if(Ut)wt(Ut);else try{localStorage.setItem(Ct.keyPrefix+L,St),vt(et)}catch(ne){ne.name!=="QuotaExceededError"&&ne.name!=="NS_ERROR_DOM_QUOTA_REACHED"||wt(ne),wt(ne)}})})});return lt(K,G),K},removeItem:function(L,k){var G=this;L=jt(L);var st=G.ready().then(function(){var K=G._dbInfo;localStorage.removeItem(K.keyPrefix+L)});return lt(st,k),st},clear:function(L){var k=this,G=k.ready().then(function(){for(var st=k._dbInfo.keyPrefix,K=localStorage.length-1;K>=0;K--){var et=localStorage.key(K);et.indexOf(st)===0&&localStorage.removeItem(et)}});return lt(G,L),G},length:function(L){var k=this.keys().then(function(G){return G.length});return lt(k,L),k},key:function(L,k){var G=this,st=G.ready().then(function(){var K,et=G._dbInfo;try{K=localStorage.key(L)}catch{K=null}return K&&(K=K.substring(et.keyPrefix.length)),K});return lt(st,k),st},keys:function(L){var k=this,G=k.ready().then(function(){for(var st=k._dbInfo,K=localStorage.length,et=[],vt=0;vt<K;vt++){var wt=localStorage.key(vt);wt.indexOf(st.keyPrefix)===0&&et.push(wt.substring(st.keyPrefix.length))}return et});return lt(G,L),G},dropInstance:function(L,k){if(k=kt.apply(this,arguments),!(L=typeof L!="function"&&L||{}).name){var G=this.config();L.name=L.name||G.name,L.storeName=L.storeName||G.storeName}var st,K=this;return lt(st=L.name?new J(function(et){L.storeName?et(Cr(L,K._defaultConfig)):et(L.name+"/")}).then(function(et){for(var vt=localStorage.length-1;vt>=0;vt--){var wt=localStorage.key(vt);wt.indexOf(et)===0&&localStorage.removeItem(wt)}}):J.reject("Invalid arguments"),k),st}},Yr=function(L,k){for(var G,st,K=L.length,et=0;et<K;){if((G=L[et])===(st=k)||typeof G=="number"&&typeof st=="number"&&isNaN(G)&&isNaN(st))return!0;et++}return!1},Ar=Array.isArray||function(L){return Object.prototype.toString.call(L)==="[object Array]"},yr={},Ri={},Or={INDEXEDDB:Bt,WEBSQL:bn,LOCALSTORAGE:Rr},Er=[Or.INDEXEDDB._driver,Or.WEBSQL._driver,Or.LOCALSTORAGE._driver],Fr=["dropInstance"],lo=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Fr),_s={description:"",driver:Er.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Fn(L,k){L[k]=function(){var G=arguments;return L.ready().then(function(){return L[k].apply(L,G)})}}function _i(){for(var L=1;L<arguments.length;L++){var k=arguments[L];if(k)for(var G in k)k.hasOwnProperty(G)&&(Ar(k[G])?arguments[0][G]=k[G].slice():arguments[0][G]=k[G])}return arguments[0]}var ki=new(function(){function L(k){for(var G in function(et,vt){if(!(et instanceof vt))throw new TypeError("Cannot call a class as a function")}(this,L),Or)if(Or.hasOwnProperty(G)){var st=Or[G],K=st._driver;this[G]=K,yr[K]||this.defineDriver(st)}this._defaultConfig=_i({},_s),this._config=_i({},this._defaultConfig,k),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return L.prototype.config=function(k){if((k===void 0?"undefined":X(k))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var G in k){if(G==="storeName"&&(k[G]=k[G].replace(/\W/g,"_")),G==="version"&&typeof k[G]!="number")return new Error("Database version must be a number.");this._config[G]=k[G]}return!("driver"in k)||!k.driver||this.setDriver(this._config.driver)}return typeof k=="string"?this._config[k]:this._config},L.prototype.defineDriver=function(k,G,st){var K=new J(function(et,vt){try{var wt=k._driver,Ct=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!k._driver)return void vt(Ct);for(var St=lo.concat("_initStorage"),Ut=0,ne=St.length;Ut<ne;Ut++){var Vt=St[Ut];if((!Yr(Fr,Vt)||k[Vt])&&typeof k[Vt]!="function")return void vt(Ct)}(function(){for(var We=function(Bo){return function(){var ho=new Error("Method "+Bo+" is not implemented by the current driver"),Uo=J.reject(ho);return lt(Uo,arguments[arguments.length-1]),Uo}},sr=0,Ii=Fr.length;sr<Ii;sr++){var ui=Fr[sr];k[ui]||(k[ui]=We(ui))}})();var fn=function(We){yr[wt]&&console.info("Redefining LocalForage driver: "+wt),yr[wt]=k,Ri[wt]=We,et()};"_support"in k?k._support&&typeof k._support=="function"?k._support().then(fn,vt):fn(!!k._support):fn(!0)}catch(We){vt(We)}});return Ft(K,G,st),K},L.prototype.driver=function(){return this._driver||null},L.prototype.getDriver=function(k,G,st){var K=yr[k]?J.resolve(yr[k]):J.reject(new Error("Driver not found."));return Ft(K,G,st),K},L.prototype.getSerializer=function(k){var G=J.resolve(Zn);return Ft(G,k),G},L.prototype.ready=function(k){var G=this,st=G._driverSet.then(function(){return G._ready===null&&(G._ready=G._initDriver()),G._ready});return Ft(st,k,k),st},L.prototype.setDriver=function(k,G,st){var K=this;Ar(k)||(k=[k]);var et=this._getSupportedDrivers(k);function vt(){K._config.driver=K.driver()}function wt(St){return K._extend(St),vt(),K._ready=K._initStorage(K._config),K._ready}var Ct=this._driverSet!==null?this._driverSet.catch(function(){return J.resolve()}):J.resolve();return this._driverSet=Ct.then(function(){var St=et[0];return K._dbInfo=null,K._ready=null,K.getDriver(St).then(function(Ut){K._driver=Ut._driver,vt(),K._wrapLibraryMethodsWithReady(),K._initDriver=function(ne){return function(){var Vt=0;return function fn(){for(;Vt<ne.length;){var We=ne[Vt];return Vt++,K._dbInfo=null,K._ready=null,K.getDriver(We).then(wt).catch(fn)}vt();var sr=new Error("No available storage method found.");return K._driverSet=J.reject(sr),K._driverSet}()}}(et)})}).catch(function(){vt();var St=new Error("No available storage method found.");return K._driverSet=J.reject(St),K._driverSet}),Ft(this._driverSet,G,st),this._driverSet},L.prototype.supports=function(k){return!!Ri[k]},L.prototype._extend=function(k){_i(this,k)},L.prototype._getSupportedDrivers=function(k){for(var G=[],st=0,K=k.length;st<K;st++){var et=k[st];this.supports(et)&&G.push(et)}return G},L.prototype._wrapLibraryMethodsWithReady=function(){for(var k=0,G=lo.length;k<G;k++)Fn(this,lo[k])},L.prototype.createInstance=function(k){return new L(k)},L}());dt.exports=ki},{3:3}]},{},[4])(4)}).call(this,S(4))},function(Re,C,S){Re.exports=function(it,j){if(it){j=j||{};for(var dt={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},ot=dt.parser[j.strictMode?"strict":"loose"].exec(it),X={},ft=14;ft--;)X[dt.key[ft]]=ot[ft]||"";return X[dt.q.name]={},X[dt.key[12]].replace(dt.q.parser,function(tt,J,lt){J&&(X[dt.q.name][J]=lt)}),X}}},function(Re,C,S){var it=S(30);Re.exports=function(j,dt){dt=dt||{};var ot=new it,X=dt.inPlace||!1,ft=j.map(function(J){return X?J:{width:J.width,height:J.height,item:J}});ft=ft.sort(function(J,lt){return lt.width*lt.height-J.width*J.height}),ot.fit(ft);var tt={width:ft.reduce(function(J,lt){return Math.max(J,lt.x+lt.width)},0),height:ft.reduce(function(J,lt){return Math.max(J,lt.y+lt.height)},0)};return X||(tt.items=ft),tt}},function(Re,C,S){(function(it){Re.exports=function j(dt,ot,X){function ft(lt,Ft){if(!ot[lt]){if(!dt[lt]){if(tt)return tt(lt,!0);var jt=new Error("Cannot find module '"+lt+"'");throw jt.code="MODULE_NOT_FOUND",jt}var kt=ot[lt]={exports:{}};dt[lt][0].call(kt.exports,function(I){var B=dt[lt][1][I];return ft(B||I)},kt,kt.exports,j,dt,ot,X)}return ot[lt].exports}for(var tt=!1,J=0;J<X.length;J++)ft(X[J]);return ft}({1:[function(j,dt,ot){(function(X){var ft,tt,J=X.MutationObserver||X.WebKitMutationObserver;if(J){var lt=0,Ft=new J(B),jt=X.document.createTextNode("");Ft.observe(jt,{characterData:!0}),ft=function(){jt.data=lt=++lt%2}}else if(X.setImmediate||X.MessageChannel===void 0)ft="document"in X&&"onreadystatechange"in X.document.createElement("script")?function(){var V=X.document.createElement("script");V.onreadystatechange=function(){B(),V.onreadystatechange=null,V.parentNode.removeChild(V),V=null},X.document.documentElement.appendChild(V)}:function(){setTimeout(B,0)};else{var kt=new X.MessageChannel;kt.port1.onmessage=B,ft=function(){kt.port2.postMessage(0)}}var I=[];function B(){var V,ut;tt=!0;for(var F=I.length;F;){for(ut=I,I=[],V=-1;++V<F;)ut[V]();F=I.length}tt=!1}dt.exports=function(V){I.push(V)!==1||tt||ft()}}).call(this,it!==void 0?it:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(j,dt,ot){var X=j(1);function ft(){}var tt={},J=["REJECTED"],lt=["FULFILLED"],Ft=["PENDING"];function jt(F){if(typeof F!="function")throw new TypeError("resolver must be a function");this.state=Ft,this.queue=[],this.outcome=void 0,F!==ft&&V(this,F)}function kt(F,Y,$){this.promise=F,typeof Y=="function"&&(this.onFulfilled=Y,this.callFulfilled=this.otherCallFulfilled),typeof $=="function"&&(this.onRejected=$,this.callRejected=this.otherCallRejected)}function I(F,Y,$){X(function(){var ct;try{ct=Y($)}catch(se){return tt.reject(F,se)}ct===F?tt.reject(F,new TypeError("Cannot resolve promise with itself")):tt.resolve(F,ct)})}function B(F){var Y=F&&F.then;if(F&&(typeof F=="object"||typeof F=="function")&&typeof Y=="function")return function(){Y.apply(F,arguments)}}function V(F,Y){var $=!1;function ct(ee){$||($=!0,tt.reject(F,ee))}function se(ee){$||($=!0,tt.resolve(F,ee))}var Le=ut(function(){Y(se,ct)});Le.status==="error"&&ct(Le.value)}function ut(F,Y){var $={};try{$.value=F(Y),$.status="success"}catch(ct){$.status="error",$.value=ct}return $}dt.exports=jt,jt.prototype.catch=function(F){return this.then(null,F)},jt.prototype.then=function(F,Y){if(typeof F!="function"&&this.state===lt||typeof Y!="function"&&this.state===J)return this;var $=new this.constructor(ft);return this.state!==Ft?I($,this.state===lt?F:Y,this.outcome):this.queue.push(new kt($,F,Y)),$},kt.prototype.callFulfilled=function(F){tt.resolve(this.promise,F)},kt.prototype.otherCallFulfilled=function(F){I(this.promise,this.onFulfilled,F)},kt.prototype.callRejected=function(F){tt.reject(this.promise,F)},kt.prototype.otherCallRejected=function(F){I(this.promise,this.onRejected,F)},tt.resolve=function(F,Y){var $=ut(B,Y);if($.status==="error")return tt.reject(F,$.value);var ct=$.value;if(ct)V(F,ct);else{F.state=lt,F.outcome=Y;for(var se=-1,Le=F.queue.length;++se<Le;)F.queue[se].callFulfilled(Y)}return F},tt.reject=function(F,Y){F.state=J,F.outcome=Y;for(var $=-1,ct=F.queue.length;++$<ct;)F.queue[$].callRejected(Y);return F},jt.resolve=function(F){return F instanceof this?F:tt.resolve(new this(ft),F)},jt.reject=function(F){var Y=new this(ft);return tt.reject(Y,F)},jt.all=function(F){var Y=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var $=F.length,ct=!1;if(!$)return this.resolve([]);for(var se=new Array($),Le=0,ee=-1,xt=new this(ft);++ee<$;)Zt(F[ee],ee);return xt;function Zt($t,Q){Y.resolve($t).then(function(Bt){se[Q]=Bt,++Le!==$||ct||(ct=!0,tt.resolve(xt,se))},function(Bt){ct||(ct=!0,tt.reject(xt,Bt))})}},jt.race=function(F){var Y=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var $=F.length,ct=!1;if(!$)return this.resolve([]);for(var se,Le=-1,ee=new this(ft);++Le<$;)se=F[Le],Y.resolve(se).then(function(xt){ct||(ct=!0,tt.resolve(ee,xt))},function(xt){ct||(ct=!0,tt.reject(ee,xt))});return ee}},{1:1}],3:[function(j,dt,ot){(function(X){typeof X.Promise!="function"&&(X.Promise=j(2))}).call(this,it!==void 0?it:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(j,dt,ot){var X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},ft=function(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch{return}}();function tt(L,k){L=L||[],k=k||{};try{return new Blob(L,k)}catch(K){if(K.name!=="TypeError")throw K;for(var G=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder),st=0;st<L.length;st+=1)G.append(L[st]);return G.getBlob(k.type)}}typeof Promise=="undefined"&&j(3);var J=Promise;function lt(L,k){k&&L.then(function(G){k(null,G)},function(G){k(G)})}function Ft(L,k,G){typeof k=="function"&&L.then(k),typeof G=="function"&&L.catch(G)}function jt(L){return typeof L!="string"&&(console.warn(L+" used as a key, but it is not a string."),L=String(L)),L}function kt(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var I=void 0,B={},V=Object.prototype.toString;function ut(L){return typeof I=="boolean"?J.resolve(I):function(k){return new J(function(G){var st=k.transaction("local-forage-detect-blob-support","readwrite"),K=tt([""]);st.objectStore("local-forage-detect-blob-support").put(K,"key"),st.onabort=function(et){et.preventDefault(),et.stopPropagation(),G(!1)},st.oncomplete=function(){var et=navigator.userAgent.match(/Chrome\/(\d+)/),vt=navigator.userAgent.match(/Edge\//);G(vt||!et||parseInt(et[1],10)>=43)}}).catch(function(){return!1})}(L).then(function(k){return I=k})}function F(L){var k=B[L.name],G={};G.promise=new J(function(st,K){G.resolve=st,G.reject=K}),k.deferredOperations.push(G),k.dbReady?k.dbReady=k.dbReady.then(function(){return G.promise}):k.dbReady=G.promise}function Y(L){var k=B[L.name].deferredOperations.pop();if(k)return k.resolve(),k.promise}function $(L,k){var G=B[L.name].deferredOperations.pop();if(G)return G.reject(k),G.promise}function ct(L,k){return new J(function(G,st){if(B[L.name]=B[L.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},L.db){if(!k)return G(L.db);F(L),L.db.close()}var K=[L.name];k&&K.push(L.version);var et=ft.open.apply(ft,K);k&&(et.onupgradeneeded=function(vt){var wt=et.result;try{wt.createObjectStore(L.storeName),vt.oldVersion<=1&&wt.createObjectStore("local-forage-detect-blob-support")}catch(Ct){if(Ct.name!=="ConstraintError")throw Ct;console.warn('The database "'+L.name+'" has been upgraded from version '+vt.oldVersion+" to version "+vt.newVersion+', but the storage "'+L.storeName+'" already exists.')}}),et.onerror=function(vt){vt.preventDefault(),st(et.error)},et.onsuccess=function(){G(et.result),Y(L)}})}function se(L){return ct(L,!1)}function Le(L){return ct(L,!0)}function ee(L,k){if(!L.db)return!0;var G=!L.db.objectStoreNames.contains(L.storeName),st=L.version<L.db.version,K=L.version>L.db.version;if(st&&(L.version!==k&&console.warn('The database "'+L.name+`" can't be downgraded from version `+L.db.version+" to version "+L.version+"."),L.version=L.db.version),K||G){if(G){var et=L.db.version+1;et>L.version&&(L.version=et)}return!0}return!1}function xt(L){return tt([function(k){for(var G=k.length,st=new ArrayBuffer(G),K=new Uint8Array(st),et=0;et<G;et++)K[et]=k.charCodeAt(et);return st}(atob(L.data))],{type:L.type})}function Zt(L){return L&&L.__local_forage_encoded_blob}function $t(L){var k=this,G=k._initReady().then(function(){var st=B[k._dbInfo.name];if(st&&st.dbReady)return st.dbReady});return Ft(G,L,L),G}function Q(L,k,G,st){st===void 0&&(st=1);try{var K=L.db.transaction(L.storeName,k);G(null,K)}catch(et){if(st>0&&(!L.db||et.name==="InvalidStateError"||et.name==="NotFoundError"))return J.resolve().then(function(){if(!L.db||et.name==="NotFoundError"&&!L.db.objectStoreNames.contains(L.storeName)&&L.version<=L.db.version)return L.db&&(L.version=L.db.version+1),Le(L)}).then(function(){return function(vt){F(vt);for(var wt=B[vt.name],Ct=wt.forages,St=0;St<Ct.length;St++){var Ut=Ct[St];Ut._dbInfo.db&&(Ut._dbInfo.db.close(),Ut._dbInfo.db=null)}return vt.db=null,se(vt).then(function(ne){return vt.db=ne,ee(vt)?Le(vt):ne}).then(function(ne){vt.db=wt.db=ne;for(var Vt=0;Vt<Ct.length;Vt++)Ct[Vt]._dbInfo.db=ne}).catch(function(ne){throw $(vt,ne),ne})}(L).then(function(){Q(L,k,G,st-1)})}).catch(G);G(et)}}var Bt={_driver:"asyncStorage",_initStorage:function(L){var k=this,G={db:null};if(L)for(var st in L)G[st]=L[st];var K=B[G.name];K||(K={forages:[],db:null,dbReady:null,deferredOperations:[]},B[G.name]=K),K.forages.push(k),k._initReady||(k._initReady=k.ready,k.ready=$t);var et=[];function vt(){return J.resolve()}for(var wt=0;wt<K.forages.length;wt++){var Ct=K.forages[wt];Ct!==k&&et.push(Ct._initReady().catch(vt))}var St=K.forages.slice(0);return J.all(et).then(function(){return G.db=K.db,se(G)}).then(function(Ut){return G.db=Ut,ee(G,k._defaultConfig.version)?Le(G):Ut}).then(function(Ut){G.db=K.db=Ut,k._dbInfo=G;for(var ne=0;ne<St.length;ne++){var Vt=St[ne];Vt!==k&&(Vt._dbInfo.db=G.db,Vt._dbInfo.version=G.version)}})},_support:function(){try{if(!ft||!ft.open)return!1;var L=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),k=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!L||k)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch{return!1}}(),iterate:function(L,k){var G=this,st=new J(function(K,et){G.ready().then(function(){Q(G._dbInfo,"readonly",function(vt,wt){if(vt)return et(vt);try{var Ct=wt.objectStore(G._dbInfo.storeName).openCursor(),St=1;Ct.onsuccess=function(){var Ut=Ct.result;if(Ut){var ne=Ut.value;Zt(ne)&&(ne=xt(ne));var Vt=L(ne,Ut.key,St++);Vt!==void 0?K(Vt):Ut.continue()}else K()},Ct.onerror=function(){et(Ct.error)}}catch(Ut){et(Ut)}})}).catch(et)});return lt(st,k),st},getItem:function(L,k){var G=this;L=jt(L);var st=new J(function(K,et){G.ready().then(function(){Q(G._dbInfo,"readonly",function(vt,wt){if(vt)return et(vt);try{var Ct=wt.objectStore(G._dbInfo.storeName).get(L);Ct.onsuccess=function(){var St=Ct.result;St===void 0&&(St=null),Zt(St)&&(St=xt(St)),K(St)},Ct.onerror=function(){et(Ct.error)}}catch(St){et(St)}})}).catch(et)});return lt(st,k),st},setItem:function(L,k,G){var st=this;L=jt(L);var K=new J(function(et,vt){var wt;st.ready().then(function(){return wt=st._dbInfo,V.call(k)==="[object Blob]"?ut(wt.db).then(function(Ct){return Ct?k:(St=k,new J(function(Ut,ne){var Vt=new FileReader;Vt.onerror=ne,Vt.onloadend=function(fn){var We=btoa(fn.target.result||"");Ut({__local_forage_encoded_blob:!0,data:We,type:St.type})},Vt.readAsBinaryString(St)}));var St}):k}).then(function(Ct){Q(st._dbInfo,"readwrite",function(St,Ut){if(St)return vt(St);try{var ne=Ut.objectStore(st._dbInfo.storeName);Ct===null&&(Ct=void 0);var Vt=ne.put(Ct,L);Ut.oncomplete=function(){Ct===void 0&&(Ct=null),et(Ct)},Ut.onabort=Ut.onerror=function(){var fn=Vt.error?Vt.error:Vt.transaction.error;vt(fn)}}catch(fn){vt(fn)}})}).catch(vt)});return lt(K,G),K},removeItem:function(L,k){var G=this;L=jt(L);var st=new J(function(K,et){G.ready().then(function(){Q(G._dbInfo,"readwrite",function(vt,wt){if(vt)return et(vt);try{var Ct=wt.objectStore(G._dbInfo.storeName).delete(L);wt.oncomplete=function(){K()},wt.onerror=function(){et(Ct.error)},wt.onabort=function(){var St=Ct.error?Ct.error:Ct.transaction.error;et(St)}}catch(St){et(St)}})}).catch(et)});return lt(st,k),st},clear:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){Q(k._dbInfo,"readwrite",function(et,vt){if(et)return K(et);try{var wt=vt.objectStore(k._dbInfo.storeName).clear();vt.oncomplete=function(){st()},vt.onabort=vt.onerror=function(){var Ct=wt.error?wt.error:wt.transaction.error;K(Ct)}}catch(Ct){K(Ct)}})}).catch(K)});return lt(G,L),G},length:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){Q(k._dbInfo,"readonly",function(et,vt){if(et)return K(et);try{var wt=vt.objectStore(k._dbInfo.storeName).count();wt.onsuccess=function(){st(wt.result)},wt.onerror=function(){K(wt.error)}}catch(Ct){K(Ct)}})}).catch(K)});return lt(G,L),G},key:function(L,k){var G=this,st=new J(function(K,et){L<0?K(null):G.ready().then(function(){Q(G._dbInfo,"readonly",function(vt,wt){if(vt)return et(vt);try{var Ct=wt.objectStore(G._dbInfo.storeName),St=!1,Ut=Ct.openKeyCursor();Ut.onsuccess=function(){var ne=Ut.result;ne?L===0||St?K(ne.key):(St=!0,ne.advance(L)):K(null)},Ut.onerror=function(){et(Ut.error)}}catch(ne){et(ne)}})}).catch(et)});return lt(st,k),st},keys:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){Q(k._dbInfo,"readonly",function(et,vt){if(et)return K(et);try{var wt=vt.objectStore(k._dbInfo.storeName).openKeyCursor(),Ct=[];wt.onsuccess=function(){var St=wt.result;St?(Ct.push(St.key),St.continue()):st(Ct)},wt.onerror=function(){K(wt.error)}}catch(St){K(St)}})}).catch(K)});return lt(G,L),G},dropInstance:function(L,k){k=kt.apply(this,arguments);var G=this.config();(L=typeof L!="function"&&L||{}).name||(L.name=L.name||G.name,L.storeName=L.storeName||G.storeName);var st,K=this;if(L.name){var et=L.name===G.name&&K._dbInfo.db,vt=et?J.resolve(K._dbInfo.db):se(L).then(function(wt){var Ct=B[L.name],St=Ct.forages;Ct.db=wt;for(var Ut=0;Ut<St.length;Ut++)St[Ut]._dbInfo.db=wt;return wt});st=L.storeName?vt.then(function(wt){if(wt.objectStoreNames.contains(L.storeName)){var Ct=wt.version+1;F(L);var St=B[L.name],Ut=St.forages;wt.close();for(var ne=0;ne<Ut.length;ne++){var Vt=Ut[ne];Vt._dbInfo.db=null,Vt._dbInfo.version=Ct}return new J(function(fn,We){var sr=ft.open(L.name,Ct);sr.onerror=function(Ii){sr.result.close(),We(Ii)},sr.onupgradeneeded=function(){sr.result.deleteObjectStore(L.storeName)},sr.onsuccess=function(){var Ii=sr.result;Ii.close(),fn(Ii)}}).then(function(fn){St.db=fn;for(var We=0;We<Ut.length;We++){var sr=Ut[We];sr._dbInfo.db=fn,Y(sr._dbInfo)}}).catch(function(fn){throw($(L,fn)||J.resolve()).catch(function(){}),fn})}}):vt.then(function(wt){F(L);var Ct=B[L.name],St=Ct.forages;wt.close();for(var Ut=0;Ut<St.length;Ut++)St[Ut]._dbInfo.db=null;return new J(function(ne,Vt){var fn=ft.deleteDatabase(L.name);fn.onerror=fn.onblocked=function(We){var sr=fn.result;sr&&sr.close(),Vt(We)},fn.onsuccess=function(){var We=fn.result;We&&We.close(),ne(We)}}).then(function(ne){Ct.db=ne;for(var Vt=0;Vt<St.length;Vt++)Y(St[Vt]._dbInfo)}).catch(function(ne){throw($(L,ne)||J.resolve()).catch(function(){}),ne})})}else st=J.reject("Invalid arguments");return lt(st,k),st}},Wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Kt=/^~~local_forage_type~([^~]+)~/,Xt="__lfsc__:".length,oe=Xt+"arbf".length,de=Object.prototype.toString;function $e(L){var k,G,st,K,et,vt=.75*L.length,wt=L.length,Ct=0;L[L.length-1]==="="&&(vt--,L[L.length-2]==="="&&vt--);var St=new ArrayBuffer(vt),Ut=new Uint8Array(St);for(k=0;k<wt;k+=4)G=Wt.indexOf(L[k]),st=Wt.indexOf(L[k+1]),K=Wt.indexOf(L[k+2]),et=Wt.indexOf(L[k+3]),Ut[Ct++]=G<<2|st>>4,Ut[Ct++]=(15&st)<<4|K>>2,Ut[Ct++]=(3&K)<<6|63&et;return St}function Ue(L){var k,G=new Uint8Array(L),st="";for(k=0;k<G.length;k+=3)st+=Wt[G[k]>>2],st+=Wt[(3&G[k])<<4|G[k+1]>>4],st+=Wt[(15&G[k+1])<<2|G[k+2]>>6],st+=Wt[63&G[k+2]];return G.length%3==2?st=st.substring(0,st.length-1)+"=":G.length%3==1&&(st=st.substring(0,st.length-2)+"=="),st}var Zn={serialize:function(L,k){var G="";if(L&&(G=de.call(L)),L&&(G==="[object ArrayBuffer]"||L.buffer&&de.call(L.buffer)==="[object ArrayBuffer]")){var st,K="__lfsc__:";L instanceof ArrayBuffer?(st=L,K+="arbf"):(st=L.buffer,G==="[object Int8Array]"?K+="si08":G==="[object Uint8Array]"?K+="ui08":G==="[object Uint8ClampedArray]"?K+="uic8":G==="[object Int16Array]"?K+="si16":G==="[object Uint16Array]"?K+="ur16":G==="[object Int32Array]"?K+="si32":G==="[object Uint32Array]"?K+="ui32":G==="[object Float32Array]"?K+="fl32":G==="[object Float64Array]"?K+="fl64":k(new Error("Failed to get type for BinaryArray"))),k(K+Ue(st))}else if(G==="[object Blob]"){var et=new FileReader;et.onload=function(){var vt="~~local_forage_type~"+L.type+"~"+Ue(this.result);k("__lfsc__:blob"+vt)},et.readAsArrayBuffer(L)}else try{k(JSON.stringify(L))}catch(vt){console.error("Couldn't convert value into a JSON string: ",L),k(null,vt)}},deserialize:function(L){if(L.substring(0,Xt)!=="__lfsc__:")return JSON.parse(L);var k,G=L.substring(oe),st=L.substring(Xt,oe);if(st==="blob"&&Kt.test(G)){var K=G.match(Kt);k=K[1],G=G.substring(K[0].length)}var et=$e(G);switch(st){case"arbf":return et;case"blob":return tt([et],{type:k});case"si08":return new Int8Array(et);case"ui08":return new Uint8Array(et);case"uic8":return new Uint8ClampedArray(et);case"si16":return new Int16Array(et);case"ur16":return new Uint16Array(et);case"si32":return new Int32Array(et);case"ui32":return new Uint32Array(et);case"fl32":return new Float32Array(et);case"fl64":return new Float64Array(et);default:throw new Error("Unkown type: "+st)}},stringToBuffer:$e,bufferToString:Ue};function Ke(L,k,G,st){L.executeSql("CREATE TABLE IF NOT EXISTS "+k.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],G,st)}function Un(L,k,G,st,K,et){L.executeSql(G,st,K,function(vt,wt){wt.code===wt.SYNTAX_ERR?vt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[k.storeName],function(Ct,St){St.rows.length?et(Ct,wt):Ke(Ct,k,function(){Ct.executeSql(G,st,K,et)},et)},et):et(vt,wt)},et)}function Hn(L,k,G,st){var K=this;L=jt(L);var et=new J(function(vt,wt){K.ready().then(function(){k===void 0&&(k=null);var Ct=k,St=K._dbInfo;St.serializer.serialize(k,function(Ut,ne){ne?wt(ne):St.db.transaction(function(Vt){Un(Vt,St,"INSERT OR REPLACE INTO "+St.storeName+" (key, value) VALUES (?, ?)",[L,Ut],function(){vt(Ct)},function(fn,We){wt(We)})},function(Vt){if(Vt.code===Vt.QUOTA_ERR){if(st>0)return void vt(Hn.apply(K,[L,Ct,G,st-1]));wt(Vt)}})})}).catch(wt)});return lt(et,G),et}function er(L){return new J(function(k,G){L.transaction(function(st){st.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(K,et){for(var vt=[],wt=0;wt<et.rows.length;wt++)vt.push(et.rows.item(wt).name);k({db:L,storeNames:vt})},function(K,et){G(et)})},function(st){G(st)})})}var bn={_driver:"webSQLStorage",_initStorage:function(L){var k=this,G={db:null};if(L)for(var st in L)G[st]=typeof L[st]!="string"?L[st].toString():L[st];var K=new J(function(et,vt){try{G.db=openDatabase(G.name,String(G.version),G.description,G.size)}catch(wt){return vt(wt)}G.db.transaction(function(wt){Ke(wt,G,function(){k._dbInfo=G,et()},function(Ct,St){vt(St)})},vt)});return G.serializer=Zn,K},_support:typeof openDatabase=="function",iterate:function(L,k){var G=this,st=new J(function(K,et){G.ready().then(function(){var vt=G._dbInfo;vt.db.transaction(function(wt){Un(wt,vt,"SELECT * FROM "+vt.storeName,[],function(Ct,St){for(var Ut=St.rows,ne=Ut.length,Vt=0;Vt<ne;Vt++){var fn=Ut.item(Vt),We=fn.value;if(We&&(We=vt.serializer.deserialize(We)),(We=L(We,fn.key,Vt+1))!==void 0)return void K(We)}K()},function(Ct,St){et(St)})})}).catch(et)});return lt(st,k),st},getItem:function(L,k){var G=this;L=jt(L);var st=new J(function(K,et){G.ready().then(function(){var vt=G._dbInfo;vt.db.transaction(function(wt){Un(wt,vt,"SELECT * FROM "+vt.storeName+" WHERE key = ? LIMIT 1",[L],function(Ct,St){var Ut=St.rows.length?St.rows.item(0).value:null;Ut&&(Ut=vt.serializer.deserialize(Ut)),K(Ut)},function(Ct,St){et(St)})})}).catch(et)});return lt(st,k),st},setItem:function(L,k,G){return Hn.apply(this,[L,k,G,1])},removeItem:function(L,k){var G=this;L=jt(L);var st=new J(function(K,et){G.ready().then(function(){var vt=G._dbInfo;vt.db.transaction(function(wt){Un(wt,vt,"DELETE FROM "+vt.storeName+" WHERE key = ?",[L],function(){K()},function(Ct,St){et(St)})})}).catch(et)});return lt(st,k),st},clear:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){var et=k._dbInfo;et.db.transaction(function(vt){Un(vt,et,"DELETE FROM "+et.storeName,[],function(){st()},function(wt,Ct){K(Ct)})})}).catch(K)});return lt(G,L),G},length:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){var et=k._dbInfo;et.db.transaction(function(vt){Un(vt,et,"SELECT COUNT(key) as c FROM "+et.storeName,[],function(wt,Ct){var St=Ct.rows.item(0).c;st(St)},function(wt,Ct){K(Ct)})})}).catch(K)});return lt(G,L),G},key:function(L,k){var G=this,st=new J(function(K,et){G.ready().then(function(){var vt=G._dbInfo;vt.db.transaction(function(wt){Un(wt,vt,"SELECT key FROM "+vt.storeName+" WHERE id = ? LIMIT 1",[L+1],function(Ct,St){var Ut=St.rows.length?St.rows.item(0).key:null;K(Ut)},function(Ct,St){et(St)})})}).catch(et)});return lt(st,k),st},keys:function(L){var k=this,G=new J(function(st,K){k.ready().then(function(){var et=k._dbInfo;et.db.transaction(function(vt){Un(vt,et,"SELECT key FROM "+et.storeName,[],function(wt,Ct){for(var St=[],Ut=0;Ut<Ct.rows.length;Ut++)St.push(Ct.rows.item(Ut).key);st(St)},function(wt,Ct){K(Ct)})})}).catch(K)});return lt(G,L),G},dropInstance:function(L,k){k=kt.apply(this,arguments);var G=this.config();(L=typeof L!="function"&&L||{}).name||(L.name=L.name||G.name,L.storeName=L.storeName||G.storeName);var st,K=this;return lt(st=L.name?new J(function(et){var vt;vt=L.name===G.name?K._dbInfo.db:openDatabase(L.name,"","",0),L.storeName?et({db:vt,storeNames:[L.storeName]}):et(er(vt))}).then(function(et){return new J(function(vt,wt){et.db.transaction(function(Ct){function St(fn){return new J(function(We,sr){Ct.executeSql("DROP TABLE IF EXISTS "+fn,[],function(){We()},function(Ii,ui){sr(ui)})})}for(var Ut=[],ne=0,Vt=et.storeNames.length;ne<Vt;ne++)Ut.push(St(et.storeNames[ne]));J.all(Ut).then(function(){vt()}).catch(function(fn){wt(fn)})},function(Ct){wt(Ct)})})}):J.reject("Invalid arguments"),k),st}};function Cr(L,k){var G=L.name+"/";return L.storeName!==k.storeName&&(G+=L.storeName+"/"),G}function Lr(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch{return!0}}()||localStorage.length>0}var Rr={_driver:"localStorageWrapper",_initStorage:function(L){var k={};if(L)for(var G in L)k[G]=L[G];return k.keyPrefix=Cr(L,this._defaultConfig),Lr()?(this._dbInfo=k,k.serializer=Zn,J.resolve()):J.reject()},_support:function(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function(L,k){var G=this,st=G.ready().then(function(){for(var K=G._dbInfo,et=K.keyPrefix,vt=et.length,wt=localStorage.length,Ct=1,St=0;St<wt;St++){var Ut=localStorage.key(St);if(Ut.indexOf(et)===0){var ne=localStorage.getItem(Ut);if(ne&&(ne=K.serializer.deserialize(ne)),(ne=L(ne,Ut.substring(vt),Ct++))!==void 0)return ne}}});return lt(st,k),st},getItem:function(L,k){var G=this;L=jt(L);var st=G.ready().then(function(){var K=G._dbInfo,et=localStorage.getItem(K.keyPrefix+L);return et&&(et=K.serializer.deserialize(et)),et});return lt(st,k),st},setItem:function(L,k,G){var st=this;L=jt(L);var K=st.ready().then(function(){k===void 0&&(k=null);var et=k;return new J(function(vt,wt){var Ct=st._dbInfo;Ct.serializer.serialize(k,function(St,Ut){if(Ut)wt(Ut);else try{localStorage.setItem(Ct.keyPrefix+L,St),vt(et)}catch(ne){ne.name!=="QuotaExceededError"&&ne.name!=="NS_ERROR_DOM_QUOTA_REACHED"||wt(ne),wt(ne)}})})});return lt(K,G),K},removeItem:function(L,k){var G=this;L=jt(L);var st=G.ready().then(function(){var K=G._dbInfo;localStorage.removeItem(K.keyPrefix+L)});return lt(st,k),st},clear:function(L){var k=this,G=k.ready().then(function(){for(var st=k._dbInfo.keyPrefix,K=localStorage.length-1;K>=0;K--){var et=localStorage.key(K);et.indexOf(st)===0&&localStorage.removeItem(et)}});return lt(G,L),G},length:function(L){var k=this.keys().then(function(G){return G.length});return lt(k,L),k},key:function(L,k){var G=this,st=G.ready().then(function(){var K,et=G._dbInfo;try{K=localStorage.key(L)}catch{K=null}return K&&(K=K.substring(et.keyPrefix.length)),K});return lt(st,k),st},keys:function(L){var k=this,G=k.ready().then(function(){for(var st=k._dbInfo,K=localStorage.length,et=[],vt=0;vt<K;vt++){var wt=localStorage.key(vt);wt.indexOf(st.keyPrefix)===0&&et.push(wt.substring(st.keyPrefix.length))}return et});return lt(G,L),G},dropInstance:function(L,k){if(k=kt.apply(this,arguments),!(L=typeof L!="function"&&L||{}).name){var G=this.config();L.name=L.name||G.name,L.storeName=L.storeName||G.storeName}var st,K=this;return lt(st=L.name?new J(function(et){L.storeName?et(Cr(L,K._defaultConfig)):et(L.name+"/")}).then(function(et){for(var vt=localStorage.length-1;vt>=0;vt--){var wt=localStorage.key(vt);wt.indexOf(et)===0&&localStorage.removeItem(wt)}}):J.reject("Invalid arguments"),k),st}},Yr=function(L,k){for(var G,st,K=L.length,et=0;et<K;){if((G=L[et])===(st=k)||typeof G=="number"&&typeof st=="number"&&isNaN(G)&&isNaN(st))return!0;et++}return!1},Ar=Array.isArray||function(L){return Object.prototype.toString.call(L)==="[object Array]"},yr={},Ri={},Or={INDEXEDDB:Bt,WEBSQL:bn,LOCALSTORAGE:Rr},Er=[Or.INDEXEDDB._driver,Or.WEBSQL._driver,Or.LOCALSTORAGE._driver],Fr=["dropInstance"],lo=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Fr),_s={description:"",driver:Er.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Fn(L,k){L[k]=function(){var G=arguments;return L.ready().then(function(){return L[k].apply(L,G)})}}function _i(){for(var L=1;L<arguments.length;L++){var k=arguments[L];if(k)for(var G in k)k.hasOwnProperty(G)&&(Ar(k[G])?arguments[0][G]=k[G].slice():arguments[0][G]=k[G])}return arguments[0]}var ki=new(function(){function L(k){for(var G in function(et,vt){if(!(et instanceof vt))throw new TypeError("Cannot call a class as a function")}(this,L),Or)if(Or.hasOwnProperty(G)){var st=Or[G],K=st._driver;this[G]=K,yr[K]||this.defineDriver(st)}this._defaultConfig=_i({},_s),this._config=_i({},this._defaultConfig,k),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return L.prototype.config=function(k){if((k===void 0?"undefined":X(k))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var G in k){if(G==="storeName"&&(k[G]=k[G].replace(/\W/g,"_")),G==="version"&&typeof k[G]!="number")return new Error("Database version must be a number.");this._config[G]=k[G]}return!("driver"in k)||!k.driver||this.setDriver(this._config.driver)}return typeof k=="string"?this._config[k]:this._config},L.prototype.defineDriver=function(k,G,st){var K=new J(function(et,vt){try{var wt=k._driver,Ct=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!k._driver)return void vt(Ct);for(var St=lo.concat("_initStorage"),Ut=0,ne=St.length;Ut<ne;Ut++){var Vt=St[Ut];if((!Yr(Fr,Vt)||k[Vt])&&typeof k[Vt]!="function")return void vt(Ct)}(function(){for(var We=function(Bo){return function(){var ho=new Error("Method "+Bo+" is not implemented by the current driver"),Uo=J.reject(ho);return lt(Uo,arguments[arguments.length-1]),Uo}},sr=0,Ii=Fr.length;sr<Ii;sr++){var ui=Fr[sr];k[ui]||(k[ui]=We(ui))}})();var fn=function(We){yr[wt]&&console.info("Redefining LocalForage driver: "+wt),yr[wt]=k,Ri[wt]=We,et()};"_support"in k?k._support&&typeof k._support=="function"?k._support().then(fn,vt):fn(!!k._support):fn(!0)}catch(We){vt(We)}});return Ft(K,G,st),K},L.prototype.driver=function(){return this._driver||null},L.prototype.getDriver=function(k,G,st){var K=yr[k]?J.resolve(yr[k]):J.reject(new Error("Driver not found."));return Ft(K,G,st),K},L.prototype.getSerializer=function(k){var G=J.resolve(Zn);return Ft(G,k),G},L.prototype.ready=function(k){var G=this,st=G._driverSet.then(function(){return G._ready===null&&(G._ready=G._initDriver()),G._ready});return Ft(st,k,k),st},L.prototype.setDriver=function(k,G,st){var K=this;Ar(k)||(k=[k]);var et=this._getSupportedDrivers(k);function vt(){K._config.driver=K.driver()}function wt(St){return K._extend(St),vt(),K._ready=K._initStorage(K._config),K._ready}var Ct=this._driverSet!==null?this._driverSet.catch(function(){return J.resolve()}):J.resolve();return this._driverSet=Ct.then(function(){var St=et[0];return K._dbInfo=null,K._ready=null,K.getDriver(St).then(function(Ut){K._driver=Ut._driver,vt(),K._wrapLibraryMethodsWithReady(),K._initDriver=function(ne){return function(){var Vt=0;return function fn(){for(;Vt<ne.length;){var We=ne[Vt];return Vt++,K._dbInfo=null,K._ready=null,K.getDriver(We).then(wt).catch(fn)}vt();var sr=new Error("No available storage method found.");return K._driverSet=J.reject(sr),K._driverSet}()}}(et)})}).catch(function(){vt();var St=new Error("No available storage method found.");return K._driverSet=J.reject(St),K._driverSet}),Ft(this._driverSet,G,st),this._driverSet},L.prototype.supports=function(k){return!!Ri[k]},L.prototype._extend=function(k){_i(this,k)},L.prototype._getSupportedDrivers=function(k){for(var G=[],st=0,K=k.length;st<K;st++){var et=k[st];this.supports(et)&&G.push(et)}return G},L.prototype._wrapLibraryMethodsWithReady=function(){for(var k=0,G=lo.length;k<G;k++)Fn(this,lo[k])},L.prototype.createInstance=function(k){return new L(k)},L}());dt.exports=ki},{3:3}]},{},[4])(4)}).call(this,S(4))},function(Re,C){Re.exports=function(S){return S.webpackPolyfill||(S.deprecate=function(){},S.paths=[],S.children||(S.children=[]),Object.defineProperty(S,"loaded",{enumerable:!0,get:function(){return S.l}}),Object.defineProperty(S,"id",{enumerable:!0,get:function(){return S.i}}),S.webpackPolyfill=1),S}},function(Re,C,S){var it=Object.prototype.hasOwnProperty,j="~";function dt(){}function ot(J,lt,Ft){this.fn=J,this.context=lt,this.once=Ft||!1}function X(J,lt,Ft,jt,kt){if(typeof Ft!="function")throw new TypeError("The listener must be a function");var I=new ot(Ft,jt||J,kt),B=j?j+lt:lt;return J._events[B]?J._events[B].fn?J._events[B]=[J._events[B],I]:J._events[B].push(I):(J._events[B]=I,J._eventsCount++),J}function ft(J,lt){--J._eventsCount==0?J._events=new dt:delete J._events[lt]}function tt(){this._events=new dt,this._eventsCount=0}Object.create&&(dt.prototype=Object.create(null),new dt().__proto__||(j=!1)),tt.prototype.eventNames=function(){var J,lt,Ft=[];if(this._eventsCount===0)return Ft;for(lt in J=this._events)it.call(J,lt)&&Ft.push(j?lt.slice(1):lt);return Object.getOwnPropertySymbols?Ft.concat(Object.getOwnPropertySymbols(J)):Ft},tt.prototype.listeners=function(J){var lt=j?j+J:J,Ft=this._events[lt];if(!Ft)return[];if(Ft.fn)return[Ft.fn];for(var jt=0,kt=Ft.length,I=new Array(kt);jt<kt;jt++)I[jt]=Ft[jt].fn;return I},tt.prototype.listenerCount=function(J){var lt=j?j+J:J,Ft=this._events[lt];return Ft?Ft.fn?1:Ft.length:0},tt.prototype.emit=function(J,lt,Ft,jt,kt,I){var B=j?j+J:J;if(!this._events[B])return!1;var V,ut,F=this._events[B],Y=arguments.length;if(F.fn){switch(F.once&&this.removeListener(J,F.fn,void 0,!0),Y){case 1:return F.fn.call(F.context),!0;case 2:return F.fn.call(F.context,lt),!0;case 3:return F.fn.call(F.context,lt,Ft),!0;case 4:return F.fn.call(F.context,lt,Ft,jt),!0;case 5:return F.fn.call(F.context,lt,Ft,jt,kt),!0;case 6:return F.fn.call(F.context,lt,Ft,jt,kt,I),!0}for(ut=1,V=new Array(Y-1);ut<Y;ut++)V[ut-1]=arguments[ut];F.fn.apply(F.context,V)}else{var $,ct=F.length;for(ut=0;ut<ct;ut++)switch(F[ut].once&&this.removeListener(J,F[ut].fn,void 0,!0),Y){case 1:F[ut].fn.call(F[ut].context);break;case 2:F[ut].fn.call(F[ut].context,lt);break;case 3:F[ut].fn.call(F[ut].context,lt,Ft);break;case 4:F[ut].fn.call(F[ut].context,lt,Ft,jt);break;default:if(!V)for($=1,V=new Array(Y-1);$<Y;$++)V[$-1]=arguments[$];F[ut].fn.apply(F[ut].context,V)}}return!0},tt.prototype.on=function(J,lt,Ft){return X(this,J,lt,Ft,!1)},tt.prototype.once=function(J,lt,Ft){return X(this,J,lt,Ft,!0)},tt.prototype.removeListener=function(J,lt,Ft,jt){var kt=j?j+J:J;if(!this._events[kt])return this;if(!lt)return ft(this,kt),this;var I=this._events[kt];if(I.fn)I.fn!==lt||jt&&!I.once||Ft&&I.context!==Ft||ft(this,kt);else{for(var B=0,V=[],ut=I.length;B<ut;B++)(I[B].fn!==lt||jt&&!I[B].once||Ft&&I[B].context!==Ft)&&V.push(I[B]);V.length?this._events[kt]=V.length===1?V[0]:V:ft(this,kt)}return this},tt.prototype.removeAllListeners=function(J){var lt;return J?(lt=j?j+J:J,this._events[lt]&&ft(this,lt)):(this._events=new dt,this._eventsCount=0),this},tt.prototype.off=tt.prototype.removeListener,tt.prototype.addListener=tt.prototype.on,tt.prefixed=j,tt.EventEmitter=tt,Re.exports=tt},function(Re,C,S){function it(Q,Bt,Wt){Wt=Wt||2;var Kt,Xt,oe,de,$e,Ue,Zn,Ke=Bt&&Bt.length,Un=Ke?Bt[0]*Wt:Q.length,Hn=j(Q,0,Un,Wt,!0),er=[];if(!Hn||Hn.next===Hn.prev)return er;if(Ke&&(Hn=function(Cr,Lr,Rr,Yr){var Ar,yr,Ri,Or,Er,Fr=[];for(Ar=0,yr=Lr.length;Ar<yr;Ar++)Ri=Lr[Ar]*Yr,Or=Ar<yr-1?Lr[Ar+1]*Yr:Cr.length,(Er=j(Cr,Ri,Or,Yr,!1))===Er.next&&(Er.steiner=!0),Fr.push(I(Er));for(Fr.sort(lt),Ar=0;Ar<Fr.length;Ar++)Rr=dt(Rr=Ft(Fr[Ar],Rr),Rr.next);return Rr}(Q,Bt,Hn,Wt)),Q.length>80*Wt){Kt=oe=Q[0],Xt=de=Q[1];for(var bn=Wt;bn<Un;bn+=Wt)($e=Q[bn])<Kt&&(Kt=$e),(Ue=Q[bn+1])<Xt&&(Xt=Ue),$e>oe&&(oe=$e),Ue>de&&(de=Ue);Zn=(Zn=Math.max(oe-Kt,de-Xt))!==0?1/Zn:0}return ot(Hn,er,Wt,Kt,Xt,Zn),er}function j(Q,Bt,Wt,Kt,Xt){var oe,de;if(Xt===$t(Q,Bt,Wt,Kt)>0)for(oe=Bt;oe<Wt;oe+=Kt)de=ee(oe,Q[oe],Q[oe+1],de);else for(oe=Wt-Kt;oe>=Bt;oe-=Kt)de=ee(oe,Q[oe],Q[oe+1],de);return de&&F(de,de.next)&&(xt(de),de=de.next),de}function dt(Q,Bt){if(!Q)return Q;Bt||(Bt=Q);var Wt,Kt=Q;do if(Wt=!1,Kt.steiner||!F(Kt,Kt.next)&&ut(Kt.prev,Kt,Kt.next)!==0)Kt=Kt.next;else{if(xt(Kt),(Kt=Bt=Kt.prev)===Kt.next)break;Wt=!0}while(Wt||Kt!==Bt);return Bt}function ot(Q,Bt,Wt,Kt,Xt,oe,de){if(Q){!de&&oe&&function(Ke,Un,Hn,er){var bn=Ke;do bn.z===null&&(bn.z=kt(bn.x,bn.y,Un,Hn,er)),bn.prevZ=bn.prev,bn.nextZ=bn.next,bn=bn.next;while(bn!==Ke);bn.prevZ.nextZ=null,bn.prevZ=null,function(Cr){var Lr,Rr,Yr,Ar,yr,Ri,Or,Er,Fr=1;do{for(Rr=Cr,Cr=null,yr=null,Ri=0;Rr;){for(Ri++,Yr=Rr,Or=0,Lr=0;Lr<Fr&&(Or++,Yr=Yr.nextZ);Lr++);for(Er=Fr;Or>0||Er>0&&Yr;)Or!==0&&(Er===0||!Yr||Rr.z<=Yr.z)?(Ar=Rr,Rr=Rr.nextZ,Or--):(Ar=Yr,Yr=Yr.nextZ,Er--),yr?yr.nextZ=Ar:Cr=Ar,Ar.prevZ=yr,yr=Ar;Rr=Yr}yr.nextZ=null,Fr*=2}while(Ri>1)}(bn)}(Q,Kt,Xt,oe);for(var $e,Ue,Zn=Q;Q.prev!==Q.next;)if($e=Q.prev,Ue=Q.next,oe?ft(Q,Kt,Xt,oe):X(Q))Bt.push($e.i/Wt),Bt.push(Q.i/Wt),Bt.push(Ue.i/Wt),xt(Q),Q=Ue.next,Zn=Ue.next;else if((Q=Ue)===Zn){de?de===1?ot(Q=tt(dt(Q),Bt,Wt),Bt,Wt,Kt,Xt,oe,2):de===2&&J(Q,Bt,Wt,Kt,Xt,oe):ot(dt(Q),Bt,Wt,Kt,Xt,oe,1);break}}}function X(Q){var Bt=Q.prev,Wt=Q,Kt=Q.next;if(ut(Bt,Wt,Kt)>=0)return!1;for(var Xt=Q.next.next;Xt!==Q.prev;){if(B(Bt.x,Bt.y,Wt.x,Wt.y,Kt.x,Kt.y,Xt.x,Xt.y)&&ut(Xt.prev,Xt,Xt.next)>=0)return!1;Xt=Xt.next}return!0}function ft(Q,Bt,Wt,Kt){var Xt=Q.prev,oe=Q,de=Q.next;if(ut(Xt,oe,de)>=0)return!1;for(var $e=Xt.x<oe.x?Xt.x<de.x?Xt.x:de.x:oe.x<de.x?oe.x:de.x,Ue=Xt.y<oe.y?Xt.y<de.y?Xt.y:de.y:oe.y<de.y?oe.y:de.y,Zn=Xt.x>oe.x?Xt.x>de.x?Xt.x:de.x:oe.x>de.x?oe.x:de.x,Ke=Xt.y>oe.y?Xt.y>de.y?Xt.y:de.y:oe.y>de.y?oe.y:de.y,Un=kt($e,Ue,Bt,Wt,Kt),Hn=kt(Zn,Ke,Bt,Wt,Kt),er=Q.prevZ,bn=Q.nextZ;er&&er.z>=Un&&bn&&bn.z<=Hn;){if(er!==Q.prev&&er!==Q.next&&B(Xt.x,Xt.y,oe.x,oe.y,de.x,de.y,er.x,er.y)&&ut(er.prev,er,er.next)>=0||(er=er.prevZ,bn!==Q.prev&&bn!==Q.next&&B(Xt.x,Xt.y,oe.x,oe.y,de.x,de.y,bn.x,bn.y)&&ut(bn.prev,bn,bn.next)>=0))return!1;bn=bn.nextZ}for(;er&&er.z>=Un;){if(er!==Q.prev&&er!==Q.next&&B(Xt.x,Xt.y,oe.x,oe.y,de.x,de.y,er.x,er.y)&&ut(er.prev,er,er.next)>=0)return!1;er=er.prevZ}for(;bn&&bn.z<=Hn;){if(bn!==Q.prev&&bn!==Q.next&&B(Xt.x,Xt.y,oe.x,oe.y,de.x,de.y,bn.x,bn.y)&&ut(bn.prev,bn,bn.next)>=0)return!1;bn=bn.nextZ}return!0}function tt(Q,Bt,Wt){var Kt=Q;do{var Xt=Kt.prev,oe=Kt.next.next;!F(Xt,oe)&&Y(Xt,Kt,Kt.next,oe)&&se(Xt,oe)&&se(oe,Xt)&&(Bt.push(Xt.i/Wt),Bt.push(Kt.i/Wt),Bt.push(oe.i/Wt),xt(Kt),xt(Kt.next),Kt=Q=oe),Kt=Kt.next}while(Kt!==Q);return dt(Kt)}function J(Q,Bt,Wt,Kt,Xt,oe){var de=Q;do{for(var $e=de.next.next;$e!==de.prev;){if(de.i!==$e.i&&V(de,$e)){var Ue=Le(de,$e);return de=dt(de,de.next),Ue=dt(Ue,Ue.next),ot(de,Bt,Wt,Kt,Xt,oe),void ot(Ue,Bt,Wt,Kt,Xt,oe)}$e=$e.next}de=de.next}while(de!==Q)}function lt(Q,Bt){return Q.x-Bt.x}function Ft(Q,Bt){var Wt=function(oe,de){var $e,Ue=de,Zn=oe.x,Ke=oe.y,Un=-1/0;do{if(Ke<=Ue.y&&Ke>=Ue.next.y&&Ue.next.y!==Ue.y){var Hn=Ue.x+(Ke-Ue.y)*(Ue.next.x-Ue.x)/(Ue.next.y-Ue.y);if(Hn<=Zn&&Hn>Un){if(Un=Hn,Hn===Zn){if(Ke===Ue.y)return Ue;if(Ke===Ue.next.y)return Ue.next}$e=Ue.x<Ue.next.x?Ue:Ue.next}}Ue=Ue.next}while(Ue!==de);if(!$e)return null;if(Zn===Un)return $e;var er,bn=$e,Cr=$e.x,Lr=$e.y,Rr=1/0;Ue=$e;do Zn>=Ue.x&&Ue.x>=Cr&&Zn!==Ue.x&&B(Ke<Lr?Zn:Un,Ke,Cr,Lr,Ke<Lr?Un:Zn,Ke,Ue.x,Ue.y)&&(er=Math.abs(Ke-Ue.y)/(Zn-Ue.x),se(Ue,oe)&&(er<Rr||er===Rr&&(Ue.x>$e.x||Ue.x===$e.x&&jt($e,Ue)))&&($e=Ue,Rr=er)),Ue=Ue.next;while(Ue!==bn);return $e}(Q,Bt);if(!Wt)return Bt;var Kt=Le(Wt,Q),Xt=dt(Wt,Wt.next);return dt(Kt,Kt.next),Bt===Wt?Xt:Bt}function jt(Q,Bt){return ut(Q.prev,Q,Bt.prev)<0&&ut(Bt.next,Q,Q.next)<0}function kt(Q,Bt,Wt,Kt,Xt){return(Q=1431655765&((Q=858993459&((Q=252645135&((Q=16711935&((Q=32767*(Q-Wt)*Xt)|Q<<8))|Q<<4))|Q<<2))|Q<<1))|(Bt=1431655765&((Bt=858993459&((Bt=252645135&((Bt=16711935&((Bt=32767*(Bt-Kt)*Xt)|Bt<<8))|Bt<<4))|Bt<<2))|Bt<<1))<<1}function I(Q){var Bt=Q,Wt=Q;do(Bt.x<Wt.x||Bt.x===Wt.x&&Bt.y<Wt.y)&&(Wt=Bt),Bt=Bt.next;while(Bt!==Q);return Wt}function B(Q,Bt,Wt,Kt,Xt,oe,de,$e){return(Xt-de)*(Bt-$e)-(Q-de)*(oe-$e)>=0&&(Q-de)*(Kt-$e)-(Wt-de)*(Bt-$e)>=0&&(Wt-de)*(oe-$e)-(Xt-de)*(Kt-$e)>=0}function V(Q,Bt){return Q.next.i!==Bt.i&&Q.prev.i!==Bt.i&&!function(Wt,Kt){var Xt=Wt;do{if(Xt.i!==Wt.i&&Xt.next.i!==Wt.i&&Xt.i!==Kt.i&&Xt.next.i!==Kt.i&&Y(Xt,Xt.next,Wt,Kt))return!0;Xt=Xt.next}while(Xt!==Wt);return!1}(Q,Bt)&&(se(Q,Bt)&&se(Bt,Q)&&function(Wt,Kt){var Xt=Wt,oe=!1,de=(Wt.x+Kt.x)/2,$e=(Wt.y+Kt.y)/2;do Xt.y>$e!=Xt.next.y>$e&&Xt.next.y!==Xt.y&&de<(Xt.next.x-Xt.x)*($e-Xt.y)/(Xt.next.y-Xt.y)+Xt.x&&(oe=!oe),Xt=Xt.next;while(Xt!==Wt);return oe}(Q,Bt)&&(ut(Q.prev,Q,Bt.prev)||ut(Q,Bt.prev,Bt))||F(Q,Bt)&&ut(Q.prev,Q,Q.next)>0&&ut(Bt.prev,Bt,Bt.next)>0)}function ut(Q,Bt,Wt){return(Bt.y-Q.y)*(Wt.x-Bt.x)-(Bt.x-Q.x)*(Wt.y-Bt.y)}function F(Q,Bt){return Q.x===Bt.x&&Q.y===Bt.y}function Y(Q,Bt,Wt,Kt){var Xt=ct(ut(Q,Bt,Wt)),oe=ct(ut(Q,Bt,Kt)),de=ct(ut(Wt,Kt,Q)),$e=ct(ut(Wt,Kt,Bt));return Xt!==oe&&de!==$e||!(Xt!==0||!$(Q,Wt,Bt))||!(oe!==0||!$(Q,Kt,Bt))||!(de!==0||!$(Wt,Q,Kt))||!($e!==0||!$(Wt,Bt,Kt))}function $(Q,Bt,Wt){return Bt.x<=Math.max(Q.x,Wt.x)&&Bt.x>=Math.min(Q.x,Wt.x)&&Bt.y<=Math.max(Q.y,Wt.y)&&Bt.y>=Math.min(Q.y,Wt.y)}function ct(Q){return Q>0?1:Q<0?-1:0}function se(Q,Bt){return ut(Q.prev,Q,Q.next)<0?ut(Q,Bt,Q.next)>=0&&ut(Q,Q.prev,Bt)>=0:ut(Q,Bt,Q.prev)<0||ut(Q,Q.next,Bt)<0}function Le(Q,Bt){var Wt=new Zt(Q.i,Q.x,Q.y),Kt=new Zt(Bt.i,Bt.x,Bt.y),Xt=Q.next,oe=Bt.prev;return Q.next=Bt,Bt.prev=Q,Wt.next=Xt,Xt.prev=Wt,Kt.next=Wt,Wt.prev=Kt,oe.next=Kt,Kt.prev=oe,Kt}function ee(Q,Bt,Wt,Kt){var Xt=new Zt(Q,Bt,Wt);return Kt?(Xt.next=Kt.next,Xt.prev=Kt,Kt.next.prev=Xt,Kt.next=Xt):(Xt.prev=Xt,Xt.next=Xt),Xt}function xt(Q){Q.next.prev=Q.prev,Q.prev.next=Q.next,Q.prevZ&&(Q.prevZ.nextZ=Q.nextZ),Q.nextZ&&(Q.nextZ.prevZ=Q.prevZ)}function Zt(Q,Bt,Wt){this.i=Q,this.x=Bt,this.y=Wt,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $t(Q,Bt,Wt,Kt){for(var Xt=0,oe=Bt,de=Wt-Kt;oe<Wt;oe+=Kt)Xt+=(Q[de]-Q[oe])*(Q[oe+1]+Q[de+1]),de=oe;return Xt}Re.exports=it,Re.exports.default=it,it.deviation=function(Q,Bt,Wt,Kt){var Xt=Bt&&Bt.length,oe=Xt?Bt[0]*Wt:Q.length,de=Math.abs($t(Q,0,oe,Wt));if(Xt)for(var $e=0,Ue=Bt.length;$e<Ue;$e++){var Zn=Bt[$e]*Wt,Ke=$e<Ue-1?Bt[$e+1]*Wt:Q.length;de-=Math.abs($t(Q,Zn,Ke,Wt))}var Un=0;for($e=0;$e<Kt.length;$e+=3){var Hn=Kt[$e]*Wt,er=Kt[$e+1]*Wt,bn=Kt[$e+2]*Wt;Un+=Math.abs((Q[Hn]-Q[bn])*(Q[er+1]-Q[Hn+1])-(Q[Hn]-Q[er])*(Q[bn+1]-Q[Hn+1]))}return de===0&&Un===0?0:Math.abs((Un-de)/de)},it.flatten=function(Q){for(var Bt=Q[0][0].length,Wt={vertices:[],holes:[],dimensions:Bt},Kt=0,Xt=0;Xt<Q.length;Xt++){for(var oe=0;oe<Q[Xt].length;oe++)for(var de=0;de<Bt;de++)Wt.vertices.push(Q[Xt][oe][de]);Xt>0&&(Kt+=Q[Xt-1].length,Wt.holes.push(Kt))}return Wt}},function(Re,C,S){Re.exports=function(it){var j={};function dt(ot){if(j[ot])return j[ot].exports;var X=j[ot]={i:ot,l:!1,exports:{}};return it[ot].call(X.exports,X,X.exports,dt),X.l=!0,X.exports}return dt.m=it,dt.c=j,dt.d=function(ot,X,ft){dt.o(ot,X)||Object.defineProperty(ot,X,{enumerable:!0,get:ft})},dt.r=function(ot){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(ot,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(ot,"__esModule",{value:!0})},dt.t=function(ot,X){if(1&X&&(ot=dt(ot)),8&X||4&X&&typeof ot=="object"&&ot&&ot.__esModule)return ot;var ft=Object.create(null);if(dt.r(ft),Object.defineProperty(ft,"default",{enumerable:!0,value:ot}),2&X&&typeof ot!="string")for(var tt in ot)dt.d(ft,tt,function(J){return ot[J]}.bind(null,tt));return ft},dt.n=function(ot){var X=ot&&ot.__esModule?function(){return ot.default}:function(){return ot};return dt.d(X,"a",X),X},dt.o=function(ot,X){return Object.prototype.hasOwnProperty.call(ot,X)},dt.p="",dt(dt.s=34)}([function(it,j){it.exports=S(5)},function(it,j){it.exports=`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
}
`},function(it,j){it.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform float lines[26];
varying vec2 vUv;
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float middleAlpha = 0.0;
	float endAlpha = 0.0;
	float headLength = 0.0;
	if (timePercent < 0.5) {
		middleAlpha = 1.0;
		endAlpha = 1.0 - (timePercent / 0.5);
	}
	else {
		middleAlpha = 1.0 - ((timePercent - 0.5) / 0.5);
		endAlpha = 0.0;
	}
	for (int i = 0; i < 26; i++) {
		float halfDis = lines[i] / 2.0;
		float middleX = headLength + halfDis;
		headLength += lines[i];
		if (abs(vUv.x - middleX) <= halfDis) {
			srcColor.a = endAlpha + (((halfDis - abs(vUv.x - middleX)) / halfDis) * (middleAlpha - endAlpha));
			gl_FragColor = blendSrcOver(srcColor, distColor);
			return ;
		}
	}
	gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`},function(it,j){it.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
void main() {
	float maxR;
	float ringR;
	float radiusMin;
	float radiusMax;
	float dist;
	vec2 uv = vec2(vUv.x, vUv.y);
	maxR = length(transform(vec2(1.0, 1.0)));
	ringR = 1.0 / 6.0;
	radiusMin = timePercent * maxR;
	radiusMax = radiusMin + ringR;
	dist = length(transform(uv));
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	if (dist < radiusMin) {
		srcColor.a = 0.0;
	}
	else if ((dist >= radiusMin) && (dist <= radiusMax)) {
		srcColor.a = (dist - radiusMin) / ringR;
	}
	else {
		srcColor.a = 1.0;
	}
	if (timePercent >= 1.0) {
		srcColor.a = 0.0;
	}
	else if (timePercent == 0.0) {
		srcColor.a = 1.0;
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(it,j){it.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
vec2 offset(float progress[4], float band, float amp, float radius) {
	vec2 tc = vUv.xy;
	vec2 uv = vec2(0.0, 0.0);
	vec2 p;
	float len;
	vec2 uv_offset;
	float wave_width = band * radius;
	for (int i = 0; i < 4; i += 1) {
		if (progress[i] == -1.0) {
			continue;
		}
		p = tc - vec2(0.5, 0.5);
		p.x = (p.x * width) / height;
		len = length(p);
		float current_progress = progress[i];
		float current_radius = radius * current_progress;
		float damp_factor = 1.0;
		if (current_progress > .5) {
			damp_factor = (1.0 - current_progress) * 2.0;
		}
		float cut_factor = clamp((wave_width * damp_factor) - abs(current_radius - len), 0.0, 1.0);
		float waves_factor = (4.0 * len) / radius;
		uv_offset = (((p / len) * cos((waves_factor - (current_progress * 10.0)) * 3.14)) * amp) * cut_factor;
		uv += uv_offset;
	}
	return uv;
}
void main() {
	float maxR;
	float ringR;
	float radiusMin;
	float radiusMax;
	float dist;
	float progress[4];
	vec2 uv = vUv.xy;
	vec2 uvOffset = vec2(0.0, 0.0);
	maxR = length(transform(vec2(1.0, 1.0)));
	ringR = 1.0 / 6.0;
	radiusMin = timePercent * maxR;
	radiusMax = radiusMin + ringR;
	dist = length(transform(uv));
	for (int i = 0; i < 4; i++) {
		progress[i] = timePercent + (0.1 * float(i));
		if (progress[i] < 0.0) {
			progress[i] = 0.0;
		}
	}
	uvOffset = offset(progress, 0.2, 0.3, 1.0);
	vec4 srcColor = texture2D(texturePrev, fract(vUv + uvOffset));
	vec4 distColor = texture2D(textureNext, fract(vUv + uvOffset));
	if (dist < radiusMin) {
		srcColor.a = 0.0;
	}
	else if ((dist >= radiusMin) && (dist <= radiusMax)) {
		srcColor.a = (dist - radiusMin) / ringR;
	}
	else {
		srcColor.a = 1.0;
	}
	if (timePercent >= 1.0) {
		srcColor.a = 0.0;
	}
	else if (timePercent == 0.0) {
		srcColor.a = 1.0;
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(it,j){it.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alphaStart = timePercent > 0.5 ? ((timePercent - 0.5) / 0.5) * 1.0 : 1.0;
	float alphaEnd = timePercent < 0.5 ? ((0.5 - timePercent) / 0.5) * 1.0 : 0.0;
	float rectStart = 0.5 * (1.0 - timePercent);
	float rectEnd = rectStart + 0.5;
	if (timePercent <= 0.33) {
		alphaStart = 1.0;
		alphaEnd = (1.0 - (timePercent / 0.33)) * 1.0;
		rectStart = 0.5;
		rectEnd = 1.0;
	}
	else if ((timePercent > 0.33) && (timePercent <= 0.66)) {
		alphaStart = 1.0;
		alphaEnd = 0.0;
		rectEnd = 1.0 - (((timePercent - 0.33) / 0.33) * 0.5);
		rectStart = rectEnd - 0.5;
	}
	else {
		alphaStart = ((1.0 - timePercent) / (1.0 - 0.66)) * 1.0;
		alphaEnd = 0.0;
		rectStart = 0.0;
		rectEnd = 0.5;
	}
	if (vUv.x >= rectEnd) {
		srcColor.a = 0.0;
	}
	else if (vUv.x <= rectStart) {
		srcColor.a = 1.0;
	}
	else {
		srcColor.a = alphaStart - (((vUv.x - rectStart) / 0.5) * (alphaStart - alphaEnd));
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(it,j){it.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform sampler2D dissolveTexture;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 dissolveColor = texture2D(dissolveTexture, vUv);
	if (dissolveColor.r == 0.0) {
		result = srcColor;
	}
	else {
		result = distColor;
	}
	gl_FragColor = result;
}
`},function(it,j){it.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	if (timePercent < 0.5) {
		float stagePercent = timePercent / 0.5;
		result = srcColor + (stagePercent * (1.0 - srcColor));
	}
	else {
		float stagePercent = (timePercent - 0.5) / 0.5;
		result = 1.0 - (stagePercent * (1.0 - distColor));
	}
	gl_FragColor = result;
}
`},function(it,j){it.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	srcColor.a = 1.0 - timePercent;
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float line = interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 3);
	if (vUv.y > line) {
		vec2 uv = vUv.xy;
		uv.y -= line;
		result = texture2D(texturePrev, uv);
	}
	else {
		vec2 uv = vUv.xy;
		uv.y += (1.0 - line);
		result = texture2D(textureNext, uv);
	}
	gl_FragColor = result;
}
`},function(it,j){it.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec2 rectLeft = vec2(0.25, 0.5);
	vec2 rectRight = vec2(0.5, 0.75);
	vec2 alphaLeft = vec2(1.0, 1.0);
	vec2 alphaRight = vec2(1.0, 1.0);
	if (timePercent <= 0.333) {
		alphaLeft.y = 1.0 - (timePercent / 0.333);
		alphaRight.x = 1.0 - (timePercent / 0.333);
	}
	else if ((timePercent <= 0.666) && (timePercent > 0.333)) {
		rectLeft.x -= (((timePercent - 0.333) / 0.333) * 0.25);
		rectLeft.y = rectLeft.x + 0.25;
		rectRight.y += (((timePercent - 0.333) / 0.333) * 0.25);
		rectRight.x = rectRight.y - 0.25;
		alphaLeft.y = 0.0;
		alphaRight.x = 0.0;
	}
	else {
		rectLeft = vec2(0.0, 0.25);
		rectRight = vec2(0.75, 1.0);
		alphaLeft.y = 0.0;
		alphaRight.x = 0.0;
		alphaLeft.x = 1.0 - ((timePercent - 0.666) / (1.0 - 0.666));
		alphaRight.y = 1.0 - ((timePercent - 0.666) / (1.0 - 0.666));
	}
	if ((vUv.x < rectLeft.x) || (vUv.x > rectRight.y)) {
		srcColor.a = 1.0;
	}
	else if ((vUv.x > rectLeft.y) && (vUv.x < rectRight.x)) {
		srcColor.a = 0.0;
	}
	else {
		if ((vUv.x >= rectLeft.x) && (vUv.x <= rectLeft.y)) {
			srcColor.a = alphaLeft.x - (((vUv.x - rectLeft.x) / (rectLeft.y - rectLeft.x)) * (alphaLeft.x - alphaLeft.y));
		}
		else {
			srcColor.a = alphaRight.y - (((rectRight.y - vUv.x) / (rectLeft.y - rectLeft.x)) * (alphaRight.y - alphaRight.x));
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(it,j){it.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 uv4 = vec4(vUv.x, vUv.y, 1.0, 1.0);
	float scale = 1.0;
	float transform = 0.0;
	if (timePercent < 0.5) {
		scale = 1.0 - ((timePercent / 0.5) * 0.05);
		transform = (1.0 - scale) * 0.5;
	}
	else {
		scale = 0.95 + (((timePercent - 0.5) / 0.5) * 0.05);
		transform = (1.0 - scale) * 0.5;
	}
	mat4 matrix = mat4(scale, 0.0, 0.0, 0.0, 0.0, scale, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, transform, transform, 0.0, 1.0);
	vec4 uv = matrix * uv4;
	vec4 srcColor = texture2D(texturePrev, uv.xy);
	vec4 distColor = texture2D(textureNext, uv.xy);
	vec4 result = timePercent < 0.5 ? srcColor : distColor;
	vec3 start;
	vec3 end;
	vec3 white = vec3(1.0, 1.0, 1.0);
	if ((timePercent < 0.25) || (timePercent > 0.75)) {
		result *= 1.0;
	}
	else if ((timePercent >= 0.25) && (timePercent <= 0.5)) {
		if (timePercent <= 0.375) {
			start = result.rgb;
			end = start + (((timePercent - 0.25) / 0.125) * (white - result.rgb));
		}
		else {
			start = result.rgb + (((timePercent - 0.375) / 0.125) * (white - result.rgb));
			end = white;
		}
		result = vec4(start - (vUv.x * (start - end)), result.a);
	}
	else if ((timePercent > 0.5) && (timePercent <= 0.75)) {
		if (timePercent < 0.625) {
			start = white - (((timePercent - 0.5) / 0.125) * (white - result.rgb));
			end = white;
		}
		else {
			start = result.rgb;
			end = white - (((timePercent - 0.625) / 0.125) * (white - result.rgb));
		}
		result = vec4(start - (vUv.x * (start - end)), result.a);
	}
	gl_FragColor = result;
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float line = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	if (vUv.x > line) {
		result = texture2D(textureNext, vUv);
	}
	else {
		vec2 uv = vUv.xy;
		uv.x = 1.0 - (line - vUv.x);
		result = texture2D(texturePrev, uv);
	}
	gl_FragColor = result;
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float line = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 3);
	if (vUv.x > line) {
		vec2 uv = vUv.xy;
		uv.x = vUv.x - line;
		result = texture2D(textureNext, uv);
	}
	else {
		result = texture2D(texturePrev, vUv);
	}
	gl_FragColor = result;
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
mat3 yuv2rgb = mat3(1.0, 0.0, 1.13983, 1.0, -0.39465, -0.58060, 1.0, 2.03211, 0.0);
mat3 rgb2yuv = mat3(0.2126, 0.7152, 0.0722, -0.09991, -0.33609, 0.43600, 0.615, -0.5586, -0.05639);
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec3 result;
	float resultAlpha;
	if (timePercent < 0.5) {
		result = srcColor.rgb * rgb2yuv;
		result.r += interpolationFloat(0.0, 1.0, 0.0, 0.5, timePercent, 0);
		resultAlpha = srcColor.a;
	}
	else {
		result = distColor.rgb * rgb2yuv;
		result.r += interpolationFloat(1.0, 0.0, 0.5, 1.0, timePercent, 0);
		resultAlpha = distColor.a;
	}
	result *= yuv2rgb;
	gl_FragColor = vec4(result.rgb, resultAlpha);
}
`},function(it,j){it.exports=`uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
attribute vec2 segment;
attribute float times;
varying vec2 vUv;
varying float fakePercent;
void main() {
	vUv = uv;
	float width = segmentWidth * horizontalSegments;
	float height = segmentHeight * verticalSegments;
	vec4 newPosition = vec4(position, 1.0);
	vec2 segmentOrigin = vec2(((segment.x + 0.5) * segmentWidth) - (width * 0.5), (height * 0.5) - ((1.0 * (segment.y + 0.5)) * segmentHeight));
	if (timePercent > times) {
		float percent = (timePercent - times) / 0.7;
		if (percent > 1.0) {
			percent = 1.0;
		}
		if (percent > 0.5) {
			percent += 1.0;
		}
		mat4 matrix = mat4(cos((-1.0 * percent) * 3.14), 0.0, sin((-1.0 * percent) * 3.14), 0.0, 0.0, 1.0, 0.0, 0.0, -sin((-1.0 * percent) * 3.14), 0.0, cos((-1.0 * percent) * 3.14), 0.0, 0.0, 0.0, 0.0, 1.0);
		newPosition.x -= segmentOrigin.x;
		newPosition.y -= segmentOrigin.y;
		newPosition = matrix * newPosition;
		newPosition.x += segmentOrigin.x;
		newPosition.y += segmentOrigin.y;
		if (segment.x < (horizontalSegments / 2.0)) {
			fakePercent = percent - (abs((horizontalSegments / 2.0) - segment.x) * (0.25 / horizontalSegments));
		}
		else {
			fakePercent = percent + (abs((horizontalSegments / 2.0) - segment.x) * (0.25 / horizontalSegments));
		}
	}
	if ((timePercent < 0.0001) || (timePercent > 0.9999)) {
		gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
		return ;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(it,j){it.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float fakePercent;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = srcColor;
	if (fakePercent > 0.5) {
		color = distColor;
	}
	if ((fakePercent < 0.5) && (fakePercent > 0.35)) {
		color.a = 0.5;
	}
	gl_FragColor = color;
}
`},function(it,j){it.exports=`#define PI 3.14159265
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
uniform float duration;
attribute vec2 segment;
attribute float times;
varying vec2 vUv;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	vUv = uv;
	float width = segmentWidth * horizontalSegments;
	float height = segmentHeight * verticalSegments;
	mat4 matrix;
	float stagePercent;
	vec4 newPosition = vec4(position, 1.0);
	float selfTimePercent = (timePercent - times) / (4.0 / 5.0);
	if (selfTimePercent < 0.0) {
		selfTimePercent = 0.0;
	}
	else if (selfTimePercent > 1.0) {
		selfTimePercent = 1.0;
	}
	if (selfTimePercent < (2.0 / 5.0)) {
		stagePercent = selfTimePercent / (2.0 / 5.0);
		newPosition.x -= (0.5 * width);
		matrix = rotateY(((-1.0 * stagePercent) * PI) * 0.5);
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
	}
	else if ((selfTimePercent >= (2.0 / 5.0)) && (selfTimePercent < (3.0 / 5.0))) {
		stagePercent = (selfTimePercent - (2.0 / 5.0)) / (1.0 / 5.0);
		newPosition.x -= (0.5 * width);
		newPosition = rotateY((-1.0 * PI) * 0.5) * newPosition;
		matrix = rotateY(((-1.0 * stagePercent) * PI) * 2.0);
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
		newPosition.x -= (width * stagePercent);
	}
	else {
		float offset = (((newPosition.x + (0.5 * width)) / width) * 2.0) / 5.0;
		stagePercent = (selfTimePercent - (1.0 / 5.0)) / ((2.0 / 5.0) + offset);
		if (stagePercent > 1.0) {
			stagePercent = 1.0;
		}
		vec4 vvUvv = vec4(vUv.x - 0.5, vUv.y - 0.5, 0.0, 1.0);
		vvUvv = rotateY(-1.0 * PI) * vvUvv;
		vUv = vvUvv.xy + 0.5;
		newPosition.x -= (0.5 * width);
		matrix = rotateY((((-1.0 * stagePercent) * PI) * 0.5) - (PI * 2.5));
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
		newPosition.x -= width;
	}
	if ((timePercent < 0.0001) || (timePercent > 0.9999)) {
		vUv = uv;
		gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
		return ;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(it,j){it.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = srcColor;
	if (timePercent > 0.5) {
		color = distColor;
	}
	if (timePercent < 0.0001) {
		color = srcColor;
	}
	else if (timePercent > 0.9999) {
		color = distColor;
	}
	gl_FragColor = color;
}
`},function(it,j){it.exports=`#define PI 3.14159265
attribute float index;
attribute float type;
attribute float delay;
uniform float timePercent;
uniform float segmentWidth;
uniform float segments;
varying vec2 vUv;
varying float vType;
varying float rotatePercent;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	vUv = uv;
	vType = type;
	vec4 newPosition = vec4(position, 1.0);
	float selfPercent = (timePercent - delay) / 0.7;
	rotatePercent = selfPercent;
	if (selfPercent < 0.0) {
		selfPercent = 0.0;
	}
	else if (selfPercent > 1.0) {
		selfPercent = 1.0;
	}
	float offsetX = ((segments * segmentWidth) * 0.5) - ((index + 0.5) * segmentWidth);
	float offsetZ = segmentWidth * 0.5;
	newPosition.x += offsetX;
	newPosition.z += offsetZ;
	newPosition.x *= (0.9 + ((abs(timePercent - 0.5) / 0.5) * 0.1));
	newPosition.z *= (0.9 + ((abs(timePercent - 0.5) / 0.5) * 0.1));
	newPosition = rotateY((PI * 0.5) * selfPercent) * newPosition;
	newPosition.x -= offsetX;
	newPosition.z -= offsetZ;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(it,j){it.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float vType;
varying float rotatePercent;
mat3 yuv2rgb = mat3(1.0, 0.0, 1.13983, 1.0, -0.39465, -0.58060, 1.0, 2.03211, 0.0);
mat3 rgb2yuv = mat3(0.2126, 0.7152, 0.0722, -0.09991, -0.33609, 0.43600, 0.615, -0.5586, -0.05639);
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec3 srcYuv;
	vec3 distYuv;
	if (rotatePercent < 0.5) {
		distYuv = distColor.rgb * rgb2yuv;
		distYuv.r *= (1.0 - (abs(rotatePercent - 0.5) / 0.5));
		distColor = vec4(distYuv * yuv2rgb, distColor.a);
	}
	else {
		srcYuv = distColor.rgb * rgb2yuv;
		srcYuv.r *= (abs(rotatePercent - 0.5) / 0.5);
		srcColor = vec4(srcYuv * yuv2rgb, srcColor.a);
	}
	vec4 color = vType < 0.5 ? srcColor : distColor;
	gl_FragColor = color;
}
`},function(it,j){it.exports=`float easeInFloat(float t, float b, float c, float d) {
	t = t / d;
	return ((c * t) * t) + b;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.141592653
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
attribute float isLeft;
varying vec2 vUv;
varying vec4 shadow;
void main() {
	vUv = uv;
	float scaleX;
	float transform;
	float displacement;
	vec4 newPosition = vec4(position, 1.0);
	vec4 glPosition = (projectionMatrix * modelViewMatrix) * newPosition;
	float crestCount = 24.0;
	float width = horizontalSegments * segmentWidth;
	float height = verticalSegments * segmentHeight;
	float heightFactor = (newPosition.y + (height * 0.5)) / height;
	float scaleY = interpolationFloat(1.0, 1.05, 0.0, 0.11, timePercent, 0);
	newPosition.y += (height * 0.5);
	newPosition.y *= scaleY;
	newPosition.y -= (height * 0.5);
	newPosition.y += 10.0;
	if ((timePercent > 0.0) && (timePercent < 0.333)) {
		float delay = (1.0 - heightFactor) * 0.1;
		scaleX = interpolationFloat(1.0, 0.5, 0.0 + delay, 0.333, timePercent, 1);
	}
	else if ((timePercent >= 0.333) && (timePercent < 0.5)) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.5, 0.25, 0.333, 0.5, timePercent, 2);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop - incr;
	}
	else if ((timePercent >= 0.5) && (timePercent < 0.583)) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.25, 0.5, 0.5, 0.583, timePercent, 1);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop - incr;
	}
	else if (timePercent >= 0.583) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.5, 0.75, 0.583, 0.666, timePercent, 2);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop + incr;
	}
	if (timePercent > 0.583) {
		displacement = (isLeft < 0.5 ? 1.0 : -1.0) * interpolationFloat(0.0, width / 2.0, 0.583, 1.0, timePercent, 0);
	}
	float ampTop = interpolationFloat(0.0, 1.0, 0.0, 0.11, timePercent, 0);
	float ampBottom = interpolationFloat(0.0, 1.0, 0.11, 0.22, timePercent, 0);
	float amp = ampBottom + (heightFactor * abs(ampBottom - ampTop));
	float foo = newPosition.x * ((crestCount * PI) / width);
	newPosition.z = (amp * cos(foo + (PI / 2.0))) * 20.0;
	transform = (isLeft < 0.5 ? -1.0 : 1.0) * (width * 0.5);
	newPosition.x += transform;
	newPosition.x *= scaleX;
	newPosition.x -= transform;
	newPosition.x += displacement;
	shadow = vec4(0.0, 0.0, 0.0, 0.0);
	if (newPosition.z < 15.0) {
		float alpha = 0.3 * (1.0 - ((newPosition.z + 20.0) / 35.0));
		shadow.a = alpha * amp;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(it,j){it.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying vec4 shadow;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = blendSrcOver(shadow, srcColor);
	gl_FragColor = color;
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265
uniform float timePercent;
uniform float aCoefficient;
uniform float zCurveLimit;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
varying vec2 vUv;
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float curve;
	float aStart = interpolationFloat(0.00000009, aCoefficient, 0.0, 0.5, timePercent, 0);
	float aEnd = 0.0000009;
	float zStart = interpolationFloat(0.0, zCurveLimit, 0.0, 0.5, timePercent, 0);
	float zEnd = 0.0;
	float a = interpolationFloat(aStart, aEnd, 0.0, halfWidth * 2.0, newPosition.x + halfWidth, 0);
	float z = interpolationFloat(zStart, zEnd, 0.0, halfWidth * 2.0, newPosition.x + halfWidth, 0);
	newPosition.z -= (((-a * newPosition.y) * newPosition.y) + z);
	float scaleYStart = interpolationFloat(1.0, 0.8, 0.0, 0.5, timePercent, 0);
	float scaleYEnd = 1.0;
	float scaleY = interpolationFloat(scaleYStart, scaleYEnd, 0.0, halfWidth * 2.0, newPosition.x + halfWidth, 0);
	newPosition.y += halfHeight;
	newPosition.y *= scaleY;
	float angle = interpolationFloat(0.0, -((2.0 * PI) / 3.0), 0.111, 1.0, timePercent, 1);
	mat4 rotateX = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), sin(angle), 0.0, 0.0, -sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	newPosition = rotateX * newPosition;
	newPosition.y -= halfHeight;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
	vec4 shadow = vec4(0.0, 0.0, 0.0, alpha);
	gl_FragColor = blendSrcOver(shadow, srcColor);
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
varying vec2 vUv;
varying float shadowAlpha;
mat2 rotateOrigin(float angle) {
	return mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec2 shadowPosition = vec2(position.xy);
	float rotateAngle = PI * 0.27;
	float min_r = halfWidth * 0.05;
	shadowPosition = rotateOrigin(rotateAngle) * shadowPosition;
	vec4 newPosition = vec4(shadowPosition.xy, position.z, 1.0);
	float line = interpolationFloat(0.0, halfWidth * 2.8, 0.0, 1.0, timePercent, 1);
	float dis2BaseLine = halfWidth - newPosition.x;
	float dis2Line = line - dis2BaseLine;
	float L = line <= (halfWidth * 2.0) ? line : halfWidth * 2.0;
	float r = L / PI;
	r = r < min_r ? min_r : r;
	float angle = dis2Line / r;
	if (((dis2Line > 0.0) && (dis2Line < (line * 0.5))) && (r > min_r)) {
		shadowAlpha = interpolationFloat(0.0, 0.3, 0.0, line * 0.5, dis2Line, 0);
	}
	else {
		shadowAlpha = 0.0;
	}
	if (dis2BaseLine < line) {
		newPosition.x = ((sin(angle) * r) + halfWidth) - line;
		newPosition.z = (r - (cos(angle) * r)) * 0.5;
	}
	vec2 finalPosition = vec2(newPosition.xy);
	finalPosition = rotateOrigin(-rotateAngle) * finalPosition;
	gl_Position = (projectionMatrix * modelViewMatrix) * vec4(finalPosition.xy, newPosition.z, 1.0);
}
`},function(it,j){it.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float shadowAlpha;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 shadow = vec4(0.0, 0.0, 0.0, shadowAlpha);
	gl_FragColor = blendSrcOver(shadow, srcColor);
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
varying vec2 vUv;
mat4 rotateX(float angle) {
	return mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), sin(angle), 0.0, 0.0, -sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float delay = interpolationFloat(0.0, 0.08, 0.0, halfWidth * 2.0, halfWidth + newPosition.x, 0);
	float arc = halfHeight - newPosition.y;
	float L;
	if (timePercent < 0.8) {
		L = interpolationFloat(halfHeight * 4.0, halfHeight * 22.0, 0.3 + delay, 0.8, timePercent, 0);
	}
	else {
		L = interpolationFloat(halfHeight * 22.0, halfHeight * 300.0, 0.8, 1.0, timePercent, 0);
	}
	float r = L / (2.0 * PI);
	float angle = PI - (arc / r);
	float y = sin(angle) * r;
	float z = cos(angle) * r;
	newPosition.y = halfHeight - y;
	newPosition.z = (z + r) * 0.45;
	float rotateAngle = interpolationFloat(-PI * 0.5, 0.0, 0.0 + delay, 0.4, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(rotateAngle) * newPosition;
	newPosition.y += halfHeight;
	float backRotate1 = interpolationFloat(0.0, PI * 0.03, 0.75, 0.9, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(backRotate1) * newPosition;
	newPosition.y += halfHeight;
	float backRotate2 = interpolationFloat(0.0, -PI * 0.03, 0.8, 1.0, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(backRotate2) * newPosition;
	newPosition.y += halfHeight;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
	vec4 shadow = vec4(0.0, 0.0, 0.0, 0.0);
	gl_FragColor = blendSrcOver(shadow, distColor);
}
`},function(it,j){it.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float shadowAngle = PI / 6.0;
	float clockAngle;
	vec2 a;
	vec2 b = transform(vUv);
	float angle;
	if (timePercent < 0.5) {
		a = vec2(0.0, 0.5);
		clockAngle = interpolationFloat(0.0, PI, 0.0, 0.5, timePercent, 0);
		if (b.x > 0.0) {
			angle = acos(((a.x * b.x) + (a.y * b.y)) / (sqrt((a.x * a.x) + (a.y * a.y)) * sqrt((b.x * b.x) + (b.y * b.y))));
			if (angle < clockAngle) {
				if (angle > (clockAngle - shadowAngle)) {
					float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
					srcColor.a = shadowAlpha;
				}
				else {
					srcColor.a = 0.0;
				}
			}
		}
		else {
			srcColor.a = 1.0;
		}
	}
	else {
		a = vec2(0.0, -0.5);
		clockAngle = interpolationFloat(0.0, PI + shadowAngle, 0.5, 1.0, timePercent, 0);
		if (b.x <= 0.0) {
			angle = acos(((a.x * b.x) + (a.y * b.y)) / (sqrt((a.x * a.x) + (a.y * a.y)) * sqrt((b.x * b.x) + (b.y * b.y))));
			if (angle < clockAngle) {
				if (angle > (clockAngle - shadowAngle)) {
					float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
					srcColor.a = shadowAlpha;
				}
				else {
					srcColor.a = 0.0;
				}
			}
		}
		else {
			srcColor.a = 0.0;
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
void main() {
	vec2 uv = vUv;
	bool useSrc = false;
	vec2 row;
	float delay = 0.02;
	for (int i = 0; i < 7; i++) {
		float fi = float(i);
		row.r = (fi * 1.0) / 7.0;
		row.g = (float(i + 1) * 1.0) / 7.0;
		if ((vUv.y <= row.g) && (vUv.y > row.r)) {
			if ((i % 2) == 0) {
				float x = interpolationFloat(0.0, 1.0, delay * fi, (delay * fi) + 0.86, timePercent, 1);
				if (vUv.x < x) {
					useSrc = false;
				}
				else {
					uv.x -= x;
					useSrc = true;
				}
			}
			else {
				float x = interpolationFloat(1.0, 0.0, delay * fi, (delay * fi) + 0.86, timePercent, 1);
				if (vUv.x < x) {
					uv.x = (1.0 - x) + uv.x;
					useSrc = true;
				}
				else {
					useSrc = false;
				}
			}
			break;
		}
	}
	vec4 srcColor = texture2D(texturePrev, uv);
	vec4 distColor = texture2D(textureNext, uv);
	gl_FragColor = useSrc ? srcColor : distColor;
}
`},function(it,j){it.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
void main() {
	vec2 uvSrc = vUv;
	vec2 uvDist = vUv;
	float scaleSrc = interpolationFloat(1.0, 0.1, 0.0, 1.0, timePercent, 0);
	float scaleDist = interpolationFloat(2.0, 1.0, 0.0, 1.0, timePercent, 0);
	uvSrc -= 0.5;
	uvSrc *= scaleSrc;
	uvSrc += 0.5;
	uvDist -= 0.5;
	uvDist *= scaleDist;
	uvDist += 0.5;
	vec4 srcColor = texture2D(texturePrev, uvSrc);
	srcColor.a = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 0);
	vec4 distColor;
	if ((((uvDist.x > 1.0) || (uvDist.x < 0.0)) || (uvDist.y > 1.0)) || (uvDist.y < 0.0)) {
		distColor = vec4(0.0, 0.0, 0.0, 1.0);
	}
	else {
		distColor = texture2D(textureNext, uvDist);
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(it,j){it.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
varying vec2 vUv;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float stageOneAngle = PI / 14.0;
	float stageTwoAngle = (PI * 12.0) / 14.0;
	float stage_1 = 0.1;
	float stage_2 = 0.8;
	if (timePercent < 0.5) {
		newPosition.z = interpolationFloat(0.0, -100.0, 0.0, 0.5, timePercent, 0);
	}
	else {
		newPosition.z = interpolationFloat(-100.0, 0.0, 0.5, 1.0, timePercent, 0);
	}
	if (timePercent < stage_1) {
		float angle = interpolationFloat(0.0, stageOneAngle, 0.0, stage_1, timePercent, 0);
		newPosition.x += halfWidth;
		newPosition *= rotateY(angle);
		newPosition.x -= halfWidth;
	}
	else if ((timePercent >= stage_1) && (timePercent < stage_2)) {
		if (timePercent > 0.5) {
			newPosition *= rotateY(PI);
		}
		float offset = halfWidth - (sin((PI * 0.5) - stageOneAngle) * halfWidth);
		float angle = interpolationFloat(0.0, stageTwoAngle, stage_1, stage_2, timePercent, 0);
		newPosition *= rotateY(angle);
		newPosition.x += halfWidth;
		newPosition *= rotateY(stageOneAngle);
		newPosition.x -= halfWidth;
		newPosition.x += interpolationFloat(0.0, 2.0 * offset, stage_1, stage_2, timePercent, 0);
	}
	else {
		float angle = interpolationFloat(-stageOneAngle, 0.0, stage_2, 1.0, timePercent, 0);
		newPosition.x -= halfWidth;
		newPosition *= rotateY(angle);
		newPosition.x += halfWidth;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(it,j){it.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	gl_FragColor = timePercent < 0.5 ? srcColor : distColor;
}
`},function(it,j,dt){dt.r(j),dt.d(j,"TransactionPlayer",function(){return eu});var ot=dt(0);class X{constructor(){this.camera=new ot.OrthographicCamera(10,10,10,10),this.camera.position.z=100,this.camera.position.x=0,this.camera.position.y=0}focus(Nt,ge){Nt.position.z=50}updateAspect(Nt,ge){this.camera.left=-1*Nt/2,this.camera.right=Nt/2,this.camera.top=ge/2,this.camera.bottom=-1*ge/2,this.camera.updateProjectionMatrix()}}class ft{constructor(){this.camera=new X,this.mesh=new ot.Mesh,this.material=null,this.geometry=null}addObjects(Nt){this.mesh.position.z=50,Nt.add(this.mesh)}setTexture(Nt,ge,Ge,Qe){this.camera.updateAspect(Ge,Qe),this.geometry=new ot.PlaneGeometry(Ge,Qe,1,1),this.material=new ot.ShaderMaterial({fragmentShader:this.fragmentShader,vertexShader:`
varying vec2 vUv;
void main(){
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`}),this.material.uniforms={width:{value:Ge},height:{value:Qe},texturePrev:{value:Nt},textureNext:{value:ge},timePercent:{value:0}},this.mesh.geometry=this.geometry,this.mesh.material=this.material}updateAnimation(Nt){this.material.uniforms.timePercent.value=Nt}dispose(){var Nt,ge;(Nt=this.geometry)===null||Nt===void 0||Nt.dispose(),(ge=this.material)===null||ge===void 0||ge.dispose()}}var tt=dt(1),J=dt.n(tt),lt=dt(2),Ft=dt.n(lt),jt=dt(3),kt=dt.n(jt),I=dt(4),B=dt.n(I),V=dt(5),ut=dt.n(V),F=dt(6),Y=dt.n(F),$=dt(7),ct=dt.n($),se=dt(8),Le=dt.n(se),ee=dt(9),xt=dt.n(ee),Zt=dt(10),$t=dt.n(Zt),Q=dt(11),Bt=dt.n(Q),Wt=dt(12),Kt=dt.n(Wt),Xt=dt(13),oe=dt.n(Xt),de=dt(14),$e=dt.n(de);class Ue{constructor(){this.camera=new ot.PerspectiveCamera(60,1,1,2e3),this.camera.position.z=1e3,this.camera.position.x=0,this.camera.position.y=0}updateAspect(Nt,ge){this.camera.aspect=Nt/ge,this.camera.updateProjectionMatrix()}focus(Nt,ge){const Ge=.5*ge/Math.tan(Math.PI/6);Nt.position.z=1e3-Ge}}class Zn{constructor(){this.geometry=new ot.BufferGeometry,this.material=null,this.camera=new Ue,this.mesh=new ot.Mesh,this.textureWidth=0,this.textureHeight=0,this.prevTexture=new ot.Texture,this.nextTexture=new ot.Texture}horizontalSegments(){return Math.ceil(this.verticalSegments*this.textureWidth/this.textureHeight)}initMesh(Nt,ge){const Ge=[],Qe=[],hn=[],jn=this.verticalSegments,wn=this.horizontalSegments(),Pn=Nt/2,xr=ge/2,gr=Nt/wn,ln=ge/jn,vn=this.extraAttributes(),ir=Object.keys(vn),yi=ir.reduce((ar,Br)=>(ar[Br]=[],ar),{});for(let ar=0;ar<jn;ar++){const Br=ar*ln-xr;for(let zr=0;zr<wn;zr++){const jr=zr*gr-Pn;Qe.push(jr,-Br,0),hn.push(1*zr/wn,1-1*ar/jn),ir.forEach(Ur=>yi[Ur].push(...vn[Ur].generator(ar,zr))),Qe.push(jr+gr,-Br,0),hn.push(1*(zr+1)/wn,1-1*ar/jn),ir.forEach(Ur=>yi[Ur].push(...vn[Ur].generator(ar,zr))),Qe.push(jr,-Br-ln,0),hn.push(1*zr/wn,1-1*(ar+1)/jn),ir.forEach(Ur=>yi[Ur].push(...vn[Ur].generator(ar,zr))),Qe.push(jr+gr,-Br-ln,0),hn.push(1*(zr+1)/wn,1-1*(ar+1)/jn),ir.forEach(Ur=>yi[Ur].push(...vn[Ur].generator(ar,zr)))}}for(let ar=0;ar<jn*wn;ar++){const Br=4*ar,zr=Br+1,jr=Br+2,Ur=Br+3;Ge.push(zr,Br,Ur),Ge.push(Br,jr,Ur)}return this.geometry.setIndex(Ge),this.geometry.setAttribute("position",new ot.Float32BufferAttribute(Qe,3)),this.geometry.setAttribute("uv",new ot.Float32BufferAttribute(new Float32Array(hn),2)),ir.forEach(ar=>{this.geometry.setAttribute(ar,new ot.Float32BufferAttribute(new Float32Array(yi[ar]),vn[ar].itemSize))}),{verticalSegments:jn,horizontalSegments:wn,segmentWidth:gr,segmentHeight:ln}}initObject(){this.material=new ot.ShaderMaterial({fragmentShader:this.fragmentShader,vertexShader:this.vertexShader,side:ot.DoubleSide})}setTexture(Nt,ge,Ge,Qe){this.textureHeight=Qe,this.textureWidth=Ge,this.prevTexture=Nt,this.nextTexture=ge,this.initObject();const{verticalSegments:hn,horizontalSegments:jn,segmentWidth:wn,segmentHeight:Pn}=this.initMesh(Ge,Qe);this.material.uniforms={segmentWidth:{value:wn},segmentHeight:{value:Pn},verticalSegments:{value:hn},horizontalSegments:{value:jn},timePercent:{value:0},texturePrev:{value:Nt},textureNext:{value:ge}},this.mesh.geometry=this.geometry,this.camera.updateAspect(Ge,Qe),this.camera.focus(this.mesh,Qe),this.material.transparent=!0,this.mesh.material=this.material}addObjects(Nt){Nt.add(this.mesh)}updateAnimation(Nt){this.material.uniforms.timePercent.value=Nt}dispose(){var Nt,ge;(Nt=this.geometry)===null||Nt===void 0||Nt.dispose(),(ge=this.material)===null||ge===void 0||ge.dispose()}}var Ke=dt(15),Un=dt.n(Ke),Hn=dt(16),er=dt.n(Hn),bn=dt(17),Cr=dt.n(bn),Lr=dt(18),Rr=dt.n(Lr),Yr=dt(19),Ar=dt.n(Yr),yr=dt(20),Ri=dt.n(yr),Or=dt(21),Er=dt.n(Or),Fr=dt(22),lo=dt.n(Fr),_s=dt(23),Fn=dt.n(_s),_i=dt(24),ki=dt.n(_i),L=dt(25),k=dt.n(L),G=dt(26),st=dt.n(G);class K extends Zn{constructor(){super(...arguments),this.duration=1250,this.fragmentShader=st.a,this.vertexShader=k.a,this.verticalSegments=100}addObjects(Nt){Nt.add(this.mesh),Nt.background=this.nextTexture}extraAttributes(){return{}}}var et=dt(27),vt=dt.n(et),wt=dt(28),Ct=dt.n(wt),St=dt(29),Ut=dt.n(St),ne=dt(30),Vt=dt.n(ne),fn=dt(31),We=dt.n(fn),sr=dt(32),Ii=dt.n(sr),ui=dt(33),Bo=dt.n(ui);const ho=new ot.Vector3(0,-0,0).multiplyScalar(.1);class Uo{constructor(Nt,ge,Ge,Qe,hn){this.position=new ot.Vector3,this.previous=new ot.Vector3,this.original=new ot.Vector3,this.a=new ot.Vector3(0,0,0),this.mass=Qe,this.invMass=1/Qe,this.tmp=new ot.Vector3,this.tmp2=new ot.Vector3,hn(Nt,ge,this.position),hn(Nt,ge,this.previous),hn(Nt,ge,this.original)}addForce(Nt){this.a.add(this.tmp2.copy(Nt).multiplyScalar(this.invMass))}integrate(Nt,ge,Ge){const Qe=.25*Math.PI,hn=.25*-Math.PI,jn=new ot.Matrix3,wn=new ot.Matrix3;jn.set(Math.cos(Qe),-Math.sin(Qe),0,Math.sin(Qe),Math.cos(Qe),0,0,0,1),wn.set(Math.cos(hn),-Math.sin(hn),0,Math.sin(hn),Math.cos(hn),0,0,0,1);const Pn=this.tmp.subVectors(this.position,this.previous);Pn.multiplyScalar(.97).add(this.position),Pn.add(this.a.multiplyScalar(Nt)),this.tmp=this.previous,this.previous=this.position,this.position=Pn,this.a.set(0,0,0)}}class wa{constructor(Nt,ge,Ge){this.width=Nt,this.height=ge;const Qe=[],hn=[];for(let wn=0;wn<=ge;wn++)for(let Pn=0;Pn<=Nt;Pn++)Qe.push(new Uo(Pn/Nt,wn/ge,0,.1,Ge));for(let wn=0;wn<ge;wn++)for(let Pn=0;Pn<Nt;Pn++)hn.push([Qe[jn(Pn,wn)],Qe[jn(Pn,wn+1)],25]),hn.push([Qe[jn(Pn,wn)],Qe[jn(Pn+1,wn)],25]);for(let wn=Nt,Pn=0;Pn<ge;Pn++)hn.push([Qe[jn(wn,Pn)],Qe[jn(wn,Pn+1)],25]);for(let wn=ge,Pn=0;Pn<Nt;Pn++)hn.push([Qe[jn(Pn,wn)],Qe[jn(Pn+1,wn)],25]);function jn(wn,Pn){return wn+Pn*(Nt+1)}this.particles=Qe,this.constraints=hn,this.index=jn}}const Sa={RandomLines:class extends ft{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Ft.a}genRandomLines(){let Jt=[1];for(let ge=20;ge--;){let Ge=Jt.sort((Pn,xr)=>xr-Pn)[0],Qe=Jt.indexOf(Ge),hn=Math.random(),jn=Ge*hn,wn=Ge*(1-hn);Jt.splice(Qe,1),Jt.push(jn,wn)}let Nt=Jt.length;for(;Nt;){let ge=Math.floor(Math.random()*Nt--);[Jt[ge],Jt[Nt]]=[Jt[Nt],Jt[ge]]}return Jt}setTexture(Jt,Nt,ge,Ge){super.setTexture(Jt,Nt,ge,Ge),this.material.uniforms.lines={value:this.genRandomLines()},this.material.vertexShader=J.a}},Shape:class extends ft{constructor(){super(...arguments),this.duration=800,this.fragmentShader=kt.a}},Ripples:class extends ft{constructor(){super(...arguments),this.duration=1400,this.fragmentShader=B.a}},Erase:class extends ft{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=ut.a}},Dissolve:class extends ft{constructor(){super(...arguments),this.duration=1200,this.fragmentShader=Y.a,this.dissolveIndices={}}random40(){return Math.ceil(40*Math.random())}setTexture(Jt,Nt,ge,Ge){super.setTexture(Jt,Nt,ge,Ge);for(let Qe=0;Qe<1600;Qe++){let hn=this.random40(),jn=this.random40();for(;this.dissolveIndices[`${hn}_${jn}`]!==void 0;)hn=this.random40(),jn=this.random40();this.dissolveIndices[`${hn}_${jn}`]=0}this.material.uniforms.dissolveTexture={value:this.genDissolveToTexture()}}genDissolveToTexture(){var Jt=new Uint8Array(4800);for(let Nt=0;Nt<1600;Nt++){const ge=Nt%40+1,Ge=Math.floor(Nt/40)+1,Qe=3*Nt;this.dissolveIndices[`${ge}_${Ge}`]===0?(Jt[Qe]=0,Jt[Qe+1]=0,Jt[Qe+2]=0):(Jt[Qe]=255,Jt[Qe+1]=255,Jt[Qe+2]=255)}return new ot.DataTexture(Jt,40,40,ot.RGBFormat)}updateAnimation(Jt){const Nt=1600*Jt-Object.keys(this.dissolveIndices).filter(ge=>this.dissolveIndices[ge]===1).length;for(let ge=0;ge<Nt;ge++){const Ge=Object.keys(this.dissolveIndices).filter(hn=>this.dissolveIndices[hn]===0),Qe=Math.ceil(Math.random()*Ge.length)-1;this.dissolveIndices[Ge[Qe]]=1}this.material.uniforms.dissolveTexture.value=this.genDissolveToTexture()}},Smooth:class extends ft{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=ct.a}},FadeInOut:class extends ft{constructor(){super(...arguments),this.duration=700,this.fragmentShader=Le.a}},Push:class extends ft{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=xt.a}},Separation:class extends ft{constructor(){super(...arguments),this.duration=1500,this.fragmentShader=$t.a}},Display:class extends ft{constructor(){super(...arguments),this.duration=3400,this.fragmentShader=Bt.a}},Uncover:class extends ft{constructor(){super(...arguments),this.duration=750,this.fragmentShader=Kt.a}},Cover:class extends ft{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=oe.a}},Flash:class extends ft{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=$e.a}},Checkerboard:class extends Zn{constructor(){super(...arguments),this.duration=2500,this.fragmentShader=er.a,this.vertexShader=Un.a,this.vIndex="",this.delay=0,this.verticalSegments=5}extraAttributes(){return{times:{itemSize:1,generator:(Jt,Nt)=>(this.vIndex!==`${Jt}${Nt}`&&(this.delay=.3*Math.random(),this.vIndex=`${Jt}${Nt}`),[this.delay])},segment:{itemSize:2,generator:(Jt,Nt)=>[Nt,Jt]}}}},Vortex:class{constructor(){this.duration=4e3,this.geometry=new ot.BufferGeometry,this.material=new ot.ShaderMaterial({fragmentShader:Rr.a,vertexShader:Cr.a,side:ot.DoubleSide}),this.camera=new Ue,this.mesh=new ot.Mesh}initData(Jt,Nt){const ge=[],Ge=[],Qe=[],hn=[],jn=[],wn=[],Pn=Math.ceil(124*Jt/Nt),xr=Jt/2,gr=Nt/2,ln=Jt/Pn,vn=Nt/124;for(let ir=0;ir<124;ir++){const yi=ir*vn-gr;for(let ar=0;ar<Pn;ar++){const Br=ar*ln-xr,zr=Math.ceil((ar+1)/((Pn+1)/12)),jr=.4/zr,Ur=(zr-1)*jr+Math.random()*jr;Ge.push(Br,-yi,0),hn.push(1*ar/Pn,1-1*ir/124),Qe.push(0,0,1),jn.push(ar,ir),wn.push(Ur),Ge.push(Br+ln,-yi,0),hn.push(1*(ar+1)/Pn,1-1*ir/124),Qe.push(0,0,1),jn.push(ar,ir),wn.push(Ur),Ge.push(Br,-yi-vn,0),hn.push(1*ar/Pn,1-1*(ir+1)/124),Qe.push(0,0,1),jn.push(ar,ir),wn.push(Ur),Ge.push(Br+ln,-yi-vn,0),hn.push(1*(ar+1)/Pn,1-1*(ir+1)/124),Qe.push(0,0,1),jn.push(ar,ir),wn.push(Ur)}}for(let ir=0;ir<124*Pn;ir++){const yi=4*ir,ar=yi+1,Br=yi+2,zr=yi+3;ge.push(ar,yi,zr),ge.push(yi,Br,zr)}return this.geometry.setIndex(ge),this.geometry.setAttribute("position",new ot.Float32BufferAttribute(Ge,3)),this.geometry.setAttribute("normal",new ot.Float32BufferAttribute(Qe,3)),this.geometry.setAttribute("uv",new ot.Float32BufferAttribute(new Float32Array(hn),2)),this.geometry.setAttribute("segment",new ot.Float32BufferAttribute(new Float32Array(jn),2)),this.geometry.setAttribute("times",new ot.Float32BufferAttribute(new Float32Array(wn),1)),{verticalSegments:124,horizontalSegments:Pn,segmentWidth:ln,segmentHeight:vn}}setTexture(Jt,Nt){const{width:ge,height:Ge}=Jt.image,{verticalSegments:Qe,horizontalSegments:hn,segmentWidth:jn,segmentHeight:wn}=this.initData(ge,Ge);this.material.uniforms={duration:{value:this.duration},segmentWidth:{value:jn},segmentHeight:{value:wn},verticalSegments:{value:Qe},horizontalSegments:{value:hn},timePercent:{value:0},texturePrev:{value:Jt},textureNext:{value:Nt}},this.camera.updateAspect(ge,Ge),this.camera.focus(this.mesh,Ge),this.mesh.geometry=this.geometry,new ot.MeshPhongMaterial({side:ot.DoubleSide,vertexColors:!0}).wireframe=!0,this.material.transparent=!0,this.mesh.material=this.material,console.log(ot)}addObjects(Jt){Jt.add(this.mesh)}updateAnimation(Jt){this.material.uniforms.timePercent.value=Jt}dispose(){var Jt,Nt;(Jt=this.geometry)===null||Jt===void 0||Jt.dispose(),(Nt=this.material)===null||Nt===void 0||Nt.dispose()}},WindowShades:class{constructor(){this.duration=1600,this.geometry=new ot.BufferGeometry,this.material=new ot.ShaderMaterial({fragmentShader:Ri.a,vertexShader:Ar.a,side:ot.DoubleSide}),this.horizontalSegments=16,this.meshToCameraDistance=0,this.camera=new Ue,this.mesh=new ot.Mesh}initData(Jt,Nt){const ge=[],Ge=[],Qe=[],hn=[],jn=[],wn=[],Pn=Jt/2,xr=Nt/2,gr=Jt/this.horizontalSegments;for(let ln=0;ln<this.horizontalSegments;ln++){const vn=Math.abs(ln-Math.ceil(this.horizontalSegments/2))*(.3/Math.ceil(this.horizontalSegments/2)),ir=ln*gr-Pn;Ge.push(ir,xr,0),Qe.push(0),hn.push(ln/this.horizontalSegments,1),jn.push(ln),wn.push(vn),Ge.push(ir+gr,xr,0),Qe.push(0),hn.push((ln+1)/this.horizontalSegments,1),jn.push(ln),wn.push(vn),Ge.push(ir,-1*xr,0),Qe.push(0),hn.push(ln/this.horizontalSegments,0),jn.push(ln),wn.push(vn),Ge.push(ir+gr,-1*xr,0),hn.push((ln+1)/this.horizontalSegments,0),Qe.push(0),jn.push(ln),wn.push(vn),Ge.push(ir+gr,xr,0),Qe.push(1),hn.push(ln/this.horizontalSegments,1),jn.push(ln),wn.push(vn),Ge.push(ir+gr,xr,-1*gr),Qe.push(1),hn.push((ln+1)/this.horizontalSegments,1),jn.push(ln),wn.push(vn),Ge.push(ir+gr,-1*xr,0),Qe.push(1),hn.push(ln/this.horizontalSegments,0),jn.push(ln),wn.push(vn),Ge.push(ir+gr,-1*xr,-1*gr),hn.push((ln+1)/this.horizontalSegments,0),Qe.push(1),jn.push(ln),wn.push(vn)}for(let ln=0;ln<this.horizontalSegments;ln++){const vn=8*ln,ir=vn+1,yi=vn+2,ar=vn+3,Br=vn+4,zr=vn+5,jr=vn+6,Ur=vn+7;ge.push(ir,vn,ar),ge.push(vn,yi,ar),ge.push(zr,Br,Ur),ge.push(Br,jr,Ur)}this.geometry.setIndex(ge),this.geometry.setAttribute("position",new ot.Float32BufferAttribute(Ge,3)),this.geometry.setAttribute("uv",new ot.Float32BufferAttribute(new Float32Array(hn),2)),this.geometry.setAttribute("index",new ot.Float32BufferAttribute(new Float32Array(jn),1)),this.geometry.setAttribute("type",new ot.Float32BufferAttribute(new Float32Array(Qe),1)),this.geometry.setAttribute("delay",new ot.Float32BufferAttribute(new Float32Array(wn),1))}setTexture(Jt,Nt,ge,Ge){this.initData(ge,Ge),this.material.uniforms={segments:{value:this.horizontalSegments},segmentWidth:{value:ge/this.horizontalSegments},timePercent:{value:0},texturePrev:{value:Jt},textureNext:{value:Nt}},this.meshToCameraDistance=.5*Ge/Math.tan(Math.PI/6),this.camera.updateAspect(ge,Ge),this.camera.focus(this.mesh,Ge),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material}addObjects(Jt){Jt.add(this.mesh)}updateAnimation(Jt){this.material.uniforms.timePercent.value=Jt}dispose(){var Jt,Nt;(Jt=this.geometry)===null||Jt===void 0||Jt.dispose(),(Nt=this.material)===null||Nt===void 0||Nt.dispose()}},Curtain:class extends Zn{constructor(){super(...arguments),this.duration=6e3,this.fragmentShader=lo.a,this.vertexShader=Er.a,this.verticalSegments=100}extraAttributes(){return{isLeft:{itemSize:1,generator:(Jt,Nt)=>[Nt<this.horizontalSegments()/2?1:0]}}}addObjects(Jt){super.addObjects(Jt),this.mesh.position.z+=20,Jt.background=this.nextTexture}},Fall:class extends Zn{constructor(){super(...arguments),this.zCurveLimit=100,this.duration=2e3,this.verticalSegments=100,this.fragmentShader=ki.a,this.vertexShader=Fn.a}extraAttributes(){return{}}setTexture(Jt,Nt,ge,Ge){super.setTexture(Jt,Nt,ge,Ge),this.material.uniforms.zCurveLimit={value:this.zCurveLimit},this.material.uniforms.aCoefficient={value:this.zCurveLimit/(this.textureHeight/2*(this.textureHeight/2))}}addObjects(Jt){Jt.add(this.mesh),Jt.background=this.nextTexture}updateAnimation(Jt){this.material.uniforms.timePercent.value=Jt}},Suspension:class extends K{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=Ct.a,this.vertexShader=vt.a}addObjects(Jt){Jt.add(this.mesh),Jt.background=this.prevTexture}},Clock:class extends ft{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Ut.a}},Combing:class extends ft{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Vt.a}},Scale:class extends ft{constructor(){super(...arguments),this.duration=900,this.fragmentShader=We.a}},PeelOff:K,Flip:class extends Zn{constructor(){super(...arguments),this.duration=1250,this.fragmentShader=Bo.a,this.vertexShader=Ii.a,this.verticalSegments=1}extraAttributes(){return{}}},Wind:class{constructor(){this.duration=2e3,this.camera=new Ue,this.mesh=new ot.Mesh,this.geometry=null,this.material=new ot.MeshLambertMaterial({side:ot.DoubleSide,alphaTest:.5}),this.tmpForce=new ot.Vector3,this.windForce=new ot.Vector3(0,0,0),this.cloth=null,this.nextTexture=null,this.diff=new ot.Vector3,this.xSegs=10,this.ySegs=10,this.width=10,this.height=10,this.enablePins=!0,this.animate=Jt=>{this.simulate(Jt),this.render(),requestAnimationFrame(this.animate)}}setTexture(Jt,Nt,ge,Ge){const Qe=ge,hn=Ge;this.xSegs=Math.ceil(Qe/25),this.ySegs=Math.ceil(hn/25),this.width=25*this.xSegs,this.height=25*this.ySegs;const jn=function(wn,Pn){return function(xr,gr,ln){const vn=(xr-.5)*wn,ir=(gr+.5)*Pn;ln.set(vn,ir,0)}}(25*this.xSegs,25*this.ySegs);this.cloth=new wa(this.xSegs,this.ySegs,jn),this.nextTexture=Nt,this.camera.updateAspect(Qe,hn),this.material.map=Jt,this.geometry=new ot.ParametricBufferGeometry(jn,this.cloth.width,this.cloth.height),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material,this.mesh.castShadow=!0,this.mesh.position.y-=hn,this.mesh.customDepthMaterial=new ot.MeshDepthMaterial({depthPacking:ot.RGBADepthPacking,map:Jt,alphaTest:.5}),this.camera.focus(this.mesh,hn)}addObjects(Jt){Jt.add(this.mesh),Jt.background=this.nextTexture,Jt.add(new ot.AmbientLight(6710886));const Nt=new ot.DirectionalLight(14674943,1);Nt.position.set(0,0,100),Nt.position.multiplyScalar(1.3),Nt.castShadow=!0,Nt.shadow.mapSize.width=1024,Nt.shadow.mapSize.height=1024;const ge=300;Nt.shadow.camera.left=-ge,Nt.shadow.camera.right=ge,Nt.shadow.camera.top=ge,Nt.shadow.camera.bottom=-ge,Nt.shadow.camera.far=1e3,Jt.add(Nt),this.animate(0)}satisfyConstraints(Jt,Nt,ge){this.diff.subVectors(Nt.position,Jt.position);const Ge=this.diff.length();if(Ge===0)return;const Qe=this.diff.multiplyScalar(1-ge/Ge).multiplyScalar(.5);Jt.position.add(Qe),Nt.position.sub(Qe)}simulate(Jt){const Nt=20*Math.abs(Math.cos(Jt/70));this.windForce.set(Math.abs(Math.sin(Jt/300)),Math.abs(Math.cos(Jt/200)),Math.sin(Jt/1e3)),this.windForce.normalize(),this.windForce.x*=50*Nt,this.windForce.y*=50*Nt,this.windForce.z*=.2*Nt;const ge=this.cloth.particles;let Ge;const Qe=new ot.Vector3,hn=this.geometry.index,jn=this.geometry.attributes.normal;for(let xr=0,gr=hn.count;xr<gr;xr+=3)for(let ln=0;ln<3;ln++)Ge=hn.getX(xr+ln),Qe.fromBufferAttribute(jn,Ge),this.tmpForce.copy(Qe).normalize().multiplyScalar(Qe.dot(this.windForce)),ge[Ge].addForce(this.tmpForce);for(let xr=0,gr=ge.length;xr<gr;xr++){const ln=ge[xr];ln.addForce(ho),ln.integrate(144e-6,this.width,this.height)}const wn=this.cloth.constraints,Pn=wn.length;for(let xr=0;xr<Pn;xr++){const gr=wn[xr];this.satisfyConstraints(gr[0],gr[1],gr[2])}for(let xr=0,gr=ge.length;xr<gr;xr++){const ln=ge[xr].position;ln.y<-250&&(ln.y=-250)}if(this.enablePins){let xr=new Array(this.xSegs+1).fill("").map((gr,ln)=>ln);for(let gr=0;gr<this.ySegs+1;gr++)xr.push(gr*(this.xSegs+1));for(let gr=0,ln=xr.length;gr<ln;gr++){const vn=ge[xr[gr]];vn.position.copy(vn.original),vn.previous.copy(vn.original)}}}render(){const Jt=this.cloth.particles;for(let Nt=0,ge=Jt.length;Nt<ge;Nt++){const Ge=Jt[Nt].position;this.geometry.attributes.position.setXYZ(Nt,Ge.x,Ge.y,Ge.z)}this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeVertexNormals()}updateAnimation(Jt){Jt>.5&&(this.enablePins=!1),Jt>.9999&&(this.mesh.visible=!1)}dispose(){var Jt,Nt;(Jt=this.geometry)===null||Jt===void 0||Jt.dispose(),(Nt=this.material)===null||Nt===void 0||Nt.dispose()}}},ml={linear:(Jt,Nt,ge,Ge)=>ge*Jt/Ge+Nt,easeIn:(Jt,Nt,ge,Ge)=>ge*(Jt/=Ge)*Jt+Nt,strongEaseIn:(Jt,Nt,ge,Ge)=>ge*(Jt/=Ge)*Jt*Jt*Jt*Jt+Nt,strongEaseOut:(Jt,Nt,ge,Ge)=>ge*((Jt=Jt/Ge-1)*Jt*Jt*Jt*Jt+1)+Nt,sineaseIn:(Jt,Nt,ge,Ge)=>ge*(Jt/=Ge)*Jt*Jt+Nt,sineaseOut:(Jt,Nt,ge,Ge)=>ge*((Jt=Jt/Ge-1)*Jt*Jt+1)+Nt};class eu{constructor(){this.startTime=0,this.lastTime=0,this.reverse=!1,this.scene=new ot.Scene,this.delay=0,this.easeFn=ml.linear,this.preset=null,this.onTransactionEnd=()=>{},this.textureLoader=new ot.TextureLoader,this.prevTexture=null,this.nextTexture=null,this.renderer=new ot.WebGLRenderer({alpha:!0,premultipliedAlpha:!0}),this.isPlaying=!1,this.animate=(Nt=-1)=>{var ge,Ge,Qe;this.renderer.clear(),Nt>this.delay&&this.lastTime===0&&(this.lastTime=Nt,this.startTime=Nt);let hn=0;this.lastTime>0&&hn<1&&(hn=this.easeFn(Nt-this.startTime,0,1,(Ge=(ge=this.preset)===null||ge===void 0?void 0:ge.duration)!==null&&Ge!==void 0?Ge:0)),hn>1&&(hn=1),(Qe=this.preset)===null||Qe===void 0||Qe.updateAnimation(this.reverse?1-hn:hn),this.rerender(),hn<1?window.requestAnimationFrame(this.animate):(this.dispose(),this.onTransactionEnd())}}play(Nt){var ge,Ge,Qe;Nt.onTransactionEnd&&(this.onTransactionEnd=Nt.onTransactionEnd),this.init(Nt),this.renderer.setSize(Nt.stageWidth,Nt.stageHeight),this.preset=new Sa[Nt.presetType],Nt.duration&&Number.isInteger(Nt.duration)&&(this.preset.duration=Nt.duration),this.prevTexture=this.textureLoader.load(Nt.prevTextureUrl),this.nextTexture=this.textureLoader.load(Nt.nextTextureUrl),this.reverse?(ge=this.preset)===null||ge===void 0||ge.setTexture(this.nextTexture,this.prevTexture,Nt.textureWidth,Nt.textureHeight):(Ge=this.preset)===null||Ge===void 0||Ge.setTexture(this.prevTexture,this.nextTexture,Nt.textureWidth,Nt.textureHeight),(Qe=this.preset)===null||Qe===void 0||Qe.addObjects(this.scene),this.animate(),this.isPlaying=!0}init(Nt){this.reverse=Nt.reverse,Nt.delay&&Number.isInteger(Nt.delay)&&(this.delay=Nt.delay),Nt.easeFn&&(this.easeFn=ml[Nt.easeFn]),this.startTime=0,this.lastTime=0,this.scene.clear(),this.renderer.shadowMap.enabled=!0,this.renderer.autoClear=!1}rerender(){var Nt;this.renderer.clear(),((Nt=this.preset)===null||Nt===void 0?void 0:Nt.camera.camera)&&this.renderer.render(this.scene,this.preset.camera.camera)}skip(){var Nt;(Nt=this.preset)===null||Nt===void 0||Nt.updateAnimation(this.reverse?0:1),this.rerender(),this.dispose(),this.onTransactionEnd()}dispose(){var Nt,ge,Ge;this.isPlaying=!1,(Nt=this.preset)===null||Nt===void 0||Nt.dispose(),(ge=this.prevTexture)===null||ge===void 0||ge.dispose(),(Ge=this.nextTexture)===null||Ge===void 0||Ge.dispose()}}}])},function(Re,C,S){(function(it){var j=S(16),dt=S(17),ot=setTimeout;function X(B){return Boolean(B&&B.length!==void 0)}function ft(){}function tt(B){if(!(this instanceof tt))throw new TypeError("Promises must be constructed via new");if(typeof B!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],I(B,this)}function J(B,V){for(;B._state===3;)B=B._value;B._state!==0?(B._handled=!0,tt._immediateFn(function(){var ut=B._state===1?V.onFulfilled:V.onRejected;if(ut!==null){var F;try{F=ut(B._value)}catch(Y){return void Ft(V.promise,Y)}lt(V.promise,F)}else(B._state===1?lt:Ft)(V.promise,B._value)})):B._deferreds.push(V)}function lt(B,V){try{if(V===B)throw new TypeError("A promise cannot be resolved with itself.");if(V&&(typeof V=="object"||typeof V=="function")){var ut=V.then;if(V instanceof tt)return B._state=3,B._value=V,void jt(B);if(typeof ut=="function")return void I((F=ut,Y=V,function(){F.apply(Y,arguments)}),B)}B._state=1,B._value=V,jt(B)}catch($){Ft(B,$)}var F,Y}function Ft(B,V){B._state=2,B._value=V,jt(B)}function jt(B){B._state===2&&B._deferreds.length===0&&tt._immediateFn(function(){B._handled||tt._unhandledRejectionFn(B._value)});for(var V=0,ut=B._deferreds.length;V<ut;V++)J(B,B._deferreds[V]);B._deferreds=null}function kt(B,V,ut){this.onFulfilled=typeof B=="function"?B:null,this.onRejected=typeof V=="function"?V:null,this.promise=ut}function I(B,V){var ut=!1;try{B(function(F){ut||(ut=!0,lt(V,F))},function(F){ut||(ut=!0,Ft(V,F))})}catch(F){if(ut)return;ut=!0,Ft(V,F)}}tt.prototype.catch=function(B){return this.then(null,B)},tt.prototype.then=function(B,V){var ut=new this.constructor(ft);return J(this,new kt(B,V,ut)),ut},tt.prototype.finally=j.a,tt.all=function(B){return new tt(function(V,ut){if(!X(B))return ut(new TypeError("Promise.all accepts an array"));var F=Array.prototype.slice.call(B);if(F.length===0)return V([]);var Y=F.length;function $(se,Le){try{if(Le&&(typeof Le=="object"||typeof Le=="function")){var ee=Le.then;if(typeof ee=="function")return void ee.call(Le,function(xt){$(se,xt)},ut)}F[se]=Le,--Y==0&&V(F)}catch(xt){ut(xt)}}for(var ct=0;ct<F.length;ct++)$(ct,F[ct])})},tt.allSettled=dt.a,tt.resolve=function(B){return B&&typeof B=="object"&&B.constructor===tt?B:new tt(function(V){V(B)})},tt.reject=function(B){return new tt(function(V,ut){ut(B)})},tt.race=function(B){return new tt(function(V,ut){if(!X(B))return ut(new TypeError("Promise.race accepts an array"));for(var F=0,Y=B.length;F<Y;F++)tt.resolve(B[F]).then(V,ut)})},tt._immediateFn=typeof it=="function"&&function(B){it(B)}||function(B){ot(B,0)},tt._unhandledRejectionFn=function(B){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",B)},C.a=tt}).call(this,S(22).setImmediate)},function(Re,C,S){C.a=function(it){var j=this.constructor;return this.then(function(dt){return j.resolve(it()).then(function(){return dt})},function(dt){return j.resolve(it()).then(function(){return j.reject(dt)})})}},function(Re,C,S){C.a=function(it){return new this(function(j,dt){if(!it||it.length===void 0)return dt(new TypeError(typeof it+" "+it+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var ot=Array.prototype.slice.call(it);if(ot.length===0)return j([]);var X=ot.length;function ft(J,lt){if(lt&&(typeof lt=="object"||typeof lt=="function")){var Ft=lt.then;if(typeof Ft=="function")return void Ft.call(lt,function(jt){ft(J,jt)},function(jt){ot[J]={status:"rejected",reason:jt},--X==0&&j(ot)})}ot[J]={status:"fulfilled",value:lt},--X==0&&j(ot)}for(var tt=0;tt<ot.length;tt++)ft(tt,ot[tt])})}},function(Re,C,S){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var it=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;function ot(X){if(X==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(X)}Re.exports=function(){try{if(!Object.assign)return!1;var X=new String("abc");if(X[5]="de",Object.getOwnPropertyNames(X)[0]==="5")return!1;for(var ft={},tt=0;tt<10;tt++)ft["_"+String.fromCharCode(tt)]=tt;if(Object.getOwnPropertyNames(ft).map(function(lt){return ft[lt]}).join("")!=="0123456789")return!1;var J={};return"abcdefghijklmnopqrst".split("").forEach(function(lt){J[lt]=lt}),Object.keys(Object.assign({},J)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(X,ft){for(var tt,J,lt=ot(X),Ft=1;Ft<arguments.length;Ft++){for(var jt in tt=Object(arguments[Ft]))j.call(tt,jt)&&(lt[jt]=tt[jt]);if(it){J=it(tt);for(var kt=0;kt<J.length;kt++)dt.call(tt,J[kt])&&(lt[J[kt]]=tt[J[kt]])}}return lt}},function(Re,C){Re.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
}
`},function(Re,C){Re.exports=`precision mediump float;
#define KERNEL 7
varying vec2 vTextureCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 inputSize;
uniform float uStartAlpha;
uniform float uEndAlpha;
uniform int uBlur;
void main() {
	float halfHeight = uShapeFilterArea.w / 2.0;
	vec2 cod = vTextureCoord * inputSize.xy;
	if (cod.y < halfHeight) {
		gl_FragColor = texture2D(uSampler, vTextureCoord);
	}
	else {
		float alpha = uStartAlpha - (((cod.y - halfHeight) / halfHeight) * (uStartAlpha - uEndAlpha));
		vec2 cord = vec2(vTextureCoord.x, (uShapeFilterArea.w - cod.y) / inputSize.y);
		vec4 outputColor = texture2D(uSampler, cord);
		outputColor *= alpha;
		gl_FragColor = outputColor;
	}
}
`},function(Re,C,S){(function(it){var j;/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){var dt=function(){this.init()};dt.prototype={init:function(){var I=this||ot;return I._counter=1e3,I._html5AudioPool=[],I.html5PoolSize=10,I._codecs={},I._howls=[],I._muted=!1,I._volume=1,I._canPlayEvent="canplaythrough",I._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,I.masterGain=null,I.noAudio=!1,I.usingWebAudio=!0,I.autoSuspend=!0,I.ctx=null,I.autoUnlock=!0,I._setup(),I},volume:function(I){var B=this||ot;if(I=parseFloat(I),B.ctx||kt(),I!==void 0&&I>=0&&I<=1){if(B._volume=I,B._muted)return B;B.usingWebAudio&&B.masterGain.gain.setValueAtTime(I,ot.ctx.currentTime);for(var V=0;V<B._howls.length;V++)if(!B._howls[V]._webAudio)for(var ut=B._howls[V]._getSoundIds(),F=0;F<ut.length;F++){var Y=B._howls[V]._soundById(ut[F]);Y&&Y._node&&(Y._node.volume=Y._volume*I)}return B}return B._volume},mute:function(I){var B=this||ot;B.ctx||kt(),B._muted=I,B.usingWebAudio&&B.masterGain.gain.setValueAtTime(I?0:B._volume,ot.ctx.currentTime);for(var V=0;V<B._howls.length;V++)if(!B._howls[V]._webAudio)for(var ut=B._howls[V]._getSoundIds(),F=0;F<ut.length;F++){var Y=B._howls[V]._soundById(ut[F]);Y&&Y._node&&(Y._node.muted=!!I||Y._muted)}return B},stop:function(){for(var I=this||ot,B=0;B<I._howls.length;B++)I._howls[B].stop();return I},unload:function(){for(var I=this||ot,B=I._howls.length-1;B>=0;B--)I._howls[B].unload();return I.usingWebAudio&&I.ctx&&I.ctx.close!==void 0&&(I.ctx.close(),I.ctx=null,kt()),I},codecs:function(I){return(this||ot)._codecs[I.replace(/^x-/,"")]},_setup:function(){var I=this||ot;if(I.state=I.ctx&&I.ctx.state||"suspended",I._autoSuspend(),!I.usingWebAudio)if(typeof Audio!="undefined")try{new Audio().oncanplaythrough===void 0&&(I._canPlayEvent="canplay")}catch{I.noAudio=!0}else I.noAudio=!0;try{new Audio().muted&&(I.noAudio=!0)}catch{}return I.noAudio||I._setupCodecs(),I},_setupCodecs:function(){var I=this||ot,B=null;try{B=typeof Audio!="undefined"?new Audio:null}catch{return I}if(!B||typeof B.canPlayType!="function")return I;var V=B.canPlayType("audio/mpeg;").replace(/^no$/,""),ut=I._navigator?I._navigator.userAgent:"",F=ut.match(/OPR\/([0-6].)/g),Y=F&&parseInt(F[0].split("/")[1],10)<33,$=ut.indexOf("Safari")!==-1&&ut.indexOf("Chrome")===-1,ct=ut.match(/Version\/(.*?) /),se=$&&ct&&parseInt(ct[1],10)<15;return I._codecs={mp3:!(Y||!V&&!B.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!V,opus:!!B.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!B.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!B.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(B.canPlayType('audio/wav; codecs="1"')||B.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!B.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!B.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(B.canPlayType("audio/x-m4a;")||B.canPlayType("audio/m4a;")||B.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(B.canPlayType("audio/x-m4b;")||B.canPlayType("audio/m4b;")||B.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(B.canPlayType("audio/x-mp4;")||B.canPlayType("audio/mp4;")||B.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(se||!B.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(se||!B.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!B.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(B.canPlayType("audio/x-flac;")||B.canPlayType("audio/flac;")).replace(/^no$/,"")},I},_unlockAudio:function(){var I=this||ot;if(!I._audioUnlocked&&I.ctx){I._audioUnlocked=!1,I.autoUnlock=!1,I._mobileUnloaded||I.ctx.sampleRate===44100||(I._mobileUnloaded=!0,I.unload()),I._scratchBuffer=I.ctx.createBuffer(1,1,22050);var B=function(V){for(;I._html5AudioPool.length<I.html5PoolSize;)try{var ut=new Audio;ut._unlocked=!0,I._releaseHtml5Audio(ut)}catch{I.noAudio=!0;break}for(var F=0;F<I._howls.length;F++)if(!I._howls[F]._webAudio)for(var Y=I._howls[F]._getSoundIds(),$=0;$<Y.length;$++){var ct=I._howls[F]._soundById(Y[$]);ct&&ct._node&&!ct._node._unlocked&&(ct._node._unlocked=!0,ct._node.load())}I._autoResume();var se=I.ctx.createBufferSource();se.buffer=I._scratchBuffer,se.connect(I.ctx.destination),se.start===void 0?se.noteOn(0):se.start(0),typeof I.ctx.resume=="function"&&I.ctx.resume(),se.onended=function(){se.disconnect(0),I._audioUnlocked=!0,document.removeEventListener("touchstart",B,!0),document.removeEventListener("touchend",B,!0),document.removeEventListener("click",B,!0),document.removeEventListener("keydown",B,!0);for(var Le=0;Le<I._howls.length;Le++)I._howls[Le]._emit("unlock")}};return document.addEventListener("touchstart",B,!0),document.addEventListener("touchend",B,!0),document.addEventListener("click",B,!0),document.addEventListener("keydown",B,!0),I}},_obtainHtml5Audio:function(){var I=this||ot;if(I._html5AudioPool.length)return I._html5AudioPool.pop();var B=new Audio().play();return B&&typeof Promise!="undefined"&&(B instanceof Promise||typeof B.then=="function")&&B.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(I){var B=this||ot;return I._unlocked&&B._html5AudioPool.push(I),B},_autoSuspend:function(){var I=this;if(I.autoSuspend&&I.ctx&&I.ctx.suspend!==void 0&&ot.usingWebAudio){for(var B=0;B<I._howls.length;B++)if(I._howls[B]._webAudio){for(var V=0;V<I._howls[B]._sounds.length;V++)if(!I._howls[B]._sounds[V]._paused)return I}return I._suspendTimer&&clearTimeout(I._suspendTimer),I._suspendTimer=setTimeout(function(){if(I.autoSuspend){I._suspendTimer=null,I.state="suspending";var ut=function(){I.state="suspended",I._resumeAfterSuspend&&(delete I._resumeAfterSuspend,I._autoResume())};I.ctx.suspend().then(ut,ut)}},3e4),I}},_autoResume:function(){var I=this;if(I.ctx&&I.ctx.resume!==void 0&&ot.usingWebAudio)return I.state==="running"&&I.ctx.state!=="interrupted"&&I._suspendTimer?(clearTimeout(I._suspendTimer),I._suspendTimer=null):I.state==="suspended"||I.state==="running"&&I.ctx.state==="interrupted"?(I.ctx.resume().then(function(){I.state="running";for(var B=0;B<I._howls.length;B++)I._howls[B]._emit("resume")}),I._suspendTimer&&(clearTimeout(I._suspendTimer),I._suspendTimer=null)):I.state==="suspending"&&(I._resumeAfterSuspend=!0),I}};var ot=new dt,X=function(I){I.src&&I.src.length!==0?this.init(I):console.error("An array of source files must be passed with any new Howl.")};X.prototype={init:function(I){var B=this;return ot.ctx||kt(),B._autoplay=I.autoplay||!1,B._format=typeof I.format!="string"?I.format:[I.format],B._html5=I.html5||!1,B._muted=I.mute||!1,B._loop=I.loop||!1,B._pool=I.pool||5,B._preload=typeof I.preload!="boolean"&&I.preload!=="metadata"||I.preload,B._rate=I.rate||1,B._sprite=I.sprite||{},B._src=typeof I.src!="string"?I.src:[I.src],B._volume=I.volume!==void 0?I.volume:1,B._xhr={method:I.xhr&&I.xhr.method?I.xhr.method:"GET",headers:I.xhr&&I.xhr.headers?I.xhr.headers:null,withCredentials:!(!I.xhr||!I.xhr.withCredentials)&&I.xhr.withCredentials},B._duration=0,B._state="unloaded",B._sounds=[],B._endTimers={},B._queue=[],B._playLock=!1,B._onend=I.onend?[{fn:I.onend}]:[],B._onfade=I.onfade?[{fn:I.onfade}]:[],B._onload=I.onload?[{fn:I.onload}]:[],B._onloaderror=I.onloaderror?[{fn:I.onloaderror}]:[],B._onplayerror=I.onplayerror?[{fn:I.onplayerror}]:[],B._onpause=I.onpause?[{fn:I.onpause}]:[],B._onplay=I.onplay?[{fn:I.onplay}]:[],B._onstop=I.onstop?[{fn:I.onstop}]:[],B._onmute=I.onmute?[{fn:I.onmute}]:[],B._onvolume=I.onvolume?[{fn:I.onvolume}]:[],B._onrate=I.onrate?[{fn:I.onrate}]:[],B._onseek=I.onseek?[{fn:I.onseek}]:[],B._onunlock=I.onunlock?[{fn:I.onunlock}]:[],B._onresume=[],B._webAudio=ot.usingWebAudio&&!B._html5,ot.ctx!==void 0&&ot.ctx&&ot.autoUnlock&&ot._unlockAudio(),ot._howls.push(B),B._autoplay&&B._queue.push({event:"play",action:function(){B.play()}}),B._preload&&B._preload!=="none"&&B.load(),B},load:function(){var I=null;if(ot.noAudio)this._emit("loaderror",null,"No audio support.");else{typeof this._src=="string"&&(this._src=[this._src]);for(var B=0;B<this._src.length;B++){var V,ut;if(this._format&&this._format[B])V=this._format[B];else{if(typeof(ut=this._src[B])!="string"){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(V=/^data:audio\/([^;,]+);/i.exec(ut))||(V=/\.([^.]+)$/.exec(ut.split("?",1)[0])),V&&(V=V[1].toLowerCase())}if(V||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),V&&ot.codecs(V)){I=this._src[B];break}}if(I)return this._src=I,this._state="loading",window.location.protocol==="https:"&&I.slice(0,5)==="http:"&&(this._html5=!0,this._webAudio=!1),new ft(this),this._webAudio&&J(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(I,B){var V=this,ut=null;if(typeof I=="number")ut=I,I=null;else{if(typeof I=="string"&&V._state==="loaded"&&!V._sprite[I])return null;if(I===void 0&&(I="__default",!V._playLock)){for(var F=0,Y=0;Y<V._sounds.length;Y++)V._sounds[Y]._paused&&!V._sounds[Y]._ended&&(F++,ut=V._sounds[Y]._id);F===1?I=null:ut=null}}var $=ut?V._soundById(ut):V._inactiveSound();if(!$)return null;if(ut&&!I&&(I=$._sprite||"__default"),V._state!=="loaded"){$._sprite=I,$._ended=!1;var ct=$._id;return V._queue.push({event:"play",action:function(){V.play(ct)}}),ct}if(ut&&!$._paused)return B||V._loadQueue("play"),$._id;V._webAudio&&ot._autoResume();var se=Math.max(0,$._seek>0?$._seek:V._sprite[I][0]/1e3),Le=Math.max(0,(V._sprite[I][0]+V._sprite[I][1])/1e3-se),ee=1e3*Le/Math.abs($._rate),xt=V._sprite[I][0]/1e3,Zt=(V._sprite[I][0]+V._sprite[I][1])/1e3;$._sprite=I,$._ended=!1;var $t=function(){$._paused=!1,$._seek=se,$._start=xt,$._stop=Zt,$._loop=!(!$._loop&&!V._sprite[I][2])};if(!(se>=Zt)){var Q=$._node;if(V._webAudio){var Bt=function(){V._playLock=!1,$t(),V._refreshBuffer($);var oe=$._muted||V._muted?0:$._volume;Q.gain.setValueAtTime(oe,ot.ctx.currentTime),$._playStart=ot.ctx.currentTime,Q.bufferSource.start===void 0?$._loop?Q.bufferSource.noteGrainOn(0,se,86400):Q.bufferSource.noteGrainOn(0,se,Le):$._loop?Q.bufferSource.start(0,se,86400):Q.bufferSource.start(0,se,Le),ee!==1/0&&(V._endTimers[$._id]=setTimeout(V._ended.bind(V,$),ee)),B||setTimeout(function(){V._emit("play",$._id),V._loadQueue()},0)};ot.state==="running"&&ot.ctx.state!=="interrupted"?Bt():(V._playLock=!0,V.once("resume",Bt),V._clearTimer($._id))}else{var Wt=function(){Q.currentTime=se,Q.muted=$._muted||V._muted||ot._muted||Q.muted,Q.volume=$._volume*ot.volume(),Q.playbackRate=$._rate;try{var oe=Q.play();if(oe&&typeof Promise!="undefined"&&(oe instanceof Promise||typeof oe.then=="function")?(V._playLock=!0,$t(),oe.then(function(){V._playLock=!1,Q._unlocked=!0,B?V._loadQueue():V._emit("play",$._id)}).catch(function(){V._playLock=!1,V._emit("playerror",$._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),$._ended=!0,$._paused=!0})):B||(V._playLock=!1,$t(),V._emit("play",$._id)),Q.playbackRate=$._rate,Q.paused)return void V._emit("playerror",$._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");I!=="__default"||$._loop?V._endTimers[$._id]=setTimeout(V._ended.bind(V,$),ee):(V._endTimers[$._id]=function(){V._ended($),Q.removeEventListener("ended",V._endTimers[$._id],!1)},Q.addEventListener("ended",V._endTimers[$._id],!1))}catch(de){V._emit("playerror",$._id,de)}};Q.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(Q.src=V._src,Q.load());var Kt=window&&window.ejecta||!Q.readyState&&ot._navigator.isCocoonJS;if(Q.readyState>=3||Kt)Wt();else{V._playLock=!0,V._state="loading";var Xt=function(){V._state="loaded",Wt(),Q.removeEventListener(ot._canPlayEvent,Xt,!1)};Q.addEventListener(ot._canPlayEvent,Xt,!1),V._clearTimer($._id)}}return $._id}V._ended($)},pause:function(I){var B=this;if(B._state!=="loaded"||B._playLock)return B._queue.push({event:"pause",action:function(){B.pause(I)}}),B;for(var V=B._getSoundIds(I),ut=0;ut<V.length;ut++){B._clearTimer(V[ut]);var F=B._soundById(V[ut]);if(F&&!F._paused&&(F._seek=B.seek(V[ut]),F._rateSeek=0,F._paused=!0,B._stopFade(V[ut]),F._node))if(B._webAudio){if(!F._node.bufferSource)continue;F._node.bufferSource.stop===void 0?F._node.bufferSource.noteOff(0):F._node.bufferSource.stop(0),B._cleanBuffer(F._node)}else isNaN(F._node.duration)&&F._node.duration!==1/0||F._node.pause();arguments[1]||B._emit("pause",F?F._id:null)}return B},stop:function(I,B){var V=this;if(V._state!=="loaded"||V._playLock)return V._queue.push({event:"stop",action:function(){V.stop(I)}}),V;for(var ut=V._getSoundIds(I),F=0;F<ut.length;F++){V._clearTimer(ut[F]);var Y=V._soundById(ut[F]);Y&&(Y._seek=Y._start||0,Y._rateSeek=0,Y._paused=!0,Y._ended=!0,V._stopFade(ut[F]),Y._node&&(V._webAudio?Y._node.bufferSource&&(Y._node.bufferSource.stop===void 0?Y._node.bufferSource.noteOff(0):Y._node.bufferSource.stop(0),V._cleanBuffer(Y._node)):isNaN(Y._node.duration)&&Y._node.duration!==1/0||(Y._node.currentTime=Y._start||0,Y._node.pause(),Y._node.duration===1/0&&V._clearSound(Y._node))),B||V._emit("stop",Y._id))}return V},mute:function(I,B){var V=this;if(V._state!=="loaded"||V._playLock)return V._queue.push({event:"mute",action:function(){V.mute(I,B)}}),V;if(B===void 0){if(typeof I!="boolean")return V._muted;V._muted=I}for(var ut=V._getSoundIds(B),F=0;F<ut.length;F++){var Y=V._soundById(ut[F]);Y&&(Y._muted=I,Y._interval&&V._stopFade(Y._id),V._webAudio&&Y._node?Y._node.gain.setValueAtTime(I?0:Y._volume,ot.ctx.currentTime):Y._node&&(Y._node.muted=!!ot._muted||I),V._emit("mute",Y._id))}return V},volume:function(){var I,B,V,ut=this,F=arguments;if(F.length===0)return ut._volume;if(F.length===1||F.length===2&&F[1]===void 0){var Y=ut._getSoundIds(),$=Y.indexOf(F[0]);$>=0?B=parseInt(F[0],10):I=parseFloat(F[0])}else F.length>=2&&(I=parseFloat(F[0]),B=parseInt(F[1],10));if(!(I!==void 0&&I>=0&&I<=1))return(V=B?ut._soundById(B):ut._sounds[0])?V._volume:0;if(ut._state!=="loaded"||ut._playLock)return ut._queue.push({event:"volume",action:function(){ut.volume.apply(ut,F)}}),ut;B===void 0&&(ut._volume=I),B=ut._getSoundIds(B);for(var ct=0;ct<B.length;ct++)(V=ut._soundById(B[ct]))&&(V._volume=I,F[2]||ut._stopFade(B[ct]),ut._webAudio&&V._node&&!V._muted?V._node.gain.setValueAtTime(I,ot.ctx.currentTime):V._node&&!V._muted&&(V._node.volume=I*ot.volume()),ut._emit("volume",V._id));return ut},fade:function(I,B,V,ut){var F=this;if(F._state!=="loaded"||F._playLock)return F._queue.push({event:"fade",action:function(){F.fade(I,B,V,ut)}}),F;I=Math.min(Math.max(0,parseFloat(I)),1),B=Math.min(Math.max(0,parseFloat(B)),1),V=parseFloat(V),F.volume(I,ut);for(var Y=F._getSoundIds(ut),$=0;$<Y.length;$++){var ct=F._soundById(Y[$]);if(ct){if(ut||F._stopFade(Y[$]),F._webAudio&&!ct._muted){var se=ot.ctx.currentTime,Le=se+V/1e3;ct._volume=I,ct._node.gain.setValueAtTime(I,se),ct._node.gain.linearRampToValueAtTime(B,Le)}F._startFadeInterval(ct,I,B,V,Y[$],ut===void 0)}}return F},_startFadeInterval:function(I,B,V,ut,F,Y){var $=this,ct=B,se=V-B,Le=Math.abs(se/.01),ee=Math.max(4,Le>0?ut/Le:ut),xt=Date.now();I._fadeTo=V,I._interval=setInterval(function(){var Zt=(Date.now()-xt)/ut;xt=Date.now(),ct+=se*Zt,ct=Math.round(100*ct)/100,ct=se<0?Math.max(V,ct):Math.min(V,ct),$._webAudio?I._volume=ct:$.volume(ct,I._id,!0),Y&&($._volume=ct),(V<B&&ct<=V||V>B&&ct>=V)&&(clearInterval(I._interval),I._interval=null,I._fadeTo=null,$.volume(V,I._id),$._emit("fade",I._id))},ee)},_stopFade:function(I){var B=this._soundById(I);return B&&B._interval&&(this._webAudio&&B._node.gain.cancelScheduledValues(ot.ctx.currentTime),clearInterval(B._interval),B._interval=null,this.volume(B._fadeTo,I),B._fadeTo=null,this._emit("fade",I)),this},loop:function(){var I,B,V,ut=this,F=arguments;if(F.length===0)return ut._loop;if(F.length===1){if(typeof F[0]!="boolean")return!!(V=ut._soundById(parseInt(F[0],10)))&&V._loop;I=F[0],ut._loop=I}else F.length===2&&(I=F[0],B=parseInt(F[1],10));for(var Y=ut._getSoundIds(B),$=0;$<Y.length;$++)(V=ut._soundById(Y[$]))&&(V._loop=I,ut._webAudio&&V._node&&V._node.bufferSource&&(V._node.bufferSource.loop=I,I&&(V._node.bufferSource.loopStart=V._start||0,V._node.bufferSource.loopEnd=V._stop,ut.playing(Y[$])&&(ut.pause(Y[$],!0),ut.play(Y[$],!0)))));return ut},rate:function(){var I,B,V,ut=this,F=arguments;if(F.length===0)B=ut._sounds[0]._id;else if(F.length===1){var Y=ut._getSoundIds(),$=Y.indexOf(F[0]);$>=0?B=parseInt(F[0],10):I=parseFloat(F[0])}else F.length===2&&(I=parseFloat(F[0]),B=parseInt(F[1],10));if(typeof I!="number")return(V=ut._soundById(B))?V._rate:ut._rate;if(ut._state!=="loaded"||ut._playLock)return ut._queue.push({event:"rate",action:function(){ut.rate.apply(ut,F)}}),ut;B===void 0&&(ut._rate=I),B=ut._getSoundIds(B);for(var ct=0;ct<B.length;ct++)if(V=ut._soundById(B[ct])){ut.playing(B[ct])&&(V._rateSeek=ut.seek(B[ct]),V._playStart=ut._webAudio?ot.ctx.currentTime:V._playStart),V._rate=I,ut._webAudio&&V._node&&V._node.bufferSource?V._node.bufferSource.playbackRate.setValueAtTime(I,ot.ctx.currentTime):V._node&&(V._node.playbackRate=I);var se=ut.seek(B[ct]),Le=(ut._sprite[V._sprite][0]+ut._sprite[V._sprite][1])/1e3-se,ee=1e3*Le/Math.abs(V._rate);!ut._endTimers[B[ct]]&&V._paused||(ut._clearTimer(B[ct]),ut._endTimers[B[ct]]=setTimeout(ut._ended.bind(ut,V),ee)),ut._emit("rate",V._id)}return ut},seek:function(){var I,B,V=this,ut=arguments;if(ut.length===0)V._sounds.length&&(B=V._sounds[0]._id);else if(ut.length===1){var F=V._getSoundIds(),Y=F.indexOf(ut[0]);Y>=0?B=parseInt(ut[0],10):V._sounds.length&&(B=V._sounds[0]._id,I=parseFloat(ut[0]))}else ut.length===2&&(I=parseFloat(ut[0]),B=parseInt(ut[1],10));if(B===void 0)return 0;if(typeof I=="number"&&(V._state!=="loaded"||V._playLock))return V._queue.push({event:"seek",action:function(){V.seek.apply(V,ut)}}),V;var $=V._soundById(B);if($){if(!(typeof I=="number"&&I>=0)){if(V._webAudio){var ct=V.playing(B)?ot.ctx.currentTime-$._playStart:0,se=$._rateSeek?$._rateSeek-$._seek:0;return $._seek+(se+ct*Math.abs($._rate))}return $._node.currentTime}var Le=V.playing(B);Le&&V.pause(B,!0),$._seek=I,$._ended=!1,V._clearTimer(B),V._webAudio||!$._node||isNaN($._node.duration)||($._node.currentTime=I);var ee=function(){Le&&V.play(B,!0),V._emit("seek",B)};if(Le&&!V._webAudio){var xt=function(){V._playLock?setTimeout(xt,0):ee()};setTimeout(xt,0)}else ee()}return V},playing:function(I){if(typeof I=="number"){var B=this._soundById(I);return!!B&&!B._paused}for(var V=0;V<this._sounds.length;V++)if(!this._sounds[V]._paused)return!0;return!1},duration:function(I){var B=this._duration,V=this._soundById(I);return V&&(B=this._sprite[V._sprite][1]/1e3),B},state:function(){return this._state},unload:function(){for(var I=this,B=I._sounds,V=0;V<B.length;V++)B[V]._paused||I.stop(B[V]._id),I._webAudio||(I._clearSound(B[V]._node),B[V]._node.removeEventListener("error",B[V]._errorFn,!1),B[V]._node.removeEventListener(ot._canPlayEvent,B[V]._loadFn,!1),B[V]._node.removeEventListener("ended",B[V]._endFn,!1),ot._releaseHtml5Audio(B[V]._node)),delete B[V]._node,I._clearTimer(B[V]._id);var ut=ot._howls.indexOf(I);ut>=0&&ot._howls.splice(ut,1);var F=!0;for(V=0;V<ot._howls.length;V++)if(ot._howls[V]._src===I._src||I._src.indexOf(ot._howls[V]._src)>=0){F=!1;break}return tt&&F&&delete tt[I._src],ot.noAudio=!1,I._state="unloaded",I._sounds=[],I=null,null},on:function(I,B,V,ut){var F=this["_on"+I];return typeof B=="function"&&F.push(ut?{id:V,fn:B,once:ut}:{id:V,fn:B}),this},off:function(I,B,V){var ut=this["_on"+I],F=0;if(typeof B=="number"&&(V=B,B=null),B||V)for(F=0;F<ut.length;F++){var Y=V===ut[F].id;if(B===ut[F].fn&&Y||!B&&Y){ut.splice(F,1);break}}else if(I)this["_on"+I]=[];else{var $=Object.keys(this);for(F=0;F<$.length;F++)$[F].indexOf("_on")===0&&Array.isArray(this[$[F]])&&(this[$[F]]=[])}return this},once:function(I,B,V){return this.on(I,B,V,1),this},_emit:function(I,B,V){for(var ut=this["_on"+I],F=ut.length-1;F>=0;F--)ut[F].id&&ut[F].id!==B&&I!=="load"||(setTimeout(function(Y){Y.call(this,B,V)}.bind(this,ut[F].fn),0),ut[F].once&&this.off(I,ut[F].fn,ut[F].id));return this._loadQueue(I),this},_loadQueue:function(I){if(this._queue.length>0){var B=this._queue[0];B.event===I&&(this._queue.shift(),this._loadQueue()),I||B.action()}return this},_ended:function(I){var B=I._sprite;if(!this._webAudio&&I._node&&!I._node.paused&&!I._node.ended&&I._node.currentTime<I._stop)return setTimeout(this._ended.bind(this,I),100),this;var V=!(!I._loop&&!this._sprite[B][2]);if(this._emit("end",I._id),!this._webAudio&&V&&this.stop(I._id,!0).play(I._id),this._webAudio&&V){this._emit("play",I._id),I._seek=I._start||0,I._rateSeek=0,I._playStart=ot.ctx.currentTime;var ut=1e3*(I._stop-I._start)/Math.abs(I._rate);this._endTimers[I._id]=setTimeout(this._ended.bind(this,I),ut)}return this._webAudio&&!V&&(I._paused=!0,I._ended=!0,I._seek=I._start||0,I._rateSeek=0,this._clearTimer(I._id),this._cleanBuffer(I._node),ot._autoSuspend()),this._webAudio||V||this.stop(I._id,!0),this},_clearTimer:function(I){if(this._endTimers[I]){if(typeof this._endTimers[I]!="function")clearTimeout(this._endTimers[I]);else{var B=this._soundById(I);B&&B._node&&B._node.removeEventListener("ended",this._endTimers[I],!1)}delete this._endTimers[I]}return this},_soundById:function(I){for(var B=0;B<this._sounds.length;B++)if(I===this._sounds[B]._id)return this._sounds[B];return null},_inactiveSound:function(){this._drain();for(var I=0;I<this._sounds.length;I++)if(this._sounds[I]._ended)return this._sounds[I].reset();return new ft(this)},_drain:function(){var I=this._pool,B=0,V=0;if(!(this._sounds.length<I)){for(V=0;V<this._sounds.length;V++)this._sounds[V]._ended&&B++;for(V=this._sounds.length-1;V>=0;V--){if(B<=I)return;this._sounds[V]._ended&&(this._webAudio&&this._sounds[V]._node&&this._sounds[V]._node.disconnect(0),this._sounds.splice(V,1),B--)}}},_getSoundIds:function(I){if(I===void 0){for(var B=[],V=0;V<this._sounds.length;V++)B.push(this._sounds[V]._id);return B}return[I]},_refreshBuffer:function(I){return I._node.bufferSource=ot.ctx.createBufferSource(),I._node.bufferSource.buffer=tt[this._src],I._panner?I._node.bufferSource.connect(I._panner):I._node.bufferSource.connect(I._node),I._node.bufferSource.loop=I._loop,I._loop&&(I._node.bufferSource.loopStart=I._start||0,I._node.bufferSource.loopEnd=I._stop||0),I._node.bufferSource.playbackRate.setValueAtTime(I._rate,ot.ctx.currentTime),this},_cleanBuffer:function(I){var B=ot._navigator&&ot._navigator.vendor.indexOf("Apple")>=0;if(ot._scratchBuffer&&I.bufferSource&&(I.bufferSource.onended=null,I.bufferSource.disconnect(0),B))try{I.bufferSource.buffer=ot._scratchBuffer}catch{}return I.bufferSource=null,this},_clearSound:function(I){/MSIE |Trident\//.test(ot._navigator&&ot._navigator.userAgent)||(I.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var ft=function(I){this._parent=I,this.init()};ft.prototype={init:function(){var I=this._parent;return this._muted=I._muted,this._loop=I._loop,this._volume=I._volume,this._rate=I._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++ot._counter,I._sounds.push(this),this.create(),this},create:function(){var I=this._parent,B=ot._muted||this._muted||this._parent._muted?0:this._volume;return I._webAudio?(this._node=ot.ctx.createGain===void 0?ot.ctx.createGainNode():ot.ctx.createGain(),this._node.gain.setValueAtTime(B,ot.ctx.currentTime),this._node.paused=!0,this._node.connect(ot.masterGain)):ot.noAudio||(this._node=ot._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(ot._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=I._src,this._node.preload=I._preload===!0?"auto":I._preload,this._node.volume=B*ot.volume(),this._node.load()),this},reset:function(){var I=this._parent;return this._muted=I._muted,this._loop=I._loop,this._volume=I._volume,this._rate=I._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++ot._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var I=this._parent;I._duration=Math.ceil(10*this._node.duration)/10,Object.keys(I._sprite).length===0&&(I._sprite={__default:[0,1e3*I._duration]}),I._state!=="loaded"&&(I._state="loaded",I._emit("load"),I._loadQueue()),this._node.removeEventListener(ot._canPlayEvent,this._loadFn,!1)},_endListener:function(){var I=this._parent;I._duration===1/0&&(I._duration=Math.ceil(10*this._node.duration)/10,I._sprite.__default[1]===1/0&&(I._sprite.__default[1]=1e3*I._duration),I._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}};var tt={},J=function(I){var B=I._src;if(tt[B])return I._duration=tt[B].duration,void jt(I);if(/^data:[^;]+;base64,/.test(B)){for(var V=atob(B.split(",")[1]),ut=new Uint8Array(V.length),F=0;F<V.length;++F)ut[F]=V.charCodeAt(F);Ft(ut.buffer,I)}else{var Y=new XMLHttpRequest;Y.open(I._xhr.method,B,!0),Y.withCredentials=I._xhr.withCredentials,Y.responseType="arraybuffer",I._xhr.headers&&Object.keys(I._xhr.headers).forEach(function($){Y.setRequestHeader($,I._xhr.headers[$])}),Y.onload=function(){var $=(Y.status+"")[0];$==="0"||$==="2"||$==="3"?Ft(Y.response,I):I._emit("loaderror",null,"Failed loading audio file with status: "+Y.status+".")},Y.onerror=function(){I._webAudio&&(I._html5=!0,I._webAudio=!1,I._sounds=[],delete tt[B],I.load())},lt(Y)}},lt=function(I){try{I.send()}catch{I.onerror()}},Ft=function(I,B){var V=function(){B._emit("loaderror",null,"Decoding audio data failed.")},ut=function(F){F&&B._sounds.length>0?(tt[B._src]=F,jt(B,F)):V()};typeof Promise!="undefined"&&ot.ctx.decodeAudioData.length===1?ot.ctx.decodeAudioData(I).then(ut).catch(V):ot.ctx.decodeAudioData(I,ut,V)},jt=function(I,B){B&&!I._duration&&(I._duration=B.duration),Object.keys(I._sprite).length===0&&(I._sprite={__default:[0,1e3*I._duration]}),I._state!=="loaded"&&(I._state="loaded",I._emit("load"),I._loadQueue())},kt=function(){if(ot.usingWebAudio){try{typeof AudioContext!="undefined"?ot.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?ot.ctx=new webkitAudioContext:ot.usingWebAudio=!1}catch{ot.usingWebAudio=!1}ot.ctx||(ot.usingWebAudio=!1);var I=/iP(hone|od|ad)/.test(ot._navigator&&ot._navigator.platform),B=ot._navigator&&ot._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),V=B?parseInt(B[1],10):null;if(I&&V&&V<9){var ut=/safari/.test(ot._navigator&&ot._navigator.userAgent.toLowerCase());ot._navigator&&!ut&&(ot.usingWebAudio=!1)}ot.usingWebAudio&&(ot.masterGain=ot.ctx.createGain===void 0?ot.ctx.createGainNode():ot.ctx.createGain(),ot.masterGain.gain.setValueAtTime(ot._muted?0:ot._volume,ot.ctx.currentTime),ot.masterGain.connect(ot.ctx.destination)),ot._setup()}};(j=function(){return{Howler:ot,Howl:X}}.apply(C,[]))===void 0||(Re.exports=j),C.Howler=ot,C.Howl=X,it!==void 0?(it.HowlerGlobal=dt,it.Howler=ot,it.Howl=X,it.Sound=ft):typeof window!="undefined"&&(window.HowlerGlobal=dt,window.Howler=ot,window.Howl=X,window.Sound=ft)})(),function(){var dt;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(X){if(!this.ctx||!this.ctx.listener)return this;for(var ft=this._howls.length-1;ft>=0;ft--)this._howls[ft].stereo(X);return this},HowlerGlobal.prototype.pos=function(X,ft,tt){return this.ctx&&this.ctx.listener?(ft=typeof ft!="number"?this._pos[1]:ft,tt=typeof tt!="number"?this._pos[2]:tt,typeof X!="number"?this._pos:(this._pos=[X,ft,tt],this.ctx.listener.positionX!==void 0?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(X,ft,tt,J,lt,Ft){if(!this.ctx||!this.ctx.listener)return this;var jt=this._orientation;return ft=typeof ft!="number"?jt[1]:ft,tt=typeof tt!="number"?jt[2]:tt,J=typeof J!="number"?jt[3]:J,lt=typeof lt!="number"?jt[4]:lt,Ft=typeof Ft!="number"?jt[5]:Ft,typeof X!="number"?jt:(this._orientation=[X,ft,tt,J,lt,Ft],this.ctx.listener.forwardX!==void 0?(this.ctx.listener.forwardX.setTargetAtTime(X,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(ft,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(tt,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(J,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(lt,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(Ft,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(X,ft,tt,J,lt,Ft),this)},Howl.prototype.init=(dt=Howl.prototype.init,function(X){return this._orientation=X.orientation||[1,0,0],this._stereo=X.stereo||null,this._pos=X.pos||null,this._pannerAttr={coneInnerAngle:X.coneInnerAngle!==void 0?X.coneInnerAngle:360,coneOuterAngle:X.coneOuterAngle!==void 0?X.coneOuterAngle:360,coneOuterGain:X.coneOuterGain!==void 0?X.coneOuterGain:0,distanceModel:X.distanceModel!==void 0?X.distanceModel:"inverse",maxDistance:X.maxDistance!==void 0?X.maxDistance:1e4,panningModel:X.panningModel!==void 0?X.panningModel:"HRTF",refDistance:X.refDistance!==void 0?X.refDistance:1,rolloffFactor:X.rolloffFactor!==void 0?X.rolloffFactor:1},this._onstereo=X.onstereo?[{fn:X.onstereo}]:[],this._onpos=X.onpos?[{fn:X.onpos}]:[],this._onorientation=X.onorientation?[{fn:X.onorientation}]:[],dt.call(this,X)}),Howl.prototype.stereo=function(X,ft){var tt=this;if(!tt._webAudio)return tt;if(tt._state!=="loaded")return tt._queue.push({event:"stereo",action:function(){tt.stereo(X,ft)}}),tt;var J=Howler.ctx.createStereoPanner===void 0?"spatial":"stereo";if(ft===void 0){if(typeof X!="number")return tt._stereo;tt._stereo=X,tt._pos=[X,0,0]}for(var lt=tt._getSoundIds(ft),Ft=0;Ft<lt.length;Ft++){var jt=tt._soundById(lt[Ft]);if(jt){if(typeof X!="number")return jt._stereo;jt._stereo=X,jt._pos=[X,0,0],jt._node&&(jt._pannerAttr.panningModel="equalpower",jt._panner&&jt._panner.pan||ot(jt,J),J==="spatial"?jt._panner.positionX!==void 0?(jt._panner.positionX.setValueAtTime(X,Howler.ctx.currentTime),jt._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),jt._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):jt._panner.setPosition(X,0,0):jt._panner.pan.setValueAtTime(X,Howler.ctx.currentTime)),tt._emit("stereo",jt._id)}}return tt},Howl.prototype.pos=function(X,ft,tt,J){var lt=this;if(!lt._webAudio)return lt;if(lt._state!=="loaded")return lt._queue.push({event:"pos",action:function(){lt.pos(X,ft,tt,J)}}),lt;if(ft=typeof ft!="number"?0:ft,tt=typeof tt!="number"?-.5:tt,J===void 0){if(typeof X!="number")return lt._pos;lt._pos=[X,ft,tt]}for(var Ft=lt._getSoundIds(J),jt=0;jt<Ft.length;jt++){var kt=lt._soundById(Ft[jt]);if(kt){if(typeof X!="number")return kt._pos;kt._pos=[X,ft,tt],kt._node&&(kt._panner&&!kt._panner.pan||ot(kt,"spatial"),kt._panner.positionX!==void 0?(kt._panner.positionX.setValueAtTime(X,Howler.ctx.currentTime),kt._panner.positionY.setValueAtTime(ft,Howler.ctx.currentTime),kt._panner.positionZ.setValueAtTime(tt,Howler.ctx.currentTime)):kt._panner.setPosition(X,ft,tt)),lt._emit("pos",kt._id)}}return lt},Howl.prototype.orientation=function(X,ft,tt,J){var lt=this;if(!lt._webAudio)return lt;if(lt._state!=="loaded")return lt._queue.push({event:"orientation",action:function(){lt.orientation(X,ft,tt,J)}}),lt;if(ft=typeof ft!="number"?lt._orientation[1]:ft,tt=typeof tt!="number"?lt._orientation[2]:tt,J===void 0){if(typeof X!="number")return lt._orientation;lt._orientation=[X,ft,tt]}for(var Ft=lt._getSoundIds(J),jt=0;jt<Ft.length;jt++){var kt=lt._soundById(Ft[jt]);if(kt){if(typeof X!="number")return kt._orientation;kt._orientation=[X,ft,tt],kt._node&&(kt._panner||(kt._pos||(kt._pos=lt._pos||[0,0,-.5]),ot(kt,"spatial")),kt._panner.orientationX!==void 0?(kt._panner.orientationX.setValueAtTime(X,Howler.ctx.currentTime),kt._panner.orientationY.setValueAtTime(ft,Howler.ctx.currentTime),kt._panner.orientationZ.setValueAtTime(tt,Howler.ctx.currentTime)):kt._panner.setOrientation(X,ft,tt)),lt._emit("orientation",kt._id)}}return lt},Howl.prototype.pannerAttr=function(){var X,ft,tt,J=this,lt=arguments;if(!J._webAudio)return J;if(lt.length===0)return J._pannerAttr;if(lt.length===1){if(typeof lt[0]!="object")return(tt=J._soundById(parseInt(lt[0],10)))?tt._pannerAttr:J._pannerAttr;X=lt[0],ft===void 0&&(X.pannerAttr||(X.pannerAttr={coneInnerAngle:X.coneInnerAngle,coneOuterAngle:X.coneOuterAngle,coneOuterGain:X.coneOuterGain,distanceModel:X.distanceModel,maxDistance:X.maxDistance,refDistance:X.refDistance,rolloffFactor:X.rolloffFactor,panningModel:X.panningModel}),J._pannerAttr={coneInnerAngle:X.pannerAttr.coneInnerAngle!==void 0?X.pannerAttr.coneInnerAngle:J._coneInnerAngle,coneOuterAngle:X.pannerAttr.coneOuterAngle!==void 0?X.pannerAttr.coneOuterAngle:J._coneOuterAngle,coneOuterGain:X.pannerAttr.coneOuterGain!==void 0?X.pannerAttr.coneOuterGain:J._coneOuterGain,distanceModel:X.pannerAttr.distanceModel!==void 0?X.pannerAttr.distanceModel:J._distanceModel,maxDistance:X.pannerAttr.maxDistance!==void 0?X.pannerAttr.maxDistance:J._maxDistance,refDistance:X.pannerAttr.refDistance!==void 0?X.pannerAttr.refDistance:J._refDistance,rolloffFactor:X.pannerAttr.rolloffFactor!==void 0?X.pannerAttr.rolloffFactor:J._rolloffFactor,panningModel:X.pannerAttr.panningModel!==void 0?X.pannerAttr.panningModel:J._panningModel})}else lt.length===2&&(X=lt[0],ft=parseInt(lt[1],10));for(var Ft=J._getSoundIds(ft),jt=0;jt<Ft.length;jt++)if(tt=J._soundById(Ft[jt])){var kt=tt._pannerAttr;kt={coneInnerAngle:X.coneInnerAngle!==void 0?X.coneInnerAngle:kt.coneInnerAngle,coneOuterAngle:X.coneOuterAngle!==void 0?X.coneOuterAngle:kt.coneOuterAngle,coneOuterGain:X.coneOuterGain!==void 0?X.coneOuterGain:kt.coneOuterGain,distanceModel:X.distanceModel!==void 0?X.distanceModel:kt.distanceModel,maxDistance:X.maxDistance!==void 0?X.maxDistance:kt.maxDistance,refDistance:X.refDistance!==void 0?X.refDistance:kt.refDistance,rolloffFactor:X.rolloffFactor!==void 0?X.rolloffFactor:kt.rolloffFactor,panningModel:X.panningModel!==void 0?X.panningModel:kt.panningModel};var I=tt._panner;I?(I.coneInnerAngle=kt.coneInnerAngle,I.coneOuterAngle=kt.coneOuterAngle,I.coneOuterGain=kt.coneOuterGain,I.distanceModel=kt.distanceModel,I.maxDistance=kt.maxDistance,I.refDistance=kt.refDistance,I.rolloffFactor=kt.rolloffFactor,I.panningModel=kt.panningModel):(tt._pos||(tt._pos=J._pos||[0,0,-.5]),ot(tt,"spatial"))}return J},Sound.prototype.init=function(X){return function(){var ft=this._parent;this._orientation=ft._orientation,this._stereo=ft._stereo,this._pos=ft._pos,this._pannerAttr=ft._pannerAttr,X.call(this),this._stereo?ft.stereo(this._stereo):this._pos&&ft.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(X){return function(){var ft=this._parent;return this._orientation=ft._orientation,this._stereo=ft._stereo,this._pos=ft._pos,this._pannerAttr=ft._pannerAttr,this._stereo?ft.stereo(this._stereo):this._pos?ft.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,ft._refreshBuffer(this)),X.call(this)}}(Sound.prototype.reset);var ot=function(X,ft){(ft=ft||"spatial")==="spatial"?(X._panner=Howler.ctx.createPanner(),X._panner.coneInnerAngle=X._pannerAttr.coneInnerAngle,X._panner.coneOuterAngle=X._pannerAttr.coneOuterAngle,X._panner.coneOuterGain=X._pannerAttr.coneOuterGain,X._panner.distanceModel=X._pannerAttr.distanceModel,X._panner.maxDistance=X._pannerAttr.maxDistance,X._panner.refDistance=X._pannerAttr.refDistance,X._panner.rolloffFactor=X._pannerAttr.rolloffFactor,X._panner.panningModel=X._pannerAttr.panningModel,X._panner.positionX!==void 0?(X._panner.positionX.setValueAtTime(X._pos[0],Howler.ctx.currentTime),X._panner.positionY.setValueAtTime(X._pos[1],Howler.ctx.currentTime),X._panner.positionZ.setValueAtTime(X._pos[2],Howler.ctx.currentTime)):X._panner.setPosition(X._pos[0],X._pos[1],X._pos[2]),X._panner.orientationX!==void 0?(X._panner.orientationX.setValueAtTime(X._orientation[0],Howler.ctx.currentTime),X._panner.orientationY.setValueAtTime(X._orientation[1],Howler.ctx.currentTime),X._panner.orientationZ.setValueAtTime(X._orientation[2],Howler.ctx.currentTime)):X._panner.setOrientation(X._orientation[0],X._orientation[1],X._orientation[2])):(X._panner=Howler.ctx.createStereoPanner(),X._panner.pan.setValueAtTime(X._stereo,Howler.ctx.currentTime)),X._panner.connect(X._node),X._paused||X._parent.pause(X._id,!0).play(X._id,!0)}}()}).call(this,S(4))},function(Re,C,S){(function(it){var j=it!==void 0&&it||typeof self!="undefined"&&self||window,dt=Function.prototype.apply;function ot(X,ft){this._id=X,this._clearFn=ft}C.setTimeout=function(){return new ot(dt.call(setTimeout,j,arguments),clearTimeout)},C.setInterval=function(){return new ot(dt.call(setInterval,j,arguments),clearInterval)},C.clearTimeout=C.clearInterval=function(X){X&&X.close()},ot.prototype.unref=ot.prototype.ref=function(){},ot.prototype.close=function(){this._clearFn.call(j,this._id)},C.enroll=function(X,ft){clearTimeout(X._idleTimeoutId),X._idleTimeout=ft},C.unenroll=function(X){clearTimeout(X._idleTimeoutId),X._idleTimeout=-1},C._unrefActive=C.active=function(X){clearTimeout(X._idleTimeoutId);var ft=X._idleTimeout;ft>=0&&(X._idleTimeoutId=setTimeout(function(){X._onTimeout&&X._onTimeout()},ft))},S(23),C.setImmediate=typeof self!="undefined"&&self.setImmediate||it!==void 0&&it.setImmediate||this&&this.setImmediate,C.clearImmediate=typeof self!="undefined"&&self.clearImmediate||it!==void 0&&it.clearImmediate||this&&this.clearImmediate}).call(this,S(4))},function(Re,C,S){(function(it,j){(function(dt,ot){if(!dt.setImmediate){var X,ft,tt,J,lt,Ft=1,jt={},kt=!1,I=dt.document,B=Object.getPrototypeOf&&Object.getPrototypeOf(dt);B=B&&B.setTimeout?B:dt,{}.toString.call(dt.process)==="[object process]"?X=function(F){j.nextTick(function(){ut(F)})}:function(){if(dt.postMessage&&!dt.importScripts){var F=!0,Y=dt.onmessage;return dt.onmessage=function(){F=!1},dt.postMessage("","*"),dt.onmessage=Y,F}}()?(J="setImmediate$"+Math.random()+"$",lt=function(F){F.source===dt&&typeof F.data=="string"&&F.data.indexOf(J)===0&&ut(+F.data.slice(J.length))},dt.addEventListener?dt.addEventListener("message",lt,!1):dt.attachEvent("onmessage",lt),X=function(F){dt.postMessage(J+F,"*")}):dt.MessageChannel?((tt=new MessageChannel).port1.onmessage=function(F){ut(F.data)},X=function(F){tt.port2.postMessage(F)}):I&&"onreadystatechange"in I.createElement("script")?(ft=I.documentElement,X=function(F){var Y=I.createElement("script");Y.onreadystatechange=function(){ut(F),Y.onreadystatechange=null,ft.removeChild(Y),Y=null},ft.appendChild(Y)}):X=function(F){setTimeout(ut,0,F)},B.setImmediate=function(F){typeof F!="function"&&(F=new Function(""+F));for(var Y=new Array(arguments.length-1),$=0;$<Y.length;$++)Y[$]=arguments[$+1];var ct={callback:F,args:Y};return jt[Ft]=ct,X(Ft),Ft++},B.clearImmediate=V}function V(F){delete jt[F]}function ut(F){if(kt)setTimeout(ut,0,F);else{var Y=jt[F];if(Y){kt=!0;try{(function($){var ct=$.callback,se=$.args;switch(se.length){case 0:ct();break;case 1:ct(se[0]);break;case 2:ct(se[0],se[1]);break;case 3:ct(se[0],se[1],se[2]);break;default:ct.apply(void 0,se)}})(Y)}finally{V(F),kt=!1}}}}})(typeof self=="undefined"?it===void 0?this:it:self)}).call(this,S(4),S(24))},function(Re,C){var S,it,j=Re.exports={};function dt(){throw new Error("setTimeout has not been defined")}function ot(){throw new Error("clearTimeout has not been defined")}function X(B){if(S===setTimeout)return setTimeout(B,0);if((S===dt||!S)&&setTimeout)return S=setTimeout,setTimeout(B,0);try{return S(B,0)}catch{try{return S.call(null,B,0)}catch{return S.call(this,B,0)}}}(function(){try{S=typeof setTimeout=="function"?setTimeout:dt}catch{S=dt}try{it=typeof clearTimeout=="function"?clearTimeout:ot}catch{it=ot}})();var ft,tt=[],J=!1,lt=-1;function Ft(){J&&ft&&(J=!1,ft.length?tt=ft.concat(tt):lt=-1,tt.length&&jt())}function jt(){if(!J){var B=X(Ft);J=!0;for(var V=tt.length;V;){for(ft=tt,tt=[];++lt<V;)ft&&ft[lt].run();lt=-1,V=tt.length}ft=null,J=!1,function(ut){if(it===clearTimeout)return clearTimeout(ut);if((it===ot||!it)&&clearTimeout)return it=clearTimeout,clearTimeout(ut);try{it(ut)}catch{try{return it.call(null,ut)}catch{return it.call(this,ut)}}}(B)}}function kt(B,V){this.fun=B,this.array=V}function I(){}j.nextTick=function(B){var V=new Array(arguments.length-1);if(arguments.length>1)for(var ut=1;ut<arguments.length;ut++)V[ut-1]=arguments[ut];tt.push(new kt(B,V)),tt.length!==1||J||X(jt)},kt.prototype.run=function(){this.fun.apply(null,this.array)},j.title="browser",j.browser=!0,j.env={},j.argv=[],j.version="",j.versions={},j.on=I,j.addListener=I,j.once=I,j.off=I,j.removeListener=I,j.removeAllListeners=I,j.emit=I,j.prependListener=I,j.prependOnceListener=I,j.listeners=function(B){return[]},j.binding=function(B){throw new Error("process.binding is not supported")},j.cwd=function(){return"/"},j.chdir=function(B){throw new Error("process.chdir is not supported")},j.umask=function(){return 0}},function(Re,C,S){(function(it,j){var dt;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(ot){C&&C.nodeType,it&&it.nodeType;var X=typeof j=="object"&&j;X.global!==X&&X.window!==X&&X.self;var ft,tt=2147483647,J=/^xn--/,lt=/[^\x20-\x7E]/,Ft=/[\x2E\u3002\uFF0E\uFF61]/g,jt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},kt=Math.floor,I=String.fromCharCode;function B(ee){throw new RangeError(jt[ee])}function V(ee,xt){for(var Zt=ee.length,$t=[];Zt--;)$t[Zt]=xt(ee[Zt]);return $t}function ut(ee,xt){var Zt=ee.split("@"),$t="";return Zt.length>1&&($t=Zt[0]+"@",ee=Zt[1]),$t+V((ee=ee.replace(Ft,".")).split("."),xt).join(".")}function F(ee){for(var xt,Zt,$t=[],Q=0,Bt=ee.length;Q<Bt;)(xt=ee.charCodeAt(Q++))>=55296&&xt<=56319&&Q<Bt?(64512&(Zt=ee.charCodeAt(Q++)))==56320?$t.push(((1023&xt)<<10)+(1023&Zt)+65536):($t.push(xt),Q--):$t.push(xt);return $t}function Y(ee){return V(ee,function(xt){var Zt="";return xt>65535&&(Zt+=I((xt-=65536)>>>10&1023|55296),xt=56320|1023&xt),Zt+=I(xt)}).join("")}function $(ee,xt){return ee+22+75*(ee<26)-((xt!=0)<<5)}function ct(ee,xt,Zt){var $t=0;for(ee=Zt?kt(ee/700):ee>>1,ee+=kt(ee/xt);ee>455;$t+=36)ee=kt(ee/35);return kt($t+36*ee/(ee+38))}function se(ee){var xt,Zt,$t,Q,Bt,Wt,Kt,Xt,oe,de,$e,Ue=[],Zn=ee.length,Ke=0,Un=128,Hn=72;for((Zt=ee.lastIndexOf("-"))<0&&(Zt=0),$t=0;$t<Zt;++$t)ee.charCodeAt($t)>=128&&B("not-basic"),Ue.push(ee.charCodeAt($t));for(Q=Zt>0?Zt+1:0;Q<Zn;){for(Bt=Ke,Wt=1,Kt=36;Q>=Zn&&B("invalid-input"),((Xt=($e=ee.charCodeAt(Q++))-48<10?$e-22:$e-65<26?$e-65:$e-97<26?$e-97:36)>=36||Xt>kt((tt-Ke)/Wt))&&B("overflow"),Ke+=Xt*Wt,!(Xt<(oe=Kt<=Hn?1:Kt>=Hn+26?26:Kt-Hn));Kt+=36)Wt>kt(tt/(de=36-oe))&&B("overflow"),Wt*=de;Hn=ct(Ke-Bt,xt=Ue.length+1,Bt==0),kt(Ke/xt)>tt-Un&&B("overflow"),Un+=kt(Ke/xt),Ke%=xt,Ue.splice(Ke++,0,Un)}return Y(Ue)}function Le(ee){var xt,Zt,$t,Q,Bt,Wt,Kt,Xt,oe,de,$e,Ue,Zn,Ke,Un,Hn=[];for(Ue=(ee=F(ee)).length,xt=128,Zt=0,Bt=72,Wt=0;Wt<Ue;++Wt)($e=ee[Wt])<128&&Hn.push(I($e));for($t=Q=Hn.length,Q&&Hn.push("-");$t<Ue;){for(Kt=tt,Wt=0;Wt<Ue;++Wt)($e=ee[Wt])>=xt&&$e<Kt&&(Kt=$e);for(Kt-xt>kt((tt-Zt)/(Zn=$t+1))&&B("overflow"),Zt+=(Kt-xt)*Zn,xt=Kt,Wt=0;Wt<Ue;++Wt)if(($e=ee[Wt])<xt&&++Zt>tt&&B("overflow"),$e==xt){for(Xt=Zt,oe=36;!(Xt<(de=oe<=Bt?1:oe>=Bt+26?26:oe-Bt));oe+=36)Un=Xt-de,Ke=36-de,Hn.push(I($(de+Un%Ke,0))),Xt=kt(Un/Ke);Hn.push(I($(Xt,0))),Bt=ct(Zt,Zn,$t==Q),Zt=0,++$t}++Zt,++xt}return Hn.join("")}ft={version:"1.4.1",ucs2:{decode:F,encode:Y},decode:se,encode:Le,toASCII:function(ee){return ut(ee,function(xt){return lt.test(xt)?"xn--"+Le(xt):xt})},toUnicode:function(ee){return ut(ee,function(xt){return J.test(xt)?se(xt.slice(4).toLowerCase()):xt})}},(dt=function(){return ft}.call(C,S,C,it))===void 0||(it.exports=dt)})()}).call(this,S(11)(Re),S(4))},function(Re,C,S){Re.exports={isString:function(it){return typeof it=="string"},isObject:function(it){return typeof it=="object"&&it!==null},isNull:function(it){return it===null},isNullOrUndefined:function(it){return it==null}}},function(Re,C,S){C.decode=C.parse=S(28),C.encode=C.stringify=S(29)},function(Re,C,S){function it(dt,ot){return Object.prototype.hasOwnProperty.call(dt,ot)}Re.exports=function(dt,ot,X,ft){ot=ot||"&",X=X||"=";var tt={};if(typeof dt!="string"||dt.length===0)return tt;var J=/\+/g;dt=dt.split(ot);var lt=1e3;ft&&typeof ft.maxKeys=="number"&&(lt=ft.maxKeys);var Ft=dt.length;lt>0&&Ft>lt&&(Ft=lt);for(var jt=0;jt<Ft;++jt){var kt,I,B,V,ut=dt[jt].replace(J,"%20"),F=ut.indexOf(X);F>=0?(kt=ut.substr(0,F),I=ut.substr(F+1)):(kt=ut,I=""),B=decodeURIComponent(kt),V=decodeURIComponent(I),it(tt,B)?j(tt[B])?tt[B].push(V):tt[B]=[tt[B],V]:tt[B]=V}return tt};var j=Array.isArray||function(dt){return Object.prototype.toString.call(dt)==="[object Array]"}},function(Re,C,S){var it=function(X){switch(typeof X){case"string":return X;case"boolean":return X?"true":"false";case"number":return isFinite(X)?X:"";default:return""}};Re.exports=function(X,ft,tt,J){return ft=ft||"&",tt=tt||"=",X===null&&(X=void 0),typeof X=="object"?dt(ot(X),function(lt){var Ft=encodeURIComponent(it(lt))+tt;return j(X[lt])?dt(X[lt],function(jt){return Ft+encodeURIComponent(it(jt))}).join(ft):Ft+encodeURIComponent(it(X[lt]))}).join(ft):J?encodeURIComponent(it(J))+tt+encodeURIComponent(it(X)):""};var j=Array.isArray||function(X){return Object.prototype.toString.call(X)==="[object Array]"};function dt(X,ft){if(X.map)return X.map(ft);for(var tt=[],J=0;J<X.length;J++)tt.push(ft(X[J],J));return tt}var ot=Object.keys||function(X){var ft=[];for(var tt in X)Object.prototype.hasOwnProperty.call(X,tt)&&ft.push(tt);return ft}},function(Re,C){var S=function(){};S.prototype={fit:function(it){var j,dt,ot,X,ft=it.length,tt=ft>0?it[0].width:0,J=ft>0?it[0].height:0;for(this.root={x:0,y:0,width:tt,height:J},j=0;j<ft;j++)ot=it[j],(dt=this.findNode(this.root,ot.width,ot.height))?(X=this.splitNode(dt,ot.width,ot.height),ot.x=X.x,ot.y=X.y):(X=this.growNode(ot.width,ot.height),ot.x=X.x,ot.y=X.y)},findNode:function(it,j,dt){return it.used?this.findNode(it.right,j,dt)||this.findNode(it.down,j,dt):j<=it.width&&dt<=it.height?it:null},splitNode:function(it,j,dt){return it.used=!0,it.down={x:it.x,y:it.y+dt,width:it.width,height:it.height-dt},it.right={x:it.x+j,y:it.y,width:it.width-j,height:dt},it},growNode:function(it,j){var dt=it<=this.root.width,ot=j<=this.root.height,X=ot&&this.root.height>=this.root.width+it,ft=dt&&this.root.width>=this.root.height+j;return X?this.growRight(it,j):ft?this.growDown(it,j):ot?this.growRight(it,j):dt?this.growDown(it,j):null},growRight:function(it,j){var dt;return this.root={used:!0,x:0,y:0,width:this.root.width+it,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:it,height:this.root.height}},(dt=this.findNode(this.root,it,j))?this.splitNode(dt,it,j):null},growDown:function(it,j){var dt;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+j,down:{x:0,y:this.root.height,width:this.root.width,height:j},right:this.root},(dt=this.findNode(this.root,it,j))?this.splitNode(dt,it,j):null}},Re.exports=S},function(Re,C,S){S.r(C),S.d(C,"SLIDE_EVENTS",function(){return ya}),S.d(C,"Slide",function(){return km});var it={};S.r(it),S.d(it,"isMobile",function(){return Er}),S.d(it,"EventEmitter",function(){return We.a}),S.d(it,"earcut",function(){return Ii.a}),S.d(it,"BaseTextureCache",function(){return Eo}),S.d(it,"CanvasRenderTarget",function(){return gl}),S.d(it,"DATA_URI",function(){return yo}),S.d(it,"ProgramCache",function(){return wu}),S.d(it,"TextureCache",function(){return $r}),S.d(it,"clearTextureCache",function(){return ic}),S.d(it,"correctBlendMode",function(){return hn}),S.d(it,"createIndicesForQuads",function(){return xr}),S.d(it,"decomposeDataUri",function(){return pf}),S.d(it,"deprecation",function(){return ea}),S.d(it,"destroyTextureCache",function(){return rc}),S.d(it,"determineCrossOrigin",function(){return ko}),S.d(it,"getBufferType",function(){return gr}),S.d(it,"getResolutionOfUrl",function(){return vl}),S.d(it,"hex2rgb",function(){return Jt}),S.d(it,"hex2string",function(){return Nt}),S.d(it,"interleaveTypedArrays",function(){return vn}),S.d(it,"isPow2",function(){return yi}),S.d(it,"isWebGLSupported",function(){return ml}),S.d(it,"log2",function(){return ar}),S.d(it,"nextPow2",function(){return ir}),S.d(it,"premultiplyBlendMode",function(){return Qe}),S.d(it,"premultiplyRgba",function(){return jn}),S.d(it,"premultiplyTint",function(){return wn}),S.d(it,"premultiplyTintToRgba",function(){return Pn}),S.d(it,"removeItems",function(){return Br}),S.d(it,"rgb2hex",function(){return Ge}),S.d(it,"sayHello",function(){return Sa}),S.d(it,"sign",function(){return zr}),S.d(it,"skipHello",function(){return wa}),S.d(it,"string2hex",function(){return ge}),S.d(it,"trimCanvas",function(){return oc}),S.d(it,"uid",function(){return Ur}),S.d(it,"url",function(){return Bo});var j={};S.r(j),S.d(j,"utils",function(){return it}),S.d(j,"AccessibilityManager",function(){return El}),S.d(j,"accessibleTarget",function(){return dd}),S.d(j,"InteractionData",function(){return Go}),S.d(j,"InteractionEvent",function(){return sc}),S.d(j,"InteractionManager",function(){return Pa}),S.d(j,"InteractionTrackingData",function(){return ra}),S.d(j,"interactiveTarget",function(){return fd}),S.d(j,"Application",function(){return lu}),S.d(j,"AbstractBatchRenderer",function(){return Ou}),S.d(j,"AbstractMultiResource",function(){return Eu}),S.d(j,"AbstractRenderer",function(){return pc}),S.d(j,"ArrayResource",function(){return pd}),S.d(j,"Attribute",function(){return lc}),S.d(j,"BaseImageResource",function(){return pi}),S.d(j,"BaseRenderTexture",function(){return gd}),S.d(j,"BaseTexture",function(){return On}),S.d(j,"BatchDrawCall",function(){return Cl}),S.d(j,"BatchGeometry",function(){return mc}),S.d(j,"BatchPluginFactory",function(){return Ms}),S.d(j,"BatchRenderer",function(){return As}),S.d(j,"BatchShaderGenerator",function(){return yh}),S.d(j,"BatchSystem",function(){return Ji}),S.d(j,"BatchTextureArray",function(){return uu}),S.d(j,"Buffer",function(){return Gi}),S.d(j,"BufferResource",function(){return hi}),S.d(j,"CanvasResource",function(){return Mu}),S.d(j,"ContextSystem",function(){return cc}),S.d(j,"CubeResource",function(){return md}),S.d(j,"Filter",function(){return zi}),S.d(j,"FilterState",function(){return jo}),S.d(j,"FilterSystem",function(){return Pu}),S.d(j,"Framebuffer",function(){return uc}),S.d(j,"FramebufferSystem",function(){return oa}),S.d(j,"GLFramebuffer",function(){return He}),S.d(j,"GLProgram",function(){return vf}),S.d(j,"GLTexture",function(){return Xo}),S.d(j,"Geometry",function(){return Ho}),S.d(j,"GeometrySystem",function(){return ii}),S.d(j,"IGLUniformData",function(){return Ts}),S.d(j,"INSTALLED",function(){return fe}),S.d(j,"ImageBitmapResource",function(){return Hr}),S.d(j,"ImageResource",function(){return Ca}),S.d(j,"MaskData",function(){return su}),S.d(j,"MaskSystem",function(){return Wo}),S.d(j,"ObjectRenderer",function(){return ci}),S.d(j,"Program",function(){return mh}),S.d(j,"ProjectionSystem",function(){return Pl}),S.d(j,"Quad",function(){return io}),S.d(j,"QuadUv",function(){return Ra}),S.d(j,"RenderTexture",function(){return Zi}),S.d(j,"RenderTexturePool",function(){return ch}),S.d(j,"RenderTextureSystem",function(){return Io}),S.d(j,"Renderer",function(){return Zr}),S.d(j,"Resource",function(){return pr}),S.d(j,"SVGResource",function(){return Ml}),S.d(j,"ScissorSystem",function(){return Vs}),S.d(j,"Shader",function(){return ua}),S.d(j,"ShaderSystem",function(){return Li}),S.d(j,"SpriteMaskFilter",function(){return gh}),S.d(j,"State",function(){return bs}),S.d(j,"StateSystem",function(){return po}),S.d(j,"StencilSystem",function(){return fo}),S.d(j,"System",function(){return Ao}),S.d(j,"Texture",function(){return Nn}),S.d(j,"TextureGCSystem",function(){return vh}),S.d(j,"TextureMatrix",function(){return Ss}),S.d(j,"TextureSystem",function(){return Ws}),S.d(j,"TextureUvs",function(){return vd}),S.d(j,"UniformGroup",function(){return zo}),S.d(j,"VideoResource",function(){return Au}),S.d(j,"ViewableBuffer",function(){return Rl}),S.d(j,"autoDetectRenderer",function(){return Es}),S.d(j,"autoDetectResource",function(){return we}),S.d(j,"checkMaxIfStatementsInShader",function(){return Co}),S.d(j,"defaultFilterVertex",function(){return Lu}),S.d(j,"defaultVertex",function(){return _h}),S.d(j,"resources",function(){return xh}),S.d(j,"systems",function(){return ca}),S.d(j,"uniformParsers",function(){return qi}),S.d(j,"Extract",function(){return bi}),S.d(j,"AppLoaderPlugin",function(){return _f}),S.d(j,"Loader",function(){return ss}),S.d(j,"LoaderResource",function(){return Vr}),S.d(j,"TextureLoader",function(){return yc}),S.d(j,"BlobResource",function(){return xc}),S.d(j,"CompressedTextureLoader",function(){return as}),S.d(j,"CompressedTextureResource",function(){return Di}),S.d(j,"DDSLoader",function(){return Na}),S.d(j,"FORMATS_TO_COMPONENTS",function(){return Vn}),S.d(j,"INTERNAL_FORMATS",function(){return Xn}),S.d(j,"INTERNAL_FORMAT_TO_BYTES_PER_PIXEL",function(){return cu}),S.d(j,"KTXLoader",function(){return Eh}),S.d(j,"TYPES_TO_BYTES_PER_COMPONENT",function(){return ls}),S.d(j,"TYPES_TO_BYTES_PER_PIXEL",function(){return Fa}),S.d(j,"ParticleContainer",function(){return Is}),S.d(j,"ParticleRenderer",function(){return yf}),S.d(j,"BasePrepare",function(){return Bd}),S.d(j,"CountLimiter",function(){return Ef}),S.d(j,"Prepare",function(){return Ih}),S.d(j,"TimeLimiter",function(){return yp}),S.d(j,"Spritesheet",function(){return Ud}),S.d(j,"SpritesheetLoader",function(){return Lh}),S.d(j,"TilingSprite",function(){return Ic}),S.d(j,"TilingSpriteRenderer",function(){return Ba}),S.d(j,"BitmapFont",function(){return Do}),S.d(j,"BitmapFontData",function(){return Ds}),S.d(j,"BitmapFontLoader",function(){return Ei}),S.d(j,"BitmapText",function(){return Ti}),S.d(j,"Ticker",function(){return ri}),S.d(j,"TickerPlugin",function(){return Aa}),S.d(j,"UPDATE_PRIORITY",function(){return no}),S.d(j,"ALPHA_MODES",function(){return vt}),S.d(j,"BLEND_MODES",function(){return Fn}),S.d(j,"BUFFER_BITS",function(){return _s}),S.d(j,"CLEAR_MODES",function(){return wt}),S.d(j,"DRAW_MODES",function(){return _i}),S.d(j,"ENV",function(){return Fr}),S.d(j,"FORMATS",function(){return ki}),S.d(j,"GC_MODES",function(){return Ct}),S.d(j,"MASK_TYPES",function(){return Ut}),S.d(j,"MIPMAP_MODES",function(){return et}),S.d(j,"MSAA_QUALITY",function(){return ne}),S.d(j,"PRECISION",function(){return St}),S.d(j,"RENDERER_TYPE",function(){return lo}),S.d(j,"SAMPLER_TYPES",function(){return G}),S.d(j,"SCALE_MODES",function(){return st}),S.d(j,"TARGETS",function(){return L}),S.d(j,"TYPES",function(){return k}),S.d(j,"WRAP_MODES",function(){return K}),S.d(j,"Bounds",function(){return Tu}),S.d(j,"Container",function(){return Wi}),S.d(j,"DisplayObject",function(){return ni}),S.d(j,"TemporaryDisplayObject",function(){return lh}),S.d(j,"FillStyle",function(){return vo}),S.d(j,"GRAPHICS_CURVES",function(){return qo}),S.d(j,"Graphics",function(){return cs}),S.d(j,"GraphicsData",function(){return Ph}),S.d(j,"GraphicsGeometry",function(){return bo}),S.d(j,"LINE_CAP",function(){return ze}),S.d(j,"LINE_JOIN",function(){return nr}),S.d(j,"LineStyle",function(){return oo}),S.d(j,"graphicsUtils",function(){return lp}),S.d(j,"Circle",function(){return na}),S.d(j,"DEG_TO_RAD",function(){return sh}),S.d(j,"Ellipse",function(){return ah}),S.d(j,"Matrix",function(){return li}),S.d(j,"ObservablePoint",function(){return Ta}),S.d(j,"PI_2",function(){return ns}),S.d(j,"Point",function(){return xi}),S.d(j,"Polygon",function(){return yl}),S.d(j,"RAD_TO_DEG",function(){return _l}),S.d(j,"Rectangle",function(){return Ln}),S.d(j,"RoundedRectangle",function(){return xl}),S.d(j,"SHAPES",function(){return fi}),S.d(j,"Transform",function(){return Sl}),S.d(j,"groupD8",function(){return Kr}),S.d(j,"Mesh",function(){return Xu}),S.d(j,"MeshBatchUvs",function(){return Gd}),S.d(j,"MeshGeometry",function(){return Ua}),S.d(j,"MeshMaterial",function(){return Oo}),S.d(j,"NineSlicePlane",function(){return Of}),S.d(j,"PlaneGeometry",function(){return ma}),S.d(j,"RopeGeometry",function(){return Xl}),S.d(j,"SimpleMesh",function(){return Jd}),S.d(j,"SimplePlane",function(){return Bc}),S.d(j,"SimpleRope",function(){return Bh}),S.d(j,"Runner",function(){return Gt}),S.d(j,"Sprite",function(){return oi}),S.d(j,"AnimatedSprite",function(){return ql}),S.d(j,"TEXT_GRADIENT",function(){return kl}),S.d(j,"Text",function(){return Pc}),S.d(j,"TextMetrics",function(){return ds}),S.d(j,"TextStyle",function(){return Vu}),S.d(j,"isMobile",function(){return Er}),S.d(j,"settings",function(){return Vt}),S.d(j,"VERSION",function(){return Uc}),S.d(j,"filters",function(){return Yl});var dt=S(7),ot=S(0),X=S.n(ot),ft=S(1),tt=S(14),J=S(15),lt=S(18),Ft=S.n(lt);/*!
 * @pixi/polyfill - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */if(self.Promise||(self.Promise=J.a),Object.assign||(Object.assign=Ft.a),Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()}),!self.performance||!self.performance.now){var jt=Date.now();self.performance||(self.performance={}),self.performance.now=function(){return Date.now()-jt}}for(var kt=Date.now(),I=["ms","moz","webkit","o"],B=0;B<I.length&&!self.requestAnimationFrame;++B){var V=I[B];self.requestAnimationFrame=self[V+"RequestAnimationFrame"],self.cancelAnimationFrame=self[V+"CancelAnimationFrame"]||self[V+"CancelRequestAnimationFrame"]}self.requestAnimationFrame||(self.requestAnimationFrame=function(o){if(typeof o!="function")throw new TypeError(o+"is not a function");var n=Date.now(),e=16+kt-n;return e<0&&(e=0),kt=n,self.setTimeout(function(){kt=Date.now(),o(performance.now())},e)}),self.cancelAnimationFrame||(self.cancelAnimationFrame=function(o){return clearTimeout(o)}),Math.sign||(Math.sign=function(o){return(o=Number(o))===0||isNaN(o)?o:o>0?1:-1}),Number.isInteger||(Number.isInteger=function(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o}),self.ArrayBuffer||(self.ArrayBuffer=Array),self.Float32Array||(self.Float32Array=Array),self.Uint32Array||(self.Uint32Array=Array),self.Uint16Array||(self.Uint16Array=Array),self.Uint8Array||(self.Uint8Array=Array),self.Int32Array||(self.Int32Array=Array);var ut=/iPhone/i,F=/iPod/i,Y=/iPad/i,$=/\biOS-universal(?:.+)Mac\b/i,ct=/\bAndroid(?:.+)Mobile\b/i,se=/Android/i,Le=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ee=/Silk/i,xt=/Windows Phone/i,Zt=/\bWindows(?:.+)ARM\b/i,$t=/BlackBerry/i,Q=/BB10/i,Bt=/Opera Mini/i,Wt=/\b(CriOS|Chrome)(?:.+)Mobile/i,Kt=/Mobile(?:.+)Firefox\b/i,Xt=function(o){return o!==void 0&&o.platform==="MacIntel"&&typeof o.maxTouchPoints=="number"&&o.maxTouchPoints>1&&typeof MSStream=="undefined"};/*!
 * @pixi/settings - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var oe,de,$e,Ue,Zn,Ke,Un,Hn,er,bn,Cr,Lr,Rr,Yr,Ar,yr,Ri,Or,Er=function(o){var n={userAgent:"",platform:"",maxTouchPoints:0};o||typeof navigator=="undefined"?typeof o=="string"?n.userAgent=o:o&&o.userAgent&&(n={userAgent:o.userAgent,platform:o.platform,maxTouchPoints:o.maxTouchPoints||0}):n={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var e=n.userAgent,r=e.split("[FBAN");r[1]!==void 0&&(e=r[0]),(r=e.split("Twitter"))[1]!==void 0&&(e=r[0]);var s=function(h){return function(p){return p.test(h)}}(e),l={apple:{phone:s(ut)&&!s(xt),ipod:s(F),tablet:!s(ut)&&(s(Y)||Xt(n))&&!s(xt),universal:s($),device:(s(ut)||s(F)||s(Y)||s($)||Xt(n))&&!s(xt)},amazon:{phone:s(Le),tablet:!s(Le)&&s(ee),device:s(Le)||s(ee)},android:{phone:!s(xt)&&s(Le)||!s(xt)&&s(ct),tablet:!s(xt)&&!s(Le)&&!s(ct)&&(s(ee)||s(se)),device:!s(xt)&&(s(Le)||s(ee)||s(ct)||s(se))||s(/\bokhttp\b/i)},windows:{phone:s(xt),tablet:s(Zt),device:s(xt)||s(Zt)},other:{blackberry:s($t),blackberry10:s(Q),opera:s(Bt),firefox:s(Kt),chrome:s(Wt),device:s($t)||s(Q)||s(Bt)||s(Kt)||s(Wt)},any:!1,phone:!1,tablet:!1};return l.any=l.apple.device||l.android.device||l.windows.device||l.other.device,l.phone=l.apple.phone||l.android.phone||l.windows.phone,l.tablet=l.apple.tablet||l.android.tablet||l.windows.tablet,l}(self.navigator);(function(o){o[o.WEBGL_LEGACY=0]="WEBGL_LEGACY",o[o.WEBGL=1]="WEBGL",o[o.WEBGL2=2]="WEBGL2"})(oe||(oe={})),function(o){o[o.UNKNOWN=0]="UNKNOWN",o[o.WEBGL=1]="WEBGL",o[o.CANVAS=2]="CANVAS"}(de||(de={})),function(o){o[o.COLOR=16384]="COLOR",o[o.DEPTH=256]="DEPTH",o[o.STENCIL=1024]="STENCIL"}($e||($e={})),function(o){o[o.NORMAL=0]="NORMAL",o[o.ADD=1]="ADD",o[o.MULTIPLY=2]="MULTIPLY",o[o.SCREEN=3]="SCREEN",o[o.OVERLAY=4]="OVERLAY",o[o.DARKEN=5]="DARKEN",o[o.LIGHTEN=6]="LIGHTEN",o[o.COLOR_DODGE=7]="COLOR_DODGE",o[o.COLOR_BURN=8]="COLOR_BURN",o[o.HARD_LIGHT=9]="HARD_LIGHT",o[o.SOFT_LIGHT=10]="SOFT_LIGHT",o[o.DIFFERENCE=11]="DIFFERENCE",o[o.EXCLUSION=12]="EXCLUSION",o[o.HUE=13]="HUE",o[o.SATURATION=14]="SATURATION",o[o.COLOR=15]="COLOR",o[o.LUMINOSITY=16]="LUMINOSITY",o[o.NORMAL_NPM=17]="NORMAL_NPM",o[o.ADD_NPM=18]="ADD_NPM",o[o.SCREEN_NPM=19]="SCREEN_NPM",o[o.NONE=20]="NONE",o[o.SRC_OVER=0]="SRC_OVER",o[o.SRC_IN=21]="SRC_IN",o[o.SRC_OUT=22]="SRC_OUT",o[o.SRC_ATOP=23]="SRC_ATOP",o[o.DST_OVER=24]="DST_OVER",o[o.DST_IN=25]="DST_IN",o[o.DST_OUT=26]="DST_OUT",o[o.DST_ATOP=27]="DST_ATOP",o[o.ERASE=26]="ERASE",o[o.SUBTRACT=28]="SUBTRACT",o[o.XOR=29]="XOR"}(Ue||(Ue={})),function(o){o[o.POINTS=0]="POINTS",o[o.LINES=1]="LINES",o[o.LINE_LOOP=2]="LINE_LOOP",o[o.LINE_STRIP=3]="LINE_STRIP",o[o.TRIANGLES=4]="TRIANGLES",o[o.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",o[o.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Zn||(Zn={})),function(o){o[o.RGBA=6408]="RGBA",o[o.RGB=6407]="RGB",o[o.ALPHA=6406]="ALPHA",o[o.LUMINANCE=6409]="LUMINANCE",o[o.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",o[o.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",o[o.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Ke||(Ke={})),function(o){o[o.TEXTURE_2D=3553]="TEXTURE_2D",o[o.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",o[o.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",o[o.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",o[o.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",o[o.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",o[o.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Un||(Un={})),function(o){o[o.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",o[o.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",o[o.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",o[o.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",o[o.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",o[o.FLOAT=5126]="FLOAT",o[o.HALF_FLOAT=36193]="HALF_FLOAT"}(Hn||(Hn={})),function(o){o[o.FLOAT=0]="FLOAT",o[o.INT=1]="INT",o[o.UINT=2]="UINT"}(er||(er={})),function(o){o[o.NEAREST=0]="NEAREST",o[o.LINEAR=1]="LINEAR"}(bn||(bn={})),function(o){o[o.CLAMP=33071]="CLAMP",o[o.REPEAT=10497]="REPEAT",o[o.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Cr||(Cr={})),function(o){o[o.OFF=0]="OFF",o[o.POW2=1]="POW2",o[o.ON=2]="ON",o[o.ON_MANUAL=3]="ON_MANUAL"}(Lr||(Lr={})),function(o){o[o.NPM=0]="NPM",o[o.UNPACK=1]="UNPACK",o[o.PMA=2]="PMA",o[o.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",o[o.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",o[o.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Rr||(Rr={})),function(o){o[o.NO=0]="NO",o[o.YES=1]="YES",o[o.AUTO=2]="AUTO",o[o.BLEND=0]="BLEND",o[o.CLEAR=1]="CLEAR",o[o.BLIT=2]="BLIT"}(Yr||(Yr={})),function(o){o[o.AUTO=0]="AUTO",o[o.MANUAL=1]="MANUAL"}(Ar||(Ar={})),function(o){o.LOW="lowp",o.MEDIUM="mediump",o.HIGH="highp"}(yr||(yr={})),function(o){o[o.NONE=0]="NONE",o[o.SCISSOR=1]="SCISSOR",o[o.STENCIL=2]="STENCIL",o[o.SPRITE=3]="SPRITE"}(Ri||(Ri={})),function(o){o[o.NONE=0]="NONE",o[o.LOW=2]="LOW",o[o.MEDIUM=4]="MEDIUM",o[o.HIGH=8]="HIGH"}(Or||(Or={}));var Fr,lo,_s,Fn,_i,ki,L,k,G,st,K,et,vt,wt,Ct,St,Ut,ne,Vt={MIPMAP_TEXTURES:Lr.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(o){var n=!0;if(Er.tablet||Er.phone){var e;Er.apple.device&&(e=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(e[1],10)<11&&(n=!1),Er.android.device&&(e=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(e[1],10)<7&&(n=!1)}return n?o:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:Ar.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:Cr.CLAMP,SCALE_MODE:bn.LINEAR,PRECISION_VERTEX:yr.HIGH,PRECISION_FRAGMENT:Er.apple.device?yr.HIGH:yr.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!Er.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},fn=S(12),We=S.n(fn),sr=S(13),Ii=S.n(sr),ui=S(6);(function(o){o[o.WEBGL_LEGACY=0]="WEBGL_LEGACY",o[o.WEBGL=1]="WEBGL",o[o.WEBGL2=2]="WEBGL2"})(Fr||(Fr={})),function(o){o[o.UNKNOWN=0]="UNKNOWN",o[o.WEBGL=1]="WEBGL",o[o.CANVAS=2]="CANVAS"}(lo||(lo={})),function(o){o[o.COLOR=16384]="COLOR",o[o.DEPTH=256]="DEPTH",o[o.STENCIL=1024]="STENCIL"}(_s||(_s={})),function(o){o[o.NORMAL=0]="NORMAL",o[o.ADD=1]="ADD",o[o.MULTIPLY=2]="MULTIPLY",o[o.SCREEN=3]="SCREEN",o[o.OVERLAY=4]="OVERLAY",o[o.DARKEN=5]="DARKEN",o[o.LIGHTEN=6]="LIGHTEN",o[o.COLOR_DODGE=7]="COLOR_DODGE",o[o.COLOR_BURN=8]="COLOR_BURN",o[o.HARD_LIGHT=9]="HARD_LIGHT",o[o.SOFT_LIGHT=10]="SOFT_LIGHT",o[o.DIFFERENCE=11]="DIFFERENCE",o[o.EXCLUSION=12]="EXCLUSION",o[o.HUE=13]="HUE",o[o.SATURATION=14]="SATURATION",o[o.COLOR=15]="COLOR",o[o.LUMINOSITY=16]="LUMINOSITY",o[o.NORMAL_NPM=17]="NORMAL_NPM",o[o.ADD_NPM=18]="ADD_NPM",o[o.SCREEN_NPM=19]="SCREEN_NPM",o[o.NONE=20]="NONE",o[o.SRC_OVER=0]="SRC_OVER",o[o.SRC_IN=21]="SRC_IN",o[o.SRC_OUT=22]="SRC_OUT",o[o.SRC_ATOP=23]="SRC_ATOP",o[o.DST_OVER=24]="DST_OVER",o[o.DST_IN=25]="DST_IN",o[o.DST_OUT=26]="DST_OUT",o[o.DST_ATOP=27]="DST_ATOP",o[o.ERASE=26]="ERASE",o[o.SUBTRACT=28]="SUBTRACT",o[o.XOR=29]="XOR"}(Fn||(Fn={})),function(o){o[o.POINTS=0]="POINTS",o[o.LINES=1]="LINES",o[o.LINE_LOOP=2]="LINE_LOOP",o[o.LINE_STRIP=3]="LINE_STRIP",o[o.TRIANGLES=4]="TRIANGLES",o[o.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",o[o.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(_i||(_i={})),function(o){o[o.RGBA=6408]="RGBA",o[o.RGB=6407]="RGB",o[o.ALPHA=6406]="ALPHA",o[o.LUMINANCE=6409]="LUMINANCE",o[o.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",o[o.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",o[o.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(ki||(ki={})),function(o){o[o.TEXTURE_2D=3553]="TEXTURE_2D",o[o.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",o[o.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",o[o.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",o[o.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",o[o.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",o[o.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(L||(L={})),function(o){o[o.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",o[o.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",o[o.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",o[o.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",o[o.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",o[o.FLOAT=5126]="FLOAT",o[o.HALF_FLOAT=36193]="HALF_FLOAT"}(k||(k={})),function(o){o[o.FLOAT=0]="FLOAT",o[o.INT=1]="INT",o[o.UINT=2]="UINT"}(G||(G={})),function(o){o[o.NEAREST=0]="NEAREST",o[o.LINEAR=1]="LINEAR"}(st||(st={})),function(o){o[o.CLAMP=33071]="CLAMP",o[o.REPEAT=10497]="REPEAT",o[o.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(K||(K={})),function(o){o[o.OFF=0]="OFF",o[o.POW2=1]="POW2",o[o.ON=2]="ON",o[o.ON_MANUAL=3]="ON_MANUAL"}(et||(et={})),function(o){o[o.NPM=0]="NPM",o[o.UNPACK=1]="UNPACK",o[o.PMA=2]="PMA",o[o.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",o[o.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",o[o.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(vt||(vt={})),function(o){o[o.NO=0]="NO",o[o.YES=1]="YES",o[o.AUTO=2]="AUTO",o[o.BLEND=0]="BLEND",o[o.CLEAR=1]="CLEAR",o[o.BLIT=2]="BLIT"}(wt||(wt={})),function(o){o[o.AUTO=0]="AUTO",o[o.MANUAL=1]="MANUAL"}(Ct||(Ct={})),function(o){o.LOW="lowp",o.MEDIUM="mediump",o.HIGH="highp"}(St||(St={})),function(o){o[o.NONE=0]="NONE",o[o.SCISSOR=1]="SCISSOR",o[o.STENCIL=2]="STENCIL",o[o.SPRITE=3]="SPRITE"}(Ut||(Ut={})),function(o){o[o.NONE=0]="NONE",o[o.LOW=2]="LOW",o[o.MEDIUM=4]="MEDIUM",o[o.HIGH=8]="HIGH"}(ne||(ne={}));/*!
 * @pixi/utils - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Bo={parse:ui.parse,format:ui.format,resolve:ui.resolve};Vt.RETINA_PREFIX=/@([0-9\.]+)x/,Vt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ho,Uo=!1;function wa(){Uo=!0}function Sa(o){var n;if(!Uo){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=[`
 %c %c %c PixiJS 6.0.4 - \u2730 `+o+` \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(n=self.console).log.apply(n,e)}else self.console&&self.console.log("PixiJS 6.0.4 - "+o+" - http://www.pixijs.com/");Uo=!0}}function ml(){return ho===void 0&&(ho=function(){var o={stencil:!0,failIfMajorPerformanceCaveat:Vt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!self.WebGLRenderingContext)return!1;var n=document.createElement("canvas"),e=n.getContext("webgl",o)||n.getContext("experimental-webgl",o),r=!(!e||!e.getContextAttributes().stencil);if(e){var s=e.getExtension("WEBGL_lose_context");s&&s.loseContext()}return e=null,r}catch{return!1}}()),ho}var eu={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Jt(o,n){return n===void 0&&(n=[]),n[0]=(o>>16&255)/255,n[1]=(o>>8&255)/255,n[2]=(255&o)/255,n}function Nt(o){var n=o.toString(16);return"#"+(n="000000".substr(0,6-n.length)+n)}function ge(o){return typeof o=="string"&&(o=eu[o.toLowerCase()]||o)[0]==="#"&&(o=o.substr(1)),parseInt(o,16)}function Ge(o){return(255*o[0]<<16)+(255*o[1]<<8)+(255*o[2]|0)}var Qe=function(){for(var o=[],n=[],e=0;e<32;e++)o[e]=e,n[e]=e;o[Fn.NORMAL_NPM]=Fn.NORMAL,o[Fn.ADD_NPM]=Fn.ADD,o[Fn.SCREEN_NPM]=Fn.SCREEN,n[Fn.NORMAL]=Fn.NORMAL_NPM,n[Fn.ADD]=Fn.ADD_NPM,n[Fn.SCREEN]=Fn.SCREEN_NPM;var r=[];return r.push(n),r.push(o),r}();function hn(o,n){return Qe[n?1:0][o]}function jn(o,n,e,r){return e=e||new Float32Array(4),r||r===void 0?(e[0]=o[0]*n,e[1]=o[1]*n,e[2]=o[2]*n):(e[0]=o[0],e[1]=o[1],e[2]=o[2]),e[3]=n,e}function wn(o,n){if(n===1)return(255*n<<24)+o;if(n===0)return 0;var e=o>>16&255,r=o>>8&255,s=255&o;return(255*n<<24)+((e=e*n+.5|0)<<16)+((r=r*n+.5|0)<<8)+(s=s*n+.5|0)}function Pn(o,n,e,r){return(e=e||new Float32Array(4))[0]=(o>>16&255)/255,e[1]=(o>>8&255)/255,e[2]=(255&o)/255,(r||r===void 0)&&(e[0]*=n,e[1]*=n,e[2]*=n),e[3]=n,e}function xr(o,n){n===void 0&&(n=null);var e=6*o;if((n=n||new Uint16Array(e)).length!==e)throw new Error("Out buffer length is incorrect, got "+n.length+" and expected "+e);for(var r=0,s=0;r<e;r+=6,s+=4)n[r+0]=s+0,n[r+1]=s+1,n[r+2]=s+2,n[r+3]=s+0,n[r+4]=s+2,n[r+5]=s+3;return n}function gr(o){if(o.BYTES_PER_ELEMENT===4)return o instanceof Float32Array?"Float32Array":o instanceof Uint32Array?"Uint32Array":"Int32Array";if(o.BYTES_PER_ELEMENT===2){if(o instanceof Uint16Array)return"Uint16Array"}else if(o.BYTES_PER_ELEMENT===1&&o instanceof Uint8Array)return"Uint8Array";return null}var ln={Float32Array,Uint32Array,Int32Array,Uint8Array};function vn(o,n){for(var e=0,r=0,s={},l=0;l<o.length;l++)r+=n[l],e+=o[l].length;var h=new ArrayBuffer(4*e),p=null,x=0;for(l=0;l<o.length;l++){var b=n[l],w=o[l],R=gr(w);s[R]||(s[R]=new ln[R](h)),p=s[R];for(var H=0;H<w.length;H++)p[(H/b|0)*r+x+H%b]=w[H];x+=b}return new Float32Array(h)}function ir(o){return o+=o===0?1:0,--o,o|=o>>>1,o|=o>>>2,o|=o>>>4,o|=o>>>8,(o|=o>>>16)+1}function yi(o){return!(o&o-1||!o)}function ar(o){var n=(o>65535?1:0)<<4,e=((o>>>=n)>255?1:0)<<3;return n|=e,n|=e=((o>>>=e)>15?1:0)<<2,(n|=e=((o>>>=e)>3?1:0)<<1)|(o>>>=e)>>1}function Br(o,n,e){var r,s=o.length;if(!(n>=s||e===0)){var l=s-(e=n+e>s?s-n:e);for(r=n;r<l;++r)o[r]=o[r+e];o.length=l}}function zr(o){return o===0?0:o<0?-1:1}var jr=0;function Ur(){return++jr}var nu={};function ea(o,n,e){if(e===void 0&&(e=3),!nu[n]){var r=new Error().stack;r===void 0?console.warn("PixiJS Deprecation Warning: ",n+`
Deprecated since v`+o):(r=r.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",n+`
Deprecated since v`+o),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",n+`
Deprecated since v`+o),console.warn(r))),nu[n]=!0}}var wu={},$r=Object.create(null),Eo=Object.create(null);function rc(){var o;for(o in $r)$r[o].destroy();for(o in Eo)Eo[o].destroy()}function ic(){var o;for(o in $r)delete $r[o];for(o in Eo)delete Eo[o]}var gl=function(){function o(n,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||Vt.RESOLUTION,this.resize(n,e)}return o.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},o.prototype.resize=function(n,e){this.canvas.width=n*this.resolution,this.canvas.height=e*this.resolution},o.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(o.prototype,"width",{get:function(){return this.canvas.width},set:function(n){this.canvas.width=n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.canvas.height},set:function(n){this.canvas.height=n},enumerable:!1,configurable:!0}),o}();function oc(o){var n,e,r,s=o.width,l=o.height,h=o.getContext("2d"),p=h.getImageData(0,0,s,l).data,x=p.length,b={top:null,left:null,right:null,bottom:null},w=null;for(n=0;n<x;n+=4)p[n+3]!==0&&(e=n/4%s,r=~~(n/4/s),b.top===null&&(b.top=r),(b.left===null||e<b.left)&&(b.left=e),(b.right===null||b.right<e)&&(b.right=e+1),(b.bottom===null||b.bottom<r)&&(b.bottom=r));return b.top!==null&&(s=b.right-b.left,l=b.bottom-b.top+1,w=h.getImageData(b.left,b.top,s,l)),{height:l,width:s,data:w}}var Su,yo=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function pf(o){var n=yo.exec(o);if(n)return{mediaType:n[1]?n[1].toLowerCase():void 0,subType:n[2]?n[2].toLowerCase():void 0,charset:n[3]?n[3].toLowerCase():void 0,encoding:n[4]?n[4].toLowerCase():void 0,data:n[5]}}function ko(o,n){if(n===void 0&&(n=self.location),o.indexOf("data:")===0)return"";n=n||self.location,Su||(Su=document.createElement("a")),Su.href=o;var e=Bo.parse(Su.href),r=!e.port&&n.port===""||e.port===n.port;return e.hostname===n.hostname&&r&&e.protocol===n.protocol?"":"anonymous"}function vl(o,n){var e=Vt.RETINA_PREFIX.exec(o);return e?parseFloat(e[1]):n!==void 0?n:1}/*!
 * @pixi/math - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var fi,ns=2*Math.PI,_l=180/Math.PI,sh=Math.PI/180;(function(o){o[o.POLY=0]="POLY",o[o.RECT=1]="RECT",o[o.CIRC=2]="CIRC",o[o.ELIP=3]="ELIP",o[o.RREC=4]="RREC"})(fi||(fi={}));var Ln=function(){function o(n,e,r,s){n===void 0&&(n=0),e===void 0&&(e=0),r===void 0&&(r=0),s===void 0&&(s=0),this.x=Number(n),this.y=Number(e),this.width=Number(r),this.height=Number(s),this.type=fi.RECT}return Object.defineProperty(o.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(o,"EMPTY",{get:function(){return new o(0,0,0,0)},enumerable:!1,configurable:!0}),o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height)},o.prototype.copyFrom=function(n){return this.x=n.x,this.y=n.y,this.width=n.width,this.height=n.height,this},o.prototype.copyTo=function(n){return n.x=this.x,n.y=this.y,n.width=this.width,n.height=this.height,n},o.prototype.contains=function(n,e){return!(this.width<=0||this.height<=0)&&n>=this.x&&n<this.x+this.width&&e>=this.y&&e<this.y+this.height},o.prototype.pad=function(n,e){return n===void 0&&(n=0),e===void 0&&(e=n),this.x-=n,this.y-=e,this.width+=2*n,this.height+=2*e,this},o.prototype.fit=function(n){var e=Math.max(this.x,n.x),r=Math.min(this.x+this.width,n.x+n.width),s=Math.max(this.y,n.y),l=Math.min(this.y+this.height,n.y+n.height);return this.x=e,this.width=Math.max(r-e,0),this.y=s,this.height=Math.max(l-s,0),this},o.prototype.ceil=function(n,e){n===void 0&&(n=1),e===void 0&&(e=.001);var r=Math.ceil((this.x+this.width-e)*n)/n,s=Math.ceil((this.y+this.height-e)*n)/n;return this.x=Math.floor((this.x+e)*n)/n,this.y=Math.floor((this.y+e)*n)/n,this.width=r-this.x,this.height=s-this.y,this},o.prototype.enlarge=function(n){var e=Math.min(this.x,n.x),r=Math.max(this.x+this.width,n.x+n.width),s=Math.min(this.y,n.y),l=Math.max(this.y+this.height,n.y+n.height);return this.x=e,this.width=r-e,this.y=s,this.height=l-s,this},o.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},o}(),na=function(){function o(n,e,r){n===void 0&&(n=0),e===void 0&&(e=0),r===void 0&&(r=0),this.x=n,this.y=e,this.radius=r,this.type=fi.CIRC}return o.prototype.clone=function(){return new o(this.x,this.y,this.radius)},o.prototype.contains=function(n,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,s=this.x-n,l=this.y-e;return(s*=s)+(l*=l)<=r},o.prototype.getBounds=function(){return new Ln(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},o.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},o}(),ah=function(){function o(n,e,r,s){n===void 0&&(n=0),e===void 0&&(e=0),r===void 0&&(r=0),s===void 0&&(s=0),this.x=n,this.y=e,this.width=r,this.height=s,this.type=fi.ELIP}return o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height)},o.prototype.contains=function(n,e){if(this.width<=0||this.height<=0)return!1;var r=(n-this.x)/this.width,s=(e-this.y)/this.height;return(r*=r)+(s*=s)<=1},o.prototype.getBounds=function(){return new Ln(this.x-this.width,this.y-this.height,this.width,this.height)},o.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},o}(),yl=function(){function o(){for(var n=arguments,e=[],r=0;r<arguments.length;r++)e[r]=n[r];var s=Array.isArray(e[0])?e[0]:e;if(typeof s[0]!="number"){for(var l=[],h=0,p=s.length;h<p;h++)l.push(s[h].x,s[h].y);s=l}this.points=s,this.type=fi.POLY,this.closeStroke=!0}return o.prototype.clone=function(){var n=new o(this.points.slice());return n.closeStroke=this.closeStroke,n},o.prototype.contains=function(n,e){for(var r=!1,s=this.points.length/2,l=0,h=s-1;l<s;h=l++){var p=this.points[2*l],x=this.points[2*l+1],b=this.points[2*h],w=this.points[2*h+1];x>e!=w>e&&n<(e-x)/(w-x)*(b-p)+p&&(r=!r)}return r},o.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce(function(n,e){return n+", "+e},"")+"]"},o}(),xl=function(){function o(n,e,r,s,l){n===void 0&&(n=0),e===void 0&&(e=0),r===void 0&&(r=0),s===void 0&&(s=0),l===void 0&&(l=20),this.x=n,this.y=e,this.width=r,this.height=s,this.radius=l,this.type=fi.RREC}return o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.radius)},o.prototype.contains=function(n,e){if(this.width<=0||this.height<=0)return!1;if(n>=this.x&&n<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||n>=this.x+this.radius&&n<=this.x+this.width-this.radius)return!0;var r=n-(this.x+this.radius),s=e-(this.y+this.radius),l=this.radius*this.radius;if(r*r+s*s<=l||(r=n-(this.x+this.width-this.radius))*r+s*s<=l||r*r+(s=e-(this.y+this.height-this.radius))*s<=l||(r=n-(this.x+this.radius))*r+s*s<=l)return!0}return!1},o.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},o}(),xi=function(){function o(n,e){n===void 0&&(n=0),e===void 0&&(e=0),this.x=0,this.y=0,this.x=n,this.y=e}return o.prototype.clone=function(){return new o(this.x,this.y)},o.prototype.copyFrom=function(n){return this.set(n.x,n.y),this},o.prototype.copyTo=function(n){return n.set(this.x,this.y),n},o.prototype.equals=function(n){return n.x===this.x&&n.y===this.y},o.prototype.set=function(n,e){return n===void 0&&(n=0),e===void 0&&(e=n),this.x=n,this.y=e,this},o.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},o}(),Ta=function(){function o(n,e,r,s){r===void 0&&(r=0),s===void 0&&(s=0),this._x=r,this._y=s,this.cb=n,this.scope=e}return o.prototype.clone=function(n,e){return n===void 0&&(n=this.cb),e===void 0&&(e=this.scope),new o(n,e,this._x,this._y)},o.prototype.set=function(n,e){return n===void 0&&(n=0),e===void 0&&(e=n),this._x===n&&this._y===e||(this._x=n,this._y=e,this.cb.call(this.scope)),this},o.prototype.copyFrom=function(n){return this._x===n.x&&this._y===n.y||(this._x=n.x,this._y=n.y,this.cb.call(this.scope)),this},o.prototype.copyTo=function(n){return n.set(this._x,this._y),n},o.prototype.equals=function(n){return n.x===this._x&&n.y===this._y},o.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(o.prototype,"x",{get:function(){return this._x},set:function(n){this._x!==n&&(this._x=n,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"y",{get:function(){return this._y},set:function(n){this._y!==n&&(this._y=n,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),o}(),li=function(){function o(n,e,r,s,l,h){n===void 0&&(n=1),e===void 0&&(e=0),r===void 0&&(r=0),s===void 0&&(s=1),l===void 0&&(l=0),h===void 0&&(h=0),this.array=null,this.a=n,this.b=e,this.c=r,this.d=s,this.tx=l,this.ty=h}return o.prototype.fromArray=function(n){this.a=n[0],this.b=n[1],this.c=n[3],this.d=n[4],this.tx=n[2],this.ty=n[5]},o.prototype.set=function(n,e,r,s,l,h){return this.a=n,this.b=e,this.c=r,this.d=s,this.tx=l,this.ty=h,this},o.prototype.toArray=function(n,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return n?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},o.prototype.apply=function(n,e){e=e||new xi;var r=n.x,s=n.y;return e.x=this.a*r+this.c*s+this.tx,e.y=this.b*r+this.d*s+this.ty,e},o.prototype.applyInverse=function(n,e){e=e||new xi;var r=1/(this.a*this.d+this.c*-this.b),s=n.x,l=n.y;return e.x=this.d*r*s+-this.c*r*l+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*l+-this.b*r*s+(-this.ty*this.a+this.tx*this.b)*r,e},o.prototype.translate=function(n,e){return this.tx+=n,this.ty+=e,this},o.prototype.scale=function(n,e){return this.a*=n,this.d*=e,this.c*=n,this.b*=e,this.tx*=n,this.ty*=e,this},o.prototype.rotate=function(n){var e=Math.cos(n),r=Math.sin(n),s=this.a,l=this.c,h=this.tx;return this.a=s*e-this.b*r,this.b=s*r+this.b*e,this.c=l*e-this.d*r,this.d=l*r+this.d*e,this.tx=h*e-this.ty*r,this.ty=h*r+this.ty*e,this},o.prototype.append=function(n){var e=this.a,r=this.b,s=this.c,l=this.d;return this.a=n.a*e+n.b*s,this.b=n.a*r+n.b*l,this.c=n.c*e+n.d*s,this.d=n.c*r+n.d*l,this.tx=n.tx*e+n.ty*s+this.tx,this.ty=n.tx*r+n.ty*l+this.ty,this},o.prototype.setTransform=function(n,e,r,s,l,h,p,x,b){return this.a=Math.cos(p+b)*l,this.b=Math.sin(p+b)*l,this.c=-Math.sin(p-x)*h,this.d=Math.cos(p-x)*h,this.tx=n-(r*this.a+s*this.c),this.ty=e-(r*this.b+s*this.d),this},o.prototype.prepend=function(n){var e=this.tx;if(n.a!==1||n.b!==0||n.c!==0||n.d!==1){var r=this.a,s=this.c;this.a=r*n.a+this.b*n.c,this.b=r*n.b+this.b*n.d,this.c=s*n.a+this.d*n.c,this.d=s*n.b+this.d*n.d}return this.tx=e*n.a+this.ty*n.c+n.tx,this.ty=e*n.b+this.ty*n.d+n.ty,this},o.prototype.decompose=function(n){var e=this.a,r=this.b,s=this.c,l=this.d,h=n.pivot,p=-Math.atan2(-s,l),x=Math.atan2(r,e),b=Math.abs(p+x);return b<1e-5||Math.abs(ns-b)<1e-5?(n.rotation=x,n.skew.x=n.skew.y=0):(n.rotation=0,n.skew.x=p,n.skew.y=x),n.scale.x=Math.sqrt(e*e+r*r),n.scale.y=Math.sqrt(s*s+l*l),n.position.x=this.tx+(h.x*e+h.y*s),n.position.y=this.ty+(h.x*r+h.y*l),n},o.prototype.invert=function(){var n=this.a,e=this.b,r=this.c,s=this.d,l=this.tx,h=n*s-e*r;return this.a=s/h,this.b=-e/h,this.c=-r/h,this.d=n/h,this.tx=(r*this.ty-s*l)/h,this.ty=-(n*this.ty-e*l)/h,this},o.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},o.prototype.clone=function(){var n=new o;return n.a=this.a,n.b=this.b,n.c=this.c,n.d=this.d,n.tx=this.tx,n.ty=this.ty,n},o.prototype.copyTo=function(n){return n.a=this.a,n.b=this.b,n.c=this.c,n.d=this.d,n.tx=this.tx,n.ty=this.ty,n},o.prototype.copyFrom=function(n){return this.a=n.a,this.b=n.b,this.c=n.c,this.d=n.d,this.tx=n.tx,this.ty=n.ty,this},o.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(o,"IDENTITY",{get:function(){return new o},enumerable:!1,configurable:!0}),Object.defineProperty(o,"TEMP_MATRIX",{get:function(){return new o},enumerable:!1,configurable:!0}),o}(),rs=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ru=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ea=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ma=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],bl=[],uh=[],wl=Math.sign;(function(){for(var o=0;o<16;o++){var n=[];bl.push(n);for(var e=0;e<16;e++)for(var r=wl(rs[o]*rs[e]+Ea[o]*ru[e]),s=wl(ru[o]*rs[e]+Ma[o]*ru[e]),l=wl(rs[o]*Ea[e]+Ea[o]*Ma[e]),h=wl(ru[o]*Ea[e]+Ma[o]*Ma[e]),p=0;p<16;p++)if(rs[p]===r&&ru[p]===s&&Ea[p]===l&&Ma[p]===h){n.push(p);break}}for(o=0;o<16;o++){var x=new li;x.set(rs[o],ru[o],Ea[o],Ma[o],0,0),uh.push(x)}})();var Kr={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(o){return rs[o]},uY:function(o){return ru[o]},vX:function(o){return Ea[o]},vY:function(o){return Ma[o]},inv:function(o){return 8&o?15&o:7&-o},add:function(o,n){return bl[o][n]},sub:function(o,n){return bl[o][Kr.inv(n)]},rotate180:function(o){return 4^o},isVertical:function(o){return(3&o)==2},byDirection:function(o,n){return 2*Math.abs(o)<=Math.abs(n)?n>=0?Kr.S:Kr.N:2*Math.abs(n)<=Math.abs(o)?o>0?Kr.E:Kr.W:n>0?o>0?Kr.SE:Kr.SW:o>0?Kr.NE:Kr.NW},matrixAppendRotationInv:function(o,n,e,r){e===void 0&&(e=0),r===void 0&&(r=0);var s=uh[Kr.inv(n)];s.tx=e,s.ty=r,o.append(s)}},Sl=function(){function o(){this.worldTransform=new li,this.localTransform=new li,this.position=new Ta(this.onChange,this,0,0),this.scale=new Ta(this.onChange,this,1,1),this.pivot=new Ta(this.onChange,this,0,0),this.skew=new Ta(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return o.prototype.onChange=function(){this._localID++},o.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},o.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},o.prototype.updateLocalTransform=function(){var n=this.localTransform;this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d),this._currentLocalID=this._localID,this._parentID=-1)},o.prototype.updateTransform=function(n){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==n._worldID){var r=n.worldTransform,s=this.worldTransform;s.a=e.a*r.a+e.b*r.c,s.b=e.a*r.b+e.b*r.d,s.c=e.c*r.a+e.d*r.c,s.d=e.c*r.b+e.d*r.d,s.tx=e.tx*r.a+e.ty*r.c+r.tx,s.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=n._worldID,this._worldID++}},o.prototype.setFromMatrix=function(n){n.decompose(this),this._localID++},Object.defineProperty(o.prototype,"rotation",{get:function(){return this._rotation},set:function(n){this._rotation!==n&&(this._rotation=n,this.updateSkew())},enumerable:!1,configurable:!0}),o.IDENTITY=new o,o}();/*!
 * @pixi/display - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Vt.SORTABLE_CHILDREN=!1;var Tu=function(){function o(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return o.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},o.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},o.prototype.getRectangle=function(n){return this.minX>this.maxX||this.minY>this.maxY?Ln.EMPTY:((n=n||new Ln(0,0,1,1)).x=this.minX,n.y=this.minY,n.width=this.maxX-this.minX,n.height=this.maxY-this.minY,n)},o.prototype.addPoint=function(n){this.minX=Math.min(this.minX,n.x),this.maxX=Math.max(this.maxX,n.x),this.minY=Math.min(this.minY,n.y),this.maxY=Math.max(this.maxY,n.y)},o.prototype.addPointMatrix=function(n,e){var r=n.a,s=n.b,l=n.c,h=n.d,p=n.tx,x=n.ty,b=r*e.x+l*e.y+p,w=s*e.x+h*e.y+x;this.minX=Math.min(this.minX,b),this.maxX=Math.max(this.maxX,b),this.minY=Math.min(this.minY,w),this.maxY=Math.max(this.maxY,w)},o.prototype.addQuad=function(n){var e=this.minX,r=this.minY,s=this.maxX,l=this.maxY,h=n[0],p=n[1];e=h<e?h:e,r=p<r?p:r,s=h>s?h:s,l=p>l?p:l,e=(h=n[2])<e?h:e,r=(p=n[3])<r?p:r,s=h>s?h:s,l=p>l?p:l,e=(h=n[4])<e?h:e,r=(p=n[5])<r?p:r,s=h>s?h:s,l=p>l?p:l,e=(h=n[6])<e?h:e,r=(p=n[7])<r?p:r,s=h>s?h:s,l=p>l?p:l,this.minX=e,this.minY=r,this.maxX=s,this.maxY=l},o.prototype.addFrame=function(n,e,r,s,l){this.addFrameMatrix(n.worldTransform,e,r,s,l)},o.prototype.addFrameMatrix=function(n,e,r,s,l){var h=n.a,p=n.b,x=n.c,b=n.d,w=n.tx,R=n.ty,H=this.minX,z=this.minY,q=this.maxX,at=this.maxY,_t=h*e+x*r+w,bt=p*e+b*r+R;H=_t<H?_t:H,z=bt<z?bt:z,q=_t>q?_t:q,at=bt>at?bt:at,H=(_t=h*s+x*r+w)<H?_t:H,z=(bt=p*s+b*r+R)<z?bt:z,q=_t>q?_t:q,at=bt>at?bt:at,H=(_t=h*e+x*l+w)<H?_t:H,z=(bt=p*e+b*l+R)<z?bt:z,q=_t>q?_t:q,at=bt>at?bt:at,H=(_t=h*s+x*l+w)<H?_t:H,z=(bt=p*s+b*l+R)<z?bt:z,q=_t>q?_t:q,at=bt>at?bt:at,this.minX=H,this.minY=z,this.maxX=q,this.maxY=at},o.prototype.addVertexData=function(n,e,r){for(var s=this.minX,l=this.minY,h=this.maxX,p=this.maxY,x=e;x<r;x+=2){var b=n[x],w=n[x+1];s=b<s?b:s,l=w<l?w:l,h=b>h?b:h,p=w>p?w:p}this.minX=s,this.minY=l,this.maxX=h,this.maxY=p},o.prototype.addVertices=function(n,e,r,s){this.addVerticesMatrix(n.worldTransform,e,r,s)},o.prototype.addVerticesMatrix=function(n,e,r,s,l,h){l===void 0&&(l=0),h===void 0&&(h=l);for(var p=n.a,x=n.b,b=n.c,w=n.d,R=n.tx,H=n.ty,z=this.minX,q=this.minY,at=this.maxX,_t=this.maxY,bt=r;bt<s;bt+=2){var zt=e[bt],De=e[bt+1],an=p*zt+b*De+R,Dt=w*De+x*zt+H;z=Math.min(z,an-l),at=Math.max(at,an+l),q=Math.min(q,Dt-h),_t=Math.max(_t,Dt+h)}this.minX=z,this.minY=q,this.maxX=at,this.maxY=_t},o.prototype.addBounds=function(n){var e=this.minX,r=this.minY,s=this.maxX,l=this.maxY;this.minX=n.minX<e?n.minX:e,this.minY=n.minY<r?n.minY:r,this.maxX=n.maxX>s?n.maxX:s,this.maxY=n.maxY>l?n.maxY:l},o.prototype.addBoundsMask=function(n,e){var r=n.minX>e.minX?n.minX:e.minX,s=n.minY>e.minY?n.minY:e.minY,l=n.maxX<e.maxX?n.maxX:e.maxX,h=n.maxY<e.maxY?n.maxY:e.maxY;if(r<=l&&s<=h){var p=this.minX,x=this.minY,b=this.maxX,w=this.maxY;this.minX=r<p?r:p,this.minY=s<x?s:x,this.maxX=l>b?l:b,this.maxY=h>w?h:w}},o.prototype.addBoundsMatrix=function(n,e){this.addFrameMatrix(e,n.minX,n.minY,n.maxX,n.maxY)},o.prototype.addBoundsArea=function(n,e){var r=n.minX>e.x?n.minX:e.x,s=n.minY>e.y?n.minY:e.y,l=n.maxX<e.x+e.width?n.maxX:e.x+e.width,h=n.maxY<e.y+e.height?n.maxY:e.y+e.height;if(r<=l&&s<=h){var p=this.minX,x=this.minY,b=this.maxX,w=this.maxY;this.minX=r<p?r:p,this.minY=s<x?s:x,this.maxX=l>b?l:b,this.maxY=h>w?h:w}},o.prototype.pad=function(n,e){n===void 0&&(n=0),e===void 0&&(e=n),this.isEmpty()||(this.minX-=n,this.maxX+=n,this.minY-=e,this.maxY+=e)},o.prototype.addFramePad=function(n,e,r,s,l,h){n-=l,e-=h,r+=l,s+=h,this.minX=this.minX<n?this.minX:n,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s},o}(),Mo=function(o,n){return(Mo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Tl(o,n){function e(){this.constructor=o}Mo(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var ni=function(o){function n(){var e=o.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new Sl,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Tu,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return Tl(n,o),n.mixin=function(e){for(var r=Object.keys(e),s=0;s<r.length;++s){var l=r[s];Object.defineProperty(n.prototype,l,Object.getOwnPropertyDescriptor(e,l))}},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},n.prototype.getBounds=function(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new Ln),r=this._boundsRect),this._bounds.getRectangle(r)},n.prototype.getLocalBounds=function(e){e||(this._localBoundsRect||(this._localBoundsRect=new Ln),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Tu);var r=this.transform,s=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var l=this._bounds,h=this._boundsID;this._bounds=this._localBounds;var p=this.getBounds(!1,e);return this.parent=s,this.transform=r,this._bounds=l,this._bounds.updateID+=this._boundsID-h,p},n.prototype.toGlobal=function(e,r,s){return s===void 0&&(s=!1),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)},n.prototype.toLocal=function(e,r,s,l){return r&&(e=r.toGlobal(e,s,l)),l||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,s)},n.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},n.prototype.setTransform=function(e,r,s,l,h,p,x,b,w){return e===void 0&&(e=0),r===void 0&&(r=0),s===void 0&&(s=1),l===void 0&&(l=1),h===void 0&&(h=0),p===void 0&&(p=0),x===void 0&&(x=0),b===void 0&&(b=0),w===void 0&&(w=0),this.position.x=e,this.position.y=r,this.scale.x=s||1,this.scale.y=l||1,this.rotation=h,this.skew.x=p,this.skew.y=x,this.pivot.x=b,this.pivot.y=w,this},n.prototype.destroy=function(e){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(n.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new lh),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),n.prototype.enableTempParent=function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e},n.prototype.disableTempParent=function(e){this.parent=e},Object.defineProperty(n.prototype,"x",{get:function(){return this.position.x},set:function(e){this.transform.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.position.y},set:function(e){this.transform.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"skew",{get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"angle",{get:function(){return this.transform.rotation*_l},set:function(e){this.transform.rotation=e*sh},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mask",{get:function(){return this._mask},set:function(e){var r;this._mask&&((r=this._mask.maskObject||this._mask).renderable=!0,r.isMask=!1),this._mask=e,this._mask&&((r=this._mask.maskObject||this._mask).renderable=!1,r.isMask=!0)},enumerable:!1,configurable:!0}),n}(We.a),lh=function(o){function n(){var e=o!==null&&o.apply(this,arguments)||this;return e.sortDirty=null,e}return Tl(n,o),n}(ni);function cd(o,n){return o.zIndex===n.zIndex?o._lastSortedIndex-n._lastSortedIndex:o.zIndex-n.zIndex}ni.prototype.displayObjectUpdateTransform=ni.prototype.updateTransform;var Wi=function(o){function n(){var e=o.call(this)||this;return e.children=[],e.sortableChildren=Vt.SORTABLE_CHILDREN,e.sortDirty=!1,e}return Tl(n,o),n.prototype.onChildrenChange=function(e){},n.prototype.addChild=function(){for(var e=arguments,r=[],s=0;s<arguments.length;s++)r[s]=e[s];if(r.length>1)for(var l=0;l<r.length;l++)this.addChild(r[l]);else{var h=r[0];h.parent&&h.parent.removeChild(h),h.parent=this,this.sortDirty=!0,h.transform._parentID=-1,this.children.push(h),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",h,this,this.children.length-1),h.emit("added",this)}return r[0]},n.prototype.addChildAt=function(e,r){if(r<0||r>this.children.length)throw new Error(e+"addChildAt: The index "+r+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(r,0,e),this._boundsID++,this.onChildrenChange(r),e.emit("added",this),this.emit("childAdded",e,this,r),e},n.prototype.swapChildren=function(e,r){if(e!==r){var s=this.getChildIndex(e),l=this.getChildIndex(r);this.children[s]=r,this.children[l]=e,this.onChildrenChange(s<l?s:l)}},n.prototype.getChildIndex=function(e){var r=this.children.indexOf(e);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r},n.prototype.setChildIndex=function(e,r){if(r<0||r>=this.children.length)throw new Error("The index "+r+" supplied is out of bounds "+this.children.length);var s=this.getChildIndex(e);Br(this.children,s,1),this.children.splice(r,0,e),this.onChildrenChange(r)},n.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},n.prototype.removeChild=function(){for(var e=arguments,r=[],s=0;s<arguments.length;s++)r[s]=e[s];if(r.length>1)for(var l=0;l<r.length;l++)this.removeChild(r[l]);else{var h=r[0],p=this.children.indexOf(h);if(p===-1)return null;h.parent=null,h.transform._parentID=-1,Br(this.children,p,1),this._boundsID++,this.onChildrenChange(p),h.emit("removed",this),this.emit("childRemoved",h,this,p)}return r[0]},n.prototype.removeChildAt=function(e){var r=this.getChildAt(e);return r.parent=null,r.transform._parentID=-1,Br(this.children,e,1),this._boundsID++,this.onChildrenChange(e),r.emit("removed",this),this.emit("childRemoved",r,this,e),r},n.prototype.removeChildren=function(e,r){e===void 0&&(e=0),r===void 0&&(r=this.children.length);var s,l=e,h=r-l;if(h>0&&h<=r){s=this.children.splice(l,h);for(var p=0;p<s.length;++p)s[p].parent=null,s[p].transform&&(s[p].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(e),p=0;p<s.length;++p)s[p].emit("removed",this),this.emit("childRemoved",s[p],this,p);return s}if(h===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},n.prototype.sortChildren=function(){for(var e=!1,r=0,s=this.children.length;r<s;++r){var l=this.children[r];l._lastSortedIndex=r,e||l.zIndex===0||(e=!0)}e&&this.children.length>1&&this.children.sort(cd),this.sortDirty=!1},n.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,r=this.children.length;e<r;++e){var s=this.children[e];s.visible&&s.updateTransform()}},n.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var r=this.children[e];if(r.visible&&r.renderable)if(r.calculateBounds(),r._mask){var s=r._mask.maskObject||r._mask;s.calculateBounds(),this._bounds.addBoundsMask(r._bounds,s._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID},n.prototype.getLocalBounds=function(e,r){r===void 0&&(r=!1);var s=o.prototype.getLocalBounds.call(this,e);if(!r)for(var l=0,h=this.children.length;l<h;++l){var p=this.children[l];p.visible&&p.updateTransform()}return s},n.prototype._calculateBounds=function(){},n.prototype.render=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else{this._render(e);for(var r=0,s=this.children.length;r<s;++r)this.children[r].render(e)}},n.prototype.renderAdvanced=function(e){e.batch.flush();var r=this.filters,s=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var l=0;l<r.length;l++)r[l].enabled&&this._enabledFilters.push(r[l]);this._enabledFilters.length&&e.filter.push(this,this._enabledFilters)}s&&e.mask.push(this,this._mask),this._render(e),l=0;for(var h=this.children.length;l<h;l++)this.children[l].render(e);e.batch.flush(),s&&e.mask.pop(this),r&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},n.prototype._render=function(e){},n.prototype.destroy=function(e){o.prototype.destroy.call(this),this.sortDirty=!1;var r=typeof e=="boolean"?e:e&&e.children,s=this.removeChildren(0,this.children.length);if(r)for(var l=0;l<s.length;++l)s[l].destroy(e)},Object.defineProperty(n.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var r=this.getLocalBounds().width;this.scale.x=r!==0?e/r:1,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var r=this.getLocalBounds().height;this.scale.y=r!==0?e/r:1,this._height=e},enumerable:!1,configurable:!0}),n}(ni);Wi.prototype.containerUpdateTransform=Wi.prototype.updateTransform;/*!
 * @pixi/accessibility - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/accessibility is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var dd={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};ni.mixin(dd);var no,El=function(){function o(n){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Er.tablet||Er.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2 .toString(),this.div=e,this.renderer=n,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),self.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(o.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),o.prototype.createTouchHook=function(){var n=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2 .toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",function(){n._isMobileAccessibility=!0,n.activate(),n.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e},o.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},o.prototype.activate=function(){var n;this._isActive||(this._isActive=!0,self.document.addEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(n=this.renderer.view.parentNode)===null||n===void 0||n.appendChild(this.div))},o.prototype.deactivate=function(){var n;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(n=this.div.parentNode)===null||n===void 0||n.removeChild(this.div))},o.prototype.updateAccessibleObjects=function(n){if(n.visible&&n.accessibleChildren){n.accessible&&n.interactive&&(n._accessibleActive||this.addChild(n),n.renderId=this.renderId);for(var e=n.children,r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}},o.prototype.update=function(){var n=performance.now();if(!(Er.android.device&&n<this.androidUpdateCount)&&(this.androidUpdateCount=n+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),r=e.left,s=e.top,l=e.width,h=e.height,p=this.renderer,x=p.width,b=p.height,w=p.resolution,R=l/x*w,H=h/b*w,z=this.div;z.style.left=r+"px",z.style.top=s+"px",z.style.width=x+"px",z.style.height=b+"px";for(var q=0;q<this.children.length;q++){var at=this.children[q];if(at.renderId!==this.renderId)at._accessibleActive=!1,Br(this.children,q,1),this.div.removeChild(at._accessibleDiv),this.pool.push(at._accessibleDiv),at._accessibleDiv=null,q--;else{z=at._accessibleDiv;var _t=at.hitArea,bt=at.worldTransform;at.hitArea?(z.style.left=(bt.tx+_t.x*bt.a)*R+"px",z.style.top=(bt.ty+_t.y*bt.d)*H+"px",z.style.width=_t.width*bt.a*R+"px",z.style.height=_t.height*bt.d*H+"px"):(_t=at.getBounds(),this.capHitArea(_t),z.style.left=_t.x*R+"px",z.style.top=_t.y*H+"px",z.style.width=_t.width*R+"px",z.style.height=_t.height*H+"px",z.title!==at.accessibleTitle&&at.accessibleTitle!==null&&(z.title=at.accessibleTitle),z.getAttribute("aria-label")!==at.accessibleHint&&at.accessibleHint!==null&&z.setAttribute("aria-label",at.accessibleHint)),at.accessibleTitle===z.title&&at.tabIndex===z.tabIndex||(z.title=at.accessibleTitle,z.tabIndex=at.tabIndex,this.debug&&this.updateDebugHTML(z))}}this.renderId++}},o.prototype.updateDebugHTML=function(n){n.innerHTML="type: "+n.type+"</br> title : "+n.title+"</br> tabIndex: "+n.tabIndex},o.prototype.capHitArea=function(n){n.x<0&&(n.width+=n.x,n.x=0),n.y<0&&(n.height+=n.y,n.y=0);var e=this.renderer,r=e.width,s=e.height;n.x+n.width>r&&(n.width=r-n.x),n.y+n.height>s&&(n.height=s-n.y)},o.prototype.addChild=function(n){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2 .toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=n.accessiblePointerEvents,e.type=n.accessibleType,n.accessibleTitle&&n.accessibleTitle!==null?e.title=n.accessibleTitle:n.accessibleHint&&n.accessibleHint!==null||(e.title="displayObject "+n.tabIndex),n.accessibleHint&&n.accessibleHint!==null&&e.setAttribute("aria-label",n.accessibleHint),this.debug&&this.updateDebugHTML(e),n._accessibleActive=!0,n._accessibleDiv=e,e.displayObject=n,this.children.push(n),this.div.appendChild(n._accessibleDiv),n._accessibleDiv.tabIndex=n.tabIndex},o.prototype._onClick=function(n){var e=this.renderer.plugins.interaction,r=n.target.displayObject,s=e.eventData;e.dispatchEvent(r,"click",s),e.dispatchEvent(r,"pointertap",s),e.dispatchEvent(r,"tap",s)},o.prototype._onFocus=function(n){n.target.getAttribute("aria-live")||n.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,r=n.target.displayObject,s=e.eventData;e.dispatchEvent(r,"mouseover",s)},o.prototype._onFocusOut=function(n){n.target.getAttribute("aria-live")||n.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,r=n.target.displayObject,s=e.eventData;e.dispatchEvent(r,"mouseout",s)},o.prototype._onKeyDown=function(n){n.keyCode===9&&this.activate()},o.prototype._onMouseMove=function(n){n.movementX===0&&n.movementY===0||this.deactivate()},o.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},o}();/*!
 * @pixi/ticker - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Vt.TARGET_FPMS=.06,function(o){o[o.INTERACTION=50]="INTERACTION",o[o.HIGH=25]="HIGH",o[o.NORMAL=0]="NORMAL",o[o.LOW=-25]="LOW",o[o.UTILITY=-50]="UTILITY"}(no||(no={}));var ks=function(){function o(n,e,r,s){e===void 0&&(e=null),r===void 0&&(r=0),s===void 0&&(s=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=n,this.context=e,this.priority=r,this.once=s}return o.prototype.match=function(n,e){return e===void 0&&(e=null),this.fn===n&&this.context===e},o.prototype.emit=function(n){this.fn&&(this.context?this.fn.call(this.context,n):this.fn(n));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},o.prototype.connect=function(n){this.previous=n,n.next&&(n.next.previous=this),this.next=n.next,n.next=this},o.prototype.destroy=function(n){n===void 0&&(n=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=n?null:e,this.previous=null,e},o}(),ri=function(){function o(){var n=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ks(null,null,1/0),this.deltaMS=1/Vt.TARGET_FPMS,this.elapsedMS=1/Vt.TARGET_FPMS,this._tick=function(e){n._requestId=null,n.started&&(n.update(e),n.started&&n._requestId===null&&n._head.next&&(n._requestId=requestAnimationFrame(n._tick)))}}return o.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},o.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},o.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},o.prototype.add=function(n,e,r){return r===void 0&&(r=no.NORMAL),this._addListener(new ks(n,e,r))},o.prototype.addOnce=function(n,e,r){return r===void 0&&(r=no.NORMAL),this._addListener(new ks(n,e,r,!0))},o.prototype._addListener=function(n){var e=this._head.next,r=this._head;if(e){for(;e;){if(n.priority>e.priority){n.connect(r);break}r=e,e=e.next}n.previous||n.connect(r)}else n.connect(r);return this._startIfPossible(),this},o.prototype.remove=function(n,e){for(var r=this._head.next;r;)r=r.match(n,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(o.prototype,"count",{get:function(){if(!this._head)return 0;for(var n=0,e=this._head;e=e.next;)n++;return n},enumerable:!1,configurable:!0}),o.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},o.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},o.prototype.destroy=function(){if(!this._protected){this.stop();for(var n=this._head.next;n;)n=n.destroy(!0);this._head.destroy(),this._head=null}},o.prototype.update=function(n){var e;if(n===void 0&&(n=performance.now()),n>this.lastTime){if((e=this.elapsedMS=n-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=n-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=n-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Vt.TARGET_FPMS;for(var s=this._head,l=s.next;l;)l=l.emit(this.deltaTime);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=n},Object.defineProperty(o.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(n){var e=Math.min(this.maxFPS,n),r=Math.min(Math.max(0,e)/1e3,Vt.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(n){if(n===0)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,n);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(o,"shared",{get:function(){if(!o._shared){var n=o._shared=new o;n.autoStart=!0,n._protected=!0}return o._shared},enumerable:!1,configurable:!0}),Object.defineProperty(o,"system",{get:function(){if(!o._system){var n=o._system=new o;n.autoStart=!0,n._protected=!0}return o._system},enumerable:!1,configurable:!0}),o}(),Aa=function(){function o(){}return o.init=function(n){var e=this;n=Object.assign({autoStart:!0,sharedTicker:!1},n),Object.defineProperty(this,"ticker",{set:function(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,no.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=n.sharedTicker?ri.shared:new ri,n.autoStart&&this.start()},o.destroy=function(){if(this._ticker){var n=this._ticker;this.ticker=null,n.destroy()}},o}(),Go=function(){function o(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new xi,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(o.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),o.prototype.getLocalPosition=function(n,e,r){return n.worldTransform.applyInverse(r||this.global,e)},o.prototype.copyEvent=function(n){"isPrimary"in n&&n.isPrimary&&(this.isPrimary=!0),this.button="button"in n&&n.button;var e="buttons"in n&&n.buttons;this.buttons=Number.isInteger(e)?e:"which"in n&&n.which,this.width="width"in n&&n.width,this.height="height"in n&&n.height,this.tiltX="tiltX"in n&&n.tiltX,this.tiltY="tiltY"in n&&n.tiltY,this.pointerType="pointerType"in n&&n.pointerType,this.pressure="pressure"in n&&n.pressure,this.rotationAngle="rotationAngle"in n&&n.rotationAngle,this.twist="twist"in n&&n.twist||0,this.tangentialPressure="tangentialPressure"in n&&n.tangentialPressure||0},o.prototype.reset=function(){this.isPrimary=!1},o}(),iu=function(o,n){return(iu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},sc=function(){function o(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return o.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},o.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},o}(),ra=function(){function o(n){this._pointerId=n,this._flags=o.FLAGS.NONE}return o.prototype._doSet=function(n,e){this._flags=e?this._flags|n:this._flags&~n},Object.defineProperty(o.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"flags",{get:function(){return this._flags},set:function(n){this._flags=n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"none",{get:function(){return this._flags===o.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"over",{get:function(){return(this._flags&o.FLAGS.OVER)!=0},set:function(n){this._doSet(o.FLAGS.OVER,n)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"rightDown",{get:function(){return(this._flags&o.FLAGS.RIGHT_DOWN)!=0},set:function(n){this._doSet(o.FLAGS.RIGHT_DOWN,n)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"leftDown",{get:function(){return(this._flags&o.FLAGS.LEFT_DOWN)!=0},set:function(n){this._doSet(o.FLAGS.LEFT_DOWN,n)},enumerable:!1,configurable:!0}),o.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),o}(),Gs=function(){function o(){this._tempPoint=new xi}return o.prototype.recursiveFindHit=function(n,e,r,s,l){if(!e||!e.visible)return!1;var h=n.data.global,p=!1,x=l=e.interactive||l,b=!0;if(e.hitArea?(s&&(e.worldTransform.applyInverse(h,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?p=!0:(s=!1,b=!1)),x=!1):e._mask&&s&&(e._mask.containsPoint&&e._mask.containsPoint(h)||(s=!1)),b&&e.interactiveChildren&&e.children)for(var w=e.children,R=w.length-1;R>=0;R--){var H=w[R],z=this.recursiveFindHit(n,H,r,s,x);if(z){if(!H.parent)continue;x=!1,z&&(n.target&&(s=!1),p=!0)}}return l&&(s&&!n.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(h)&&(p=!0),e.interactive&&(p&&!n.target&&(n.target=e),r&&r(n,e,!!p))),p},o.prototype.findHit=function(n,e,r,s){this.recursiveFindHit(n,e,r,s,!1)},o}(),fd={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(o){o?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};ni.mixin(fd);var ro={target:null,data:{global:null}},Pa=function(o){function n(e,r){var s=o.call(this)||this;return r=r||{},s.renderer=e,s.autoPreventDefault=r.autoPreventDefault===void 0||r.autoPreventDefault,s.interactionFrequency=r.interactionFrequency||10,s.mouse=new Go,s.mouse.identifier=1,s.mouse.global.set(-999999),s.activeInteractionData={},s.activeInteractionData[1]=s.mouse,s.interactionDataPool=[],s.eventData=new sc,s.interactionDOMElement=null,s.moveWhenInside=!1,s.eventsAdded=!1,s.tickerAdded=!1,s.mouseOverRenderer=!("PointerEvent"in self),s.supportsTouchEvents="ontouchstart"in self,s.supportsPointerEvents=!!self.PointerEvent,s.onPointerUp=s.onPointerUp.bind(s),s.processPointerUp=s.processPointerUp.bind(s),s.onPointerCancel=s.onPointerCancel.bind(s),s.processPointerCancel=s.processPointerCancel.bind(s),s.onPointerDown=s.onPointerDown.bind(s),s.processPointerDown=s.processPointerDown.bind(s),s.onPointerMove=s.onPointerMove.bind(s),s.processPointerMove=s.processPointerMove.bind(s),s.onPointerOut=s.onPointerOut.bind(s),s.processPointerOverOut=s.processPointerOverOut.bind(s),s.onPointerOver=s.onPointerOver.bind(s),s.cursorStyles={default:"inherit",pointer:"pointer"},s.currentCursorMode=null,s.cursor=null,s.resolution=1,s.delayedEvents=[],s.search=new Gs,s._tempDisplayObject=new lh,s._useSystemTicker=r.useSystemTicker===void 0||r.useSystemTicker,s.setTargetElement(s.renderer.view,s.renderer.resolution),s}return function(e,r){function s(){this.constructor=e}iu(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),Object.defineProperty(n.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),n.prototype.hitTest=function(e,r){return ro.target=null,ro.data.global=e,r||(r=this.lastObjectRendered),this.processInteractive(ro,r,null,!0),ro.target},n.prototype.setTargetElement=function(e,r){r===void 0&&(r=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=r,this.addEvents(),this.addTickerListener()},n.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(ri.system.add(this.tickerUpdate,this,no.INTERACTION),this.tickerAdded=!0)},n.prototype.removeTickerListener=function(){this.tickerAdded&&(ri.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},n.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none"),this.supportsPointerEvents?(self.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),self.addEventListener("pointercancel",this.onPointerCancel,!0),self.addEventListener("pointerup",this.onPointerUp,!0)):(self.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),self.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},n.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(self.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),self.removeEventListener("pointercancel",this.onPointerCancel,!0),self.removeEventListener("pointerup",this.onPointerUp,!0)):(self.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),self.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},n.prototype.tickerUpdate=function(e){this._deltaTime+=e,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},n.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var r=this.activeInteractionData[e];if(r.originalEvent&&r.pointerType!=="touch"){var s=this.configureInteractionEventForDOMEvent(this.eventData,r.originalEvent,r);this.processInteractive(s,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},n.prototype.setCursorMode=function(e){e=e||"default";var r=!0;if(self.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(r=!1),this.currentCursorMode!==e){this.currentCursorMode=e;var s=this.cursorStyles[e];if(s)switch(typeof s){case"string":r&&(this.interactionDOMElement.style.cursor=s);break;case"function":s(e);break;case"object":r&&Object.assign(this.interactionDOMElement.style,s)}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},n.prototype.dispatchEvent=function(e,r,s){s.stopPropagationHint&&e!==s.stopsPropagatingAt||(s.currentTarget=e,s.type=r,e.emit(r,s),e[r]&&e[r](s))},n.prototype.delayDispatchEvent=function(e,r,s){this.delayedEvents.push({displayObject:e,eventString:r,eventData:s})},n.prototype.mapPositionToPoint=function(e,r,s){var l;l=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var h=1/this.resolution;e.x=(r-l.left)*(this.interactionDOMElement.width/l.width)*h,e.y=(s-l.top)*(this.interactionDOMElement.height/l.height)*h},n.prototype.processInteractive=function(e,r,s,l){var h=this.search.findHit(e,r,s,l),p=this.delayedEvents;if(!p.length)return h;e.stopPropagationHint=!1;var x=p.length;this.delayedEvents=[];for(var b=0;b<x;b++){var w=p[b],R=w.displayObject,H=w.eventString,z=w.eventData;z.stopsPropagatingAt===R&&(z.stopPropagationHint=!0),this.dispatchEvent(R,H,z)}return h},n.prototype.onPointerDown=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var r=this.normalizeToPointerData(e);this.autoPreventDefault&&r[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(var s=r.length,l=0;l<s;l++){var h=r[l],p=this.getInteractionDataForPointerId(h),x=this.configureInteractionEventForDOMEvent(this.eventData,h,p);if(x.data.originalEvent=e,this.processInteractive(x,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",x),h.pointerType==="touch")this.emit("touchstart",x);else if(h.pointerType==="mouse"||h.pointerType==="pen"){var b=h.button===2;this.emit(b?"rightdown":"mousedown",this.eventData)}}}},n.prototype.processPointerDown=function(e,r,s){var l=e.data,h=e.data.identifier;if(s){if(r.trackedPointers[h]||(r.trackedPointers[h]=new ra(h)),this.dispatchEvent(r,"pointerdown",e),l.pointerType==="touch")this.dispatchEvent(r,"touchstart",e);else if(l.pointerType==="mouse"||l.pointerType==="pen"){var p=l.button===2;p?r.trackedPointers[h].rightDown=!0:r.trackedPointers[h].leftDown=!0,this.dispatchEvent(r,p?"rightdown":"mousedown",e)}}},n.prototype.onPointerComplete=function(e,r,s){for(var l=this.normalizeToPointerData(e),h=l.length,p=e.target!==this.interactionDOMElement?"outside":"",x=0;x<h;x++){var b=l[x],w=this.getInteractionDataForPointerId(b),R=this.configureInteractionEventForDOMEvent(this.eventData,b,w);if(R.data.originalEvent=e,this.processInteractive(R,this.lastObjectRendered,s,r||!p),this.emit(r?"pointercancel":"pointerup"+p,R),b.pointerType==="mouse"||b.pointerType==="pen"){var H=b.button===2;this.emit(H?"rightup"+p:"mouseup"+p,R)}else b.pointerType==="touch"&&(this.emit(r?"touchcancel":"touchend"+p,R),this.releaseInteractionDataForPointerId(b.pointerId))}},n.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!0,this.processPointerCancel)},n.prototype.processPointerCancel=function(e,r){var s=e.data,l=e.data.identifier;r.trackedPointers[l]!==void 0&&(delete r.trackedPointers[l],this.dispatchEvent(r,"pointercancel",e),s.pointerType==="touch"&&this.dispatchEvent(r,"touchcancel",e))},n.prototype.onPointerUp=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!1,this.processPointerUp)},n.prototype.processPointerUp=function(e,r,s){var l=e.data,h=e.data.identifier,p=r.trackedPointers[h],x=l.pointerType==="touch",b=l.pointerType==="mouse"||l.pointerType==="pen",w=!1;if(b){var R=l.button===2,H=ra.FLAGS,z=R?H.RIGHT_DOWN:H.LEFT_DOWN,q=p!==void 0&&p.flags&z;s?(this.dispatchEvent(r,R?"rightup":"mouseup",e),q&&(this.dispatchEvent(r,R?"rightclick":"click",e),w=!0)):q&&this.dispatchEvent(r,R?"rightupoutside":"mouseupoutside",e),p&&(R?p.rightDown=!1:p.leftDown=!1)}s?(this.dispatchEvent(r,"pointerup",e),x&&this.dispatchEvent(r,"touchend",e),p&&(b&&!w||this.dispatchEvent(r,"pointertap",e),x&&(this.dispatchEvent(r,"tap",e),p.over=!1))):p&&(this.dispatchEvent(r,"pointerupoutside",e),x&&this.dispatchEvent(r,"touchendoutside",e)),p&&p.none&&delete r.trackedPointers[h]},n.prototype.onPointerMove=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var r=this.normalizeToPointerData(e);r[0].pointerType!=="mouse"&&r[0].pointerType!=="pen"||(this._didMove=!0,this.cursor=null);for(var s=r.length,l=0;l<s;l++){var h=r[l],p=this.getInteractionDataForPointerId(h),x=this.configureInteractionEventForDOMEvent(this.eventData,h,p);x.data.originalEvent=e,this.processInteractive(x,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",x),h.pointerType==="touch"&&this.emit("touchmove",x),h.pointerType!=="mouse"&&h.pointerType!=="pen"||this.emit("mousemove",x)}r[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},n.prototype.processPointerMove=function(e,r,s){var l=e.data,h=l.pointerType==="touch",p=l.pointerType==="mouse"||l.pointerType==="pen";p&&this.processPointerOverOut(e,r,s),this.moveWhenInside&&!s||(this.dispatchEvent(r,"pointermove",e),h&&this.dispatchEvent(r,"touchmove",e),p&&this.dispatchEvent(r,"mousemove",e))},n.prototype.onPointerOut=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var r=this.normalizeToPointerData(e)[0];r.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var s=this.getInteractionDataForPointerId(r),l=this.configureInteractionEventForDOMEvent(this.eventData,r,s);l.data.originalEvent=r,this.processInteractive(l,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",l),r.pointerType==="mouse"||r.pointerType==="pen"?this.emit("mouseout",l):this.releaseInteractionDataForPointerId(s.identifier)}},n.prototype.processPointerOverOut=function(e,r,s){var l=e.data,h=e.data.identifier,p=l.pointerType==="mouse"||l.pointerType==="pen",x=r.trackedPointers[h];s&&!x&&(x=r.trackedPointers[h]=new ra(h)),x!==void 0&&(s&&this.mouseOverRenderer?(x.over||(x.over=!0,this.delayDispatchEvent(r,"pointerover",e),p&&this.delayDispatchEvent(r,"mouseover",e)),p&&this.cursor===null&&(this.cursor=r.cursor)):x.over&&(x.over=!1,this.dispatchEvent(r,"pointerout",this.eventData),p&&this.dispatchEvent(r,"mouseout",e),x.none&&delete r.trackedPointers[h]))},n.prototype.onPointerOver=function(e){var r=this.normalizeToPointerData(e)[0],s=this.getInteractionDataForPointerId(r),l=this.configureInteractionEventForDOMEvent(this.eventData,r,s);l.data.originalEvent=r,r.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",l),r.pointerType!=="mouse"&&r.pointerType!=="pen"||this.emit("mouseover",l)},n.prototype.getInteractionDataForPointerId=function(e){var r,s=e.pointerId;return s===1||e.pointerType==="mouse"?r=this.mouse:this.activeInteractionData[s]?r=this.activeInteractionData[s]:((r=this.interactionDataPool.pop()||new Go).identifier=s,this.activeInteractionData[s]=r),r.copyEvent(e),r},n.prototype.releaseInteractionDataForPointerId=function(e){var r=this.activeInteractionData[e];r&&(delete this.activeInteractionData[e],r.reset(),this.interactionDataPool.push(r))},n.prototype.configureInteractionEventForDOMEvent=function(e,r,s){return e.data=s,this.mapPositionToPoint(s.global,r.clientX,r.clientY),r.pointerType==="touch"&&(r.globalX=s.global.x,r.globalY=s.global.y),s.originalEvent=r,e.reset(),e},n.prototype.normalizeToPointerData=function(e){var r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var s=0,l=e.changedTouches.length;s<l;s++){var h=e.changedTouches[s];h.button===void 0&&(h.button=e.touches.length?1:0),h.buttons===void 0&&(h.buttons=e.touches.length?1:0),h.isPrimary===void 0&&(h.isPrimary=e.touches.length===1&&e.type==="touchstart"),h.width===void 0&&(h.width=h.radiusX||1),h.height===void 0&&(h.height=h.radiusY||1),h.tiltX===void 0&&(h.tiltX=0),h.tiltY===void 0&&(h.tiltY=0),h.pointerType===void 0&&(h.pointerType="touch"),h.pointerId===void 0&&(h.pointerId=h.identifier||0),h.pressure===void 0&&(h.pressure=h.force||.5),h.twist===void 0&&(h.twist=0),h.tangentialPressure===void 0&&(h.tangentialPressure=0),h.layerX===void 0&&(h.layerX=h.offsetX=h.clientX),h.layerY===void 0&&(h.layerY=h.offsetY=h.clientY),h.isNormalized=!0,r.push(h)}else if(self.MouseEvent&&(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof self.PointerEvent))r.push(e);else{var p=e;p.isPrimary===void 0&&(p.isPrimary=!0),p.width===void 0&&(p.width=1),p.height===void 0&&(p.height=1),p.tiltX===void 0&&(p.tiltX=0),p.tiltY===void 0&&(p.tiltY=0),p.pointerType===void 0&&(p.pointerType="mouse"),p.pointerId===void 0&&(p.pointerId=1),p.pressure===void 0&&(p.pressure=.5),p.twist===void 0&&(p.twist=0),p.tangentialPressure===void 0&&(p.tangentialPressure=0),p.isNormalized=!0,r.push(p)}return r},n.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},n}(We.a),Gt=function(){function o(n){this.items=[],this._name=n,this._aliasCount=0}return o.prototype.emit=function(n,e,r,s,l,h,p,x){if(arguments.length>8)throw new Error("max arguments reached");var b=this,w=b.name,R=b.items;this._aliasCount++;for(var H=0,z=R.length;H<z;H++)R[H][w](n,e,r,s,l,h,p,x);return R===this.items&&this._aliasCount--,this},o.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},o.prototype.add=function(n){return n[this._name]&&(this.ensureNonAliasedItems(),this.remove(n),this.items.push(n)),this},o.prototype.remove=function(n){var e=this.items.indexOf(n);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},o.prototype.contains=function(n){return this.items.indexOf(n)!==-1},o.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},o.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(o.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),o}();Object.defineProperties(Gt.prototype,{dispatch:{value:Gt.prototype.emit},run:{value:Gt.prototype.emit}}),Vt.PREFER_ENV=Er.any?Fr.WEBGL:Fr.WEBGL2,Vt.STRICT_TEXTURE_CACHE=!1;var fe=[];function we(o,n){if(!o)return null;var e="";if(typeof o=="string"){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(o);r&&(e=r[1].toLowerCase())}for(var s=fe.length-1;s>=0;--s){var l=fe[s];if(l.test&&l.test(o,e))return new l(o,n)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var sn=function(o,n){return(sn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function en(o,n){function e(){this.constructor=o}sn(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var pr=function(){function o(n,e){n===void 0&&(n=0),e===void 0&&(e=0),this._width=n,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Gt("setRealSize"),this.onUpdate=new Gt("update"),this.onError=new Gt("onError")}return o.prototype.bind=function(n){this.onResize.add(n),this.onUpdate.add(n),this.onError.add(n),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},o.prototype.unbind=function(n){this.onResize.remove(n),this.onUpdate.remove(n),this.onError.remove(n)},o.prototype.resize=function(n,e){n===this._width&&e===this._height||(this._width=n,this._height=e,this.onResize.emit(n,e))},Object.defineProperty(o.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),o.prototype.update=function(){this.destroyed||this.onUpdate.emit()},o.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(o.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),o.prototype.style=function(n,e,r){return!1},o.prototype.dispose=function(){},o.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},o.test=function(n,e){return!1},o}(),hi=function(o){function n(e,r){var s=this,l=r||{},h=l.width,p=l.height;if(!h||!p)throw new Error("BufferResource width or height invalid");return(s=o.call(this,h,p)||this).data=e,s}return en(n,o),n.prototype.upload=function(e,r,s){var l=e.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===vt.UNPACK);var h=r.realWidth,p=r.realHeight;return s.width===h&&s.height===p?l.texSubImage2D(r.target,0,0,0,h,p,r.format,r.type,this.data):(s.width=h,s.height=p,l.texImage2D(r.target,0,s.internalFormat,h,p,0,r.format,s.type,this.data)),!0},n.prototype.dispose=function(){this.data=null},n.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},n}(pr),Hs={scaleMode:st.NEAREST,format:ki.RGBA,alphaMode:vt.NPM},On=function(o){function n(e,r){e===void 0&&(e=null),r===void 0&&(r=null);var s=o.call(this)||this,l=(r=r||{}).alphaMode,h=r.mipmap,p=r.anisotropicLevel,x=r.scaleMode,b=r.width,w=r.height,R=r.wrapMode,H=r.format,z=r.type,q=r.target,at=r.resolution,_t=r.resourceOptions;return!e||e instanceof pr||((e=we(e,_t)).internal=!0),s.width=b||0,s.height=w||0,s.resolution=at||Vt.RESOLUTION,s.mipmap=h!==void 0?h:Vt.MIPMAP_TEXTURES,s.anisotropicLevel=p!==void 0?p:Vt.ANISOTROPIC_LEVEL,s.wrapMode=R||Vt.WRAP_MODE,s.scaleMode=x!==void 0?x:Vt.SCALE_MODE,s.format=H||ki.RGBA,s.type=z||k.UNSIGNED_BYTE,s.target=q||L.TEXTURE_2D,s.alphaMode=l!==void 0?l:vt.UNPACK,s.uid=Ur(),s.touched=0,s.isPowerOfTwo=!1,s._refreshPOT(),s._glTextures={},s.dirtyId=0,s.dirtyStyleId=0,s.cacheId=null,s.valid=b>0&&w>0,s.textureCacheIds=[],s.destroyed=!1,s.resource=null,s._batchEnabled=0,s._batchLocation=0,s.parentTextureArray=null,s.setResource(e),s}return en(n,o),Object.defineProperty(n.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),n.prototype.setStyle=function(e,r){var s;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,s=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,s=!0),s&&this.dirtyStyleId++,this},n.prototype.setSize=function(e,r,s){return this.resolution=s||this.resolution,this.width=e,this.height=r,this._refreshPOT(),this.update(),this},n.prototype.setRealSize=function(e,r,s){return this.resolution=s||this.resolution,this.width=e/this.resolution,this.height=r/this.resolution,this._refreshPOT(),this.update(),this},n.prototype._refreshPOT=function(){this.isPowerOfTwo=yi(this.realWidth)&&yi(this.realHeight)},n.prototype.setResolution=function(e){var r=this.resolution;return r===e||(this.resolution=e,this.valid&&(this.width=this.width*r/e,this.height=this.height*r/e,this.emit("update",this)),this._refreshPOT()),this},n.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},n.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},n.prototype.onError=function(e){this.emit("error",this,e)},n.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Eo[this.cacheId],delete $r[this.cacheId],this.cacheId=null),this.dispose(),n.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},n.prototype.dispose=function(){this.emit("dispose",this)},n.prototype.castToBaseTexture=function(){return this},n.from=function(e,r,s){s===void 0&&(s=Vt.STRICT_TEXTURE_CACHE);var l=typeof e=="string",h=null;if(l)h=e;else{if(!e._pixiId){var p=r&&r.pixiIdPrefix||"pixiid";e._pixiId=p+"_"+Ur()}h=e._pixiId}var x=Eo[h];if(l&&s&&!x)throw new Error('The cacheId "'+h+'" does not exist in BaseTextureCache.');return x||((x=new n(e,r)).cacheId=h,n.addToCache(x,h)),x},n.fromBuffer=function(e,r,s,l){e=e||new Float32Array(r*s*4);var h=new hi(e,{width:r,height:s}),p=e instanceof Float32Array?k.FLOAT:k.UNSIGNED_BYTE;return new n(h,Object.assign(Hs,l||{width:r,height:s,type:p}))},n.addToCache=function(e,r){r&&(e.textureCacheIds.indexOf(r)===-1&&e.textureCacheIds.push(r),Eo[r]&&console.warn("BaseTexture added to the cache with an id ["+r+"] that already had an entry"),Eo[r]=e)},n.removeFromCache=function(e){if(typeof e=="string"){var r=Eo[e];if(r){var s=r.textureCacheIds.indexOf(e);return s>-1&&r.textureCacheIds.splice(s,1),delete Eo[e],r}}else if(e&&e.textureCacheIds){for(var l=0;l<e.textureCacheIds.length;++l)delete Eo[e.textureCacheIds[l]];return e.textureCacheIds.length=0,e}return null},n._globalBatch=0,n}(We.a),Eu=function(o){function n(e,r){var s=this,l=r||{},h=l.width,p=l.height;(s=o.call(this,h,p)||this).items=[],s.itemDirtyIds=[];for(var x=0;x<e;x++){var b=new On;s.items.push(b),s.itemDirtyIds.push(-2)}return s.length=e,s._load=null,s.baseTexture=null,s}return en(n,o),n.prototype.initFromArray=function(e,r){for(var s=0;s<this.length;s++)e[s]&&(e[s].castToBaseTexture?this.addBaseTextureAt(e[s].castToBaseTexture(),s):e[s]instanceof pr?this.addResourceAt(e[s],s):this.addResourceAt(we(e[s],r),s))},n.prototype.dispose=function(){for(var e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},n.prototype.addResourceAt=function(e,r){if(!this.items[r])throw new Error("Index "+r+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this},n.prototype.bind=function(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");o.prototype.bind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)},n.prototype.unbind=function(e){o.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)},n.prototype.load=function(){var e=this;if(this._load)return this._load;var r=this.items.map(function(s){return s.resource}).filter(function(s){return s}).map(function(s){return s.load()});return this._load=Promise.all(r).then(function(){var s=e.items[0],l=s.realWidth,h=s.realHeight;return e.resize(l,h),Promise.resolve(e)}),this._load},n}(pr),pd=function(o){function n(e,r){var s,l,h=this,p=r||{},x=p.width,b=p.height;return Array.isArray(e)?(s=e,l=e.length):l=e,h=o.call(this,l,{width:x,height:b})||this,s&&h.initFromArray(s,r),h}return en(n,o),n.prototype.addBaseTextureAt=function(e,r){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,r),this},n.prototype.bind=function(e){o.prototype.bind.call(this,e),e.target=L.TEXTURE_2D_ARRAY},n.prototype.upload=function(e,r,s){var l=this.length,h=this.itemDirtyIds,p=this.items,x=e.gl;s.dirtyId<0&&x.texImage3D(x.TEXTURE_2D_ARRAY,0,r.format,this._width,this._height,l,0,r.format,r.type,null);for(var b=0;b<l;b++){var w=p[b];h[b]<w.dirtyId&&(h[b]=w.dirtyId,w.valid&&x.texSubImage3D(x.TEXTURE_2D_ARRAY,0,0,0,b,w.resource.width,w.resource.height,1,r.format,r.type,w.resource.source))}return!0},n}(Eu),pi=function(o){function n(e){var r=this,s=e,l=s.naturalWidth||s.videoWidth||s.width,h=s.naturalHeight||s.videoHeight||s.height;return(r=o.call(this,l,h)||this).source=e,r.noSubImage=!1,r}return en(n,o),n.crossOrigin=function(e,r,s){s===void 0&&r.indexOf("data:")!==0?e.crossOrigin=ko(r):s!==!1&&(e.crossOrigin=typeof s=="string"?s:"anonymous")},n.prototype.upload=function(e,r,s,l){var h=e.gl,p=r.realWidth,x=r.realHeight;return l=l||this.source,h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===vt.UNPACK),this.noSubImage||r.target!==h.TEXTURE_2D||s.width!==p||s.height!==x?(s.width=p,s.height=x,h.texImage2D(r.target,0,r.format,r.format,r.type,l)):h.texSubImage2D(h.TEXTURE_2D,0,0,0,r.format,r.type,l),!0},n.prototype.update=function(){if(!this.destroyed){var e=this.source,r=e.naturalWidth||e.videoWidth||e.width,s=e.naturalHeight||e.videoHeight||e.height;this.resize(r,s),o.prototype.update.call(this)}},n.prototype.dispose=function(){this.source=null},n}(pr),Mu=function(o){function n(e){return o.call(this,e)||this}return en(n,o),n.test=function(e){var r=self.OffscreenCanvas;return!!(r&&e instanceof r)||self.HTMLCanvasElement&&e instanceof HTMLCanvasElement},n}(pi),md=function(o){function n(e,r){var s=this,l=r||{},h=l.width,p=l.height,x=l.autoLoad,b=l.linkBaseTexture;if(e&&e.length!==n.SIDES)throw new Error("Invalid length. Got "+e.length+", expected 6");s=o.call(this,6,{width:h,height:p})||this;for(var w=0;w<n.SIDES;w++)s.items[w].target=L.TEXTURE_CUBE_MAP_POSITIVE_X+w;return s.linkBaseTexture=b!==!1,e&&s.initFromArray(e,r),x!==!1&&s.load(),s}return en(n,o),n.prototype.bind=function(e){o.prototype.bind.call(this,e),e.target=L.TEXTURE_CUBE_MAP},n.prototype.addBaseTextureAt=function(e,r,s){if(!this.items[r])throw new Error("Index "+r+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,r)}else e.target=L.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this},n.prototype.upload=function(e,r,s){for(var l=this.itemDirtyIds,h=0;h<n.SIDES;h++){var p=this.items[h];l[h]<p.dirtyId&&(p.valid&&p.resource?(p.resource.upload(e,p,s),l[h]=p.dirtyId):l[h]<-1&&(e.gl.texImage2D(p.target,0,s.internalFormat,r.realWidth,r.realHeight,0,r.format,s.type,null),l[h]=-1))}return!0},n.test=function(e){return Array.isArray(e)&&e.length===n.SIDES},n.SIDES=6,n}(Eu),Ca=function(o){function n(e,r){var s=this;if(r=r||{},!(e instanceof HTMLImageElement)){var l=new Image;pi.crossOrigin(l,e,r.crossorigin),l.src=e,e=l}return s=o.call(this,e)||this,!e.complete&&s._width&&s._height&&(s._width=0,s._height=0),s.url=e.src,s._process=null,s.preserveBitmap=!1,s.createBitmap=(r.createBitmap!==void 0?r.createBitmap:Vt.CREATE_IMAGE_BITMAP)&&!!self.createImageBitmap,s.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,s.bitmap=null,s._load=null,r.autoLoad!==!1&&s.load(),s}return en(n,o),n.prototype.load=function(e){var r=this;return this._load||(e!==void 0&&(this.createBitmap=e),this._load=new Promise(function(s,l){var h=r.source;r.url=h.src;var p=function(){r.destroyed||(h.onload=null,h.onerror=null,r.resize(h.width,h.height),r._load=null,r.createBitmap?s(r.process()):s(r))};h.complete&&h.src?p():(h.onload=p,h.onerror=function(x){l(x),r.onError.emit(x)})})),this._load},n.prototype.process=function(){var e=this,r=this.source;return this._process!==null?this._process:this.bitmap===null&&self.createImageBitmap?(this._process=self.createImageBitmap(r,0,0,r.width,r.height,{premultiplyAlpha:this.alphaMode===vt.UNPACK?"premultiply":"none"}).then(function(s){return e.destroyed?Promise.reject():(e.bitmap=s,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},n.prototype.upload=function(e,r,s){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,e,r,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,e,r,s,this.bitmap),!this.preserveBitmap){var l=!0,h=r._glTextures;for(var p in h){var x=h[p];if(x!==s&&x.dirtyId!==r.dirtyId){l=!1;break}}l&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},n.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},n.test=function(e){return typeof e=="string"||e instanceof HTMLImageElement},n}(pi),Ml=function(o){function n(e,r){var s=this;return r=r||{},(s=o.call(this,document.createElement("canvas"))||this)._width=0,s._height=0,s.svg=e,s.scale=r.scale||1,s._overrideWidth=r.width,s._overrideHeight=r.height,s._resolve=null,s._crossorigin=r.crossorigin,s._load=null,r.autoLoad!==!1&&s.load(),s}return en(n,o),n.prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(r){if(e._resolve=function(){e.resize(e.source.width,e.source.height),r(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},n.prototype._loadSvg=function(){var e=this,r=new Image;pi.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(s){e._resolve&&(r.onerror=null,e.onError.emit(s))},r.onload=function(){if(e._resolve){var s=r.width,l=r.height;if(!s||!l)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var h=s*e.scale,p=l*e.scale;(e._overrideWidth||e._overrideHeight)&&(h=e._overrideWidth||e._overrideHeight/l*s,p=e._overrideHeight||e._overrideWidth/s*l),h=Math.round(h),p=Math.round(p);var x=e.source;x.width=h,x.height=p,x._pixiId="canvas_"+Ur(),x.getContext("2d").drawImage(r,0,0,s,l,0,0,h,p),e._resolve(),e._resolve=null}}},n.getSize=function(e){var r=n.SVG_SIZE.exec(e),s={};return r&&(s[r[1]]=Math.round(parseFloat(r[3])),s[r[5]]=Math.round(parseFloat(r[7]))),s},n.prototype.dispose=function(){o.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},n.test=function(e,r){return r==="svg"||typeof e=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(e)||typeof e=="string"&&e.indexOf("<svg")===0},n.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,n}(pi),Au=function(o){function n(e,r){var s=this;if(r=r||{},!(e instanceof HTMLVideoElement)){var l=document.createElement("video");l.setAttribute("preload","auto"),l.setAttribute("webkit-playsinline",""),l.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);var h=e[0].src||e[0];pi.crossOrigin(l,h,r.crossorigin);for(var p=0;p<e.length;++p){var x=document.createElement("source"),b=e[p],w=b.src,R=b.mime,H=(w=w||e[p]).split("?").shift().toLowerCase(),z=H.substr(H.lastIndexOf(".")+1);R=R||n.MIME_TYPES[z]||"video/"+z,x.src=w,x.type=R,l.appendChild(x)}e=l}return(s=o.call(this,e)||this).noSubImage=!0,s._autoUpdate=!0,s._isConnectedToTicker=!1,s._updateFPS=r.updateFPS||0,s._msToNextUpdate=0,s.autoPlay=r.autoPlay!==!1,s._load=null,s._resolve=null,s._onCanPlay=s._onCanPlay.bind(s),s._onError=s._onError.bind(s),r.autoLoad!==!1&&s.load(),s}return en(n,o),n.prototype.update=function(e){if(!this.destroyed){var r=ri.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(o.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},n.prototype.load=function(){var e=this;if(this._load)return this._load;var r=this.source;return(r.readyState===r.HAVE_ENOUGH_DATA||r.readyState===r.HAVE_FUTURE_DATA)&&r.width&&r.height&&(r.complete=!0),r.addEventListener("play",this._onPlayStart.bind(this)),r.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(r.addEventListener("canplay",this._onCanPlay),r.addEventListener("canplaythrough",this._onCanPlay),r.addEventListener("error",this._onError,!0)),this._load=new Promise(function(s){e.valid?s(e):(e._resolve=s,r.load())}),this._load},n.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},n.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&e.paused===!1&&e.ended===!1&&e.readyState>2},n.prototype._isSourceReady=function(){var e=this.source;return e.readyState===3||e.readyState===4},n.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(ri.shared.add(this.update,this),this._isConnectedToTicker=!0)},n.prototype._onPlayStop=function(){this._isConnectedToTicker&&(ri.shared.remove(this.update,this),this._isConnectedToTicker=!1)},n.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var r=this.valid;this.resize(e.videoWidth,e.videoHeight),!r&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},n.prototype.dispose=function(){this._isConnectedToTicker&&ri.shared.remove(this.update,this);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),o.prototype.dispose.call(this)},Object.defineProperty(n.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(ri.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(ri.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),n.test=function(e,r){return self.HTMLVideoElement&&e instanceof HTMLVideoElement||n.TYPES.indexOf(r)>-1},n.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],n.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},n}(pi),Hr=function(o){function n(e){return o.call(this,e)||this}return en(n,o),n.test=function(e){return!!self.createImageBitmap&&e instanceof ImageBitmap},n}(pi);fe.push(Ca,Hr,Mu,Au,Ml,hi,md,pd);var mf={__proto__:null,Resource:pr,BaseImageResource:pi,INSTALLED:fe,autoDetectResource:we,AbstractMultiResource:Eu,ArrayResource:pd,BufferResource:hi,CanvasResource:Mu,CubeResource:md,ImageResource:Ca,SVGResource:Ml,VideoResource:Au,ImageBitmapResource:Hr},Ao=function(){function o(n){this.renderer=n}return o.prototype.destroy=function(){this.renderer=null},o}(),ac=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return en(n,o),n.prototype.upload=function(e,r,s){var l=e.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===vt.UNPACK);var h=r.realWidth,p=r.realHeight;return s.width===h&&s.height===p?l.texSubImage2D(r.target,0,0,0,h,p,r.format,r.type,this.data):(s.width=h,s.height=p,l.texImage2D(r.target,0,e.context.webGLVersion===1?l.DEPTH_COMPONENT:l.DEPTH_COMPONENT16,h,p,0,r.format,r.type,this.data)),!0},n}(hi),uc=function(){function o(n,e){this.width=Math.ceil(n||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Gt("disposeFramebuffer"),this.multisample=ne.NONE}return Object.defineProperty(o.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),o.prototype.addColorTexture=function(n,e){return n===void 0&&(n=0),this.colorTextures[n]=e||new On(null,{scaleMode:st.NEAREST,resolution:1,mipmap:et.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},o.prototype.addDepthTexture=function(n){return this.depthTexture=n||new On(new ac(null,{width:this.width,height:this.height}),{scaleMode:st.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:et.OFF,format:ki.DEPTH_COMPONENT,type:k.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},o.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},o.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},o.prototype.resize=function(n,e){if(n=Math.ceil(n),e=Math.ceil(e),n!==this.width||e!==this.height){this.width=n,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var s=this.colorTextures[r],l=s.resolution;s.setSize(n/l,e/l)}this.depthTexture&&(l=this.depthTexture.resolution,this.depthTexture.setSize(n/l,e/l))}},o.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},o.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},o}(),gd=function(o){function n(e){var r=this;if(typeof e=="number"){var s=arguments[0],l=arguments[1],h=arguments[2],p=arguments[3];e={width:s,height:l,scaleMode:h,resolution:p}}r=o.call(this,null,e)||this;var x=e||{},b=x.width,w=x.height;return r.mipmap=et.OFF,r.width=Math.ceil(b)||100,r.height=Math.ceil(w)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new uc(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return en(n,o),n.prototype.resize=function(e,r){e=Math.ceil(e),r=Math.ceil(r),this.framebuffer.resize(e*this.resolution,r*this.resolution)},n.prototype.dispose=function(){this.framebuffer.dispose(),o.prototype.dispose.call(this)},n.prototype.destroy=function(){o.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},n}(On),vd=function(){function o(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return o.prototype.set=function(n,e,r){var s=e.width,l=e.height;if(r){var h=n.width/2/s,p=n.height/2/l,x=n.x/s+h,b=n.y/l+p;r=Kr.add(r,Kr.NW),this.x0=x+h*Kr.uX(r),this.y0=b+p*Kr.uY(r),r=Kr.add(r,2),this.x1=x+h*Kr.uX(r),this.y1=b+p*Kr.uY(r),r=Kr.add(r,2),this.x2=x+h*Kr.uX(r),this.y2=b+p*Kr.uY(r),r=Kr.add(r,2),this.x3=x+h*Kr.uX(r),this.y3=b+p*Kr.uY(r)}else this.x0=n.x/s,this.y0=n.y/l,this.x1=(n.x+n.width)/s,this.y1=n.y/l,this.x2=(n.x+n.width)/s,this.y2=(n.y+n.height)/l,this.x3=n.x/s,this.y3=(n.y+n.height)/l;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},o.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},o}(),hh=new vd,Nn=function(o){function n(e,r,s,l,h,p){var x=o.call(this)||this;if(x.noFrame=!1,r||(x.noFrame=!0,r=new Ln(0,0,1,1)),e instanceof n&&(e=e.baseTexture),x.baseTexture=e,x._frame=r,x.trim=l,x.valid=!1,x._uvs=hh,x.uvMatrix=null,x.orig=s||r,x._rotate=Number(h||0),h===!0)x._rotate=2;else if(x._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return x.defaultAnchor=p?new xi(p.x,p.y):new xi(0,0),x._updateID=0,x.textureCacheIds=[],e.valid?x.noFrame?e.valid&&x.onBaseTextureUpdated(e):x.frame=r:e.once("loaded",x.onBaseTextureUpdated,x),x.noFrame&&e.on("update",x.onBaseTextureUpdated,x),x}return en(n,o),n.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},n.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},n.prototype.destroy=function(e){if(this.baseTexture){if(e){var r=this.baseTexture.resource;r&&r.url&&$r[r.url]&&n.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,n.removeFromCache(this),this.textureCacheIds=null},n.prototype.clone=function(){var e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),s=new n(this.baseTexture,!this.noFrame&&e,r,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(s._frame=e),s},n.prototype.updateUvs=function(){this._uvs===hh&&(this._uvs=new vd),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},n.from=function(e,r,s){r===void 0&&(r={}),s===void 0&&(s=Vt.STRICT_TEXTURE_CACHE);var l=typeof e=="string",h=null;if(l)h=e;else{if(!e._pixiId){var p=r&&r.pixiIdPrefix||"pixiid";e._pixiId=p+"_"+Ur()}h=e._pixiId}var x=$r[h];if(l&&s&&!x)throw new Error('The cacheId "'+h+'" does not exist in TextureCache.');return x||(r.resolution||(r.resolution=vl(e)),(x=new n(new On(e,r))).baseTexture.cacheId=h,On.addToCache(x.baseTexture,h),n.addToCache(x,h)),x},n.fromURL=function(e,r){var s=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),l=n.from(e,Object.assign({resourceOptions:s},r),!1),h=l.baseTexture.resource;return l.baseTexture.valid?Promise.resolve(l):h.load().then(function(){return Promise.resolve(l)})},n.fromBuffer=function(e,r,s,l){return new n(On.fromBuffer(e,r,s,l))},n.fromLoader=function(e,r,s,l){var h=new On(e,Object.assign({scaleMode:Vt.SCALE_MODE,resolution:vl(r)},l)),p=h.resource;p instanceof Ca&&(p.url=r);var x=new n(h);return s||(s=r),On.addToCache(x.baseTexture,s),n.addToCache(x,s),s!==r&&(On.addToCache(x.baseTexture,r),n.addToCache(x,r)),x.baseTexture.valid?Promise.resolve(x):new Promise(function(b){x.baseTexture.once("loaded",function(){return b(x)})})},n.addToCache=function(e,r){r&&(e.textureCacheIds.indexOf(r)===-1&&e.textureCacheIds.push(r),$r[r]&&console.warn("Texture added to the cache with an id ["+r+"] that already had an entry"),$r[r]=e)},n.removeFromCache=function(e){if(typeof e=="string"){var r=$r[e];if(r){var s=r.textureCacheIds.indexOf(e);return s>-1&&r.textureCacheIds.splice(s,1),delete $r[e],r}}else if(e&&e.textureCacheIds){for(var l=0;l<e.textureCacheIds.length;++l)$r[e.textureCacheIds[l]]===e&&delete $r[e.textureCacheIds[l]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(n.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var r=e.x,s=e.y,l=e.width,h=e.height,p=r+l>this.baseTexture.width,x=s+h>this.baseTexture.height;if(p||x){var b=p&&x?"and":"or",w="X: "+r+" + "+l+" = "+(r+l)+" > "+this.baseTexture.width,R="Y: "+s+" + "+h+" = "+(s+h)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+w+" "+b+" "+R)}this.valid=l&&h&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),n.prototype.castToBaseTexture=function(){return this.baseTexture},n}(We.a);function ys(o){o.destroy=function(){},o.on=function(){},o.once=function(){},o.emit=function(){}}Nn.EMPTY=new Nn(new On),ys(Nn.EMPTY),ys(Nn.EMPTY.baseTexture),Nn.WHITE=function(){var o=document.createElement("canvas");o.width=16,o.height=16;var n=o.getContext("2d");return n.fillStyle="white",n.fillRect(0,0,16,16),new Nn(new On(new Mu(o)))}(),ys(Nn.WHITE),ys(Nn.WHITE.baseTexture);var Zi=function(o){function n(e,r){var s=o.call(this,e,r)||this;return s.valid=!0,s.filterFrame=null,s.filterPoolKey=null,s.updateUvs(),s}return en(n,o),Object.defineProperty(n.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),n.prototype.resize=function(e,r,s){s===void 0&&(s=!0),e=Math.ceil(e),r=Math.ceil(r),this.valid=e>0&&r>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=r,s&&this.baseTexture.resize(e,r),this.updateUvs()},n.prototype.setResolution=function(e){var r=this.baseTexture;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))},n.create=function(e){for(var r=arguments,s=[],l=1;l<arguments.length;l++)s[l-1]=r[l];return typeof e=="number"&&(ea("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),e={width:e,height:s[0],scaleMode:s[1],resolution:s[2]}),new n(new gd(e))},n}(Nn),ch=function(){function o(n){this.texturePool={},this.textureOptions=n||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return o.prototype.createTexture=function(n,e){var r=new gd(Object.assign({width:n,height:e,resolution:1},this.textureOptions));return new Zi(r)},o.prototype.getOptimalTexture=function(n,e,r){r===void 0&&(r=1);var s=o.SCREEN_KEY;n*=r,e*=r,this.enableFullScreen&&n===this._pixelsWidth&&e===this._pixelsHeight||(s=(65535&(n=ir(n)))<<16|65535&(e=ir(e))),this.texturePool[s]||(this.texturePool[s]=[]);var l=this.texturePool[s].pop();return l||(l=this.createTexture(n,e)),l.filterPoolKey=s,l.setResolution(r),l},o.prototype.getFilterTexture=function(n,e){var r=this.getOptimalTexture(n.width,n.height,e||n.resolution);return r.filterFrame=n.filterFrame,r},o.prototype.returnTexture=function(n){var e=n.filterPoolKey;n.filterFrame=null,this.texturePool[e].push(n)},o.prototype.returnFilterTexture=function(n){this.returnTexture(n)},o.prototype.clear=function(n){if(n=n!==!1)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var s=0;s<r.length;s++)r[s].destroy(!0)}this.texturePool={}},o.prototype.setScreenSize=function(n){if(n.width!==this._pixelsWidth||n.height!==this._pixelsHeight){var e=o.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=n.width>0&&n.height>0,r)for(var s=0;s<r.length;s++)r[s].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=n.width,this._pixelsHeight=n.height}},o.SCREEN_KEY="screen",o}(),lc=function(){function o(n,e,r,s,l,h,p){e===void 0&&(e=0),r===void 0&&(r=!1),s===void 0&&(s=k.FLOAT),this.buffer=n,this.size=e,this.normalized=r,this.type=s,this.stride=l,this.start=h,this.instance=p}return o.prototype.destroy=function(){this.buffer=null},o.from=function(n,e,r,s,l){return new o(n,e,r,s,l)},o}(),gf=0,Gi=function(){function o(n,e,r){e===void 0&&(e=!0),r===void 0&&(r=!1),this.data=n||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=gf++,this.disposeRunner=new Gt("disposeBuffer")}return o.prototype.update=function(n){this.data=n||this.data,this._updateID++},o.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},o.prototype.destroy=function(){this.dispose(),this.data=null},o.from=function(n){return n instanceof Array&&(n=new Float32Array(n)),new o(n)},o}();function _d(o){if(o.BYTES_PER_ELEMENT===4)return o instanceof Float32Array?"Float32Array":o instanceof Uint32Array?"Uint32Array":"Int32Array";if(o.BYTES_PER_ELEMENT===2){if(o instanceof Uint16Array)return"Uint16Array"}else if(o.BYTES_PER_ELEMENT===1&&o instanceof Uint8Array)return"Uint8Array";return null}var dh={Float32Array,Uint32Array,Int32Array,Uint8Array},ou={5126:4,5123:2,5121:1},hc=0,yd={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Ho=function(){function o(n,e){n===void 0&&(n=[]),e===void 0&&(e={}),this.buffers=n,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=hc++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Gt("disposeGeometry"),this.refCount=0}return o.prototype.addAttribute=function(n,e,r,s,l,h,p,x){if(r===void 0&&(r=0),s===void 0&&(s=!1),x===void 0&&(x=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Gi||(e instanceof Array&&(e=new Float32Array(e)),e=new Gi(e));var b=n.split("|");if(b.length>1){for(var w=0;w<b.length;w++)this.addAttribute(b[w],e,r,s,l);return this}var R=this.buffers.indexOf(e);return R===-1&&(this.buffers.push(e),R=this.buffers.length-1),this.attributes[n]=new lc(R,r,s,l,h,p,x),this.instanced=this.instanced||x,this},o.prototype.getAttribute=function(n){return this.attributes[n]},o.prototype.getBuffer=function(n){return this.buffers[this.getAttribute(n).buffer]},o.prototype.addIndex=function(n){return n instanceof Gi||(n instanceof Array&&(n=new Uint16Array(n)),n=new Gi(n)),n.index=!0,this.indexBuffer=n,this.buffers.indexOf(n)===-1&&this.buffers.push(n),this},o.prototype.getIndex=function(){return this.indexBuffer},o.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var n,e=[],r=[],s=new Gi;for(n in this.attributes){var l=this.attributes[n],h=this.buffers[l.buffer];e.push(h.data),r.push(l.size*ou[l.type]/4),l.buffer=0}for(s.data=function(p,x){for(var b=0,w=0,R={},H=0;H<p.length;H++)w+=x[H],b+=p[H].length;var z=new ArrayBuffer(4*b),q=null,at=0;for(H=0;H<p.length;H++){var _t=x[H],bt=p[H],zt=_d(bt);R[zt]||(R[zt]=new dh[zt](z)),q=R[zt];for(var De=0;De<bt.length;De++)q[(De/_t|0)*w+at+De%_t]=bt[De];at+=_t}return new Float32Array(z)}(e,r),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},o.prototype.getSize=function(){for(var n in this.attributes){var e=this.attributes[n];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},o.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},o.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},o.prototype.clone=function(){for(var n=new o,e=0;e<this.buffers.length;e++)n.buffers[e]=new Gi(this.buffers[e].data.slice(0));for(var e in this.attributes){var r=this.attributes[e];n.attributes[e]=new lc(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(n.indexBuffer=n.buffers[this.buffers.indexOf(this.indexBuffer)],n.indexBuffer.index=!0),n},o.merge=function(n){for(var e,r=new o,s=[],l=[],h=[],p=0;p<n.length;p++){e=n[p];for(var x=0;x<e.buffers.length;x++)l[x]=l[x]||0,l[x]+=e.buffers[x].data.length,h[x]=0}for(p=0;p<e.buffers.length;p++)s[p]=new yd[_d(e.buffers[p].data)](l[p]),r.buffers[p]=new Gi(s[p]);for(p=0;p<n.length;p++)for(e=n[p],x=0;x<e.buffers.length;x++)s[x].set(e.buffers[x].data,h[x]),h[x]+=e.buffers[x].data.length;if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;var b=0,w=0,R=0,H=0;for(p=0;p<e.buffers.length;p++)if(e.buffers[p]!==e.indexBuffer){H=p;break}for(var p in e.attributes){var z=e.attributes[p];(0|z.buffer)===H&&(w+=z.size*ou[z.type]/4)}for(p=0;p<n.length;p++){var q=n[p].indexBuffer.data;for(x=0;x<q.length;x++)r.indexBuffer.data[x+R]+=b;b+=e.buffers[H].data.length/w,R+=q.length}}return r},o}(),io=function(o){function n(){var e=o.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return en(n,o),n}(Ho),Ra=function(o){function n(){var e=o.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new Gi(e.vertices),e.uvBuffer=new Gi(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return en(n,o),n.prototype.map=function(e,r){var s=0,l=0;return this.uvs[0]=s,this.uvs[1]=l,this.uvs[2]=s+r.width/e.width,this.uvs[3]=l,this.uvs[4]=s+r.width/e.width,this.uvs[5]=l+r.height/e.height,this.uvs[6]=s,this.uvs[7]=l+r.height/e.height,s=r.x,l=r.y,this.vertices[0]=s,this.vertices[1]=l,this.vertices[2]=s+r.width,this.vertices[3]=l,this.vertices[4]=s+r.width,this.vertices[5]=l+r.height,this.vertices[6]=s,this.vertices[7]=l+r.height,this.invalidate(),this},n.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},n}(Ho),ia=0,zo=function(){function o(n,e){this.uniforms=n,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=ia++,this.static=!!e}return o.prototype.update=function(){this.dirtyId++},o.prototype.add=function(n,e,r){this.uniforms[n]=new o(e,r)},o.from=function(n,e){return new o(n,e)},o}(),jo=function(){function o(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new Ln,this.destinationFrame=new Ln,this.bindingSourceFrame=new Ln,this.bindingDestinationFrame=new Ln,this.filters=[],this.transform=null}return o.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},o}(),Hi=[new xi,new xi,new xi,new xi],fh=new li,Pu=function(o){function n(e){var r=o.call(this,e)||this;return r.defaultFilterStack=[{}],r.texturePool=new ch,r.texturePool.setScreenSize(e.view),r.statePool=[],r.quad=new io,r.quadUv=new Ra,r.tempRect=new Ln,r.activeState={},r.globalUniforms=new zo({outputFrame:new Ln,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return en(n,o),n.prototype.push=function(e,r){for(var s=this.renderer,l=this.defaultFilterStack,h=this.statePool.pop()||new jo,p=this.renderer.renderTexture,x=r[0].resolution,b=r[0].padding,w=r[0].autoFit,R=r[0].legacy,H=1;H<r.length;H++){var z=r[H];x=Math.min(x,z.resolution),b=this.useMaxPadding?Math.max(b,z.padding):b+z.padding,w=w&&z.autoFit,R=R||z.legacy}if(l.length===1&&(this.defaultFilterStack[0].renderTexture=p.current),l.push(h),h.resolution=x,h.legacy=R,h.target=e,h.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),h.sourceFrame.pad(b),w){var q=this.tempRect.copyFrom(p.sourceFrame);s.projection.transform&&this.transformAABB(fh.copyFrom(s.projection.transform).invert(),q),h.sourceFrame.fit(q)}this.roundFrame(h.sourceFrame,p.current?p.current.resolution:s.resolution,p.sourceFrame,p.destinationFrame,s.projection.transform),h.renderTexture=this.getOptimalFilterTexture(h.sourceFrame.width,h.sourceFrame.height,x),h.filters=r,h.destinationFrame.width=h.renderTexture.width,h.destinationFrame.height=h.renderTexture.height;var at=this.tempRect;at.x=0,at.y=0,at.width=h.sourceFrame.width,at.height=h.sourceFrame.height,h.renderTexture.filterFrame=h.sourceFrame,h.bindingSourceFrame.copyFrom(p.sourceFrame),h.bindingDestinationFrame.copyFrom(p.destinationFrame),h.transform=s.projection.transform,s.projection.transform=null,p.bind(h.renderTexture,h.sourceFrame,at),s.framebuffer.clear(0,0,0,0)},n.prototype.pop=function(){var e=this.defaultFilterStack,r=e.pop(),s=r.filters;this.activeState=r;var l=this.globalUniforms.uniforms;l.outputFrame=r.sourceFrame,l.resolution=r.resolution;var h=l.inputSize,p=l.inputPixel,x=l.inputClamp;if(h[0]=r.destinationFrame.width,h[1]=r.destinationFrame.height,h[2]=1/h[0],h[3]=1/h[1],p[0]=h[0]*r.resolution,p[1]=h[1]*r.resolution,p[2]=1/p[0],p[3]=1/p[1],x[0]=.5*p[2],x[1]=.5*p[3],x[2]=r.sourceFrame.width*h[2]-.5*p[2],x[3]=r.sourceFrame.height*h[3]-.5*p[3],r.legacy){var b=l.filterArea;b[0]=r.destinationFrame.width,b[1]=r.destinationFrame.height,b[2]=r.sourceFrame.x,b[3]=r.sourceFrame.y,l.filterClamp=l.inputClamp}this.globalUniforms.update();var w=e[e.length-1];if(r.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,r.renderTexture,w.renderTexture,wt.BLEND,r),this.returnFilterTexture(r.renderTexture);else{var R=r.renderTexture,H=this.getOptimalFilterTexture(R.width,R.height,r.resolution);H.filterFrame=R.filterFrame;var z=0;for(z=0;z<s.length-1;++z){s[z].apply(this,R,H,wt.CLEAR,r);var q=R;R=H,H=q}s[z].apply(this,R,w.renderTexture,wt.BLEND,r),this.returnFilterTexture(R),this.returnFilterTexture(H)}r.clear(),this.statePool.push(r)},n.prototype.bindAndClear=function(e,r){r===void 0&&(r=wt.CLEAR);var s=this.renderer,l=s.renderTexture,h=s.state;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e&&e.filterFrame){var p=this.tempRect;p.x=0,p.y=0,p.width=e.filterFrame.width,p.height=e.filterFrame.height,l.bind(e,e.filterFrame,p)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?l.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var x=1&h.stateId||this.forceClear;(r===wt.CLEAR||r===wt.BLIT&&x)&&this.renderer.framebuffer.clear(0,0,0,0)},n.prototype.applyFilter=function(e,r,s,l){var h=this.renderer;h.state.set(e.state),this.bindAndClear(s,l),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,h.shader.bind(e),e.legacy?(this.quadUv.map(r._frame,r.filterFrame),h.geometry.bind(this.quadUv),h.geometry.draw(_i.TRIANGLES)):(h.geometry.bind(this.quad),h.geometry.draw(_i.TRIANGLE_STRIP))},n.prototype.calculateSpriteMatrix=function(e,r){var s=this.activeState,l=s.sourceFrame,h=s.destinationFrame,p=r._texture.orig,x=e.set(h.width,0,0,h.height,l.x,l.y),b=r.worldTransform.copyTo(li.TEMP_MATRIX);return b.invert(),x.prepend(b),x.scale(1/p.width,1/p.height),x.translate(r.anchor.x,r.anchor.y),x},n.prototype.destroy=function(){this.texturePool.clear(!1)},n.prototype.getOptimalFilterTexture=function(e,r,s){return s===void 0&&(s=1),this.texturePool.getOptimalTexture(e,r,s)},n.prototype.getFilterTexture=function(e,r){if(typeof e=="number"){var s=e;e=r,r=s}e=e||this.activeState.renderTexture;var l=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution);return l.filterFrame=e.filterFrame,l},n.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},n.prototype.emptyPool=function(){this.texturePool.clear(!0)},n.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},n.prototype.transformAABB=function(e,r){var s=Hi[0],l=Hi[1],h=Hi[2],p=Hi[3];s.set(r.left,r.top),l.set(r.left,r.bottom),h.set(r.right,r.top),p.set(r.right,r.bottom),e.apply(s,s),e.apply(l,l),e.apply(h,h),e.apply(p,p);var x=Math.min(s.x,l.x,h.x,p.x),b=Math.min(s.y,l.y,h.y,p.y),w=Math.max(s.x,l.x,h.x,p.x),R=Math.max(s.y,l.y,h.y,p.y);r.x=x,r.y=b,r.width=w-x,r.height=R-b},n.prototype.roundFrame=function(e,r,s,l,h){if(h){var p=h.a,x=h.b,b=h.c,w=h.d;if(!(x===0&&b===0||p===0&&w===0))return}(h=h?fh.copyFrom(h):fh.identity()).translate(-s.x,-s.y).scale(l.width/s.width,l.height/s.height).translate(l.x,l.y),this.transformAABB(h,e),e.ceil(r),this.transformAABB(h.invert(),e)},n}(Ao),ci=function(){function o(n){this.renderer=n}return o.prototype.flush=function(){},o.prototype.destroy=function(){this.renderer=null},o.prototype.start=function(){},o.prototype.stop=function(){this.flush()},o.prototype.render=function(n){},o}(),Ji=function(o){function n(e){var r=o.call(this,e)||this;return r.emptyRenderer=new ci(e),r.currentRenderer=r.emptyRenderer,r}return en(n,o),n.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},n.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},n.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},n.prototype.copyBoundTextures=function(e,r){for(var s=this.renderer.texture.boundTextures,l=r-1;l>=0;--l)e[l]=s[l]||null,e[l]&&(e[l]._batchLocation=l)},n.prototype.boundArray=function(e,r,s,l){for(var h=e.elements,p=e.ids,x=e.count,b=0,w=0;w<x;w++){var R=h[w],H=R._batchLocation;if(H>=0&&H<l&&r[H]===R)p[w]=H;else for(;b<l;){var z=r[b];if(!z||z._batchEnabled!==s||z._batchLocation!==b){p[w]=b,R._batchLocation=b,r[b]=R;break}b++}}},n}(Ao),xd=0,cc=function(o){function n(e){var r=o.call(this,e)||this;return r.webGLVersion=1,r.extensions={},r.supports={uint32Indices:!1},r.handleContextLost=r.handleContextLost.bind(r),r.handleContextRestored=r.handleContextRestored.bind(r),e.view.addEventListener("webglcontextlost",r.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",r.handleContextRestored,!1),r}return en(n,o),Object.defineProperty(n.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),n.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=xd++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},n.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=xd++,this.renderer.runners.contextChange.emit(e)},n.prototype.initFromOptions=function(e){var r=this.createContext(this.renderer.view,e);this.initFromContext(r)},n.prototype.createContext=function(e,r){var s;if(Vt.PREFER_ENV>=Fr.WEBGL2&&(s=e.getContext("webgl2",r)),s)this.webGLVersion=2;else if(this.webGLVersion=1,!(s=e.getContext("webgl",r)||e.getContext("experimental-webgl",r)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl},n.prototype.getExtensions=function(){var e=this.gl,r={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})},n.prototype.handleContextLost=function(e){e.preventDefault()},n.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},n.prototype.destroy=function(){var e=this.renderer.view;e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},n.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},n.prototype.validateContext=function(e){var r=e.getContextAttributes(),s="WebGL2RenderingContext"in self&&e instanceof self.WebGL2RenderingContext;s&&(this.webGLVersion=2),r.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var l=s||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=l,l||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},n}(Ao),He=function(o){this.framebuffer=o,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=ne.NONE,this.msaaBuffer=null,this.blitFramebuffer=null},$i=new Ln,oa=function(o){function n(e){var r=o.call(this,e)||this;return r.managedFramebuffers=[],r.unknownFramebuffer=new uc(10,10),r.msaaSamples=null,r}return en(n,o),n.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Ln,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var r=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;Vt.PREFER_ENV===Fr.WEBGL_LEGACY&&(r=null,s=null),r?e.drawBuffers=function(l){return r.drawBuffersWEBGL(l)}:(this.hasMRT=!1,e.drawBuffers=function(){}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},n.prototype.bind=function(e,r){var s=this.gl;if(e){var l=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,s.bindFramebuffer(s.FRAMEBUFFER,l.framebuffer)),l.dirtyId!==e.dirtyId&&(l.dirtyId=e.dirtyId,l.dirtyFormat!==e.dirtyFormat?(l.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)):l.dirtySize!==e.dirtySize&&(l.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var h=0;h<e.colorTextures.length;h++){var p=e.colorTextures[h];this.renderer.texture.unbind(p.parentTextureArray||p)}e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},n.prototype.setViewport=function(e,r,s,l){var h=this.viewport;h.width===s&&h.height===l&&h.x===e&&h.y===r||(h.x=e,h.y=r,h.width=s,h.height=l,this.gl.viewport(e,r,s,l))},Object.defineProperty(n.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),n.prototype.clear=function(e,r,s,l,h){h===void 0&&(h=_s.COLOR|_s.DEPTH);var p=this.gl;p.clearColor(e,r,s,l),p.clear(h)},n.prototype.initFramebuffer=function(e){var r=this.gl,s=new He(r.createFramebuffer());return s.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(e),e.disposeRunner.add(this),s},n.prototype.resizeFramebuffer=function(e){var r=this.gl,s=e.glFramebuffers[this.CONTEXT_UID];s.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,s.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e.width,e.height));for(var l=e.colorTextures,h=0;h<l.length;h++)this.renderer.texture.bind(l[h],0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},n.prototype.updateFramebuffer=function(e){var r=this.gl,s=e.glFramebuffers[this.CONTEXT_UID],l=e.colorTextures.length;r.drawBuffers||(l=Math.min(l,1)),s.multisample>1&&(s.msaaBuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,s.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,s.multisample,r.RGBA8,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,s.msaaBuffer));for(var h=[],p=0;p<l;p++)if(!(p===0&&s.multisample>1)){var x=e.colorTextures[p],b=x.parentTextureArray||x;this.renderer.texture.bind(b,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+p,x.target,b._glTextures[this.CONTEXT_UID].texture,0),h.push(r.COLOR_ATTACHMENT0+p)}if(h.length>1&&r.drawBuffers(h),e.depthTexture&&this.writeDepthTexture){var w=e.depthTexture;this.renderer.texture.bind(w,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,w._glTextures[this.CONTEXT_UID].texture,0)}s.stencil||!e.stencil&&!e.depth||(s.stencil=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,s.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e.width,e.height),e.depthTexture||r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,s.stencil))},n.prototype.detectSamples=function(e){var r=this.msaaSamples,s=ne.NONE;if(e<=1||r===null)return s;for(var l=0;l<r.length;l++)if(r[l]<=e){s=r[l];break}return s===1&&(s=ne.NONE),s},n.prototype.blit=function(e,r,s){var l=this.current,h=this.renderer,p=this.gl,x=this.CONTEXT_UID;if(h.context.webGLVersion===2&&l){var b=l.glFramebuffers[x];if(b){if(!e){if(b.multisample<=1)return;b.blitFramebuffer||(b.blitFramebuffer=new uc(l.width,l.height),b.blitFramebuffer.addColorTexture(0,l.colorTextures[0])),(e=b.blitFramebuffer).width=l.width,e.height=l.height}r||((r=$i).width=l.width,r.height=l.height),s||(s=r);var w=r.width===s.width&&r.height===s.height;this.bind(e),p.bindFramebuffer(p.READ_FRAMEBUFFER,b.framebuffer),p.blitFramebuffer(r.x,r.y,r.width,r.height,s.x,s.y,s.width,s.height,p.COLOR_BUFFER_BIT,w?p.NEAREST:p.LINEAR)}}},n.prototype.disposeFramebuffer=function(e,r){var s=e.glFramebuffers[this.CONTEXT_UID],l=this.gl;if(s){delete e.glFramebuffers[this.CONTEXT_UID];var h=this.managedFramebuffers.indexOf(e);h>=0&&this.managedFramebuffers.splice(h,1),e.disposeRunner.remove(this),r||(l.deleteFramebuffer(s.framebuffer),s.stencil&&l.deleteRenderbuffer(s.stencil))}},n.prototype.disposeAll=function(e){var r=this.managedFramebuffers;this.managedFramebuffers=[];for(var s=0;s<r.length;s++)this.disposeFramebuffer(r[s],e)},n.prototype.forceStencil=function(){var e=this.current;if(e){var r=e.glFramebuffers[this.CONTEXT_UID];if(r&&!r.stencil){e.enableStencil();var s=e.width,l=e.height,h=this.gl,p=h.createRenderbuffer();h.bindRenderbuffer(h.RENDERBUFFER,p),h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_STENCIL,s,l),r.stencil=p,h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.RENDERBUFFER,p)}}},n.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Ln},n}(Ao),zs=function(o){this.buffer=o||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},ph={5126:4,5123:2,5121:1},ii=function(o){function n(e){var r=o.call(this,e)||this;return r._activeGeometry=null,r._activeVao=null,r.hasVao=!0,r.hasInstance=!0,r.canUseUInt32ElementIndex=!1,r.managedGeometries={},r.managedBuffers={},r}return en(n,o),n.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){var s=this.renderer.context.extensions.vertexArrayObject;Vt.PREFER_ENV===Fr.WEBGL_LEGACY&&(s=null),s?(e.createVertexArray=function(){return s.createVertexArrayOES()},e.bindVertexArray=function(h){return s.bindVertexArrayOES(h)},e.deleteVertexArray=function(h){return s.deleteVertexArrayOES(h)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(r.webGLVersion!==2){var l=e.getExtension("ANGLE_instanced_arrays");l?(e.vertexAttribDivisor=function(h,p){return l.vertexAttribDivisorANGLE(h,p)},e.drawElementsInstanced=function(h,p,x,b,w){return l.drawElementsInstancedANGLE(h,p,x,b,w)},e.drawArraysInstanced=function(h,p,x,b){return l.drawArraysInstancedANGLE(h,p,x,b)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex},n.prototype.bind=function(e,r){r=r||this.renderer.shader.shader;var s=this.gl,l=e.glVertexArrayObjects[this.CONTEXT_UID],h=!1;l||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=l={},h=!0);var p=l[r.program.id]||this.initGeometryVao(e,r.program,h);this._activeGeometry=e,this._activeVao!==p&&(this._activeVao=p,this.hasVao?s.bindVertexArray(p):this.activateVao(e,r.program)),this.updateBuffers()},n.prototype.reset=function(){this.unbind()},n.prototype.updateBuffers=function(){for(var e=this._activeGeometry,r=this.gl,s=0;s<e.buffers.length;s++){var l=e.buffers[s],h=l._glBuffers[this.CONTEXT_UID];if(l._updateID!==h.updateID){h.updateID=l._updateID;var p=l.index?r.ELEMENT_ARRAY_BUFFER:r.ARRAY_BUFFER;if(r.bindBuffer(p,h.buffer),this._boundBuffer=h,h.byteLength>=l.data.byteLength)r.bufferSubData(p,0,l.data);else{var x=l.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;h.byteLength=l.data.byteLength,r.bufferData(p,l.data,x)}}}},n.prototype.checkCompatibility=function(e,r){var s=e.attributes,l=r.attributeData;for(var h in l)if(!s[h])throw new Error('shader and geometry incompatible, geometry missing the "'+h+'" attribute')},n.prototype.getSignature=function(e,r){var s=e.attributes,l=r.attributeData,h=["g",e.id];for(var p in s)l[p]&&h.push(p);return h.join("-")},n.prototype.initGeometryVao=function(e,r,s){s===void 0&&(s=!0),this.checkCompatibility(e,r);var l=this.gl,h=this.CONTEXT_UID,p=this.getSignature(e,r),x=e.glVertexArrayObjects[this.CONTEXT_UID],b=x[p];if(b)return x[r.id]=b,b;var w=e.buffers,R=e.attributes,H={},z={};for(var q in w)H[q]=0,z[q]=0;for(var q in R)!R[q].size&&r.attributeData[q]?R[q].size=r.attributeData[q].size:R[q].size||console.warn("PIXI Geometry attribute '"+q+"' size cannot be determined (likely the bound shader does not have the attribute)"),H[R[q].buffer]+=R[q].size*ph[R[q].type];for(var q in R){var at=R[q],_t=at.size;at.stride===void 0&&(H[at.buffer]===_t*ph[at.type]?at.stride=0:at.stride=H[at.buffer]),at.start===void 0&&(at.start=z[at.buffer],z[at.buffer]+=_t*ph[at.type])}b=l.createVertexArray(),l.bindVertexArray(b);for(var bt=0;bt<w.length;bt++){var zt=w[bt];zt._glBuffers[h]||(zt._glBuffers[h]=new zs(l.createBuffer()),this.managedBuffers[zt.id]=zt,zt.disposeRunner.add(this)),s&&zt._glBuffers[h].refCount++}return this.activateVao(e,r),this._activeVao=b,x[r.id]=b,x[p]=b,b},n.prototype.disposeBuffer=function(e,r){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var s=e._glBuffers[this.CONTEXT_UID],l=this.gl;e.disposeRunner.remove(this),s&&(r||l.deleteBuffer(s.buffer),delete e._glBuffers[this.CONTEXT_UID])}},n.prototype.disposeGeometry=function(e,r){if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var s=e.glVertexArrayObjects[this.CONTEXT_UID],l=this.gl,h=e.buffers;if(e.disposeRunner.remove(this),s){for(var p=0;p<h.length;p++){var x=h[p]._glBuffers[this.CONTEXT_UID];x.refCount--,x.refCount!==0||r||this.disposeBuffer(h[p],r)}if(!r){for(var b in s)if(b[0]==="g"){var w=s[b];this._activeVao===w&&this.unbind(),l.deleteVertexArray(w)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},n.prototype.disposeAll=function(e){for(var r=Object.keys(this.managedGeometries),s=0;s<r.length;s++)this.disposeGeometry(this.managedGeometries[r[s]],e);for(r=Object.keys(this.managedBuffers),s=0;s<r.length;s++)this.disposeBuffer(this.managedBuffers[r[s]],e)},n.prototype.activateVao=function(e,r){var s=this.gl,l=this.CONTEXT_UID,h=e.buffers,p=e.attributes;e.indexBuffer&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.indexBuffer._glBuffers[l].buffer);var x=null;for(var b in p){var w=p[b],R=h[w.buffer]._glBuffers[l];if(r.attributeData[b]){x!==R&&(s.bindBuffer(s.ARRAY_BUFFER,R.buffer),x=R);var H=r.attributeData[b].location;if(s.enableVertexAttribArray(H),s.vertexAttribPointer(H,w.size,w.type||s.FLOAT,w.normalized,w.stride,w.start),w.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");s.vertexAttribDivisor(H,1)}}}},n.prototype.draw=function(e,r,s,l){var h=this.gl,p=this._activeGeometry;if(p.indexBuffer){var x=p.indexBuffer.data.BYTES_PER_ELEMENT,b=x===2?h.UNSIGNED_SHORT:h.UNSIGNED_INT;x===2||x===4&&this.canUseUInt32ElementIndex?p.instanced?h.drawElementsInstanced(e,r||p.indexBuffer.data.length,b,(s||0)*x,l||1):h.drawElements(e,r||p.indexBuffer.data.length,b,(s||0)*x):console.warn("unsupported index buffer type: uint32")}else p.instanced?h.drawArraysInstanced(e,s,r||p.getSize(),l||1):h.drawArrays(e,s,r||p.getSize());return this},n.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},n}(Ao),su=function(){function o(n){n===void 0&&(n=null),this.type=Ut.NONE,this.autoDetect=!0,this.maskObject=n||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return o.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Ut.NONE,this.autoDetect=!0),this._target=null},o.prototype.copyCountersOrReset=function(n){n?(this._stencilCounter=n._stencilCounter,this._scissorCounter=n._scissorCounter,this._scissorRect=n._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},o}();function Ir(o,n,e){var r=o.createShader(n);return o.shaderSource(r,e),o.compileShader(r),r}function Po(o,n,e,r){var s=Ir(o,o.VERTEX_SHADER,n),l=Ir(o,o.FRAGMENT_SHADER,e),h=o.createProgram();if(o.attachShader(h,s),o.attachShader(h,l),r)for(var p in r)o.bindAttribLocation(h,r[p],p);return o.linkProgram(h),o.getProgramParameter(h,o.LINK_STATUS)||(o.getShaderParameter(s,o.COMPILE_STATUS)||(console.warn(n),console.error(o.getShaderInfoLog(s))),o.getShaderParameter(l,o.COMPILE_STATUS)||(console.warn(e),console.error(o.getShaderInfoLog(l))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",o.getProgramParameter(h,o.VALIDATE_STATUS)),console.error("gl.getError()",o.getError()),o.getProgramInfoLog(h)!==""&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",o.getProgramInfoLog(h)),o.deleteProgram(h),h=null),o.deleteShader(s),o.deleteShader(l),h}function Ia(o){for(var n=new Array(o),e=0;e<n.length;e++)n[e]=!1;return n}function dc(o,n){switch(o){case"float":return 0;case"vec2":return new Float32Array(2*n);case"vec3":return new Float32Array(3*n);case"vec4":return new Float32Array(4*n);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*n);case"ivec3":return new Int32Array(3*n);case"ivec4":return new Int32Array(4*n);case"uvec2":return new Uint32Array(2*n);case"uvec3":return new Uint32Array(3*n);case"uvec4":return new Uint32Array(4*n);case"bool":return!1;case"bvec2":return Ia(2*n);case"bvec3":return Ia(3*n);case"bvec4":return Ia(4*n);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Xi,mt={},Cu=mt;function bd(){if(Cu===mt||Cu&&Cu.isContextLost()){var o=document.createElement("canvas"),n=void 0;Vt.PREFER_ENV>=Fr.WEBGL2&&(n=o.getContext("webgl2",{})),n||((n=o.getContext("webgl",{})||o.getContext("experimental-webgl",{}))?n.getExtension("WEBGL_draw_buffers"):n=null),Cu=n}return Cu}function co(o,n,e){if(o.substring(0,9)!=="precision"){var r=n;return n===St.HIGH&&e!==St.HIGH&&(r=St.MEDIUM),"precision "+r+` float;
`+o}return e!==St.HIGH&&o.substring(0,15)==="precision highp"?o.replace("precision highp","precision mediump"):o}var is={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Al(o){return is[o]}var nt=null,xs={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function sa(o,n){if(!nt){var e=Object.keys(xs);nt={};for(var r=0;r<e.length;++r){var s=e[r];nt[o[s]]=xs[s]}}return nt[n]}var qi=[{test:function(o){return o.type==="float"&&o.size===1},code:function(o){return`
            if(uv["`+o+'"] !== ud["'+o+`"].value)
            {
                ud["`+o+'"].value = uv["'+o+`"]
                gl.uniform1f(ud["`+o+'"].location, uv["'+o+`"])
            }
            `}},{test:function(o){return(o.type==="sampler2D"||o.type==="samplerCube"||o.type==="sampler2DArray")&&o.size===1&&!o.isArray},code:function(o){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+o+`"], t);

            if(ud["`+o+`"].value !== t)
            {
                ud["`+o+`"].value = t;
                gl.uniform1i(ud["`+o+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(o,n){return o.type==="mat3"&&o.size===1&&n.a!==void 0},code:function(o){return`
            gl.uniformMatrix3fv(ud["`+o+'"].location, false, uv["'+o+`"].toArray(true));
            `}},{test:function(o,n){return o.type==="vec2"&&o.size===1&&n.x!==void 0},code:function(o){return`
                cv = ud["`+o+`"].value;
                v = uv["`+o+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+o+`"].location, v.x, v.y);
                }`}},{test:function(o){return o.type==="vec2"&&o.size===1},code:function(o){return`
                cv = ud["`+o+`"].value;
                v = uv["`+o+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+o+`"].location, v[0], v[1]);
                }
            `}},{test:function(o,n){return o.type==="vec4"&&o.size===1&&n.width!==void 0},code:function(o){return`
                cv = ud["`+o+`"].value;
                v = uv["`+o+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+o+`"].location, v.x, v.y, v.width, v.height)
                }`}},{test:function(o){return o.type==="vec4"&&o.size===1},code:function(o){return`
                cv = ud["`+o+`"].value;
                v = uv["`+o+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+o+`"].location, v[0], v[1], v[2], v[3])
                }`}}],lr={float:`
    if(cv !== v)
    {
        cv.v = v;
        gl.uniform1f(location, v)
    }`,vec2:`
    if(cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",uint:"gl.uniform1ui(location, v)",uvec2:"gl.uniform2ui(location, v[0], v[1])",uvec3:"gl.uniform3ui(location, v[0], v[1], v[2])",uvec4:"gl.uniform4ui(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Vo={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},Ki,os=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function aa(o){for(var n="",e=0;e<o;++e)e>0&&(n+=`
else `),e<o-1&&(n+="if(test == "+e+".0){}");return n}function Co(o,n){if(o===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var e=n.createShader(n.FRAGMENT_SHADER);;){var r=os.replace(/%forloop%/gi,aa(o));if(n.shaderSource(e,r),n.compileShader(e),n.getShaderParameter(e,n.COMPILE_STATUS))break;o=o/2|0}return o}var au=0,Ru={},mh=function(){function o(n,e,r){r===void 0&&(r="pixi-shader"),this.id=au++,this.vertexSrc=n||o.defaultVertexSrc,this.fragmentSrc=e||o.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),Ru[r]?(Ru[r]++,r+="-"+Ru[r]):Ru[r]=1,this.vertexSrc="#define SHADER_NAME "+r+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+r+`
`+this.fragmentSrc,this.vertexSrc=co(this.vertexSrc,Vt.PRECISION_VERTEX,St.HIGH),this.fragmentSrc=co(this.fragmentSrc,Vt.PRECISION_FRAGMENT,function(){if(!Xi){Xi=St.MEDIUM;var s=bd();if(s&&s.getShaderPrecisionFormat){var l=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT);Xi=l.precision?St.HIGH:St.MEDIUM}}return Xi}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return o.prototype.extractData=function(n,e){var r=bd();if(r){var s=Po(r,n,e);this.attributeData=this.getAttributeData(s,r),this.uniformData=this.getUniformData(s,r),r.deleteProgram(s)}else this.uniformData={},this.attributeData={}},o.prototype.getAttributeData=function(n,e){for(var r={},s=[],l=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES),h=0;h<l;h++){var p=e.getActiveAttrib(n,h),x=sa(e,p.type),b={type:x,name:p.name,size:Al(x),location:0};r[p.name]=b,s.push(b)}for(s.sort(function(w,R){return w.name>R.name?1:-1}),h=0;h<s.length;h++)s[h].location=h;return r},o.prototype.getUniformData=function(n,e){for(var r={},s=e.getProgramParameter(n,e.ACTIVE_UNIFORMS),l=0;l<s;l++){var h=e.getActiveUniform(n,l),p=h.name.replace(/\[.*?\]$/,""),x=h.name.match(/\[.*?\]$/),b=sa(e,h.type);r[p]={type:b,size:h.size,isArray:x,value:dc(b,h.size)}}return r},Object.defineProperty(o,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(o,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`},enumerable:!1,configurable:!0}),o.from=function(n,e,r){var s=n+e,l=wu[s];return l||(wu[s]=l=new o(n,e,r)),l},o}(),ua=function(){function o(n,e){for(var r in this.program=n,this.uniformGroup=e?e instanceof zo?e:new zo(e):new zo({}),n.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))}return o.prototype.checkUniformExists=function(n,e){if(e.uniforms[n])return!0;for(var r in e.uniforms){var s=e.uniforms[r];if(s.group&&this.checkUniformExists(n,s))return!0}return!1},o.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(o.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),o.from=function(n,e,r){return new o(mh.from(n,e),r)},o}(),bs=function(){function o(){this.data=0,this.blendMode=Fn.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(o.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(n){!!(1&this.data)!==n&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(n){!!(2&this.data)!==n&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(n){!!(4&this.data)!==n&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(n){!!(8&this.data)!==n&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(n){!!(32&this.data)!==n&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(n){!!(16&this.data)!==n&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"blendMode",{get:function(){return this._blendMode},set:function(n){this.blend=n!==Fn.NONE,this._blendMode=n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(n){this.offsets=!!n,this._polygonOffset=n},enumerable:!1,configurable:!0}),o.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},o.for2d=function(){var n=new o;return n.depthTest=!1,n.blend=!0,n},o}(),zi=function(o){function n(e,r,s){var l=this,h=mh.from(e||n.defaultVertexSrc,r||n.defaultFragmentSrc);return(l=o.call(this,h,s)||this).padding=0,l.resolution=Vt.FILTER_RESOLUTION,l.enabled=!0,l.autoFit=!0,l.legacy=!!l.program.attributeData.aTextureCoord,l.state=new bs,l}return en(n,o),n.prototype.apply=function(e,r,s,l,h){e.applyFilter(this,r,s,l)},Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`},enumerable:!1,configurable:!0}),n}(ua),ws=new li,Ss=function(){function o(n,e){this._texture=n,this.mapCoord=new li,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=e===void 0?.5:e,this.isSimple=!1}return Object.defineProperty(o.prototype,"texture",{get:function(){return this._texture},set:function(n){this._texture=n,this._textureID=-1},enumerable:!1,configurable:!0}),o.prototype.multiplyUvs=function(n,e){e===void 0&&(e=n);for(var r=this.mapCoord,s=0;s<n.length;s+=2){var l=n[s],h=n[s+1];e[s]=l*r.a+h*r.c+r.tx,e[s+1]=l*r.b+h*r.d+r.ty}return e},o.prototype.update=function(n){var e=this._texture;if(!e||!e.valid||!n&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var s=e.orig,l=e.trim;l&&(ws.set(s.width/l.width,0,0,s.height/l.height,-l.x/l.width,-l.y/l.height),this.mapCoord.append(ws));var h=e.baseTexture,p=this.uClampFrame,x=this.clampMargin/h.resolution,b=this.clampOffset;return p[0]=(e._frame.x+x+b)/h.width,p[1]=(e._frame.y+x+b)/h.height,p[2]=(e._frame.x+e._frame.width-x+b)/h.width,p[3]=(e._frame.y+e._frame.height-x+b)/h.height,this.uClampOffset[0]=b/h.realWidth,this.uClampOffset[1]=b/h.realHeight,this.isSimple=e._frame.width===h.width&&e._frame.height===h.height&&e.rotate===0,!0},o}(),gh=function(o){function n(e){var r=this,s=new li;return r=o.call(this,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`)||this,e.renderable=!1,r.maskSprite=e,r.maskMatrix=s,r}return en(n,o),n.prototype.apply=function(e,r,s,l){var h=this.maskSprite,p=h._texture;p.valid&&(p.uvMatrix||(p.uvMatrix=new Ss(p,0)),p.uvMatrix.update(),this.uniforms.npmAlpha=p.baseTexture.alphaMode?0:1,this.uniforms.mask=p,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,h).prepend(p.uvMatrix.mapCoord),this.uniforms.alpha=h.worldAlpha,this.uniforms.maskClamp=p.uvMatrix.uClampFrame,e.applyFilter(this,r,s,l))},n}(zi),Wo=function(o){function n(e){var r=o.call(this,e)||this;return r.enableScissor=!0,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return en(n,o),n.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},n.prototype.push=function(e,r){var s=r;if(!s.isMaskData){var l=this.maskDataPool.pop()||new su;l.pooled=!0,l.maskObject=r,s=l}switch(s.autoDetect&&this.detect(s),s.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),s._target=e,s.type){case Ut.SCISSOR:this.maskStack.push(s),this.renderer.scissor.push(s);break;case Ut.STENCIL:this.maskStack.push(s),this.renderer.stencil.push(s);break;case Ut.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s),this.maskStack.push(s)}},n.prototype.pop=function(e){var r=this.maskStack.pop();if(r&&r._target===e){switch(r.type){case Ut.SCISSOR:this.renderer.scissor.pop();break;case Ut.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case Ut.SPRITE:this.popSpriteMask()}r.reset(),r.pooled&&this.maskDataPool.push(r)}},n.prototype.detect=function(e){var r=e.maskObject;if(r.isSprite)e.type=Ut.SPRITE;else if(e.type=Ut.STENCIL,this.enableScissor&&r.isFastRect&&r.isFastRect()){var s=r.worldTransform,l=Math.atan2(s.b,s.a),h=Math.atan2(s.d,s.c);l=Math.round(l*(180/Math.PI)*100),h=((h=Math.round(h*(180/Math.PI)*100)-l)%18e3+18e3)%18e3,(l=(l%9e3+9e3)%9e3)==0&&h===9e3&&(e.type=Ut.SCISSOR)}},n.prototype.pushSpriteMask=function(e){var r=e.maskObject,s=e._target,l=this.alphaMaskPool[this.alphaMaskIndex];l||(l=this.alphaMaskPool[this.alphaMaskIndex]=[new gh(r)]),l[0].resolution=this.renderer.resolution,l[0].maskSprite=r;var h=s.filterArea;s.filterArea=r.getBounds(!0),this.renderer.filter.push(s,l),s.filterArea=h,this.alphaMaskIndex++},n.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},n}(Ao),js=function(o){function n(e){var r=o.call(this,e)||this;return r.maskStack=[],r.glConst=0,r}return en(n,o),n.prototype.getStackLength=function(){return this.maskStack.length},n.prototype.setMaskStack=function(e){var r=this.renderer.gl,s=this.getStackLength();this.maskStack=e;var l=this.getStackLength();l!==s&&(l===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))},n.prototype._useCurrent=function(){},n.prototype.destroy=function(){o.prototype.destroy.call(this),this.maskStack=null},n}(Ao),Vs=function(o){function n(e){var r=o.call(this,e)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return en(n,o),n.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},n.prototype.push=function(e){var r=e.maskObject;r.renderable=!0;var s=e._scissorRect,l=r.getBounds(!0),h=this.renderer.gl;r.renderable=!1,s?l.fit(s):h.enable(h.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=l,this._useCurrent()},n.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},n.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,r=this.renderer.renderTexture.current,s=this.renderer.projection,l=s.transform,h=s.sourceFrame,p=s.destinationFrame,x=r?r.resolution:this.renderer.resolution,b=p.width/h.width,w=p.height/h.height,R=((e.x-h.x)*b+p.x)*x,H=((e.y-h.y)*w+p.y)*x,z=e.width*b*x,q=e.height*w*x;l&&(R+=l.tx*x,H+=l.ty*x),r||(H=this.renderer.height-q-H),this.renderer.gl.scissor(R,H,z,q)},n}(js),fo=function(o){function n(e){var r=o.call(this,e)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return en(n,o),n.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},n.prototype.push=function(e){var r=e.maskObject,s=this.renderer.gl,l=e._stencilCounter;l===0&&(this.renderer.framebuffer.forceStencil(),s.enable(s.STENCIL_TEST)),e._stencilCounter++,s.colorMask(!1,!1,!1,!1),s.stencilFunc(s.EQUAL,l,this._getBitwiseMask()),s.stencilOp(s.KEEP,s.KEEP,s.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),this.renderer.framebuffer.blit(),r.renderable=!1,this._useCurrent()},n.prototype.pop=function(e){var r=this.renderer.gl;this.getStackLength()===0?(r.disable(r.STENCIL_TEST),r.clear(r.STENCIL_BUFFER_BIT),r.clearStencil(0)):(r.colorMask(!1,!1,!1,!1),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},n.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},n.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},n}(js),Pl=function(o){function n(e){var r=o.call(this,e)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new li,r.transform=null,r}return en(n,o),n.prototype.update=function(e,r,s,l){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,l),this.transform&&this.projectionMatrix.append(this.transform);var h=this.renderer;h.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,h.globalUniforms.update(),h.shader.shader&&h.shader.syncUniformGroup(h.shader.shader.uniforms.globals)},n.prototype.calculateProjection=function(e,r,s,l){var h=this.projectionMatrix,p=l?-1:1;h.identity(),h.a=1/r.width*2,h.d=p*(1/r.height*2),h.tx=-1-r.x*h.a,h.ty=-p-r.y*h.d},n.prototype.setTransform=function(e){},n}(Ao),Ro=new Ln,Tn=new Ln,Io=function(o){function n(e){var r=o.call(this,e)||this;return r.clearColor=e._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new Ln,r.destinationFrame=new Ln,r.viewportFrame=new Ln,r}return en(n,o),n.prototype.bind=function(e,r,s){e===void 0&&(e=null);var l,h,p,x=this.renderer;this.current=e,e?(p=(l=e.baseTexture).resolution,r||(Ro.width=e.frame.width,Ro.height=e.frame.height,r=Ro),s||(Tn.x=e.frame.x,Tn.y=e.frame.y,Tn.width=r.width,Tn.height=r.height,s=Tn),h=l.framebuffer):(p=x.resolution,r||(Ro.width=x.screen.width,Ro.height=x.screen.height,r=Ro),s||((s=Ro).width=r.width,s.height=r.height));var b=this.viewportFrame;b.x=s.x*p,b.y=s.y*p,b.width=s.width*p,b.height=s.height*p,e||(b.y=x.view.height-(b.y+b.height)),this.renderer.framebuffer.bind(h,b),this.renderer.projection.update(s,r,p,!h),e?this.renderer.mask.setMaskStack(l.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(s)},n.prototype.clear=function(e,r){e=this.current?e||this.current.baseTexture.clearColor:e||this.clearColor;var s=this.destinationFrame,l=this.current?this.current.baseTexture:this.renderer.screen,h=s.width!==l.width||s.height!==l.height;if(h){var p=this.viewportFrame,x=p.x,b=p.y,w=p.width,R=p.height;this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(x,b,w,R)}this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],r),h&&this.renderer.scissor.pop()},n.prototype.resize=function(){this.bind(null)},n.prototype.reset=function(){this.bind(null)},n}(Ao),Ts=function(){},vf=function(){function o(n,e){this.program=n,this.uniformData=e,this.uniformGroups={}}return o.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},o}(),fc=0,la={textureCount:0},Li=function(o){function n(e){var r=o.call(this,e)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=fc++,r}return en(n,o),n.prototype.systemCheck=function(){if(!function(){if(typeof Ki=="boolean")return Ki;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");Ki=e({a:"b"},"a","b")===!0}catch{Ki=!1}return Ki}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},n.prototype.contextChange=function(e){this.gl=e,this.reset()},n.prototype.bind=function(e,r){e.uniforms.globals=this.renderer.globalUniforms;var s=e.program,l=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(e);return this.shader=e,this.program!==s&&(this.program=s,this.gl.useProgram(l.program)),r||(la.textureCount=0,this.syncUniformGroup(e.uniformGroup,la)),l},n.prototype.setUniforms=function(e){var r=this.shader.program,s=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(s.uniformData,e,this.renderer)},n.prototype.syncUniformGroup=function(e,r){var s=this.getglProgram();e.static&&e.dirtyId===s.uniformGroups[e.id]||(s.uniformGroups[e.id]=e.dirtyId,this.syncUniforms(e,s,r))},n.prototype.syncUniforms=function(e,r,s){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,s)},n.prototype.createSyncGroups=function(e){var r=this.getSignature(e,this.shader.program.uniformData);return this.cache[r]||(this.cache[r]=function(s,l){var h=[`
        var v = null;
        var cv = null
        var t = 0;
        var gl = renderer.gl
    `];for(var p in s.uniforms){var x=l[p];if(x){for(var b=s.uniforms[p],w=!1,R=0;R<qi.length;R++)if(qi[R].test(x,b)){h.push(qi[R].code(p,b)),w=!0;break}if(!w){var H=(x.size===1?lr:Vo)[x.type].replace("location",'ud["'+p+'"].location');h.push(`
            cv = ud["`+p+`"].value;
            v = uv["`+p+`"];
            `+H+";")}}else s.uniforms[p].group&&h.push(`
                    renderer.shader.syncUniformGroup(uv["`+p+`"], syncData);
                `)}return new Function("ud","uv","renderer","syncData",h.join(`
`))}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]},n.prototype.getSignature=function(e,r){var s=e.uniforms,l=[];for(var h in s)l.push(h),r[h]&&l.push(r[h].type);return l.join("-")},n.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},n.prototype.generateShader=function(e){var r=this.gl,s=e.program,l={};for(var h in s.attributeData)l[h]=s.attributeData[h].location;var p=Po(r,s.vertexSrc,s.fragmentSrc,l),x={};for(var h in s.uniformData){var b=s.uniformData[h];x[h]={location:r.getUniformLocation(p,h),value:dc(b.type,b.size)}}var w=new vf(p,x);return s.glPrograms[this.renderer.CONTEXT_UID]=w,w},n.prototype.reset=function(){this.program=null,this.shader=null},n.prototype.destroy=function(){this.destroyed=!0},n}(Ao),po=function(o){function n(e){var r=o.call(this,e)||this;return r.gl=null,r.stateId=0,r.polygonOffset=0,r.blendMode=Fn.NONE,r._blendEq=!1,r.map=[],r.map[0]=r.setBlend,r.map[1]=r.setOffset,r.map[2]=r.setCullFace,r.map[3]=r.setDepthTest,r.map[4]=r.setFrontFace,r.map[5]=r.setDepthMask,r.checks=[],r.defaultState=new bs,r.defaultState.blend=!0,r}return en(n,o),n.prototype.contextChange=function(e){this.gl=e,this.blendModes=function(r,s){return s===void 0&&(s=[]),s[Fn.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.ADD]=[r.ONE,r.ONE],s[Fn.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.NONE]=[0,0],s[Fn.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],s[Fn.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Fn.SRC_IN]=[r.DST_ALPHA,r.ZERO],s[Fn.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],s[Fn.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],s[Fn.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],s[Fn.DST_IN]=[r.ZERO,r.SRC_ALPHA],s[Fn.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],s[Fn.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],s[Fn.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],s[Fn.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],s}(e),this.set(this.defaultState),this.reset()},n.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var r=this.stateId^e.data,s=0;r;)1&r&&this.map[s].call(this,!!(e.data&1<<s)),r>>=1,s++;this.stateId=e.data}for(s=0;s<this.checks.length;s++)this.checks[s](this,e)},n.prototype.forceState=function(e){e=e||this.defaultState;for(var r=0;r<this.map.length;r++)this.map[r].call(this,!!(e.data&1<<r));for(r=0;r<this.checks.length;r++)this.checks[r](this,e);this.stateId=e.data},n.prototype.setBlend=function(e){this.updateCheck(n.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},n.prototype.setOffset=function(e){this.updateCheck(n.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},n.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},n.prototype.setDepthMask=function(e){this.gl.depthMask(e)},n.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},n.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},n.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var r=this.blendModes[e],s=this.gl;r.length===2?s.blendFunc(r[0],r[1]):s.blendFuncSeparate(r[0],r[1],r[2],r[3]),r.length===6?(this._blendEq=!0,s.blendEquationSeparate(r[4],r[5])):this._blendEq&&(this._blendEq=!1,s.blendEquationSeparate(s.FUNC_ADD,s.FUNC_ADD))}},n.prototype.setPolygonOffset=function(e,r){this.gl.polygonOffset(e,r)},n.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},n.prototype.updateCheck=function(e,r){var s=this.checks.indexOf(e);r&&s===-1?this.checks.push(e):r||s===-1||this.checks.splice(s,1)},n.checkBlendMode=function(e,r){e.setBlendMode(r.blendMode)},n.checkPolygonOffset=function(e,r){e.setPolygonOffset(1,r.polygonOffset)},n}(Ao),vh=function(o){function n(e){var r=o.call(this,e)||this;return r.count=0,r.checkCount=0,r.maxIdle=Vt.GC_MAX_IDLE,r.checkCountMax=Vt.GC_MAX_CHECK_COUNT,r.mode=Vt.GC_MODE,r}return en(n,o),n.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Ct.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},n.prototype.run=function(){for(var e=this.renderer.texture,r=e.managedTextures,s=!1,l=0;l<r.length;l++){var h=r[l];!h.framebuffer&&this.count-h.touched>this.maxIdle&&(e.destroyTexture(h,!0),r[l]=null,s=!0)}if(s){var p=0;for(l=0;l<r.length;l++)r[l]!==null&&(r[p++]=r[l]);r.length=p}},n.prototype.unload=function(e){var r=this.renderer.texture,s=e._texture;s&&!s.framebuffer&&r.destroyTexture(s);for(var l=e.children.length-1;l>=0;l--)this.unload(e.children[l])},n}(Ao),Xo=function(o){this.texture=o,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121,this.samplerType=0},Ws=function(o){function n(e){var r=o.call(this,e)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new On,r.hasIntegerTextures=!1,r}return en(n,o),n.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(var s=0;s<r;s++)this.boundTextures[s]=null;this.emptyTextures={};var l=new Xo(e.createTexture());for(e.bindTexture(e.TEXTURE_2D,l.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=l,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Xo(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture),s=0;s<6;s++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);for(e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),s=0;s<this.boundTextures.length;s++)this.bind(null,s)},n.prototype.bind=function(e,r){r===void 0&&(r=0);var s=this.gl;if(e){if((e=e.castToBaseTexture()).parentTextureArray)return;if(e.valid){e.touched=this.renderer.textureGC.count;var l=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,s.activeTexture(s.TEXTURE0+r)),s.bindTexture(e.target,l.texture)),l.dirtyId!==e.dirtyId&&(this.currentLocation!==r&&(this.currentLocation=r,s.activeTexture(s.TEXTURE0+r)),this.updateTexture(e)),this.boundTextures[r]=e}}else this.currentLocation!==r&&(this.currentLocation=r,s.activeTexture(s.TEXTURE0+r)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[r]=null},n.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},n.prototype.unbind=function(e){var r=this.gl,s=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var l=0;l<s.length;l++)s[l]===this.unknownTexture&&this.bind(null,l)}for(l=0;l<s.length;l++)s[l]===e&&(this.currentLocation!==l&&(r.activeTexture(r.TEXTURE0+l),this.currentLocation=l),r.bindTexture(e.target,this.emptyTextures[e.target].texture),s[l]=null)},n.prototype.ensureSamplerType=function(e){var r=this.boundTextures,s=this.hasIntegerTextures,l=this.CONTEXT_UID;if(s)for(var h=e-1;h>=0;--h){var p=r[h];p&&p._glTextures[l].samplerType!==G.FLOAT&&this.renderer.texture.unbind(p)}},n.prototype.initTexture=function(e){var r=new Xo(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r},n.prototype.initTextureType=function(e,r){if(r.internalFormat=e.format,r.type=e.type,this.webGLVersion===2){var s=this.renderer.gl;e.type===s.FLOAT&&e.format===s.RGBA&&(r.internalFormat=s.RGBA32F),e.type===k.HALF_FLOAT&&(r.type=s.HALF_FLOAT),r.type===s.HALF_FLOAT&&e.format===s.RGBA&&(r.internalFormat=s.RGBA16F)}},n.prototype.updateTexture=function(e){var r=e._glTextures[this.CONTEXT_UID];if(r){var s=this.renderer;if(this.initTextureType(e,r),e.resource&&e.resource.upload(s,e,r))r.samplerType!==G.FLOAT&&(this.hasIntegerTextures=!0);else{var l=e.realWidth,h=e.realHeight,p=s.gl;(r.width!==l||r.height!==h||r.dirtyId<0)&&(r.width=l,r.height=h,p.texImage2D(e.target,0,r.internalFormat,l,h,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}},n.prototype.destroyTexture=function(e,r){var s=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),s.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){var l=this.managedTextures.indexOf(e);l!==-1&&Br(this.managedTextures,l,1)}},n.prototype.updateTextureStyle=function(e){var r=e._glTextures[this.CONTEXT_UID];r&&(e.mipmap!==et.POW2&&this.webGLVersion===2||e.isPowerOfTwo?r.mipmap=e.mipmap>=1:r.mipmap=!1,this.webGLVersion===2||e.isPowerOfTwo?r.wrapMode=e.wrapMode:r.wrapMode=K.CLAMP,e.resource&&e.resource.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)},n.prototype.setStyle=function(e,r){var s=this.gl;if(r.mipmap&&e.mipmap!==et.ON_MANUAL&&s.generateMipmap(e.target),s.texParameteri(e.target,s.TEXTURE_WRAP_S,r.wrapMode),s.texParameteri(e.target,s.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,e.scaleMode===st.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);var l=this.renderer.context.extensions.anisotropicFiltering;if(l&&e.anisotropicLevel>0&&e.scaleMode===st.LINEAR){var h=Math.min(e.anisotropicLevel,s.getParameter(l.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(e.target,l.TEXTURE_MAX_ANISOTROPY_EXT,h)}}else s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,e.scaleMode===st.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(e.target,s.TEXTURE_MAG_FILTER,e.scaleMode===st.LINEAR?s.LINEAR:s.NEAREST)},n}(Ao),Iu={__proto__:null,FilterSystem:Pu,BatchSystem:Ji,ContextSystem:cc,FramebufferSystem:oa,GeometrySystem:ii,MaskSystem:Wo,ScissorSystem:Vs,StencilSystem:fo,ProjectionSystem:Pl,RenderTextureSystem:Io,ShaderSystem:Li,StateSystem:po,TextureGCSystem:vh,TextureSystem:Ws},La=new li,pc=function(o){function n(e,r){e===void 0&&(e=lo.UNKNOWN);var s=o.call(this)||this;return r=Object.assign({},Vt.RENDER_OPTIONS,r),s.options=r,s.type=e,s.screen=new Ln(0,0,r.width,r.height),s.view=r.view||document.createElement("canvas"),s.resolution=r.resolution||Vt.RESOLUTION,s.useContextAlpha=r.useContextAlpha,s.autoDensity=!!r.autoDensity,s.preserveDrawingBuffer=r.preserveDrawingBuffer,s.clearBeforeRender=r.clearBeforeRender,s._backgroundColor=0,s._backgroundColorRgba=[0,0,0,1],s._backgroundColorString="#000000",s.backgroundColor=r.backgroundColor||s._backgroundColor,s.backgroundAlpha=r.backgroundAlpha,r.transparent!==void 0&&(ea("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),s.useContextAlpha=r.transparent,s.backgroundAlpha=r.transparent?0:1),s._lastObjectRendered=null,s.plugins={},s}return en(n,o),n.prototype.initPlugins=function(e){for(var r in e)this.plugins[r]=new e[r](this)},Object.defineProperty(n.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),n.prototype.resize=function(e,r){this.screen.width=e,this.screen.height=r,this.view.width=e*this.resolution,this.view.height=r*this.resolution,this.autoDensity&&(this.view.style.width=e+"px",this.view.style.height=r+"px"),this.emit("resize",e,r)},n.prototype.generateTexture=function(e,r,s,l){(l=l||e.getLocalBounds(null,!0)).width===0&&(l.width=1),l.height===0&&(l.height=1);var h=Zi.create({width:0|l.width,height:0|l.height,scaleMode:r,resolution:s});return La.tx=-l.x,La.ty=-l.y,this.render(e,{renderTexture:h,clear:!1,transform:La,skipUpdateTransform:!!e.parent}),h},n.prototype.destroy=function(e){for(var r in this.plugins)this.plugins[r].destroy(),this.plugins[r]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=lo.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=Nt(e),Jt(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(e){this._backgroundColorRgba[3]=e},enumerable:!1,configurable:!0}),n}(We.a),Zr=function(o){function n(e){var r=o.call(this,lo.WEBGL,e)||this;return e=r.options,r.gl=null,r.CONTEXT_UID=0,r.runners={destroy:new Gt("destroy"),contextChange:new Gt("contextChange"),reset:new Gt("reset"),update:new Gt("update"),postrender:new Gt("postrender"),prerender:new Gt("prerender"),resize:new Gt("resize")},r.globalUniforms=new zo({projectionMatrix:new li},!0),r.addSystem(Wo,"mask").addSystem(cc,"context").addSystem(po,"state").addSystem(Li,"shader").addSystem(Ws,"texture").addSystem(ii,"geometry").addSystem(oa,"framebuffer").addSystem(Vs,"scissor").addSystem(fo,"stencil").addSystem(Pl,"projection").addSystem(vh,"textureGC").addSystem(Pu,"filter").addSystem(Io,"renderTexture").addSystem(Ji,"batch"),r.initPlugins(n.__plugins),e.context?r.context.initFromContext(e.context):r.context.initFromOptions({alpha:!!r.useContextAlpha,antialias:e.antialias,premultipliedAlpha:r.useContextAlpha&&r.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:r.options.powerPreference}),r.renderingToScreen=!0,Sa(r.context.webGLVersion===2?"WebGL 2":"WebGL 1"),r.resize(r.options.width,r.options.height),r}return en(n,o),n.create=function(e){if(ml())return new n(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},n.prototype.addSystem=function(e,r){r||(r=e.name);var s=new e(this);if(this[r])throw new Error('Whoops! The name "'+r+'" is already in use');for(var l in this[r]=s,this.runners)this.runners[l].add(s);return this},n.prototype.render=function(e,r){var s,l,h,p;if(r&&(r instanceof Zi?(ea("6.0.0","Renderer#render arguments changed, use options instead."),s=r,l=arguments[2],h=arguments[3],p=arguments[4]):(s=r.renderTexture,l=r.clear,h=r.transform,p=r.skipUpdateTransform)),this.renderingToScreen=!s,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=h,!this.context.isLost){if(s||(this._lastObjectRendered=e),!p){var x=e.enableTempParent();e.updateTransform(),e.disableTempParent(x)}this.renderTexture.bind(s),this.batch.currentRenderer.start(),(l!==void 0?l:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),s&&s.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},n.prototype.resize=function(e,r){o.prototype.resize.call(this,e,r),this.runners.resize.emit(e,r)},n.prototype.reset=function(){return this.runners.reset.emit(),this},n.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},n.prototype.destroy=function(e){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();o.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(n.prototype,"extract",{get:function(){return ea("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),n.registerPlugin=function(e,r){n.__plugins=n.__plugins||{},n.__plugins[e]=r},n}(pc);function Es(o){return Zr.create(o)}var _h=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Lu=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Cl=function(){this.texArray=null,this.blend=0,this.type=_i.TRIANGLES,this.start=0,this.size=0,this.data=null},uu=function(){function o(){this.elements=[],this.ids=[],this.count=0}return o.prototype.clear=function(){for(var n=0;n<this.count;n++)this.elements[n]=null;this.count=0},o}(),Rl=function(){function o(n){typeof n=="number"?this.rawBinaryData=new ArrayBuffer(n):n instanceof Uint8Array?this.rawBinaryData=n.buffer:this.rawBinaryData=n,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(o.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),o.prototype.view=function(n){return this[n+"View"]},o.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},o.sizeOf=function(n){switch(n){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(n+" isn't a valid view type")}},o}(),Ou=function(o){function n(e){var r=o.call(this,e)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=bs.for2d(),r.size=4*Vt.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),e.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return en(n,o),n.prototype.contextChange=function(){var e=this.renderer.gl;Vt.PREFER_ENV===Fr.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Vt.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=Co(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()},n.prototype.initFlushBuffers=function(){for(var e=n._drawCallPool,r=n._textureArrayPool,s=this.size/4,l=Math.floor(s/this.MAX_TEXTURES)+1;e.length<s;)e.push(new Cl);for(;r.length<l;)r.push(new uu);for(var h=0;h<this.MAX_TEXTURES;h++)this._tempBoundTextures[h]=null},n.prototype.onPrerender=function(){this._flushId=0},n.prototype.render=function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},n.prototype.buildTexturesAndDrawCalls=function(){var e=this._bufferedTextures,r=this.MAX_TEXTURES,s=n._textureArrayPool,l=this.renderer.batch,h=this._tempBoundTextures,p=this.renderer.textureGC.count,x=++On._globalBatch,b=0,w=s[0],R=0;l.copyBoundTextures(h,r);for(var H=0;H<this._bufferSize;++H){var z=e[H];e[H]=null,z._batchEnabled!==x&&(w.count>=r&&(l.boundArray(w,h,x,r),this.buildDrawCalls(w,R,H),R=H,w=s[++b],++x),z._batchEnabled=x,z.touched=p,w.elements[w.count++]=z)}for(w.count>0&&(l.boundArray(w,h,x,r),this.buildDrawCalls(w,R,this._bufferSize),++b,++x),H=0;H<h.length;H++)h[H]=null;On._globalBatch=x},n.prototype.buildDrawCalls=function(e,r,s){var l=this._bufferedElements,h=this._attributeBuffer,p=this._indexBuffer,x=this.vertexSize,b=n._drawCallPool,w=this._dcIndex,R=this._aIndex,H=this._iIndex,z=b[w];z.start=this._iIndex,z.texArray=e;for(var q=r;q<s;++q){var at=l[q],_t=at._texture.baseTexture,bt=Qe[_t.alphaMode?1:0][at.blendMode];l[q]=null,r<q&&z.blend!==bt&&(z.size=H-z.start,r=q,(z=b[++w]).texArray=e,z.start=H),this.packInterleavedGeometry(at,h,p,R,H),R+=at.vertexData.length/2*x,H+=at.indices.length,z.blend=bt}r<s&&(z.size=H-z.start,++w),this._dcIndex=w,this._aIndex=R,this._iIndex=H},n.prototype.bindAndClearTexArray=function(e){for(var r=this.renderer.texture,s=0;s<e.count;s++)r.bind(e.elements[s],e.ids[s]),e.elements[s]=null;e.count=0},n.prototype.updateGeometry=function(){var e=this._packedGeometries,r=this._attributeBuffer,s=this._indexBuffer;Vt.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(s),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(s),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},n.prototype.drawBatches=function(){for(var e=this._dcIndex,r=this.renderer,s=r.gl,l=r.state,h=n._drawCallPool,p=null,x=0;x<e;x++){var b=h[x],w=b.texArray,R=b.type,H=b.size,z=b.start,q=b.blend;p!==w&&(p=w,this.bindAndClearTexArray(w)),this.state.blendMode=q,l.set(this.state),s.drawElements(R,H,s.UNSIGNED_SHORT,2*z)}},n.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},n.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),Vt.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},n.prototype.stop=function(){this.flush()},n.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),o.prototype.destroy.call(this)},n.prototype.getAttributeBuffer=function(e){var r=ir(Math.ceil(e/8)),s=ar(r),l=8*r;this._aBuffers.length<=s&&(this._iBuffers.length=s+1);var h=this._aBuffers[l];return h||(this._aBuffers[l]=h=new Rl(l*this.vertexSize*4)),h},n.prototype.getIndexBuffer=function(e){var r=ir(Math.ceil(e/12)),s=ar(r),l=12*r;this._iBuffers.length<=s&&(this._iBuffers.length=s+1);var h=this._iBuffers[s];return h||(this._iBuffers[s]=h=new Uint16Array(l)),h},n.prototype.packInterleavedGeometry=function(e,r,s,l,h){for(var p=r.uint32View,x=r.float32View,b=l/this.vertexSize,w=e.uvs,R=e.indices,H=e.vertexData,z=e._texture.baseTexture._batchLocation,q=Math.min(e.worldAlpha,1),at=q<1&&e._texture.baseTexture.alphaMode?wn(e._tintRGB,q):e._tintRGB+(255*q<<24),_t=0;_t<H.length;_t+=2)x[l++]=H[_t],x[l++]=H[_t+1],x[l++]=w[_t],x[l++]=w[_t+1],p[l++]=at,x[l++]=z;for(_t=0;_t<R.length;_t++)s[h++]=b+R[_t]},n._drawCallPool=[],n._textureArrayPool=[],n}(ci),yh=function(){function o(n,e){if(this.vertexSrc=n,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return o.prototype.generateShader=function(n){if(!this.programCache[n]){for(var e=new Int32Array(n),r=0;r<n;r++)e[r]=r;this.defaultGroupCache[n]=zo.from({uSamplers:e},!0);var s=this.fragTemplate;s=(s=s.replace(/%count%/gi,""+n)).replace(/%forloop%/gi,this.generateSampleSrc(n)),this.programCache[n]=new mh(this.vertexSrc,s)}var l={tint:new Float32Array([1,1,1,1]),translationMatrix:new li,default:this.defaultGroupCache[n]};return new ua(this.programCache[n],l)},o.prototype.generateSampleSrc=function(n){var e="";e+=`
`,e+=`
`;for(var r=0;r<n;r++)r>0&&(e+=`
else `),r<n-1&&(e+="if(vTextureId < "+r+".5)"),e+=`
{`,e+=`
	color = texture2D(uSamplers[`+r+"], vTextureCoord);",e+=`
}`;return e+=`
`,e+=`
`},o}(),mc=function(o){function n(e){e===void 0&&(e=!1);var r=o.call(this)||this;return r._buffer=new Gi(null,e,!1),r._indexBuffer=new Gi(null,e,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,k.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,k.FLOAT).addAttribute("aColor",r._buffer,4,!0,k.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,k.FLOAT).addIndex(r._indexBuffer),r}return en(n,o),n}(Ho),gc=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,vr=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Ms=function(){function o(){}return o.create=function(n){var e=Object.assign({vertex:gc,fragment:vr,geometryClass:mc,vertexSize:6},n),r=e.vertex,s=e.fragment,l=e.vertexSize,h=e.geometryClass;return function(p){function x(b){var w=p.call(this,b)||this;return w.shaderGenerator=new yh(r,s),w.geometryClass=h,w.vertexSize=l,w}return en(x,p),x}(Ou)},Object.defineProperty(o,"defaultVertexSrc",{get:function(){return gc},enumerable:!1,configurable:!0}),Object.defineProperty(o,"defaultFragmentTemplate",{get:function(){return vr},enumerable:!1,configurable:!0}),o}(),As=Ms.create(),xh={},ha=function(o){Object.defineProperty(xh,o,{get:function(){return ea("6.0.0","PIXI.systems."+o+" has moved to PIXI."+o),mf[o]}})};for(var Oa in mf)ha(Oa);var ca={},wd=function(o){Object.defineProperty(ca,o,{get:function(){return ea("6.0.0","PIXI.resources."+o+" has moved to PIXI."+o),Iu[o]}})};for(var Oa in Iu)wd(Oa);/*!
 * @pixi/app - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var lu=function(){function o(n){var e=this;this.stage=new Wi,n=Object.assign({forceCanvas:!1},n),this.renderer=Es(n),o._plugins.forEach(function(r){r.init.call(e,n)})}return o.registerPlugin=function(n){o._plugins.push(n)},o.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(o.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),o.prototype.destroy=function(n,e){var r=this,s=o._plugins.slice(0);s.reverse(),s.forEach(function(l){l.destroy.call(r)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(n),this.renderer=null},o._plugins=[],o}(),vc=function(){function o(){}return o.init=function(n){var e=this;Object.defineProperty(this,"resizeTo",{set:function(r){self.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(self.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame(function(){return e.resize()}))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var r,s;if(e.cancelResize(),e._resizeTo===self)r=self.innerWidth,s=self.innerHeight;else{var l=e._resizeTo;r=l.clientWidth,s=l.clientHeight}e.renderer.resize(r,s)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=n.resizeTo||null},o.destroy=function(){self.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},o}();lu.registerPlugin(vc);/*!
 * @pixi/extract - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Il=new Ln,bi=function(){function o(n){this.renderer=n}return o.prototype.image=function(n,e,r){var s=new Image;return s.src=this.base64(n,e,r),s},o.prototype.base64=function(n,e,r){return this.canvas(n).toDataURL(e,r)},o.prototype.canvas=function(n){var e,r,s,l=this.renderer,h=!1,p=!1;n&&(n instanceof Zi?s=n:(s=this.renderer.generateTexture(n),p=!0)),s?(e=s.baseTexture.resolution,r=s.frame,h=!1,l.renderTexture.bind(s)):(e=this.renderer.resolution,h=!0,(r=Il).width=this.renderer.width,r.height=this.renderer.height,l.renderTexture.bind(null));var x=Math.floor(r.width*e+1e-4),b=Math.floor(r.height*e+1e-4),w=new gl(x,b,1),R=new Uint8Array(4*x*b),H=l.gl;H.readPixels(r.x*e,r.y*e,x,b,H.RGBA,H.UNSIGNED_BYTE,R);var z=w.context.getImageData(0,0,x,b);if(o.arrayPostDivide(R,z.data),w.context.putImageData(z,0,0),h){var q=new gl(w.width,w.height,1);q.context.scale(1,-1),q.context.drawImage(w.canvas,0,-b),w.destroy(),w=q}return p&&s.destroy(!0),w.canvas},o.prototype.pixels=function(n){var e,r,s,l=this.renderer,h=!1;n&&(n instanceof Zi?s=n:(s=this.renderer.generateTexture(n),h=!0)),s?(e=s.baseTexture.resolution,r=s.frame,l.renderTexture.bind(s)):(e=l.resolution,(r=Il).width=l.width,r.height=l.height,l.renderTexture.bind(null));var p=r.width*e,x=r.height*e,b=new Uint8Array(4*p*x),w=l.gl;return w.readPixels(r.x*e,r.y*e,p,x,w.RGBA,w.UNSIGNED_BYTE,b),h&&s.destroy(!0),o.arrayPostDivide(b,b),b},o.prototype.destroy=function(){this.renderer=null},o.arrayPostDivide=function(n,e){for(var r=0;r<n.length;r+=4){var s=e[r+3]=n[r+3];s!==0?(e[r]=Math.round(Math.min(255*n[r]/s,255)),e[r+1]=Math.round(Math.min(255*n[r+1]/s,255)),e[r+2]=Math.round(Math.min(255*n[r+2]/s,255))):(e[r]=n[r],e[r+1]=n[r+1],e[r+2]=n[r+2])}},o}(),Sd=S(8),ji=S.n(Sd),br=S(2),Qi=S.n(br);/*!
 * resource-loader - v3.0.1
 * https://github.com/pixijs/pixi-sound
 * Compiled Tue, 02 Jul 2019 14:06:18 UTC
 *
 * resource-loader is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */function da(){}function hu(o,n,e,r){var s=0,l=o.length;(function h(p){p||s===l?e&&e(p):r?setTimeout(function(){n(o[s++],h)},1):n(o[s++],h)})()}function _c(o){return function(){if(o===null)throw new Error("Callback was already called.");var n=o;o=null,n.apply(this,arguments)}}function Td(o,n){if(n==null)n=1;else if(n===0)throw new Error("Concurrency must not be zero");var e=0,r={_tasks:[],concurrency:n,saturated:da,unsaturated:da,buffer:n/4,empty:da,drain:da,error:da,started:!1,paused:!1,push:function(h,p){s(h,!1,p)},kill:function(){e=0,r.drain=da,r.started=!1,r._tasks=[]},unshift:function(h,p){s(h,!0,p)},process:function(){for(;!r.paused&&e<r.concurrency&&r._tasks.length;){var h=r._tasks.shift();r._tasks.length===0&&r.empty(),(e+=1)===r.concurrency&&r.saturated(),o(h.data,_c(l(h)))}},length:function(){return r._tasks.length},running:function(){return e},idle:function(){return r._tasks.length+e===0},pause:function(){r.paused!==!0&&(r.paused=!0)},resume:function(){if(r.paused!==!1){r.paused=!1;for(var h=1;h<=r.concurrency;h++)r.process()}}};function s(h,p,x){if(x!=null&&typeof x!="function")throw new Error("task callback must be a function");if(r.started=!0,h==null&&r.idle())setTimeout(function(){return r.drain()},1);else{var b={data:h,callback:typeof x=="function"?x:da};p?r._tasks.unshift(b):r._tasks.push(b),setTimeout(function(){return r.process()},1)}}function l(h){return function(){e-=1,h.callback.apply(h,arguments),arguments[0]!=null&&r.error(arguments[0],h.data),e<=r.concurrency-r.buffer&&r.unsaturated(),r.idle()&&r.drain(),r.process()}}return r}var pn={};function Vi(o,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,r.key,r)}}function Qr(o,n,e){return n&&Vi(o.prototype,n),e&&Vi(o,e),o}var Du=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),hr=null;function Ed(){}var zn=function(){function o(e,r,s){if(typeof e!="string"||typeof r!="string")throw new Error("Both name and url are required for constructing a resource.");s=s||{},this._flags=0,this._setFlag(o.STATUS_FLAGS.DATA_URL,r.indexOf("data:")===0),this.name=e,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=s.crossOrigin===!0?"anonymous":s.crossOrigin,this.timeout=s.timeout||0,this.loadType=s.loadType||this._determineLoadType(),this.xhrType=s.xhrType,this.metadata=s.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=o.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Ed,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Qi.a,this.onProgress=new Qi.a,this.onComplete=new Qi.a,this.onAfterMiddleware=new Qi.a}o.setExtensionLoadType=function(e,r){Lo(o._loadTypeMap,e,r)},o.setExtensionXhrType=function(e,r){Lo(o._xhrTypeMap,e,r)};var n=o.prototype;return n.complete=function(){this._clearEvents(),this._finish()},n.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=o.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},n.load=function(e){var r=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout(function(){return e(r)},1);else switch(e&&this.onComplete.once(e),this._setFlag(o.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),this.crossOrigin!==!1&&typeof this.crossOrigin=="string"||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case o.LOAD_TYPE.IMAGE:this.type=o.TYPE.IMAGE,this._loadElement("image");break;case o.LOAD_TYPE.AUDIO:this.type=o.TYPE.AUDIO,this._loadSourceElement("audio");break;case o.LOAD_TYPE.VIDEO:this.type=o.TYPE.VIDEO,this._loadSourceElement("video");break;case o.LOAD_TYPE.XHR:default:Du&&this.crossOrigin?this._loadXdr():this._loadXhr()}},n._hasFlag=function(e){return(this._flags&e)!=0},n._setFlag=function(e,r){this._flags=r?this._flags|e:this._flags&~e},n._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},n._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(o.STATUS_FLAGS.COMPLETE,!0),this._setFlag(o.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},n._loadElement=function(e){this.metadata.loadElement?this.data=this.metadata.loadElement:e==="image"&&window.Image!==void 0?this.data=new Image:this.data=document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},n._loadSourceElement=function(e){if(this.metadata.loadElement?this.data=this.metadata.loadElement:e==="audio"&&window.Audio!==void 0?this.data=new Audio:this.data=document.createElement(e),this.data!==null){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var r=this.metadata.mimeType,s=0;s<this.url.length;++s)this.data.appendChild(this._createSource(e,this.url[s],Array.isArray(r)?r[s]:r));else{var l=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(l)?l[0]:l))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+e)},n._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===o.XHR_RESPONSE_TYPE.JSON||this.xhrType===o.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=o.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},n._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XDomainRequest;e.timeout=this.timeout||5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXhrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open("GET",this.url,!0),setTimeout(function(){return e.send()},1)},n._createSource=function(e,r,s){s||(s=e+"/"+this._getExtension(r));var l=document.createElement("source");return l.src=r,l.type=s,l},n._onError=function(e){this.abort("Failed to load element using: "+e.target.nodeName)},n._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},n._onTimeout=function(){this.abort("Load timed out.")},n._xhrOnError=function(){var e=this.xhr;this.abort(Xs(e)+" Request failed. Status: "+e.status+', text: "'+e.statusText+'"')},n._xhrOnTimeout=function(){var e=this.xhr;this.abort(Xs(e)+" Request timed out.")},n._xhrOnAbort=function(){var e=this.xhr;this.abort(Xs(e)+" Request was aborted by the user.")},n._xhrOnLoad=function(){var e=this.xhr,r="",s=e.status===void 0?200:e.status;if(e.responseType!==""&&e.responseType!=="text"&&e.responseType!==void 0||(r=e.responseText),s===0&&(r.length>0||e.responseType===o.XHR_RESPONSE_TYPE.BUFFER)?s=200:s===1223&&(s=204),(s/100|0)==2){if(this.xhrType===o.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=o.TYPE.TEXT;else if(this.xhrType===o.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=o.TYPE.JSON}catch(p){return void this.abort("Error trying to parse loaded json: "+p)}else if(this.xhrType===o.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var l=new DOMParser;this.data=l.parseFromString(r,"text/xml")}else{var h=document.createElement("div");h.innerHTML=r,this.data=h}this.type=o.TYPE.XML}catch(p){return void this.abort("Error trying to parse loaded xml: "+p)}else this.data=e.response||r;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},n._determineCrossOrigin=function(e,r){if(e.indexOf("data:")===0)return"";if(window.origin!==window.location.origin)return"anonymous";r=r||window.location,hr||(hr=document.createElement("a")),hr.href=e;var s=!(e=ji()(hr.href,{strictMode:!0})).port&&r.port===""||e.port===r.port,l=e.protocol?e.protocol+":":"";return e.host===r.hostname&&s&&l===r.protocol?"":"anonymous"},n._determineXhrType=function(){return o._xhrTypeMap[this.extension]||o.XHR_RESPONSE_TYPE.TEXT},n._determineLoadType=function(){return o._loadTypeMap[this.extension]||o.LOAD_TYPE.XHR},n._getExtension=function(){var e=this.url,r="";if(this.isDataUrl){var s=e.indexOf("/");r=e.substring(s+1,e.indexOf(";",s))}else{var l=e.indexOf("?"),h=e.indexOf("#"),p=Math.min(l>-1?l:e.length,h>-1?h:e.length);r=(e=e.substring(0,p)).substring(e.lastIndexOf(".")+1)}return r.toLowerCase()},n._getMimeFromXhrType=function(e){switch(e){case o.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case o.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case o.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case o.XHR_RESPONSE_TYPE.JSON:return"application/json";case o.XHR_RESPONSE_TYPE.DEFAULT:case o.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},Qr(o,[{key:"isDataUrl",get:function(){return this._hasFlag(o.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(o.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(o.STATUS_FLAGS.LOADING)}}]),o}();function Lo(o,n,e){n&&n.indexOf(".")===0&&(n=n.substring(1)),n&&(o[n]=e)}function Xs(o){return o.toString().replace("object ","")}zn.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},zn.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},zn.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},zn.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},zn._loadTypeMap={gif:zn.LOAD_TYPE.IMAGE,png:zn.LOAD_TYPE.IMAGE,bmp:zn.LOAD_TYPE.IMAGE,jpg:zn.LOAD_TYPE.IMAGE,jpeg:zn.LOAD_TYPE.IMAGE,tif:zn.LOAD_TYPE.IMAGE,tiff:zn.LOAD_TYPE.IMAGE,webp:zn.LOAD_TYPE.IMAGE,tga:zn.LOAD_TYPE.IMAGE,svg:zn.LOAD_TYPE.IMAGE,"svg+xml":zn.LOAD_TYPE.IMAGE,mp3:zn.LOAD_TYPE.AUDIO,ogg:zn.LOAD_TYPE.AUDIO,wav:zn.LOAD_TYPE.AUDIO,mp4:zn.LOAD_TYPE.VIDEO,webm:zn.LOAD_TYPE.VIDEO},zn._xhrTypeMap={xhtml:zn.XHR_RESPONSE_TYPE.DOCUMENT,html:zn.XHR_RESPONSE_TYPE.DOCUMENT,htm:zn.XHR_RESPONSE_TYPE.DOCUMENT,xml:zn.XHR_RESPONSE_TYPE.DOCUMENT,tmx:zn.XHR_RESPONSE_TYPE.DOCUMENT,svg:zn.XHR_RESPONSE_TYPE.DOCUMENT,tsx:zn.XHR_RESPONSE_TYPE.DOCUMENT,gif:zn.XHR_RESPONSE_TYPE.BLOB,png:zn.XHR_RESPONSE_TYPE.BLOB,bmp:zn.XHR_RESPONSE_TYPE.BLOB,jpg:zn.XHR_RESPONSE_TYPE.BLOB,jpeg:zn.XHR_RESPONSE_TYPE.BLOB,tif:zn.XHR_RESPONSE_TYPE.BLOB,tiff:zn.XHR_RESPONSE_TYPE.BLOB,webp:zn.XHR_RESPONSE_TYPE.BLOB,tga:zn.XHR_RESPONSE_TYPE.BLOB,json:zn.XHR_RESPONSE_TYPE.JSON,text:zn.XHR_RESPONSE_TYPE.TEXT,txt:zn.XHR_RESPONSE_TYPE.TEXT,ttf:zn.XHR_RESPONSE_TYPE.BUFFER,otf:zn.XHR_RESPONSE_TYPE.BUFFER},zn.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var Nu=window.URL||window.webkitURL,Md={caching:function(o,n){var e=this;pn[o.url]?(o.data=pn[o.url],o.complete()):o.onComplete.once(function(){return pn[e.url]=e.data}),n()},parsing:function(o,n){if(o.data){if(o.xhr&&o.xhrType===zn.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&typeof o.data!="string"){if(o.data.type.indexOf("image")===0){var e=Nu.createObjectURL(o.data);return o.blob=o.data,o.data=new Image,o.data.src=e,o.type=zn.TYPE.IMAGE,void(o.data.onload=function(){Nu.revokeObjectURL(e),o.data.onload=null,n()})}}else{var r=o.xhr.getResponseHeader("content-type");if(r&&r.indexOf("image")===0)return o.data=new Image,o.data.src="data:"+r+";base64,"+function(s){for(var l="",h=0;h<s.length;){for(var p=[0,0,0],x=[0,0,0,0],b=0;b<p.length;++b)h<s.length?p[b]=255&s.charCodeAt(h++):p[b]=0;switch(x[0]=p[0]>>2,x[1]=(3&p[0])<<4|p[1]>>4,x[2]=(15&p[1])<<2|p[2]>>6,x[3]=63&p[2],h-(s.length-1)){case 2:x[3]=64,x[2]=64;break;case 1:x[3]=64}for(var w=0;w<x.length;++w)l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(x[w])}return l}(o.xhr.responseText),o.type=zn.TYPE.IMAGE,void(o.data.onload=function(){o.data.onload=null,n()})}n()}else n()}},Fu=/(#[\w-]+)?$/,qs=function(){function o(e,r){var s=this;e===void 0&&(e=""),r===void 0&&(r=10),this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(p,x){return s._loadResource(p,x)},this._queue=Td(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new Qi.a,this.onError=new Qi.a,this.onLoad=new Qi.a,this.onStart=new Qi.a,this.onComplete=new Qi.a;for(var l=0;l<o._defaultBeforeMiddleware.length;++l)this.pre(o._defaultBeforeMiddleware[l]);for(var h=0;h<o._defaultAfterMiddleware.length;++h)this.use(o._defaultAfterMiddleware[h])}var n=o.prototype;return n.add=function(e,r,s,l){if(Array.isArray(e)){for(var h=0;h<e.length;++h)this.add(e[h]);return this}if(typeof e=="object"&&(l=r||e.callback||e.onComplete,s=e,r=e.url,e=e.name||e.key||e.url),typeof r!="string"&&(l=s,s=r,r=e),typeof r!="string")throw new Error("No url passed to add resource to loader.");if(typeof s=="function"&&(l=s,s=null),this.loading&&(!s||!s.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[e])throw new Error('Resource named "'+e+'" already exists.');if(r=this._prepareUrl(r),this.resources[e]=new zn(e,r,s),typeof l=="function"&&this.resources[e].onAfterMiddleware.once(l),this.loading){for(var p=s.parentResource,x=[],b=0;b<p.children.length;++b)p.children[b].isComplete||x.push(p.children[b]);var w=p.progressChunk*(x.length+1)/(x.length+2);p.children.push(this.resources[e]),p.progressChunk=w;for(var R=0;R<x.length;++R)x[R].progressChunk=w;this.resources[e].progressChunk=w}return this._queue.push(this.resources[e]),this},n.pre=function(e){return this._beforeMiddleware.push(e),this},n.use=function(e){return this._afterMiddleware.push(e),this},n.reset=function(){for(var e in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var r=this.resources[e];r._onLoadBinding&&r._onLoadBinding.detach(),r.isLoading&&r.abort()}return this.resources={},this},n.load=function(e){if(typeof e=="function"&&this.onComplete.once(e),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var r=100/this._queue._tasks.length,s=0;s<this._queue._tasks.length;++s)this._queue._tasks[s].data.progressChunk=r;this._onStart(),this._queue.resume()}return this},n._prepareUrl=function(e){var r,s=ji()(e,{strictMode:!0});if(r=s.protocol||!s.path||e.indexOf("//")===0?e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&e.charAt(0)!=="/"?this.baseUrl+"/"+e:this.baseUrl+e,this.defaultQueryString){var l=Fu.exec(r)[0];(r=r.substr(0,r.length-l.length)).indexOf("?")!==-1?r+="&"+this.defaultQueryString:r+="?"+this.defaultQueryString,r+=l}return r},n._loadResource=function(e,r){var s=this;e._dequeue=r,hu(this._beforeMiddleware,function(l,h){l.call(s,e,function(){h(e.isComplete?{}:null)})},function(){e.isComplete?s._onLoad(e):(e._onLoadBinding=e.onComplete.once(s._onLoad,s),e.load())},!0)},n._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},n._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},n._onLoad=function(e){var r=this;e._onLoadBinding=null,this._resourcesParsing.push(e),e._dequeue(),hu(this._afterMiddleware,function(s,l){s.call(r,e,l)},function(){e.onAfterMiddleware.dispatch(e),r.progress=Math.min(100,r.progress+e.progressChunk),r.onProgress.dispatch(r,e),e.error?r.onError.dispatch(e.error,r,e):r.onLoad.dispatch(r,e),r._resourcesParsing.splice(r._resourcesParsing.indexOf(e),1),r._queue.idle()&&r._resourcesParsing.length===0&&r._onComplete()},!0)},Qr(o,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(e){this._queue.concurrency=e}}]),o}();qs._defaultBeforeMiddleware=[],qs._defaultAfterMiddleware=[],qs.pre=function(o){return qs._defaultBeforeMiddleware.push(o),qs},qs.use=function(o){return qs._defaultAfterMiddleware.push(o),qs};/*!
 * @pixi/loaders - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var En=function(o,n){return(En=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},yc=function(){function o(){}return o.add=function(){zn.setExtensionLoadType("svg",zn.LOAD_TYPE.XHR),zn.setExtensionXhrType("svg",zn.XHR_RESPONSE_TYPE.TEXT)},o.use=function(n,e){if(!n.data||n.type!==zn.TYPE.IMAGE&&n.extension!=="svg")e();else{var r=n.data,s=n.url,l=n.name,h=n.metadata;Nn.fromLoader(r,s,l,h).then(function(p){n.texture=p,e()}).catch(e)}},o}(),ss=function(o){function n(e,r){for(var s=o.call(this,e,r)||this,l=0;l<n._plugins.length;++l){var h=n._plugins[l],p=h.pre,x=h.use;p&&s.pre(p),x&&s.use(x)}return s._protected=!1,s}return function(e,r){function s(){this.constructor=e}En(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(n,"shared",{get:function(){var e=n._shared;return e||((e=new n)._protected=!0,n._shared=e),e},enumerable:!1,configurable:!0}),n.registerPlugin=function(e){return n._plugins.push(e),e.add&&e.add(),n},n._plugins=[],n}(qs);ss.registerPlugin({use:Md.parsing}),ss.registerPlugin(yc);var qr,Xn,_f=function(){function o(){}return o.init=function(n){n=Object.assign({sharedLoader:!1},n),this.loader=n.sharedLoader?ss.shared:new ss},o.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},o}(),Vr=zn;(function(o){o[o.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",o[o.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",o[o.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",o[o.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",o[o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",o[o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",o[o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",o[o.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",o[o.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",o[o.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",o[o.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",o[o.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",o[o.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",o[o.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",o[o.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",o[o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",o[o.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",o[o.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",o[o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",o[o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",o[o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",o[o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",o[o.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",o[o.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",o[o.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",o[o.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"})(Xn||(Xn={}));var cu=((qr={})[Xn.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,qr[Xn.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,qr[Xn.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,qr[Xn.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,qr[Xn.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,qr[Xn.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,qr[Xn.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,qr[Xn.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,qr[Xn.COMPRESSED_R11_EAC]=.5,qr[Xn.COMPRESSED_SIGNED_R11_EAC]=.5,qr[Xn.COMPRESSED_RG11_EAC]=1,qr[Xn.COMPRESSED_SIGNED_RG11_EAC]=1,qr[Xn.COMPRESSED_RGB8_ETC2]=.5,qr[Xn.COMPRESSED_RGBA8_ETC2_EAC]=1,qr[Xn.COMPRESSED_SRGB8_ETC2]=.5,qr[Xn.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,qr[Xn.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,qr[Xn.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,qr[Xn.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,qr[Xn.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,qr[Xn.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,qr[Xn.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,qr[Xn.COMPRESSED_RGB_ETC1_WEBGL]=.5,qr[Xn.COMPRESSED_RGB_ATC_WEBGL]=.5,qr[Xn.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,qr[Xn.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,qr),du=function(o,n){return(du=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function xo(o,n){function e(){this.constructor=o}du(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}function Ll(o,n){var e,r,s,l,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(x){return function(b){return function(w){if(e)throw new TypeError("Generator is already executing.");for(;h;)try{if(e=1,r&&(s=2&w[0]?r.return:w[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,w[1])).done)return s;switch(r=0,s&&(w=[2&w[0],s.value]),w[0]){case 0:case 1:s=w;break;case 4:return h.label++,{value:w[1],done:!1};case 5:h.label++,r=w[1],w=[0];continue;case 7:w=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!((s=s.length>0&&s[s.length-1])||w[0]!==6&&w[0]!==2)){h=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){h.label=w[1];break}if(w[0]===6&&h.label<s[1]){h.label=s[1],s=w;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(w);break}s[2]&&h.ops.pop(),h.trys.pop();continue}w=n.call(o,h)}catch(R){w=[6,R],r=0}finally{e=s=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([x,b])}}}var Oi,Dn,xc=function(o){function n(e,r){r===void 0&&(r={width:1,height:1,autoLoad:!0});var s,l,h=this;return typeof e=="string"?(s=e,l=new Uint8Array):(s=null,l=e),(h=o.call(this,l,r)||this).origin=s,h.buffer=l?new Rl(l):null,h.origin&&r.autoLoad!==!1&&h.load(),l&&l.length&&(h.loaded=!0,h.onBlobLoaded(h.buffer.rawBinaryData)),h}return xo(n,o),n.prototype.onBlobLoaded=function(e){},n.prototype.load=function(){return e=this,r=void 0,l=function(){var h;return Ll(this,function(p){switch(p.label){case 0:return[4,fetch(this.origin)];case 1:return[4,p.sent().blob()];case 2:return[4,p.sent().arrayBuffer()];case 3:return h=p.sent(),this.data=new Uint32Array(h),this.buffer=new Rl(h),this.loaded=!0,this.onBlobLoaded(h),this.update(),[2,this]}})},new((s=Promise)||(s=Promise))(function(h,p){function x(R){try{w(l.next(R))}catch(H){p(H)}}function b(R){try{w(l.throw(R))}catch(H){p(H)}}function w(R){R.done?h(R.value):new s(function(H){H(R.value)}).then(x,b)}w((l=l.apply(e,r||[])).next())});var e,r,s,l},n}(hi),Di=function(o){function n(e,r){var s=o.call(this,e,r)||this;return s.format=r.format,s.levels=r.levels||1,s._width=r.width,s._height=r.height,s._extension=n._formatToExtension(s.format),(r.levelBuffers||s.buffer)&&(s._levelBuffers=r.levelBuffers||n._createLevelBuffers(e instanceof Uint8Array?e:s.buffer.uint8View,s.format,s.levels,4,4,s.width,s.height)),s}return xo(n,o),n.prototype.upload=function(e,r,s){var l=e.gl;if(!e.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var h=0,p=this.levels;h<p;h++){var x=this._levelBuffers[h],b=x.levelID,w=x.levelWidth,R=x.levelHeight,H=x.levelBuffer;l.compressedTexImage2D(l.TEXTURE_2D,b,this.format,w,R,0,H)}return!0},n.prototype.onBlobLoaded=function(){this._levelBuffers=n._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},n._formatToExtension=function(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},n._createLevelBuffers=function(e,r,s,l,h,p,x){for(var b=new Array(s),w=e.byteOffset,R=p,H=x,z=R+l-1&~(l-1),q=H+h-1&~(h-1),at=z*q*cu[r],_t=0;_t<s;_t++)b[_t]={levelID:_t,levelWidth:s>1?R:z,levelHeight:s>1?H:q,levelBuffer:new Uint8Array(e.buffer,w,at)},w+=at,at=(z=(R=R>>1||1)+l-1&~(l-1))*(q=(H=H>>1||1)+h-1&~(h-1))*cu[r];return b},n}(xc),as=function(){function o(){}return o.use=function(n,e){var r=n.data;if(n.type===Vr.TYPE.JSON&&r&&r.cacheID&&r.textures){for(var s=r.textures,l=void 0,h=void 0,p=0,x=s.length;p<x;p++){var b=s[p],w=b.src,R=b.format;if(R||(h=w),o.textureFormats[R]){l=w;break}}if(!(l=l||h))return void e(new Error("Cannot load compressed-textures in "+n.url+", make sure you provide a fallback"));if(l===n.url)return void e(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var H={crossOrigin:n.crossOrigin,metadata:n.metadata.imageMetadata,parentResource:n},z=Bo.resolve(n.url.replace(this.baseUrl,""),l),q=r.cacheID;this.add(q,z,H,function(at){if(at.error)e(at.error);else{var _t=at.texture,bt=_t===void 0?null:_t,zt=at.textures,De=zt===void 0?{}:zt;Object.assign(n,{texture:bt,textures:De}),e()}})}else e()},o.add=function(){var n=document.createElement("canvas").getContext("webgl");if(n){var e={s3tc:n.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:n.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:n.getExtension("WEBGL_compressed_texture_etc"),etc1:n.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:n.getExtension("WEBGL_compressed_texture_atc"),astc:n.getExtension("WEBGL_compressed_texture_astc")};for(var r in o.textureExtensions=e,o.textureFormats={},e){var s=e[r];s&&Object.assign(o.textureFormats,Object.getPrototypeOf(s))}}else console.error("WebGL not available for compressed textures. Silently failing.")},o}();function Ps(o,n,e){var r={textures:{},texture:null};return n&&n.map(function(s){return new Nn(new On(s,Object.assign({mipmap:et.OFF,alphaMode:vt.NO_PREMULTIPLIED_ALPHA},e)))}).forEach(function(s,l){var h=s.baseTexture,p=o+"-"+(l+1);On.addToCache(h,p),Nn.addToCache(s,p),l===0&&(On.addToCache(h,o),Nn.addToCache(s,o),r.texture=s),r.textures[p]=s}),r}Vr.setExtensionXhrType("dds",Vr.XHR_RESPONSE_TYPE.BUFFER);var wi,Ys,bc=3,wc=4,fu=7,pu=19,bh=2,wh=0,Bu=1,Sh=2,Uu=3;(function(o){o[o.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",o[o.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",o[o.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",o[o.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",o[o.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",o[o.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",o[o.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",o[o.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",o[o.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",o[o.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",o[o.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",o[o.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",o[o.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",o[o.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",o[o.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",o[o.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",o[o.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",o[o.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",o[o.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",o[o.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",o[o.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",o[o.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",o[o.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",o[o.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",o[o.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",o[o.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",o[o.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",o[o.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",o[o.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",o[o.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",o[o.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",o[o.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",o[o.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",o[o.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",o[o.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",o[o.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",o[o.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",o[o.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",o[o.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",o[o.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",o[o.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",o[o.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",o[o.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",o[o.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",o[o.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",o[o.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",o[o.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",o[o.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",o[o.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",o[o.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",o[o.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",o[o.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",o[o.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",o[o.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",o[o.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",o[o.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",o[o.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",o[o.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",o[o.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",o[o.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",o[o.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",o[o.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",o[o.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",o[o.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",o[o.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",o[o.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",o[o.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",o[o.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",o[o.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",o[o.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",o[o.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",o[o.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",o[o.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",o[o.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",o[o.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",o[o.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",o[o.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",o[o.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",o[o.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",o[o.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",o[o.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",o[o.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",o[o.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",o[o.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",o[o.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",o[o.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",o[o.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",o[o.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",o[o.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",o[o.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",o[o.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",o[o.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",o[o.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",o[o.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",o[o.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",o[o.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",o[o.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",o[o.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",o[o.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",o[o.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",o[o.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",o[o.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",o[o.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",o[o.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",o[o.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",o[o.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",o[o.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",o[o.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",o[o.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",o[o.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",o[o.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",o[o.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",o[o.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",o[o.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",o[o.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",o[o.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",o[o.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",o[o.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",o[o.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",o[o.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",o[o.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",o[o.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"})(wi||(wi={})),function(o){o[o.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",o[o.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",o[o.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(Ys||(Ys={}));var Da,Cs,mi,ku=((Oi={})[827611204]=Xn.COMPRESSED_RGBA_S3TC_DXT1_EXT,Oi[861165636]=Xn.COMPRESSED_RGBA_S3TC_DXT3_EXT,Oi[894720068]=Xn.COMPRESSED_RGBA_S3TC_DXT5_EXT,Oi),fa=((Dn={})[wi.DXGI_FORMAT_BC1_TYPELESS]=Xn.COMPRESSED_RGBA_S3TC_DXT1_EXT,Dn[wi.DXGI_FORMAT_BC1_UNORM]=Xn.COMPRESSED_RGBA_S3TC_DXT1_EXT,Dn[wi.DXGI_FORMAT_BC2_TYPELESS]=Xn.COMPRESSED_RGBA_S3TC_DXT3_EXT,Dn[wi.DXGI_FORMAT_BC2_UNORM]=Xn.COMPRESSED_RGBA_S3TC_DXT3_EXT,Dn[wi.DXGI_FORMAT_BC3_TYPELESS]=Xn.COMPRESSED_RGBA_S3TC_DXT5_EXT,Dn[wi.DXGI_FORMAT_BC3_UNORM]=Xn.COMPRESSED_RGBA_S3TC_DXT5_EXT,Dn[wi.DXGI_FORMAT_BC1_UNORM_SRGB]=Xn.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,Dn[wi.DXGI_FORMAT_BC2_UNORM_SRGB]=Xn.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,Dn[wi.DXGI_FORMAT_BC3_UNORM_SRGB]=Xn.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,Dn),Na=function(){function o(){}return o.use=function(n,e){if(n.extension==="dds"&&n.data)try{Object.assign(n,Ps(n.name||n.url,o.parse(n.data),n.metadata))}catch(r){return void e(r)}e()},o.parse=function(n){var e=new Uint32Array(n);if(e[0]!==542327876)throw new Error("Invalid DDS file magic word");var r=new Uint32Array(n,0,124/Uint32Array.BYTES_PER_ELEMENT),s=r[bc],l=r[wc],h=r[fu],p=new Uint32Array(n,pu*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),x=p[1];if(4&x){var b=p[bh];if(b!==808540228){var w=ku[b],R=new Uint8Array(n,128);return[new Di(R,{format:w,width:l,height:s,levels:h})]}var H=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),z=H[wh],q=H[Bu],at=H[Sh],_t=H[Uu],bt=fa[z];if(bt===void 0)throw new Error("DDSLoader cannot parse texture data with DXGI format "+z);if(at===4)throw new Error("DDSLoader does not support cubemap textures");if(q===Ys.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var zt=new Array;if(_t===1)zt.push(new Uint8Array(n,148));else{for(var De=cu[bt],an=0,Dt=l,ue=s,te=0;te<h;te++)an+=Math.max(1,Dt+3&-4)*Math.max(1,ue+3&-4)*De,Dt>>>=1,ue>>>=1;var he=148;for(te=0;te<_t;te++)zt.push(new Uint8Array(n,he,an)),he+=an}return zt.map(function(Ve){return new Di(Ve,{format:bt,width:l,height:s,levels:h})})}throw 64&x?new Error("DDSLoader does not support uncompressed texture data."):512&x?new Error("DDSLoader does not supported YUV uncompressed texture data."):131072&x?new Error("DDSLoader does not support single-channel (lumninance) texture data!"):2&x?new Error("DDSLoader does not support single-channel (alpha) texture data!"):new Error("DDSLoader failed to load a texture file due to an unknown reason!")},o}();Vr.setExtensionXhrType("ktx",Vr.XHR_RESPONSE_TYPE.BUFFER);var mo=[171,75,84,88,32,49,49,187,13,10,26,10],Ad=12,go=16,Ol=24,to=28,Sc=36,Gu=40,Rs=44,Th=48,Pd=52,Cd=56,us=60,ls=((Da={})[k.UNSIGNED_BYTE]=1,Da[k.UNSIGNED_SHORT]=2,Da[k.FLOAT]=4,Da[k.HALF_FLOAT]=8,Da),Vn=((Cs={})[ki.RGBA]=4,Cs[ki.RGB]=3,Cs[ki.LUMINANCE]=1,Cs[ki.LUMINANCE_ALPHA]=2,Cs[ki.ALPHA]=1,Cs),Fa=((mi={})[k.UNSIGNED_SHORT_4_4_4_4]=2,mi[k.UNSIGNED_SHORT_5_5_5_1]=2,mi[k.UNSIGNED_SHORT_5_6_5]=2,mi),Eh=function(){function o(){}return o.use=function(n,e){if(n.extension==="ktx"&&n.data)try{var r=n.name||n.url;Object.assign(n,Ps(r,o.parse(r,n.data),n.metadata))}catch(s){return void e(s)}e()},o.parse=function(n,e){var r=new DataView(e);if(!o.validate(n,r))return null;var s=r.getUint32(Ad,!0)===67305985,l=r.getUint32(go,s),h=r.getUint32(Ol,s),p=r.getUint32(to,s),x=r.getUint32(Sc,s),b=r.getUint32(Gu,s)||1,w=r.getUint32(Rs,s)||1,R=r.getUint32(Th,s)||1,H=r.getUint32(Pd,s),z=r.getUint32(Cd,s),q=r.getUint32(us,s);if(b===0||w!==1)throw new Error("Only 2D textures are supported");if(H!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(R!==1)throw new Error("WebGL does not support array textures");var at,_t=x+3&-4,bt=b+3&-4,zt=new Array(R),De=x*b;if(l===0&&(De=_t*bt),(at=l!==0?ls[l]?ls[l]*Vn[h]:Fa[l]:cu[p])===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var an=De*at,Dt=x,ue=b,te=_t,he=bt,Ve=64+q,Pe=0;Pe<z;Pe++){for(var ie=r.getUint32(Ve,s),pe=Ve+4,rn=0;rn<R;rn++){var Ye=zt[rn];Ye||(Ye=zt[rn]=new Array(z)),Ye[Pe]={levelID:Pe,levelWidth:z>1?Dt:te,levelHeight:z>1?ue:he,levelBuffer:new Uint8Array(e,pe,an)},pe+=an}Ve=(Ve+=ie+4)%4!=0?Ve+4-Ve%4:Ve,an=(te=(Dt=Dt>>1||1)+4-1&-4)*(he=(ue=ue>>1||1)+4-1&-4)*at}if(l!==0)throw new Error("TODO: Uncompressed");return zt.map(function(tn){return new Di(null,{format:p,width:x,height:b,levels:z,levelBuffers:tn})})},o.validate=function(n,e){for(var r=0;r<mo.length;r++)if(e.getUint8(r)!==mo[r])return console.error(n+" is not a valid *.ktx file!"),!1;return!0},o}(),mu=function(o,n){return(mu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function pa(o,n){function e(){this.constructor=o}mu(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var nr,ze,Is=function(o){function n(e,r,s,l){e===void 0&&(e=1500),s===void 0&&(s=16384),l===void 0&&(l=!1);var h=o.call(this)||this;return s>16384&&(s=16384),h._properties=[!1,!0,!1,!1,!1],h._maxSize=e,h._batchSize=s,h._buffers=null,h._bufferUpdateIDs=[],h._updateID=0,h.interactiveChildren=!1,h.blendMode=Fn.NORMAL,h.autoResize=l,h.roundPixels=!0,h.baseTexture=null,h.setProperties(r),h._tint=0,h.tintRgb=new Float32Array(4),h.tint=16777215,h}return pa(n,o),n.prototype.setProperties=function(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])},n.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,Jt(e,this.tintRgb)},enumerable:!1,configurable:!0}),n.prototype.render=function(e){var r=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return r.onChildrenChange(0)})),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},n.prototype.onChildrenChange=function(e){for(var r=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<r;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[r]=++this._updateID},n.prototype.dispose=function(){if(this._buffers){for(var e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}},n.prototype.destroy=function(e){o.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},n}(Wi),Rd=function(){function o(n,e,r){this.geometry=new Ho,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var s=0;s<n.length;++s){var l=n[s];l={attributeName:l.attributeName,size:l.size,uploadFunction:l.uploadFunction,type:l.type||k.FLOAT,offset:l.offset},e[s]?this.dynamicProperties.push(l):this.staticProperties.push(l)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return o.prototype.initBuffers=function(){var n=this.geometry,e=0;this.indexBuffer=new Gi(xr(this.size),!0,!0),n.addIndex(this.indexBuffer),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r)(p=this.dynamicProperties[r]).offset=e,e+=p.size,this.dynamicStride+=p.size;var s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new Gi(this.dynamicData,!1,!1);var l=0;for(this.staticStride=0,r=0;r<this.staticProperties.length;++r)(p=this.staticProperties[r]).offset=l,l+=p.size,this.staticStride+=p.size;var h=new ArrayBuffer(this.size*this.staticStride*4*4);for(this.staticData=new Float32Array(h),this.staticDataUint32=new Uint32Array(h),this.staticBuffer=new Gi(this.staticData,!0,!1),r=0;r<this.dynamicProperties.length;++r){var p=this.dynamicProperties[r];n.addAttribute(p.attributeName,this.dynamicBuffer,0,p.type===k.UNSIGNED_BYTE,p.type,4*this.dynamicStride,4*p.offset)}for(r=0;r<this.staticProperties.length;++r)p=this.staticProperties[r],n.addAttribute(p.attributeName,this.staticBuffer,0,p.type===k.UNSIGNED_BYTE,p.type,4*this.staticStride,4*p.offset)},o.prototype.uploadDynamic=function(n,e,r){for(var s=0;s<this.dynamicProperties.length;s++){var l=this.dynamicProperties[s];l.uploadFunction(n,e,r,l.type===k.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,l.offset)}this.dynamicBuffer._updateID++},o.prototype.uploadStatic=function(n,e,r){for(var s=0;s<this.staticProperties.length;s++){var l=this.staticProperties[s];l.uploadFunction(n,e,r,l.type===k.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,l.offset)}this.staticBuffer._updateID++},o.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},o}(),yf=function(o){function n(e){var r=o.call(this,e)||this;return r.shader=null,r.properties=null,r.tempMatrix=new li,r.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:r.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:r.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:r.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:r.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:k.UNSIGNED_BYTE,uploadFunction:r.uploadTint,offset:0}],r.shader=ua.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,{}),r.state=bs.for2d(),r}return pa(n,o),n.prototype.render=function(e){var r=e.children,s=e._maxSize,l=e._batchSize,h=this.renderer,p=r.length;if(p!==0){p>s&&!e.autoResize&&(p=s);var x=e._buffers;x||(x=e._buffers=this.generateBuffers(e));var b=r[0]._texture.baseTexture;this.state.blendMode=hn(e.blendMode,b.alphaMode),h.state.set(this.state);var w=h.gl,R=e.worldTransform.copyTo(this.tempMatrix);R.prepend(h.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=R.toArray(!0),this.shader.uniforms.uColor=jn(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,b.alphaMode),this.shader.uniforms.uSampler=b,this.renderer.shader.bind(this.shader);for(var H=!1,z=0,q=0;z<p;z+=l,q+=1){var at=p-z;at>l&&(at=l),q>=x.length&&x.push(this._generateOneMoreBuffer(e));var _t=x[q];_t.uploadDynamic(r,z,at);var bt=e._bufferUpdateIDs[q]||0;(H=H||_t._updateID<bt)&&(_t._updateID=e._updateID,_t.uploadStatic(r,z,at)),h.geometry.bind(_t.geometry),w.drawElements(w.TRIANGLES,6*at,w.UNSIGNED_SHORT,0)}}},n.prototype.generateBuffers=function(e){for(var r=[],s=e._maxSize,l=e._batchSize,h=e._properties,p=0;p<s;p+=l)r.push(new Rd(this.properties,h,l));return r},n.prototype._generateOneMoreBuffer=function(e){var r=e._batchSize,s=e._properties;return new Rd(this.properties,s,r)},n.prototype.uploadVertices=function(e,r,s,l,h,p){for(var x=0,b=0,w=0,R=0,H=0;H<s;++H){var z=e[r+H],q=z._texture,at=z.scale.x,_t=z.scale.y,bt=q.trim,zt=q.orig;bt?(x=(b=bt.x-z.anchor.x*zt.width)+bt.width,w=(R=bt.y-z.anchor.y*zt.height)+bt.height):(x=zt.width*(1-z.anchor.x),b=zt.width*-z.anchor.x,w=zt.height*(1-z.anchor.y),R=zt.height*-z.anchor.y),l[p]=b*at,l[p+1]=R*_t,l[p+h]=x*at,l[p+h+1]=R*_t,l[p+2*h]=x*at,l[p+2*h+1]=w*_t,l[p+3*h]=b*at,l[p+3*h+1]=w*_t,p+=4*h}},n.prototype.uploadPosition=function(e,r,s,l,h,p){for(var x=0;x<s;x++){var b=e[r+x].position;l[p]=b.x,l[p+1]=b.y,l[p+h]=b.x,l[p+h+1]=b.y,l[p+2*h]=b.x,l[p+2*h+1]=b.y,l[p+3*h]=b.x,l[p+3*h+1]=b.y,p+=4*h}},n.prototype.uploadRotation=function(e,r,s,l,h,p){for(var x=0;x<s;x++){var b=e[r+x].rotation;l[p]=b,l[p+h]=b,l[p+2*h]=b,l[p+3*h]=b,p+=4*h}},n.prototype.uploadUvs=function(e,r,s,l,h,p){for(var x=0;x<s;++x){var b=e[r+x]._texture._uvs;b?(l[p]=b.x0,l[p+1]=b.y0,l[p+h]=b.x1,l[p+h+1]=b.y1,l[p+2*h]=b.x2,l[p+2*h+1]=b.y2,l[p+3*h]=b.x3,l[p+3*h+1]=b.y3,p+=4*h):(l[p]=0,l[p+1]=0,l[p+h]=0,l[p+h+1]=0,l[p+2*h]=0,l[p+2*h+1]=0,l[p+3*h]=0,l[p+3*h+1]=0,p+=4*h)}},n.prototype.uploadTint=function(e,r,s,l,h,p){for(var x=0;x<s;++x){var b=e[r+x],w=b._texture.baseTexture.alphaMode>0,R=b.alpha,H=R<1&&w?wn(b._tintRGB,R):b._tintRGB+(255*R<<24);l[p]=H,l[p+h]=H,l[p+2*h]=H,l[p+3*h]=H,p+=4*h}},n.prototype.destroy=function(){o.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},n}(ci);(function(o){o.MITER="miter",o.BEVEL="bevel",o.ROUND="round"})(nr||(nr={})),function(o){o.BUTT="butt",o.ROUND="round",o.SQUARE="square"}(ze||(ze={}));var qo={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(o,n){if(n===void 0&&(n=20),!this.adaptive||!o||isNaN(o))return n;var e=Math.ceil(o/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},vo=function(){function o(){this.color=16777215,this.alpha=1,this.texture=Nn.WHITE,this.matrix=null,this.visible=!1,this.reset()}return o.prototype.clone=function(){var n=new o;return n.color=this.color,n.alpha=this.alpha,n.texture=this.texture,n.matrix=this.matrix,n.visible=this.visible,n},o.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Nn.WHITE,this.matrix=null,this.visible=!1},o.prototype.destroy=function(){this.texture=null,this.matrix=null},o}(),Tc=function(o,n){return(Tc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function Mh(o,n){function e(){this.constructor=o}Tc(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var Id={build:function(o){o.points=o.shape.points.slice()},triangulate:function(o,n){var e=o.points,r=o.holes,s=n.points,l=n.indices;if(e.length>=6){for(var h=[],p=0;p<r.length;p++){var x=r[p];h.push(e.length/2),e=e.concat(x.points)}var b=Ii()(e,h,2);if(!b)return;var w=s.length/2;for(p=0;p<b.length;p+=3)l.push(b[p]+w),l.push(b[p+1]+w),l.push(b[p+2]+w);for(p=0;p<e.length;p++)s.push(e[p])}}},Hu={build:function(o){var n,e,r=o.shape,s=o.points,l=r.x,h=r.y;if(s.length=0,o.type===fi.CIRC)n=r.radius,e=r.radius;else{var p=o.shape;n=p.width,e=p.height}if(n!==0&&e!==0){var x=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(n+e));x/=2.3;for(var b=2*Math.PI/x,w=0;w<x-.5;w++)s.push(l+Math.sin(-b*w)*n,h+Math.cos(-b*w)*e);s.push(s[0],s[1])}},triangulate:function(o,n){var e=o.points,r=n.points,s=n.indices,l=r.length/2,h=l,p=o.shape,x=o.matrix,b=p.x,w=p.y;r.push(o.matrix?x.a*b+x.c*w+x.tx:b,o.matrix?x.b*b+x.d*w+x.ty:w);for(var R=0;R<e.length;R+=2)r.push(e[R],e[R+1]),s.push(l++,h,l)}},Ld={build:function(o){var n=o.shape,e=n.x,r=n.y,s=n.width,l=n.height,h=o.points;h.length=0,h.push(e,r,e+s,r,e+s,r+l,e,r+l)},triangulate:function(o,n){var e=o.points,r=n.points,s=r.length/2;r.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),n.indices.push(s,s+1,s+2,s+1,s+2,s+3)}};function zu(o,n,e){return o+(n-o)*e}function Ah(o,n,e,r,s,l,h){h===void 0&&(h=[]);for(var p=h,x=0,b=0,w=0,R=0,H=0,z=0,q=0,at=0;q<=20;++q)x=zu(o,e,at=q/20),b=zu(n,r,at),w=zu(e,s,at),R=zu(r,l,at),H=zu(x,w,at),z=zu(b,R,at),p.push(H,z);return p}var Od={build:function(o){var n=o.shape,e=o.points,r=n.x,s=n.y,l=n.width,h=n.height,p=Math.max(0,Math.min(n.radius,Math.min(l,h)/2));e.length=0,p?(Ah(r,s+p,r,s,r+p,s,e),Ah(r+l-p,s,r+l,s,r+l,s+p,e),Ah(r+l,s+h-p,r+l,s+h,r+l-p,s+h,e),Ah(r+p,s+h,r,s+h,r,s+h-p,e)):e.push(r,s,r+l,s,r+l,s+h,r,s+h)},triangulate:function(o,n){for(var e=o.points,r=n.points,s=n.indices,l=r.length/2,h=Ii()(e,null,2),p=0,x=h.length;p<x;p+=3)s.push(h[p]+l),s.push(h[p+1]+l),s.push(h[p+2]+l);for(p=0,x=e.length;p<x;p++)r.push(e[p],e[++p])}};function xf(o,n,e,r,s,l,h,p){var x,b;h?(x=r,b=-e):(x=-r,b=e);var w=o-e*s+x,R=n-r*s+b,H=o+e*l+x,z=n+r*l+b;return p.push(w,R),p.push(H,z),2}function gu(o,n,e,r,s,l,h,p){var x=e-o,b=r-n,w=Math.atan2(x,b),R=Math.atan2(s-o,l-n);p&&w<R?w+=2*Math.PI:!p&&w>R&&(R+=2*Math.PI);var H=w,z=R-w,q=Math.abs(z),at=Math.sqrt(x*x+b*b),_t=1+(15*q*Math.sqrt(at)/Math.PI>>0),bt=z/_t;if(H+=bt,p){h.push(o,n),h.push(e,r);for(var zt=1,De=H;zt<_t;zt++,De+=bt)h.push(o,n),h.push(o+Math.sin(De)*at,n+Math.cos(De)*at);h.push(o,n),h.push(s,l)}else{for(h.push(e,r),h.push(o,n),zt=1,De=H;zt<_t;zt++,De+=bt)h.push(o+Math.sin(De)*at,n+Math.cos(De)*at),h.push(o,n);h.push(s,l),h.push(o,n)}return 2*_t}function Dl(o,n){o.lineStyle.native?function(e,r){var s=0,l=e.shape,h=e.points||l.points,p=l.type!==fi.POLY||l.closeStroke;if(h.length!==0){var x=r.points,b=r.indices,w=h.length/2,R=x.length/2,H=R;for(x.push(h[0],h[1]),s=1;s<w;s++)x.push(h[2*s],h[2*s+1]),b.push(H,H+1),H++;p&&b.push(H,R)}}(o,n):function(e,r){var s=e.shape,l=e.points||s.points.slice(),h=r.closePointEps;if(l.length!==0){var p=e.lineStyle,x=new xi(l[0],l[1]),b=new xi(l[l.length-2],l[l.length-1]),w=s.type!==fi.POLY||s.closeStroke,R=Math.abs(x.x-b.x)<h&&Math.abs(x.y-b.y)<h;if(w){l=l.slice(),R&&(l.pop(),l.pop(),b.set(l[l.length-2],l[l.length-1]));var H=.5*(x.x+b.x),z=.5*(b.y+x.y);l.unshift(H,z),l.push(H,z)}var q=r.points,at=l.length/2,_t=l.length,bt=q.length/2,zt=p.width/2,De=zt*zt,an=p.miterLimit*p.miterLimit,Dt=l[0],ue=l[1],te=l[2],he=l[3],Ve=0,Pe=0,ie=-(ue-he),pe=Dt-te,rn=0,Ye=0,tn=Math.sqrt(ie*ie+pe*pe);ie/=tn,pe/=tn,ie*=zt,pe*=zt;var cn=p.alignment,ke=2*(1-cn),Ce=2*cn;w||(p.cap===ze.ROUND?_t+=gu(Dt-ie*(ke-Ce)*.5,ue-pe*(ke-Ce)*.5,Dt-ie*ke,ue-pe*ke,Dt+ie*Ce,ue+pe*Ce,q,!0)+2:p.cap===ze.SQUARE&&(_t+=xf(Dt,ue,ie,pe,ke,Ce,!0,q))),q.push(Dt-ie*ke,ue-pe*ke),q.push(Dt+ie*Ce,ue+pe*Ce);for(var mn=1;mn<at-1;++mn){Dt=l[2*(mn-1)],ue=l[2*(mn-1)+1],te=l[2*mn],he=l[2*mn+1],Ve=l[2*(mn+1)],Pe=l[2*(mn+1)+1],ie=-(ue-he),pe=Dt-te,ie/=tn=Math.sqrt(ie*ie+pe*pe),pe/=tn,ie*=zt,pe*=zt,rn=-(he-Pe),Ye=te-Ve,rn/=tn=Math.sqrt(rn*rn+Ye*Ye),Ye/=tn,rn*=zt,Ye*=zt;var kn=te-Dt,Jn=ue-he,_r=te-Ve,or=Pe-he,Tr=Jn*_r-or*kn,si=Tr<0;if(Math.abs(Tr)<.1)q.push(te-ie*ke,he-pe*ke),q.push(te+ie*Ce,he+pe*Ce);else{var ai=(-ie+Dt)*(-pe+he)-(-ie+te)*(-pe+ue),Bi=(-rn+Ve)*(-Ye+he)-(-rn+te)*(-Ye+Pe),So=(kn*Bi-_r*ai)/Tr,tr=(or*ai-Jn*Bi)/Tr,ei=(So-te)*(So-te)+(tr-he)*(tr-he),Wr=te+(So-te)*ke,rr=he+(tr-he)*ke,$n=te-(So-te)*Ce,eo=he-(tr-he)*Ce,dl=si?ke:Ce;ei<=Math.min(kn*kn+Jn*Jn,_r*_r+or*or)+dl*dl*De?p.join===nr.BEVEL||ei/De>an?(si?(q.push(Wr,rr),q.push(te+ie*Ce,he+pe*Ce),q.push(Wr,rr),q.push(te+rn*Ce,he+Ye*Ce)):(q.push(te-ie*ke,he-pe*ke),q.push($n,eo),q.push(te-rn*ke,he-Ye*ke),q.push($n,eo)),_t+=2):p.join===nr.ROUND?si?(q.push(Wr,rr),q.push(te+ie*Ce,he+pe*Ce),_t+=gu(te,he,te+ie*Ce,he+pe*Ce,te+rn*Ce,he+Ye*Ce,q,!0)+4,q.push(Wr,rr),q.push(te+rn*Ce,he+Ye*Ce)):(q.push(te-ie*ke,he-pe*ke),q.push($n,eo),_t+=gu(te,he,te-ie*ke,he-pe*ke,te-rn*ke,he-Ye*ke,q,!1)+4,q.push(te-rn*ke,he-Ye*ke),q.push($n,eo)):(q.push(Wr,rr),q.push($n,eo)):(q.push(te-ie*ke,he-pe*ke),q.push(te+ie*Ce,he+pe*Ce),p.join===nr.BEVEL||ei/De>an||(p.join===nr.ROUND?_t+=si?gu(te,he,te+ie*Ce,he+pe*Ce,te+rn*Ce,he+Ye*Ce,q,!0)+2:gu(te,he,te-ie*ke,he-pe*ke,te-rn*ke,he-Ye*ke,q,!1)+2:(si?(q.push($n,eo),q.push($n,eo)):(q.push(Wr,rr),q.push(Wr,rr)),_t+=2)),q.push(te-rn*ke,he-Ye*ke),q.push(te+rn*Ce,he+Ye*Ce),_t+=2)}}Dt=l[2*(at-2)],ue=l[2*(at-2)+1],te=l[2*(at-1)],ie=-(ue-(he=l[2*(at-1)+1])),pe=Dt-te,ie/=tn=Math.sqrt(ie*ie+pe*pe),pe/=tn,ie*=zt,pe*=zt,q.push(te-ie*ke,he-pe*ke),q.push(te+ie*Ce,he+pe*Ce),w||(p.cap===ze.ROUND?_t+=gu(te-ie*(ke-Ce)*.5,he-pe*(ke-Ce)*.5,te-ie*ke,he-pe*ke,te+ie*Ce,he+pe*Ce,q,!1)+2:p.cap===ze.SQUARE&&(_t+=xf(te,he,ie,pe,ke,Ce,!1,q)));var hd=r.indices,up=qo.epsilon*qo.epsilon;for(mn=bt;mn<_t+bt-2;++mn)Dt=q[2*mn],ue=q[2*mn+1],te=q[2*(mn+1)],he=q[2*(mn+1)+1],Ve=q[2*(mn+2)],Pe=q[2*(mn+2)+1],Math.abs(Dt*(he-Pe)+te*(Pe-ue)+Ve*(ue-he))<up||hd.push(mn,mn+1,mn+2)}}(o,n)}var Ls,Nl=function(){function o(){}return o.curveTo=function(n,e,r,s,l,h){var p=h[h.length-2],x=h[h.length-1]-e,b=p-n,w=s-e,R=r-n,H=Math.abs(x*R-b*w);if(H<1e-8||l===0)return h[h.length-2]===n&&h[h.length-1]===e||h.push(n,e),null;var z=x*x+b*b,q=w*w+R*R,at=x*w+b*R,_t=l*Math.sqrt(z)/H,bt=l*Math.sqrt(q)/H,zt=_t*at/z,De=bt*at/q,an=_t*R+bt*b,Dt=_t*w+bt*x,ue=b*(bt+zt),te=x*(bt+zt),he=R*(_t+De),Ve=w*(_t+De);return{cx:an+n,cy:Dt+e,radius:l,startAngle:Math.atan2(te-Dt,ue-an),endAngle:Math.atan2(Ve-Dt,he-an),anticlockwise:b*w>R*x}},o.arc=function(n,e,r,s,l,h,p,x,b){for(var w=p-h,R=qo._segmentsCount(Math.abs(w)*l,40*Math.ceil(Math.abs(w)/ns)),H=w/(2*R),z=2*H,q=Math.cos(H),at=Math.sin(H),_t=R-1,bt=_t%1/_t,zt=0;zt<=_t;++zt){var De=H+h+z*(zt+bt*zt),an=Math.cos(De),Dt=-Math.sin(De);b.push((q*an+at*Dt)*l+r,(q*-Dt+at*an)*l+s)}},o}(),Dd=function(){function o(){}return o.curveLength=function(n,e,r,s,l,h,p,x){for(var b=0,w=0,R=0,H=0,z=0,q=0,at=0,_t=0,bt=0,zt=0,De=0,an=n,Dt=e,ue=1;ue<=10;++ue)zt=an-(_t=(at=(q=(z=1-(w=ue/10))*z)*z)*n+3*q*w*r+3*z*(R=w*w)*l+(H=R*w)*p),De=Dt-(bt=at*e+3*q*w*s+3*z*R*h+H*x),an=_t,Dt=bt,b+=Math.sqrt(zt*zt+De*De);return b},o.curveTo=function(n,e,r,s,l,h,p){var x=p[p.length-2],b=p[p.length-1];p.length-=2;var w=qo._segmentsCount(o.curveLength(x,b,n,e,r,s,l,h)),R=0,H=0,z=0,q=0,at=0;p.push(x,b);for(var _t=1,bt=0;_t<=w;++_t)z=(H=(R=1-(bt=_t/w))*R)*R,at=(q=bt*bt)*bt,p.push(z*x+3*H*bt*n+3*R*q*r+at*l,z*b+3*H*bt*e+3*R*q*s+at*h)},o}(),Nd=function(){function o(){}return o.curveLength=function(n,e,r,s,l,h){var p=n-2*r+l,x=e-2*s+h,b=2*r-2*n,w=2*s-2*e,R=4*(p*p+x*x),H=4*(p*b+x*w),z=b*b+w*w,q=2*Math.sqrt(R+H+z),at=Math.sqrt(R),_t=2*R*at,bt=2*Math.sqrt(z),zt=H/at;return(_t*q+at*H*(q-bt)+(4*z*R-H*H)*Math.log((2*at+zt+q)/(zt+bt)))/(4*_t)},o.curveTo=function(n,e,r,s,l){for(var h=l[l.length-2],p=l[l.length-1],x=qo._segmentsCount(o.curveLength(h,p,n,e,r,s)),b=0,w=0,R=1;R<=x;++R){var H=R/x;b=h+(n-h)*H,w=p+(e-p)*H,l.push(b+(n+(r-n)*H-b)*H,w+(e+(s-e)*H-w)*H)}},o}(),Fl=function(){function o(){this.reset()}return o.prototype.begin=function(n,e,r){this.reset(),this.style=n,this.start=e,this.attribStart=r},o.prototype.end=function(n,e){this.attribSize=e-this.attribStart,this.size=n-this.start},o.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},o}(),Bl=((Ls={})[fi.POLY]=Id,Ls[fi.CIRC]=Hu,Ls[fi.ELIP]=Hu,Ls[fi.RECT]=Ld,Ls[fi.RREC]=Od,Ls),hs=[],Os=[],Ph=function(){function o(n,e,r,s){e===void 0&&(e=null),r===void 0&&(r=null),s===void 0&&(s=null),this.shape=n,this.lineStyle=r,this.fillStyle=e,this.matrix=s,this.type=n.type,this.points=[],this.holes=[]}return o.prototype.clone=function(){return new o(this.shape,this.fillStyle,this.lineStyle,this.matrix)},o.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},o}(),ju=new xi,Ul=new Tu,bo=function(o){function n(){var e=o.call(this)||this;return e.uvsFloat32=null,e.indicesUint16=null,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.dirty=0,e.batchDirty=-1,e.cacheDirty=-1,e.clearDirty=0,e.drawCalls=[],e.batches=[],e.shapeIndex=0,e._bounds=new Tu,e.boundsDirty=-1,e.boundsPadding=0,e.batchable=!1,e.indicesUint16=null,e.uvsFloat32=null,e.closePointEps=1e-4,e}return Mh(n,o),Object.defineProperty(n.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),n.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Os.push(this.drawCalls[e]);for(this.drawCalls.length=0,e=0;e<this.batches.length;e++){var r=this.batches[e];r.reset(),hs.push(r)}this.batches.length=0},n.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},n.prototype.drawShape=function(e,r,s,l){r===void 0&&(r=null),s===void 0&&(s=null),l===void 0&&(l=null);var h=new Ph(e,r,s,l);return this.graphicsData.push(h),this.dirty++,this},n.prototype.drawHole=function(e,r){if(r===void 0&&(r=null),!this.graphicsData.length)return null;var s=new Ph(e,null,null,r),l=this.graphicsData[this.graphicsData.length-1];return s.lineStyle=l.lineStyle,l.holes.push(s),this.dirty++,this},n.prototype.destroy=function(){o.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},n.prototype.containsPoint=function(e){for(var r=this.graphicsData,s=0;s<r.length;++s){var l=r[s];if(l.fillStyle.visible&&l.shape&&(l.matrix?l.matrix.applyInverse(e,ju):ju.copyFrom(e),l.shape.contains(ju.x,ju.y))){var h=!1;if(l.holes){for(var p=0;p<l.holes.length;p++)if(l.holes[p].shape.contains(ju.x,ju.y)){h=!0;break}}if(!h)return!0}}return!1},n.prototype.updateBatches=function(e){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var r=this.uvs,s=this.graphicsData,l=null,h=null;this.batches.length>0&&(h=(l=this.batches[this.batches.length-1]).style);for(var p=this.shapeIndex;p<s.length;p++){this.shapeIndex++;var x=s[p],b=x.fillStyle,w=x.lineStyle;Bl[x.type].build(x),x.matrix&&this.transformPoints(x.points,x.matrix);for(var R=0;R<2;R++){var H=R===0?b:w;if(H.visible){var z=H.texture.baseTexture,q=this.indices.length,at=this.points.length/2;z.wrapMode=K.REPEAT,R===0?this.processFill(x):this.processLine(x);var _t=this.points.length/2-at;_t!==0&&(l&&!this._compareStyles(h,H)&&(l.end(q,at),l=null),l||((l=hs.pop()||new Fl).begin(H,q,at),this.batches.push(l),h=H),this.addUvs(this.points,r,H.texture,at,_t,H.matrix))}}}var bt=this.indices.length,zt=this.points.length/2;if(l&&l.end(bt,zt),this.batches.length!==0){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var De=zt>65535&&e;this.indicesUint16=De?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},n.prototype._compareStyles=function(e,r){return!(!e||!r)&&e.texture.baseTexture===r.texture.baseTexture&&e.color+e.alpha===r.color+r.alpha&&!!e.native==!!r.native},n.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,r=this.graphicsData.length;e<r;e++){var s=this.graphicsData[e],l=s.fillStyle,h=s.lineStyle;if(l&&!l.texture.baseTexture.valid||h&&!h.texture.baseTexture.valid)return!1}return!0},n.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,r=0,s=e.length;r<s;r++)for(var l=e[r],h=0;h<l.size;h++){var p=l.start+h;this.indicesUint16[p]=this.indicesUint16[p]-l.attribStart}},n.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var e=this.batches,r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<2*n.BATCHABLE_SIZE},n.prototype.buildDrawCalls=function(){for(var e=++On._globalBatch,r=0;r<this.drawCalls.length;r++)this.drawCalls[r].texArray.clear(),Os.push(this.drawCalls[r]);this.drawCalls.length=0;var s=this.colors,l=this.textureIds,h=Os.pop();h||((h=new Cl).texArray=new uu),h.texArray.count=0,h.start=0,h.size=0,h.type=_i.TRIANGLES;var p=0,x=null,b=0,w=!1,R=_i.TRIANGLES,H=0;for(this.drawCalls.push(h),r=0;r<this.batches.length;r++){var z=this.batches[r],q=z.style,at=q.texture.baseTexture;w!==!!q.native&&(R=(w=!!q.native)?_i.LINES:_i.TRIANGLES,x=null,p=8,e++),x!==at&&(x=at,at._batchEnabled!==e&&(p===8&&(e++,p=0,h.size>0&&((h=Os.pop())||((h=new Cl).texArray=new uu),this.drawCalls.push(h)),h.start=H,h.size=0,h.texArray.count=0,h.type=R),at.touched=1,at._batchEnabled=e,at._batchLocation=p,at.wrapMode=K.REPEAT,h.texArray.elements[h.texArray.count++]=at,p++)),h.size+=z.size,H+=z.size,b=at._batchLocation,this.addColors(s,q.color,q.alpha,z.attribSize),this.addTextureIds(l,b,z.attribSize)}On._globalBatch=e,this.packAttributes()},n.prototype.packAttributes=function(){for(var e=this.points,r=this.uvs,s=this.colors,l=this.textureIds,h=new ArrayBuffer(3*e.length*4),p=new Float32Array(h),x=new Uint32Array(h),b=0,w=0;w<e.length/2;w++)p[b++]=e[2*w],p[b++]=e[2*w+1],p[b++]=r[2*w],p[b++]=r[2*w+1],x[b++]=s[w],p[b++]=l[w];this._buffer.update(h),this._indexBuffer.update(this.indicesUint16)},n.prototype.processFill=function(e){e.holes.length?(this.processHoles(e.holes),Id.triangulate(e,this)):Bl[e.type].triangulate(e,this)},n.prototype.processLine=function(e){Dl(e,this);for(var r=0;r<e.holes.length;r++)Dl(e.holes[r],this)},n.prototype.processHoles=function(e){for(var r=0;r<e.length;r++){var s=e[r];Bl[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix)}},n.prototype.calculateBounds=function(){var e=this._bounds,r=Ul,s=li.IDENTITY;this._bounds.clear(),r.clear();for(var l=0;l<this.graphicsData.length;l++){var h=this.graphicsData[l],p=h.shape,x=h.type,b=h.lineStyle,w=h.matrix||li.IDENTITY,R=0;if(b&&b.visible){var H=b.alignment;R=b.width,x===fi.POLY?R*=.5+Math.abs(.5-H):R*=Math.max(0,H)}if(s!==w&&(r.isEmpty()||(e.addBoundsMatrix(r,s),r.clear()),s=w),x===fi.RECT||x===fi.RREC){var z=p;r.addFramePad(z.x,z.y,z.x+z.width,z.y+z.height,R,R)}else if(x===fi.CIRC){var q=p;r.addFramePad(q.x,q.y,q.x,q.y,q.radius+R,q.radius+R)}else if(x===fi.ELIP){var at=p;r.addFramePad(at.x,at.y,at.x,at.y,at.width+R,at.height+R)}else{var _t=p;e.addVerticesMatrix(s,_t.points,0,_t.points.length,R,R)}}r.isEmpty()||e.addBoundsMatrix(r,s),e.pad(this.boundsPadding,this.boundsPadding)},n.prototype.transformPoints=function(e,r){for(var s=0;s<e.length/2;s++){var l=e[2*s],h=e[2*s+1];e[2*s]=r.a*l+r.c*h+r.tx,e[2*s+1]=r.b*l+r.d*h+r.ty}},n.prototype.addColors=function(e,r,s,l){for(var h=wn((r>>16)+(65280&r)+((255&r)<<16),s);l-- >0;)e.push(h)},n.prototype.addTextureIds=function(e,r,s){for(;s-- >0;)e.push(r)},n.prototype.addUvs=function(e,r,s,l,h,p){p===void 0&&(p=null);for(var x=0,b=r.length,w=s.frame;x<h;){var R=e[2*(l+x)],H=e[2*(l+x)+1];if(p){var z=p.a*R+p.c*H+p.tx;H=p.b*R+p.d*H+p.ty,R=z}x++,r.push(R/w.width,H/w.height)}var q=s.baseTexture;(w.width<q.width||w.height<q.height)&&this.adjustUvs(r,s,b,h)},n.prototype.adjustUvs=function(e,r,s,l){for(var h=r.baseTexture,p=1e-6,x=s+2*l,b=r.frame,w=b.width/h.width,R=b.height/h.height,H=b.x/b.width,z=b.y/b.height,q=Math.floor(e[s]+p),at=Math.floor(e[s+1]+p),_t=s+2;_t<x;_t+=2)q=Math.min(q,Math.floor(e[_t]+p)),at=Math.min(at,Math.floor(e[_t+1]+p));for(H-=q,z-=at,_t=s;_t<x;_t+=2)e[_t]=(e[_t]+H)*w,e[_t+1]=(e[_t+1]+z)*R},n.BATCHABLE_SIZE=100,n}(mc),oo=function(o){function n(){var e=o!==null&&o.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=ze.BUTT,e.join=nr.MITER,e.miterLimit=10,e}return Mh(n,o),n.prototype.clone=function(){var e=new n;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e},n.prototype.reset=function(){o.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},n}(vo),Fd=new Float32Array(3),Ec={},cs=function(o){function n(e){e===void 0&&(e=null);var r=o.call(this)||this;return r._geometry=e||new bo,r._geometry.refCount++,r.shader=null,r.state=bs.for2d(),r._fillStyle=new vo,r._lineStyle=new oo,r._matrix=null,r._holeMode=!1,r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r.pluginName="batch",r._transformID=-1,r.tint=16777215,r.blendMode=Fn.NORMAL,r}return Mh(n,o),Object.defineProperty(n.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),n.prototype.clone=function(){return this.finishPoly(),new n(this._geometry)},Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),n.prototype.lineStyle=function(e,r,s,l,h){return e===void 0&&(e=null),r===void 0&&(r=0),s===void 0&&(s=1),l===void 0&&(l=.5),h===void 0&&(h=!1),typeof e=="number"&&(e={width:e,color:r,alpha:s,alignment:l,native:h}),this.lineTextureStyle(e)},n.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:Nn.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:ze.BUTT,join:nr.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this},n.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new yl,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[r-2],e[r-1]))}else this.currentPath=new yl,this.currentPath.closeStroke=!1},n.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},n.prototype.moveTo=function(e,r){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=r,this},n.prototype.lineTo=function(e,r){this.currentPath||this.moveTo(0,0);var s=this.currentPath.points,l=s[s.length-2],h=s[s.length-1];return l===e&&h===r||s.push(e,r),this},n.prototype._initCurve=function(e,r){e===void 0&&(e=0),r===void 0&&(r=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,r]):this.moveTo(e,r)},n.prototype.quadraticCurveTo=function(e,r,s,l){this._initCurve();var h=this.currentPath.points;return h.length===0&&this.moveTo(0,0),Nd.curveTo(e,r,s,l,h),this},n.prototype.bezierCurveTo=function(e,r,s,l,h,p){return this._initCurve(),Dd.curveTo(e,r,s,l,h,p,this.currentPath.points),this},n.prototype.arcTo=function(e,r,s,l,h){this._initCurve(e,r);var p=this.currentPath.points,x=Nl.curveTo(e,r,s,l,h,p);if(x){var b=x.cx,w=x.cy,R=x.radius,H=x.startAngle,z=x.endAngle,q=x.anticlockwise;this.arc(b,w,R,H,z,q)}return this},n.prototype.arc=function(e,r,s,l,h,p){if(p===void 0&&(p=!1),l===h)return this;if(!p&&h<=l?h+=ns:p&&l<=h&&(l+=ns),h-l==0)return this;var x=e+Math.cos(l)*s,b=r+Math.sin(l)*s,w=this._geometry.closePointEps,R=this.currentPath?this.currentPath.points:null;if(R){var H=Math.abs(R[R.length-2]-x),z=Math.abs(R[R.length-1]-b);H<w&&z<w||R.push(x,b)}else this.moveTo(x,b),R=this.currentPath.points;return Nl.arc(x,b,e,r,s,l,h,p,R),this},n.prototype.beginFill=function(e,r){return e===void 0&&(e=0),r===void 0&&(r=1),this.beginTextureFill({texture:Nn.WHITE,color:e,alpha:r})},n.prototype.beginTextureFill=function(e){e=Object.assign({texture:Nn.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this},n.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},n.prototype.drawRect=function(e,r,s,l){return this.drawShape(new Ln(e,r,s,l))},n.prototype.drawRoundedRect=function(e,r,s,l,h){return this.drawShape(new xl(e,r,s,l,h))},n.prototype.drawCircle=function(e,r,s){return this.drawShape(new na(e,r,s))},n.prototype.drawEllipse=function(e,r,s,l){return this.drawShape(new ah(e,r,s,l))},n.prototype.drawPolygon=function(){for(var e,r=arguments,s=[],l=0;l<arguments.length;l++)s[l]=r[l];var h=!0,p=s[0];p.points?(h=p.closeStroke,e=p.points):e=Array.isArray(s[0])?s[0]:s;var x=new yl(e);return x.closeStroke=h,this.drawShape(x),this},n.prototype.drawShape=function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},n.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},n.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return!(e.length!==1||e[0].shape.type!==fi.RECT||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)},n.prototype._render=function(e){this.finishPoly();var r=this._geometry,s=e.context.supports.uint32Indices;r.updateBatches(s),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},n.prototype._populateBatches=function(){var e=this._geometry,r=this.blendMode,s=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=s,this.vertexData=new Float32Array(e.points);for(var l=0;l<s;l++){var h=e.batches[l],p=h.style.color,x=new Float32Array(this.vertexData.buffer,4*h.attribStart*2,2*h.attribSize),b=new Float32Array(e.uvsFloat32.buffer,4*h.attribStart*2,2*h.attribSize),w={vertexData:x,blendMode:r,indices:new Uint16Array(e.indicesUint16.buffer,2*h.start,h.size),uvs:b,_batchRGB:Jt(p),_tintRGB:p,_texture:h.style.texture,alpha:h.style.alpha,worldAlpha:1};this.batches[l]=w}},n.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var r=0,s=this.batches.length;r<s;r++){var l=this.batches[r];l.worldAlpha=this.worldAlpha*l.alpha,e.plugins[this.pluginName].render(l)}}},n.prototype._renderDirect=function(e){var r=this._resolveDirectShader(e),s=this._geometry,l=this.tint,h=this.worldAlpha,p=r.uniforms,x=s.drawCalls;p.translationMatrix=this.transform.worldTransform,p.tint[0]=(l>>16&255)/255*h,p.tint[1]=(l>>8&255)/255*h,p.tint[2]=(255&l)/255*h,p.tint[3]=h,e.shader.bind(r),e.geometry.bind(s,r),e.state.set(this.state);for(var b=0,w=x.length;b<w;b++)this._renderDrawCallDirect(e,s.drawCalls[b])},n.prototype._renderDrawCallDirect=function(e,r){for(var s=r.texArray,l=r.type,h=r.size,p=r.start,x=s.count,b=0;b<x;b++)e.texture.bind(s.elements[b],b);e.geometry.draw(l,h,p)},n.prototype._resolveDirectShader=function(e){var r=this.shader,s=this.pluginName;if(!r){if(!Ec[s]){for(var l=e.plugins.batch.MAX_TEXTURES,h=new Int32Array(l),p=0;p<l;p++)h[p]=p;var x={tint:new Float32Array([1,1,1,1]),translationMatrix:new li,default:zo.from({uSamplers:h},!0)},b=e.plugins[s]._shader.program;Ec[s]=new ua(b,x)}r=Ec[s]}return r},n.prototype._calculateBounds=function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var r=e.bounds,s=r.minX,l=r.minY,h=r.maxX,p=r.maxY;this._bounds.addFrame(this.transform,s,l,h,p)}},n.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,n._TEMP_POINT),this._geometry.containsPoint(n._TEMP_POINT)},n.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=Jt(this.tint,Fd),r=0;r<this.batches.length;r++){var s=this.batches[r],l=s._batchRGB,h=(e[0]*l[0]*255<<16)+(e[1]*l[1]*255<<8)+(0|e[2]*l[2]*255);s._tintRGB=(h>>16)+(65280&h)+((255&h)<<16)}}},n.prototype.calculateVertices=function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var r=this.transform.worldTransform,s=r.a,l=r.b,h=r.c,p=r.d,x=r.tx,b=r.ty,w=this._geometry.points,R=this.vertexData,H=0,z=0;z<w.length;z+=2){var q=w[z],at=w[z+1];R[H++]=s*q+h*at+x,R[H++]=p*at+l*q+b}}},n.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0),this},n.prototype.setMatrix=function(e){return this._matrix=e,this},n.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},n.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},n.prototype.destroy=function(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,o.prototype.destroy.call(this,e)},n._TEMP_POINT=new xi,n}(Wi),lp={buildPoly:Id,buildCircle:Hu,buildRectangle:Ld,buildRoundedRectangle:Od,buildLine:Dl,ArcUtils:Nl,BezierUtils:Dd,QuadraticUtils:Nd,BatchPart:Fl,FILL_COMMANDS:Bl,BATCH_POOL:hs,DRAW_CALL_POOL:Os},bf=function(o,n){return(bf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},kl,wo=new xi,hp=new Uint16Array([0,1,2,0,2,3]),oi=function(o){function n(e){var r=o.call(this)||this;return r._anchor=new Ta(r._onAnchorUpdate,r,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=Fn.NORMAL,r._cachedTint=16777215,r.uvs=null,r.texture=e||Nn.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.indices=hp,r.pluginName="batch",r.isSprite=!0,r._roundPixels=Vt.ROUND_PIXELS,r}return function(e,r){function s(){this.constructor=e}bf(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=zr(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=zr(this.scale.y)*this._height/this._texture.orig.height)},n.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},n.prototype.calculateVertices=function(){var e=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==e._updateID){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var r=this.transform.worldTransform,s=r.a,l=r.b,h=r.c,p=r.d,x=r.tx,b=r.ty,w=this.vertexData,R=e.trim,H=e.orig,z=this._anchor,q=0,at=0,_t=0,bt=0;if(R?(q=(at=R.x-z._x*H.width)+R.width,_t=(bt=R.y-z._y*H.height)+R.height):(q=(at=-z._x*H.width)+H.width,_t=(bt=-z._y*H.height)+H.height),w[0]=s*at+h*bt+x,w[1]=p*bt+l*at+b,w[2]=s*q+h*bt+x,w[3]=p*bt+l*q+b,w[4]=s*q+h*_t+x,w[5]=p*_t+l*q+b,w[6]=s*at+h*_t+x,w[7]=p*_t+l*at+b,this._roundPixels)for(var zt=Vt.RESOLUTION,De=0;De<w.length;++De)w[De]=Math.round((w[De]*zt|0)/zt)}},n.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,r=this.vertexTrimmedData,s=e.orig,l=this._anchor,h=this.transform.worldTransform,p=h.a,x=h.b,b=h.c,w=h.d,R=h.tx,H=h.ty,z=-l._x*s.width,q=z+s.width,at=-l._y*s.height,_t=at+s.height;r[0]=p*z+b*at+R,r[1]=w*at+x*z+H,r[2]=p*q+b*at+R,r[3]=w*at+x*q+H,r[4]=p*q+b*_t+R,r[5]=w*_t+x*q+H,r[6]=p*z+b*_t+R,r[7]=w*_t+x*z+H},n.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},n.prototype._calculateBounds=function(){var e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},n.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Ln),e=this._localBoundsRect),this._bounds.getRectangle(e)):o.prototype.getLocalBounds.call(this,e)},n.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,wo);var r=this._texture.orig.width,s=this._texture.orig.height,l=-r*this.anchor.x,h=0;return wo.x>=l&&wo.x<l+r&&(h=-s*this.anchor.y,wo.y>=h&&wo.y<h+s)},n.prototype.destroy=function(e){if(o.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e&&e.texture){var r=typeof e=="boolean"?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null},n.from=function(e,r){return new n(e instanceof Nn?e:Nn.from(e,r))},Object.defineProperty(n.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var r=zr(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var r=zr(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Nn.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),n}(Wi),wf=function(o,n){return(wf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};(function(o){o[o.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",o[o.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(kl||(kl={}));var Ch={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:kl.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},cp=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Vu=function(){function o(n){this.styleID=0,this.reset(),Mc(this,n,n)}return o.prototype.clone=function(){var n={};return Mc(n,this,Ch),new o(n)},o.prototype.reset=function(){Mc(this,Ch,Ch)},Object.defineProperty(o.prototype,"align",{get:function(){return this._align},set:function(n){this._align!==n&&(this._align=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"breakWords",{get:function(){return this._breakWords},set:function(n){this._breakWords!==n&&(this._breakWords=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(n){this._dropShadow!==n&&(this._dropShadow=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(n){this._dropShadowAlpha!==n&&(this._dropShadowAlpha=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(n){this._dropShadowAngle!==n&&(this._dropShadowAngle=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(n){this._dropShadowBlur!==n&&(this._dropShadowBlur=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(n){var e=Rh(n);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(n){this._dropShadowDistance!==n&&(this._dropShadowDistance=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fill",{get:function(){return this._fill},set:function(n){var e=Rh(n);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(n){this._fillGradientType!==n&&(this._fillGradientType=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(n){(function(e,r){if(!Array.isArray(e)||!Array.isArray(r)||e.length!==r.length)return!1;for(var s=0;s<e.length;++s)if(e[s]!==r[s])return!1;return!0})(this._fillGradientStops,n)||(this._fillGradientStops=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(n){this.fontFamily!==n&&(this._fontFamily=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontSize",{get:function(){return this._fontSize},set:function(n){this._fontSize!==n&&(this._fontSize=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(n){this._fontStyle!==n&&(this._fontStyle=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(n){this._fontVariant!==n&&(this._fontVariant=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(n){this._fontWeight!==n&&(this._fontWeight=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(n){this._letterSpacing!==n&&(this._letterSpacing=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(n){this._lineHeight!==n&&(this._lineHeight=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"leading",{get:function(){return this._leading},set:function(n){this._leading!==n&&(this._leading=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(n){this._lineJoin!==n&&(this._lineJoin=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(n){this._miterLimit!==n&&(this._miterLimit=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"padding",{get:function(){return this._padding},set:function(n){this._padding!==n&&(this._padding=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"stroke",{get:function(){return this._stroke},set:function(n){var e=Rh(n);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(n){this._strokeThickness!==n&&(this._strokeThickness=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(n){this._textBaseline!==n&&(this._textBaseline=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"trim",{get:function(){return this._trim},set:function(n){this._trim!==n&&(this._trim=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(n){this._whiteSpace!==n&&(this._whiteSpace=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(n){this._wordWrap!==n&&(this._wordWrap=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(n){this._wordWrapWidth!==n&&(this._wordWrapWidth=n,this.styleID++)},enumerable:!1,configurable:!0}),o.prototype.toFontString=function(){var n=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;r>=0;r--){var s=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&cp.indexOf(s)<0&&(s='"'+s+'"'),e[r]=s}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+n+" "+e.join(",")},o}();function Sf(o){return typeof o=="number"?Nt(o):(typeof o=="string"&&o.indexOf("0x")===0&&(o=o.replace("0x","#")),o)}function Rh(o){if(Array.isArray(o)){for(var n=0;n<o.length;++n)o[n]=Sf(o[n]);return o}return Sf(o)}function Mc(o,n,e){for(var r in e)Array.isArray(n[r])?o[r]=n[r].slice():o[r]=n[r]}var ds=function(){function o(n,e,r,s,l,h,p,x,b){this.text=n,this.style=e,this.width=r,this.height=s,this.lines=l,this.lineWidths=h,this.lineHeight=p,this.maxLineWidth=x,this.fontProperties=b}return o.measureText=function(n,e,r,s){s===void 0&&(s=o._canvas),r=r==null?e.wordWrap:r;var l=e.toFontString(),h=o.measureFont(l);h.fontSize===0&&(h.fontSize=e.fontSize,h.ascent=e.fontSize);var p=s.getContext("2d");p.font=l;for(var x=(r?o.wordWrap(n,e,s):n).split(/(?:\r\n|\r|\n)/),b=new Array(x.length),w=0,R=0;R<x.length;R++){var H=p.measureText(x[R]).width+(x[R].length-1)*e.letterSpacing;b[R]=H,w=Math.max(w,H)}var z=w+e.strokeThickness;e.dropShadow&&(z+=e.dropShadowDistance);var q=e.lineHeight||h.fontSize+e.strokeThickness,at=Math.max(q,h.fontSize+e.strokeThickness)+(x.length-1)*(q+e.leading);return e.dropShadow&&(at+=e.dropShadowDistance),new o(n,e,z,at,x,b,q+e.leading,w,h)},o.wordWrap=function(n,e,r){r===void 0&&(r=o._canvas);for(var s=r.getContext("2d"),l=0,h="",p="",x=Object.create(null),b=e.letterSpacing,w=e.whiteSpace,R=o.collapseSpaces(w),H=o.collapseNewlines(w),z=!R,q=e.wordWrapWidth+b,at=o.tokenize(n),_t=0;_t<at.length;_t++){var bt=at[_t];if(o.isNewline(bt)){if(!H){p+=o.addLine(h),z=!R,h="",l=0;continue}bt=" "}if(R){var zt=o.isBreakingSpace(bt),De=o.isBreakingSpace(h[h.length-1]);if(zt&&De)continue}var an=o.getFromCache(bt,b,x,s);if(an>q)if(h!==""&&(p+=o.addLine(h),h="",l=0),o.canBreakWords(bt,e.breakWords))for(var Dt=o.wordWrapSplit(bt),ue=0;ue<Dt.length;ue++){for(var te=Dt[ue],he=1;Dt[ue+he];){var Ve=Dt[ue+he],Pe=te[te.length-1];if(o.canBreakChars(Pe,Ve,bt,ue,e.breakWords))break;te+=Ve,he++}ue+=te.length-1;var ie=o.getFromCache(te,b,x,s);ie+l>q&&(p+=o.addLine(h),z=!1,h="",l=0),h+=te,l+=ie}else{h.length>0&&(p+=o.addLine(h),h="",l=0);var pe=_t===at.length-1;p+=o.addLine(bt,!pe),z=!1,h="",l=0}else an+l>q&&(z=!1,p+=o.addLine(h),h="",l=0),(h.length>0||!o.isBreakingSpace(bt)||z)&&(h+=bt,l+=an)}return p+=o.addLine(h,!1)},o.addLine=function(n,e){return e===void 0&&(e=!0),n=o.trimRight(n),n=e?n+`
`:n},o.getFromCache=function(n,e,r,s){var l=r[n];if(typeof l!="number"){var h=n.length*e;l=s.measureText(n).width+h,r[n]=l}return l},o.collapseSpaces=function(n){return n==="normal"||n==="pre-line"},o.collapseNewlines=function(n){return n==="normal"},o.trimRight=function(n){if(typeof n!="string")return"";for(var e=n.length-1;e>=0;e--){var r=n[e];if(!o.isBreakingSpace(r))break;n=n.slice(0,-1)}return n},o.isNewline=function(n){return typeof n=="string"&&o._newlines.indexOf(n.charCodeAt(0))>=0},o.isBreakingSpace=function(n,e){return typeof n=="string"&&o._breakingSpaces.indexOf(n.charCodeAt(0))>=0},o.tokenize=function(n){var e=[],r="";if(typeof n!="string")return e;for(var s=0;s<n.length;s++){var l=n[s],h=n[s+1];o.isBreakingSpace(l,h)||o.isNewline(l)?(r!==""&&(e.push(r),r=""),e.push(l)):r+=l}return r!==""&&e.push(r),e},o.canBreakWords=function(n,e){return e},o.canBreakChars=function(n,e,r,s,l){return!0},o.wordWrapSplit=function(n){return n.split("")},o.measureFont=function(n){if(o._fonts[n])return o._fonts[n];var e={ascent:0,descent:0,fontSize:0},r=o._canvas,s=o._context;s.font=n;var l=o.METRICS_STRING+o.BASELINE_SYMBOL,h=Math.ceil(s.measureText(l).width),p=Math.ceil(s.measureText(o.BASELINE_SYMBOL).width),x=Math.ceil(o.HEIGHT_MULTIPLIER*p);p=p*o.BASELINE_MULTIPLIER|0,r.width=h,r.height=x,s.fillStyle="#f00",s.fillRect(0,0,h,x),s.font=n,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(l,0,p);var b=s.getImageData(0,0,h,x).data,w=b.length,R=4*h,H=0,z=0,q=!1;for(H=0;H<p;++H){for(var at=0;at<R;at+=4)if(b[z+at]!==255){q=!0;break}if(q)break;z+=R}for(e.ascent=p-H,z=w-R,q=!1,H=x;H>p;--H){for(at=0;at<R;at+=4)if(b[z+at]!==255){q=!0;break}if(q)break;z-=R}return e.descent=H-p,e.fontSize=e.ascent+e.descent,o._fonts[n]=e,e},o.clearMetrics=function(n){n===void 0&&(n=""),n?delete o._fonts[n]:o._fonts={}},o}(),Ac=function(){try{var o=new OffscreenCanvas(0,0),n=o.getContext("2d");return n&&n.measureText?o:document.createElement("canvas")}catch{return document.createElement("canvas")}}();Ac.width=Ac.height=10,ds._canvas=Ac,ds._context=Ac.getContext("2d"),ds._fonts={},ds.METRICS_STRING="|\xC9q\xC5",ds.BASELINE_SYMBOL="M",ds.BASELINE_MULTIPLIER=1.4,ds.HEIGHT_MULTIPLIER=2,ds._newlines=[10,13],ds._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var dp={texture:!0,children:!1,baseTexture:!0},Pc=function(o){function n(e,r,s){var l=this,h=!1;s||(s=document.createElement("canvas"),h=!0),s.width=3,s.height=3;var p=Nn.from(s);return p.orig=new Ln,p.trim=new Ln,(l=o.call(this,p)||this)._ownCanvas=h,l.canvas=s,l.context=l.canvas.getContext("2d"),l._resolution=Vt.RESOLUTION,l._autoResolution=!0,l._text=null,l._style=null,l._styleListener=null,l._font="",l.text=e,l.style=r,l.localStyleID=-1,l}return function(e,r){function s(){this.constructor=e}wf(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype.updateText=function(e){var r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),this.dirty||!e){this._font=this._style.toFontString();var s,l,h=this.context,p=ds.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),x=p.width,b=p.height,w=p.lines,R=p.lineHeight,H=p.lineWidths,z=p.maxLineWidth,q=p.fontProperties;this.canvas.width=Math.ceil((Math.max(1,x)+2*r.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,b)+2*r.padding)*this._resolution),h.scale(this._resolution,this._resolution),h.clearRect(0,0,this.canvas.width,this.canvas.height),h.font=this._font,h.lineWidth=r.strokeThickness,h.textBaseline=r.textBaseline,h.lineJoin=r.lineJoin,h.miterLimit=r.miterLimit;for(var at=r.dropShadow?2:1,_t=0;_t<at;++_t){var bt=r.dropShadow&&_t===0,zt=bt?Math.ceil(Math.max(1,b)+2*r.padding):0,De=zt*this._resolution;if(bt){h.fillStyle="black",h.strokeStyle="black";var an=r.dropShadowColor,Dt=Jt(typeof an=="number"?an:ge(an));h.shadowColor="rgba("+255*Dt[0]+","+255*Dt[1]+","+255*Dt[2]+","+r.dropShadowAlpha+")",h.shadowBlur=r.dropShadowBlur,h.shadowOffsetX=Math.cos(r.dropShadowAngle)*r.dropShadowDistance,h.shadowOffsetY=Math.sin(r.dropShadowAngle)*r.dropShadowDistance+De}else h.fillStyle=this._generateFillStyle(r,w,p),h.strokeStyle=r.stroke,h.shadowColor="black",h.shadowBlur=0,h.shadowOffsetX=0,h.shadowOffsetY=0;var ue=(R-q.fontSize)/2;(!n.nextLineHeightBehavior||R-q.fontSize<0)&&(ue=0);for(var te=0;te<w.length;te++)s=r.strokeThickness/2,l=r.strokeThickness/2+te*R+q.ascent+ue,r.align==="right"?s+=z-H[te]:r.align==="center"&&(s+=(z-H[te])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(w[te],s+r.padding,l+r.padding-zt,!0),r.fill&&this.drawLetterSpacing(w[te],s+r.padding,l+r.padding-zt)}this.updateTexture()}},n.prototype.drawLetterSpacing=function(e,r,s,l){l===void 0&&(l=!1);var h=this._style.letterSpacing;if(h!==0)for(var p=r,x=Array.from?Array.from(e):e.split(""),b=this.context.measureText(e).width,w=0,R=0;R<x.length;++R){var H=x[R];l?this.context.strokeText(H,p,s):this.context.fillText(H,p,s),p+=b-(w=this.context.measureText(e.substring(R+1)).width)+h,b=w}else l?this.context.strokeText(e,r,s):this.context.fillText(e,r,s)},n.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var r=oc(e);r.data&&(e.width=r.width,e.height=r.height,this.context.putImageData(r.data,0,0))}var s=this._texture,l=this._style,h=l.trim?0:l.padding,p=s.baseTexture;s.trim.width=s._frame.width=Math.ceil(e.width/this._resolution),s.trim.height=s._frame.height=Math.ceil(e.height/this._resolution),s.trim.x=-h,s.trim.y=-h,s.orig.width=s._frame.width-2*h,s.orig.height=s._frame.height-2*h,this._onTextureUpdate(),p.setRealSize(e.width,e.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},n.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),o.prototype._render.call(this,e)},n.prototype.getLocalBounds=function(e){return this.updateText(!0),o.prototype.getLocalBounds.call(this,e)},n.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},n.prototype._generateFillStyle=function(e,r,s){var l,h=e.fill;if(!Array.isArray(h))return h;if(h.length===1)return h[0];var p=e.dropShadow?e.dropShadowDistance:0,x=e.padding||0,b=Math.ceil(this.canvas.width/this._resolution)-p-2*x,w=Math.ceil(this.canvas.height/this._resolution)-p-2*x,R=h.slice(),H=e.fillGradientStops.slice();if(!H.length)for(var z=R.length+1,q=1;q<z;++q)H.push(q/z);if(R.unshift(h[0]),H.unshift(0),R.push(h[h.length-1]),H.push(1),e.fillGradientType===kl.LINEAR_VERTICAL){l=this.context.createLinearGradient(b/2,x,b/2,w+x);var at=(s.fontProperties.fontSize+e.strokeThickness)/w;for(q=0;q<r.length;q++)for(var _t=s.lineHeight*q,bt=0;bt<R.length;bt++){var zt=0;zt=typeof H[bt]=="number"?H[bt]:bt/R.length;var De=Math.min(1,Math.max(0,_t/w+zt*at));De=Number(De.toFixed(5)),l.addColorStop(De,R[bt])}}else{l=this.context.createLinearGradient(x,w/2,b+x,w/2);var an=R.length+1,Dt=1;for(q=0;q<R.length;q++){var ue=void 0;ue=typeof H[q]=="number"?H[q]:Dt/an,l.addColorStop(ue,R[q]),Dt++}}return l},n.prototype.destroy=function(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},dp,e),o.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(n.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var r=zr(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var r=zr(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this._style},set:function(e){e=e||{},this._style=e instanceof Vu?e:new Vu(e),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e==null?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),n.nextLineHeightBehavior=!1,n}(oi);/*!
 * @pixi/prepare - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Vt.UPLOADS_PER_FRAME=4;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Tf=function(o,n){return(Tf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Ef=function(){function o(n){this.maxItemsPerFrame=n,this.itemsLeft=0}return o.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},o.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},o}();function Mf(o,n){var e=!1;if(o&&o._textures&&o._textures.length){for(var r=0;r<o._textures.length;r++)if(o._textures[r]instanceof Nn){var s=o._textures[r].baseTexture;n.indexOf(s)===-1&&(n.push(s),e=!0)}}return e}function Cc(o,n){if(o.baseTexture instanceof On){var e=o.baseTexture;return n.indexOf(e)===-1&&n.push(e),!0}return!1}function fp(o,n){if(o._texture&&o._texture instanceof Nn){var e=o._texture.baseTexture;return n.indexOf(e)===-1&&n.push(e),!0}return!1}function pp(o,n){return n instanceof Pc&&(n.updateText(!0),!0)}function mp(o,n){if(n instanceof Vu){var e=n.toFontString();return ds.measureFont(e),!0}return!1}function gp(o,n){if(o instanceof Pc){n.indexOf(o.style)===-1&&n.push(o.style),n.indexOf(o)===-1&&n.push(o);var e=o._texture.baseTexture;return n.indexOf(e)===-1&&n.push(e),!0}return!1}function Af(o,n){return o instanceof Vu&&(n.indexOf(o)===-1&&n.push(o),!0)}var Bd=function(){function o(n){var e=this;this.limiter=new Ef(Vt.UPLOADS_PER_FRAME),this.renderer=n,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(gp),this.registerFindHook(Af),this.registerFindHook(Mf),this.registerFindHook(Cc),this.registerFindHook(fp),this.registerUploadHook(pp),this.registerUploadHook(mp)}return o.prototype.upload=function(n,e){typeof n=="function"&&(e=n,n=null),n&&this.add(n),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,ri.system.addOnce(this.tick,this,no.UTILITY))):e&&e()},o.prototype.tick=function(){setTimeout(this.delayedTick,0)},o.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var n=this.queue[0],e=!1;if(n&&!n._destroyed){for(var r=0,s=this.uploadHooks.length;r<s;r++)if(this.uploadHooks[r](this.uploadHookHelper,n)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)ri.system.addOnce(this.tick,this,no.UTILITY);else{this.ticking=!1;var l=this.completes.slice(0);for(this.completes.length=0,r=0,s=l.length;r<s;r++)l[r]()}},o.prototype.registerFindHook=function(n){return n&&this.addHooks.push(n),this},o.prototype.registerUploadHook=function(n){return n&&this.uploadHooks.push(n),this},o.prototype.add=function(n){for(var e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](n,this.queue);e++);if(n instanceof Wi)for(e=n.children.length-1;e>=0;e--)this.add(n.children[e]);return this},o.prototype.destroy=function(){this.ticking&&ri.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},o}();function Pf(o,n){return n instanceof On&&(n._glTextures[o.CONTEXT_UID]||o.texture.bind(n),!0)}function vp(o,n){if(!(n instanceof cs))return!1;var e=n.geometry;n.finishPoly(),e.updateBatches();for(var r=e.batches,s=0;s<r.length;s++){var l=r[s].style.texture;l&&Pf(o,l.baseTexture)}return e.batchable||o.geometry.bind(e,n._resolveDirectShader(o)),!0}function _p(o,n){return o instanceof cs&&(n.push(o),!0)}var Ih=function(o){function n(e){var r=o.call(this,e)||this;return r.uploadHookHelper=r.renderer,r.registerFindHook(_p),r.registerUploadHook(Pf),r.registerUploadHook(vp),r}return function(e,r){function s(){this.constructor=e}Tf(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n}(Bd),yp=function(){function o(n){this.maxMilliseconds=n,this.frameStart=0}return o.prototype.beginFrame=function(){this.frameStart=Date.now()},o.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},o}(),Ud=function(){function o(n,e,r){r===void 0&&(r=null),this._texture=n instanceof Nn?n:null,this.baseTexture=n instanceof On?n:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var s=this.baseTexture.resource;this.resolution=this._updateResolution(r||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return o.prototype._updateResolution=function(n){n===void 0&&(n=null);var e=this.data.meta.scale,r=vl(n,null);return r===null&&(r=e!==void 0?parseFloat(e):1),r!==1&&this.baseTexture.setResolution(r),r},o.prototype.parse=function(n){this._batchIndex=0,this._callback=n,this._frameKeys.length<=o.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},o.prototype._processFrames=function(n){for(var e=n,r=o.BATCH_SIZE;e-n<r&&e<this._frameKeys.length;){var s=this._frameKeys[e],l=this._frames[s],h=l.frame;if(h){var p=null,x=null,b=l.trimmed!==!1&&l.sourceSize?l.sourceSize:l.frame,w=new Ln(0,0,Math.floor(b.w)/this.resolution,Math.floor(b.h)/this.resolution);p=l.rotated?new Ln(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.h)/this.resolution,Math.floor(h.w)/this.resolution):new Ln(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution),l.trimmed!==!1&&l.spriteSourceSize&&(x=new Ln(Math.floor(l.spriteSourceSize.x)/this.resolution,Math.floor(l.spriteSourceSize.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution)),this.textures[s]=new Nn(this.baseTexture,p,w,x,l.rotated?2:0,l.anchor),Nn.addToCache(this.textures[s],s)}e++}},o.prototype._processAnimations=function(){var n=this.data.animations||{};for(var e in n){this.animations[e]=[];for(var r=0;r<n[e].length;r++){var s=n[e][r];this.animations[e].push(this.textures[s])}}},o.prototype._parseComplete=function(){var n=this._callback;this._callback=null,this._batchIndex=0,n.call(this,this.textures)},o.prototype._nextBatch=function(){var n=this;this._processFrames(this._batchIndex*o.BATCH_SIZE),this._batchIndex++,setTimeout(function(){n._batchIndex*o.BATCH_SIZE<n._frameKeys.length?n._nextBatch():(n._processAnimations(),n._parseComplete())},0)},o.prototype.destroy=function(n){var e;for(var r in n===void 0&&(n=!1),this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,n&&((e=this._texture)===null||e===void 0||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},o.BATCH_SIZE=1e3,o}(),Lh=function(){function o(){}return o.use=function(n,e){var r,s,l=this,h=n.name+"_image";if(n.data&&n.type===Vr.TYPE.JSON&&n.data.frames&&!l.resources[h]){var p=(s=(r=n.data)===null||r===void 0?void 0:r.meta)===null||s===void 0?void 0:s.related_multi_packs;if(Array.isArray(p))for(var x=function(z){if(typeof z!="string")return"continue";var q=z.replace(".json",""),at=Bo.resolve(n.url.replace(l.baseUrl,""),z);if(l.resources[q]||Object.values(l.resources).some(function(bt){return Bo.format(Bo.parse(bt.url))===at}))return"continue";var _t={crossOrigin:n.crossOrigin,loadType:Vr.LOAD_TYPE.XHR,xhrType:Vr.XHR_RESPONSE_TYPE.JSON,parentResource:n};l.add(q,at,_t)},b=0,w=p;b<w.length;b++)x(w[b]);var R={crossOrigin:n.crossOrigin,metadata:n.metadata.imageMetadata,parentResource:n},H=o.getResourcePath(n,l.baseUrl);l.add(h,H,R,function(z){if(z.error)e(z.error);else{var q=new Ud(z.texture,n.data,n.url);q.parse(function(){n.spritesheet=q,n.textures=q.textures,e()})}})}else e()},o.getResourcePath=function(n,e){return n.isDataUrl?n.data.meta.image:Bo.resolve(n.url.replace(e,""),n.data.meta.image)},o}(),kd=function(o,n){return(kd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function Rc(o,n){function e(){this.constructor=o}kd(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var vu=new xi,Ic=function(o){function n(e,r,s){r===void 0&&(r=100),s===void 0&&(s=100);var l=o.call(this,e)||this;return l.tileTransform=new Sl,l._width=r,l._height=s,l.uvMatrix=l.texture.uvMatrix||new Ss(e),l.pluginName="tilingSprite",l.uvRespectAnchor=!1,l}return Rc(n,o),Object.defineProperty(n.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)},enumerable:!1,configurable:!0}),n.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},n.prototype._render=function(e){var r=this._texture;r&&r.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},n.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,r=this._height*-this._anchor._y,s=this._width*(1-this._anchor._x),l=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,r,s,l)},n.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Ln),e=this._localBoundsRect),this._bounds.getRectangle(e)):o.prototype.getLocalBounds.call(this,e)},n.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,vu);var r=this._width,s=this._height,l=-r*this.anchor._x;if(vu.x>=l&&vu.x<l+r){var h=-s*this.anchor._y;if(vu.y>=h&&vu.y<h+s)return!0}return!1},n.prototype.destroy=function(e){o.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},n.from=function(e,r){return new n(e instanceof Nn?e:Nn.from(e,r),r.width,r.height)},Object.defineProperty(n.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!1,configurable:!0}),n}(oi),Lc=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,Oc=new li,Ba=function(o){function n(e){var r=o.call(this,e)||this,s={globals:r.renderer.globalUniforms};return r.shader=ua.from(Lc,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture2D(uSampler, coord);
    gl_FragColor = texSample * uColor;
}
`,s),r.simpleShader=ua.from(Lc,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 sample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = sample * uColor;
}
`,s),r.quad=new Ra,r.state=bs.for2d(),r}return Rc(n,o),n.prototype.render=function(e){var r=this.renderer,s=this.quad,l=s.vertices;l[0]=l[6]=e._width*-e.anchor.x,l[1]=l[3]=e._height*-e.anchor.y,l[2]=l[4]=e._width*(1-e.anchor.x),l[5]=l[7]=e._height*(1-e.anchor.y);var h=e.uvRespectAnchor?e.anchor.x:0,p=e.uvRespectAnchor?e.anchor.y:0;(l=s.uvs)[0]=l[6]=-h,l[1]=l[3]=-p,l[2]=l[4]=1-h,l[5]=l[7]=1-p,s.invalidate();var x=e._texture,b=x.baseTexture,w=e.tileTransform.localTransform,R=e.uvMatrix,H=b.isPowerOfTwo&&x.frame.width===b.width&&x.frame.height===b.height;H&&(b._glTextures[r.CONTEXT_UID]?H=b.wrapMode!==K.CLAMP:b.wrapMode===K.CLAMP&&(b.wrapMode=K.REPEAT));var z=H?this.simpleShader:this.shader,q=x.width,at=x.height,_t=e._width,bt=e._height;Oc.set(w.a*q/_t,w.b*q/bt,w.c*at/_t,w.d*at/bt,w.tx/_t,w.ty/bt),Oc.invert(),H?Oc.prepend(R.mapCoord):(z.uniforms.uMapCoord=R.mapCoord.toArray(!0),z.uniforms.uClampFrame=R.uClampFrame,z.uniforms.uClampOffset=R.uClampOffset),z.uniforms.uTransform=Oc.toArray(!0),z.uniforms.uColor=Pn(e.tint,e.worldAlpha,z.uniforms.uColor,b.alphaMode),z.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),z.uniforms.uSampler=x,r.shader.bind(z),r.geometry.bind(s),this.state.blendMode=hn(e.blendMode,b.alphaMode),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},n}(ci),Gl=function(o,n){return(Gl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function Hl(o,n){function e(){this.constructor=o}Gl(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var Gd=function(){function o(n,e){this.uvBuffer=n,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return o.prototype.update=function(n){if(n||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},o}(),zl=new xi,Wu=new yl,Xu=function(o){function n(e,r,s,l){l===void 0&&(l=_i.TRIANGLES);var h=o.call(this)||this;return h.geometry=e,e.refCount++,h.shader=r,h.state=s||bs.for2d(),h.drawMode=l,h.start=0,h.size=0,h.uvs=null,h.indices=null,h.vertexData=new Float32Array(1),h.vertexDirty=-1,h._transformID=-1,h._roundPixels=Vt.ROUND_PIXELS,h.batchUvs=null,h}return Hl(n,o),Object.defineProperty(n.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"material",{get:function(){return this.shader},set:function(e){this.shader=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(e){this.shader.tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(e){this.shader.texture=e},enumerable:!1,configurable:!0}),n.prototype._render=function(e){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===_i.TRIANGLES&&r.length<2*n.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)},n.prototype._renderDefault=function(e){var r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),e.batch.flush(),r.program.uniformData.translationMatrix&&(r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),e.shader.bind(r),e.state.set(this.state),e.geometry.bind(this.geometry,r),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},n.prototype._renderToBatch=function(e){var r=this.geometry,s=this.shader;s.uvMatrix&&(s.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=s._tintRGB,this._texture=s.texture;var l=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[l]),e.plugins[l].render(this)},n.prototype.calculateVertices=function(){var e=this.geometry.buffers[0],r=e.data,s=e._updateID;if(s!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));for(var l=this.transform.worldTransform,h=l.a,p=l.b,x=l.c,b=l.d,w=l.tx,R=l.ty,H=this.vertexData,z=0;z<H.length/2;z++){var q=r[2*z],at=r[2*z+1];H[2*z]=h*q+x*at+w,H[2*z+1]=p*q+b*at+R}if(this._roundPixels){var _t=Vt.RESOLUTION;for(z=0;z<H.length;++z)H[z]=Math.round((H[z]*_t|0)/_t)}this.vertexDirty=s}},n.prototype.calculateUvs=function(){var e=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new Gd(e,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},n.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},n.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,zl);for(var r=this.geometry.getBuffer("aVertexPosition").data,s=Wu.points,l=this.geometry.getIndex().data,h=l.length,p=this.drawMode===4?3:1,x=0;x+2<h;x+=p){var b=2*l[x],w=2*l[x+1],R=2*l[x+2];if(s[0]=r[b],s[1]=r[b+1],s[2]=r[w],s[3]=r[w+1],s[4]=r[R],s[5]=r[R+1],Wu.contains(zl.x,zl.y))return!0}return!1},n.prototype.destroy=function(e){o.prototype.destroy.call(this,e),this.geometry.refCount--,this.geometry.refCount===0&&this.geometry.dispose(),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},n.BATCHABLE_SIZE=100,n}(Wi),Oo=function(o){function n(e,r){var s=this,l={uSampler:e,alpha:1,uTextureMatrix:li.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(l,r.uniforms),(s=o.call(this,r.program||mh.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`),l)||this)._colorDirty=!1,s.uvMatrix=new Ss(e),s.batchable=r.program===void 0,s.pluginName=r.pluginName,s.tint=r.tint,s.alpha=r.alpha,s}return Hl(n,o),Object.defineProperty(n.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(e){this.uniforms.uSampler!==e&&(this.uniforms.uSampler=e,this.uvMatrix.texture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"alpha",{get:function(){return this._alpha},set:function(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(e){e!==this._tint&&(this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),n.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var e=this.texture.baseTexture;Pn(this._tint,this._alpha,this.uniforms.uColor,e.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},n}(ua),Ua=function(o){function n(e,r,s){var l=o.call(this)||this,h=new Gi(e),p=new Gi(r,!0),x=new Gi(s,!0,!0);return l.addAttribute("aVertexPosition",h,2,!1,k.FLOAT).addAttribute("aTextureCoord",p,2,!1,k.FLOAT).addIndex(x),l._updateId=-1,l}return Hl(n,o),Object.defineProperty(n.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),n}(Ho),Hd=function(o,n){return(Hd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Ds=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},cr=function(){function o(){}return o.test=function(n){return typeof n=="string"&&n.indexOf("info face=")===0},o.parse=function(n){var e=n.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var s in e){var l=e[s].match(/^[a-z]+/gm)[0],h=e[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(var x in h){var b=h[x].split("="),w=b[0],R=b[1].replace(/"/gm,""),H=parseFloat(R),z=isNaN(H)?R:H;p[w]=z}r[l].push(p)}var q=new Ds;return r.info.forEach(function(at){return q.info.push({face:at.face,size:parseInt(at.size,10)})}),r.common.forEach(function(at){return q.common.push({lineHeight:parseInt(at.lineHeight,10)})}),r.page.forEach(function(at){return q.page.push({id:parseInt(at.id,10),file:at.file})}),r.char.forEach(function(at){return q.char.push({id:parseInt(at.id,10),page:parseInt(at.page,10),x:parseInt(at.x,10),y:parseInt(at.y,10),width:parseInt(at.width,10),height:parseInt(at.height,10),xoffset:parseInt(at.xoffset,10),yoffset:parseInt(at.yoffset,10),xadvance:parseInt(at.xadvance,10)})}),r.kerning.forEach(function(at){return q.kerning.push({first:parseInt(at.first,10),second:parseInt(at.second,10),amount:parseInt(at.amount,10)})}),q},o}(),Oh=function(){function o(){}return o.test=function(n){return n instanceof XMLDocument&&n.getElementsByTagName("page").length&&n.getElementsByTagName("info")[0].getAttribute("face")!==null},o.parse=function(n){for(var e=new Ds,r=n.getElementsByTagName("info"),s=n.getElementsByTagName("common"),l=n.getElementsByTagName("page"),h=n.getElementsByTagName("char"),p=n.getElementsByTagName("kerning"),x=0;x<r.length;x++)e.info.push({face:r[x].getAttribute("face"),size:parseInt(r[x].getAttribute("size"),10)});for(x=0;x<s.length;x++)e.common.push({lineHeight:parseInt(s[x].getAttribute("lineHeight"),10)});for(x=0;x<l.length;x++)e.page.push({id:parseInt(l[x].getAttribute("id"),10)||0,file:l[x].getAttribute("file")});for(x=0;x<h.length;x++){var b=h[x];e.char.push({id:parseInt(b.getAttribute("id"),10),page:parseInt(b.getAttribute("page"),10)||0,x:parseInt(b.getAttribute("x"),10),y:parseInt(b.getAttribute("y"),10),width:parseInt(b.getAttribute("width"),10),height:parseInt(b.getAttribute("height"),10),xoffset:parseInt(b.getAttribute("xoffset"),10),yoffset:parseInt(b.getAttribute("yoffset"),10),xadvance:parseInt(b.getAttribute("xadvance"),10)})}for(x=0;x<p.length;x++)e.kerning.push({first:parseInt(p[x].getAttribute("first"),10),second:parseInt(p[x].getAttribute("second"),10),amount:parseInt(p[x].getAttribute("amount"),10)});return e},o}(),Yo=function(){function o(){}return o.test=function(n){if(typeof n=="string"&&n.indexOf("<font>")>-1){var e=new self.DOMParser().parseFromString(n,"text/xml");return Oh.test(e)}return!1},o.parse=function(n){var e=new self.DOMParser().parseFromString(n,"text/xml");return Oh.parse(e)},o}(),Si=[cr,Oh,Yo];function ka(o){for(var n=0;n<Si.length;n++)if(Si[n].test(o))return Si[n];return null}function zd(o,n,e,r,s,l){var h,p=e.fill;if(!Array.isArray(p))return p;if(p.length===1)return p[0];var x=e.dropShadow?e.dropShadowDistance:0,b=e.padding||0,w=Math.ceil(o.width/r)-x-2*b,R=Math.ceil(o.height/r)-x-2*b,H=p.slice(),z=e.fillGradientStops.slice();if(!z.length)for(var q=H.length+1,at=1;at<q;++at)z.push(at/q);if(H.unshift(p[0]),z.unshift(0),H.push(p[p.length-1]),z.push(1),e.fillGradientType===kl.LINEAR_VERTICAL){h=n.createLinearGradient(w/2,b,w/2,R+b);var _t=0,bt=(l.fontProperties.fontSize+e.strokeThickness)/R;for(at=0;at<s.length;at++)for(var zt=l.lineHeight*at,De=0;De<H.length;De++){var an=zt/R+(typeof z[De]=="number"?z[De]:De/H.length)*bt,Dt=Math.max(_t,an);Dt=Math.min(Dt,1),h.addColorStop(Dt,H[De]),_t=Dt}}else{h=n.createLinearGradient(b,R/2,w+b,R/2);var ue=H.length+1,te=1;for(at=0;at<H.length;at++){var he=void 0;he=typeof z[at]=="number"?z[at]:te/ue,h.addColorStop(he,H[at]),te++}}return h}function jd(o,n,e,r,s,l,h){var p=e.text,x=e.fontProperties;n.translate(r,s),n.scale(l,l);var b=h.strokeThickness/2,w=-h.strokeThickness/2;n.font=h.toFontString(),n.lineWidth=h.strokeThickness,n.textBaseline=h.textBaseline,n.lineJoin=h.lineJoin,n.miterLimit=h.miterLimit,n.fillStyle=zd(o,n,h,l,[p],e),n.strokeStyle=h.stroke,n.font=h.toFontString(),n.lineWidth=h.strokeThickness,n.textBaseline=h.textBaseline,n.lineJoin=h.lineJoin,n.miterLimit=h.miterLimit,n.fillStyle=zd(o,n,h,l,[p],e),n.strokeStyle=h.stroke;var R=h.dropShadowColor,H=Jt(typeof R=="number"?R:ge(R));h.dropShadow?(n.shadowColor="rgba("+255*H[0]+","+255*H[1]+","+255*H[2]+","+h.dropShadowAlpha+")",n.shadowBlur=h.dropShadowBlur,n.shadowOffsetX=Math.cos(h.dropShadowAngle)*h.dropShadowDistance,n.shadowOffsetY=Math.sin(h.dropShadowAngle)*h.dropShadowDistance):(n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),h.stroke&&h.strokeThickness&&n.strokeText(p,b,w+e.lineHeight-x.descent),h.fill&&n.fillText(p,b,w+e.lineHeight-x.descent),n.setTransform(1,0,0,1,0,0),n.fillStyle="rgba(0, 0, 0, 0)"}var Do=function(){function o(n,e,r){var s=n.info[0],l=n.common[0],h=vl(n.page[0].file),p={};this._ownsTextures=r,this.font=s.face,this.size=s.size,this.lineHeight=l.lineHeight/h,this.chars={},this.pageTextures=p;for(var x=0;x<n.page.length;x++){var b=n.page[x],w=b.id,R=b.file;p[w]=e instanceof Array?e[x]:e[R]}for(x=0;x<n.char.length;x++){var H=n.char[x],z=(w=H.id,H.page),q=n.char[x],at=q.x,_t=q.y,bt=q.width,zt=q.height,De=q.xoffset,an=q.yoffset,Dt=q.xadvance;_t/=h,bt/=h,zt/=h,De/=h,an/=h,Dt/=h;var ue=new Ln((at/=h)+p[z].frame.x/h,_t+p[z].frame.y/h,bt,zt);this.chars[w]={xOffset:De,yOffset:an,xAdvance:Dt,kerning:{},texture:new Nn(p[z].baseTexture,ue),page:z}}for(x=0;x<n.kerning.length;x++){var te=n.kerning[x],he=te.first,Ve=te.second,Pe=te.amount;he/=h,Ve/=h,Pe/=h,this.chars[Ve]&&(this.chars[Ve].kerning[he]=Pe)}}return o.prototype.destroy=function(){for(var n in this.chars)this.chars[n].texture.destroy(),this.chars[n].texture=null;for(var n in this.pageTextures)this._ownsTextures&&this.pageTextures[n].destroy(!0),this.pageTextures[n]=null;this.chars=null,this.pageTextures=null},o.install=function(n,e,r){var s;if(n instanceof Ds)s=n;else{var l=ka(n);if(!l)throw new Error("Unrecognized data format for font.");s=l.parse(n)}e instanceof Nn&&(e=[e]);var h=new o(s,e,r);return o.available[h.font]=h,h},o.uninstall=function(n){var e=o.available[n];if(!e)throw new Error("No font found named '"+n+"'");e.destroy(),delete o.available[n]},o.from=function(n,e,r){if(!n)throw new Error("[BitmapFont] Property `name` is required.");var s=Object.assign({},o.defaultOptions,r),l=s.chars,h=s.padding,p=s.resolution,x=s.textureWidth,b=s.textureHeight,w=function(mn){typeof mn=="string"&&(mn=[mn]);for(var kn=[],Jn=0,_r=mn.length;Jn<_r;Jn++){var or=mn[Jn];if(Array.isArray(or)){if(or.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+or.length+".");var Tr=or[0].charCodeAt(0),si=or[1].charCodeAt(0);if(si<Tr)throw new Error("[BitmapFont]: Invalid character range.");for(var ai=Tr,Bi=si;ai<=Bi;ai++)kn.push(String.fromCharCode(ai))}else kn.push.apply(kn,or.split(""))}if(kn.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return kn}(l),R=e instanceof Vu?e:new Vu(e),H=x,z=new Ds;z.info[0]={face:R.fontFamily,size:R.fontSize},z.common[0]={lineHeight:R.fontSize};for(var q,at,_t,bt=0,zt=0,De=0,an=[],Dt=0;Dt<w.length;Dt++){q||((q=document.createElement("canvas")).width=x,q.height=b,at=q.getContext("2d"),_t=new On(q,{resolution:p}),an.push(new Nn(_t)),z.page.push({id:an.length-1,file:""}));var ue=ds.measureText(w[Dt],R,!1,q),te=ue.width,he=Math.ceil(ue.height),Ve=Math.ceil((R.fontStyle==="italic"?2:1)*te);if(zt>=b-he*p){if(zt===0)throw new Error("[BitmapFont] textureHeight "+b+"px is too small for "+R.fontSize+"px fonts");--Dt,q=null,at=null,_t=null,zt=0,bt=0,De=0}else if(De=Math.max(he+ue.fontProperties.descent,De),Ve*p+bt>=H)--Dt,zt+=De*p,zt=Math.ceil(zt),bt=0,De=0;else{jd(q,at,ue,bt,zt,p,R);var Pe=ue.text.charCodeAt(0);z.char.push({id:Pe,page:an.length-1,x:bt/p,y:zt/p,width:Ve,height:he,xoffset:0,yoffset:0,xadvance:Math.ceil(te-(R.dropShadow?R.dropShadowDistance:0)-(R.stroke?R.strokeThickness:0))}),bt+=(Ve+2*h)*p,bt=Math.ceil(bt)}}Dt=0;for(var ie=w.length;Dt<ie;Dt++)for(var pe=w[Dt],rn=0;rn<ie;rn++){var Ye=w[rn],tn=at.measureText(pe).width,cn=at.measureText(Ye).width,ke=at.measureText(pe+Ye).width-(tn+cn);ke&&z.kerning.push({first:pe.charCodeAt(0),second:Ye.charCodeAt(0),amount:ke})}var Ce=new o(z,an,!0);return o.available[n]!==void 0&&o.uninstall(n),o.available[n]=Ce,Ce},o.ALPHA=[["a","z"],["A","Z"]," "],o.NUMERIC=[["0","9"]],o.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],o.ASCII=[[" ","~"]],o.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:o.ALPHANUMERIC},o.available={},o}(),Dc=[],Dh=[],Ti=function(o){function n(e,r){r===void 0&&(r={});var s=o.call(this)||this;s._tint=16777215;var l=Object.assign({},n.styleDefaults,r),h=l.align,p=l.tint,x=l.maxWidth,b=l.letterSpacing,w=l.fontName,R=l.fontSize;if(!Do.available[w])throw new Error('Missing BitmapFont "'+w+'"');return s._activePagesMeshData=[],s._textWidth=0,s._textHeight=0,s._align=h,s._tint=p,s._fontName=w,s._fontSize=R||Do.available[w].size,s._text=e,s._maxWidth=x,s._maxLineHeight=0,s._letterSpacing=b,s._anchor=new Ta(function(){s.dirty=!0},s,0,0),s._roundPixels=Vt.ROUND_PIXELS,s.dirty=!0,s._textureCache={},s}return function(e,r){function s(){this.constructor=e}Hd(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype.updateText=function(){for(var e,r=Do.available[this._fontName],s=this._fontSize/r.size,l=new xi,h=[],p=[],x=[],b=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",w=b.length,R=this._maxWidth*r.size/this._fontSize,H=null,z=0,q=0,at=0,_t=-1,bt=0,zt=0,De=0,an=0,Dt=0;Dt<w;Dt++){var ue=b.charCodeAt(Dt),te=b.charAt(Dt);if(/(?:\s)/.test(te)&&(_t=Dt,bt=z,an++),te!=="\r"&&te!==`
`){var he=r.chars[ue];if(he){H&&he.kerning[H]&&(l.x+=he.kerning[H]);var Ve=Dh.pop()||{texture:Nn.EMPTY,line:0,charCode:0,prevSpaces:0,position:new xi};Ve.texture=he.texture,Ve.line=at,Ve.charCode=ue,Ve.position.x=l.x+he.xOffset+this._letterSpacing/2,Ve.position.y=l.y+he.yOffset,Ve.prevSpaces=an,h.push(Ve),l.x+=he.xAdvance+this._letterSpacing,z=l.x,De=Math.max(De,he.yOffset+he.texture.height),H=ue,_t!==-1&&R>0&&l.x>R&&(Br(h,1+_t-++zt,1+Dt-_t),Dt=_t,_t=-1,p.push(bt),x.push(h.length>0?h[h.length-1].prevSpaces:0),q=Math.max(q,bt),at++,l.x=0,l.y+=r.lineHeight,H=null,an=0)}}else p.push(z),x.push(-1),q=Math.max(q,z),++at,++zt,l.x=0,l.y+=r.lineHeight,H=null,an=0}var Pe=b.charAt(b.length-1);Pe!=="\r"&&Pe!==`
`&&(/(?:\s)/.test(Pe)&&(z=bt),p.push(z),q=Math.max(q,z),x.push(-1));var ie=[];for(Dt=0;Dt<=at;Dt++){var pe=0;this._align==="right"?pe=q-p[Dt]:this._align==="center"?pe=(q-p[Dt])/2:this._align==="justify"&&(pe=x[Dt]<0?0:(q-p[Dt])/x[Dt]),ie.push(pe)}var rn=h.length,Ye={},tn=[],cn=this._activePagesMeshData;for(Dt=0;Dt<cn.length;Dt++)Dc.push(cn[Dt]);for(Dt=0;Dt<rn;Dt++){var ke=(ai=h[Dt].texture).baseTexture.uid;if(!Ye[ke]){if(!($n=Dc.pop())){var Ce=new Ua,mn=new Oo(Nn.EMPTY);$n={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new Xu(Ce,mn),vertices:null,uvs:null,indices:null}}$n.index=0,$n.indexCount=0,$n.vertexCount=0,$n.uvsCount=0,$n.total=0;var kn=this._textureCache;kn[ke]=kn[ke]||new Nn(ai.baseTexture),$n.mesh.texture=kn[ke],$n.mesh.tint=this._tint,tn.push($n),Ye[ke]=$n}Ye[ke].total++}for(Dt=0;Dt<cn.length;Dt++)tn.indexOf(cn[Dt])===-1&&this.removeChild(cn[Dt].mesh);for(Dt=0;Dt<tn.length;Dt++)tn[Dt].mesh.parent!==this&&this.addChild(tn[Dt].mesh);for(var Dt in this._activePagesMeshData=tn,Ye){var Jn=($n=Ye[Dt]).total;if(!(((e=$n.indices)===null||e===void 0?void 0:e.length)>6*Jn)||$n.vertices.length<2*Xu.BATCHABLE_SIZE)$n.vertices=new Float32Array(8*Jn),$n.uvs=new Float32Array(8*Jn),$n.indices=new Uint16Array(6*Jn);else for(var _r=$n.total,or=$n.vertices,Tr=4*_r*2;Tr<or.length;Tr++)or[Tr]=0;$n.mesh.size=6*Jn}for(Dt=0;Dt<rn;Dt++){var si=(te=h[Dt]).position.x+ie[te.line]*(this._align==="justify"?te.prevSpaces:1);this._roundPixels&&(si=Math.round(si));var ai,Bi=si*s,So=te.position.y*s,tr=Ye[(ai=te.texture).baseTexture.uid],ei=ai.frame,Wr=ai._uvs,rr=tr.index++;tr.indices[6*rr+0]=0+4*rr,tr.indices[6*rr+1]=1+4*rr,tr.indices[6*rr+2]=2+4*rr,tr.indices[6*rr+3]=0+4*rr,tr.indices[6*rr+4]=2+4*rr,tr.indices[6*rr+5]=3+4*rr,tr.vertices[8*rr+0]=Bi,tr.vertices[8*rr+1]=So,tr.vertices[8*rr+2]=Bi+ei.width*s,tr.vertices[8*rr+3]=So,tr.vertices[8*rr+4]=Bi+ei.width*s,tr.vertices[8*rr+5]=So+ei.height*s,tr.vertices[8*rr+6]=Bi,tr.vertices[8*rr+7]=So+ei.height*s,tr.uvs[8*rr+0]=Wr.x0,tr.uvs[8*rr+1]=Wr.y0,tr.uvs[8*rr+2]=Wr.x1,tr.uvs[8*rr+3]=Wr.y1,tr.uvs[8*rr+4]=Wr.x2,tr.uvs[8*rr+5]=Wr.y2,tr.uvs[8*rr+6]=Wr.x3,tr.uvs[8*rr+7]=Wr.y3}for(var Dt in this._textWidth=q*s,this._textHeight=(l.y+r.lineHeight)*s,Ye){var $n=Ye[Dt];if(this.anchor.x!==0||this.anchor.y!==0)for(var eo=0,dl=this._textWidth*this.anchor.x,hd=this._textHeight*this.anchor.y,up=0;up<$n.total;up++)$n.vertices[eo++]-=dl,$n.vertices[eo++]-=hd,$n.vertices[eo++]-=dl,$n.vertices[eo++]-=hd,$n.vertices[eo++]-=dl,$n.vertices[eo++]-=hd,$n.vertices[eo++]-=dl,$n.vertices[eo++]-=hd;this._maxLineHeight=De*s;var Sm=$n.mesh.geometry.getBuffer("aVertexPosition"),Tm=$n.mesh.geometry.getBuffer("aTextureCoord"),Em=$n.mesh.geometry.getIndex();Sm.data=$n.vertices,Tm.data=$n.uvs,Em.data=$n.indices,Sm.update(),Tm.update(),Em.update()}for(Dt=0;Dt<h.length;Dt++)Dh.push(h[Dt])},n.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},n.prototype.getLocalBounds=function(){return this.validate(),o.prototype.getLocalBounds.call(this)},n.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(e){if(this._tint!==e){this._tint=e;for(var r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=e}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(!Do.available[e])throw new Error('Missing BitmapFont "'+e+'"');this._fontName!==e&&(this._fontName=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"anchor",{get:function(){return this._anchor},set:function(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e==null?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),n.prototype.destroy=function(e){var r=this._textureCache;for(var s in r)r[s].destroy(),delete r[s];this._textureCache=null,o.prototype.destroy.call(this,e)},n.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},n}(Wi),Ei=function(){function o(){}return o.add=function(){Vr.setExtensionXhrType("fnt",Vr.XHR_RESPONSE_TYPE.TEXT)},o.use=function(n,e){var r=ka(n.data);if(r)for(var s=o.getBaseUrl(this,n),l=r.parse(n.data),h={},p=function(at){h[at.metadata.pageFile]=at.texture,Object.keys(h).length===l.page.length&&(n.bitmapFont=Do.install(l,h,!0),e())},x=0;x<l.page.length;++x){var b=l.page[x].file,w=s+b,R=!1;for(var H in this.resources){var z=this.resources[H];if(z.url===w){z.metadata.pageFile=b,z.texture?p(z):z.onAfterMiddleware.add(p),R=!0;break}}if(!R){var q={crossOrigin:n.crossOrigin,loadType:Vr.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:b},n.metadata.imageMetadata),parentResource:n};this.add(w,q,p)}}else e()},o.getBaseUrl=function(n,e){var r=e.isDataUrl?"":o.dirname(e.url);return e.isDataUrl&&(r==="."&&(r=""),n.baseUrl&&r&&n.baseUrl.charAt(n.baseUrl.length-1)==="/"&&(r+="/")),(r=r.replace(n.baseUrl,""))&&r.charAt(r.length-1)!=="/"&&(r+="/"),r},o.dirname=function(n){var e=n.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===n?".":e===""?"/":e},o}(),Vd=function(o,n){return(Vd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Wd=function(o){function n(e){e===void 0&&(e=1);var r=o.call(this,_h,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,{uAlpha:1})||this;return r.alpha=e,r}return function(e,r){function s(){this.constructor=e}Vd(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),Object.defineProperty(n.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),n}(zi),qu=function(o,n){return(qu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function Nc(o,n){function e(){this.constructor=o}qu(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var Xd,Nh,Zo,Yu,qd,Cf,jl,fs,dr,Yd,ps,Fc,Dr,Zs,Zd,Zu,Rf,If,Jr={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Lf=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);(function(o){o[o.WEBGL_LEGACY=0]="WEBGL_LEGACY",o[o.WEBGL=1]="WEBGL",o[o.WEBGL2=2]="WEBGL2"})(Xd||(Xd={})),function(o){o[o.UNKNOWN=0]="UNKNOWN",o[o.WEBGL=1]="WEBGL",o[o.CANVAS=2]="CANVAS"}(Nh||(Nh={})),function(o){o[o.COLOR=16384]="COLOR",o[o.DEPTH=256]="DEPTH",o[o.STENCIL=1024]="STENCIL"}(Zo||(Zo={})),function(o){o[o.NORMAL=0]="NORMAL",o[o.ADD=1]="ADD",o[o.MULTIPLY=2]="MULTIPLY",o[o.SCREEN=3]="SCREEN",o[o.OVERLAY=4]="OVERLAY",o[o.DARKEN=5]="DARKEN",o[o.LIGHTEN=6]="LIGHTEN",o[o.COLOR_DODGE=7]="COLOR_DODGE",o[o.COLOR_BURN=8]="COLOR_BURN",o[o.HARD_LIGHT=9]="HARD_LIGHT",o[o.SOFT_LIGHT=10]="SOFT_LIGHT",o[o.DIFFERENCE=11]="DIFFERENCE",o[o.EXCLUSION=12]="EXCLUSION",o[o.HUE=13]="HUE",o[o.SATURATION=14]="SATURATION",o[o.COLOR=15]="COLOR",o[o.LUMINOSITY=16]="LUMINOSITY",o[o.NORMAL_NPM=17]="NORMAL_NPM",o[o.ADD_NPM=18]="ADD_NPM",o[o.SCREEN_NPM=19]="SCREEN_NPM",o[o.NONE=20]="NONE",o[o.SRC_OVER=0]="SRC_OVER",o[o.SRC_IN=21]="SRC_IN",o[o.SRC_OUT=22]="SRC_OUT",o[o.SRC_ATOP=23]="SRC_ATOP",o[o.DST_OVER=24]="DST_OVER",o[o.DST_IN=25]="DST_IN",o[o.DST_OUT=26]="DST_OUT",o[o.DST_ATOP=27]="DST_ATOP",o[o.ERASE=26]="ERASE",o[o.SUBTRACT=28]="SUBTRACT",o[o.XOR=29]="XOR"}(Yu||(Yu={})),function(o){o[o.POINTS=0]="POINTS",o[o.LINES=1]="LINES",o[o.LINE_LOOP=2]="LINE_LOOP",o[o.LINE_STRIP=3]="LINE_STRIP",o[o.TRIANGLES=4]="TRIANGLES",o[o.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",o[o.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(qd||(qd={})),function(o){o[o.RGBA=6408]="RGBA",o[o.RGB=6407]="RGB",o[o.ALPHA=6406]="ALPHA",o[o.LUMINANCE=6409]="LUMINANCE",o[o.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",o[o.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",o[o.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Cf||(Cf={})),function(o){o[o.TEXTURE_2D=3553]="TEXTURE_2D",o[o.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",o[o.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",o[o.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",o[o.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",o[o.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",o[o.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(jl||(jl={})),function(o){o[o.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",o[o.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",o[o.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",o[o.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",o[o.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",o[o.FLOAT=5126]="FLOAT",o[o.HALF_FLOAT=36193]="HALF_FLOAT"}(fs||(fs={})),function(o){o[o.FLOAT=0]="FLOAT",o[o.INT=1]="INT",o[o.UINT=2]="UINT"}(dr||(dr={})),function(o){o[o.NEAREST=0]="NEAREST",o[o.LINEAR=1]="LINEAR"}(Yd||(Yd={})),function(o){o[o.CLAMP=33071]="CLAMP",o[o.REPEAT=10497]="REPEAT",o[o.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(ps||(ps={})),function(o){o[o.OFF=0]="OFF",o[o.POW2=1]="POW2",o[o.ON=2]="ON",o[o.ON_MANUAL=3]="ON_MANUAL"}(Fc||(Fc={})),function(o){o[o.NPM=0]="NPM",o[o.UNPACK=1]="UNPACK",o[o.PMA=2]="PMA",o[o.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",o[o.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",o[o.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Dr||(Dr={})),function(o){o[o.NO=0]="NO",o[o.YES=1]="YES",o[o.AUTO=2]="AUTO",o[o.BLEND=0]="BLEND",o[o.CLEAR=1]="CLEAR",o[o.BLIT=2]="BLIT"}(Zs||(Zs={})),function(o){o[o.AUTO=0]="AUTO",o[o.MANUAL=1]="MANUAL"}(Zd||(Zd={})),function(o){o.LOW="lowp",o.MEDIUM="mediump",o.HIGH="highp"}(Zu||(Zu={})),function(o){o[o.NONE=0]="NONE",o[o.SCISSOR=1]="SCISSOR",o[o.STENCIL=2]="STENCIL",o[o.SPRITE=3]="SPRITE"}(Rf||(Rf={})),function(o){o[o.NONE=0]="NONE",o[o.LOW=2]="LOW",o[o.MEDIUM=4]="MEDIUM",o[o.HIGH=8]="HIGH"}(If||(If={}));var Ga=function(o){function n(e,r,s,l,h){r===void 0&&(r=8),s===void 0&&(s=4),l===void 0&&(l=Vt.FILTER_RESOLUTION),h===void 0&&(h=5);var p=this,x=function(w,R){var H,z=Math.ceil(w/2),q=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`,at="";H=R?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var _t=0;_t<w;_t++){var bt=H.replace("%index%",_t.toString());at+=bt=bt.replace("%sampleIndex%",_t-(z-1)+".0"),at+=`
`}return q=(q=q.replace("%blur%",at)).replace("%size%",w.toString())}(h,e),b=function(w){for(var R,H=Jr[w],z=H.length,q=Lf,at="",_t=0;_t<w;_t++){var bt="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",_t.toString());R=_t,_t>=z&&(R=w-_t-1),at+=bt=bt.replace("%value%",H[R].toString()),at+=`
`}return q=(q=q.replace("%blur%",at)).replace("%size%",w.toString())}(h);return(p=o.call(this,x,b)||this).horizontal=e,p.resolution=l,p._quality=0,p.quality=s,p.blur=r,p}return Nc(n,o),n.prototype.apply=function(e,r,s,l){if(s?this.horizontal?this.uniforms.strength=1/s.width*(s.width/r.width):this.uniforms.strength=1/s.height*(s.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,s,l);else{var h=e.getFilterTexture(),p=e.renderer,x=r,b=h;this.state.blend=!1,e.applyFilter(this,x,b,Zs.CLEAR);for(var w=1;w<this.passes-1;w++){e.bindAndClear(x,Zs.BLIT),this.uniforms.uSampler=b;var R=b;b=x,x=R,p.shader.bind(this),p.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,b,s,l),e.returnFilterTexture(h)}},Object.defineProperty(n.prototype,"blur",{get:function(){return this.strength},set:function(e){this.padding=1+2*Math.abs(e),this.strength=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"quality",{get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e},enumerable:!1,configurable:!0}),n}(zi),Ju=function(o){function n(e,r,s,l){e===void 0&&(e=8),r===void 0&&(r=4),s===void 0&&(s=Vt.FILTER_RESOLUTION),l===void 0&&(l=5);var h=o.call(this)||this;return h.blurXFilter=new Ga(!0,e,r,s,l),h.blurYFilter=new Ga(!1,e,r,s,l),h.resolution=s,h.quality=r,h.blur=e,h.repeatEdgePixels=!1,h}return Nc(n,o),n.prototype.apply=function(e,r,s,l){var h=Math.abs(this.blurXFilter.strength),p=Math.abs(this.blurYFilter.strength);if(h&&p){var x=e.getFilterTexture();this.blurXFilter.apply(e,r,x,Zs.CLEAR),this.blurYFilter.apply(e,x,s,l),e.returnFilterTexture(x)}else p?this.blurYFilter.apply(e,r,s,l):this.blurXFilter.apply(e,r,s,l)},n.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(n.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(e){this.blurYFilter.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(e){this._repeatEdgePixels=e,this.updatePadding()},enumerable:!1,configurable:!0}),n}(zi),Fh=function(o,n){return(Fh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Ha=function(o){function n(){var e=this,r={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=o.call(this,Lu,`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,r)||this).alpha=1,e}return function(e,r){function s(){this.constructor=e}Fh(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype._loadMatrix=function(e,r){r===void 0&&(r=!1);var s=e;r&&(this._multiply(s,this.uniforms.m,e),s=this._colorMatrix(s)),this.uniforms.m=s},n.prototype._multiply=function(e,r,s){return e[0]=r[0]*s[0]+r[1]*s[5]+r[2]*s[10]+r[3]*s[15],e[1]=r[0]*s[1]+r[1]*s[6]+r[2]*s[11]+r[3]*s[16],e[2]=r[0]*s[2]+r[1]*s[7]+r[2]*s[12]+r[3]*s[17],e[3]=r[0]*s[3]+r[1]*s[8]+r[2]*s[13]+r[3]*s[18],e[4]=r[0]*s[4]+r[1]*s[9]+r[2]*s[14]+r[3]*s[19]+r[4],e[5]=r[5]*s[0]+r[6]*s[5]+r[7]*s[10]+r[8]*s[15],e[6]=r[5]*s[1]+r[6]*s[6]+r[7]*s[11]+r[8]*s[16],e[7]=r[5]*s[2]+r[6]*s[7]+r[7]*s[12]+r[8]*s[17],e[8]=r[5]*s[3]+r[6]*s[8]+r[7]*s[13]+r[8]*s[18],e[9]=r[5]*s[4]+r[6]*s[9]+r[7]*s[14]+r[8]*s[19]+r[9],e[10]=r[10]*s[0]+r[11]*s[5]+r[12]*s[10]+r[13]*s[15],e[11]=r[10]*s[1]+r[11]*s[6]+r[12]*s[11]+r[13]*s[16],e[12]=r[10]*s[2]+r[11]*s[7]+r[12]*s[12]+r[13]*s[17],e[13]=r[10]*s[3]+r[11]*s[8]+r[12]*s[13]+r[13]*s[18],e[14]=r[10]*s[4]+r[11]*s[9]+r[12]*s[14]+r[13]*s[19]+r[14],e[15]=r[15]*s[0]+r[16]*s[5]+r[17]*s[10]+r[18]*s[15],e[16]=r[15]*s[1]+r[16]*s[6]+r[17]*s[11]+r[18]*s[16],e[17]=r[15]*s[2]+r[16]*s[7]+r[17]*s[12]+r[18]*s[17],e[18]=r[15]*s[3]+r[16]*s[8]+r[17]*s[13]+r[18]*s[18],e[19]=r[15]*s[4]+r[16]*s[9]+r[17]*s[14]+r[18]*s[19]+r[19],e},n.prototype._colorMatrix=function(e){var r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r},n.prototype.brightness=function(e,r){var s=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(s,r)},n.prototype.greyscale=function(e,r){var s=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(s,r)},n.prototype.blackAndWhite=function(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)},n.prototype.hue=function(e,r){e=(e||0)/180*Math.PI;var s=Math.cos(e),l=Math.sin(e),h=1/3,p=(0,Math.sqrt)(h),x=[s+(1-s)*h,h*(1-s)-p*l,h*(1-s)+p*l,0,0,h*(1-s)+p*l,s+h*(1-s),h*(1-s)-p*l,0,0,h*(1-s)-p*l,h*(1-s)+p*l,s+h*(1-s),0,0,0,0,0,1,0];this._loadMatrix(x,r)},n.prototype.contrast=function(e,r){var s=(e||0)+1,l=-.5*(s-1),h=[s,0,0,0,l,0,s,0,0,l,0,0,s,0,l,0,0,0,1,0];this._loadMatrix(h,r)},n.prototype.saturate=function(e,r){e===void 0&&(e=0);var s=2*e/3+1,l=-.5*(s-1),h=[s,l,l,0,0,l,s,l,0,0,l,l,s,0,0,0,0,0,1,0];this._loadMatrix(h,r)},n.prototype.desaturate=function(){this.saturate(-1)},n.prototype.negative=function(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)},n.prototype.sepia=function(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)},n.prototype.technicolor=function(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)},n.prototype.polaroid=function(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)},n.prototype.toBGR=function(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)},n.prototype.kodachrome=function(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)},n.prototype.browni=function(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)},n.prototype.vintage=function(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)},n.prototype.colorTone=function(e,r,s,l,h){var p=((s=s||16770432)>>16&255)/255,x=(s>>8&255)/255,b=(255&s)/255,w=((l=l||3375104)>>16&255)/255,R=(l>>8&255)/255,H=(255&l)/255,z=[.3,.59,.11,0,0,p,x,b,e=e||.2,0,w,R,H,r=r||.15,0,p-w,x-R,b-H,0,0];this._loadMatrix(z,h)},n.prototype.night=function(e,r){var s=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(s,r)},n.prototype.predator=function(e,r){var s=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(s,r)},n.prototype.lsd=function(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)},n.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(n.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),n}(zi);Ha.prototype.grayscale=Ha.prototype.greyscale;/*!
 * @pixi/filter-displacement - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ni=function(o,n){return(Ni=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},di=function(o){function n(e,r){var s=this,l=new li;return e.renderable=!1,(s=o.call(this,`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`,`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,{mapSampler:e._texture,filterMatrix:l,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,s.maskMatrix=l,r==null&&(r=20),s.scale=new xi(r,r),s}return function(e,r){function s(){this.constructor=e}Ni(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype.apply=function(e,r,s,l){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var h=this.maskSprite.worldTransform,p=Math.sqrt(h.a*h.a+h.b*h.b),x=Math.sqrt(h.c*h.c+h.d*h.d);p!==0&&x!==0&&(this.uniforms.rotation[0]=h.a/p,this.uniforms.rotation[1]=h.b/p,this.uniforms.rotation[2]=h.c/x,this.uniforms.rotation[3]=h.d/x),e.applyFilter(this,r,s,l)},Object.defineProperty(n.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e},enumerable:!1,configurable:!0}),n}(zi),so=function(o,n){return(so=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Vl=function(o){function n(){return o.call(this,`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`)||this}return function(e,r){function s(){this.constructor=e}so(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n}(zi),$u=function(o,n){return($u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Wl=function(o){function n(e,r){e===void 0&&(e=.5),r===void 0&&(r=Math.random());var s=o.call(this,Lu,`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`,{uNoise:0,uSeed:0})||this;return s.noise=e,s.seed=r,s}return function(e,r){function s(){this.constructor=e}$u(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),Object.defineProperty(n.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e},enumerable:!1,configurable:!0}),n}(zi),Ku=new li;ni.prototype._cacheAsBitmap=!1,ni.prototype._cacheData=null,ni.prototype._cacheAsBitmapResolution=null;var Qu=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(ni.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(o){o!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=o,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(o){var n;this._cacheAsBitmap!==o&&(this._cacheAsBitmap=o,o?(this._cacheData||(this._cacheData=new Qu),(n=this._cacheData).originalRender=this.render,n.originalRenderCanvas=this.renderCanvas,n.originalUpdateTransform=this.updateTransform,n.originalCalculateBounds=this.calculateBounds,n.originalGetLocalBounds=this.getLocalBounds,n.originalDestroy=this.destroy,n.originalContainsPoint=this.containsPoint,n.originalMask=this._mask,n.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((n=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=n.originalRender,this.renderCanvas=n.originalRenderCanvas,this.calculateBounds=n.originalCalculateBounds,this.getLocalBounds=n.originalGetLocalBounds,this.destroy=n.originalDestroy,this.updateTransform=n.originalUpdateTransform,this.containsPoint=n.originalContainsPoint,this._mask=n.originalMask,this.filterArea=n.originalFilterArea))}}}),ni.prototype._renderCached=function(o){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(o),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(o))},ni.prototype._initCachedDisplayObject=function(o){if(!this._cacheData||!this._cacheData.sprite){var n=this.alpha;this.alpha=1,o.batch.flush();var e=this.getLocalBounds(null,!0).clone();if(this.filters){var r=this.filters[0].padding;e.pad(r)}e.ceil(Vt.RESOLUTION);var s=o.renderTexture.current,l=o.renderTexture.sourceFrame.clone(),h=o.renderTexture.destinationFrame.clone(),p=o.projection.transform,x=Zi.create({width:e.width,height:e.height,resolution:this.cacheAsBitmapResolution||o.resolution}),b="cacheAsBitmap_"+Ur();this._cacheData.textureCacheId=b,On.addToCache(x.baseTexture,b),Nn.addToCache(x,b);var w=this.transform.localTransform.copyTo(Ku).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender,o.render(this,{renderTexture:x,clear:!0,transform:w,skipUpdateTransform:!1}),o.projection.transform=p,o.renderTexture.bind(s,l,h),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;var R=new oi(x);R.transform.worldTransform=this.transform.worldTransform,R.anchor.x=-e.x/e.width,R.anchor.y=-e.y/e.height,R.alpha=n,R._bounds=this._bounds,this._cacheData.sprite=R,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=R.containsPoint.bind(R)}},ni.prototype._renderCachedCanvas=function(o){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(o),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(o))},ni.prototype._initCachedDisplayObjectCanvas=function(o){if(!this._cacheData||!this._cacheData.sprite){var n=this.getLocalBounds(null,!0),e=this.alpha;this.alpha=1;var r=o.context,s=o._projTransform;n.ceil(Vt.RESOLUTION);var l=Zi.create({width:n.width,height:n.height}),h="cacheAsBitmap_"+Ur();this._cacheData.textureCacheId=h,On.addToCache(l.baseTexture,h),Nn.addToCache(l,h);var p=Ku;this.transform.localTransform.copyTo(p),p.invert(),p.tx-=n.x,p.ty-=n.y,this.renderCanvas=this._cacheData.originalRenderCanvas,o.render(this,{renderTexture:l,clear:!0,transform:p,skipUpdateTransform:!1}),o.context=r,o._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;var x=new oi(l);x.transform.worldTransform=this.transform.worldTransform,x.anchor.x=-n.x/n.width,x.anchor.y=-n.y/n.height,x.alpha=e,x._bounds=this._bounds,this._cacheData.sprite=x,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=o._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=x.containsPoint.bind(x)}},ni.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},ni.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},ni.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,On.removeFromCache(this._cacheData.textureCacheId),Nn.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},ni.prototype._cacheAsBitmapDestroy=function(o){this.cacheAsBitmap=!1,this.destroy(o)},ni.prototype.name=null,Wi.prototype.getChildByName=function(o,n){for(var e=0,r=this.children.length;e<r;e++)if(this.children[e].name===o)return this.children[e];if(n){for(e=0,r=this.children.length;e<r;e++)if(this.children[e].getChildByName){var s=this.children[e].getChildByName(o,!0);if(s)return s}}return null},ni.prototype.getGlobalPosition=function(o,n){return o===void 0&&(o=new xi),n===void 0&&(n=!1),this.parent?this.parent.toGlobal(this.position,o,n):(o.x=this.position.x,o.y=this.position.y),o};/*!
 * @pixi/mesh-extras - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/mesh-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var tl=function(o,n){return(tl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function _u(o,n){function e(){this.constructor=o}tl(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var ma=function(o){function n(e,r,s,l){e===void 0&&(e=100),r===void 0&&(r=100),s===void 0&&(s=10),l===void 0&&(l=10);var h=o.call(this)||this;return h.segWidth=s,h.segHeight=l,h.width=e,h.height=r,h.build(),h}return _u(n,o),n.prototype.build=function(){for(var e=this.segWidth*this.segHeight,r=[],s=[],l=[],h=this.segWidth-1,p=this.segHeight-1,x=this.width/h,b=this.height/p,w=0;w<e;w++){var R=w%this.segWidth,H=w/this.segWidth|0;r.push(R*x,H*b),s.push(R/h,H/p)}var z=h*p;for(w=0;w<z;w++){var q=w%h,at=w/h|0,_t=at*this.segWidth+q,bt=at*this.segWidth+q+1,zt=(at+1)*this.segWidth+q,De=(at+1)*this.segWidth+q+1;l.push(_t,bt,zt,bt,De,zt)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(s),this.indexBuffer.data=new Uint16Array(l),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},n}(Ua),Xl=function(o){function n(e,r,s){e===void 0&&(e=200),s===void 0&&(s=0);var l=o.call(this,new Float32Array(4*r.length),new Float32Array(4*r.length),new Uint16Array(6*(r.length-1)))||this;return l.points=r,l._width=e,l.textureScale=s,l.build(),l}return _u(n,o),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),n.prototype.build=function(){var e=this.points;if(e){var r=this.getBuffer("aVertexPosition"),s=this.getBuffer("aTextureCoord"),l=this.getIndex();if(!(e.length<1)){r.data.length/4!==e.length&&(r.data=new Float32Array(4*e.length),s.data=new Float32Array(4*e.length),l.data=new Uint16Array(6*(e.length-1)));var h=s.data,p=l.data;h[0]=0,h[1]=0,h[2]=0,h[3]=1;for(var x=0,b=e[0],w=this._width*this.textureScale,R=e.length,H=0;H<R;H++){var z=4*H;if(this.textureScale>0){var q=b.x-e[H].x,at=b.y-e[H].y,_t=Math.sqrt(q*q+at*at);b=e[H],x+=_t/w}else x=H/(R-1);h[z]=x,h[z+1]=0,h[z+2]=x,h[z+3]=1}var bt=0;for(H=0;H<R-1;H++)z=2*H,p[bt++]=z,p[bt++]=z+1,p[bt++]=z+2,p[bt++]=z+2,p[bt++]=z+1,p[bt++]=z+3;s.update(),l.update(),this.updateVertices()}}},n.prototype.updateVertices=function(){var e=this.points;if(!(e.length<1)){for(var r,s=e[0],l=0,h=0,p=this.buffers[0].data,x=e.length,b=0;b<x;b++){var w=e[b],R=4*b;h=-((r=b<e.length-1?e[b+1]:w).x-s.x),l=r.y-s.y;var H=Math.sqrt(l*l+h*h),z=this.textureScale>0?this.textureScale*this._width/2:this._width/2;l/=H,h/=H,l*=z,h*=z,p[R]=w.x+l,p[R+1]=w.y+h,p[R+2]=w.x-l,p[R+3]=w.y-h,s=w}this.buffers[0].update()}},n.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},n}(Ua),Bh=function(o){function n(e,r,s){s===void 0&&(s=0);var l=this,h=new Xl(e.height,r,s),p=new Oo(e);return s>0&&(e.baseTexture.wrapMode=K.REPEAT),(l=o.call(this,h,p)||this).autoUpdate=!0,l}return _u(n,o),n.prototype._render=function(e){var r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),o.prototype._render.call(this,e)},n}(Xu),Bc=function(o){function n(e,r,s){var l=this,h=new ma(e.width,e.height,r,s),p=new Oo(Nn.WHITE);return(l=o.call(this,h,p)||this).texture=e,l}return _u(n,o),n.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var e=this.geometry;e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build()},Object.defineProperty(n.prototype,"texture",{get:function(){return this.shader.texture},set:function(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),n.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),o.prototype._render.call(this,e)},n.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),o.prototype.destroy.call(this,e)},n}(Xu),Jd=function(o){function n(e,r,s,l,h){e===void 0&&(e=Nn.EMPTY);var p=this,x=new Ua(r,s,l);x.getBuffer("aVertexPosition").static=!1;var b=new Oo(e);return(p=o.call(this,x,b,null,h)||this).autoUpdate=!0,p}return _u(n,o),Object.defineProperty(n.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e},enumerable:!1,configurable:!0}),n.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),o.prototype._render.call(this,e)},n}(Xu),Of=function(o){function n(e,r,s,l,h){r===void 0&&(r=10),s===void 0&&(s=10),l===void 0&&(l=10),h===void 0&&(h=10);var p=o.call(this,Nn.WHITE,4,4)||this;return p._origWidth=e.orig.width,p._origHeight=e.orig.height,p._width=p._origWidth,p._height=p._origHeight,p._leftWidth=r,p._rightWidth=l,p._topHeight=s,p._bottomHeight=h,p.texture=e,p}return _u(n,o),n.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(n.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e},enumerable:!1,configurable:!0}),n.prototype.updateHorizontalVertices=function(){var e=this.vertices,r=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*r,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*r,e[25]=e[27]=e[29]=e[31]=this._height},n.prototype.updateVerticalVertices=function(){var e=this.vertices,r=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*r,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*r,e[6]=e[14]=e[22]=e[30]=this._width},n.prototype._getMinScale=function(){var e=this._leftWidth+this._rightWidth,r=this._width>e?1:this._width/e,s=this._topHeight+this._bottomHeight,l=this._height>s?1:this._height/s;return Math.min(r,l)},Object.defineProperty(n.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(e){this._leftWidth=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(e){this._rightWidth=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"topHeight",{get:function(){return this._topHeight},set:function(e){this._topHeight=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(e){this._bottomHeight=e,this._refresh()},enumerable:!1,configurable:!0}),n.prototype._refresh=function(){var e=this.texture,r=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;var s=1/this._origWidth,l=1/this._origHeight;r[0]=r[8]=r[16]=r[24]=0,r[1]=r[3]=r[5]=r[7]=0,r[6]=r[14]=r[22]=r[30]=1,r[25]=r[27]=r[29]=r[31]=1,r[2]=r[10]=r[18]=r[26]=s*this._leftWidth,r[4]=r[12]=r[20]=r[28]=1-s*this._rightWidth,r[9]=r[11]=r[13]=r[15]=l*this._topHeight,r[17]=r[19]=r[21]=r[23]=1-l*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},n}(Bc),Uh=function(o,n){return(Uh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},ql=function(o){function n(e,r){r===void 0&&(r=!0);var s=o.call(this,e[0]instanceof Nn?e[0]:e[0].texture)||this;return s._textures=null,s._durations=null,s._autoUpdate=r,s._isConnectedToTicker=!1,s.animationSpeed=1,s.loop=!0,s.updateAnchor=!1,s.onComplete=null,s.onFrameChange=null,s.onLoop=null,s._currentTime=0,s._playing=!1,s._previousFrame=null,s.textures=e,s}return function(e,r){function s(){this.constructor=e}Uh(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(ri.shared.remove(this.update,this),this._isConnectedToTicker=!1))},n.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(ri.shared.add(this.update,this,no.HIGH),this._isConnectedToTicker=!0))},n.prototype.gotoAndStop=function(e){this.stop();var r=this.currentFrame;this._currentTime=e,r!==this.currentFrame&&this.updateTexture()},n.prototype.gotoAndPlay=function(e){var r=this.currentFrame;this._currentTime=e,r!==this.currentFrame&&this.updateTexture(),this.play()},n.prototype.update=function(e){if(this._playing){var r=this.animationSpeed*e,s=this.currentFrame;if(this._durations!==null){var l=this._currentTime%1*this._durations[this.currentFrame];for(l+=r/60*1e3;l<0;)this._currentTime--,l+=this._durations[this.currentFrame];var h=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);l>=this._durations[this.currentFrame];)l-=this._durations[this.currentFrame]*h,this._currentTime+=h;this._currentTime+=l/this._durations[this.currentFrame]}else this._currentTime+=r;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):s!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<s||this.animationSpeed<0&&this.currentFrame>s)&&this.onLoop(),this.updateTexture())}},n.prototype.updateTexture=function(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},n.prototype.destroy=function(e){this.stop(),o.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},n.fromFrames=function(e){for(var r=[],s=0;s<e.length;++s)r.push(Nn.from(e[s]));return new n(r)},n.fromImages=function(e){for(var r=[],s=0;s<e.length;++s)r.push(Nn.from(e[s]));return new n(r)},Object.defineProperty(n.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textures",{get:function(){return this._textures},set:function(e){if(e[0]instanceof Nn)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var r=0;r<e.length;r++)this._textures.push(e[r].texture),this._durations.push(e[r].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentFrame",{get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(ri.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(ri.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),n}(oi);/*!
 * pixi.js - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Zr.registerPlugin("accessibility",El),Zr.registerPlugin("extract",bi),Zr.registerPlugin("interaction",Pa),Zr.registerPlugin("particle",yf),Zr.registerPlugin("prepare",Ih),Zr.registerPlugin("batch",As),Zr.registerPlugin("tilingSprite",Ba),ss.registerPlugin(Ei),ss.registerPlugin(as),ss.registerPlugin(Na),ss.registerPlugin(Eh),ss.registerPlugin(Lh),lu.registerPlugin(Aa),lu.registerPlugin(_f);var Uc="6.0.4",Yl={AlphaFilter:Wd,BlurFilter:Ju,BlurFilterPass:Ga,ColorMatrixFilter:Ha,DisplacementFilter:di,FXAAFilter:Vl,NoiseFilter:Wl};class kc{constructor(n){this.target=n}get color(){return this.target.strokeColorFilter.currentColor}set color(n){this.target.strokeColorFilter.color=n}get on(){return this.target.strokeActive?"true":"false"}set on(n){this.target.strokeActive=n==="true"}}class $d{constructor(n){this.target=n}applyCommand(n,e){this.target.applyCommand(n,e)}}class Kd{constructor(n){this.target=n}get color(){return this.target.fillColorFilter.currentColor}set color(n){this.target.fillColorFilter.color=n}get on(){return this.target.fillActive?"true":"false"}set on(n){this.target.fillActive=n==="true"}}class Df{constructor(n,e){this.hardHidden=!1,this.target=n,e===!0&&(this.hardHidden=!0)}get opacity(){return this.target.alpha}set opacity(n){this.target.alpha=n}get rotation(){return this.target.rotation/Math.PI*180}set rotation(n){this.target.rotation=n/180*Math.PI}get visibility(){return this.target.visible?"visible":"hidden"}set visibility(n){this.visibility===n||this.hardHidden||(this.target.visible=n==="visible")}}class Qd{constructor(n,e){this.actions=[],this.ctx=e,this.object=n,this.object.interactive=!0}reset(n){this.object.interactive=!1,this.object.removeAllListeners(),this.object=n,this.object.interactive=!0}addAction(n,e){this.actions.push([n,e]),e==="click"?(this.object.addListener("click",()=>this.handleAction(n)),this.object.cursor="pointer"):e==="hover"&&this.object.addListener("mouseover",()=>this.handleAction(n))}addProxy(n){this.proxy=n,this.hitArea=this.getOriginHitArea(),this.proxy.interactive=!0,this.actions.forEach(([e,r])=>{var s,l;r==="click"?(s=this.proxy)===null||s===void 0||s.addListener("click",h=>this.handleProxyAction(h,e)):r==="hover"&&((l=this.proxy)===null||l===void 0||l.addListener("mouseover",h=>this.handleProxyAction(h,e)))})}handleProxyAction(n,e){var r;const s=n.data.global,l=this.object.getGlobalPosition(),h=s.x-l.x+this.object.pivot.x,p=s.y-l.y+this.object.pivot.y;((r=this.hitArea)===null||r===void 0?void 0:r.contains(h,p))&&this.handleAction(e,!0)}getOriginHitArea(){return this.object.hitArea?this.object.hitArea:new xl(0,0,this.object.width,this.object.height)}handleAction(n,e=!1){this.proxy&&!e||(this.ctx.eventHub.emit(wr.hyperlinkTrigger,n),this.execAction(n))}execAction(n){var e;if(n.action==="ppaction://hlinksldjump"){const r=((e=n==null?void 0:n.target)!==null&&e!==void 0?e:"").match(/slide(\d+)\.xml/);r&&r[1]&&this.ctx.eventHub.emit(Ya.goto,Number(r[1]))}else n.action==="ppaction://hlinkshowjump?jump=nextslide"?this.ctx.eventHub.emit(Ya.next):n.action==="ppaction://hlinkshowjump?jump=previousslide"&&this.ctx.eventHub.emit(Ya.prev)}}class Gc{constructor(n,e,r){var s,l,h,p,x,b;this.scaleExt={x:1,y:1},this.scaleOrigin={x:1,y:1},this.designScale={x:1,y:1},this.bound=new Ln(0,0,1,1),this.pptX=0,this.pptY=0,this.presetSubType=0,this.designWidth=0,this.designHeight=0,this.designX=0,this.designY=0,this.hasPreset=!1,this.container=new Wi,this.ctx=e,this.style=new Df(this.container,n.hardHidden),this.designGlobalPosition={x:r.x+((l=(s=n.position)===null||s===void 0?void 0:s.x)!==null&&l!==void 0?l:0),y:r.y+((p=(h=n.position)===null||h===void 0?void 0:h.y)!==null&&p!==void 0?p:0)},(n.hlinkClick||n.hlinkHover)&&(this.hyperlink=new Qd(this.container,this.ctx),n.hlinkHover&&((x=this.hyperlink)===null||x===void 0||x.addAction(n.hlinkHover,"hover")),n.hlinkClick&&((b=this.hyperlink)===null||b===void 0||b.addAction(n.hlinkClick,"click")))}updateScale(){this.container.scale.x=this.designScale.x*this.scaleExt.x*this.scaleOrigin.x,this.container.scale.y=this.designScale.y*this.scaleExt.y*this.scaleOrigin.y}updateTransform(n){var e,r,s,l,h,p,x,b;this.designWidth=n.width,this.designHeight=n.height,this.designX=(r=(e=n.position)===null||e===void 0?void 0:e.x)!==null&&r!==void 0?r:0,this.designY=(l=(s=n.position)===null||s===void 0?void 0:s.y)!==null&&l!==void 0?l:0;const w=this.designWidth/2,R=this.designHeight/2;this.container.width=this.designWidth,this.container.height=this.designHeight,this.container.pivot.x=w,this.container.pivot.y=R;const H=(p=(h=n.position)===null||h===void 0?void 0:h.x)!==null&&p!==void 0?p:0,z=(b=(x=n.position)===null||x===void 0?void 0:x.y)!==null&&b!==void 0?b:0;this.container.x=H+w,this.container.y=z+R,n.scale&&(this.designScale={x:n.scale.x,y:n.scale.y},this.container.scale.x=n.scale.x,this.container.scale.y=n.scale.y),n.rotation&&(this.container.rotation=n.rotation);const q=new cs;q.drawRect(0,0,this.designWidth,this.designHeight),this.container.addChild(q),this.json.hardHidden&&(this.container.visible=!1),this.bound.x=H,this.bound.y=z}get scale(){return this.container.scale}set scale(n){this.scaleOrigin.x=n.x,this.scaleOrigin.y=n.y,this.updateScale()}get design_ppt_w(){return this.designWidth/this.ctx.stageWidth}get design_ppt_h(){return this.designHeight/this.ctx.stageHeight}get design_ppt_x(){return this.designX/this.ctx.stageWidth}get design_ppt_y(){return this.designY/this.ctx.stageHeight}get ppt_w(){return this.scaleExt.x*this.scaleOrigin.x*this.designWidth/this.ctx.stageWidth}set ppt_w(n){this.scaleExt.x=n*this.ctx.stageWidth/this.designWidth,this.updateScale()}get ppt_h(){return this.scaleExt.y*this.scaleOrigin.y*this.designHeight/this.ctx.stageHeight}set ppt_h(n){this.scaleExt.y=n*this.ctx.stageHeight/this.designHeight,this.updateScale()}get ppt_x(){return(this.container.position.x-this.container.pivot.x)/this.ctx.stageWidth}set ppt_x(n){this.pptX=n;const e=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=n*this.ctx.stageWidth+this.container.pivot.x*e}get ppt_y(){return(this.container.position.y-this.container.pivot.y)/this.ctx.stageHeight}set ppt_y(n){this.pptY=n;const e=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=n*this.ctx.stageHeight+this.container.pivot.y*e}get r(){return this.container.rotation}set r(n){this.container.rotation=n}}class el{constructor(n){if(this._isInit=!1,this.h=0,this.s=0,this.l=0,this.a=1,n){this._isInit=!0;const e=n.match(/-?[0-9]+/g);e&&(this.h=parseInt(e[0],10),this.s=parseInt(e[1],10)/100,this.l=parseInt(e[2],10)/100)}}isInit(){return this._isInit}by(n,e){e.h=Math.max(Math.min(this.h+n.h,359),0),e.s=Math.max(Math.min(this.s+n.s,1),0),e.l=Math.max(Math.min(this.l+n.l,1),0),e.a=Math.max(Math.min(this.a+n.a,1),0)}fromHexString(n){const[e,r,s,l]=Js(n);let h=0,p=0,x=0;const b=Math.max(e,r,s),w=Math.min(e,r,s),R=b-w;x=(b+w)/2,R===0?h=0:b===e?h=(r-s)/R%6*60:b===r?h=60*((s-e)/R+2):b===s&&(h=60*((e-r)/R+4)),p=R===0?0:R/(1-Math.abs(2*x-1)),this.h=h,this.s=p,this.l=x,this.a=l}interpolationFrom(n,e,r){const s=n.h+(this.h-n.h)*e,l=n.s+(this.s-n.s)*e,h=n.l+(this.l-n.l)*e,p=n.a+(this.a-n.a)*e;r.h=Math.max(Math.min(s,359),0),r.s=Math.max(Math.min(l,1),0),r.l=Math.max(Math.min(h,1),0),r.a=Math.max(Math.min(p,1),0)}toHexString(){let n=[0,0,0,0];const{h:e,s:r,l:s}=this;if(e<360&&e>=0&&r<=1&&r>=0&&s<=1&&s>=0){let l,h,p;const x=(1-Math.abs(2*s-1))*r,b=x*(1-Math.abs(e/60%2-1)),w=s-x/2;[l,h,p]=e>=0&&e<60?[x,b,0]:e>=60&&e<120?[b,x,0]:e>=120&&e<180?[0,x,b]:e>=180&&e<240?[0,b,x]:e>=240&&e<300?[b,0,x]:[x,0,b],n=[l+w,h+w,p+w,this.a]}return Nf(n)}}class Yi{constructor(n){this._isInit=!1,this.r=0,this.g=0,this.b=0,this.a=0,n&&(this._isInit=!0,this.fromHexString(n))}fromHexString(n){const[e,r,s,l]=Js(n);this.r=e,this.g=r,this.b=s,this.a=l}isInit(){return this._isInit}interpolationFrom(n,e,r){r.r=n.r+(this.r-n.r)*e,r.g=n.g+(this.g-n.g)*e,r.b=n.b+(this.b-n.b)*e,r.a=n.a+(this.a-n.a)*e}by(n,e){e.r=Math.min(Math.max(this.r+n.r,0),255),e.g=Math.min(Math.max(this.g+n.g,0),255),e.b=Math.min(Math.max(this.b+n.b,0),255),e.a=Math.min(Math.max(this.a+n.a,0),1)}toHexString(){return Nf([this.r,this.g,this.b,this.a])}}function ga(o){const n=o.substring(1);return[parseInt(n.substring(0,6),16),parseInt(n.substring(6,8),16)/255]}function Js(o){return(o=o.replace(/^#/,"")).substring(6,8).length===0&&(o+="FF"),[parseInt(o.substring(0,2).padStart(8,"0"),16)/255,parseInt(o.substring(2,4).padStart(8,"0"),16)/255,parseInt(o.substring(4,6).padStart(8,"0"),16)/255,parseInt(o.substring(6,8).padStart(8,"0"),16)/255]}function Nf(o){return"#"+Math.round(255*o[0]).toString(16).padStart(2,"0")+Math.round(255*o[1]).toString(16).padStart(2,"0")+Math.round(255*o[2]).toString(16).padStart(2,"0")+Math.round(255*o[3]).toString(16).padStart(2,"0")}function za(o,n,e){const r=Js(o),s=Js(n),l=Math.round(255*(r[0]+(s[0]-r[0])*e)),h=Math.round(255*(r[1]+(s[1]-r[1])*e)),p=Math.round(255*(r[2]+(s[2]-r[2])*e)),x=Math.round(255*(r[3]+(s[3]-r[3])*e));return"#"+l.toString(16).padStart(2,"0")+h.toString(16).padStart(2,"0")+p.toString(16).padStart(2,"0")+x.toString(16).padStart(2,"0")}class kh extends zi{constructor(){super(void 0,`
varying vec2 vTextureCoord;

uniform vec4 color;
uniform sampler2D uSampler;

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);

    if (texColor.a > 0.0) {
        vec4 resultColor = color;
        resultColor = resultColor * texColor.a;
        gl_FragColor = resultColor;
    } else {
        gl_FragColor = texColor;
    }
}
`,{color:new Float32Array([0,0,0,0]),active:0}),this.currentColor="#FFFFFFFF"}set color(n){this.currentColor=n;const e=Js(n);this.uniforms.color=Float32Array.from(e)}get color(){return this.currentColor}}const tf=new Yl.ColorMatrixFilter;tf.matrix=[1,0,0,0,-.2,0,1,0,0,-.2,0,0,1,0,-.2,0,0,0,1,0];const Gh=new Yl.ColorMatrixFilter;Gh.matrix=[1,0,0,0,-.1,0,1,0,0,-.1,0,0,1,0,-.1,0,0,0,1,0];const Zl=new Yl.ColorMatrixFilter;Zl.matrix=[1,0,0,0,.2,0,1,0,0,.2,0,0,1,0,.2,0,0,0,1,0];const Hh=new Yl.ColorMatrixFilter;Hh.matrix=[1,0,0,0,.1,0,1,0,0,.1,0,0,1,0,.1,0,0,0,1,0];const ao={darken:tf,darkenLess:Gh,lightenLess:Hh,lighten:Zl};var Ff=S(3),nl=S.n(Ff);class Hc{constructor(n){this.scaleX=1,this.scaleY=1,this.pivot={x:0,y:0},this.paths=[],this.hash="",this.width=0,this.height=0,this.graphicsId="",this.textureId="",this.id=n.id,this.type=n.type,this.heightSize=n.heightSize,this.widthSize=n.widthSize,this.fillStyle=n.fillStyle||{fillType:"solidFill",color:"#ffffffff"},this.lineWidth=n.lineWidth||1,this.position=n.position||{x:0,y:0},this.rotate=n.rotation||1,this.path=this.getUnitPath(),this.setScaleFromLineWidth(),this.setScaleFromSize(),this.generatePaths(),this.setPivot()}setPivot(){switch(this.type){case"oval":case"diamond":this.pivot={x:this.width/2,y:this.height/2};break;case"arrow":case"stealth":case"triangle":default:this.pivot={x:this.width,y:this.height/2}}}generatePaths(){this.hash="arrow-"+nl()(this.path),this.paths=[{id:this.id,path:this.path,fill:"norm",hasStroke:!1,hash:this.hash,scale:{x:this.scaleX,y:this.scaleY}}]}getUnitPath(){switch(this.type){case"stealth":return"M 0,0 L 95250,47625 L 0,95250 L 28575,47625 C C";case"oval":return"M 0,47625 A 47625,47625,-3.14159265,6.2831853 C C";case"diamond":return"M 47625,0 L 95250,47625 L 47625,95250 L 0,47625 C C";case"arrow":return"M 9525,0 L 95250,47625 L 9525,95250 L 0,85725 L 68389.5,47625 L 0,9525 C C";case"triangle":return"M 0,0 L 95250,47625 L 0,95250 C C";default:return""}}setScaleFromLineWidth(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=.29*this.lineWidth+.7,this.scaleY*=.29*this.lineWidth+.7;break;default:throw new Error("can't match any arrow type!")}}setScaleFromSize(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=1,this.scaleY*=1;break;default:throw new Error("can't match any arrow type!")}switch(this.widthSize){case"sm":this.scaleX*=3/4;break;case"lg":this.scaleX*=1.25;break;case"med":this.scaleX*=1}switch(this.heightSize){case"sm":this.scaleY*=3/4;break;case"lg":this.scaleY*=1.25;break;case"med":this.scaleY*=1}this.width=10*this.scaleX,this.height=10*this.scaleY}}class zh extends Gc{constructor(n,e,r){super({position:{x:n.x,y:n.y},width:n.width,height:n.height},e,r),this.json=n,this.ctx=e,this.parentGlobalPos=r,this.global={x:r.x+n.x,y:r.y+n.y},this.updateTransform({position:{x:n.x,y:n.y},width:n.width,height:n.height})}get renderContainer(){return this.container}get interactiveContainer(){return this.container}getTextElement(){return null}getBgElement(){return null}get ppt_x(){return this.global.x/this.ctx.stageWidth}set ppt_x(n){const e=n*this.ctx.stageWidth-this.global.x,r=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=this.designX+e+this.container.pivot.x*r}get ppt_y(){return this.global.y/this.ctx.stageHeight}set ppt_y(n){const e=n*this.ctx.stageHeight-this.global.y,r=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=this.designY+e+this.container.pivot.y*r}get design_ppt_x(){return this.global.x/this.ctx.stageWidth}get design_ppt_y(){return this.global.y/this.ctx.stageHeight}}var zc=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class ja extends zh{constructor(n,e,r,s,l){super(n,e,r),this.lineWidth=s,this.lineHeight=l}getIterateEntry(){return null}getBgElement(){return null}preRender(){const{fill:n}=this.json;this.fillBgId=this.ctx.fillTexture.addFill(n.fill,this.lineWidth,this.lineHeight),this.fillTextureId=this.ctx.fillTexture.addFill({fillType:"blipFill",src:n.key,filters:[]},n.width,n.height)}render(){return zc(this,void 0,void 0,function*(){const n=new Wi;if(this.json.highlightColor){const s=new cs,[l,h]=ga(this.json.highlightColor);s.beginFill(l,h),s.drawRect(0,0,this.json.width,this.json.height),s.endFill(),n.addChild(s)}if(this.fillBgId&&this.fillTextureId){const s=this.ctx.fillTexture.getTexture(this.fillBgId),l=this.ctx.fillTexture.getTexture(this.fillTextureId);if(s&&l){const h=new oi;h.texture=l,h.scale.x=.5,h.scale.y=.5;const p=new oi;p.texture=s,p.mask=h,n.addChild(p),n.addChild(h)}}const e=Zi.create({width:this.json.width,height:this.json.height,resolution:2});this.ctx.renderer.render(n,{renderTexture:e});const r=new oi;r.texture=e,this.container.addChild(r),this.container.name=this.json.content,n.destroy({children:!0})})}destroy(){this.container.destroy({children:!0,texture:!0})}}var Bf=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class jc extends zh{constructor(){super(...arguments),this.units=[]}getIterateElements(){return this.units}getIterateEntry(n,e,r){return this.units[e]?this.units[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",r),null)}preRender(){for(let n=0,e=this.json.textUnits.length;n<e;n++){const r=this.json.textUnits[n];if(r.fill.fill){const s=new ja(r,this.ctx,this.global,this.json.width,this.json.height);s.preRender(),this.units.push(s)}}}render(){return Bf(this,void 0,void 0,function*(){for(const n of this.units.reverse())yield n.render(),this.container.addChild(n.container)})}destroy(){this.units.forEach(n=>{n.destroy()}),this.container.destroy({children:!1})}}var Jo=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class ef extends zh{constructor(){super(...arguments),this.iterateElements=[],this.lines=[]}getIterateElements(){if(this.iterateElements.length>0)return this.iterateElements;const n=this.lines.reduce((e,r)=>e=e.concat(r.getIterateElements()),[]);return this.iterateElements=n,n}getIterateEntry(n,e,r){const s=this.getIterateElements();return s[e]?s[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",r),null)}preRender(){for(let n=0,e=this.json.lines.length;n<e;n++){const r=this.json.lines[n],s=new jc(r,this.ctx,this.global);s.container.name="line-"+n,s.preRender(),this.lines.push(s)}}render(){return Jo(this,void 0,void 0,function*(){for(const n of this.lines)yield n.render(),this.container.addChild(n.container)})}destroy(){this.lines.forEach(n=>{n.destroy()}),this.container.destroy({children:!1})}}var rl=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class c{constructor(n,e,r,s){this.iterateElements=[],this.paragraphs=[],this.container=new Wi,this.json=n,this.ctx=e,this.parentGlobalPos=s,this.iterateType=r,this.container.name="textBody",this.global={x:this.parentGlobalPos.x+n.position.x,y:this.parentGlobalPos.y+n.position.y},this.container.position.x=n.position.x,this.container.position.y=n.position.y;const l=new cs;l.drawRect(0,0,n.width,n.height),this.container.addChild(l)}updateScale(n){this.container.scale.x=n.x,this.container.scale.y=n.y}getTextElement(n,e){return n==="paragraph"?this.paragraphs[e[0]]:null}getIterateEntry(n,e){return this.iterateElements[n]?this.iterateElements[n]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",e),null)}destroy(){this.paragraphs.forEach(n=>{n.destroy()})}preRender(){for(let n=0,e=this.json.paragraphs.length;n<e;n++){const r=this.json.paragraphs[n],s=new ef(r,this.ctx,this.global);s.preRender(),this.iterateElements=this.iterateElements.concat(s.getIterateElements()),s.container.name="\u6BB5\u843D-"+n,this.paragraphs.push(s)}}render(){return rl(this,void 0,void 0,function*(){for(const e of this.paragraphs)yield e.render(),this.container.addChild(e.container);const{width:n}=this.container;this.container.scale.x<0&&(this.container.x+=-1*n)})}}var g=S(19),T=S.n(g),N=S(20),W=S.n(N);const ht={Reflection:class extends zi{constructor(o){super(T.a,W.a,{uShapeFilterArea:new Float32Array([0,0,0,0]),uStartAlpha:o.startAlpha,uEndAlpha:o.endAlpha,uBlur:0}),this.json=o}}};var Tt=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};const It={pivot:{x:0,y:0},width:0,height:0};class qt extends Gc{constructor(n,e,r){var s,l,h,p;if(super(n,e,r),this.renderContainer=new Wi,this.bgTextureId="",this.bgSprite=new oi,this.backgroundMaskTextureId="",this.filterAreaJustifies=[],this.backgroundMask=new oi,this.pathStrokeTextureId="",this.pathSprite=new oi,this.pathMask=new oi,this.pathMaskTextureId="",this.fillColorFilter=new kh,this.strokeColorFilter=new kh,this.id="",this.arrowList=[],this.fill=new Kd(this),this.stroke=new kc(this),this.updateFilterArea=()=>{const x=this.renderContainer.getBounds(!1),b=this.filterAreaJustifies.map(z=>z(x)),w=b.map(z=>z.width),R=b.map(z=>z.height),H=new Ln(x.x,x.y,Math.max(...w),Math.max(...R));this.renderContainer.filterArea=H,this.renderContainer.filters.forEach(z=>{z.uniforms.uShapeFilterArea=new Float32Array(4),z.uniforms.uShapeFilterArea[0]=H.x,z.uniforms.uShapeFilterArea[1]=H.y,z.uniforms.uShapeFilterArea[2]=H.width,z.uniforms.uShapeFilterArea[3]=H.height})},this.json=n,this.id=n.id,this.container.name=n.id,this.fillStyle=n.fillStyle,this.lineStyle=n.lineStyle,this.geometry=n.geometry,this.ctx.timingTargets.addTarget(this.id,this),((s=this.fillStyle)===null||s===void 0?void 0:s.fillType)==="solidFill"&&(this.fillColorFilter.currentColor=this.fillStyle.color),((h=(l=this.lineStyle)===null||l===void 0?void 0:l.fill)===null||h===void 0?void 0:h.fillType)==="solidFill"&&(this.strokeColorFilter.currentColor=this.lineStyle.fill.color),this.pathSprite.name="path-fill",this.pathMask.name="path-mask",this.bgSprite.name="bg-fill",this.backgroundMask.name="bg-mask",this.updateTransform(this.json),n.textBody){this.text=new c(n.textBody,this.ctx,n.textBody.iterateType,{x:this.designGlobalPosition.x,y:this.designGlobalPosition.y});const x={x:1,y:1};((p=this.json.scale)===null||p===void 0?void 0:p.x)&&this.json.scale.x<0&&(x.x=-1),this.text.updateScale(x)}}get interactiveContainer(){return this.renderContainer}get strokeActive(){var n,e;return((e=(n=this.pathSprite.filters)===null||n===void 0?void 0:n.length)!==null&&e!==void 0?e:-1)>0}set strokeActive(n){var e,r;n?((r=(e=this.pathSprite.filters)===null||e===void 0?void 0:e.indexOf(this.strokeColorFilter))!==null&&r!==void 0?r:-1)<0&&(this.pathSprite.filters=[this.strokeColorFilter]):this.pathSprite.filters=[]}get fillActive(){var n,e;return((e=(n=this.bgSprite.filters)===null||n===void 0?void 0:n.length)!==null&&e!==void 0?e:-1)>0}set fillActive(n){var e,r;n?((r=(e=this.bgSprite.filters)===null||e===void 0?void 0:e.indexOf(this.fillColorFilter))!==null&&r!==void 0?r:-1)<0&&(this.bgSprite.filters=[this.fillColorFilter]):this.bgSprite.filters=[]}getTextElement(n,e){var r,s;return(s=(r=this.text)===null||r===void 0?void 0:r.getTextElement(n,e))!==null&&s!==void 0?s:null}getBgElement(){return this}getIterateEntry(n,e,r){return n==="el"||e===0?this:this.text?this.text.getIterateEntry(e-1,r)||null:(this.ctx.eventHub.emit("IterateTimeNodeEnd",r),null)}createBackgroundMask(){return Tt(this,void 0,void 0,function*(){const n=this.ctx.graphicsTexture.getGraphicsData(this.backgroundMaskTextureId);n&&(this.backgroundMask.texture=n.texture,this.backgroundMask.pivot.x=n.pivot.x,this.backgroundMask.pivot.y=n.pivot.y)})}createBackground(){var n,e,r,s,l,h,p;const{pivot:x,width:b,height:w}=((n=this.geometry)===null||n===void 0?void 0:n.fillTransform)||It;if(((e=this.fillStyle)===null||e===void 0?void 0:e.fillType)==="gifFill"){const R=this.ctx.fillTexture.getGifFrames(this.fillStyle.src);this.bgSprite=new ql(R,!0),this.bgSprite.play();const H=this.fillStyle.fps/60;let z=1;const q=this.fillStyle.loop;this.bgSprite.animationSpeed=H,this.bgSprite.onLoop=()=>{z+=1,q>0&&z>q&&this.bgSprite.gotoAndStop(R.length-1)},this.bgSprite.height=w||this.designHeight,this.bgSprite.width=b||this.designWidth,this.bgSprite.mask=this.backgroundMask,this.bgSprite.x=x.x,this.bgSprite.y=x.y,this.container.addChild(this.backgroundMask),this.container.addChild(this.bgSprite)}else if(((r=this.fillStyle)===null||r===void 0?void 0:r.fillType)==="groupFill"){if(this.groupFillTextureId){const R=this.ctx.fillTexture.getTexture(this.groupFillTextureId);R&&(this.bgSprite.texture=R,this.bgSprite.mask=this.backgroundMask,this.bgSprite.x=-1*((l=(s=this.json.position)===null||s===void 0?void 0:s.x)!==null&&l!==void 0?l:0),this.bgSprite.y=-1*((p=(h=this.json.position)===null||h===void 0?void 0:h.y)!==null&&p!==void 0?p:0),this.container.addChild(this.bgSprite),this.container.addChild(this.backgroundMask))}}else{const R=this.ctx.fillTexture.getTexture(this.bgTextureId);R&&(this.bgSprite.texture=R,this.bgSprite.mask=this.backgroundMask,this.container.addChild(this.backgroundMask),this.container.addChild(this.bgSprite),this.bgSprite.height=w||this.designHeight,this.bgSprite.width=b||this.designWidth,this.bgSprite.x=x.x,this.bgSprite.y=x.y)}}createPathFill(){const n=this.ctx.fillTexture.getTexture(this.pathStrokeTextureId);n&&(this.pathSprite.texture=n,this.pathSprite.pivot.x=this.pathMask.pivot.x,this.pathSprite.pivot.y=this.pathMask.pivot.y,this.pathMask.pivot.x=0,this.pathMask.pivot.y=0,this.pathSprite.mask=this.pathMask,this.pathSprite.addChild(this.pathMask),this.container.addChild(this.pathSprite))}createPathMask(){return Tt(this,void 0,void 0,function*(){const n=this.ctx.graphicsTexture.getGraphicsData(this.pathMaskTextureId);if(n){const{texture:e,pivot:r}=n;this.pathMask.texture=e,this.pathMask.pivot.x=r.x,this.pathMask.pivot.y=r.y,this.pathMask.texture=e}})}createFilledPathMask(){var n,e;return Tt(this,void 0,void 0,function*(){const r=((e=(n=this.geometry)===null||n===void 0?void 0:n.paths)===null||e===void 0?void 0:e.filter(s=>s.fill!=="none"&&s.fill!=="norm"))||[];for(const s of r){const l=this.ctx.graphicsTexture.getGraphicsData(s.id);if(l){const h=new oi(l.texture);h.pivot.x=l.pivot.x,h.pivot.y=l.pivot.y;const p=new oi(this.bgSprite.texture);p.pivot.x=this.bgSprite.pivot.x,p.pivot.y=this.bgSprite.pivot.y,p.mask=h,p.filters=[ao[s.fill]],this.container.addChild(p),this.container.addChild(h)}}})}createBackgroundTexture(){var n,e,r,s,l;if(this.fillStyle&&this.fillStyle.fillType!=="gifFill"&&this.fillStyle.fillType!=="groupFill"){const h=((n=this.geometry)===null||n===void 0?void 0:n.fillTransform)||It,p=(h==null?void 0:h.width)||this.designWidth,x=(h==null?void 0:h.height)||this.designHeight;this.bgTextureId=this.ctx.fillTexture.addFill(this.fillStyle,p+((r=(e=this.lineStyle)===null||e===void 0?void 0:e.width)!==null&&r!==void 0?r:0),x+((l=(s=this.lineStyle)===null||s===void 0?void 0:s.width)!==null&&l!==void 0?l:0))}}createPathFillTexture(){var n,e,r,s,l,h;if(((n=this.lineStyle)===null||n===void 0?void 0:n.fill)&&this.lineStyle.fill.fillType!=="gifFill"&&this.lineStyle.fill.fillType!=="groupFill"){const{width:p,height:x}=((e=this.geometry)===null||e===void 0?void 0:e.lineTransform)||It;this.pathStrokeTextureId=this.ctx.fillTexture.addFill(this.lineStyle.fill,(p||this.designWidth)+((s=(r=this.lineStyle)===null||r===void 0?void 0:r.width)!==null&&s!==void 0?s:0),(x||this.designHeight)+((h=(l=this.lineStyle)===null||l===void 0?void 0:l.width)!==null&&h!==void 0?h:0))}}createArrowFillTexture(){var n;(n=this.json.lineArrowList)===null||n===void 0||n.forEach(e=>{var r,s,l;const h=new Hc(Object.assign(Object.assign({},e),{fillStyle:(r=this.lineStyle)===null||r===void 0?void 0:r.fill,lineWidth:(s=this.lineStyle)===null||s===void 0?void 0:s.width}));h.graphicsId=this.ctx.graphicsTexture.addGraphics((l=h.paths)!==null&&l!==void 0?l:[],h.hash,h.pivot||{x:0,y:0},h.width,h.height,void 0,!0),h.textureId=this.ctx.fillTexture.addFill(h.fillStyle,h.width,h.height),this.arrowList.push(h)})}createArrow(){this.arrowList.forEach(n=>{const e=this.ctx.graphicsTexture.getGraphicsData(n.graphicsId),r=this.ctx.fillTexture.getTexture(n.textureId);if(e&&r){const{texture:s,pivot:l}=e,h=new oi(s);h.pivot.x=l.x,h.pivot.y=l.y;const p=new oi(r);p.addChild(h),p.mask=h,p.position.x=n.position.x,p.position.y=n.position.y,p.pivot.x=n.pivot.x,p.pivot.y=n.pivot.y,p.width=n.width,p.height=n.height,p.rotation=n.rotate/180*Math.PI,n.sprite=p,this.container.addChild(p)}})}preRender(){var n,e,r,s,l,h,p,x,b,w;this.createBackgroundTexture(),this.createPathFillTexture(),this.createArrowFillTexture();const{width:R,height:H,pivot:z}=((n=this.geometry)===null||n===void 0?void 0:n.lineTransform)||It,q=R||this.designWidth,at=H||this.designHeight;((e=this.geometry)===null||e===void 0?void 0:e.paths)&&this.geometry.paths.length>0&&(this.pathMaskTextureId=this.ctx.graphicsTexture.addGraphics((s=(r=this.geometry)===null||r===void 0?void 0:r.paths)!==null&&s!==void 0?s:[],this.geometry.hash,z||{x:0,y:0},q,at,this.lineStyle,!1),this.backgroundMaskTextureId=this.ctx.graphicsTexture.addGraphics((h=(l=this.geometry)===null||l===void 0?void 0:l.paths)!==null&&h!==void 0?h:[],this.geometry.hash,z||{x:0,y:0},q,at,this.lineStyle,!0));const _t=((x=(p=this.geometry)===null||p===void 0?void 0:p.paths)===null||x===void 0?void 0:x.filter(bt=>bt.fill!=="none"&&bt.fill!=="norm"))||[];for(const bt of _t)this.ctx.graphicsTexture.addGraphics([bt],bt.hash,(((b=this.geometry)===null||b===void 0?void 0:b.lineTransform)||It).pivot,q,at,this.lineStyle,!0,bt.id);(w=this.text)===null||w===void 0||w.preRender()}subClassRender(){return Tt(this,void 0,void 0,function*(){})}setupEffect(){const{effectList:n}=this.json;if(n&&n.length>0){const e=[];return n.forEach(r=>{r.type==="reflection"&&(this.filterAreaJustifies.push(s=>(s.height*=2,s)),e.push(new ht.Reflection(r)))}),this.ctx.ticker.add(this.updateFilterArea,void 0,-20),this.renderContainer.filters=e,!0}return!1}render(){var n,e,r,s,l,h,p;return Tt(this,void 0,void 0,function*(){yield this.createBackgroundMask(),yield this.createBackground(),yield this.subClassRender(),yield this.createFilledPathMask(),yield this.createPathMask(),yield this.createPathFill(),yield this.createArrow(),this.text&&(yield this.text.render()),((n=this.json.textBody)===null||n===void 0?void 0:n.iterateType)==="wd"||((e=this.json.textBody)===null||e===void 0?void 0:e.iterateType)==="lt"?(this.renderContainer.addChild(this.container),this.text&&(this.text.container.position.x=(s=(r=this.json.position)===null||r===void 0?void 0:r.x)!==null&&s!==void 0?s:0,this.text.container.position.y=(h=(l=this.json.position)===null||l===void 0?void 0:l.y)!==null&&h!==void 0?h:0,this.renderContainer.addChild(this.text.container))):(this.text&&this.container.addChild((p=this.text)===null||p===void 0?void 0:p.container),this.renderContainer.addChild(this.container)),this.json.cacheAsBitMap&&(this.renderContainer.cacheAsBitmap=!0)})}destroy(){this.bgSprite.destroy(),this.backgroundMask.destroy(),this.pathSprite.destroy(),this.pathMask.destroy(),this.fillColorFilter.destroy(),this.strokeColorFilter.destroy(),this.arrowList.forEach(n=>{var e;(e=n.sprite)===null||e===void 0||e.destroy()})}}var ve=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};function le(o,n){for(const e in n)o.style[e]=n[e]}class Ne{constructor(n){var e,r;this.progress=document.createElement("div"),this.totalTime=document.createElement("span"),this.playButton=document.createElement("div"),this.pauseButton=document.createElement("div"),this.currentTime=document.createElement("span"),this.mediaController=document.createElement("div"),this.currentProgress=document.createElement("div"),this.playCallBackList=[],this.duration=0,this.start=0,this.end=0,this.changeMediaProgress=s=>{s.stopPropagation();const l=s.offsetX/this.progress.clientWidth*this.duration;this.jumpToTime(l),this.ctx.eventHub.emit(wr.mediaSeek,{id:this.targetId,time:this.media.currentTime,isPlaying:this.media.isPlaying})},this.jumpToTime=(s=0)=>{const l=Math.floor(s)+this.start;this.media.currentTime!==l&&(this.media.currentTime=l,(this.media.paused||this.media.ended)&&setTimeout(()=>{this.media.play().then(()=>this.media.pause())}))},this.showController=s=>{s.stopPropagation(),this.show()},this.getMediaDuration=()=>{this.duration&&!Number.isNaN(this.duration)||(this.duration=this.media.duration,this.end?this.start?this.duration=this.duration-this.end-this.start:this.duration-=this.end:this.start&&(this.duration-=this.start)),this.totalTime.innerText=Ne.formatTime(this.duration)},this.playMedia=()=>ve(this,void 0,void 0,function*(){this.playButton.style.display="none",this.pauseButton.style.display="block",yield this.media.play(),this.playCallBackList.forEach(s=>{s()})}),this.pauseMedia=()=>ve(this,void 0,void 0,function*(){this.playButton.style.display="block",this.pauseButton.style.display="none",yield this.media.pause()}),this.onMouseOut=s=>{s.stopPropagation(),this.mediaController.style.display="none"},this.mediaTimeUpdate=()=>ve(this,void 0,void 0,function*(){const s=this.media.currentTime-this.start;(s>this.duration||this.media.ended)&&(yield this.pauseMedia(),this.jumpToTime()),this.currentTime.innerText=Ne.formatTime(s),this.currentProgress.style.flex=(s/this.duration).toString()}),this.onPauseMedia=()=>{this.playButton.style.display="block",this.pauseButton.style.display="none"},this.onPlayMedia=()=>{this.playButton.style.display="none",this.pauseButton.style.display="block",this.playCallBackList.forEach(s=>{s()})},this.playMediaFromCtrl=()=>{this.ctx.eventHub.emit(wr.mediaPlay,{id:this.targetId,time:this.media.currentTime}),this.playMedia()},this.pauseMediaFromCtrl=()=>{this.ctx.eventHub.emit(wr.mediaPause,{id:this.targetId,time:this.media.currentTime}),this.pauseMedia()},this.targetId=n.targetId,this.ctx=n.ctx,this.height=n.height,this.width=n.width,this.position=n.position,this.media=n.media,this.info=n.info,this.canvasElement=n.canvasElement,this.getMedianContainer(),this.createMediaController(),this.info.cut&&(this.start=(e=this.info.cut.start)!==null&&e!==void 0?e:0,this.end=(r=this.info.cut.end)!==null&&r!==void 0?r:0)}getMedianContainer(){let n=document.getElementById("median-container");n||(n=document.createElement("div"),n.id="median-container",this.canvasElement.parentElement.appendChild(n)),this.container=n}static formatTime(n){let e="00:00";if(n){const r=Math.floor(n/60),s=String(r<0?0:r).padStart(2,"0"),l=Math.floor(n%60);e=`${s}:${String(l<0?0:l).padStart(2,"0")}`}return e}createButton(){const n={marginLeft:"15px",marginRight:"10px",fontSize:"0",height:"20px"};le(this.playButton,Object.assign(Object.assign({},n),{display:"block"}));const e=document.createElement("img");le(e,{height:"20px"}),e.src="https://convertcdn.netless.link/publicFiles/icon/play.png",this.playButton.appendChild(e),le(this.pauseButton,Object.assign(Object.assign({},n),{display:"none"}));const r=document.createElement("img");le(r,{height:"20px"}),r.src="https://convertcdn.netless.link/publicFiles/icon/pause.png",this.pauseButton.appendChild(r)}createTimer(){const n=document.createElement("div");le(n,{width:"100px"}),this.currentTime.innerText="00:00";const e=document.createElement("span");return e.innerText="/",n.append(this.currentTime,e,this.totalTime),n}createProgress(){le(this.progress,{flex:"1",position:"relative",marginRight:"10px"});const n=document.createElement("div");le(n,{background:"#D9D9D9",position:"relative",height:"10px",display:"flex"}),this.progress.appendChild(n),le(this.currentProgress,{background:"#4F4F4F",top:"0px",left:"0",height:"10px",flex:"0"}),n.appendChild(this.currentProgress)}bindEvent(){this.mediaController.addEventListener("mouseover",this.showController,!1),this.mediaController.addEventListener("mouseout",this.onMouseOut,!1),this.progress.addEventListener("mousedown",this.changeMediaProgress,!1),this.playButton.addEventListener("click",this.playMediaFromCtrl,!1),this.pauseButton.addEventListener("click",this.pauseMediaFromCtrl,!1),this.media.on("durationchange",this.getMediaDuration,!1),this.media.on("timeupdate",this.mediaTimeUpdate,!1),this.media.on("pause",this.onPauseMedia,!1),this.media.on("play",this.onPlayMedia,!1)}createMediaController(){var n,e;const{position:r}=this,s=(e=(n=this.canvasElement.parentElement)===null||n===void 0?void 0:n.offsetWidth)!==null&&e!==void 0?e:0;r.x=r.x>s/2?r.x-300+this.width:r.x,r.y=r.y+this.height/2-25,le(this.mediaController,{height:"50px",borderRadius:"50px",width:"300px",flexDirection:"row",alignItems:"center",position:"absolute",left:r.x+"px",top:r.y+"px",display:"none",background:"#fff",zIndex:"2",border:"1px solid #ccc"}),this.createButton();const l=this.createTimer();this.createProgress(),this.mediaController.append(this.playButton,this.pauseButton,l,this.progress),this.container.appendChild(this.mediaController),this.bindEvent()}addPlayCallBack(n){this.playCallBackList.push(n)}unbindEvent(){this.mediaController.removeEventListener("mouseover",this.showController,!1),this.progress.removeEventListener("mousedown",this.changeMediaProgress,!1),this.playButton.removeEventListener("click",()=>this.playMedia(),!1),this.pauseButton.removeEventListener("click",()=>this.pauseMedia(),!1),this.media.removeListener("durationchange",this.getMediaDuration,!1),this.media.removeListener("timeupdate",this.mediaTimeUpdate,!1),this.media.removeListener("pause",this.onPauseMedia,!1),this.media.removeListener("play",this.onPlayMedia,!1)}show(){this.mediaController.style.display="flex"}hide(){this.mediaController.style.display="none"}destroy(){var n;this.unbindEvent(),this.playCallBackList=[],(n=this.container)===null||n===void 0||n.removeChild(this.mediaController)}}var yn=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class xn extends X.a{constructor(n){var e,r;super(),this.type="video",this.sprite=new oi,this.isPlaying=!1,this.id=n.id,this.video=n.video,this.start=(e=n.video.cut)===null||e===void 0?void 0:e.start,this.end=(r=n.video.cut)===null||r===void 0?void 0:r.end,this.container=n.container,this.ctx=n.ctx,this.ctx.medias[this.id]=this,this.videoResource=new Au(this.video.src,{autoLoad:!0,autoPlay:!1,updateFPS:30,crossorigin:!0});const{video:s,width:l,height:h,position:p}=n;this.controller=new Ne({targetId:n.id,ctx:n.ctx,width:l,height:h,position:p,media:this,info:s,canvasElement:n.canvasElement}),this.controller.addPlayCallBack(()=>{this.sprite.width=l,this.sprite.height=h,setTimeout(()=>{this.sprite.visible=!0},50)});const x=new On(null,{height:h,width:l});x.resource=this.videoResource,this.videoResource.bind(x),this.sprite=new oi,this.sprite.visible=!1,this.sprite.texture=new Nn(x),this.sprite.interactive=!0,this.container.addChild(this.sprite),this.sprite.on("mouseover",b=>{b.stopPropagation(),this.controller.show()}),this.sprite.on("mouseout",b=>{b.stopPropagation(),this.controller.hide()}),["durationchange","timeupdate","pause","play"].forEach(b=>{this.videoResource.source.addEventListener(b,()=>{b!=="timeupdate"||this.isPlaying||this.pause(),this.emit(b)})})}get currentTime(){var n,e;return(e=(n=this.videoResource.source)===null||n===void 0?void 0:n.currentTime)!==null&&e!==void 0?e:0}set currentTime(n){this.videoResource.source&&(this.videoResource.source.currentTime=n)}get paused(){var n,e;return(e=(n=this.videoResource.source)===null||n===void 0?void 0:n.paused)===null||e===void 0||e}get ended(){var n,e;return(e=(n=this.videoResource.source)===null||n===void 0?void 0:n.ended)===null||e===void 0||e}get duration(){var n,e;return(e=(n=this.videoResource.source)===null||n===void 0?void 0:n.duration)!==null&&e!==void 0?e:0}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){var n;return yn(this,void 0,void 0,function*(){this.isPlaying=!0,yield this.load(),yield(n=this.videoResource.source)===null||n===void 0?void 0:n.play()})}load(){return this.videoResource.load()}pause(){var n;this.isPlaying=!1,(n=this.videoResource.source)===null||n===void 0||n.pause()}togglePause(){this.isPlaying?this.pause():this.play()}seek(n){this.controller.jumpToTime(n)}destroy(){var n;this.sprite.interactive=!1,this.sprite.destroy({texture:!0,baseTexture:!0}),(n=this.videoResource)===null||n===void 0||n.destroy(),this.controller.destroy()}}var Bn=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class Me extends X.a{constructor(n){super(),this.type="audio",this.isPlaying=!1,this.id=n.id,this.audio=n.audio,this.container=n.container,this.container=n.container,this.audioEl=document.createElement("audio"),this.audioEl.src=this.audio.src,n.audio.cut&&(this.start=n.audio.cut.start,this.end=n.audio.cut.end),this.ctx=n.ctx,this.ctx.medias[this.id]=this;const{width:e,height:r,position:s}=n;this.controller=new Ne({targetId:n.id,ctx:n.ctx,height:r,width:e,position:s,media:this,info:this.audio,canvasElement:n.canvasElement}),["durationchange","timeupdate","pause","play"].forEach(l=>{this.audioEl.addEventListener(l,()=>{this.emit(l)})})}get currentTime(){return this.audioEl.currentTime}set currentTime(n){this.audioEl.currentTime=n}get paused(){return this.audioEl.paused}get ended(){return this.audioEl.ended}get duration(){return this.audioEl.duration}load(){return Promise.resolve()}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){return Bn(this,void 0,void 0,function*(){this.isPlaying=!0,yield this.audioEl.play()})}pause(){this.isPlaying=!1,this.audioEl.pause()}togglePause(){this.isPlaying?this.pause():this.play()}seek(n){this.controller.jumpToTime(n)}destroy(){this.audioEl.pause(),this.controller.destroy()}}var qe=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class Qn extends qt{constructor(n,e,r){super(Object.assign(Object.assign({},n),{type:"Shape"}),e,r),this.picTextureId="",this.picSprite=new oi,this.picMask=new oi,this.cmd=new $d(this),this.picFill=n.picFill,this.media=n==null?void 0:n.media}applyCommand(n,e){var r,s,l,h,p;if(e==="call")if(/playFrom\(([0-9.]+)\)/.test(n)){const x=n.match(/playFrom\(([0-9.]+)\)/),b=Number(x[1]||"0");(r=this.mediaPlayer)===null||r===void 0||r.play().then(()=>{var w;(w=this.mediaPlayer)===null||w===void 0||w.seek(b)})}else n==="custom-pause"?(s=this.mediaPlayer)===null||s===void 0||s.pause():n==="togglePause"?(l=this.mediaPlayer)===null||l===void 0||l.togglePause():n==="stop"&&((h=this.mediaPlayer)===null||h===void 0||h.pause(),(p=this.mediaPlayer)===null||p===void 0||p.seek(0))}renderPic(){var n,e,r;return qe(this,void 0,void 0,function*(){const s=this.ctx.fillTexture.getTexture(this.picTextureId);s&&(this.picSprite.texture=s),this.picMask.texture=this.backgroundMask.texture,this.picSprite.mask=this.picMask,this.picSprite.width=this.designWidth,this.picSprite.height=this.designHeight,this.container.addChild(this.picSprite),this.container.addChild(this.picMask),((n=this.media)===null||n===void 0?void 0:n.type)==="video"?(this.mediaPlayer=new xn({id:this.json.id+"-video",ctx:this.ctx,video:this.media,height:this.designHeight,width:this.designWidth,position:this.picSprite.getGlobalPosition(),container:this.container,canvasElement:this.ctx.view}),((e=this.mediaPlayer)===null||e===void 0?void 0:e.sprite)&&(this.mediaPlayer.sprite.mask=this.picMask)):((r=this.media)===null||r===void 0?void 0:r.type)==="audio"&&(this.mediaPlayer=new Me({id:this.json.id+"-audio",ctx:this.ctx,audio:this.media,height:this.designHeight,width:this.designWidth,position:this.picSprite.getGlobalPosition(),container:this.container,canvasElement:this.ctx.view})),this.mediaPlayer&&(this.picSprite.interactive=!0,this.picSprite.on("mouseover",()=>{this.mediaPlayer.showController()}),this.picSprite.on("mouseout",()=>{this.mediaPlayer.hideController()},!1))})}preRender(){if(super.preRender(),this.picFill.fillType!=="gifFill")this.picTextureId=this.ctx.fillTexture.addFill(this.picFill,this.designWidth,this.designHeight);else{let n=1;const e=this.ctx.fillTexture.getGifFrames(this.picFill.src);this.picSprite=new ql(e,!0),this.picSprite.play();const r=this.picFill.fps/60,s=this.picFill.loop;this.picSprite.animationSpeed=r,this.picSprite.onLoop=()=>{n+=1,s>0&&n>s&&this.picSprite.gotoAndStop(e.length-1)}}}subClassRender(){return qe(this,void 0,void 0,function*(){yield this.renderPic()})}destroy(){this.mediaPlayer&&(this.picSprite.interactive=!1,this.mediaPlayer.destroy(),this.mediaPlayer=void 0),this.picSprite.destroy(),this.picMask.destroy()}}var _n=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class qn extends Gc{constructor(n,e,r){var s,l,h,p;super(n,e,r),this.children=[],this.cacheSprite=new oi,this.json=n,this.container.name=n.id,this.ctx.timingTargets.addTarget(n.id,this);const x={x:(l=(s=n.position)===null||s===void 0?void 0:s.x)!==null&&l!==void 0?l:0,y:(p=(h=n.position)===null||h===void 0?void 0:h.y)!==null&&p!==void 0?p:0};n.children.forEach(b=>{let w=null;(b==null?void 0:b.type)==="Shape"?w=new qt(b,this.ctx,x):(b==null?void 0:b.type)==="Picture"?w=new Qn(b,this.ctx,x):(b==null?void 0:b.type)==="Container"&&(w=new qn(b,this.ctx,x)),w&&this.children.push(w)}),this.updateTransform(this.json)}get interactiveContainer(){return this.container}get renderContainer(){return this.container}preRender(){if(this.json.fillStyle)if(this.json.fillStyle.fillType==="groupFill")this.fillTextureId=this.groupFillTextureId;else{const{fillStyle:n,width:e,height:r}=this.json;this.fillTextureId=this.ctx.fillTexture.addFill(n,e,r)}for(const n of this.children)n.groupFillTextureId=this.fillTextureId,n.preRender()}getBgElement(){return null}getIterateEntry(){return null}getTextElement(){return null}render(){var n;return _n(this,void 0,void 0,function*(){const e=new Wi;for(const r of this.children)yield r.render(),r.renderContainer&&e.addChild(r.renderContainer),(r.json.hlinkHover||r.json.hlinkClick)&&((n=r.hyperlink)===null||n===void 0||n.addProxy(this.container));if(this.container.addChild(e),this.json.cacheAsTexture){const r=e.getBounds(),s=Math.min(r.x,this.designX,r.x+r.width,this.designX+this.designWidth),l=Math.max(r.x,this.designX,r.x+r.width,this.designX+this.designWidth),h=Math.min(r.y,this.designY,r.y+r.height,this.designY+this.designHeight),p=l-s,x=Math.max(r.y,this.designY,r.y+r.height,this.designY+this.designHeight)-h,b=this.designX-r.x,w=this.designY-r.y,R=Zi.create({width:p,height:x});e.position.x=b,e.position.y=w,this.ctx.renderer.render(e,{renderTexture:R}),this.cacheSprite.texture=R,this.cacheSprite.position.x=-b,this.cacheSprite.position.y=-w,this.container.addChild(this.cacheSprite),e.position.x=0,e.position.y=0,e.visible=!1}})}destroy(){this.cacheSprite&&this.cacheSprite.destroy({texture:!0}),this.children.forEach(n=>n.destroy()),this.container.destroy()}}class Cn extends X.a{constructor(n,e,r,s){super(),this.cond={},this.timeoutIds=[],this.condHandle=l=>{if(l)if(l.delay&&l.delay>0){const h=this.setTimeout(()=>{l.event&&(this.cond[l.event]=!0,this.detectTrigger())},l.delay);this.timeoutIds.push(h)}else this.cond[l.event]=!0,this.detectTrigger();else this.detectTrigger()},this.id=n,this.ctx=s,this.eventHubs=r,e.forEach(l=>{this.addCond(l)})}setTriggerParams(n){this.triggerParams=n}addCond(n){const e=()=>this.condHandle(n);n.event&&(/^shape/.test(n.event)||/^time/.test(n.event)?(this.cond[n.event]=!1,this.eventHubs.global.addListener(n.event,e)):/^runtime/.test(n.event)?(this.cond[n.event]=!1,this.eventHubs.runtime.addListener(n.event,e)):/^self/.test(n.event)?n.delay&&n.delay>0&&(this.cond[n.event]=!1,this.eventHubs.runtime.addListener(n.event,e)):this.cond[n.event]=!1)}setTimeout(n,e){let r=0;const s=l=>{r+=l/(Vt.TARGET_FPMS||.06),r>=e&&(n(),this.ctx.ticker.remove(s))};return this.ctx.ticker.add(s,void 0,-9),()=>{this.ctx.ticker.remove(s)}}isTrigger(){return Object.keys(this.cond).every(n=>!!this.cond[n])}isTriggerWithoutParent(){return Object.keys(this.cond).filter(n=>n!=="self").every(n=>!!this.cond[n])}detectTrigger(){if(Object.keys(this.cond).every(n=>!!this.cond[n])){Object.keys(this.cond).forEach(e=>{this.cond[e]=!1});const n=this.triggerParams;this.triggerParams=void 0,this.emit("active",n)}}reset(){Object.keys(this.cond).forEach(n=>{this.cond[n]=!1}),this.timeoutIds.forEach(n=>n())}}class fr extends X.a{constructor(n){super(),this.runtimeNodeEventHub=new X.a,this._currentSeqIndex=0,this._currentSeqState="idle",this.isForward=!0,this.autoPlay=!1,this.handlePrev=()=>{var R,H,z,q,at,_t;this.hasPrev()||!this.isMainSeq?this.currentSeqState==="idle"?(this.decrSeqIndex(),(R=this.commonTimeNode.children[this.currentSeqIndex])===null||R===void 0||R.commonTimeNode.seekToStart(),(H=this.commonTimeNode.children[this.currentSeqIndex])===null||H===void 0||H.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="running"?((z=this.commonTimeNode.children[this.currentSeqIndex])===null||z===void 0||z.commonTimeNode.seekToStart(),(q=this.commonTimeNode.children[this.currentSeqIndex])===null||q===void 0||q.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="end"&&(this.currentSeqIndex>=this.commonTimeNode.children.length&&(this.currentSeqIndex=this.commonTimeNode.children.length-1),(at=this.commonTimeNode.children[this.currentSeqIndex])===null||at===void 0||at.commonTimeNode.seekToStart(),(_t=this.commonTimeNode.children[this.currentSeqIndex])===null||_t===void 0||_t.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.globalEventHub.emit("c:prev slide")},this.handleNext=()=>{var R,H,z,q;this.hasNext()||!this.isMainSeq?this.currentSeqState==="idle"?(R=this.commonTimeNode.children[this.currentSeqIndex])===null||R===void 0||R.commonTimeNode.startTimeNodeForce():this.currentSeqState==="running"?((H=this.commonTimeNode.children[this.currentSeqIndex])===null||H===void 0||H.commonTimeNode.seekToEnd(!1,!0),this.currentSeqState="end",this.incrSeqIndex(),(z=this.commonTimeNode.children[this.currentSeqIndex])===null||z===void 0||z.commonTimeNode.startTimeNodeForce()):this.currentSeqState==="end"&&(this.incrSeqIndex(),(q=this.commonTimeNode.children[this.currentSeqIndex])===null||q===void 0||q.commonTimeNode.startTimeNodeForce()):this.globalEventHub.emit("c:next slide")};const{json:e,iterateType:r,isIterate:s,isSub:l,parent:h,ctx:p,eventHub:x,iterateIndex:b,iterateId:w}=n;this.isMainSeq=e.ctn.nodeType==="mainSeq",this.id=e.ctn.id,this.isIterate=s,this.json=e,this.ctx=p,this.globalEventHub=x,this.commonTimeNode=new Wc({json:e.ctn,isSub:l,eventHubs:{global:x,runtime:this.runtimeNodeEventHub},ctx:p,parent:h,isIterate:!1,iterateType:r,iterateIndex:b,iterateId:w}),this.bindShapeEvent(),this.nextConds=new Cn("mainSeq",e.nextCondLst,{global:x,runtime:this.runtimeNodeEventHub},this.ctx),this.prevConds=new Cn("mainSeq",e.preCondLst,{global:x,runtime:this.runtimeNodeEventHub},this.ctx),this.commonTimeNode.on("timeNodeRestart",()=>{this.currentSeqIndex=0,this.currentSeqState="idle"}),this.commonTimeNode.on("childTimeNodeStart",R=>{const H=this.commonTimeNode.children.findIndex(z=>z.commonTimeNode.uuid===R.id);H>=0&&(this.currentSeqIndex=H),this.currentSeqState="running",this.isMainSeq&&this.ctx.eventHub.emit(wr.mainSeqStepStart,H)}),this.commonTimeNode.on("childTimeNodeEnd",R=>{const H=this.commonTimeNode.children.findIndex(z=>z.commonTimeNode.uuid===R.id);H>=0&&(this.currentSeqIndex=H),this.currentSeqState="end",this.autoPlay&&setTimeout(()=>{this.handleNext()}),this.isMainSeq&&this.ctx.eventHub.emit(wr.mainSeqStepEnd,H)}),this.commonTimeNode.on("timeNodeEndSync",()=>{this.commonTimeNode.resetForRepeat(),setTimeout(()=>{this.currentSeqState="idle",this.currentSeqIndex=0})}),this.nextConds.on("active",this.handleNext),this.prevConds.on("active",this.handlePrev)}get currentSeqIndex(){return this._currentSeqIndex}set currentSeqIndex(n){this._currentSeqIndex=n,this.isMainSeq&&this.ctx.eventHub.emit(wr.mainSeqStepChange,n)}get currentSeqState(){return this._currentSeqState}set currentSeqState(n){this._currentSeqState=n,this.isMainSeq&&this.ctx.eventHub.emit(wr.mainSeqStateChange,n)}get stepLength(){return this.commonTimeNode.children.length}get currentStep(){return this.currentSeqIndex}get currentState(){return this.currentSeqState}startAutoPlay(){this.autoPlay=!0,this.commonTimeNode.children[0].commonTimeNode.startTimeNodeForce()}incrSeqIndex(){this.currentSeqIndex+1<=this.commonTimeNode.children.length&&(this.currentSeqIndex+=1)}decrSeqIndex(){this.currentSeqIndex-1>=-1&&(this.currentSeqIndex-=1)}hasPrev(){return!(this.currentSeqIndex<=0&&this.currentSeqState==="idle")}hasNext(){return!(this.currentSeqIndex>=this.commonTimeNode.children.length||this.currentSeqIndex===this.commonTimeNode.children.length-1&&this.currentSeqState==="end")}bindShapeEvent(){this.json.ctn.nodeType==="interactiveSeq"&&this.json.nextCondLst.forEach(n=>{if(/^shape/.test(n.event)){const e=n.event.split(" ")[1];if(e){const r=this.ctx.timingTargets.getTargetById(e);r&&(r.interactiveContainer.interactive=!0,r.interactiveContainer.cursor="pointer",r.interactiveContainer.on("pointerdown",()=>{const s=`shape ${e} onClick`;this.ctx.mode!=="interactive"&&this.ctx.mode!=="sync"||this.ctx.eventHub.emit(wr.interactiveAnimTrigger,{action:s,seqId:this.json.ctn.id}),this.ctx.mode!=="sync"&&this.ctx.mode!=="local"||this.globalEventHub.emit(s)}))}}})}setCurrentStep(n,e){let r=n;this.commonTimeNode.seekToStart();const{length:s}=this.commonTimeNode.children;if(r===-1&&(r=s-1),r>=0&&r<s)for(let l=0;l<=r;l++){const h=this.commonTimeNode.children[l];l!==r?h.commonTimeNode.seekToEnd(!1,!0):e==="start"?h.commonTimeNode.seekToStart():e==="end"&&h.commonTimeNode.seekToEnd(!1,!0)}this.currentSeqIndex=r,this.currentSeqState=e==="start"?"idle":"end"}}function Mn(o,n,e){const r=n.split(".");r.reduce((s,l,h)=>{if(s)return h!==r.length-1?s[l]:void(s[l]=e);console.warn(`${o} not support ${n}`)},o)}function Wn(o,n){return n.split(".").reduce((e,r)=>{if(e)return e[r];console.warn(`${o} not support ${n}`)},o)}const Fi=new class{constructor(){this.runningTimeNodes={}}addRunningTimeNode(o,n,e){const r=`${n}_${o}`;this.runningTimeNodes[r]&&this.runningTimeNodes[r].dispose(!0),this.runningTimeNodes[r]=e}};class gi{constructor(n){this.timingTarget=null,this.runtimeNodeEventHub=new X.a,this.onTimeLineStart=()=>{if(this.isConflict){const{target:R}=this.json.cBhvr;if(this.activeWhenConflict==="next"){let H=R.id;R.type==="shape"&&R.txEl&&(H=`${H}-txEl-${R.txEl.range[0]}`),this.commonTimeNode.isIterate&&(H=`${H}-iterate-${this.commonTimeNode.iterateIndex}`),Fi.addRunningTimeNode(H,this.modifyAttrKey,this.commonTimeNode)}else this.activeWhenConflict==="prev"&&this.commonTimeNode.dispose()}};const{isIterate:e,isSub:r,json:s,ctx:l,parent:h,eventHub:p,iterateType:x,iterateIndex:b,iterateId:w}=n;this.json=s,this.id=s.cBhvr.ctn.id,this.ctx=l,this.globalEventHub=p,this.commonTimeNode=new Wc({json:s.cBhvr.ctn,isSub:r,eventHubs:{global:p,runtime:this.runtimeNodeEventHub},ctx:l,parent:h,isIterate:e,iterateType:x,iterateIndex:b,iterateId:w}),this.timingTarget=this.ctx.timingTargets.getTarget(s.cBhvr.target,e,{type:x,index:b,id:w}),this.commonTimeNode.on("seekToStart",()=>this.onSeekToStart()),this.commonTimeNode.on("seekToEnd",()=>this.onSeekToEnd()),this.commonTimeNode.on("timelineStart",this.onTimeLineStart)}}class Ns extends gi{constructor(n){super(n),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.updateStartValue=()=>{this.timingTarget&&(this.startVal=Wn(this.timingTarget,this.json.cBhvr.attrList[0]))},this.onSeekToStart=()=>{const e=this.json.cBhvr.attrList[0];this.startVal!==null&&this.timingTarget&&Mn(this.timingTarget,e,this.startVal)},this.onSeekToEnd=()=>{const e=this.json.cBhvr.attrList[0],r=this.json.cBhvr.to||this.json.to;r&&this.timingTarget&&Mn(this.timingTarget,e,r)},this.commonTimeNode.on("timeNodeStart",this.updateStartValue),this.commonTimeNode.on("timeNodeCreate",this.updateStartValue),this.commonTimeNode.on("timeUpdate",({duration:e,delta:r})=>{if(r/e>=1){const s=this.json.cBhvr.attrList[0];this.json.cBhvr.attrList.length>1&&console.warn("this.json.cBhvr.attrList.length > 0");const l=this.json.cBhvr.to||this.json.to;l&&this.timingTarget&&Mn(this.timingTarget,s,l)}})}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}}class Mi{constructor(n,e){this.math={pi:Math.PI,e:Math.E,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,cosh:Math.cosh,deg:r=>r/Math.PI*180,exp:Math.exp,floor:Math.floor,ln:Math.log,max:Math.max,min:Math.min,rad:r=>r/180*Math.PI,rand:Math.random,sin:Math.sin,sinh:Math.sinh,sqrt:Math.sqrt,tan:Math.tan,tanh:Math.tanh},this.timingTarget=e,this.val=n.val.value,this.time=n.time,n.fmla&&(this.fmla=this.parseFmla(n.fmla))}parseFmla(n){let e=n.replaceAll("#ppt_h",`(${this.timingTarget.design_ppt_h})`);return e=e.replaceAll("#ppt_w",`(${this.timingTarget.design_ppt_w})`),e=e.replaceAll("#ppt_x",`(${this.timingTarget.design_ppt_x})`),e=e.replaceAll("#ppt_y",`(${this.timingTarget.design_ppt_y})`),e=e.replaceAll("ppt_w","vars.ppt_w"),e=e.replaceAll("ppt_h","vars.ppt_h"),e=e.replaceAll("ppt_x","vars.ppt_x"),e=e.replaceAll("ppt_y","vars.ppt_y"),e=e.replaceAll("#","vars."),["abs","acos","asin","atan","ceil","cos","cosh","deg","exp","floor","ln","max","min","rad","rand","sin","sinh","sqrt","tan","tanh","pi","e"].forEach(r=>{e=e.replaceAll(r,"math."+r)}),new Function("vars","math","$","return "+e)}}class $s extends Mi{constructor(n,e,r){super(n,e),this.value=n.val.value,r&&(this.fmla=this.parseFmla(r))}resolveValue(){return this.value}interpolationFrom(n,e,r){const s=n.resolveValue(r),l=s+(this.resolveValue()-s)*e;return n.fmla?n.fmla(r,this.math,l):l}}class Va extends Mi{constructor(n,e){var r;super(n,e),this.value=(r=n.val)===null||r===void 0?void 0:r.value}interpolationFrom(n,e,r){let s=n.resolveValue(r);return e>this.time&&(s=this.resolveValue()),s}resolveValue(){return this.value||""}}class ms extends Mi{constructor(n,e){super(n,e),this.fn=this.parseFmla(this.val)}resolveValue(n){return this.fn(n,this.math,1)}interpolationFrom(n,e,r){const s=n.resolveValue(r),l=s+(this.resolveValue(r)-s)*e;return n.fmla?n.fmla(r,this.math,l):l}}class yu extends gi{constructor(n){super(n),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.vars={ppt_x:0,ppt_y:0,ppt_w:0,ppt_h:0},this.keyFrames=[],this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal=Wn(this.timingTarget,this.json.cBhvr.attrList[0]))},this.updateVars=()=>{var e,r,s,l;((e=this.timingTarget)===null||e===void 0?void 0:e.ppt_h)&&(this.vars.ppt_h=this.timingTarget.ppt_h),((r=this.timingTarget)===null||r===void 0?void 0:r.ppt_w)&&(this.vars.ppt_w=this.timingTarget.ppt_w),((s=this.timingTarget)===null||s===void 0?void 0:s.ppt_x)&&(this.vars.ppt_x=this.timingTarget.ppt_x),((l=this.timingTarget)===null||l===void 0?void 0:l.ppt_y)&&(this.vars.ppt_y=this.timingTarget.ppt_y)},this.onTimeUpdate=({duration:e,delta:r})=>{const s=r/e,l=this.keyFrames.findIndex(R=>s<=R[0]);if(l<0){const R=this.keyFrames[this.keyFrames.length-1];return void(this.timingTarget&&Mn(this.timingTarget,this.json.cBhvr.attrList[0],R[1].resolveValue(this.vars)))}const h=l-1,p=this.keyFrames[l],x=this.keyFrames[h]||p,b=p[0]-x[0]==0?1:(s-x[0])/(p[0]-x[0]),w=p[1].interpolationFrom(x[1],b,this.vars);this.timingTarget&&Mn(this.timingTarget,this.json.cBhvr.attrList[0],w)},this.onSeekToStart=()=>{this.startVal!==null&&this.timingTarget&&Mn(this.timingTarget,this.json.cBhvr.attrList[0],this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.initKeyFrames(),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timelineStart",this.updateVars),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart)}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}initKeyFrames(){var n;const{valueType:e}=this.json;if(this.json.tavLst.length<=0){if(this.json.to){if(this.json.from||this.startVal){const s={time:0,val:{type:"string",value:this.json.from||this.startVal.toString()},fmla:""};if(e==="num"&&this.timingTarget){const l=new ms(s,this.timingTarget);this.keyFrames.push([s.time,l])}}const r={time:1,val:{type:"string",value:this.json.to},fmla:""};if(e==="num"&&this.timingTarget){const s=new ms(r,this.timingTarget);this.keyFrames.push([r.time,s])}}else if(this.json.by){const r={time:0,val:{type:"string",value:this.json.cBhvr.attrList[0]},fmla:""};if(e==="num"&&this.timingTarget){const l=new ms(r,this.timingTarget);this.keyFrames.push([r.time,l])}const s={time:1,val:{type:"string",value:(((n=r.val)===null||n===void 0?void 0:n.value)||"")+"+"+this.json.by},fmla:""};if(e==="num"&&this.timingTarget){const l=new ms(s,this.timingTarget);this.keyFrames.push([s.time,l])}}}if(this.json.tavLst.length>0){for(const r of this.json.tavLst)if(r.val&&this.timingTarget){let s=null;r.val.type==="string"?e==="num"?s=new ms(r,this.timingTarget):e==="str"&&(s=new Va(r,this.timingTarget)):r.val.type==="number"?s=new $s(r,this.timingTarget):(r.val.type==="color"||r.val.type==="boolean")&&console.warn("not implements"),s&&this.keyFrames.push([r.time,s])}}}}class Wa extends zi{constructor(n){super(`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;

uniform vec4 inputSize;
uniform vec4 outputFrame;
uniform float percent;
uniform float direction;
uniform float transition;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord(vec2 aVertexPosition)
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    vTransition = transition;
    vDirection = direction;
    vPercent = percent;
    vVertexPosition = aVertexPosition;
    vec2 localVertexPosition = aVertexPosition;
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord(localVertexPosition);
}
`,`
// \u7EB9\u7406\u5750\u6807
varying vec2 vTextureCoord;
// \u9876\u70B9\u5750\u6807
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;

uniform sampler2D uSampler;

void main(void){
    vec4 outputColor;

    float percent = vPercent;
    float direction = vDirection;
    
    if (vTransition < 0.0) {
        percent = 1.0 - percent;
        if (vDirection > 1.5 && vDirection < 2.5) {
            direction = 1.0;
        } else if (vDirection > 0.5 && vDirection < 1.5) {
            direction = 2.0;
        } else if (vDirection > 2.5 && vDirection < 3.5) {
            direction = 4.0;
        } else {
            direction = 3.0;
        }
    }

    if (direction > 1.5 && direction < 2.5) { // \u4ECE\u4E0B\u81F3\u4E0A\u663E\u793A
        if (vVertexPosition.y >= 1.0 - percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.y >= 1.0 - percent && vVertexPosition.y <= 1.0 - percent + 0.2 ) {
            outputColor = outputColor * ((vVertexPosition.y - (1.0 - percent)) / 0.2);
        }
    } else if (direction > 0.5 && direction < 1.5) { // \u4ECE\u4E0A\u81F3\u4E0B\u663E\u793A
        if (vVertexPosition.y <= percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.y <= percent && vVertexPosition.y >= percent - 0.2) {
            outputColor = outputColor * (1.0 - (vVertexPosition.y - (percent - 0.2)) / 0.2);
        }
    } else if (direction > 2.5 && direction < 3.5) { // \u4ECE\u5DE6\u5230\u53F3
        if (vVertexPosition.x <= percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.x <= percent && vVertexPosition.x >= percent - 0.2) {
            outputColor = outputColor * (1.0 - (vVertexPosition.x - (percent - 0.2)) / 0.2);
        }
    } else {
        if (vVertexPosition.x >= 1.0 - percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.x >= 1.0 - percent && vVertexPosition.x <= 1.0 - percent + 0.2) {
            outputColor = outputColor * ((vVertexPosition.x - (1.0 - percent)) / 0.2);
        }
    }

    gl_FragColor = outputColor;
}
`,{percent:0,direction:1,transition:n})}set percent(n){this.uniforms.percent=n}set direction(n){this.uniforms.direction=n}}class va extends zi{constructor(){super(void 0,`
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;

void main(void){
    vec4 color1 = texture2D(uSampler, vTextureCoord);
    if (color1.a != 0.0 && percent < 1.0) {
        float alpha = percent;
        gl_FragColor = color1 * alpha;
        return;
    }
    gl_FragColor = color1;
}
`,{percent:0})}set percent(n){this.uniforms.percent=n}}class Jl extends gi{constructor(n){var e;super(n),this.filterType="",this.isConflict=!0,this.activeWhenConflict="prev",this.onTimeUpdate=({duration:l,delta:h})=>{const p=h/l;this.filter&&(this.filter.percent=p),p>=1&&this.timingTarget&&(this.timingTarget.container.filters=[])},this.onSeekToStart=()=>{this.timingTarget&&(this.timingTarget.container.filters=[])},this.onSeekToEnd=()=>{this.timingTarget&&(this.timingTarget.container.filters=[])},this.commonTimeNode.on("timelineStart",()=>{this.filter&&this.timingTarget&&(this.timingTarget.container.filters=[this.filter])}),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate);let r=0;n.json.transition==="out"?r=-1:n.json.transition==="in"&&(r=1);const s=(e=n.json.filter)===null||e===void 0?void 0:e.match(/^([a-zA-Z]+)(\((.+)\))?/);if(s){const l=s[1],h=s[3];if(l==="wipe"){const p=new Wa(r);h==="up"?p.direction=1:h==="down"?p.direction=2:h==="left"?p.direction=3:h==="right"&&(p.direction=4),this.filter=p,this.filterType=`${l}-${h}`}else if(l==="fade"){const p=new va;this.filter=p,this.filterType=""+l}}}get modifyAttrKey(){return this.filterType}}var Vc=S(5);class il extends gi{constructor(n){super(n),this.isConflict=!0,this.activeWhenConflict="next",this.onTimeUpdate=({duration:e,delta:r})=>{var s;const l=r/e,h=(s=this.path)===null||s===void 0?void 0:s.getPoint(l);this.timingTarget&&h&&(this.timingTarget.ppt_x=h.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=h.y+ +this.timingTarget.design_ppt_y)},this.onSeekToStart=()=>{var e;const r=(e=this.path)===null||e===void 0?void 0:e.getPoint(0);this.timingTarget&&r&&(this.timingTarget.ppt_x=r.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=r.y+this.timingTarget.design_ppt_y)},this.onSeekToEnd=()=>{var e;const r=(e=this.path)===null||e===void 0?void 0:e.getPoint(1);this.timingTarget&&r&&(this.timingTarget.ppt_x=r.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=r.y+this.timingTarget.design_ppt_y)},this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.createPath()}get modifyAttrKey(){return"motion"}createPath(){var n;const e=new Vc.Path,r=(n=this.json.path)===null||n===void 0?void 0:n.match(/[MLCmlc][^MLCmlc]+/g);if(r)for(const s of r){const[l,...h]=s.trim().replace(/\s+/g," ").split(" ");if(l==="M"){const[p,x]=h.map(b=>Number(b));e.moveTo(p,x)}else if(l==="L"){const[p,x]=h.map(b=>Number(b));e.lineTo(p,x)}else if(l==="C"){const[p,x,b,w,R,H]=h.map(z=>Number(z));e.bezierCurveTo(p,x,b,w,R,H)}else if(l==="Z")e.closePath();else if(l==="E")console.warn("not implements");else if(l==="c"){const[p,x,b,w,R,H]=h.map(q=>Number(q)),z=e.currentPoint;e.bezierCurveTo(p+z.x,x+z.y,b+z.x,w+z.y,R+z.x,H+z.y)}else if(l==="l"){const p=e.currentPoint,[x,b]=h.map(w=>Number(w));e.lineTo(x+p.x,b+p.y)}else if(l==="m"){const p=e.currentPoint,[x,b]=h.map(w=>Number(w));e.moveTo(x+p.x,b+p.y)}}this.path=e}}class jh extends gi{constructor(n){super(n),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.onTimelineStart=e=>{e.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:e,delta:r})=>{const s=r/e,l={x:1,y:1};if(this.from&&this.to)l.x=this.from.x+(this.to.x-this.from.x)*s,l.y=this.from.y+(this.to.y-this.from.y)*s;else if(this.by){const h={x:this.by.x,y:this.by.y};l.x=1+(h.x-1)*s,l.y=1+(h.y-1)*s}this.timingTarget&&(this.timingTarget.scale=l)},this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})},this.onSeekToStart=()=>{this.timingTarget&&this.startVal&&(this.timingTarget.scale=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.from=n.json.from,this.to=n.json.to,this.by=n.json.by,this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart)}get modifyAttrKey(){return"scale"}updateCurrentValue(){this.timingTarget&&(this.current={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})}}class ol extends gi{constructor(n){super(n),this.isConflict=!1,this.activeWhenConflict="next",this.startColorString=null,this.currentColorString="#FFFFFFFF",this.onTimelineStart=e=>{this.from.isInit()||this.from.fromHexString(this.currentColorString),this.to.isInit()||this.from.by(this.by,this.to),e.isReverse||this.updateCurrentValue();const[r]=this.json.cBhvr.attrList[0].split(".");Mn(this.timingTarget,r+".on","true")},this.onTimeNodeEnd=()=>{if(this.json.cBhvr.ctn.fill==="remove"){const[e]=this.json.cBhvr.attrList[0].split(".");Mn(this.timingTarget,e+".on","false")}},this.onSeekToStart=()=>{if(this.timingTarget){const[e]=this.json.cBhvr.attrList[0].split(".");Mn(this.timingTarget,e+".on","false")}},this.onTimeNodeStart=()=>{if(this.timingTarget){const e=Wn(this.timingTarget,this.json.cBhvr.attrList[0]);e&&(this.startColorString=e)}},this.onTimeUpdate=({delta:e,duration:r})=>{const s=e/r;this.to.interpolationFrom(this.from,s,this.target),this.timingTarget&&Mn(this.timingTarget,this.json.cBhvr.attrList[0],this.target.toHexString())},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1})},this.json.clrSpc==="rgb"?(this.from=new Yi(this.json.from),this.to=new Yi(this.json.to),this.by=new Yi(this.json.by),this.target=new Yi):(this.from=new el(this.json.from),this.to=new el(this.json.to),this.by=new el(this.json.by),this.target=new el),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeEnd",this.onTimeNodeEnd),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate)}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}updateCurrentValue(){if(this.timingTarget){const n=Wn(this.timingTarget,this.json.cBhvr.attrList[0]);n&&(this.currentColorString=n)}}}class $l extends gi{constructor(n){super(n),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.lastVal=null,this.onTimelineStart=e=>{this.lastVal=null,e.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:e,delta:r})=>{const s=r/e;let l=0,h=0;if(this.from!==void 0&&this.to!==void 0){l=this.from,h=this.to;const p=l+(h-l)*s;this.timingTarget&&(this.timingTarget.r=p)}else if(this.by!==void 0){this.lastVal||(this.lastVal=0);const p=this.by*s-this.lastVal;this.lastVal=this.by*s,this.timingTarget&&(this.timingTarget.r+=p)}},this.onTimeNodeStart=()=>{var e;Object(ft.isNumber)((e=this.timingTarget)===null||e===void 0?void 0:e.r)&&(this.startVal=this.timingTarget.r)},this.onSeekToStart=()=>{this.timingTarget&&this.startVal!==null&&(this.timingTarget.r=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.from=this.json.from,this.to=this.json.to,this.by=this.json.by,this.by?this.isConflict=!1:this.isConflict=!0,this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate)}get modifyAttrKey(){return"rotate"}updateCurrentValue(){var n;this.currentVal=(n=this.timingTarget)===null||n===void 0?void 0:n.r}}class Uf extends gi{constructor(n){super(n),this.isConflict=!1,this.activeWhenConflict="next",this.isApplied=!1,this.onTimeUpdate=()=>{var e,r;const{cmd:s,cmdType:l}=this.json;!this.isApplied&&s&&l&&(this.isApplied=!0,(r=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||r===void 0||r.applyCommand(s,l))},this.onSeekToStart=()=>{var e,r;(r=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||r===void 0||r.applyCommand("custom-pause","call")},this.onSeekToEnd=()=>{var e,r;(r=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||r===void 0||r.applyCommand("custom-pause","call")},this.commonTimeNode.on("timeNodeStart",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeNodeEnd",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate)}get modifyAttrKey(){var n,e,r,s;return((e=(n=this.json)===null||n===void 0?void 0:n.cmd)!==null&&e!==void 0?e:"")+((s=(r=this.json)===null||r===void 0?void 0:r.cmdType)!==null&&s!==void 0?s:"")}}var Vh=S(21);class $o{constructor(n){$o.useRtc||(this.howl=new Vh.Howl({src:[n]}))}play(){var n;(n=this.howl)===null||n===void 0||n.play()}pause(){var n;(n=this.howl)===null||n===void 0||n.pause()}stop(){var n;(n=this.howl)===null||n===void 0||n.stop()}}$o.useRtc=!1;class nf{constructor(n){this.runtimeNodeEventHub=new X.a,this.stopAudio=()=>{this.audio.stop()};const{json:e,isIterate:r,isSub:s,eventHub:l,ctx:h,parent:p,iterateType:x,iterateIndex:b,iterateId:w}=n;this.json=e,this.id=e.cMediaNode.ctn.id,this.commonTimeNode=new Wc({json:e.cMediaNode.ctn,isSub:s,eventHubs:{global:l,runtime:this.runtimeNodeEventHub},ctx:h,parent:p,isIterate:r,iterateType:x,iterateIndex:b,iterateId:w}),this.audio=new $o(e.cMediaNode.tgtEl),this.commonTimeNode.on("timelineStart",()=>{this.audio.play()}),this.commonTimeNode.on("seekToStart",this.stopAudio),this.commonTimeNode.on("seekToEnd",this.stopAudio),this.commonTimeNode.on("timeNodeDestroy",this.stopAudio)}}var Am=S(9),tm=S.n(Am);function em(){return Date.now().toString(32)+Math.random().toString(32).substring(2)}function xp(o){const n=[],e=o.filter(x=>{const b=x.width<2048&&x.height<2048;return b||n.push(x),b}).sort((x,b)=>x.width*x.height-b.width*b.height);let r=e.length+1,s=2050,l=2050;const h=[];let p=null;for(;(s>2048||l>2048)&&e.length>0;)r-=1,p=tm()(e.slice(0,r)),s=p.width,l=p.height;return p&&h.push(p),n.forEach(x=>{const b=tm()([x]);h.push(b)}),r<e.length?h.concat(xp(e.slice(r))):h}var Pm=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class Wc extends X.a{constructor(n){super(),this.uuid=Date.now().toString(32)+Math.random().toString(32).substring(2),this.isSub=!1,this.isShadow=!1,this.startCount=0,this.applyCount=0,this.isReverse=!1,this.isConflictDispose=!1,this.isIterateEnd=!1,this.parentTimeNode=null,this.isActive=!1,this.isDestroy=!1,this.shouldSeekOnStart=!1,this.repeatTimeoutId=null,this.iterateShadows=[],this.isIterate=!1,this.iterateType="el",this.iterateIndex=0,this.children=[],this.subList=[],this.duration=0,this.timeDelta=0,this.isNegativeSpeed=!1,this.handleEndCond=()=>{this.isActive&&(this.isActive=!1,this.dispose())},this.handleActive=(z=!0)=>{if(this.isActive=!0,this.applyCount+=1,this.json.iterate||this.emit("timeNodeStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startCount>0&&this.json.restart){if(this.json.restart==="never")return;this.json.restart!=="whenNotActive"&&this.json.restart!=="always"||(this.seekToStart(),this.emit("timeNodeRestart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startTimeLine(z))}else this.startTimeLine(z)},this.updateTimeLine=z=>{const q=z/(Vt.TARGET_FPMS||.06);this.timeDelta+=q,this.duration-this.timeDelta<=q&&(this.timeDelta=this.duration),this.timeDelta<this.duration?this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?this.duration-this.timeDelta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}):(this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?0:this.duration,duration:this.duration,isReverse:this.isReverse}),this.onTimeLineEnd())},this.handleEnd=(z=!1)=>{(this.isTimeNodeEnd()||z)&&(this.isActive=!1,this.isSub&&this.destroy(),this.emitEndEvents())};const{isSub:e,isIterate:r,ctx:s,eventHubs:l,parent:h,json:p,iterateType:x,iterateId:b,iterateIndex:w}=n;this.isSub=e,this.isIterate=r,this.parentTimeNode=h,this.json=p,this.ctx=s,this.iterateIndex=w,this.eventHubs=l,this.iterateType=x,this.iterateId=b;const R=Number(this.json.dur),H=this.json.spd||1;this.isNegativeSpeed=H<0,Number.isNaN(R)||(this.duration=R/Math.abs(H)),this.setPreStyle(),p.childTnLst&&this.createChildren(p.childTnLst),this.startConds=new Cn(this.json.id||"",p.stCondLst,l,this.ctx),this.endConds=new Cn(this.json.id||"",p.endCondLst,l,this.ctx),p.endSync&&(this.endSync=new Cn(this.json.id||"",[p.endSync],l,this.ctx),this.endSync.on("active",()=>{var z;this.json.nodeType==="interactiveSeq"&&(this.isActive=!1,this.shouldSeekOnStart=!0,this.emit("timeNodeEndSync"),(z=this.endSync)===null||z===void 0||z.reset())})),this.startConds.on("active",z=>{this.isActive||(this.shouldSeekOnStart&&(this.shouldSeekOnStart=!1,this.seekToStart()),this.handleActive(z))}),this.endConds.on("active",()=>{this.handleEndCond(),this.children.forEach(z=>z.commonTimeNode.handleEndCond())}),this.parentTimeNode&&this.parentTimeNode.on("timeNodeStart",()=>{this.applyCount=0}),this.isSub&&this.json.masterRel==="nextClick"&&this.startConds.addCond({event:"shape slide onNext"}),this.json.iterate&&this.isIterate===!1&&this.createIterateShadow()}createIterateShadow(){const n=em();let e=!0,r=0;const s=l=>{l===n&&(e=!1,this.ctx.eventHub.removeListener("IterateTimeNodeEnd",s))};for(this.ctx.eventHub.on("IterateTimeNodeEnd",s);e;){const l=JSON.parse(JSON.stringify(this.json)),h=new Wc({json:l,isSub:!1,eventHubs:this.eventHubs,ctx:this.ctx,parent:null,isIterate:!0,iterateType:l.iterate.type,iterateIndex:r,iterateId:n});this.iterateShadows[r]=h,r+=1}}isInfiniteRepeat(){return this.json.repeatCount>999999998}getReverse(){return this.isReverse}setReverse(n){this.isReverse=n}createTimeNode(n,e){let r=null;const s={json:n,isSub:e,isIterate:this.isIterate,eventHub:this.eventHubs.global,ctx:this.ctx,parent:this,iterateType:this.iterateType,iterateIndex:this.iterateIndex,iterateId:this.iterateId};return n.type==="seq"?r=new fr(s):n.type==="par"?r=new nm(s):n.type==="set"?r=new Ns(s):n.type==="anim"?r=new yu(s):n.type==="animEffect"?r=new Jl(s):n.type==="animMotion"?r=new il(s):n.type==="animScale"?r=new jh(s):n.type==="animClr"?r=new ol(s):n.type==="animRot"?r=new $l(s):n.type==="cmd"?r=new Uf(s):n.type==="audio"&&(r=new nf(s)),r}createSubList(n){this.subList=[],n.forEach(e=>{const r=this.createTimeNode(e,!0);r&&this.subList.push(r)})}createChildren(n){n.forEach(e=>{const r=this.createTimeNode(e,!1);r&&(r.commonTimeNode.on("timeNodeStart",s=>{this.emit("childTimeNodeStart",s)}),r.commonTimeNode.on("timeNodeEnd",s=>{this.emit("childTimeNodeEnd",s),this.children.every(l=>l.commonTimeNode.isTimeNodeEnd())&&(this.json.iterate||this.allChildrenEndHandle())}),this.children.push(r))})}playReverse(){this.isReverse=!0,this.startReverseTimeLine(),this.children.forEach(n=>n.commonTimeNode.playReverse())}allChildrenEndHandle(){if(!this.isDestroy){if(this.json.autoRev&&!this.isReverse)return this.isReverse=!0,void this.playReverse();this.isReverse&&(this.isReverse=!1),this.json.repeatCount&&this.json.repeatCount>this.applyCount?this.repeatTimeoutId=setTimeout(()=>{this.seekToStart(!1),this.resetForRepeat(),this.startTimeNodeRepeat()}):(this.json.iterate&&!this.isIterate&&(this.isIterateEnd=!0),this.eventHubs.runtime.emit("runtime all end"),this.startSubList(),this.handleEnd())}}resetForRepeat(){this.timeDelta=0,this.children.forEach(n=>n.commonTimeNode.resetForRepeat())}startSubList(){this.subList.forEach(n=>n.commonTimeNode.startTimeNode())}startReverseTimeLine(){this.timeDelta=0;const n=1e3/this.ctx.ticker.maxFPS;this.duration<=n&&this.duration>0?(this.emit("timeUpdate",{delta:this.duration,duration:this.duration,isReverse:this.isReverse}),this.ctx.eventHub.emit(wr.animateEnd),this.ctx.ticker.remove(this.updateTimeLine)):this.duration>n&&(this.ctx.eventHub.emit(wr.animateStart),this.ctx.ticker.add(this.updateTimeLine))}startTimeLine(n=!0){if(n&&(this.eventHubs.global.emit(`time ${this.json.id} begin`),this.eventHubs.global.emit(`time ${this.json.id} onBegin`),this.eventHubs.runtime.emit(`runtime ${this.json.id} begin`)),this.json.iterate)return void this.startIterate();this.timeDelta=0,this.emit("timelineStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse});const e=1e3/this.ctx.ticker.maxFPS;this.duration<=e&&this.duration>0?(this.timeDelta=this.isReverse?0:this.duration,this.emit("timeUpdate",{delta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}),this.emit("timelineEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.onTimeLineEnd()):this.duration>e&&(this.ctx.eventHub.emit(wr.animateStart),this.updateTimeLine(0),this.ctx.ticker.add(this.updateTimeLine))}setTimeout(n,e){let r=0;const s=l=>{r+=l/(Vt.TARGET_FPMS||.06),r>=e&&(n(),this.ctx.ticker.remove(s))};return this.ctx.ticker.add(s),()=>{this.ctx.ticker.remove(s)}}tickerDelay(n){return new Promise(e=>{this.setTimeout(()=>{e()},n)})}startIterate(){return Pm(this,void 0,void 0,function*(){if(this.json.iterate){this.isIterateEnd=!1;for(const n of this.iterateShadows){if(this.isIterateEnd)return;n.children.forEach(e=>{e.commonTimeNode.startTimeNode()}),n.applyCount+=1,yield this.tickerDelay(this.json.iterate.interval)}this.onTimeLineEnd()}})}isNatureTimeEnd(){return this.duration>=0&&this.timeDelta>=this.duration}setPreStyle(){if(!this.json.presetClass)return;const n=[],e=r=>{r.forEach(s=>{var l,h,p;s.cBhvr&&s.cBhvr.target&&n.findIndex(x=>x.id===s.cBhvr.target.id)<0&&n.push(s.cBhvr.target),((h=(l=s==null?void 0:s.cBhvr)===null||l===void 0?void 0:l.ctn)===null||h===void 0?void 0:h.childTnLst)&&s.cBhvr.ctn.childTnLst.length>0&&e(s.cBhvr.ctn.childTnLst),((p=s==null?void 0:s.ctn)===null||p===void 0?void 0:p.childTnLst)&&s.ctn.childTnLst.length>0&&e(s.ctn.childTnLst)})};e(this.json.childTnLst||[]),n.forEach(r=>{if(this.json.iterate){let s=0,l=!0;for(;l;){const h=this.ctx.timingTargets.getTarget(r,!0,{type:this.json.iterate.type,index:s,id:""});h&&(this.setPreStyleForTarget(h),s+=1),l=!!h}}else{const s=this.ctx.timingTargets.getTarget(r,!1);s&&this.setPreStyleForTarget(s)}})}setPreStyleForTarget(n){n&&this.json.presetSubtype&&(n.presetSubType=this.json.presetSubtype),n&&!n.hasPreset&&(this.json.presetClass==="entr"?(n.hasPreset=!0,n.style.visibility="hidden"):this.json.presetClass==="exit"&&(n.hasPreset=!0,n.style.visibility="visible"))}startTimeNodeRepeat(){this.timeDelta=0,this.isActive=!0,this.applyCount+=1,this.startTimeLine(!1),this.json.iterate||this.emit("timeNodeRepeat",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse})}startTimeNodeForce(){this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.timeDelta=0,this.isActive=!0,this.handleActive(!1)}startTimeNode(n=!0){if(this.isDestroy)return;this.collectStartValue(),this.timeDelta=0,this.isReverse=!1,this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.startConds.setTriggerParams(n);const e=this.json.stCondLst.filter(s=>/^self/.test(s.event||""))[0];e&&this.startConds.condHandle(e);const r=this.json.endCondLst.filter(s=>/^self/.test(s.event||""))[0];r&&this.endConds.condHandle(r),this.startConds.condHandle()}onTimeLineEnd(){this.dispose(),(this.children.length===0||this.json.iterate)&&this.allChildrenEndHandle()}clearSubList(){this.subList.forEach(n=>n.commonTimeNode.destroy())}seekToStart(n=!0){if(this.isActive=!1,this.dispose(),this.timeDelta=0,this.isNegativeSpeed,this.emit("seekToStart"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(e=>e.seekToStart(n));if(n)for(let e=this.subList.length-1;e>=0;e--){const r=this.subList[e];r==null||r.commonTimeNode.seekToStart()}for(let e=this.children.length-1;e>=0;e--){const r=this.children[e];r==null||r.commonTimeNode.seekToStart()}for(let e=this.children.length-1;e>=0;e--){const r=this.children[e];r==null||r.commonTimeNode.seekToStart()}}dispose(n=!1){this.isConflictDispose=n,window.clearTimeout(this.repeatTimeoutId),this.ctx.eventHub.emit(wr.animateEnd),this.ctx.ticker.remove(this.updateTimeLine),this.startConds.reset(),this.endConds.reset()}seekToEnd(n,e=!1){if(this.isInfiniteRepeat())return;!this.isActive&&this.applyCount<=0&&this.collectStartValue(),this.applyCount=this.json.repeatCount,this.json.autoRev&&(this.isReverse=!0),this.timeDelta=this.duration,this.isActive=!1,this.dispose();const r=this.json.autoRev||n;if(r?this.emit("seekToStart"):this.emit("seekToEnd"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(s=>s.seekToEnd(r,e));this.children.length===0&&(this.eventHubs.runtime.emit("runtime all end"),this.handleEnd()),this.children.forEach(s=>s.commonTimeNode.seekToEnd(r,e)),e&&this.json.subTnLst&&(this.subList.length<=0&&this.createSubList(this.json.subTnLst),this.subList.forEach(s=>s.commonTimeNode.seekToEnd(!1)))}isTimeNodeEnd(){let n=!0;return this.children.length>0&&(n=n&&this.children.every(e=>e.commonTimeNode.isTimeNodeEnd())),this.json.repeatCount&&(n=n&&this.applyCount>=this.json.repeatCount),this.json.autoRev&&(n=n&&!this.isReverse),n=n&&this.isNatureTimeEnd(),!!this.isConflictDispose||!(!this.isIterateEnd||!this.json.iterate)||n}emitEndEvents(){this.eventHubs.global.emit(`time ${this.json.id} end`),this.eventHubs.global.emit(`time ${this.json.id} onEnd`),this.eventHubs.runtime.emit(`runtime ${this.json.id} end`),this.emit("timeNodeEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse})}collectStartValue(){this.emit("timeNodeCreate"),this.children.forEach(n=>n.commonTimeNode.collectStartValue())}destroy(){this.emit("timeNodeDestroy"),this.isDestroy=!0,this.dispose(),this.startConds.removeAllListeners(),this.endConds.removeAllListeners(),this.children.forEach(n=>n.commonTimeNode.destroy())}}class nm extends X.a{constructor(n){super(),this.isRunning=!1,this.runtimeNodeEventHub=new X.a;const{json:e,iterateType:r,isIterate:s,isSub:l,parent:h,ctx:p,eventHub:x,iterateIndex:b,iterateId:w}=n;this.id=e.ctn.id,this.json=e,this.ctx=p,this.isIterate=s,this.globalEventHub=x,this.commonTimeNode=new Wc({json:e.ctn,isSub:l,eventHubs:{global:x,runtime:this.runtimeNodeEventHub},ctx:p,parent:h,isIterate:!1,iterateType:r,iterateIndex:b,iterateId:w}),this.commonTimeNode.on("timeNodeStart",()=>{this.commonTimeNode.children.forEach(R=>{R.commonTimeNode.setReverse(this.commonTimeNode.getReverse()),R.commonTimeNode.startTimeNode()}),this.isRunning||(this.isRunning=!0,this.globalEventHub.emit(`runtime ${this.id} begin`),this.emit("begin"))}),this.commonTimeNode.on("timeNodeRepeat",()=>{this.commonTimeNode.children.forEach(R=>{R.commonTimeNode.startTimeNode(!1)})}),this.commonTimeNode.on("timeNodeEnd",()=>{this.commonTimeNode.isTimeNodeEnd()&&this.isRunning&&(this.isRunning=!1,this.globalEventHub.emit(`runtime ${this.id} end`),this.emit("end"))})}}class bp{constructor(n,e,r){this.json=n,this.ctx=r;const s=n.timeNodeList.find(l=>l.type==="par"&&l.ctn.nodeType==="tmRoot");s&&(this.tmRoot=new nm({json:s,isSub:!1,isIterate:!1,eventHub:e,ctx:r,parent:null,iterateType:"el",iterateIndex:0,iterateId:""}),this.mainSeq=this.tmRoot.commonTimeNode.children.find(l=>{var h,p,x;return((h=l.json)===null||h===void 0?void 0:h.type)==="seq"&&((x=(p=l.json)===null||p===void 0?void 0:p.ctn)===null||x===void 0?void 0:x.nodeType)==="mainSeq"}))}findSeq(n){var e;return(e=this.tmRoot)===null||e===void 0?void 0:e.commonTimeNode.children.find(r=>{var s,l,h;return((s=r.json)===null||s===void 0?void 0:s.type)==="seq"&&((h=(l=r.json)===null||l===void 0?void 0:l.ctn)===null||h===void 0?void 0:h.id)===n})}start(){var n;this.json.autoPlayMainSeq?setTimeout(()=>{var e;(e=this.mainSeq)===null||e===void 0||e.commonTimeNode.startTimeNode()}):(n=this.mainSeq)===null||n===void 0||n.commonTimeNode.startTimeNode()}setMainSeqApplied(){this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1)}collectMainSeqStartValue(){var n;(n=this.mainSeq)===null||n===void 0||n.commonTimeNode.collectStartValue()}setMainSeqStep(n,e){var r;n===-1&&this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1),(r=this.mainSeq)===null||r===void 0||r.setCurrentStep(n,e)}destroy(){var n;(n=this.tmRoot)===null||n===void 0||n.commonTimeNode.destroy()}hasMainSeq(){return!!this.mainSeq&&this.mainSeq.commonTimeNode.children.length>0}currentMainSeqState(){return this.mainSeq?this.mainSeq.currentState:null}currentMainSeqStep(){return this.mainSeq?this.mainSeq.currentStep:0}currentMainSeqLength(){return this.mainSeq?this.mainSeq.stepLength:0}mainSeqHasNextStep(){return!!this.mainSeq&&this.mainSeq.hasNext()}mainSeqHasPrevStep(){return!!this.mainSeq&&this.mainSeq.hasPrev()}seekInteractiveSeqToEnd(n){const e=this.findSeq(n);e&&e.commonTimeNode.seekToEnd(!1,!0)}}var rm=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class Xc extends qn{constructor(n,e,r){super({id:"stage",width:n.width,height:n.height,type:"Container",children:n.children},e,r),this.globalEventHub=new X.a,this.json=n,this.container.visible=!1,this.ctx=e,this.globalEventHub.on("c:prev slide",()=>{this.ctx.eventHub.emit(Ya.prev)}),this.globalEventHub.on("c:next slide",()=>{this.ctx.eventHub.emit(Ya.next)});const s=new cs;s.drawRect(0,0,n.width,n.height),this.container.addChild(s)}get interactiveContainer(){return this.container}render(){const n=Object.create(null,{render:{get:()=>super.render}});return rm(this,void 0,void 0,function*(){yield n.render.call(this),this.ctx.eventHub.emit("StageRenderEnd")})}createTiming(){this.json.timing&&(this.timing=new bp(this.json.timing,this.globalEventHub,this.ctx))}startTiming(){var n;(n=this.timing)===null||n===void 0||n.start()}setMainSeqApplied(){var n;(n=this.timing)===null||n===void 0||n.setMainSeqApplied()}setMainSeqStep(n,e){var r;(r=this.timing)===null||r===void 0||r.setMainSeqStep(n,e)}collectMainSeqStartValue(){var n;(n=this.timing)===null||n===void 0||n.collectMainSeqStartValue()}hasTiming(){return!!this.timing}destroy(){var n;super.destroy(),this.ctx.eventHub.removeAllListeners(),this.ctx.graphicsTexture.destroy(),this.ctx.fillTexture.destroy(),this.globalEventHub.removeAllListeners(),(n=this.timing)===null||n===void 0||n.destroy()}mainSeqStep(){var n,e;return(e=(n=this.timing)===null||n===void 0?void 0:n.currentMainSeqStep())!==null&&e!==void 0?e:0}mainSeqLength(){var n,e;return(e=(n=this.timing)===null||n===void 0?void 0:n.currentMainSeqLength())!==null&&e!==void 0?e:0}mainSeqHasNextStep(){var n,e;return(e=(n=this.timing)===null||n===void 0?void 0:n.mainSeqHasNextStep())!==null&&e!==void 0&&e}mainSeqHasPrevStep(){var n,e;return(e=(n=this.timing)===null||n===void 0?void 0:n.mainSeqHasPrevStep())!==null&&e!==void 0&&e}mainSeqState(){return this.timing?this.timing.currentMainSeqState():null}nextStep(){var n;this.hasTiming()&&((n=this.timing)===null||n===void 0?void 0:n.hasMainSeq())?this.globalEventHub.emit("shape slide onNext"):this.ctx.eventHub.emit(Ya.next)}prevStep(){var n;this.hasTiming()&&((n=this.timing)===null||n===void 0?void 0:n.hasMainSeq())?this.globalEventHub.emit("shape slide onPrev"):this.ctx.eventHub.emit(Ya.prev)}applyInteractiveAction(n){this.globalEventHub.emit(n)}seekInteractiveSeqToEnd(n){var e;(e=this.timing)===null||e===void 0||e.seekInteractiveSeqToEnd(n)}setMediaState(n,e){return rm(this,void 0,void 0,function*(){const r=this.ctx.medias[n];r&&(e?yield r.play():yield r.pause())})}setMediaCurrentTime(n,e){const r=this.ctx.medias[n];r&&r.seek(e)}}const Ko=134217729;function Ai(o,n,e,r,s){let l,h,p,x,b=n[0],w=r[0],R=0,H=0;w>b==w>-b?(l=b,b=n[++R]):(l=w,w=r[++H]);let z=0;if(R<o&&H<e)for(w>b==w>-b?(h=b+l,p=l-(h-b),b=n[++R]):(h=w+l,p=l-(h-w),w=r[++H]),l=h,p!==0&&(s[z++]=p);R<o&&H<e;)w>b==w>-b?(h=l+b,x=h-l,p=l-(h-x)+(b-x),b=n[++R]):(h=l+w,x=h-l,p=l-(h-x)+(w-x),w=r[++H]),l=h,p!==0&&(s[z++]=p);for(;R<o;)h=l+b,x=h-l,p=l-(h-x)+(b-x),b=n[++R],l=h,p!==0&&(s[z++]=p);for(;H<e;)h=l+w,x=h-l,p=l-(h-x)+(w-x),w=r[++H],l=h,p!==0&&(s[z++]=p);return l===0&&z!==0||(s[z++]=l),z}function kf(o,n){let e=n[0];for(let r=1;r<o;r++)e+=n[r];return e}function qc(o){return new Float64Array(o)}const sl=qc(4),rf=qc(8),Yc=qc(12),wp=qc(16),Qo=qc(4);function Kl(o,n,e,r,s,l){const h=(n-l)*(e-s),p=(o-s)*(r-l),x=h-p;if(h===0||p===0||h>0!=p>0)return x;const b=Math.abs(h+p);return Math.abs(x)>=33306690738754716e-32*b?x:-function(w,R,H,z,q,at,_t){let bt,zt,De,an,Dt,ue,te,he,Ve,Pe,ie,pe,rn,Ye,tn,cn,ke,Ce;const mn=w-q,kn=H-q,Jn=R-at,_r=z-at;Ye=mn*_r,ue=Ko*mn,te=ue-(ue-mn),he=mn-te,ue=Ko*_r,Ve=ue-(ue-_r),Pe=_r-Ve,tn=he*Pe-(Ye-te*Ve-he*Ve-te*Pe),cn=Jn*kn,ue=Ko*Jn,te=ue-(ue-Jn),he=Jn-te,ue=Ko*kn,Ve=ue-(ue-kn),Pe=kn-Ve,ke=he*Pe-(cn-te*Ve-he*Ve-te*Pe),ie=tn-ke,Dt=tn-ie,sl[0]=tn-(ie+Dt)+(Dt-ke),pe=Ye+ie,Dt=pe-Ye,rn=Ye-(pe-Dt)+(ie-Dt),ie=rn-cn,Dt=rn-ie,sl[1]=rn-(ie+Dt)+(Dt-cn),Ce=pe+ie,Dt=Ce-pe,sl[2]=pe-(Ce-Dt)+(ie-Dt),sl[3]=Ce;let or=kf(4,sl),Tr=22204460492503146e-32*_t;if(or>=Tr||-or>=Tr||(Dt=w-mn,bt=w-(mn+Dt)+(Dt-q),Dt=H-kn,De=H-(kn+Dt)+(Dt-q),Dt=R-Jn,zt=R-(Jn+Dt)+(Dt-at),Dt=z-_r,an=z-(_r+Dt)+(Dt-at),bt===0&&zt===0&&De===0&&an===0)||(Tr=11093356479670487e-47*_t+33306690738754706e-32*Math.abs(or),or+=mn*an+_r*bt-(Jn*De+kn*zt),or>=Tr||-or>=Tr))return or;Ye=bt*_r,ue=Ko*bt,te=ue-(ue-bt),he=bt-te,ue=Ko*_r,Ve=ue-(ue-_r),Pe=_r-Ve,tn=he*Pe-(Ye-te*Ve-he*Ve-te*Pe),cn=zt*kn,ue=Ko*zt,te=ue-(ue-zt),he=zt-te,ue=Ko*kn,Ve=ue-(ue-kn),Pe=kn-Ve,ke=he*Pe-(cn-te*Ve-he*Ve-te*Pe),ie=tn-ke,Dt=tn-ie,Qo[0]=tn-(ie+Dt)+(Dt-ke),pe=Ye+ie,Dt=pe-Ye,rn=Ye-(pe-Dt)+(ie-Dt),ie=rn-cn,Dt=rn-ie,Qo[1]=rn-(ie+Dt)+(Dt-cn),Ce=pe+ie,Dt=Ce-pe,Qo[2]=pe-(Ce-Dt)+(ie-Dt),Qo[3]=Ce;const si=Ai(4,sl,4,Qo,rf);Ye=mn*an,ue=Ko*mn,te=ue-(ue-mn),he=mn-te,ue=Ko*an,Ve=ue-(ue-an),Pe=an-Ve,tn=he*Pe-(Ye-te*Ve-he*Ve-te*Pe),cn=Jn*De,ue=Ko*Jn,te=ue-(ue-Jn),he=Jn-te,ue=Ko*De,Ve=ue-(ue-De),Pe=De-Ve,ke=he*Pe-(cn-te*Ve-he*Ve-te*Pe),ie=tn-ke,Dt=tn-ie,Qo[0]=tn-(ie+Dt)+(Dt-ke),pe=Ye+ie,Dt=pe-Ye,rn=Ye-(pe-Dt)+(ie-Dt),ie=rn-cn,Dt=rn-ie,Qo[1]=rn-(ie+Dt)+(Dt-cn),Ce=pe+ie,Dt=Ce-pe,Qo[2]=pe-(Ce-Dt)+(ie-Dt),Qo[3]=Ce;const ai=Ai(si,rf,4,Qo,Yc);Ye=bt*an,ue=Ko*bt,te=ue-(ue-bt),he=bt-te,ue=Ko*an,Ve=ue-(ue-an),Pe=an-Ve,tn=he*Pe-(Ye-te*Ve-he*Ve-te*Pe),cn=zt*De,ue=Ko*zt,te=ue-(ue-zt),he=zt-te,ue=Ko*De,Ve=ue-(ue-De),Pe=De-Ve,ke=he*Pe-(cn-te*Ve-he*Ve-te*Pe),ie=tn-ke,Dt=tn-ie,Qo[0]=tn-(ie+Dt)+(Dt-ke),pe=Ye+ie,Dt=pe-Ye,rn=Ye-(pe-Dt)+(ie-Dt),ie=rn-cn,Dt=rn-ie,Qo[1]=rn-(ie+Dt)+(Dt-cn),Ce=pe+ie,Dt=Ce-pe,Qo[2]=pe-(Ce-Dt)+(ie-Dt),Qo[3]=Ce;const Bi=Ai(ai,Yc,4,Qo,wp);return wp[Bi-1]}(o,n,e,r,s,l,b)}const Gf=Math.pow(2,-52),Ks=new Uint32Array(512);class Hf{static from(n,e=Wh,r=jf){const s=n.length,l=new Float64Array(2*s);for(let h=0;h<s;h++){const p=n[h];l[2*h]=e(p),l[2*h+1]=r(p)}return new Hf(l)}constructor(n){const e=n.length>>1;if(e>0&&typeof n[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=n;const r=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:n,_hullPrev:e,_hullNext:r,_hullTri:s,_hullHash:l}=this,h=n.length>>1;let p=1/0,x=1/0,b=-1/0,w=-1/0;for(let Pe=0;Pe<h;Pe++){const ie=n[2*Pe],pe=n[2*Pe+1];ie<p&&(p=ie),pe<x&&(x=pe),ie>b&&(b=ie),pe>w&&(w=pe),this._ids[Pe]=Pe}const R=(p+b)/2,H=(x+w)/2;let z,q,at,_t=1/0;for(let Pe=0;Pe<h;Pe++){const ie=zf(R,H,n[2*Pe],n[2*Pe+1]);ie<_t&&(z=Pe,_t=ie)}const bt=n[2*z],zt=n[2*z+1];_t=1/0;for(let Pe=0;Pe<h;Pe++){if(Pe===z)continue;const ie=zf(bt,zt,n[2*Pe],n[2*Pe+1]);ie<_t&&ie>0&&(q=Pe,_t=ie)}let De=n[2*q],an=n[2*q+1],Dt=1/0;for(let Pe=0;Pe<h;Pe++){if(Pe===z||Pe===q)continue;const ie=Cm(bt,zt,De,an,n[2*Pe],n[2*Pe+1]);ie<Dt&&(at=Pe,Dt=ie)}let ue=n[2*at],te=n[2*at+1];if(Dt===1/0){for(let pe=0;pe<h;pe++)this._dists[pe]=n[2*pe]-n[0]||n[2*pe+1]-n[1];qa(this._ids,this._dists,0,h-1);const Pe=new Uint32Array(h);let ie=0;for(let pe=0,rn=-1/0;pe<h;pe++){const Ye=this._ids[pe];this._dists[Ye]>rn&&(Pe[ie++]=Ye,rn=this._dists[Ye])}return this.hull=Pe.subarray(0,ie),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Kl(bt,zt,De,an,ue,te)<0){const Pe=q,ie=De,pe=an;q=at,De=ue,an=te,at=Pe,ue=ie,te=pe}const he=function(Pe,ie,pe,rn,Ye,tn){const cn=pe-Pe,ke=rn-ie,Ce=Ye-Pe,mn=tn-ie,kn=cn*cn+ke*ke,Jn=Ce*Ce+mn*mn,_r=.5/(cn*mn-ke*Ce);return{x:Pe+(mn*kn-ke*Jn)*_r,y:ie+(cn*Jn-Ce*kn)*_r}}(bt,zt,De,an,ue,te);this._cx=he.x,this._cy=he.y;for(let Pe=0;Pe<h;Pe++)this._dists[Pe]=zf(n[2*Pe],n[2*Pe+1],he.x,he.y);qa(this._ids,this._dists,0,h-1),this._hullStart=z;let Ve=3;r[z]=e[at]=q,r[q]=e[z]=at,r[at]=e[q]=z,s[z]=0,s[q]=1,s[at]=2,l.fill(-1),l[this._hashKey(bt,zt)]=z,l[this._hashKey(De,an)]=q,l[this._hashKey(ue,te)]=at,this.trianglesLen=0,this._addTriangle(z,q,at,-1,-1,-1);for(let Pe,ie,pe=0;pe<this._ids.length;pe++){const rn=this._ids[pe],Ye=n[2*rn],tn=n[2*rn+1];if(pe>0&&Math.abs(Ye-Pe)<=Gf&&Math.abs(tn-ie)<=Gf||(Pe=Ye,ie=tn,rn===z||rn===q||rn===at))continue;let cn=0;for(let Jn=0,_r=this._hashKey(Ye,tn);Jn<this._hashSize&&(cn=l[(_r+Jn)%this._hashSize],cn===-1||cn===r[cn]);Jn++);cn=e[cn];let ke,Ce=cn;for(;ke=r[Ce],Kl(Ye,tn,n[2*Ce],n[2*Ce+1],n[2*ke],n[2*ke+1])>=0;)if(Ce=ke,Ce===cn){Ce=-1;break}if(Ce===-1)continue;let mn=this._addTriangle(Ce,rn,r[Ce],-1,-1,s[Ce]);s[rn]=this._legalize(mn+2),s[Ce]=mn,Ve++;let kn=r[Ce];for(;ke=r[kn],Kl(Ye,tn,n[2*kn],n[2*kn+1],n[2*ke],n[2*ke+1])<0;)mn=this._addTriangle(kn,rn,ke,s[rn],-1,s[kn]),s[rn]=this._legalize(mn+2),r[kn]=kn,Ve--,kn=ke;if(Ce===cn)for(;ke=e[Ce],Kl(Ye,tn,n[2*ke],n[2*ke+1],n[2*Ce],n[2*Ce+1])<0;)mn=this._addTriangle(ke,rn,Ce,-1,s[Ce],s[ke]),this._legalize(mn+2),s[ke]=mn,r[Ce]=Ce,Ve--,Ce=ke;this._hullStart=e[rn]=Ce,r[Ce]=e[kn]=rn,r[rn]=kn,l[this._hashKey(Ye,tn)]=rn,l[this._hashKey(n[2*Ce],n[2*Ce+1])]=Ce}this.hull=new Uint32Array(Ve);for(let Pe=0,ie=this._hullStart;Pe<Ve;Pe++)this.hull[Pe]=ie,ie=r[ie];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(n,e){return Math.floor(function(r,s){const l=r/(Math.abs(r)+Math.abs(s));return(s>0?3-l:1+l)/4}(n-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(n){const{_triangles:e,_halfedges:r,coords:s}=this;let l=0,h=0;for(;;){const p=r[n],x=n-n%3;if(h=x+(n+2)%3,p===-1){if(l===0)break;n=Ks[--l];continue}const b=p-p%3,w=x+(n+1)%3,R=b+(p+2)%3,H=e[h],z=e[n],q=e[w],at=e[R];if(Xa(s[2*H],s[2*H+1],s[2*z],s[2*z+1],s[2*q],s[2*q+1],s[2*at],s[2*at+1])){e[n]=at,e[p]=H;const _t=r[R];if(_t===-1){let zt=this._hullStart;do{if(this._hullTri[zt]===R){this._hullTri[zt]=n;break}zt=this._hullPrev[zt]}while(zt!==this._hullStart)}this._link(n,_t),this._link(p,r[h]),this._link(h,R);const bt=b+(p+1)%3;l<Ks.length&&(Ks[l++]=bt)}else{if(l===0)break;n=Ks[--l]}}return h}_link(n,e){this._halfedges[n]=e,e!==-1&&(this._halfedges[e]=n)}_addTriangle(n,e,r,s,l,h){const p=this.trianglesLen;return this._triangles[p]=n,this._triangles[p+1]=e,this._triangles[p+2]=r,this._link(p,s),this._link(p+1,l),this._link(p+2,h),this.trianglesLen+=3,p}}function zf(o,n,e,r){const s=o-e,l=n-r;return s*s+l*l}function Xa(o,n,e,r,s,l,h,p){const x=o-h,b=n-p,w=e-h,R=r-p,H=s-h,z=l-p,q=w*w+R*R,at=H*H+z*z;return x*(R*at-q*z)-b*(w*at-q*H)+(x*x+b*b)*(w*z-R*H)<0}function Cm(o,n,e,r,s,l){const h=e-o,p=r-n,x=s-o,b=l-n,w=h*h+p*p,R=x*x+b*b,H=.5/(h*b-p*x),z=(b*w-p*R)*H,q=(h*R-x*w)*H;return z*z+q*q}function qa(o,n,e,r){if(r-e<=20)for(let s=e+1;s<=r;s++){const l=o[s],h=n[l];let p=s-1;for(;p>=e&&n[o[p]]>h;)o[p+1]=o[p--];o[p+1]=l}else{let s=e+1,l=r;xu(o,e+r>>1,s),n[o[e]]>n[o[r]]&&xu(o,e,r),n[o[s]]>n[o[r]]&&xu(o,s,r),n[o[e]]>n[o[s]]&&xu(o,e,s);const h=o[s],p=n[h];for(;;){do s++;while(n[o[s]]<p);do l--;while(n[o[l]]>p);if(l<s)break;xu(o,s,l)}o[e+1]=o[l],o[l]=h,r-s+1>=l-e?(qa(o,n,s,r),qa(o,n,e,l-1)):(qa(o,n,e,l-1),qa(o,n,s,r))}}function xu(o,n,e){const r=o[n];o[n]=o[e],o[e]=r}function Wh(o){return o[0]}function jf(o){return o[1]}function gs(o,n,e=5){return Math.abs(o-n)<=Math.pow(10,-e)}class Fs{constructor(){this.point={x:0,y:0},this.slope=Math.PI/4}static fromPointSlope(n,e){const r=new Fs;return r.point=n,r.slope=e,r}resolveY(n){return Math.tan(this.slope)*(n-this.point.x)+this.point.y}distanceToLinearEquation(n){return gs(this.slope,n.slope)?this.distanceToPoint(n.point):-1}distanceToPoint(n){let e=0;if(Math.tan(this.slope)*(n.x-this.point.x)+this.point.y===n.y)return 0;e=this.slope>=Math.PI/2?this.slope-Math.PI/2:Math.PI/2+this.slope;const r=Fs.fromPointSlope(n,e),s=this.crossPoint(r);return s?Math.ceil(Math.sqrt(Math.pow(s.x-n.x,2)+Math.pow(s.y-n.y,2))):0}crossPoint(n){if(gs(n.slope,this.slope))return null;let e=0,r=0;const s=Math.tan(n.slope),l=Math.tan(this.slope),{x:h,y:p}=this.point,{x,y:b}=n.point;return gs(this.slope,Math.PI/2)?(e=this.point.x,r=s*(e-x)+b):gs(n.slope,Math.PI/2)?(e=n.point.x,r=l*(e-h)+p):gs(this.slope,Math.PI)||gs(this.slope,0)?(r=this.point.y,e=(r-b)/s+x):gs(n.slope,Math.PI)||gs(n.slope,0)?(r=n.point.y,e=(r-p)/l+h):(e=(s*x-b+p-l*h)/(s-l),r=l*(e-h)+p),{x:e,y:r}}}function Xh(o,n,e){return o.fillType==="solidFill"?function(r,s,l){const h=new cs,[p,x]=ga(r.color);return h.beginFill(p,x),h.drawRect(0,0,s,l),h.endFill(),h}(o,n,e):o.fillType==="gradientFill"?function(r,s,l){let h=null;const p=new Wi;if(r.stopList.sort((b,w)=>b.pos-w.pos),!r.stopList.find(b=>b.pos===0)){const b=r.stopList[0];r.stopList.unshift({pos:0,color:b.color})}if(!r.stopList.find(b=>b.pos===1)){const b=r.stopList[r.stopList.length-1];r.stopList.push({pos:1,color:b.color})}const x=b=>{const w=[];for(let R=0,H=b.length;R<H-1;R++){const z=b[R],q=b[R+1],at=z.pos+.5*(q.pos-z.pos),_t=za(z.color,q.color,.5),bt=2*R;w[bt]=z,w[bt+1]={color:_t,pos:at},w[bt+2]=q}return w};if(r.stopList=x(r.stopList),r.stopList=x(r.stopList),r.line?h=function(b,w,R){const H=w/2,z=R/2,q={x:-H,y:z},at={x:-H,y:-z},_t={x:H,y:z},bt={x:H,y:-z},zt=Fs.fromPointSlope({x:-H,y:0},Math.PI/2),De=Fs.fromPointSlope({x:0,y:z},0),an=Fs.fromPointSlope({x:H,y:0},Math.PI/2),Dt=Fs.fromPointSlope({x:0,y:-z},0),ue=[q,at,_t,bt],te=[zt,De,an,Dt],he=[],Ve=b.stopList.slice(1,b.stopList.length-1).map(tn=>{var cn,ke;const Ce=2*Math.PI;let mn=(ke=(cn=b.line)===null||cn===void 0?void 0:cn.ang)!==null&&ke!==void 0?ke:0;for(;mn>Ce;)mn-=Ce;for(;mn<0;)mn+=Ce;const kn={x:0,y:0};gs(mn,Math.PI/2)?(kn.x=0,kn.y=R/2-tn.pos*R):gs(mn,0)?(kn.x=tn.pos*w-w/2,kn.y=0):(kn.x=tn.pos*w-w/2,kn.y=R/2-tn.pos*R),mn>Math.PI/2&&mn<=Math.PI&&(kn.x*=-1),mn>Math.PI&&mn<=2*Math.PI&&(kn.y*=-1);const Jn=Fs.fromPointSlope(kn,Math.PI/2-b.line.ang),_r=te.map(Tr=>Jn.crossPoint(Tr)).filter(Tr=>Tr&&Tr.x<=H&&Tr.x>=-H&&Tr.y<=z&&Tr.y>=-z).map(Tr=>({point:Tr,color:tn.color})).sort((Tr,si)=>si.point.y-Tr.point.y);he.push(..._r);let or=Math.abs(_r[1].point.x-_r[0].point.x)/10;for(let Tr=20;Tr--;){const si=Tr%2==0?1:-1,ai=kn.x+si*or,Bi=Jn.resolveY(ai);ai<=H&&ai>=-H&&Bi<=z&&Bi>=-z&&he.push({point:{x:ai,y:Bi},color:tn.color}),or+=or}return Jn});let Pe=[],ie=[];t:for(let tn=0;tn<ue.length;tn++){const cn=ue[tn];for(let Jn=0;Jn<Ve.length-1;Jn++){const _r=Ve[Jn],or=Ve[Jn+1],Tr=_r.distanceToLinearEquation(or),si=_r.distanceToPoint(cn),ai=or.distanceToPoint(cn);if(si<Tr&&ai<Tr){const Bi=b.stopList.slice(1,b.stopList.length-1)[Jn],So=b.stopList.slice(1,b.stopList.length-1)[Jn+1],tr=za(Bi.color,So.color,si/Tr);he.splice(Jn+1,0,{point:cn,color:tr});continue t}}const ke=Ve[0],Ce=Ve[Ve.length-1],mn=ke.distanceToPoint(cn),kn=Ce.distanceToPoint(cn);mn<=kn?Pe.push({point:cn,dis:mn}):ie.push({point:cn,dis:kn})}Pe=Pe.sort((tn,cn)=>cn.dis-tn.dis);const pe=Pe.map((tn,cn)=>{if(cn===0)return{point:tn.point,color:b.stopList[0].color};{const ke=b.stopList[0].color,Ce=b.stopList[1].color;return{point:tn.point,color:za(ke,Ce,1-(Pe[0].dis===0?1:tn.dis/Pe[0].dis))}}}).sort((tn,cn)=>cn.point.y-tn.point.y);ie=ie.sort((tn,cn)=>cn.dis-tn.dis);const rn=ie.map((tn,cn)=>{if(cn===0)return{point:tn.point,color:b.stopList[b.stopList.length-1].color};{const ke=b.stopList[b.stopList.length-2].color,Ce=b.stopList[b.stopList.length-1].color;return{point:tn.point,color:za(ke,Ce,ie[0].dis===0?0:tn.dis/ie[0].dis)}}}).sort((tn,cn)=>cn.point.y-tn.point.y),Ye=pe.concat(...he).concat(rn);for(let tn=0;tn<Ye.length;tn++)Ye[tn].point.x+=H,Ye[tn].point.y=-Ye[tn].point.y+z;return{points:Ye,position:{x:0,y:0}}}(r,s,l):r.path&&(h=function(b,w,R){var H;const z=[],q={x:0,y:0};if(((H=b.path)===null||H===void 0?void 0:H.path)==="circle"){const at=w/2,_t=R/2,bt=Math.sqrt(at*at+_t*_t);b.stopList.forEach(zt=>{if(zt.pos===0)z.push({point:{x:0,y:0},color:zt.color});else{const De=bt*zt.pos,an=new Vc.Path;an.absellipse(0,0,De,De,0,2*Math.PI,!1,0),an.getPoints(50).forEach(Dt=>{z.push({point:{x:Dt.x,y:Dt.y},color:zt.color})})}q.x=at,q.y=_t})}return{points:z,position:q}}(r,s,l)),h){const b=[],w=[],{position:R,points:H}=h,z=Hf.from(H,zt=>zt.point.x,zt=>zt.point.y);for(let zt=0;zt<z.triangles.length;zt+=3)b.push(H[z.triangles[zt]].point.x,H[z.triangles[zt]].point.y),b.push(H[z.triangles[zt+1]].point.x,H[z.triangles[zt+1]].point.y),b.push(H[z.triangles[zt+2]].point.x,H[z.triangles[zt+2]].point.y),w.push(...Js(H[z.triangles[zt]].color)),w.push(...Js(H[z.triangles[zt+1]].color)),w.push(...Js(H[z.triangles[zt+2]].color));const q=new Ho;q.addAttribute("aVertexPosition",b,2),q.addAttribute("aColor",w,4);const at=ua.from(`
        precision mediump float;
        attribute vec2 aVertexPosition;
        attribute vec4 aColor;
        uniform mat3 translationMatrix;
        uniform mat3 projectionMatrix;
        varying vec4 vColor;
        void main() {
            vColor = aColor;
            gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
        }`,`precision mediump float;    
        varying vec4 vColor;
        void main() {
            float alpha = vColor.a;
            vec4 color = vColor;
            color.a = 1.0;
            gl_FragColor = color * alpha;
        }
    `),_t=new cs;_t.drawRect(0,0,s+1,l+1),p.mask=_t,p.addChild(_t);const bt=new Xu(q,at);bt.position.x=R.x,bt.position.y=R.y,p.addChild(bt)}return p}(o,n,e):null}const qh=`
vec3 rgb2hsl(vec3 rgb) {
    float cMax = max(max(rgb.r, rgb.g), rgb.b);
    float cMin = min(min(rgb.r, rgb.g), rgb.b);
    float delta = cMax - cMin;
    
    float h = 0.0;
    if (delta == 0.0) {
        h = 0.0;
    } else if (cMax == rgb.r) {
        h = 60.0 * mod(((rgb.g - rgb.b) / delta), 6.0);
    } else if (cMax == rgb.g ) {
        h = 60.0 * ((rgb.b - rgb.r) / delta + 2.0);
    } else if (cMax == rgb.b) {
        h = 60.0 * ((rgb.r - rgb.g) / delta + 4.0);
    }
    
    float l = (cMax + cMin) / 2.0;
    
    float s = 0.0;
    if (delta == 0.0) {
        s = 0.0;
    } else {
        s = delta / (1.0 - abs(2.0 * l - 1.0));
    }
    
    return vec3(h, s, l);
}
`,Vf=[qh],Zc={biLevel:`
vec4 transform(vec4 texColor, float arg) {
    vec3 hsl = rgb2hsl(texColor.rgb);
    mat3 rgb2yuv = mat3(
        0.2126, 0.7152, 0.0722,
        -0.09991, -0.33609, 0.43600,
        0.615, -0.5586, -0.05639
    );
    vec3 yuv = texColor.rgb * rgb2yuv;
    if (yuv.x >= 0.49 || texColor.a < 0.9) {
        return vec4(1.0, 1.0, 1.0, 1.0);
    } else {
        return vec4(0.0, 0.0, 0.0, 1.0);
    }
}
`};class Jc extends zi{constructor(n,e){var r;super(void 0,(r=Zc[n],`
varying vec2 vTextureCoord;

uniform float arg;
uniform sampler2D uSampler;

${Vf.map(s=>s+`
`).join(`
`)}

${r}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg);
}
`),{arg:e})}}const $c=[qh],Sp={clrChange:`
vec4 transform(vec4 texColor, vec4 arg1, vec4 arg2) {
    float epsilon = 0.001;
    vec3 colorDiff = arg1.rgb - (texColor.rgb / max(texColor.a, 0.0000000001));
    float colorDistance = length(colorDiff);
    // float doReplace = step(colorDistance, epsilon);
    // texColor.a = 0.0;
    if (colorDistance < epsilon) {
        arg2.rgb *= arg2.a;
        return arg2;
    } else {
        return texColor;
    }
}
`};class im extends zi{constructor(n,e,r){var s;super(void 0,(s=Sp[n],`
varying vec2 vTextureCoord;

uniform vec4 arg1;
uniform vec4 arg2;
uniform sampler2D uSampler;

${$c.map(l=>l+`
`).join(`
`)}

${s}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg1, arg2);
}
`),{arg1:Float32Array.from(e),arg2:Float32Array.from(r)})}}class Tp{constructor(n,e){this.renderContainers=[],this.renderTextures=[],this.textures=Object.create(null),this.fillStyles=[],this.renderer=n,this.spriteTextures=e}addTexture(n,e){this.textures[n]=e}render(n){const{items:e,width:r,height:s}=n,l=new Wi;e.forEach(x=>{if(x.item.blipFillObject)x.item.blipFillObject.position.x+=x.x+2,x.item.blipFillObject.position.y+=x.y+2,l.addChild(x.item.blipFillObject);else{const b=Xh(x.item.fill,x.width-2,x.height-2);if(b)b.position.x+=x.x+2,b.position.y+=x.y+2,l.addChild(b);else{const w=new cs;w.drawRect(0,0,x.width-4,x.height-4),l.addChild(w)}}if(x.item.name){const b=new Pc(x.item.name,{fontFamily:"Arial",fontSize:12,fill:16715792,align:"center"});b.position.x=x.x+2,b.position.y=x.y+2,l.addChild(b)}});const h=new cs;h.drawRect(0,0,Math.ceil(r),Math.ceil(s)),l.addChild(h);const p=Zi.create({width:r,height:s});this.renderTextures.push(p),this.renderContainers.push(l),this.renderer.render(l,{renderTexture:p}),e.forEach(x=>{this.textures[x.item.id]=new Nn(p.baseTexture,new Ln(x.x+2,x.y+2,x.width-4,x.height-4))})}getTexture(n){return this.textures[n]||this.spriteTextures.getTexture(n)||null}getGifFrames(n){return this.spriteTextures.getGifFrames(n)}addFill(n,e,r,s){const l=JSON.stringify(n)+e+r,h=nl()(l);if(this.textures[h]||this.fillStyles.findIndex(p=>p.id===h)>=0)return h;if(n.fillType!=="blipFill")this.fillStyles.push({fill:n,width:e,height:r,id:h,name:s});else{const p=this.spriteTextures.getTexture(n.src);if(p){const x=new oi;x.texture=p,n.filters.length>0&&(x.filters=function(b){const w=[];return b.forEach(R=>{if(R.type==="biLevel")w.push(new Jc("biLevel",R.args[0]));else if(R.type==="clrChange"){const H=Js(R.args[0]),z=Js(R.args[1]);w.push(new im("clrChange",H,z))}}),w}(n.filters)),this.fillStyles.push({fill:n,width:p.width,height:p.height,id:h,blipFillObject:x})}}return h}pack(){const n=this.fillStyles.filter(r=>!(!r.fill.fillType||r.fill.fillType==="noFill"||r.width===0||r.height===0)||(this.textures[r.id]=null,!1));n.forEach(r=>{r.width+=4,r.height+=4});const e=xp(n);for(let r=0,s=e.length;r<s;r++){const l=e[r];this.render(l)}}destroy(){this.textures=Object.create(null),this.fillStyles=[],this.renderTextures.forEach(n=>n.destroy(!0)),this.renderContainers.forEach(n=>n.destroy({children:!0})),this.spriteTextures.destroy()}}function Yh(o,n,e){let r,s,l=n,h=e;l===0&&(l=h/1e4),h===0&&(h=l/1e4);const p=o%360;if(p%180==0)r=Math.cos(p*(Math.PI/180))*l,s=0;else if(p%90==0)r=0,s=-Math.sin(p*(Math.PI/180))*h;else{const x=Math.tan(p*Math.PI/180);r=l*h/Math.sqrt(Math.pow(h,2)+Math.pow(l*x,2)),(p>90&&p<270||p<-90&&p>-270)&&(r=-r),s=-x*r}return{x:r,y:s}}function Wf(o,n,e,r,s,l,h){const p={x:0,y:0},x=-l,b=Yh((s=-s)/Math.PI*180,e,r),w=o.x-b.x,R=o.y-b.y;for(let H=0;H<51;H++){const z=Yh((s+H/50*x)/Math.PI*180,e,r);z.x+=w,z.y+=R,H/50==1&&(p.x=z.x,p.y=z.y),z.x=z.x/9525*n.x,z.y=z.y/9525*n.y,h.lineTo(z.x,z.y)}return p}class Ep{constructor(n){this.renderContainers=[],this.renderTextures=[],this.idTidMap=Object.create(null),this.textures=Object.create(null),this.graphics=[],this.renderer=n}render(n){const{items:e,width:r,height:s}=n,l=Zi.create({width:r,height:s});this.renderTextures.push(l);const h=new Wi;e.forEach(x=>{const b=new oi;b.texture=x.item.texture,b.x=x.x+2,b.y=x.y+2,h.addChild(b)});const p=new cs;p.drawRect(0,0,r,s),h.addChild(p),this.renderer.render(h,{renderTexture:l}),this.renderContainers.push(h),e.forEach(x=>{const b=x.item.padding;this.textures[x.item.id]={texture:new Nn(l.baseTexture,new Ln(x.x+2+b,x.y+2+b,x.width-4-2*b,x.height-4-2*b)),pivot:x.item.pivot}})}getGraphicsData(n){const e=this.idTidMap[n]||"";return this.textures[e]||null}addGraphics(n,e,r,s,l,h,p,x){const b=x||em(),w=nl()(e+((h==null?void 0:h.width)||1).toString()+p);if(this.idTidMap[b]=w,this.graphics.findIndex(R=>R.id===w)<0){const{texture:R,pivot:H,padding:z}=function(q,at,_t,bt,zt,De=!0){var an,Dt,ue,te,he,Ve,Pe;const ie={x:Math.abs(zt.x),y:Math.abs(zt.y)},pe=window.devicePixelRatio,rn=document.createElement("canvas"),Ye=rn.getContext("2d");if(!Ye)throw new Error("ctx");Ye.lineCap=(bt==null?void 0:bt.cap)||"butt",Ye.lineJoin=(bt==null?void 0:bt.join)||"miter";let tn=0,cn=0,ke=0,Ce=0,mn=0,kn="none",Jn="none";return De?(tn=at,cn=_t,mn=0,Jn="#ffffff"):(kn="#ff0000",mn=(an=bt==null?void 0:bt.width)!==null&&an!==void 0?an:1,ke=.5*((Dt=bt==null?void 0:bt.width)!==null&&Dt!==void 0?Dt:1),Ce=.5*((ue=bt==null?void 0:bt.width)!==null&&ue!==void 0?ue:1),tn=at+((te=bt==null?void 0:bt.width)!==null&&te!==void 0?te:1),cn=_t+((he=bt==null?void 0:bt.width)!==null&&he!==void 0?he:1),ie.x+=.5*((Ve=bt==null?void 0:bt.width)!==null&&Ve!==void 0?Ve:1),ie.y+=.5*((Pe=bt==null?void 0:bt.width)!==null&&Pe!==void 0?Pe:1)),tn+=Math.abs(zt.x),cn+=Math.abs(zt.y),ke+=Math.abs(zt.x),Ce+=Math.abs(zt.y),tn+=4,cn+=4,ke+=2,Ce+=2,ke*=pe,Ce*=pe,tn=Math.ceil(tn*pe),cn=Math.ceil(cn*pe),rn.width=tn,rn.height=cn,Ye.transform(pe,0,0,pe,ke,Ce),q.forEach(_r=>{Ye.lineWidth=mn,Ye.strokeStyle=kn,_r.fill!=="none"&&(Ye.fillStyle=Jn),(bt==null?void 0:bt.dash)&&Ye.setLineDash(bt.dash.split(",").map(ai=>Number(ai.trim()))),Ye.beginPath();const{scale:or}=_r,Tr=_r.path.trim().split(" ");let si={x:0,y:0};for(let ai=0;ai<Tr.length;ai+=2){const Bi=Tr[ai],So=Tr[ai+1];if(Bi==="M"){let[tr,ei]=So.split(",").map(Wr=>Number(Wr));si={x:tr,y:ei},tr=tr/9525*or.x,ei=ei/9525*or.y,Ye.moveTo(tr,ei)}else if(Bi==="A"){const[tr,ei,Wr,rr]=So.split(",").map($n=>Number($n));si=Wf(si,or,tr,ei,Wr,rr,Ye)}else if(Bi==="L"){let[tr,ei]=So.split(",").map(Wr=>Number(Wr));si={x:tr,y:ei},tr=tr/9525*or.x,ei=ei/9525*or.y,Ye.lineTo(tr,ei)}else if(Bi==="QB"){let[tr,ei,Wr,rr]=So.split(",").map($n=>Number($n));si={x:Wr,y:rr},tr=tr/9525*or.x,ei=ei/9525*or.y,Wr=Wr/9525*or.x,rr=rr/9525*or.y,Ye.quadraticCurveTo(tr,ei,Wr,rr)}else if(Bi==="CB"){let[tr,ei,Wr,rr,$n,eo]=So.split(",").map(dl=>Number(dl));si={x:$n,y:eo},tr=tr/9525*or.x,ei=ei/9525*or.y,Wr=Wr/9525*or.x,rr=rr/9525*or.y,$n=$n/9525*or.x,eo=eo/9525*or.y,Ye.bezierCurveTo(tr,ei,Wr,rr,$n,eo)}else Bi==="C"&&Ye.closePath()}_r.hasStroke&&mn>0&&Ye.stroke(),_r.fill!=="none"&&De&&Ye.fill("nonzero")}),{texture:new Nn(new On(rn,{width:rn.width/2,height:rn.height/2,resolution:pe})),pivot:ie,padding:2}}(n,s,l,h,r,p);this.graphics.push({id:w,texture:R,pivot:H,width:R.width,height:R.height,padding:z})}return b}pack(){this.graphics.forEach(n=>{n.width+=4,n.height+=4}),xp(this.graphics).forEach(n=>{this.render(n)}),this.graphics.forEach(n=>{n.texture.destroy(!0)}),this.graphics=[]}destroy(){Object.keys(this.textures).forEach(n=>{var e;(e=this.textures[n])===null||e===void 0||e.texture.destroy()}),this.textures=Object.create(null),this.graphics=[],this.renderContainers.forEach(n=>n.destroy({children:!0,baseTexture:!0,texture:!0})),this.renderTextures.forEach(n=>n.destroy(!0))}}var Mp=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class Ap{constructor(n){this.gifs=Object.create(null),this.textures=Object.create(null),this.spriteSheets=[],this.isLoaded=!1,this.loader=n}getTexture(n){return this.textures[n]||null}getGifFrames(n){return this.gifs[n]?this.gifs[n].filter(e=>!!e):[]}loadSpriteSheetItem(n,e,r){return Mp(this,void 0,void 0,function*(){const s=yield this.loader.fetchJson(`${n}/${e}/jsonOutput/${r}.json`),l=yield this.loader.fetchPng(`${n}/${e}/jsonOutput/${r}.png`),h=document.createElement("img");h.src=l,yield new Promise((b,w)=>{h.onload=()=>b(""),h.onerror=()=>w()});const p=new On(h),x=new Ud(p,s);yield new Promise(b=>{x.parse(()=>b(""))}),this.spriteSheets.push(x),Object.keys(x.textures).forEach(b=>{const w=b.match(/^(.+)_gif_(\d+)$/);if(w&&w[1]&&w[2]){const R=w[1];this.gifs[R]||(this.gifs[R]=[]);const H=parseInt(w[2],10);this.gifs[R][H]=x.textures[b]}else this.textures[b]=x.textures[b]})})}loadSpriteSheets(n,e,r){return this.isLoaded?Promise.resolve([]):(this.isLoaded=!0,Promise.all(n.map(s=>this.loadSpriteSheetItem(e,r,s))))}destroy(){this.isLoaded=!1,this.spriteSheets.forEach(n=>n.destroy(!0))}}class Pp{constructor(){this.prevTime=-1,this.times=10,this.dur=0,this.valeList=[],this.value=0,this.calcFps()}calcFps(){requestAnimationFrame(n=>{const e=n-this.prevTime;this.dur+=e,this.times-=1,this.times===0&&(this.valeList.push(1e4/this.dur),this.times=10,this.dur=0,this.valeList.length>10&&(this.value=Math.round(this.valeList.reduce((r,s)=>r+s)/this.valeList.length),this.valeList=[])),this.prevTime=n,this.calcFps()})}}var Xf=S(10),qf=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};class Cp{constructor(n){this.useCache=!1,this.useCache=n}bindTask(n){this.taskId=n,this.useCache&&(this.cache=Xf.createInstance({name:"_slide_local_cache_",storeName:this.taskId,driver:Xf.INDEXEDDB,version:1}),this.cache.clear().catch(()=>{}))}fetchJson(n){var e,r;return qf(this,void 0,void 0,function*(){let s=yield(e=this.cache)===null||e===void 0?void 0:e.getItem(n);return s&&this.useCache||(s=yield(yield fetch(n)).json(),this.useCache&&(yield(r=this.cache)===null||r===void 0?void 0:r.setItem(n,s))),s})}fetchPng(n){var e,r;return qf(this,void 0,void 0,function*(){let s=yield(e=this.cache)===null||e===void 0?void 0:e.getItem(n);if(s&&this.useCache)return s;if(s=yield fetch(n).then(l=>l.blob()).then(l=>new Promise((h,p)=>{const x=new FileReader;x.onload=()=>{h(x.result)},x.onerror=()=>{p(new Error(`fetch ${n} failed`))},x.readAsDataURL(l)})),this.useCache&&(yield(r=this.cache)===null||r===void 0?void 0:r.setItem(n,s)),!s)throw new Error(`fetch ${n} failed`);return s})}destroy(){var n;(n=this.cache)===null||n===void 0||n.clear().catch(()=>{})}}var Zh=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})};window.PIXI=j,it.skipHello();const vi={randomBar:"RandomLines",circle:"Shape",ripple:"Ripples",wipe:"Erase",dissolve:"Dissolve",morph:"Smooth",fade:"FadeInOut",push:"Push",split:"Separation",reveal:"Display",pull:"Uncover",cover:"Cover",flash:"Flash",checker:"Checkerboard",blinds:"WindowShades",curtains:"Curtain",fallOver:"Fall",drape:"Suspension",wheel:"Clock",comb:"Combing",warp:"Scale",peelOff:"PeelOff",flip:"Flip"};class al{constructor(n){this.eventHub=n,this.targets=Object.create(null)}addTarget(n,e){this.targets[n]=e}getTargetById(n){return this.targets[n]}getTarget(n,e,r={type:"el",index:0,id:""}){var s,l;let h=this.targets[n.id];return n.type!=="shape"?h:(n.type==="shape"&&n.txEl&&(h=(s=h==null?void 0:h.getTextElement(n.txEl.type,n.txEl.range))!==null&&s!==void 0?s:null),n.type==="shape"&&n.bg&&r.index===0&&(e=!1,h=(l=h==null?void 0:h.getBgElement())!==null&&l!==void 0?l:null,this.eventHub.emit("IterateTimeNodeEnd",r.id)),e&&h?h.getIterateEntry(r.type,r.index,r.id):h)}clearTargets(){this.targets=Object.create(null)}}const Ya={prev:"gotoPrev",next:"gotoNext",goto:"gotoSlide"},wr={mainSeqStepChange:"mainSeqStepChange",mainSeqStateChange:"mainSeqStateChange",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",slideChange:"slideChange",renderStart:"renderStart",renderEnd:"renderEnd",hyperlinkTrigger:"hyperlinkTrigger",interactiveAnimTrigger:"interactiveAnimTrigger",animateStart:"animateStart",animateEnd:"animateEnd",mediaSeek:"mediaSeek",mediaPlay:"mediaPlay",mediaPause:"mediaPause"};class om extends X.a{constructor(n,e={}){super(),this.loader=new Cp(!1),this.transactionPlayer=new tt.TransactionPlayer,this.transactionSprite=new oi,this.isForward=!0,this.dynamicResolution=1,this.drawCall=0,this.fps=new Pp,this.width=0,this.height=0,this.currentIndex=0,this.slideCount=0,this.frameList=[],this.runtime={drawCall:0,fps:0},this.handlePrevSlide=()=>Zh(this,void 0,void 0,function*(){const l=this.currentIndex-1;l>=1&&(this.isForward=!1,yield this.renderSlide(l))}),this.handleNextSlide=()=>Zh(this,void 0,void 0,function*(){const l=this.currentIndex+1;l<=this.slideCount&&(this.isForward=!0,yield this.renderSlide(l))}),this.handleGotoSlide=l=>{l<=this.slideCount&&l>=1&&this.renderSlide(l)},this.mode=n,this.config={minFPS:Object(ft.isUndefined)(e.minFPS)?45:e.minFPS,maxFPS:Object(ft.isUndefined)(e.maxFPS)?50:e.maxFPS,resolution:Object(ft.isUndefined)(e.resolution)?window.devicePixelRatio:e.resolution,autoResolution:!Object(ft.isUndefined)(e.autoResolution)&&e.autoResolution,minResolution:Object(ft.isUndefined)(e.minResolution)?1:e.minResolution,autoFPS:!Object(ft.isUndefined)(e.autoFPS)&&e.autoFPS},this.app=new lu({antialias:!0,autoDensity:!0,backgroundColor:16777215}),this.updateConfig(this.config),this.app.view.style.zIndex="1",this.app.stage.sortableChildren=!0;const r=this.app.renderer,{drawElements:s}=r.gl;r.gl.drawElements=(...l)=>{s.call(r.gl,...l),this.drawCall+=1},this.app.ticker.add(l=>{this.runtime.drawCall=this.drawCall,this.drawCall=0;const h=1e3/(l/(Vt.TARGET_FPMS||.06));if(this.frameList.push(h),this.frameList.length>50){const p=this.frameList.reduce((x,b)=>x+b)/this.frameList.length;if(this.runtime.fps=Math.floor(p),this.fps.value<this.config.minFPS)this.dynamicResolution=this.app.renderer.resolution-.1,this.dynamicResolution=Math.max(this.config.minResolution,this.dynamicResolution),this.dynamicResolution<=this.config.minResolution&&this.config.autoFPS&&(this.app.ticker.minFPS-=2,this.app.ticker.maxFPS-=2);else if(this.fps.value>1.08*this.config.minFPS&&this.fps.value<=this.config.maxFPS){const x=Math.min(this.app.ticker.minFPS+2,this.config.minFPS),b=Math.min(this.app.ticker.maxFPS+2,this.config.maxFPS);x<=this.config.minFPS&&(this.app.ticker.minFPS=x),b<=this.config.maxFPS&&(this.app.ticker.maxFPS=b),x>=this.config.minFPS&&b>=this.config.maxFPS&&(this.dynamicResolution+=.1,this.dynamicResolution=Math.max(this.config.minResolution,this.dynamicResolution))}this.config.autoResolution&&this.dynamicResolution!==this.app.renderer.resolution&&this.app.ticker.addOnce(()=>{const x=Math.min(this.dynamicResolution,this.config.resolution);this.app.renderer.resolution=x,this.app.renderer.plugins.interaction.resolution=this.app.renderer.resolution,this.app.renderer.resize(this.width,this.height)},no.HIGH),this.frameList=[]}},null,no.LOW)}get view(){return this.app.view}clearForward(){this.isForward=!0}updateConfig(n){Object(ft.isUndefined)(n.minFPS)||(this.config.minFPS=n.minFPS,this.app.ticker.minFPS=n.minFPS),Object(ft.isUndefined)(n.maxFPS)||(this.config.maxFPS=n.maxFPS,this.app.ticker.maxFPS=n.maxFPS),Object(ft.isUndefined)(n.resolution)||(this.config.resolution=n.resolution,this.app.ticker.addOnce(()=>{this.app.renderer.resolution=n.resolution||window.devicePixelRatio,this.app.renderer.plugins.interaction.resolution=this.app.renderer.resolution,this.app.renderer.resize(this.width,this.height)},no.HIGH)),Object(ft.isUndefined)(n.autoResolution)||(this.config.autoResolution=n.autoResolution),Object(ft.isUndefined)(n.autoFPS)||(this.config.autoFPS=n.autoFPS),Object(ft.isUndefined)(n.minResolution)||(this.config.minResolution=n.minResolution)}preload(n){return Zh(this,void 0,void 0,function*(){if(n<1||n>this.slideCount||!this.loader.cache)return;const e=yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/slide-${n}.json`),{sheets:r}=e;for(const s of r)yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/${s}.json`),yield this.loader.fetchPng(`${this.url}/${this.taskId}/jsonOutput/${s}.png`)})}setResourceData(n,e){this.taskId=n,this.url=e,this.loader.bindTask(n)}setInteractive(n){this.app.stage.interactive=n,this.app.stage.interactiveChildren=n}loadSlide(n){return Zh(this,void 0,void 0,function*(){const e=new Ap(this.loader),r=new X.a,s={mode:this.mode,renderer:this.app.renderer,graphicsTexture:new Ep(this.app.renderer),fillTexture:new Tp(this.app.renderer,e),stageWidth:0,stageHeight:0,ticker:this.app.ticker,timingTargets:new al(r),eventHub:r,view:this.app.view,medias:Object.create(null)},l=yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/slide-${n}.json`),{width:h,height:p,sheets:x}=l;yield e.loadSpriteSheets(x,this.url,this.taskId),s.stageWidth=h,s.stageHeight=p;const b=new Xc(l,s,{x:0,y:0});return s.eventHub.on(Ya.prev,this.handlePrevSlide),s.eventHub.on(Ya.next,this.handleNextSlide),s.eventHub.on(Ya.goto,this.handleGotoSlide),this.translateEvent(s.eventHub,[wr.mainSeqStepChange,wr.mainSeqStateChange,wr.hyperlinkTrigger,wr.interactiveAnimTrigger,wr.mainSeqStepStart,wr.mainSeqStepEnd,wr.animateStart,wr.animateEnd,wr.mediaPlay,wr.mediaPause,wr.mediaSeek]),b.preRender(),s.fillTexture.pack(),s.graphicsTexture.pack(),{stage:b,json:l}})}translateEvent(n,e){e.forEach(r=>{n.on(r,(...s)=>{this.emit(r,...s)})})}renderSlide(n){return Zh(this,void 0,void 0,function*(){this.emit(wr.renderStart,n),this.currentIndex=Number(n);const e=yield this.loadSlide(n),{width:r,height:s,slideCount:l}=e.json;let h;this.slideCount=l,this.app.view.style.width=r+"px",this.app.view.style.height=s+"px",this.app.renderer.resize(r,s),this.width=r,this.height=s,this.currentStage&&(e.json.transition&&e.json.transition.type&&(h=this.getBase64(this.currentStage)),this.prevStage=this.currentStage),this.currentStage=e,yield e.stage.render(),e.stage.createTiming(),e.stage.container.visible=!0,e.stage.collectMainSeqStartValue(),this.isForward?e.stage.setMainSeqStep(0,"start"):e.stage.setMainSeqStep(-1,"end");const p=this.getBase64(this.currentStage);e.stage.container.visible=!1,this.app.stage.addChild(e.stage.container),h&&p&&e.json.transition&&e.json.transition.type&&(yield this.playTransaction(h,p,e.json.transition)),this.prevStage&&(this.app.stage.removeChild(this.prevStage.stage.container),this.prevStage.stage.destroy(),this.prevStage=void 0),this.isForward?e.stage.startTiming():e.stage.setMainSeqApplied(),e.stage.container.visible=!0,this.emit(wr.renderEnd,n),this.emit(wr.slideChange,n),this.preload(n+1).catch(()=>{}),this.preload(n-1).catch(()=>{})})}getBase64(n){const{width:e,height:r}=n.json,s=Zi.create({width:e,height:r});return this.app.renderer.render(n.stage.container,{renderTexture:s}),this.app.renderer.plugins.extract.base64(s,"image/jpeg")}playTransaction(n,e,r){return Zh(this,void 0,void 0,function*(){const s=this.app.view.parentElement;if(n&&e&&s&&vi[r.type]){this.transactionSprite.zIndex=999,this.app.stage.addChild(this.transactionSprite);const l=this.transactionPlayer.renderer.domElement,h=Nn.from(l),p=()=>h.update();this.app.ticker.add(p),this.transactionSprite.texture=h;const{width:x,height:b}=this.currentStage.json;return new Promise(w=>{var R,H;this.transactionPlayer.play({reverse:!this.isForward,prevTextureUrl:n,nextTextureUrl:e,textureWidth:x,textureHeight:b,presetType:vi[r.type],stageWidth:x,stageHeight:b,duration:(H=(R=this.currentStage)===null||R===void 0?void 0:R.json.transition)===null||H===void 0?void 0:H.dur,delay:0,onTransactionEnd:()=>{w(),this.app.stage.removeChild(this.transactionSprite),this.app.ticker.remove(p)}})})}return Promise.resolve()})}nextStep(){var n;(n=this.currentStage)===null||n===void 0||n.stage.nextStep()}prevStep(){var n;(n=this.currentStage)===null||n===void 0||n.stage.prevStep()}mainSeqLength(){var n,e;return(e=(n=this.currentStage)===null||n===void 0?void 0:n.stage.mainSeqLength())!==null&&e!==void 0?e:0}mainSeqStep(){var n,e;return(e=(n=this.currentStage)===null||n===void 0?void 0:n.stage.mainSeqStep())!==null&&e!==void 0?e:0}setMainSeqStep(n,e){var r;(r=this.currentStage)===null||r===void 0||r.stage.setMainSeqStep(n,e)}mainSeqState(){var n,e;return(e=(n=this.currentStage)===null||n===void 0?void 0:n.stage.mainSeqState())!==null&&e!==void 0?e:null}mainSeqHasNextStep(){var n,e;return(e=(n=this.currentStage)===null||n===void 0?void 0:n.stage.mainSeqHasNextStep())!==null&&e!==void 0&&e}mainSeqHasPrevStep(){var n,e;return(e=(n=this.currentStage)===null||n===void 0?void 0:n.stage.mainSeqHasPrevStep())!==null&&e!==void 0&&e}nextTick(n){this.app.ticker.addOnce(()=>{n()},no.LOW)}applyInteractiveAction(n){var e;(e=this.currentStage)===null||e===void 0||e.stage.applyInteractiveAction(n)}seekInteractiveSeqToEnd(n){var e;(e=this.currentStage)===null||e===void 0||e.stage.seekInteractiveSeqToEnd(n)}setMediaState(n,e){var r;return Zh(this,void 0,void 0,function*(){yield(r=this.currentStage)===null||r===void 0?void 0:r.stage.setMediaState(n,e)})}setMediaCurrentTime(n,e){var r;(r=this.currentStage)===null||r===void 0||r.stage.setMediaCurrentTime(n,e)}pause(){this.app.ticker.stop()}resume(){this.app.ticker.start()}destroy(){this.prevStage&&this.prevStage.stage.destroy(),this.currentStage&&this.currentStage.stage.destroy(),this.loader.destroy()}}var vs,Qs=[],Yf="ResizeObserver loop completed with undelivered notifications.";(function(o){o.BORDER_BOX="border-box",o.CONTENT_BOX="content-box",o.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(vs||(vs={}));var Jh,Ql=function(o){return Object.freeze(o)},Kc=function(o,n){this.inlineSize=o,this.blockSize=n,Ql(this)},th=function(){function o(n,e,r,s){return this.x=n,this.y=e,this.width=r,this.height=s,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Ql(this)}return o.prototype.toJSON=function(){var n=this;return{x:n.x,y:n.y,top:n.top,right:n.right,bottom:n.bottom,left:n.left,width:n.width,height:n.height}},o.fromRect=function(n){return new o(n.x,n.y,n.width,n.height)},o}(),$h=function(o){return o instanceof SVGElement&&"getBBox"in o},Qc=function(o){if($h(o)){var n=o.getBBox(),e=n.width,r=n.height;return!e&&!r}var s=o,l=s.offsetWidth,h=s.offsetHeight;return!(l||h||o.getClientRects().length)},sm=function(o){var n,e;if(o instanceof Element)return!0;var r=(e=(n=o)===null||n===void 0?void 0:n.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(r&&o instanceof r.Element)},Za=typeof window!="undefined"?window:{},td=new WeakMap,Rp=/auto|scroll/,ts=/^tb|vertical/,Ja=/msie|trident/i.test(Za.navigator&&Za.navigator.userAgent),uo=function(o){return parseFloat(o||"0")},ed=function(o,n,e){return o===void 0&&(o=0),n===void 0&&(n=0),e===void 0&&(e=!1),new Kc((e?n:o)||0,(e?o:n)||0)},am=Ql({devicePixelContentBoxSize:ed(),borderBoxSize:ed(),contentBoxSize:ed(),contentRect:new th(0,0,0,0)}),nd=function(o,n){if(n===void 0&&(n=!1),td.has(o)&&!n)return td.get(o);if(Qc(o))return td.set(o,am),am;var e=getComputedStyle(o),r=$h(o)&&o.ownerSVGElement&&o.getBBox(),s=!Ja&&e.boxSizing==="border-box",l=ts.test(e.writingMode||""),h=!r&&Rp.test(e.overflowY||""),p=!r&&Rp.test(e.overflowX||""),x=r?0:uo(e.paddingTop),b=r?0:uo(e.paddingRight),w=r?0:uo(e.paddingBottom),R=r?0:uo(e.paddingLeft),H=r?0:uo(e.borderTopWidth),z=r?0:uo(e.borderRightWidth),q=r?0:uo(e.borderBottomWidth),at=R+b,_t=x+w,bt=(r?0:uo(e.borderLeftWidth))+z,zt=H+q,De=p?o.offsetHeight-zt-o.clientHeight:0,an=h?o.offsetWidth-bt-o.clientWidth:0,Dt=s?at+bt:0,ue=s?_t+zt:0,te=r?r.width:uo(e.width)-Dt-an,he=r?r.height:uo(e.height)-ue-De,Ve=te+at+an+bt,Pe=he+_t+De+zt,ie=Ql({devicePixelContentBoxSize:ed(Math.round(te*devicePixelRatio),Math.round(he*devicePixelRatio),l),borderBoxSize:ed(Ve,Pe,l),contentBoxSize:ed(te,he,l),contentRect:new th(R,x,te,he)});return td.set(o,ie),ie},Ip=function(o,n,e){var r=nd(o,e),s=r.borderBoxSize,l=r.contentBoxSize,h=r.devicePixelContentBoxSize;switch(n){case vs.DEVICE_PIXEL_CONTENT_BOX:return h;case vs.BORDER_BOX:return s;default:return l}},um=function(o){var n=nd(o);this.target=o,this.contentRect=n.contentRect,this.borderBoxSize=Ql([n.borderBoxSize]),this.contentBoxSize=Ql([n.contentBoxSize]),this.devicePixelContentBoxSize=Ql([n.devicePixelContentBoxSize])},Lp=function(o){if(Qc(o))return 1/0;for(var n=0,e=o.parentNode;e;)n+=1,e=e.parentNode;return n},lm=function(){var o=1/0,n=[];Qs.forEach(function(s){if(s.activeTargets.length!==0){var l=[];s.activeTargets.forEach(function(h){var p=new um(h.target),x=Lp(h.target);l.push(p),h.lastReportedSize=Ip(h.target,h.observedBox),x<o&&(o=x)}),n.push(function(){s.callback.call(s.observer,l,s.observer)}),s.activeTargets.splice(0,s.activeTargets.length)}});for(var e=0,r=n;e<r.length;e++)(0,r[e])();return o},rd=function(o){Qs.forEach(function(n){n.activeTargets.splice(0,n.activeTargets.length),n.skippedTargets.splice(0,n.skippedTargets.length),n.observationTargets.forEach(function(e){e.isActive()&&(Lp(e.target)>o?n.activeTargets.push(e):n.skippedTargets.push(e))})})},eh=function(){var o,n=0;for(rd(n);Qs.some(function(e){return e.activeTargets.length>0});)n=lm(),rd(n);return Qs.some(function(e){return e.skippedTargets.length>0})&&(typeof ErrorEvent=="function"?o=new ErrorEvent("error",{message:Yf}):((o=document.createEvent("Event")).initEvent("error",!1,!1),o.message=Yf),window.dispatchEvent(o)),n>0},_a=[],Op=function(o){if(!Jh){var n=0,e=document.createTextNode("");new MutationObserver(function(){return _a.splice(0).forEach(function(r){return r()})}).observe(e,{characterData:!0}),Jh=function(){e.textContent=""+(n?n--:n++)}}_a.push(o),Jh()},Zf=0,hm={attributes:!0,characterData:!0,childList:!0,subtree:!0},Dp=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],Jf=function(o){return o===void 0&&(o=0),Date.now()+o},$f=!1,of=new(function(){function o(){var n=this;this.stopped=!0,this.listener=function(){return n.schedule()}}return o.prototype.run=function(n){var e=this;if(n===void 0&&(n=250),!$f){$f=!0;var r,s=Jf(n);r=function(){var l=!1;try{l=eh()}finally{if($f=!1,n=s-Jf(),!Zf)return;l?e.run(1e3):n>0?e.run(n):e.start()}},Op(function(){requestAnimationFrame(r)})}},o.prototype.schedule=function(){this.stop(),this.run()},o.prototype.observe=function(){var n=this,e=function(){return n.observer&&n.observer.observe(document.body,hm)};document.body?e():Za.addEventListener("DOMContentLoaded",e)},o.prototype.start=function(){var n=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),Dp.forEach(function(e){return Za.addEventListener(e,n.listener,!0)}))},o.prototype.stop=function(){var n=this;this.stopped||(this.observer&&this.observer.disconnect(),Dp.forEach(function(e){return Za.removeEventListener(e,n.listener,!0)}),this.stopped=!0)},o}()),Np=function(o){!Zf&&o>0&&of.start(),!(Zf+=o)&&of.stop()},sf=function(){function o(n,e){this.target=n,this.observedBox=e||vs.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return o.prototype.isActive=function(){var n,e=Ip(this.target,this.observedBox,!0);return n=this.target,$h(n)||function(r){switch(r.tagName){case"INPUT":if(r.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(n)||getComputedStyle(n).display!=="inline"||(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},o}(),Fp=function(o,n){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=o,this.callback=n},af=new WeakMap,Kf=function(o,n){for(var e=0;e<o.length;e+=1)if(o[e].target===n)return e;return-1},nh=function(){function o(){}return o.connect=function(n,e){var r=new Fp(n,e);af.set(n,r)},o.observe=function(n,e,r){var s=af.get(n),l=s.observationTargets.length===0;Kf(s.observationTargets,e)<0&&(l&&Qs.push(s),s.observationTargets.push(new sf(e,r&&r.box)),Np(1),of.schedule())},o.unobserve=function(n,e){var r=af.get(n),s=Kf(r.observationTargets,e),l=r.observationTargets.length===1;s>=0&&(l&&Qs.splice(Qs.indexOf(r),1),r.observationTargets.splice(s,1),Np(-1))},o.disconnect=function(n){var e=this,r=af.get(n);r.observationTargets.slice().forEach(function(s){return e.unobserve(n,s.target)}),r.activeTargets.splice(0,r.activeTargets.length)},o}(),cm=function(){function o(n){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof n!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");nh.connect(this,n)}return o.prototype.observe=function(n,e){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!sm(n))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");nh.observe(this,n,e)},o.prototype.unobserve=function(n){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!sm(n))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");nh.unobserve(this,n)},o.prototype.disconnect=function(){nh.disconnect(this)},o.toString=function(){return"function ResizeObserver () { [polyfill code] }"},o}(),Bp=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})},Up=function(o,n){var e,r,s,l,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(x){return function(b){return function(w){if(e)throw new TypeError("Generator is already executing.");for(;h;)try{if(e=1,r&&(s=2&w[0]?r.return:w[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,w[1])).done)return s;switch(r=0,s&&(w=[2&w[0],s.value]),w[0]){case 0:case 1:s=w;break;case 4:return h.label++,{value:w[1],done:!1};case 5:h.label++,r=w[1],w=[0];continue;case 7:w=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!((s=s.length>0&&s[s.length-1])||w[0]!==6&&w[0]!==2)){h=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){h.label=w[1];break}if(w[0]===6&&h.label<s[1]){h.label=s[1],s=w;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(w);break}s[2]&&h.ops.pop(),h.trys.pop();continue}w=n.call(o,h)}catch(R){w=[6,R],r=0}finally{e=s=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([x,b])}}},kp=function(){function o(n,e,r,s){this.state="idle",this.index=-1,this.slideIndex=-1,this.fn=r,this.index=n,this.slideIndex=e,this.eventHub=s}return o.prototype.apply=function(){return Bp(this,void 0,void 0,function(){var n;return Up(this,function(e){switch(e.label){case 0:this.eventHub.emit("task-start",this),e.label=1;case 1:return e.trys.push([1,3,,4]),this.state="start",[4,this.fn()];case 2:return e.sent(),this.state="end",this.eventHub.emit("task-end",this),[3,4];case 3:return n=e.sent(),this.eventHub.emit("task-error",{task:this,error:n}),[3,4];case 4:return[2]}})})},o}(),Gp=function(){function o(){var n=this;this.eventHub=new X.a,this.tasks=[],this.index=0,this.eventHub.on("task-end",function(e){var r,s=n.tasks.findIndex(function(h){return h.index===e.index}),l=s+1;l>=0&&((r=n.tasks[l])===null||r===void 0||r.apply()),s>=0&&(n.tasks.splice(s,1),n.replaceIdleTask())}),this.eventHub.on("task-error",function(e){var r=e.task,s=n.tasks.findIndex(function(l){return l.index===r.index});s>=0&&(n.tasks.splice(s,1),n.replaceIdleTask())})}return o.prototype.replaceIdleTask=function(){for(var n,e=this,r=new Set,s=0,l=this.tasks.length;s<l;s++)this.tasks[s].state==="idle"&&((n=this.tasks[s+1])===null||n===void 0?void 0:n.state)==="idle"&&r.add(s);Array.from(r).forEach(function(h){e.tasks.splice(h,1)})},o.prototype.addTask=function(n,e){var r=new kp(this.index++,e,n,this.eventHub);this.tasks.push(r),this.tasks.sort(function(s,l){return s.index-l.index}),this.replaceIdleTask(),this.tasks.length===1&&r.apply()},o.prototype.hasStartTask=function(){return this.tasks.some(function(n){return n.state==="start"})},o}(),uf=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})},dm=function(o,n){var e,r,s,l,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(x){return function(b){return function(w){if(e)throw new TypeError("Generator is already executing.");for(;h;)try{if(e=1,r&&(s=2&w[0]?r.return:w[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,w[1])).done)return s;switch(r=0,s&&(w=[2&w[0],s.value]),w[0]){case 0:case 1:s=w;break;case 4:return h.label++,{value:w[1],done:!1};case 5:h.label++,r=w[1],w=[0];continue;case 7:w=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!((s=s.length>0&&s[s.length-1])||w[0]!==6&&w[0]!==2)){h=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){h.label=w[1];break}if(w[0]===6&&h.label<s[1]){h.label=s[1],s=w;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(w);break}s[2]&&h.ops.pop(),h.trys.pop();continue}w=n.call(o,h)}catch(R){w=[6,R],r=0}finally{e=s=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([x,b])}}};function Qf(o,n){return uf(this,void 0,void 0,function(){var e;return dm(this,function(r){switch(r.label){case 0:e=Date.now(),r.label=1;case 1:return!o()&&Date.now()-e<n?[4,(s=50,new Promise(function(l){return setTimeout(l,s)}))]:[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}var s})})}function rh(o,n){var e=o.__state.conversionName.toString(),r=Math.round(o.r),s=Math.round(o.g),l=Math.round(o.b),h=o.a,p=Math.round(o.h),x=o.s.toFixed(1),b=o.v.toFixed(1);if(n||e==="THREE_CHAR_HEX"||e==="SIX_CHAR_HEX"){for(var w=o.hex.toString(16);w.length<6;)w="0"+w;return"#"+w}return e==="CSS_RGB"?"rgb("+r+","+s+","+l+")":e==="CSS_RGBA"?"rgba("+r+","+s+","+l+","+h+")":e==="HEX"?"0x"+o.hex.toString(16):e==="RGB_ARRAY"?"["+r+","+s+","+l+"]":e==="RGBA_ARRAY"?"["+r+","+s+","+l+","+h+"]":e==="RGB_OBJ"?"{r:"+r+",g:"+s+",b:"+l+"}":e==="RGBA_OBJ"?"{r:"+r+",g:"+s+",b:"+l+",a:"+h+"}":e==="HSV_OBJ"?"{h:"+p+",s:"+x+",v:"+b+"}":e==="HSVA_OBJ"?"{h:"+p+",s:"+x+",v:"+b+",a:"+h+"}":"unknown format"}var tp=Array.prototype.forEach,id=Array.prototype.slice,Oe={BREAK:{},extend:function(o){return this.each(id.call(arguments,1),function(n){(this.isObject(n)?Object.keys(n):[]).forEach(function(e){this.isUndefined(n[e])||(o[e]=n[e])}.bind(this))},this),o},defaults:function(o){return this.each(id.call(arguments,1),function(n){(this.isObject(n)?Object.keys(n):[]).forEach(function(e){this.isUndefined(o[e])&&(o[e]=n[e])}.bind(this))},this),o},compose:function(){var o=id.call(arguments);return function(){for(var n=id.call(arguments),e=o.length-1;e>=0;e--)n=[o[e].apply(this,n)];return n[0]}},each:function(o,n,e){if(o){if(tp&&o.forEach&&o.forEach===tp)o.forEach(n,e);else if(o.length===o.length+0){var r,s=void 0;for(s=0,r=o.length;s<r;s++)if(s in o&&n.call(e,o[s],s)===this.BREAK)return}else for(var l in o)if(n.call(e,o[l],l)===this.BREAK)return}},defer:function(o){setTimeout(o,0)},debounce:function(o,n,e){var r=void 0;return function(){var s=this,l=arguments;function h(){r=null,e||o.apply(s,l)}var p=e||!r;clearTimeout(r),r=setTimeout(h,n),p&&o.apply(s,l)}},toArray:function(o){return o.toArray?o.toArray():id.call(o)},isUndefined:function(o){return o===void 0},isNull:function(o){return o===null},isNaN:function(o){function n(e){return o.apply(this,arguments)}return n.toString=function(){return o.toString()},n}(function(o){return isNaN(o)}),isArray:Array.isArray||function(o){return o.constructor===Array},isObject:function(o){return o===Object(o)},isNumber:function(o){return o===o+0},isString:function(o){return o===o+""},isBoolean:function(o){return o===!1||o===!0},isFunction:function(o){return o instanceof Function}},Rm=[{litmus:Oe.isString,conversions:{THREE_CHAR_HEX:{read:function(o){var n=o.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return n!==null&&{space:"HEX",hex:parseInt("0x"+n[1].toString()+n[1].toString()+n[2].toString()+n[2].toString()+n[3].toString()+n[3].toString(),0)}},write:rh},SIX_CHAR_HEX:{read:function(o){var n=o.match(/^#([A-F0-9]{6})$/i);return n!==null&&{space:"HEX",hex:parseInt("0x"+n[1].toString(),0)}},write:rh},CSS_RGB:{read:function(o){var n=o.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return n!==null&&{space:"RGB",r:parseFloat(n[1]),g:parseFloat(n[2]),b:parseFloat(n[3])}},write:rh},CSS_RGBA:{read:function(o){var n=o.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return n!==null&&{space:"RGB",r:parseFloat(n[1]),g:parseFloat(n[2]),b:parseFloat(n[3]),a:parseFloat(n[4])}},write:rh}}},{litmus:Oe.isNumber,conversions:{HEX:{read:function(o){return{space:"HEX",hex:o,conversionName:"HEX"}},write:function(o){return o.hex}}}},{litmus:Oe.isArray,conversions:{RGB_ARRAY:{read:function(o){return o.length===3&&{space:"RGB",r:o[0],g:o[1],b:o[2]}},write:function(o){return[o.r,o.g,o.b]}},RGBA_ARRAY:{read:function(o){return o.length===4&&{space:"RGB",r:o[0],g:o[1],b:o[2],a:o[3]}},write:function(o){return[o.r,o.g,o.b,o.a]}}}},{litmus:Oe.isObject,conversions:{RGBA_OBJ:{read:function(o){return!!(Oe.isNumber(o.r)&&Oe.isNumber(o.g)&&Oe.isNumber(o.b)&&Oe.isNumber(o.a))&&{space:"RGB",r:o.r,g:o.g,b:o.b,a:o.a}},write:function(o){return{r:o.r,g:o.g,b:o.b,a:o.a}}},RGB_OBJ:{read:function(o){return!!(Oe.isNumber(o.r)&&Oe.isNumber(o.g)&&Oe.isNumber(o.b))&&{space:"RGB",r:o.r,g:o.g,b:o.b}},write:function(o){return{r:o.r,g:o.g,b:o.b}}},HSVA_OBJ:{read:function(o){return!!(Oe.isNumber(o.h)&&Oe.isNumber(o.s)&&Oe.isNumber(o.v)&&Oe.isNumber(o.a))&&{space:"HSV",h:o.h,s:o.s,v:o.v,a:o.a}},write:function(o){return{h:o.h,s:o.s,v:o.v,a:o.a}}},HSV_OBJ:{read:function(o){return!!(Oe.isNumber(o.h)&&Oe.isNumber(o.s)&&Oe.isNumber(o.v))&&{space:"HSV",h:o.h,s:o.s,v:o.v}},write:function(o){return{h:o.h,s:o.s,v:o.v}}}}}],od=void 0,lf=void 0,ep=function(){lf=!1;var o=arguments.length>1?Oe.toArray(arguments):arguments[0];return Oe.each(Rm,function(n){if(n.litmus(o))return Oe.each(n.conversions,function(e,r){if(od=e.read(o),lf===!1&&od!==!1)return lf=od,od.conversionName=r,od.conversion=e,Oe.BREAK}),Oe.BREAK}),lf},Hp=void 0,sd={hsv_to_rgb:function(o,n,e){var r=Math.floor(o/60)%6,s=o/60-Math.floor(o/60),l=e*(1-n),h=e*(1-s*n),p=e*(1-(1-s)*n),x=[[e,p,l],[h,e,l],[l,e,p],[l,h,e],[p,l,e],[e,l,h]][r];return{r:255*x[0],g:255*x[1],b:255*x[2]}},rgb_to_hsv:function(o,n,e){var r=Math.min(o,n,e),s=Math.max(o,n,e),l=s-r,h=void 0;return s===0?{h:NaN,s:0,v:0}:(h=o===s?(n-e)/l:n===s?2+(e-o)/l:4+(o-n)/l,(h/=6)<0&&(h+=1),{h:360*h,s:l/s,v:s/255})},rgb_to_hex:function(o,n,e){var r=this.hex_with_component(0,2,o);return r=this.hex_with_component(r,1,n),r=this.hex_with_component(r,0,e)},component_from_hex:function(o,n){return o>>8*n&255},hex_with_component:function(o,n,e){return e<<(Hp=8*n)|o&~(255<<Hp)}},Im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},$a=function(o,n){if(!(o instanceof n))throw new TypeError("Cannot call a class as a function")},Bs=function(){function o(n,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}return function(n,e,r){return e&&o(n.prototype,e),r&&o(n,r),n}}(),bu=function o(n,e,r){n===null&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,e);if(s===void 0){var l=Object.getPrototypeOf(n);return l===null?void 0:o(l,e,r)}if("value"in s)return s.value;var h=s.get;return h!==void 0?h.call(r):void 0},ul=function(o,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n)},ll=function(o,n){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||typeof n!="object"&&typeof n!="function"?o:n},_o=function(){function o(){if($a(this,o),this.__state=ep.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Bs(o,[{key:"toString",value:function(){return rh(this)}},{key:"toHexString",value:function(){return rh(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),o}();function np(o,n,e){Object.defineProperty(o,n,{get:function(){return this.__state.space==="RGB"||_o.recalculateRGB(this,n,e),this.__state[n]},set:function(r){this.__state.space!=="RGB"&&(_o.recalculateRGB(this,n,e),this.__state.space="RGB"),this.__state[n]=r}})}function rp(o,n){Object.defineProperty(o,n,{get:function(){return this.__state.space==="HSV"||_o.recalculateHSV(this),this.__state[n]},set:function(e){this.__state.space!=="HSV"&&(_o.recalculateHSV(this),this.__state.space="HSV"),this.__state[n]=e}})}_o.recalculateRGB=function(o,n,e){if(o.__state.space==="HEX")o.__state[n]=sd.component_from_hex(o.__state.hex,e);else{if(o.__state.space!=="HSV")throw new Error("Corrupted color state");Oe.extend(o.__state,sd.hsv_to_rgb(o.__state.h,o.__state.s,o.__state.v))}},_o.recalculateHSV=function(o){var n=sd.rgb_to_hsv(o.r,o.g,o.b);Oe.extend(o.__state,{s:n.s,v:n.v}),Oe.isNaN(n.h)?Oe.isUndefined(o.__state.h)&&(o.__state.h=0):o.__state.h=n.h},_o.COMPONENTS=["r","g","b","h","s","v","hex","a"],np(_o.prototype,"r",2),np(_o.prototype,"g",1),np(_o.prototype,"b",0),rp(_o.prototype,"h"),rp(_o.prototype,"s"),rp(_o.prototype,"v"),Object.defineProperty(_o.prototype,"a",{get:function(){return this.__state.a},set:function(o){this.__state.a=o}}),Object.defineProperty(_o.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=sd.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(o){this.__state.space="HEX",this.__state.hex=o}});var Kh=function(){function o(n,e){$a(this,o),this.initialValue=n[e],this.domElement=document.createElement("div"),this.object=n,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0}return Bs(o,[{key:"onChange",value:function(n){return this.__onChange=n,this}},{key:"onFinishChange",value:function(n){return this.__onFinishChange=n,this}},{key:"setValue",value:function(n){return this.object[this.property]=n,this.__onChange&&this.__onChange.call(this,n),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),o}(),zp={};Oe.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(o,n){Oe.each(o,function(e){zp[e]=n})});var fm=/(\d+(\.\d+)?)px/;function es(o){if(o==="0"||Oe.isUndefined(o))return 0;var n=o.match(fm);return Oe.isNull(n)?0:parseFloat(n[1])}var Qt={makeSelectable:function(o,n){o!==void 0&&o.style!==void 0&&(o.onselectstart=n?function(){return!1}:function(){},o.style.MozUserSelect=n?"auto":"none",o.style.KhtmlUserSelect=n?"auto":"none",o.unselectable=n?"on":"off")},makeFullscreen:function(o,n,e){var r=e,s=n;Oe.isUndefined(s)&&(s=!0),Oe.isUndefined(r)&&(r=!0),o.style.position="absolute",s&&(o.style.left=0,o.style.right=0),r&&(o.style.top=0,o.style.bottom=0)},fakeEvent:function(o,n,e,r){var s=e||{},l=zp[n];if(!l)throw new Error("Event type "+n+" not supported.");var h=document.createEvent(l);switch(l){case"MouseEvents":var p=s.x||s.clientX||0,x=s.y||s.clientY||0;h.initMouseEvent(n,s.bubbles||!1,s.cancelable||!0,window,s.clickCount||1,0,0,p,x,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var b=h.initKeyboardEvent||h.initKeyEvent;Oe.defaults(s,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),b(n,s.bubbles||!1,s.cancelable,window,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.keyCode,s.charCode);break;default:h.initEvent(n,s.bubbles||!1,s.cancelable||!0)}Oe.defaults(h,r),o.dispatchEvent(h)},bind:function(o,n,e,r){var s=r||!1;return o.addEventListener?o.addEventListener(n,e,s):o.attachEvent&&o.attachEvent("on"+n,e),Qt},unbind:function(o,n,e,r){var s=r||!1;return o.removeEventListener?o.removeEventListener(n,e,s):o.detachEvent&&o.detachEvent("on"+n,e),Qt},addClass:function(o,n){if(o.className===void 0)o.className=n;else if(o.className!==n){var e=o.className.split(/ +/);e.indexOf(n)===-1&&(e.push(n),o.className=e.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return Qt},removeClass:function(o,n){if(n)if(o.className===n)o.removeAttribute("class");else{var e=o.className.split(/ +/),r=e.indexOf(n);r!==-1&&(e.splice(r,1),o.className=e.join(" "))}else o.className=void 0;return Qt},hasClass:function(o,n){return new RegExp("(?:^|\\s+)"+n+"(?:\\s+|$)").test(o.className)||!1},getWidth:function(o){var n=getComputedStyle(o);return es(n["border-left-width"])+es(n["border-right-width"])+es(n["padding-left"])+es(n["padding-right"])+es(n.width)},getHeight:function(o){var n=getComputedStyle(o);return es(n["border-top-width"])+es(n["border-bottom-width"])+es(n["padding-top"])+es(n["padding-bottom"])+es(n.height)},getOffset:function(o){var n=o,e={left:0,top:0};if(n.offsetParent)do e.left+=n.offsetLeft,e.top+=n.offsetTop,n=n.offsetParent;while(n);return e},isActive:function(o){return o===document.activeElement&&(o.type||o.href)}},pm=function(o){function n(e,r){$a(this,n);var s=ll(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),l=s;return s.__prev=s.getValue(),s.__checkbox=document.createElement("input"),s.__checkbox.setAttribute("type","checkbox"),Qt.bind(s.__checkbox,"change",function(){l.setValue(!l.__prev)},!1),s.domElement.appendChild(s.__checkbox),s.updateDisplay(),s}return ul(n,o),Bs(n,[{key:"setValue",value:function(e){var r=bu(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),bu(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"updateDisplay",this).call(this)}}]),n}(Kh),Qh=function(o){function n(e,r,s){$a(this,n);var l=ll(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),h=s,p=l;if(l.__select=document.createElement("select"),Oe.isArray(h)){var x={};Oe.each(h,function(b){x[b]=b}),h=x}return Oe.each(h,function(b,w){var R=document.createElement("option");R.innerHTML=w,R.setAttribute("value",b),p.__select.appendChild(R)}),l.updateDisplay(),Qt.bind(l.__select,"change",function(){var b=this.options[this.selectedIndex].value;p.setValue(b)}),l.domElement.appendChild(l.__select),l}return ul(n,o),Bs(n,[{key:"setValue",value:function(e){var r=bu(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return Qt.isActive(this.__select)?this:(this.__select.value=this.getValue(),bu(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"updateDisplay",this).call(this))}}]),n}(Kh),Lm=function(o){function n(e,r){$a(this,n);var s=ll(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),l=s;function h(){l.setValue(l.__input.value)}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),Qt.bind(s.__input,"keyup",h),Qt.bind(s.__input,"change",h),Qt.bind(s.__input,"blur",function(){l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}),Qt.bind(s.__input,"keydown",function(p){p.keyCode===13&&this.blur()}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return ul(n,o),Bs(n,[{key:"updateDisplay",value:function(){return Qt.isActive(this.__input)||(this.__input.value=this.getValue()),bu(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"updateDisplay",this).call(this)}}]),n}(Kh);function ip(o){var n=o.toString();return n.indexOf(".")>-1?n.length-n.indexOf(".")-1:0}var ih=function(o){function n(e,r,s){$a(this,n);var l=ll(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),h=s||{};return l.__min=h.min,l.__max=h.max,l.__step=h.step,Oe.isUndefined(l.__step)?l.initialValue===0?l.__impliedStep=1:l.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(l.initialValue))/Math.LN10))/10:l.__impliedStep=l.__step,l.__precision=ip(l.__impliedStep),l}return ul(n,o),Bs(n,[{key:"setValue",value:function(e){var r=e;return this.__min!==void 0&&r<this.__min?r=this.__min:this.__max!==void 0&&r>this.__max&&(r=this.__max),this.__step!==void 0&&r%this.__step!=0&&(r=Math.round(r/this.__step)*this.__step),bu(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=ip(e),this}}]),n}(Kh),hf=function(o){function n(e,r,s){$a(this,n);var l=ll(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r,s));l.__truncationSuspended=!1;var h=l,p=void 0;function x(){h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function b(R){var H=p-R.clientY;h.setValue(h.getValue()+H*h.__impliedStep),p=R.clientY}function w(){Qt.unbind(window,"mousemove",b),Qt.unbind(window,"mouseup",w),x()}return l.__input=document.createElement("input"),l.__input.setAttribute("type","text"),Qt.bind(l.__input,"change",function(){var R=parseFloat(h.__input.value);Oe.isNaN(R)||h.setValue(R)}),Qt.bind(l.__input,"blur",function(){x()}),Qt.bind(l.__input,"mousedown",function(R){Qt.bind(window,"mousemove",b),Qt.bind(window,"mouseup",w),p=R.clientY}),Qt.bind(l.__input,"keydown",function(R){R.keyCode===13&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1,x())}),l.updateDisplay(),l.domElement.appendChild(l.__input),l}return ul(n,o),Bs(n,[{key:"updateDisplay",value:function(){var e,r,s;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),r=this.__precision,s=Math.pow(10,r),Math.round(e*s)/s),bu(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"updateDisplay",this).call(this)}}]),n}(ih);function mm(o,n,e,r,s){return r+(o-n)/(e-n)*(s-r)}var hl=function(o){function n(e,r,s,l,h){$a(this,n);var p=ll(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r,{min:s,max:l,step:h})),x=p;function b(z){z.preventDefault();var q=x.__background.getBoundingClientRect();return x.setValue(mm(z.clientX,q.left,q.right,x.__min,x.__max)),!1}function w(){Qt.unbind(window,"mousemove",b),Qt.unbind(window,"mouseup",w),x.__onFinishChange&&x.__onFinishChange.call(x,x.getValue())}function R(z){var q=z.touches[0].clientX,at=x.__background.getBoundingClientRect();x.setValue(mm(q,at.left,at.right,x.__min,x.__max))}function H(){Qt.unbind(window,"touchmove",R),Qt.unbind(window,"touchend",H),x.__onFinishChange&&x.__onFinishChange.call(x,x.getValue())}return p.__background=document.createElement("div"),p.__foreground=document.createElement("div"),Qt.bind(p.__background,"mousedown",function(z){document.activeElement.blur(),Qt.bind(window,"mousemove",b),Qt.bind(window,"mouseup",w),b(z)}),Qt.bind(p.__background,"touchstart",function(z){z.touches.length===1&&(Qt.bind(window,"touchmove",R),Qt.bind(window,"touchend",H),R(z))}),Qt.addClass(p.__background,"slider"),Qt.addClass(p.__foreground,"slider-fg"),p.updateDisplay(),p.__background.appendChild(p.__foreground),p.domElement.appendChild(p.__background),p}return ul(n,o),Bs(n,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",bu(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"updateDisplay",this).call(this)}}]),n}(ih),gm=function(o){function n(e,r,s){$a(this,n);var l=ll(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),h=l;return l.__button=document.createElement("div"),l.__button.innerHTML=s===void 0?"Fire":s,Qt.bind(l.__button,"click",function(p){return p.preventDefault(),h.fire(),!1}),Qt.addClass(l.__button,"button"),l.domElement.appendChild(l.__button),l}return ul(n,o),Bs(n,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),n}(Kh),op=function(o){function n(e,r){$a(this,n);var s=ll(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r));s.__color=new _o(s.getValue()),s.__temp=new _o(0);var l=s;s.domElement=document.createElement("div"),Qt.makeSelectable(s.domElement,!1),s.__selector=document.createElement("div"),s.__selector.className="selector",s.__saturation_field=document.createElement("div"),s.__saturation_field.className="saturation-field",s.__field_knob=document.createElement("div"),s.__field_knob.className="field-knob",s.__field_knob_border="2px solid ",s.__hue_knob=document.createElement("div"),s.__hue_knob.className="hue-knob",s.__hue_field=document.createElement("div"),s.__hue_field.className="hue-field",s.__input=document.createElement("input"),s.__input.type="text",s.__input_textShadow="0 1px 1px ",Qt.bind(s.__input,"keydown",function(_t){_t.keyCode===13&&H.call(this)}),Qt.bind(s.__input,"blur",H),Qt.bind(s.__selector,"mousedown",function(){Qt.addClass(this,"drag").bind(window,"mouseup",function(){Qt.removeClass(l.__selector,"drag")})}),Qt.bind(s.__selector,"touchstart",function(){Qt.addClass(this,"drag").bind(window,"touchend",function(){Qt.removeClass(l.__selector,"drag")})});var h,p=document.createElement("div");function x(_t){q(_t),Qt.bind(window,"mousemove",q),Qt.bind(window,"touchmove",q),Qt.bind(window,"mouseup",w),Qt.bind(window,"touchend",w)}function b(_t){at(_t),Qt.bind(window,"mousemove",at),Qt.bind(window,"touchmove",at),Qt.bind(window,"mouseup",R),Qt.bind(window,"touchend",R)}function w(){Qt.unbind(window,"mousemove",q),Qt.unbind(window,"touchmove",q),Qt.unbind(window,"mouseup",w),Qt.unbind(window,"touchend",w),z()}function R(){Qt.unbind(window,"mousemove",at),Qt.unbind(window,"touchmove",at),Qt.unbind(window,"mouseup",R),Qt.unbind(window,"touchend",R),z()}function H(){var _t=ep(this.value);_t!==!1?(l.__color.__state=_t,l.setValue(l.__color.toOriginal())):this.value=l.__color.toString()}function z(){l.__onFinishChange&&l.__onFinishChange.call(l,l.__color.toOriginal())}function q(_t){_t.type.indexOf("touch")===-1&&_t.preventDefault();var bt=l.__saturation_field.getBoundingClientRect(),zt=_t.touches&&_t.touches[0]||_t,De=zt.clientX,an=zt.clientY,Dt=(De-bt.left)/(bt.right-bt.left),ue=1-(an-bt.top)/(bt.bottom-bt.top);return ue>1?ue=1:ue<0&&(ue=0),Dt>1?Dt=1:Dt<0&&(Dt=0),l.__color.v=ue,l.__color.s=Dt,l.setValue(l.__color.toOriginal()),!1}function at(_t){_t.type.indexOf("touch")===-1&&_t.preventDefault();var bt=l.__hue_field.getBoundingClientRect(),zt=1-((_t.touches&&_t.touches[0]||_t).clientY-bt.top)/(bt.bottom-bt.top);return zt>1?zt=1:zt<0&&(zt=0),l.__color.h=360*zt,l.setValue(l.__color.toOriginal()),!1}return Oe.extend(s.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Oe.extend(s.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:s.__field_knob_border+(s.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Oe.extend(s.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Oe.extend(s.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Oe.extend(p.style,{width:"100%",height:"100%",background:"none"}),_m(p,"top","rgba(0,0,0,0)","#000"),Oe.extend(s.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(h=s.__hue_field).style.background="",h.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",h.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",h.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",h.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",h.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Oe.extend(s.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:s.__input_textShadow+"rgba(0,0,0,0.7)"}),Qt.bind(s.__saturation_field,"mousedown",x),Qt.bind(s.__saturation_field,"touchstart",x),Qt.bind(s.__field_knob,"mousedown",x),Qt.bind(s.__field_knob,"touchstart",x),Qt.bind(s.__hue_field,"mousedown",b),Qt.bind(s.__hue_field,"touchstart",b),s.__saturation_field.appendChild(p),s.__selector.appendChild(s.__field_knob),s.__selector.appendChild(s.__saturation_field),s.__selector.appendChild(s.__hue_field),s.__hue_field.appendChild(s.__hue_knob),s.domElement.appendChild(s.__input),s.domElement.appendChild(s.__selector),s.updateDisplay(),s}return ul(n,o),Bs(n,[{key:"updateDisplay",value:function(){var e=ep(this.getValue());if(e!==!1){var r=!1;Oe.each(_o.COMPONENTS,function(h){if(!Oe.isUndefined(e[h])&&!Oe.isUndefined(this.__color.__state[h])&&e[h]!==this.__color.__state[h])return r=!0,{}},this),r&&Oe.extend(this.__color.__state,e)}Oe.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,l=255-s;Oe.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,_m(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Oe.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+l+","+l+","+l+",.7)"})}}]),n}(Kh),vm=["-moz-","-o-","-webkit-","-ms-",""];function _m(o,n,e,r){o.style.background="",Oe.each(vm,function(s){o.style.cssText+="background: "+s+"linear-gradient("+n+", "+e+" 0%, "+r+" 100%); "})}var Om=function(o,n){var e=n||document,r=document.createElement("style");r.type="text/css",r.innerHTML=o;var s=e.getElementsByTagName("head")[0];try{s.appendChild(r)}catch{}},Dm=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,Nm=function(o,n){var e=o[n];return Oe.isArray(arguments[2])||Oe.isObject(arguments[2])?new Qh(o,n,arguments[2]):Oe.isNumber(e)?Oe.isNumber(arguments[2])&&Oe.isNumber(arguments[3])?Oe.isNumber(arguments[4])?new hl(o,n,arguments[2],arguments[3],arguments[4]):new hl(o,n,arguments[2],arguments[3]):Oe.isNumber(arguments[4])?new hf(o,n,{min:arguments[2],max:arguments[3],step:arguments[4]}):new hf(o,n,{min:arguments[2],max:arguments[3]}):Oe.isString(e)?new Lm(o,n):Oe.isFunction(e)?new gm(o,n,""):Oe.isBoolean(e)?new pm(o,n):null},Fm=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(o){setTimeout(o,1e3/60)},Bm=function(){function o(){$a(this,o),this.backgroundElement=document.createElement("div"),Oe.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),Qt.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Oe.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;Qt.bind(this.backgroundElement,"click",function(){n.hide()})}return Bs(o,[{key:"show",value:function(){var n=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Oe.defer(function(){n.backgroundElement.style.opacity=1,n.domElement.style.opacity=1,n.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var n=this,e=function r(){n.domElement.style.display="none",n.backgroundElement.style.display="none",Qt.unbind(n.domElement,"webkitTransitionEnd",r),Qt.unbind(n.domElement,"transitionend",r),Qt.unbind(n.domElement,"oTransitionEnd",r)};Qt.bind(this.domElement,"webkitTransitionEnd",e),Qt.bind(this.domElement,"transitionend",e),Qt.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-Qt.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-Qt.getHeight(this.domElement)/2+"px"}}]),o}();Om(function(o){if(o&&typeof window!="undefined"){var n=document.createElement("style");return n.setAttribute("type","text/css"),n.innerHTML=o,document.head.appendChild(n),o}}(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`));var cf=function(){try{return!!window.localStorage}catch{return!1}}(),sp=void 0,kr=!0,tc=void 0,jp=!1,Vp=[],ti=function o(n){var e=this,r=n||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Qt.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=Oe.defaults(r,{closeOnTop:!1,autoPlace:!0,width:o.DEFAULT_WIDTH}),r=Oe.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),Oe.isUndefined(r.load)?r.load={preset:"Default"}:r.preset&&(r.load.preset=r.preset),Oe.isUndefined(r.parent)&&r.hideable&&Vp.push(this),r.resizable=Oe.isUndefined(r.parent)&&r.resizable,r.autoPlace&&Oe.isUndefined(r.scrollable)&&(r.scrollable=!0);var s,l=cf&&localStorage.getItem(ad(this,"isLocal"))==="true",h=void 0,p=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return e.parent?e.getRoot().preset:r.load.preset},set:function(w){e.parent?e.getRoot().preset=w:r.load.preset=w,function(R){for(var H=0;H<R.__preset_select.length;H++)R.__preset_select[H].value===R.preset&&(R.__preset_select.selectedIndex=H)}(this),e.revert()}},width:{get:function(){return r.width},set:function(w){r.width=w,ld(e,w)}},name:{get:function(){return r.name},set:function(w){r.name=w,p&&(p.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(w){r.closed=w,r.closed?Qt.addClass(e.__ul,o.CLASS_CLOSED):Qt.removeClass(e.__ul,o.CLASS_CLOSED),this.onResize(),e.__closeButton&&(e.__closeButton.innerHTML=w?o.TEXT_OPEN:o.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return l},set:function(w){cf&&(l=w,w?Qt.bind(window,"unload",h):Qt.unbind(window,"unload",h),localStorage.setItem(ad(e,"isLocal"),w))}}}),Oe.isUndefined(r.parent)){if(this.closed=r.closed||!1,Qt.addClass(this.domElement,o.CLASS_MAIN),Qt.makeSelectable(this.domElement,!1),cf&&l){e.useLocalStorage=!0;var x=localStorage.getItem(ad(this,"gui"));x&&(r.load=JSON.parse(x))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=o.TEXT_CLOSED,Qt.addClass(this.__closeButton,o.CLASS_CLOSE_BUTTON),r.closeOnTop?(Qt.addClass(this.__closeButton,o.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(Qt.addClass(this.__closeButton,o.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),Qt.bind(this.__closeButton,"click",function(){e.closed=!e.closed})}else{r.closed===void 0&&(r.closed=!0);var b=document.createTextNode(r.name);Qt.addClass(b,"controller-name"),p=ap(e,b),Qt.addClass(this.__ul,o.CLASS_CLOSED),Qt.addClass(p,"title"),Qt.bind(p,"click",function(w){return w.preventDefault(),e.closed=!e.closed,!1}),r.closed||(this.closed=!1)}r.autoPlace&&(Oe.isUndefined(r.parent)&&(kr&&(tc=document.createElement("div"),Qt.addClass(tc,"dg"),Qt.addClass(tc,o.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(tc),kr=!1),tc.appendChild(this.domElement),Qt.addClass(this.domElement,o.CLASS_AUTO_PLACE)),this.parent||ld(e,r.width)),this.__resizeHandler=function(){e.onResizeDebounced()},Qt.bind(window,"resize",this.__resizeHandler),Qt.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Qt.bind(this.__ul,"transitionend",this.__resizeHandler),Qt.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&ym(this),h=function(){cf&&localStorage.getItem(ad(e,"isLocal"))==="true"&&localStorage.setItem(ad(e,"gui"),JSON.stringify(e.getSaveObject()))},this.saveToLocalStorageIfPossible=h,r.parent||((s=e.getRoot()).width+=1,Oe.defer(function(){s.width-=1}))};function ap(o,n,e){var r=document.createElement("li");return n&&r.appendChild(n),e?o.__ul.insertBefore(r,e):o.__ul.appendChild(r),o.onResize(),r}function Wp(o){Qt.unbind(window,"resize",o.__resizeHandler),o.saveToLocalStorageIfPossible&&Qt.unbind(window,"unload",o.saveToLocalStorageIfPossible)}function Xp(o,n){var e=o.__preset_select[o.__preset_select.selectedIndex];e.innerHTML=n?e.value+"*":e.value}function qp(o,n){var e=o.getRoot(),r=e.__rememberedObjects.indexOf(n.object);if(r!==-1){var s=e.__rememberedObjectIndecesToControllers[r];if(s===void 0&&(s={},e.__rememberedObjectIndecesToControllers[r]=s),s[n.property]=n,e.load&&e.load.remembered){var l=e.load.remembered,h=void 0;if(l[o.preset])h=l[o.preset];else{if(!l.Default)return;h=l.Default}if(h[r]&&h[r][n.property]!==void 0){var p=h[r][n.property];n.initialValue=p,n.setValue(p)}}}}function ec(o,n,e,r){if(n[e]===void 0)throw new Error('Object "'+n+'" has no property "'+e+'"');var s=void 0;if(r.color)s=new op(n,e);else{var l=[n,e].concat(r.factoryArgs);s=Nm.apply(o,l)}r.before instanceof Kh&&(r.before=r.before.__li),qp(o,s),Qt.addClass(s.domElement,"c");var h=document.createElement("span");Qt.addClass(h,"property-name"),h.innerHTML=s.property;var p=document.createElement("div");p.appendChild(h),p.appendChild(s.domElement);var x=ap(o,p,r.before);return Qt.addClass(x,ti.CLASS_CONTROLLER_ROW),s instanceof op?Qt.addClass(x,"color"):Qt.addClass(x,Im(s.getValue())),function(b,w,R){if(R.__li=w,R.__gui=b,Oe.extend(R,{options:function(q){if(arguments.length>1){var at=R.__li.nextElementSibling;return R.remove(),ec(b,R.object,R.property,{before:at,factoryArgs:[Oe.toArray(arguments)]})}if(Oe.isArray(q)||Oe.isObject(q)){var _t=R.__li.nextElementSibling;return R.remove(),ec(b,R.object,R.property,{before:_t,factoryArgs:[q]})}},name:function(q){return R.__li.firstElementChild.firstElementChild.innerHTML=q,R},listen:function(){return R.__gui.listen(R),R},remove:function(){return R.__gui.remove(R),R}}),R instanceof hl){var H=new hf(R.object,R.property,{min:R.__min,max:R.__max,step:R.__step});Oe.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(q){var at=R[q],_t=H[q];R[q]=H[q]=function(){var bt=Array.prototype.slice.call(arguments);return _t.apply(H,bt),at.apply(R,bt)}}),Qt.addClass(w,"has-slider"),R.domElement.insertBefore(H.domElement,R.domElement.firstElementChild)}else if(R instanceof hf){var z=function(q){if(Oe.isNumber(R.__min)&&Oe.isNumber(R.__max)){var at=R.__li.firstElementChild.firstElementChild.innerHTML,_t=R.__gui.__listening.indexOf(R)>-1;R.remove();var bt=ec(b,R.object,R.property,{before:R.__li.nextElementSibling,factoryArgs:[R.__min,R.__max,R.__step]});return bt.name(at),_t&&bt.listen(),bt}return q};R.min=Oe.compose(z,R.min),R.max=Oe.compose(z,R.max)}else R instanceof pm?(Qt.bind(w,"click",function(){Qt.fakeEvent(R.__checkbox,"click")}),Qt.bind(R.__checkbox,"click",function(q){q.stopPropagation()})):R instanceof gm?(Qt.bind(w,"click",function(){Qt.fakeEvent(R.__button,"click")}),Qt.bind(w,"mouseover",function(){Qt.addClass(R.__button,"hover")}),Qt.bind(w,"mouseout",function(){Qt.removeClass(R.__button,"hover")})):R instanceof op&&(Qt.addClass(w,"color"),R.updateDisplay=Oe.compose(function(q){return w.style.borderLeftColor=R.__color.toString(),q},R.updateDisplay),R.updateDisplay());R.setValue=Oe.compose(function(q){return b.getRoot().__preset_select&&R.isModified()&&Xp(b.getRoot(),!0),q},R.setValue)}(o,x,s),o.__controllers.push(s),s}function ad(o,n){return document.location.href+"."+n}function Yp(o,n,e){var r=document.createElement("option");r.innerHTML=n,r.value=n,o.__preset_select.appendChild(r),e&&(o.__preset_select.selectedIndex=o.__preset_select.length-1)}function Zp(o,n){n.style.display=o.useLocalStorage?"block":"none"}function ud(o){var n=o.__save_row=document.createElement("li");Qt.addClass(o.domElement,"has-save"),o.__ul.insertBefore(n,o.__ul.firstChild),Qt.addClass(n,"save-row");var e=document.createElement("span");e.innerHTML="&nbsp;",Qt.addClass(e,"button gears");var r=document.createElement("span");r.innerHTML="Save",Qt.addClass(r,"button"),Qt.addClass(r,"save");var s=document.createElement("span");s.innerHTML="New",Qt.addClass(s,"button"),Qt.addClass(s,"save-as");var l=document.createElement("span");l.innerHTML="Revert",Qt.addClass(l,"button"),Qt.addClass(l,"revert");var h=o.__preset_select=document.createElement("select");if(o.load&&o.load.remembered?Oe.each(o.load.remembered,function(w,R){Yp(o,R,R===o.preset)}):Yp(o,"Default",!1),Qt.bind(h,"change",function(){for(var w=0;w<o.__preset_select.length;w++)o.__preset_select[w].innerHTML=o.__preset_select[w].value;o.preset=this.value}),n.appendChild(h),n.appendChild(e),n.appendChild(r),n.appendChild(s),n.appendChild(l),cf){var p=document.getElementById("dg-local-explain"),x=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block",localStorage.getItem(ad(0,"isLocal"))==="true"&&x.setAttribute("checked","checked"),Zp(o,p),Qt.bind(x,"change",function(){o.useLocalStorage=!o.useLocalStorage,Zp(o,p)})}var b=document.getElementById("dg-new-constructor");Qt.bind(b,"keydown",function(w){!w.metaKey||w.which!==67&&w.keyCode!==67||sp.hide()}),Qt.bind(e,"click",function(){b.innerHTML=JSON.stringify(o.getSaveObject(),void 0,2),sp.show(),b.focus(),b.select()}),Qt.bind(r,"click",function(){o.save()}),Qt.bind(s,"click",function(){var w=prompt("Enter a new preset name.");w&&o.saveAs(w)}),Qt.bind(l,"click",function(){o.revert()})}function ym(o){var n=void 0;function e(l){return l.preventDefault(),o.width+=n-l.clientX,o.onResize(),n=l.clientX,!1}function r(){Qt.removeClass(o.__closeButton,ti.CLASS_DRAG),Qt.unbind(window,"mousemove",e),Qt.unbind(window,"mouseup",r)}function s(l){return l.preventDefault(),n=l.clientX,Qt.addClass(o.__closeButton,ti.CLASS_DRAG),Qt.bind(window,"mousemove",e),Qt.bind(window,"mouseup",r),!1}o.__resize_handle=document.createElement("div"),Oe.extend(o.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),Qt.bind(o.__resize_handle,"mousedown",s),Qt.bind(o.__closeButton,"mousedown",s),o.domElement.insertBefore(o.__resize_handle,o.domElement.firstElementChild)}function ld(o,n){o.domElement.style.width=n+"px",o.__save_row&&o.autoPlace&&(o.__save_row.style.width=n+"px"),o.__closeButton&&(o.__closeButton.style.width=n+"px")}function df(o,n){var e={};return Oe.each(o.__rememberedObjects,function(r,s){var l={},h=o.__rememberedObjectIndecesToControllers[s];Oe.each(h,function(p,x){l[x]=n?p.initialValue:p.getValue()}),e[s]=l}),e}ti.toggleHide=function(){jp=!jp,Oe.each(Vp,function(o){o.domElement.style.display=jp?"none":""})},ti.CLASS_AUTO_PLACE="a",ti.CLASS_AUTO_PLACE_CONTAINER="ac",ti.CLASS_MAIN="main",ti.CLASS_CONTROLLER_ROW="cr",ti.CLASS_TOO_TALL="taller-than-window",ti.CLASS_CLOSED="closed",ti.CLASS_CLOSE_BUTTON="close-button",ti.CLASS_CLOSE_TOP="close-top",ti.CLASS_CLOSE_BOTTOM="close-bottom",ti.CLASS_DRAG="drag",ti.DEFAULT_WIDTH=245,ti.TEXT_CLOSED="Close Controls",ti.TEXT_OPEN="Open Controls",ti._keydownHandler=function(o){document.activeElement.type==="text"||o.which!==72&&o.keyCode!==72||ti.toggleHide()},Qt.bind(window,"keydown",ti._keydownHandler,!1),Oe.extend(ti.prototype,{add:function(o,n){return ec(this,o,n,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(o,n){return ec(this,o,n,{color:!0})},remove:function(o){this.__ul.removeChild(o.__li),this.__controllers.splice(this.__controllers.indexOf(o),1);var n=this;Oe.defer(function(){n.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&tc.removeChild(this.domElement);var o=this;Oe.each(this.__folders,function(n){o.removeFolder(n)}),Qt.unbind(window,"keydown",ti._keydownHandler,!1),Wp(this)},addFolder:function(o){if(this.__folders[o]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+o+'"');var n={name:o,parent:this};n.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[o]&&(n.closed=this.load.folders[o].closed,n.load=this.load.folders[o]);var e=new ti(n);this.__folders[o]=e;var r=ap(this,e.domElement);return Qt.addClass(r,"folder"),e},removeFolder:function(o){this.__ul.removeChild(o.domElement.parentElement),delete this.__folders[o.name],this.load&&this.load.folders&&this.load.folders[o.name]&&delete this.load.folders[o.name],Wp(o);var n=this;Oe.each(o.__folders,function(e){o.removeFolder(e)}),Oe.defer(function(){n.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var o=this.getRoot();if(o.scrollable){var n=Qt.getOffset(o.__ul).top,e=0;Oe.each(o.__ul.childNodes,function(r){o.autoPlace&&r===o.__save_row||(e+=Qt.getHeight(r))}),window.innerHeight-n-20<e?(Qt.addClass(o.domElement,ti.CLASS_TOO_TALL),o.__ul.style.height=window.innerHeight-n-20+"px"):(Qt.removeClass(o.domElement,ti.CLASS_TOO_TALL),o.__ul.style.height="auto")}o.__resize_handle&&Oe.defer(function(){o.__resize_handle.style.height=o.__ul.offsetHeight+"px"}),o.__closeButton&&(o.__closeButton.style.width=o.width+"px")},onResizeDebounced:Oe.debounce(function(){this.onResize()},50),remember:function(){if(Oe.isUndefined(sp)&&((sp=new Bm).domElement.innerHTML=Dm),this.parent)throw new Error("You can only call remember on a top level GUI.");var o=this;Oe.each(Array.prototype.slice.call(arguments),function(n){o.__rememberedObjects.length===0&&ud(o),o.__rememberedObjects.indexOf(n)===-1&&o.__rememberedObjects.push(n)}),this.autoPlace&&ld(this,this.width)},getRoot:function(){for(var o=this;o.parent;)o=o.parent;return o},getSaveObject:function(){var o=this.load;return o.closed=this.closed,this.__rememberedObjects.length>0&&(o.preset=this.preset,o.remembered||(o.remembered={}),o.remembered[this.preset]=df(this)),o.folders={},Oe.each(this.__folders,function(n,e){o.folders[e]=n.getSaveObject()}),o},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=df(this),Xp(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(o){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=df(this,!0)),this.load.remembered[o]=df(this),this.preset=o,Yp(this,o,!0),this.saveToLocalStorageIfPossible()},revert:function(o){Oe.each(this.__controllers,function(n){this.getRoot().load.remembered?qp(o||this.getRoot(),n):n.setValue(n.initialValue),n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())},this),Oe.each(this.__folders,function(n){n.revert(n)}),o||Xp(this.getRoot(),!1)},listen:function(o){var n=this.__listening.length===0;this.__listening.push(o),n&&function e(r){r.length!==0&&Fm.call(window,function(){e(r)}),Oe.each(r,function(s){s.updateDisplay()})}(this.__listening)},updateDisplay:function(){Oe.each(this.__controllers,function(o){o.updateDisplay()}),Oe.each(this.__folders,function(o){o.updateDisplay()})}});var xm=ti,bm=function(){function o(n){this.runTime={fps:0,resolution:""},this.target=n.target,this.data=n.params,this.player=n.player,this.gui=this.createControllerGUI(),this.createStats(),this.addEventListener()}return o.prototype.createStats=function(){var n=this;setInterval(function(){n.controller.runTimeFps.setValue(n.player.runtime.fps),n.controller.runTimeResolution.setValue(n.player.view.width+"*"+n.player.view.height)},500)},o.prototype.createControllerGUI=function(){var n,e,r,s,l,h,p=new xm({autoPlace:!0,closed:!0});return p.domElement.style.opacity=".6",p.domElement.style.transformOrigin="100% 0",p.domElement.style.transform="scale(1.4)",this.target.appendChild(p.domElement),p.domElement.style.position="absolute",p.domElement.style.right="0",p.domElement.style.top="0",p.domElement.style.zIndex="2",this.controller={runTimeFps:p.add({FPS:0},"FPS",0),runTimeResolution:p.add({\u5206\u8FA8\u7387:""},"\u5206\u8FA8\u7387",""),autoFps:p.add({\u81EA\u52A8fps:(n=this.data.autoFPS)===null||n===void 0||n},"\u81EA\u52A8fps",!0),autoResolution:p.add({\u81EA\u52A8\u5206\u8FA8\u7387:(e=this.data.autoResolution)!==null&&e!==void 0&&e},"\u81EA\u52A8\u5206\u8FA8\u7387",!0),moreCalculation:p.add({\u989D\u5916\u8BA1\u7B97:0},"\u989D\u5916\u8BA1\u7B97",0,100),minFPS:p.add({\u6700\u4F4Efps:(r=this.data.minFPS)!==null&&r!==void 0?r:40},"\u6700\u4F4Efps",0,60),maxFPS:p.add({\u6700\u9AD8fps:(s=this.data.maxFPS)!==null&&s!==void 0?s:50},"\u6700\u9AD8fps",0,60),resolution:p.add({\u76EE\u6807\u5206\u8FA8\u500D\u7387:(l=this.data.resolution)!==null&&l!==void 0?l:window.devicePixelRatio},"\u76EE\u6807\u5206\u8FA8\u500D\u7387",.5,4),minResolution:p.add({\u6700\u5C0F\u5206\u8FA8\u500D\u7387:(h=this.data.minResolution)!==null&&h!==void 0?h:1},"\u6700\u5C0F\u5206\u8FA8\u500D\u7387",.5,4)},this.controller.runTimeFps.disabled=!0,this.controller.runTimeResolution.disabled=!0,p},o.prototype.addEventListener=function(){var n,e=this;this.controller.autoFps.onChange(function(r){e.data.autoFPS=r,e.player.updateConfig(e.data)}),this.controller.maxFPS.onChange(function(r){e.data.maxFPS=r,e.player.updateConfig(e.data)}),this.controller.minFPS.onChange(function(r){e.data.minFPS=r,e.player.updateConfig(e.data)}),this.controller.autoResolution.onChange(function(r){e.data.autoResolution=r,e.player.updateConfig(e.data)}),this.controller.minResolution.onChange(function(r){e.data.minResolution=r,e.player.updateConfig(e.data)}),this.controller.resolution.onChange(function(r){e.data.resolution=r,e.player.updateConfig(e.data)}),this.controller.moreCalculation.onChange(function(r){n&&e.player.app.ticker.remove(n),r>0&&(n=function(){for(var s="";s.length<r;)s+=Math.random().toString(32).substr(2);nl()(s)},e.player.app.ticker.add(n))})},o}(),Um=function(){var o=function(n,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(r[l]=s[l])})(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}o(n,e),n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ka=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function p(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,p)}x((r=r.apply(o,n||[])).next())})},nc=function(o,n){var e,r,s,l,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(x){return function(b){return function(w){if(e)throw new TypeError("Generator is already executing.");for(;h;)try{if(e=1,r&&(s=2&w[0]?r.return:w[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,w[1])).done)return s;switch(r=0,s&&(w=[2&w[0],s.value]),w[0]){case 0:case 1:s=w;break;case 4:return h.label++,{value:w[1],done:!1};case 5:h.label++,r=w[1],w=[0];continue;case 7:w=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!((s=s.length>0&&s[s.length-1])||w[0]!==6&&w[0]!==2)){h=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){h.label=w[1];break}if(w[0]===6&&h.label<s[1]){h.label=s[1],s=w;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(w);break}s[2]&&h.ops.pop(),h.trys.pop();continue}w=n.call(o,h)}catch(R){w=[6,R],r=0}finally{e=s=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([x,b])}}};window.__slide_local_logger__||(window.__slide_local_logger__=dt.createInstance({name:"_slide_local_log_",driver:dt.INDEXEDDB,version:1}));var cl=window.__slide_local_logger__,wm=window.ResizeObserver||cm,ya={syncDispatch:"syncDispatch",syncReceive:"syncReceive",renderStart:"renderStart",renderEnd:"renderEnd",renderError:"renderError",slideChange:"slideChange",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",animateStart:"animateStart",animateEnd:"animateEnd",stateChange:"stateChange"},km=function(o){function n(e){var r=o.call(this)||this;return r.__slideState={taskId:"",url:"",currentSlideIndex:-1,mainSeqStep:-1,mainSeqState:null,appliedInteractiveSeqIds:[],mediaState:Object.create(null)},r.resize=!1,r.isAnimating=!1,r.renderingTaskManager=new Gp,r.isLoading=!1,r.interactive=!0,r.frameWidth=1,r.frameHeight=1,r.frame=document.createElement("div"),r.medianController=document.createElement("div"),r.frameResizeObserver=new wm(function(s){return r.frameResizeHandler(s)}),r.timestamp=function(){return Date.now()},r.mode="local",r.log="",r.logId="",r.lastEmitedState=null,r.persistLog=function(){return Ka(r,void 0,void 0,function(){var s,l;return nc(this,function(h){switch(h.label){case 0:if(!cl||!this.logId)return[3,5];h.label=1;case 1:return h.trys.push([1,4,,5]),s=this.log,[4,cl.getItem(this.logId)];case 2:return l=h.sent()||"",[4,cl.setItem(this.logId,l+s)];case 3:return h.sent(),this.log="",[3,5];case 4:return h.sent(),[3,5];case 5:return[2]}})})},r.handleSlideStateLog=function(){console.log(r.logId),console.log(JSON.stringify(r.slideState,null,2))},r.handleLogDownload=function(){return Ka(r,void 0,void 0,function(){var s,l,h;return nc(this,function(p){switch(p.label){case 0:return s="",cl?(l=s,[4,cl.getItem(this.logId)]):[3,2];case 1:s=l+(p.sent()||""),p.label=2;case 2:return s+=this.log,(h=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(s)),h.setAttribute("download",this.logId),h.style.display="none",document.body.appendChild(h),h.click(),document.body.removeChild(h),[2]}})})},e.timestamp&&(r.timestamp=e.timestamp),r.mode=e.mode,r.anchor=e.anchor,r.resize=e.resize||!1,r.interactive=e.interactive,r.player=new om(r.mode),r.player.setInteractive(r.interactive),r.player.updateConfig(e.renderOptions||{}),r.frame.style.cssText="width:100%;height:100%;display:flex;justify-content:center;align-items:center",r.frame.appendChild(r.player.view),r.setMedianControllerAttribute(),r.frame.appendChild(r.medianController),r.anchor.appendChild(r.frame),(e==null?void 0:e.controller)&&new bm({player:r.player,params:e.renderOptions||{},target:r.frame}),r.frameResizeObserver.observe(r.frame),r.player.on(wr.renderStart,function(s){r.isLoading=!0,r.emit(ya.renderStart,s)}),r.player.on(wr.renderEnd,function(s){r.isLoading=!1,r.emit(ya.renderEnd,s)}),r.player.on(wr.slideChange,function(s){r.__slideState.currentSlideIndex=s,r.emit(ya.slideChange,s)}),r.player.on(wr.mainSeqStateChange,function(s){r.__slideState.mainSeqState=s,r.emitStateChange()}),r.player.on(wr.mainSeqStepChange,function(s){r.__slideState.mainSeqStep=s,r.emitStateChange()}),r.player.on(wr.animateStart,function(){r.isAnimating!==!0&&(r.isAnimating=!0,r.emit(ya.animateStart))}),r.player.on(wr.animateEnd,function(){r.isAnimating!==!1&&(r.isAnimating=!1,r.emit(ya.animateEnd))}),r.player.on(wr.interactiveAnimTrigger,function(s){var l=s.action,h=s.seqId;r.__slideState.appliedInteractiveSeqIds.push(h),r.emitSyncDispatch({type:"interactiveAnim",action:l}),r.emitStateChange()}),r.player.on(wr.mainSeqStepStart,Object(ft.throttle)(function(s){r.emit(ya.mainSeqStepStart)},100)),r.player.on(wr.mainSeqStepEnd,Object(ft.throttle)(function(s){r.emit(ya.mainSeqStepEnd)},100)),r.player.on(wr.mediaPlay,function(s){var l={type:"play",time:r.timestamp()-1e3*s.time};r.__slideState.mediaState[s.id]=l,r.emitSyncDispatch({type:"mediaPlay",id:s.id,state:l}),r.emitStateChange()}),r.player.on(wr.mediaPause,function(s){var l={type:"pause",time:s.time};r.__slideState.mediaState[s.id]=l,r.emitSyncDispatch({type:"mediaPause",id:s.id,state:l}),r.emitStateChange()}),r.player.on(wr.mediaSeek,function(s){var l={type:"pause",time:0};s.isPlaying?(l.type="play",r.__slideState.mediaState[s.id]?l.time=r.__slideState.mediaState[s.id].time-1e3*s.time:l.time=r.timestamp()-1e3*s.time,r.__slideState.mediaState[s.id]=l):(l.type="pause",l.time=s.time,r.__slideState.mediaState[s.id]=l),r.emitSyncDispatch({type:"mediaSeek",id:s.id,time:s.time,state:l}),r.emitStateChange()}),r.on(ya.syncReceive,r.receiveSyncHandler),r.renderingTaskManager.eventHub.on("task-error",function(s){var l=s.error,h=s.task;r.emit(ya.renderError,{error:l,index:h.slideIndex})}),window.addEventListener("__slide_log__",r.handleLogDownload),window.addEventListener("__slide_state__",r.handleSlideStateLog),r.persistLogId=window.setInterval(r.persistLog,5e3),r}return Um(n,o),n.prototype.setMedianControllerAttribute=function(){this.medianController.id="median-container",this.medianController.style.position="absolute",this.medianController.style.left="0",this.medianController.style.top="0",this.medianController.style.zIndex="2"},n.prototype.frameResizeHandler=function(e){var r=e[0].contentRect,s=r.width,l=r.height;this.frameWidth=s,this.frameHeight=l,this.resizeView()},n.prototype.resizeView=function(){var e=this,r=this.width,s=this.height;if(r>0&&s>0){var l=this.frameWidth/r,h=l*s;if(h>this.frameHeight&&(l*=this.frameHeight/h),this.resize){var p=this.player.app;p.ticker.addOnce(function(){var x=l*(e.player.config.resolution||window.devicePixelRatio);p.renderer.resolution=x,p.renderer.plugins.interaction.resolution=p.renderer.resolution,p.renderer.resize(e.width,e.height)})}this.view.style.transform="scale("+l+")",this.medianController.style.transform="scale("+l+")",this.medianController.style.top=(this.frameHeight-s*l)/2+"px"}},n.prototype.receiveSyncHandler=function(e){var r=this;this.log+="=== sync receive ["+new Date().toISOString()+`] ===
`,this.log+=JSON.stringify(e,null,2),this.log+=`

`,e.type==="nextStep"?this.mainSeqStep===e.next-1||this.mainSeqStep+1===this.mainSeqLength?this.doNextStep():(this.setMainSeqStep(e.next,"start"),this.player.nextTick(function(){r.doNextStep()})):e.type==="prevStep"?this.mainSeqStep===0&&this.mainSeqState==="idle"||this.mainSeqStep===e.next+1||this.mainSeqStep+1===this.mainSeqLength?this.doPrevStep():(this.setMainSeqStep(e.next+1,"start"),this.player.nextTick(function(){r.doPrevStep()})):e.type==="interactiveAnim"?this.player.applyInteractiveAction(e.action):e.type==="renderSlide"?this.doRenderSlide(e.index):e.type==="mediaPlay"?(this.player.setMediaState(e.id,!0),this.__slideState.mediaState[e.id]=e.state):e.type==="mediaPause"?(this.player.setMediaState(e.id,!1),this.__slideState.mediaState[e.id]=e.state):e.type==="mediaSeek"&&(this.player.setMediaCurrentTime(e.id,e.time),this.__slideState.mediaState[e.id]=e.state)},n.prototype.setSlideState=function(e){return Ka(this,void 0,void 0,function(){var r,s=this;return nc(this,function(l){switch(l.label){case 0:return this.log+="=== stateChange receive ["+new Date().toISOString()+`] ===
`,this.log+=JSON.stringify(e,null,2),this.log+=`

`,e.taskId&&e.taskId!==this.__slideState.taskId&&(this.__slideState.taskId=e.taskId,this.player.setResourceData(e.taskId,this.__slideState.url)),e.url&&e.url!==this.__slideState.url&&(this.__slideState.url=e.url,this.player.setResourceData(this.__slideState.taskId,e.url)),Number.isInteger(e.currentSlideIndex)&&e.currentSlideIndex!==this.__slideState.currentSlideIndex?(this.__slideState.currentSlideIndex=e.currentSlideIndex,[4,this.doRenderSlide(e.currentSlideIndex)]):[3,2];case 1:l.sent(),l.label=2;case 2:return[4,Qf(function(){return s.player.currentIndex===e.currentSlideIndex&&s.player.currentStage},3e3)];case 3:return l.sent(),r=!1,Number.isInteger(e.mainSeqStep)&&e.mainSeqStep!==this.__slideState.mainSeqStep&&(r=!0,this.__slideState.mainSeqStep=e.mainSeqStep),e.mainSeqState&&e.mainSeqState!==this.__slideState.mainSeqState&&(r=!0,this.__slideState.mainSeqState=e.mainSeqState),r&&this.setMainSeqStep(this.__slideState.mainSeqStep,this.__slideState.mainSeqState==="idle"?"start":"end"),e.appliedInteractiveSeqIds&&e.appliedInteractiveSeqIds.length>0&&(this.__slideState.appliedInteractiveSeqIds=e.appliedInteractiveSeqIds,e.appliedInteractiveSeqIds.forEach(function(h){s.player.seekInteractiveSeqToEnd(h)})),e.mediaState&&(this.initMedia(e),this.__slideState.mediaState=e.mediaState),[2]}})})},n.prototype.initMedia=function(e){var r=this,s=function(p){var x=e.mediaState[p],b=l.__slideState.mediaState[p];if(b&&x.type===b.type&&x.time===b.time)return"continue";x.type==="play"?l.player.setMediaState(p,!0).then(function(){var w=r.timestamp();r.player.setMediaCurrentTime(p,(w-x.time)/1e3)}):l.player.setMediaState(p,!1).then(function(){r.player.setMediaCurrentTime(p,x.time)})},l=this;for(var h in e.mediaState)s(h)},Object.defineProperty(n.prototype,"slideCount",{get:function(){return this.player.slideCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"slideState",{get:function(){return this.__slideState.mainSeqState=this.mainSeqState,this.__slideState.mainSeqStep=this.mainSeqStep,JSON.parse(JSON.stringify(this.__slideState))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mainSeqLength",{get:function(){return this.player.mainSeqLength()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mainSeqStep",{get:function(){return this.player.mainSeqStep()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mainSeqState",{get:function(){return this.player.mainSeqState()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"renderOptions",{get:function(){return this.player.config},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"drawCall",{get:function(){return this.player.runtime.drawCall},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"renderFps",{get:function(){return this.player.runtime.fps},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"runtimeFps",{get:function(){return this.player.fps.value},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"view",{get:function(){return this.player.view},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.player.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.player.height},enumerable:!1,configurable:!0}),n.prototype.updateRenderOption=function(e){this.player.updateConfig(e)},n.prototype.setResource=function(e,r){this.player.setResourceData(e,r),this.__slideState.taskId=e,this.__slideState.url=r,this.emitSyncDispatch({type:"setResource",taskId:e,url:r}),this.logId=e+"-"+Math.random().toString(32).substr(2)},n.prototype._renderSlide=function(e){return Ka(this,void 0,void 0,function(){return nc(this,function(r){switch(r.label){case 0:return this.isLoading=!0,[4,this.player.renderSlide(e)];case 1:return r.sent(),this.__slideState.currentSlideIndex=e,this.isLoading=!1,this.resizeView(),this.emitStateChange(),[2]}})})},n.prototype.renderSlide=function(e){var r=Number(e);(r!==this.player.currentIndex||this.renderingTaskManager.hasStartTask())&&(r>this.slideCount&&this.slideCount>0||(this.mode==="interactive"?this.emitSyncDispatch({type:"renderSlide",index:r}):this.mode==="sync"?(this.doRenderSlide(r),this.emitSyncDispatch({type:"renderSlide",index:r})):this.doRenderSlide(r)))},n.prototype.doRenderSlide=function(e){var r=this;this.player.clearForward(),this.renderingTaskManager.addTask(function(){return r._renderSlide(e)},e)},n.prototype.nextStep=function(){this.isLoading||(this.mode==="interactive"?this.emitSyncDispatch({type:"nextStep",next:this.player.mainSeqStep()+1}):this.mode==="sync"?(this.doNextStep(),this.emitSyncDispatch({type:"nextStep",next:this.player.mainSeqStep()})):this.doNextStep())},n.prototype.doNextStep=function(){this.player.nextStep();var e=this.player.mainSeqStep();this.__slideState.mainSeqStep=e,this.emitStateChange()},n.prototype.prevStep=function(){this.isLoading||(this.mode==="interactive"?this.emitSyncDispatch({type:"prevStep",next:this.player.mainSeqStep()-1}):this.mode==="sync"?(this.doPrevStep(),this.emitSyncDispatch({type:"prevStep",next:this.player.mainSeqStep()})):this.doPrevStep())},n.prototype.doPrevStep=function(){this.player.prevStep();var e=this.player.mainSeqStep();this.__slideState.mainSeqStep=e,this.emitStateChange()},n.prototype.emitStateChange=function(){if(this.mode!=="local"){var e=this.slideState;Object(ft.isEqual)(this.lastEmitedState,e)||(this.lastEmitedState=e,this.emit(ya.stateChange,this.slideState),this.log+="=== stateChange dispatch ["+new Date().toISOString()+`] ===
`,this.log+=JSON.stringify(this.slideState,null,2),this.log+=`

`)}},n.prototype.emitSyncDispatch=function(e){this.emit(ya.syncDispatch,e),this.log+="=== sync dispatch ["+new Date().toISOString()+`] ===
`,this.log+=JSON.stringify(e,null,2),this.log+=`

`},n.prototype.setMainSeqStep=function(e,r){this.player.setMainSeqStep(e,r)},n.prototype.setInteractive=function(e){this.interactive=e,this.player.setInteractive(e)},n.prototype.pause=function(){this.player.pause()},n.prototype.resume=function(){this.player.resume()},n.prototype.destroy=function(){this.frameResizeObserver.disconnect(),this.player.removeAllListeners(),this.player.destroy(),this.player.removeAllListeners(),window.removeEventListener("__slide_log__",this.handleLogDownload),window.removeEventListener("__slide_state__",this.handleSlideStateLog),window.clearInterval(this.persistLogId),cl&&cl.removeItem(this.logId).catch(function(){});try{this.anchor.removeChild(this.player.view)}catch{}},n}(X.a)}]);function Ng(Re,C,S){return Math.min(Math.max(Re,C),S)}function Fg(Re){return typeof Re=="object"&&Re!==null}function Bg(Re){return new Promise(C=>setTimeout(C,Re))}function Ug(Re,C,S){const it=C.slideState.currentSlideIndex;if(it==null)return;const j=[S,it].join("/");if(Re.scenePathType(j)==="none"){Re.removeScenes(S);const dt=C.slideCount,ot=[];for(let X=1;X<=dt;++X)ot.push({name:`${X}`});Re.putScenes(S,ot)}Re.setScenePath(j)}function kg(Re){const{width:C,height:S,slideCount:it,slideState:j}=Re,{taskId:dt,url:ot}=j,X=[];for(let ft=1;ft<=it;++ft)X.push({width:C,height:S,thumbnail:`${ot}/${dt}/preview/${ft}.png`,src:"ppt"});return X}class Gg{constructor(C,S,it,j,dt,ot,X,ft){this.slide=C,this.onPageChanged=S,this.onTransitionStart=it,this.onTransitionEnd=j,this.onDispatchSyncEvent=dt,this.onStateChange=ot,this.initialState=X,this.initialPage=ft,this.ready=new Promise((tt,J)=>{this.resolveReady=tt,this.reject=J}),this.onRenderError=({error:tt})=>{console.warn("[Slide] render error",tt)},this.pollCount=0,this.pollReadyState=()=>{this.isReady()?this.resolveReady(this):this.pollCount<60?(this.pollCount++,setTimeout(this.pollReadyState,500)):this.reject(new Error("slide init time out (30s)"))},this.targetingPage=-1,this.resetTargetingPage=()=>{this.targetingPage=-1},C.on(ba.SLIDE_EVENTS.slideChange,S),C.on(ba.SLIDE_EVENTS.slideChange,this.resetTargetingPage),C.on(ba.SLIDE_EVENTS.renderStart,it),C.on(ba.SLIDE_EVENTS.renderEnd,j),C.on(ba.SLIDE_EVENTS.mainSeqStepStart,it),C.on(ba.SLIDE_EVENTS.mainSeqStepEnd,j),C.on(ba.SLIDE_EVENTS.syncDispatch,dt),C.on(ba.SLIDE_EVENTS.renderError,j),C.on(ba.SLIDE_EVENTS.renderError,this.onRenderError),C.on(ba.SLIDE_EVENTS.stateChange,ot),this.pollReadyState()}initialize(){this.initialState?this.slide.setSlideState(this.initialState):this.slide.renderSlide(this.initialPage)}receiveSyncEvent(C){this.slide.emit(ba.SLIDE_EVENTS.syncReceive,C)}isReady(){return this.slide.slideCount>0}jumpToPage(C){!this.isReady()||(C=Ng(C,1,this.slide.slideCount),C!==this.targetingPage&&(this.targetingPage=C,this.slide.renderSlide(C)))}destroy(){this.slide.destroy()}}function Hg(Re,C,S,it,j,dt,ot,X,ft,tt,J,lt){const Ft=new ba.Slide({anchor:Re,interactive:!0,mode:"interactive",resize:!1,controller:it,timestamp:lt});return Ft.setResource(C,S),new Gg(Ft,ot,X,ft,tt,J,j,dt)}function zg(Re){const C="http://www.w3.org/2000/svg",S=document.createElementNS(C,"svg");S.setAttribute("class",`${Re}-footer-icon-sidebar`),S.setAttribute("viewBox","0 0 64 64");const it=document.createElementNS(C,"path");return it.setAttribute("fill","currentColor"),it.setAttribute("d","M50 8H14c-3.309 0-6 2.691-6 6v36c0 3.309 2.691 6 6 6h36c3.309 0 6-2.691 6-6V14c0-3.309-2.691-6-6-6zM12 50V14c0-1.103.897-2 2-2h8v40h-8c-1.103 0-2-.897-2-2zm40 0c0 1.103-.897 2-2 2H26V12h24c1.103 0 2 .897 2 2z"),S.appendChild(it),S}function jg(Re){const C="http://www.w3.org/2000/svg",S=document.createElementNS(C,"svg");S.setAttribute("class",`${Re}-footer-icon-arrow-left`),S.setAttribute("viewBox","0 0 500 500");const it=document.createElementNS(C,"path");return it.setAttribute("fill","currentColor"),it.setAttribute("d","M177.81 249.959L337.473 90.295c2.722-2.865 2.651-7.378-.143-10.1-2.793-2.65-7.163-2.65-9.956 0l-164.75 164.75c-2.793 2.793-2.793 7.306 0 10.1l164.75 164.75c2.865 2.722 7.378 2.65 10.099-.143 2.651-2.794 2.651-7.163 0-9.957L177.809 249.959z"),S.appendChild(it),S}function Vg(Re){const C="http://www.w3.org/2000/svg",S=document.createElementNS(C,"svg");S.setAttribute("class",`${Re}-footer-icon-arrow-right`),S.setAttribute("viewBox","0 0 500 500");const it=document.createElementNS(C,"path");return it.setAttribute("fill","currentColor"),it.setAttribute("d","M322.19 250.041L162.527 409.705c-2.722 2.865-2.651 7.378.143 10.1 2.793 2.65 7.163 2.65 9.956 0l164.75-164.75c2.793-2.793 2.793-7.306 0-10.1l-164.75-164.75c-2.865-2.722-7.378-2.65-10.099.143-2.651 2.794-2.651 7.163 0 9.957l159.664 159.736z"),S.appendChild(it),S}function Wg(Re){const C="http://www.w3.org/2000/svg",S=document.createElementNS(C,"svg");S.setAttribute("class",`${Re}-footer-icon-play`),S.setAttribute("viewBox","0 0 500 500");const it=document.createElementNS(C,"path");return it.setAttribute("fill","currentColor"),it.setAttribute("d","M418.158 257.419L174.663 413.33c-6.017 3.919-15.708 3.772-21.291-.29-2.791-2.018-4.295-4.483-4.295-7.084V94.109c0-5.65 6.883-10.289 15.271-10.289 4.298 0 8.391 1.307 11.181 3.332l242.629 155.484c6.016 3.917 6.451 10.292.649 14.491-.216.154-.432.154-.649.292zM170.621 391.288l223.116-141.301L170.71 107.753l-.089 283.535z"),S.appendChild(it),S}function Xg(Re){const C="http://www.w3.org/2000/svg",S=document.createElementNS(C,"svg");S.setAttribute("class",`${Re}-footer-icon-pause`),S.setAttribute("viewBox","0 0 500 500");const it=document.createElementNS(C,"path");return it.setAttribute("fill","currentColor"),it.setAttribute("d","M312.491 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261zM165.257 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261z"),S.appendChild(it),S}class qg{constructor({readonly:C,box:S,onNewPageIndex:it,onPlay:j}){this._pages=[],this.pageIndex=0,this.setPaused=()=>{this.$btnPlay.classList.toggle(this.wrapClassName("footer-btn-playing"),!1)},this.setPlaying=()=>{this.$btnPlay.classList.toggle(this.wrapClassName("footer-btn-playing"),!0)},this.namespace="netless-app-slide",this.isShowPreview=!1,this.isSmallBox=!1,this.sideEffect=new zm,this.readonly=C,this.box=S,this.onNewPageIndex=it,this.onPlay=j,this.render()}set pages(C){this._pages=C,this.refreshPreview(),this.refreshTotalPage(),this.refreshBtnSidebar()}get pages(){return this._pages}mount(){this.box.mountContent(this.$content),this.box.mountFooter(this.$footer)}unmount(){this.$content.remove(),this.$footer.remove()}setReadonly(C){this.readonly!==C&&(this.readonly=C,this.$content.classList.toggle(this.wrapClassName("readonly"),C),this.$footer.classList.toggle(this.wrapClassName("readonly"),C),this.$pageNumberInput.disabled=C)}destroy(){this.sideEffect.flushAll(),this.unmount()}setPageIndex(C){Number.isNaN(C)||(this.pageIndex=C,this.$pageNumberInput.value=String(C+1))}refreshTotalPage(){this.pages.length?this.$totalPage.textContent=" / "+this.pages.length:this.$totalPage.textContent=""}setSmallBox(C){this.isSmallBox!==C&&(this.isSmallBox=C,this.$footer.classList.toggle(this.wrapClassName("float-footer"),C))}render(){return this.renderContent(),this.renderFooter(),this.$content}renderContent(){if(!this.$content){const C=document.createElement("div");C.className=this.wrapClassName("content"),this.$content=C,this.readonly&&C.classList.add(this.wrapClassName("readonly")),C.appendChild(this.renderPreviewMask()),C.appendChild(this.renderPreview())}return this.$content}renderPreview(){if(!this.$preview){const C=document.createElement("div");C.className=this.wrapClassName("preview")+" tele-fancy-scrollbar",this.$preview=C,this.refreshPreview(),this.sideEffect.addEventListener(C,"click",S=>{var j;if(this.readonly)return;const it=(j=S.target.dataset)==null?void 0:j.pageIndex;it&&(S.preventDefault(),S.stopPropagation(),S.stopImmediatePropagation(),this.onNewPageIndex(Number(it)),this.togglePreview(!1))})}return this.$preview}refreshPreview(){const{$preview:C}=this,S=this.wrapClassName("preview-page"),it=this.wrapClassName("preview-page-name");for(;C.firstChild;)C.firstChild.remove();this.pages.forEach((j,dt)=>{var lt;const ot=(lt=j.thumbnail)!=null?lt:j.src.startsWith("ppt")?void 0:j.src;if(!ot)return;const X=String(dt),ft=document.createElement("a");ft.className=S+" "+this.wrapClassName(`preview-page-${dt}`),ft.setAttribute("href","#"),ft.dataset.pageIndex=X;const tt=document.createElement("span");tt.className=it,tt.textContent=String(dt+1),tt.dataset.pageIndex=X;const J=document.createElement("img");J.width=j.width,J.height=j.height,J.dataset.src=ot,J.dataset.pageIndex=X,ft.appendChild(J),ft.appendChild(tt),C.appendChild(ft)}),this.sideEffect.add(()=>{const j=new Og({container:this.$preview,elements_selector:`.${this.wrapClassName("preview-page>img")}`});return()=>j.destroy()},"preview-lazyload")}renderPreviewMask(){return this.$previewMask||(this.$previewMask=document.createElement("div"),this.$previewMask.className=this.wrapClassName("preview-mask"),this.sideEffect.addEventListener(this.$previewMask,"click",C=>{this.readonly||C.target===this.$previewMask&&this.togglePreview(!1)})),this.$previewMask}refreshBtnSidebar(){this.$btnSidebar.style.display=this.pages.length>0?"":"none"}renderFooter(){if(!this.$footer){const C=document.createElement("div");C.className=this.wrapClassName("footer"),this.$footer=C,this.readonly&&C.classList.add(this.wrapClassName("readonly")),this.isSmallBox&&C.classList.add(this.wrapClassName("float-footer"));const S=this.renderFooterBtn("btn-sidebar",zg(this.namespace));this.sideEffect.addEventListener(S,"click",()=>{this.readonly||this.togglePreview()}),this.$btnSidebar=S,this.$btnSidebar.style.display="none",this.$footer.appendChild(S);const it=document.createElement("div");it.className=this.wrapClassName("page-jumps");const j=this.renderFooterBtn("btn-page-back",jg(this.namespace));if(this.sideEffect.addEventListener(j,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex-1)}),it.appendChild(j),this.onPlay){const tt=this.renderFooterBtn("btn-page-play",Wg(this.namespace),Xg(this.namespace));this.$btnPlay=tt,this.sideEffect.addEventListener(tt,"click",()=>{this.readonly||(this.setPlaying(),this.onPlay&&this.onPlay())}),it.appendChild(tt)}const dt=this.renderFooterBtn("btn-page-next",Vg(this.namespace));this.sideEffect.addEventListener(dt,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex+1)}),it.appendChild(dt);const ot=document.createElement("div");ot.className=this.wrapClassName("page-number");const X=document.createElement("input");X.className=this.wrapClassName("page-number-input"),X.value=String(this.pageIndex+1),this.readonly&&(X.disabled=!0),this.$pageNumberInput=X,this.sideEffect.addEventListener(X,"change",()=>{this.readonly||X.value&&this.onNewPageIndex(Number(X.value)-1)});const ft=document.createElement("span");this.$totalPage=ft,ot.appendChild(X),ot.appendChild(ft),this.$footer.appendChild(it),this.$footer.appendChild(ot)}return this.$footer}renderFooterBtn(C,S,it){const j=document.createElement("button");return j.className=this.wrapClassName("footer-btn")+" "+this.wrapClassName(C),j.appendChild(S),it&&j.appendChild(it),j}togglePreview(C){if(this.isShowPreview=C!=null?C:!this.isShowPreview,this.$content.classList.toggle(this.wrapClassName("preview-active"),this.isShowPreview),this.isShowPreview){const S=this.$preview.querySelector("."+this.wrapClassName(`preview-page-${this.pageIndex}`));S&&this.$preview.scrollTo({top:S.offsetTop-16})}}wrapClassName(C){return`${this.namespace}-${C}`}}const Yg=new Set(["clicker","selector"]);class Zg{constructor({box:C,view:S,mountSlideController:it,mountWhiteboard:j}){this.scaleDocsToFit=()=>{if(this.slideController){const{width:dt,height:ot}=this.slideController.slide;this.whiteboardView.moveCameraToContain({originX:-dt/2,originY:-ot/2,width:dt,height:ot,animationMode:"immediately"})}},this.onPlay=()=>{this.slideController&&this.slideController.slide.nextStep()},this.onNewPageIndex=dt=>{this.slideController&&this.slideController.jumpToPage(dt+1)},this.sideEffect=new zm,this.namespace="netless-app-slide",this.box=C,this.whiteboardView=S,this.mountSlideController=it,this.mountWhiteboard=j,this.viewer=new qg({box:C,readonly:C.readonly,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlay}),this.render()}render(){this.viewer.$content.appendChild(this.renderSlideContainer()),this.viewer.$content.appendChild(this.renderWhiteboardView()),this.sideEffect.addEventListener(window,"keydown",C=>{if(this.box.focus&&this.slideController)switch(C.key){case"ArrowUp":case"ArrowLeft":{this.slideController.slide.prevStep();break}case"ArrowRight":case"ArrowDown":{this.slideController.slide.nextStep();break}}})}renderSlideContainer(){if(!this.$slide){const C=document.createElement("div");C.className=this.wrapClassName("slide"),C.dataset.appKind="Slide",this.$slide=C}return this.$slide}renderWhiteboardView(){return this.$whiteboardView||(this.$whiteboardView=document.createElement("div"),this.$whiteboardView.className=this.wrapClassName("wb-view"),this.mountWhiteboard(this.$whiteboardView)),this.$whiteboardView}async mount(){return this.viewer.mount(),this.slideController=await this.mountSlideController(this.$slide),this.viewer.pages=kg(this.slideController.slide),this.viewer.setPageIndex(this.getPageIndex(this.slideController.slide)),this.scaleDocsToFit(),this.sideEffect.add(()=>(this.whiteboardView.callbacks.on("onSizeUpdated",this.scaleDocsToFit),()=>this.whiteboardView.callbacks.off("onSizeUpdated",this.scaleDocsToFit))),this}getPageIndex(C){return(C.slideState.currentSlideIndex||1)-1}unmount(){return this.slideController&&(this.slideController.destroy(),this.slideController=void 0),this.viewer.unmount(),this}setReadonly(C){this.viewer.setReadonly(C)}destroy(){this.sideEffect.flushAll(),this.unmount(),this.viewer.destroy()}toggleClickThrough(C){this.$whiteboardView.style.pointerEvents=!C||Yg.has(C)?"none":"auto"}wrapClassName(C){return`${this.namespace}-${C}`}}var Jg=`.netless-app-slide-content{position:relative;height:100%;overflow:hidden}.netless-app-slide-preview-mask{display:none;position:absolute;z-index:200;top:0;left:0;width:100%;height:100%}.netless-app-slide-preview{display:flex;flex-direction:column;align-items:center;position:absolute;z-index:300;top:0;left:0;width:33%;max-width:200px;height:100%;padding-top:10px;transform:translate(-100%);background:rgba(237,237,240,.9);box-shadow:inset -1px 0 #0000001c;transition:transform .4s}.netless-app-slide-preview-active .netless-app-slide-preview-mask{display:block}.netless-app-slide-preview-active .netless-app-slide-preview{transform:translate(0)}.netless-app-slide-preview-page{position:relative;display:block;width:55%;margin-bottom:10px;font-size:0;color:transparent;outline:none;border:7px solid transparent;border-radius:4px;transition:border-color .3s;user-select:none}.netless-app-slide-preview-page:hover,.netless-app-slide-preview-page.netless-app-slide-preview-page-active{border-color:#444e601a}.netless-app-slide-preview-page>img{width:100%;height:auto;box-sizing:border-box;border:1px solid rgba(0,0,0,.5);border-radius:1px;background-color:#fff;box-shadow:0 2px 8px #0000004d}.netless-app-slide-preview-page-name{position:absolute;top:1px;left:-10px;transform:translate(-100%);text-align:right;font-size:12px;color:#5f5f5f;user-select:none}.netless-app-slide-footer{box-sizing:border-box;height:26px;display:flex;align-items:center;padding:0 16px;border-top:1px solid #eeeef7;color:#191919}.netless-app-slide-float-footer{width:100%;min-height:26px;position:absolute;left:0;bottom:0;z-index:2000;background:rgba(249,249,252,.9);transition:opacity .4s}.netless-app-slide-footer-btn{box-sizing:border-box;width:26px;height:26px;font-size:0;margin:0;padding:3px;border:none;border-radius:1px;outline:none;color:currentColor;background:transparent;transition:background .4s;cursor:pointer;user-select:none}.netless-app-slide-footer-btn:hover{background:rgba(237,237,240,.9)}.netless-app-slide-footer-btn>svg{width:100%;height:100%}.netless-app-slide-footer-btn>svg:nth-of-type(2){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(1){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(2){display:initial}.netless-app-slide-footer-btn~.netless-app-slide-footer-btn{margin-left:15px}.netless-app-slide-page-jumps{flex:1;display:flex;justify-content:center;align-items:center}.netless-app-slide-page-number{margin-left:auto;font-size:13px;user-select:none;white-space:nowrap;word-break:keep-all}.netless-app-slide-page-number-input{border:none;outline:none;width:1.5em;text-align:right;border-radius:2px;color:currentColor;background:transparent;transition:background .4s;user-select:text}.netless-app-slide-page-number-input:hover,.netless-app-slide-page-number-input:focus,.netless-app-slide-page-number-input:active{background:#fff;box-shadow:#63636333 0 2px 8px}.netless-app-slide-readonly .netless-app-slide-footer-btn{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-footer-btn:hover{background:transparent}.netless-app-slide-readonly .netless-app-slide-page-number-input{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-page-number-input:hover,.netless-app-slide-readonly .netless-app-slide-page-number-input:focus,.netless-app-slide-readonly .netless-app-slide-page-number-input:active{background:transparent;box-shadow:none}.netless-app-slide-readonly .netless-app-slide-page-number-input:disabled{color:inherit}.netless-app-slide-readonly.netless-app-slide-float-footer{display:none}.netless-app-slide-wb-view{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;overflow:hidden}.netless-app-slide-slide{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.netless-app-slide-slide canvas{transform:scale(var(--netless-app-slide-scale, 1))}
`;const rv={kind:"Slide",async setup(Re){var F;const C=Re.getBox(),S=Re.getView(),it=Re.getRoom(),j=Re.getDisplayer(),dt=Dg(Re,{taskId:"",url:"",state:null});if(!dt.taskId)throw new Error("[Slide] no taskId");if(!S)throw new Error("[Slide] no view, please set scenePath on addApp()");if(!dt.state&&!Re.isAddApp)for(let Y=0;Y<15&&(await Bg(200),!dt.state);++Y);C.mountStyles(Jg);const ot=new zm,X=Re.getInitScenePath(),ft=(F=Re.getAppOptions())==null?void 0:F.debug,tt=`channel-${Re.appId}`;let J;const lt=()=>it?it.calibrationTimestamp:j.beginTimestamp+j.progressTime,Ft=Y=>{console.log("[Slide] page to",Y),Re.getIsWritable()&&it&&J&&(Ug(it,J.slide,X),ut.viewer.setPageIndex(Y-1))},jt=()=>{ut.viewer.setPlaying()},kt=()=>{ut.viewer.setPaused()},I=Y=>{Re.getIsWritable()&&J&&it&&it.dispatchMagixEvent(tt,{type:ba.SLIDE_EVENTS.syncDispatch,payload:Y})},B=Y=>{Re.updateAttributes(["state"],Y)};ot.add(()=>{const Y=async $=>{if(J&&$.event===tt&&Fg($.payload)){const{type:ct,payload:se}=$.payload;ct===ba.SLIDE_EVENTS.syncDispatch&&J.receiveSyncEvent(se)}};return j.addMagixEventListener(tt,Y),()=>j.removeMagixEventListener(tt,Y)});const V=async Y=>(J=Hg(Y,dt.taskId,dt.url||"https://convertcdn.netless.link/dynamicConvert",ft,JSON.parse(JSON.stringify(dt.state)),j.state.sceneState.index+1,Ft,jt,kt,I,B,lt),J.initialize(),await J.ready,J),ut=new Zg({box:C,view:S,mountSlideController:V,mountWhiteboard:Y=>Re.mountView(Y)});try{await ut.mount()}catch(Y){console.warn(Y),console.log("[Slide]: destroy by error"),ot.flushAll(),ut.destroy();return}it&&(ut.toggleClickThrough(it.state.memberState.currentApplianceName),ot.add(()=>{const Y=$=>{$.memberState&&ut.toggleClickThrough($.memberState.currentApplianceName)};return it.callbacks.on("onRoomStateChanged",Y),()=>it.callbacks.off("onRoomStateChanged",Y)})),Re.emitter.on("writableChange",()=>{ut.setReadonly(!Re.getIsWritable())}),Re.emitter.on("destroy",()=>{console.log("[Slide]: destroy"),ot.flushAll(),ut.destroy()})}};export{rv as default};
