var yA=Object.defineProperty;var rw=Object.getOwnPropertySymbols;var xA=Object.prototype.hasOwnProperty,bA=Object.prototype.propertyIsEnumerable;var ow=(tt,ce,_)=>ce in tt?yA(tt,ce,{enumerable:!0,configurable:!0,writable:!0,value:_}):tt[ce]=_,sw=(tt,ce)=>{for(var _ in ce||(ce={}))xA.call(ce,_)&&ow(tt,_,ce[_]);if(rw)for(var _ of rw(ce))bA.call(ce,_)&&ow(tt,_,ce[_]);return tt};import{s as V0}from"./side-effect-manager.es.5f289aa4.js";import{L as wA}from"./lazyload.esm.0a4b6d46.js";import{e as TA}from"./ensure-attributes.2c659353.js";var Io=function(tt){var ce={};function _(b){if(ce[b])return ce[b].exports;var ee=ce[b]={i:b,l:!1,exports:{}};return tt[b].call(ee.exports,ee,ee.exports,_),ee.l=!0,ee.exports}return _.m=tt,_.c=ce,_.d=function(b,ee,N){_.o(b,ee)||Object.defineProperty(b,ee,{enumerable:!0,get:N})},_.r=function(b){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})},_.t=function(b,ee){if(1&ee&&(b=_(b)),8&ee||4&ee&&typeof b=="object"&&b&&b.__esModule)return b;var N=Object.create(null);if(_.r(N),Object.defineProperty(N,"default",{enumerable:!0,value:b}),2&ee&&typeof b!="string")for(var ne in b)_.d(N,ne,function(B){return b[B]}.bind(null,ne));return N},_.n=function(b){var ee=b&&b.__esModule?function(){return b.default}:function(){return b};return _.d(ee,"a",ee),ee},_.o=function(b,ee){return Object.prototype.hasOwnProperty.call(b,ee)},_.p="",_(_.s=27)}([function(tt,ce,_){var b=Object.prototype.hasOwnProperty,ee="~";function N(){}function ne(K,re,Te){this.fn=K,this.context=re,this.once=Te||!1}function B(K,re,Te,Ne,Le){if(typeof Te!="function")throw new TypeError("The listener must be a function");var S=new ne(Te,Ne||K,Le),A=ee?ee+re:re;return K._events[A]?K._events[A].fn?K._events[A]=[K._events[A],S]:K._events[A].push(S):(K._events[A]=S,K._eventsCount++),K}function ie(K,re){--K._eventsCount==0?K._events=new N:delete K._events[re]}function V(){this._events=new N,this._eventsCount=0}Object.create&&(N.prototype=Object.create(null),new N().__proto__||(ee=!1)),V.prototype.eventNames=function(){var K,re,Te=[];if(this._eventsCount===0)return Te;for(re in K=this._events)b.call(K,re)&&Te.push(ee?re.slice(1):re);return Object.getOwnPropertySymbols?Te.concat(Object.getOwnPropertySymbols(K)):Te},V.prototype.listeners=function(K){var re=ee?ee+K:K,Te=this._events[re];if(!Te)return[];if(Te.fn)return[Te.fn];for(var Ne=0,Le=Te.length,S=new Array(Le);Ne<Le;Ne++)S[Ne]=Te[Ne].fn;return S},V.prototype.listenerCount=function(K){var re=ee?ee+K:K,Te=this._events[re];return Te?Te.fn?1:Te.length:0},V.prototype.emit=function(K,re,Te,Ne,Le,S){var A=ee?ee+K:K;if(!this._events[A])return!1;var I,z,L=this._events[A],G=arguments.length;if(L.fn){switch(L.once&&this.removeListener(K,L.fn,void 0,!0),G){case 1:return L.fn.call(L.context),!0;case 2:return L.fn.call(L.context,re),!0;case 3:return L.fn.call(L.context,re,Te),!0;case 4:return L.fn.call(L.context,re,Te,Ne),!0;case 5:return L.fn.call(L.context,re,Te,Ne,Le),!0;case 6:return L.fn.call(L.context,re,Te,Ne,Le,S),!0}for(z=1,I=new Array(G-1);z<G;z++)I[z-1]=arguments[z];L.fn.apply(L.context,I)}else{var j,J=L.length;for(z=0;z<J;z++)switch(L[z].once&&this.removeListener(K,L[z].fn,void 0,!0),G){case 1:L[z].fn.call(L[z].context);break;case 2:L[z].fn.call(L[z].context,re);break;case 3:L[z].fn.call(L[z].context,re,Te);break;case 4:L[z].fn.call(L[z].context,re,Te,Ne);break;default:if(!I)for(j=1,I=new Array(G-1);j<G;j++)I[j-1]=arguments[j];L[z].fn.apply(L[z].context,I)}}return!0},V.prototype.on=function(K,re,Te){return B(this,K,re,Te,!1)},V.prototype.once=function(K,re,Te){return B(this,K,re,Te,!0)},V.prototype.removeListener=function(K,re,Te,Ne){var Le=ee?ee+K:K;if(!this._events[Le])return this;if(!re)return ie(this,Le),this;var S=this._events[Le];if(S.fn)S.fn!==re||Ne&&!S.once||Te&&S.context!==Te||ie(this,Le);else{for(var A=0,I=[],z=S.length;A<z;A++)(S[A].fn!==re||Ne&&!S[A].once||Te&&S[A].context!==Te)&&I.push(S[A]);I.length?this._events[Le]=I.length===1?I[0]:I:ie(this,Le)}return this},V.prototype.removeAllListeners=function(K){var re;return K?(re=ee?ee+K:K,this._events[re]&&ie(this,re)):(this._events=new N,this._eventsCount=0),this},V.prototype.off=V.prototype.removeListener,V.prototype.addListener=V.prototype.on,V.prefixed=ee,V.EventEmitter=V,tt.exports=V},function(tt,ce,_){(function(b,ee){var N;/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var ne="Expected a function",B="__lodash_placeholder__",ie=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],V="[object Arguments]",K="[object Array]",re="[object Boolean]",Te="[object Date]",Ne="[object Error]",Le="[object Function]",S="[object GeneratorFunction]",A="[object Map]",I="[object Number]",z="[object Object]",L="[object RegExp]",G="[object Set]",j="[object String]",J="[object Symbol]",Je="[object WeakMap]",dt="[object ArrayBuffer]",Ze="[object DataView]",se="[object Float32Array]",Ae="[object Float64Array]",Re="[object Int8Array]",k="[object Int16Array]",xe="[object Int32Array]",Ee="[object Uint8Array]",Ie="[object Uint16Array]",Se="[object Uint32Array]",Be=/\b__p \+= '';/g,Xe=/\b(__p \+=) '' \+/g,ot=/(__e\(.*?\)|\b__t\)) \+\n'';/g,nt=/&(?:amp|lt|gt|quot|#39);/g,Jt=/[&<>"']/g,st=RegExp(nt.source),Kt=RegExp(Jt.source),Nt=/<%-([\s\S]+?)%>/g,Ht=/<%([\s\S]+?)%>/g,yt=/<%=([\s\S]+?)%>/g,In=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xn=/^\w*$/,fn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Wn=/[\\^$.*+?()[\]{}|]/g,vn=RegExp(Wn.source),ri=/^\s+/,Li=/\s/,Ei=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ki=/\{\n\/\* \[wrapped with (.+)\] \*/,Mr=/,? & /,Zd=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ja=/[()=,{}\[\]\/\s]/,$d=/\\(\\)?/g,Jd=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,io=/\w*$/,Kd=/^[-+]0x[0-9a-f]+$/i,Qd=/^0b[01]+$/i,ep=/^\[object .+?Constructor\]$/,tp=/^0o[0-7]+$/i,np=/^(?:0|[1-9]\d*)$/,lu=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Lo=/($^)/,Wa=/['\n\r\u2028\u2029\\]/g,Xa="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ya="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ra="[\\ud800-\\udfff]",oa="["+Ya+"]",Oo="["+Xa+"]",di="\\d+",qa="[\\u2700-\\u27bf]",Xn="[a-z\\xdf-\\xf6\\xf8-\\xff]",Za="[^\\ud800-\\udfff"+Ya+di+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Xl="\\ud83c[\\udffb-\\udfff]",$a="[^\\ud800-\\udfff]",Yl="(?:\\ud83c[\\udde6-\\uddff]){2}",Yn="[\\ud800-\\udbff][\\udc00-\\udfff]",Do="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ip="(?:"+Xn+"|"+Za+")",fs="(?:"+Do+"|"+Za+")",rp="(?:"+Oo+"|"+Xl+")?",No="[\\ufe0e\\ufe0f]?"+rp+("(?:\\u200d(?:"+[$a,Yl,Yn].join("|")+")[\\ufe0e\\ufe0f]?"+rp+")*"),op="(?:"+[qa,Yl,Yn].join("|")+")"+No,sp="(?:"+[$a+Oo+"?",Oo,Yl,Yn,ra].join("|")+")",Ja=RegExp("['\u2019]","g"),ap=RegExp(Oo,"g"),ms=RegExp(Xl+"(?="+Xl+")|"+sp+No,"g"),ro=RegExp([Do+"?"+Xn+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[oa,Do,"$"].join("|")+")",fs+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[oa,Do+ip,"$"].join("|")+")",Do+"?"+ip+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Do+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",di,op].join("|"),"g"),gs=RegExp("[\\u200d\\ud800-\\udfff"+Xa+"\\ufe0e\\ufe0f]"),hp=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,up=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],lp=-1,ln={};ln[se]=ln[Ae]=ln[Re]=ln[k]=ln[xe]=ln[Ee]=ln["[object Uint8ClampedArray]"]=ln[Ie]=ln[Se]=!0,ln[V]=ln[K]=ln[dt]=ln[re]=ln[Ze]=ln[Te]=ln[Ne]=ln[Le]=ln[A]=ln[I]=ln[z]=ln[L]=ln[G]=ln[j]=ln[Je]=!1;var gn={};gn[V]=gn[K]=gn[dt]=gn[Ze]=gn[re]=gn[Te]=gn[se]=gn[Ae]=gn[Re]=gn[k]=gn[xe]=gn[A]=gn[I]=gn[z]=gn[L]=gn[G]=gn[j]=gn[J]=gn[Ee]=gn["[object Uint8ClampedArray]"]=gn[Ie]=gn[Se]=!0,gn[Ne]=gn[Le]=gn[Je]=!1;var oo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},$i=parseFloat,cp=parseInt,ql=typeof b=="object"&&b&&b.Object===Object&&b,dp=typeof self=="object"&&self&&self.Object===Object&&self,Ln=ql||dp||Function("return this")(),vs=ce&&!ce.nodeType&&ce,sa=vs&&typeof ee=="object"&&ee&&!ee.nodeType&&ee,Zl=sa&&sa.exports===vs,cu=Zl&&ql.process,Ji=function(){try{var be=sa&&sa.require&&sa.require("util").types;return be||cu&&cu.binding&&cu.binding("util")}catch{}}(),$l=Ji&&Ji.isArrayBuffer,Jl=Ji&&Ji.isDate,du=Ji&&Ji.isMap,pu=Ji&&Ji.isRegExp,fu=Ji&&Ji.isSet,mu=Ji&&Ji.isTypedArray;function Oi(be,Ve,Ye){switch(Ye.length){case 0:return be.call(Ve);case 1:return be.call(Ve,Ye[0]);case 2:return be.call(Ve,Ye[0],Ye[1]);case 3:return be.call(Ve,Ye[0],Ye[1],Ye[2])}return be.apply(Ve,Ye)}function Kl(be,Ve,Ye,ut){for(var xt=-1,Zt=be==null?0:be.length;++xt<Zt;){var kn=be[xt];Ve(ut,kn,Ye(kn),be)}return ut}function Gi(be,Ve){for(var Ye=-1,ut=be==null?0:be.length;++Ye<ut&&Ve(be[Ye],Ye,be)!==!1;);return be}function Ql(be,Ve){for(var Ye=be==null?0:be.length;Ye--&&Ve(be[Ye],Ye,be)!==!1;);return be}function ec(be,Ve){for(var Ye=-1,ut=be==null?0:be.length;++Ye<ut;)if(!Ve(be[Ye],Ye,be))return!1;return!0}function kr(be,Ve){for(var Ye=-1,ut=be==null?0:be.length,xt=0,Zt=[];++Ye<ut;){var kn=be[Ye];Ve(kn,Ye,be)&&(Zt[xt++]=kn)}return Zt}function aa(be,Ve){return!!(be==null?0:be.length)&&_s(be,Ve,0)>-1}function gu(be,Ve,Ye){for(var ut=-1,xt=be==null?0:be.length;++ut<xt;)if(Ye(Ve,be[ut]))return!0;return!1}function bn(be,Ve){for(var Ye=-1,ut=be==null?0:be.length,xt=Array(ut);++Ye<ut;)xt[Ye]=Ve(be[Ye],Ye,be);return xt}function so(be,Ve){for(var Ye=-1,ut=Ve.length,xt=be.length;++Ye<ut;)be[xt+Ye]=Ve[Ye];return be}function vu(be,Ve,Ye,ut){var xt=-1,Zt=be==null?0:be.length;for(ut&&Zt&&(Ye=be[++xt]);++xt<Zt;)Ye=Ve(Ye,be[xt],xt,be);return Ye}function pp(be,Ve,Ye,ut){var xt=be==null?0:be.length;for(ut&&xt&&(Ye=be[--xt]);xt--;)Ye=Ve(Ye,be[xt],xt,be);return Ye}function _u(be,Ve){for(var Ye=-1,ut=be==null?0:be.length;++Ye<ut;)if(Ve(be[Ye],Ye,be))return!0;return!1}var fp=yu("length");function tc(be,Ve,Ye){var ut;return Ye(be,function(xt,Zt,kn){if(Ve(xt,Zt,kn))return ut=Zt,!1}),ut}function Ka(be,Ve,Ye,ut){for(var xt=be.length,Zt=Ye+(ut?1:-1);ut?Zt--:++Zt<xt;)if(Ve(be[Zt],Zt,be))return Zt;return-1}function _s(be,Ve,Ye){return Ve==Ve?function(ut,xt,Zt){for(var kn=Zt-1,Ki=ut.length;++kn<Ki;)if(ut[kn]===xt)return kn;return-1}(be,Ve,Ye):Ka(be,nc,Ye)}function mp(be,Ve,Ye,ut){for(var xt=Ye-1,Zt=be.length;++xt<Zt;)if(ut(be[xt],Ve))return xt;return-1}function nc(be){return be!=be}function ic(be,Ve){var Ye=be==null?0:be.length;return Ye?bu(be,Ve)/Ye:NaN}function yu(be){return function(Ve){return Ve==null?void 0:Ve[be]}}function xu(be){return function(Ve){return be==null?void 0:be[Ve]}}function rc(be,Ve,Ye,ut,xt){return xt(be,function(Zt,kn,Ki){Ye=ut?(ut=!1,Zt):Ve(Ye,Zt,kn,Ki)}),Ye}function bu(be,Ve){for(var Ye,ut=-1,xt=be.length;++ut<xt;){var Zt=Ve(be[ut]);Zt!==void 0&&(Ye=Ye===void 0?Zt:Ye+Zt)}return Ye}function wu(be,Ve){for(var Ye=-1,ut=Array(be);++Ye<be;)ut[Ye]=Ve(Ye);return ut}function oc(be){return be&&be.slice(0,Bo(be)+1).replace(ri,"")}function Hi(be){return function(Ve){return be(Ve)}}function Tu(be,Ve){return bn(Ve,function(Ye){return be[Ye]})}function ha(be,Ve){return be.has(Ve)}function sc(be,Ve){for(var Ye=-1,ut=be.length;++Ye<ut&&_s(Ve,be[Ye],0)>-1;);return Ye}function ac(be,Ve){for(var Ye=be.length;Ye--&&_s(Ve,be[Ye],0)>-1;);return Ye}function gp(be,Ve){for(var Ye=be.length,ut=0;Ye--;)be[Ye]===Ve&&++ut;return ut}var vp=xu({\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"}),_p=xu({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function yp(be){return"\\"+oo[be]}function ys(be){return gs.test(be)}function Su(be){var Ve=-1,Ye=Array(be.size);return be.forEach(function(ut,xt){Ye[++Ve]=[xt,ut]}),Ye}function hc(be,Ve){return function(Ye){return be(Ve(Ye))}}function ao(be,Ve){for(var Ye=-1,ut=be.length,xt=0,Zt=[];++Ye<ut;){var kn=be[Ye];kn!==Ve&&kn!==B||(be[Ye]=B,Zt[xt++]=Ye)}return Zt}function Fo(be){var Ve=-1,Ye=Array(be.size);return be.forEach(function(ut){Ye[++Ve]=ut}),Ye}function Qa(be){var Ve=-1,Ye=Array(be.size);return be.forEach(function(ut){Ye[++Ve]=[ut,ut]}),Ye}function ho(be){return ys(be)?function(Ve){for(var Ye=ms.lastIndex=0;ms.test(Ve);)++Ye;return Ye}(be):fp(be)}function _i(be){return ys(be)?function(Ve){return Ve.match(ms)||[]}(be):function(Ve){return Ve.split("")}(be)}function Bo(be){for(var Ve=be.length;Ve--&&Li.test(be.charAt(Ve)););return Ve}var eh=xu({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),xs=function be(Ve){var Ye,ut=(Ve=Ve==null?Ln:xs.defaults(Ln.Object(),Ve,xs.pick(Ln,up))).Array,xt=Ve.Date,Zt=Ve.Error,kn=Ve.Function,Ki=Ve.Math,_n=Ve.Object,th=Ve.RegExp,uc=Ve.String,zi=Ve.TypeError,nh=ut.prototype,lc=kn.prototype,ur=_n.prototype,ih=Ve["__core-js_shared__"],Eu=lc.toString,an=ur.hasOwnProperty,Im=0,xp=(Ye=/[^.]+$/.exec(ih&&ih.keys&&ih.keys.IE_PROTO||""))?"Symbol(src)_1."+Ye:"",Mu=ur.toString,Lm=Eu.call(_n),Om=Ln._,Dm=th("^"+Eu.call(an).replace(Wn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Au=Zl?Ve.Buffer:void 0,Uo=Ve.Symbol,Pu=Ve.Uint8Array,bp=Au?Au.allocUnsafe:void 0,Ru=hc(_n.getPrototypeOf,_n),wp=_n.create,Tp=ur.propertyIsEnumerable,rh=nh.splice,bs=Uo?Uo.isConcatSpreadable:void 0,Gr=Uo?Uo.iterator:void 0,ws=Uo?Uo.toStringTag:void 0,Cu=function(){try{var l=Ns(_n,"defineProperty");return l({},"",{}),l}catch{}}(),Nm=Ve.clearTimeout!==Ln.clearTimeout&&Ve.clearTimeout,Fm=xt&&xt.now!==Ln.Date.now&&xt.now,Bm=Ve.setTimeout!==Ln.setTimeout&&Ve.setTimeout,Iu=Ki.ceil,Lu=Ki.floor,cc=_n.getOwnPropertySymbols,dc=Au?Au.isBuffer:void 0,uo=Ve.isFinite,yi=nh.join,Ou=hc(_n.keys,_n),wn=Ki.max,Qn=Ki.min,Qi=xt.now,xi=Ve.parseInt,Du=Ki.random,oh=nh.reverse,sh=Ns(Ve,"DataView"),ua=Ns(Ve,"Map"),Nu=Ns(Ve,"Promise"),Ts=Ns(Ve,"Set"),$e=Ns(Ve,"WeakMap"),Tn=Ns(_n,"create"),lo=$e&&new $e,lr={},Um=Xo(sh),qn=Xo(ua),pc=Xo(Nu),cn=Xo(Ts),Ar=Xo($e),ah=Uo?Uo.prototype:void 0,Ss=ah?ah.valueOf:void 0,pi=ah?ah.toString:void 0;function w(l){if(Nn(l)&&!Ft(l)&&!(l instanceof kt)){if(l instanceof Rn)return l;if(an.call(l,"__wrapped__"))return kp(l)}return new Rn(l)}var ko=function(){function l(){}return function(p){if(!Dn(p))return{};if(wp)return wp(p);l.prototype=p;var y=new l;return l.prototype=void 0,y}}();function hh(){}function Rn(l,p){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!p,this.__index__=0,this.__values__=void 0}function kt(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Pr(l){var p=-1,y=l==null?0:l.length;for(this.clear();++p<y;){var E=l[p];this.set(E[0],E[1])}}function Rr(l){var p=-1,y=l==null?0:l.length;for(this.clear();++p<y;){var E=l[p];this.set(E[0],E[1])}}function Vi(l){var p=-1,y=l==null?0:l.length;for(this.clear();++p<y;){var E=l[p];this.set(E[0],E[1])}}function cr(l){var p=-1,y=l==null?0:l.length;for(this.__data__=new Vi;++p<y;)this.add(l[p])}function Mi(l){var p=this.__data__=new Rr(l);this.size=p.size}function co(l,p){var y=Ft(l),E=!y&&qo(l),P=!y&&!E&&_o(l),H=!y&&!E&&!P&&Bs(l),te=y||E||P||H,ue=te?wu(l.length,uc):[],ve=ue.length;for(var Ge in l)!p&&!an.call(l,Ge)||te&&(Ge=="length"||P&&(Ge=="offset"||Ge=="parent")||H&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||Pi(Ge,ve))||ue.push(Ge);return ue}function po(l){var p=l.length;return p?l[Vo(0,p-1)]:void 0}function Es(l,p){return Zu(si(l),fo(p,0,l.length))}function uh(l){return Zu(si(l))}function la(l,p,y){(y!==void 0&&!vr(l[p],y)||y===void 0&&!(p in l))&&zr(l,p,y)}function Go(l,p,y){var E=l[p];an.call(l,p)&&vr(E,y)&&(y!==void 0||p in l)||zr(l,p,y)}function Hr(l,p){for(var y=l.length;y--;)if(vr(l[y][0],p))return y;return-1}function fc(l,p,y,E){return Di(l,function(P,H,te){p(E,P,y(P),te)}),E}function Sp(l,p){return l&&Hn(p,hi(p),l)}function zr(l,p,y){p=="__proto__"&&Cu?Cu(l,p,{configurable:!0,enumerable:!0,value:y,writable:!0}):l[p]=y}function lh(l,p){for(var y=-1,E=p.length,P=ut(E),H=l==null;++y<E;)P[y]=H?void 0:Yc(l,p[y]);return P}function fo(l,p,y){return l==l&&(y!==void 0&&(l=l<=y?l:y),p!==void 0&&(l=l>=p?l:p)),l}function oi(l,p,y,E,P,H){var te,ue=1&p,ve=2&p,Ge=4&p;if(y&&(te=P?y(l,E,P,H):y(l)),te!==void 0)return te;if(!Dn(l))return l;var He=Ft(l);if(He){if(te=function(qe){var Qe=qe.length,Tt=new qe.constructor(Qe);return Qe&&typeof qe[0]=="string"&&an.call(qe,"index")&&(Tt.index=qe.index,Tt.input=qe.input),Tt}(l),!ue)return si(l,te)}else{var Ke=ai(l),mt=Ke==Le||Ke==S;if(_o(l))return Mc(l,ue);if(Ke==z||Ke==V||mt&&!P){if(te=ve||mt?{}:Ic(l),!ue)return ve?function(qe,Qe){return Hn(qe,Fs(qe),Qe)}(l,function(qe,Qe){return qe&&Hn(Qe,mi(Qe),qe)}(te,l)):function(qe,Qe){return Hn(qe,mr(qe),Qe)}(l,Sp(te,l))}else{if(!gn[Ke])return P?l:{};te=function(qe,Qe,Tt){var pt=qe.constructor;switch(Qe){case dt:return Ac(qe);case re:case Te:return new pt(+qe);case Ze:return function(Rt,zt){var bt=zt?Ac(Rt.buffer):Rt.buffer;return new Rt.constructor(bt,Rt.byteOffset,Rt.byteLength)}(qe,Tt);case se:case Ae:case Re:case k:case xe:case Ee:case"[object Uint8ClampedArray]":case Ie:case Se:return Rs(qe,Tt);case A:return new pt;case I:case j:return new pt(qe);case L:return function(Rt){var zt=new Rt.constructor(Rt.source,io.exec(Rt));return zt.lastIndex=Rt.lastIndex,zt}(qe);case G:return new pt;case J:return wt=qe,Ss?_n(Ss.call(wt)):{}}var wt}(l,Ke,ue)}}H||(H=new Mi);var vt=H.get(l);if(vt)return vt;H.set(l,te),nf(l)?l.forEach(function(qe){te.add(oi(qe,p,y,qe,l,H))}):tf(l)&&l.forEach(function(qe,Qe){te.set(Qe,oi(qe,p,y,Qe,l,H))});var At=He?void 0:(Ge?ve?Os:Ni:ve?mi:hi)(l);return Gi(At||l,function(qe,Qe){At&&(qe=l[Qe=qe]),Go(te,Qe,oi(qe,p,y,Qe,l,H))}),te}function Vr(l,p,y){var E=y.length;if(l==null)return!E;for(l=_n(l);E--;){var P=y[E],H=p[P],te=l[P];if(te===void 0&&!(P in l)||!H(te))return!1}return!0}function Fu(l,p,y){if(typeof l!="function")throw new zi(ne);return _h(function(){l.apply(void 0,y)},p)}function Ho(l,p,y,E){var P=-1,H=aa,te=!0,ue=l.length,ve=[],Ge=p.length;if(!ue)return ve;y&&(p=bn(p,Hi(y))),E?(H=gu,te=!1):p.length>=200&&(H=ha,te=!1,p=new cr(p));e:for(;++P<ue;){var He=l[P],Ke=y==null?He:y(He);if(He=E||He!==0?He:0,te&&Ke==Ke){for(var mt=Ge;mt--;)if(p[mt]===Ke)continue e;ve.push(He)}else H(p,Ke,E)||ve.push(He)}return ve}w.templateSettings={escape:Nt,evaluate:Ht,interpolate:yt,variable:"",imports:{_:w}},w.prototype=hh.prototype,w.prototype.constructor=w,Rn.prototype=ko(hh.prototype),Rn.prototype.constructor=Rn,kt.prototype=ko(hh.prototype),kt.prototype.constructor=kt,Pr.prototype.clear=function(){this.__data__=Tn?Tn(null):{},this.size=0},Pr.prototype.delete=function(l){var p=this.has(l)&&delete this.__data__[l];return this.size-=p?1:0,p},Pr.prototype.get=function(l){var p=this.__data__;if(Tn){var y=p[l];return y==="__lodash_hash_undefined__"?void 0:y}return an.call(p,l)?p[l]:void 0},Pr.prototype.has=function(l){var p=this.__data__;return Tn?p[l]!==void 0:an.call(p,l)},Pr.prototype.set=function(l,p){var y=this.__data__;return this.size+=this.has(l)?0:1,y[l]=Tn&&p===void 0?"__lodash_hash_undefined__":p,this},Rr.prototype.clear=function(){this.__data__=[],this.size=0},Rr.prototype.delete=function(l){var p=this.__data__,y=Hr(p,l);return!(y<0)&&(y==p.length-1?p.pop():rh.call(p,y,1),--this.size,!0)},Rr.prototype.get=function(l){var p=this.__data__,y=Hr(p,l);return y<0?void 0:p[y][1]},Rr.prototype.has=function(l){return Hr(this.__data__,l)>-1},Rr.prototype.set=function(l,p){var y=this.__data__,E=Hr(y,l);return E<0?(++this.size,y.push([l,p])):y[E][1]=p,this},Vi.prototype.clear=function(){this.size=0,this.__data__={hash:new Pr,map:new(ua||Rr),string:new Pr}},Vi.prototype.delete=function(l){var p=Ta(this,l).delete(l);return this.size-=p?1:0,p},Vi.prototype.get=function(l){return Ta(this,l).get(l)},Vi.prototype.has=function(l){return Ta(this,l).has(l)},Vi.prototype.set=function(l,p){var y=Ta(this,l),E=y.size;return y.set(l,p),this.size+=y.size==E?0:1,this},cr.prototype.add=cr.prototype.push=function(l){return this.__data__.set(l,"__lodash_hash_undefined__"),this},cr.prototype.has=function(l){return this.__data__.has(l)},Mi.prototype.clear=function(){this.__data__=new Rr,this.size=0},Mi.prototype.delete=function(l){var p=this.__data__,y=p.delete(l);return this.size=p.size,y},Mi.prototype.get=function(l){return this.__data__.get(l)},Mi.prototype.has=function(l){return this.__data__.has(l)},Mi.prototype.set=function(l,p){var y=this.__data__;if(y instanceof Rr){var E=y.__data__;if(!ua||E.length<199)return E.push([l,p]),this.size=++y.size,this;y=this.__data__=new Vi(E)}return y.set(l,p),this.size=y.size,this};var Di=St(jr),Bu=St(mc,!0);function Uu(l,p){var y=!0;return Di(l,function(E,P,H){return y=!!p(E,P,H)}),y}function ca(l,p,y){for(var E=-1,P=l.length;++E<P;){var H=l[E],te=p(H);if(te!=null&&(ue===void 0?te==te&&!rr(te):y(te,ue)))var ue=te,ve=H}return ve}function mo(l,p){var y=[];return Di(l,function(E,P,H){p(E,P,H)&&y.push(E)}),y}function ct(l,p,y,E,P){var H=-1,te=l.length;for(y||(y=km),P||(P=[]);++H<te;){var ue=l[H];p>0&&y(ue)?p>1?ct(ue,p-1,y,E,P):so(P,ue):E||(P[P.length]=ue)}return P}var zo=Pc(),dr=Pc(!0);function jr(l,p){return l&&zo(l,p,hi)}function mc(l,p){return l&&dr(l,p,hi)}function Cr(l,p){return kr(p,function(y){return Dr(l[y])})}function Wr(l,p){for(var y=0,E=(p=Lr(p,l)).length;l!=null&&y<E;)l=l[gr(p[y++])];return y&&y==E?l:void 0}function ji(l,p,y){var E=p(l);return Ft(l)?E:so(E,y(l))}function Ai(l){return l==null?l===void 0?"[object Undefined]":"[object Null]":ws&&ws in _n(l)?function(p){var y=an.call(p,ws),E=p[ws];try{p[ws]=void 0;var P=!0}catch{}var H=Mu.call(p);return P&&(y?p[ws]=E:delete p[ws]),H}(l):function(p){return Mu.call(p)}(l)}function ku(l,p){return l>p}function Ms(l,p){return l!=null&&an.call(l,p)}function gc(l,p){return l!=null&&p in _n(l)}function vc(l,p,y){for(var E=y?gu:aa,P=l[0].length,H=l.length,te=H,ue=ut(H),ve=1/0,Ge=[];te--;){var He=l[te];te&&p&&(He=bn(He,Hi(p))),ve=Qn(He.length,ve),ue[te]=!y&&(p||P>=120&&He.length>=120)?new cr(te&&He):void 0}He=l[0];var Ke=-1,mt=ue[0];e:for(;++Ke<P&&Ge.length<ve;){var vt=He[Ke],At=p?p(vt):vt;if(vt=y||vt!==0?vt:0,!(mt?ha(mt,At):E(Ge,At,y))){for(te=H;--te;){var qe=ue[te];if(!(qe?ha(qe,At):E(l[te],At,y)))continue e}mt&&mt.push(At),Ge.push(vt)}}return Ge}function da(l,p,y){var E=(l=Np(l,p=Lr(p,l)))==null?l:l[gr(ir(p))];return E==null?void 0:Oi(E,l,y)}function As(l){return Nn(l)&&Ai(l)==V}function er(l,p,y,E,P){return l===p||(l==null||p==null||!Nn(l)&&!Nn(p)?l!=l&&p!=p:function(H,te,ue,ve,Ge,He){var Ke=Ft(H),mt=Ft(te),vt=Ke?K:ai(H),At=mt?K:ai(te),qe=(vt=vt==V?z:vt)==z,Qe=(At=At==V?z:At)==z,Tt=vt==At;if(Tt&&_o(H)){if(!_o(te))return!1;Ke=!0,qe=!1}if(Tt&&!qe)return He||(He=new Mi),Ke||Bs(H)?bi(H,te,ue,ve,Ge,He):function(bt,It,zn,wi,Vn,Fn,Nr){switch(zn){case Ze:if(bt.byteLength!=It.byteLength||bt.byteOffset!=It.byteOffset)return!1;bt=bt.buffer,It=It.buffer;case dt:return!(bt.byteLength!=It.byteLength||!Fn(new Pu(bt),new Pu(It)));case re:case Te:case I:return vr(+bt,+It);case Ne:return bt.name==It.name&&bt.message==It.message;case L:case j:return bt==It+"";case A:var $r=Su;case G:var $o=1&wi;if($r||($r=Fo),bt.size!=It.size&&!$o)return!1;var La=Nr.get(bt);if(La)return La==It;wi|=2,Nr.set(bt,It);var Jo=bi($r(bt),$r(It),wi,Vn,Fn,Nr);return Nr.delete(bt),Jo;case J:if(Ss)return Ss.call(bt)==Ss.call(It)}return!1}(H,te,vt,ue,ve,Ge,He);if(!(1&ue)){var pt=qe&&an.call(H,"__wrapped__"),wt=Qe&&an.call(te,"__wrapped__");if(pt||wt){var Rt=pt?H.value():H,zt=wt?te.value():te;return He||(He=new Mi),Ge(Rt,zt,ue,ve,He)}}return Tt?(He||(He=new Mi),function(bt,It,zn,wi,Vn,Fn){var Nr=1&zn,$r=Ni(bt),$o=$r.length,La=Ni(It).length;if($o!=La&&!Nr)return!1;for(var Jo=$o;Jo--;){var Jr=$r[Jo];if(!(Nr?Jr in It:an.call(It,Jr)))return!1}var ml=Fn.get(bt),Jc=Fn.get(It);if(ml&&Jc)return ml==It&&Jc==bt;var Ko=!0;Fn.set(bt,It),Fn.set(It,bt);for(var Vs=Nr;++Jo<$o;){Jr=$r[Jo];var js=bt[Jr],Oa=It[Jr];if(wi)var Da=Nr?wi(Oa,js,Jr,It,bt,Fn):wi(js,Oa,Jr,bt,It,Fn);if(!(Da===void 0?js===Oa||Vn(js,Oa,zn,wi,Fn):Da)){Ko=!1;break}Vs||(Vs=Jr=="constructor")}if(Ko&&!Vs){var Rh=bt.constructor,Ws=It.constructor;Rh==Ws||!("constructor"in bt)||!("constructor"in It)||typeof Rh=="function"&&Rh instanceof Rh&&typeof Ws=="function"&&Ws instanceof Ws||(Ko=!1)}return Fn.delete(bt),Fn.delete(It),Ko}(H,te,ue,ve,Ge,He)):!1}(l,p,y,E,er,P))}function pa(l,p,y,E){var P=y.length,H=P,te=!E;if(l==null)return!H;for(l=_n(l);P--;){var ue=y[P];if(te&&ue[2]?ue[1]!==l[ue[0]]:!(ue[0]in l))return!1}for(;++P<H;){var ve=(ue=y[P])[0],Ge=l[ve],He=ue[1];if(te&&ue[2]){if(Ge===void 0&&!(ve in l))return!1}else{var Ke=new Mi;if(E)var mt=E(Ge,He,ve,l,p,Ke);if(!(mt===void 0?er(He,Ge,3,E,Ke):mt))return!1}}return!0}function fa(l){return!(!Dn(l)||(p=l,xp&&xp in p))&&(Dr(l)?Dm:ep).test(Xo(l));var p}function Ep(l){return typeof l=="function"?l:l==null?Bi:typeof l=="object"?Ft(l)?xc(l[0],l[1]):Ap(l):mf(l)}function _c(l){if(!vh(l))return Ou(l);var p=[];for(var y in _n(l))an.call(l,y)&&y!="constructor"&&p.push(y);return p}function Mp(l){if(!Dn(l))return function(P){var H=[];if(P!=null)for(var te in _n(P))H.push(te);return H}(l);var p=vh(l),y=[];for(var E in l)(E!="constructor"||!p&&an.call(l,E))&&y.push(E);return y}function Gu(l,p){return l<p}function yc(l,p){var y=-1,E=Wi(l)?ut(l.length):[];return Di(l,function(P,H,te){E[++y]=p(P,H,te)}),E}function Ap(l){var p=Cc(l);return p.length==1&&p[0][2]?Op(p[0][0],p[0][1]):function(y){return y===l||pa(y,l,p)}}function xc(l,p){return lt(l)&&Lp(p)?Op(gr(l),p):function(y){var E=Yc(y,l);return E===void 0&&E===p?bh(y,l):er(p,E,3)}}function jt(l,p,y,E,P){l!==p&&zo(p,function(H,te){if(P||(P=new Mi),Dn(H))(function(ve,Ge,He,Ke,mt,vt,At){var qe=Lc(ve,He),Qe=Lc(Ge,He),Tt=At.get(Qe);if(Tt)return void la(ve,He,Tt);var pt=vt?vt(qe,Qe,He+"",ve,Ge,At):void 0,wt=pt===void 0;if(wt){var Rt=Ft(Qe),zt=!Rt&&_o(Qe),bt=!Rt&&!zt&&Bs(Qe);pt=Qe,Rt||zt||bt?Ft(qe)?pt=qe:En(qe)?pt=si(qe):zt?(wt=!1,pt=Mc(Qe,!0)):bt?(wt=!1,pt=Rs(Qe,!0)):pt=[]:Ma(Qe)||qo(Qe)?(pt=qe,qo(qe)?pt=af(qe):Dn(qe)&&!Dr(qe)||(pt=Ic(Qe))):wt=!1}wt&&(At.set(Qe,pt),mt(pt,Qe,Ke,vt,At),At.delete(Qe)),la(ve,He,pt)})(l,p,te,y,jt,E,P);else{var ue=E?E(Lc(l,te),H,te+"",l,p,P):void 0;ue===void 0&&(ue=H),la(l,te,ue)}},mi)}function pr(l,p){var y=l.length;if(y)return Pi(p+=p<0?y:0,y)?l[p]:void 0}function Xr(l,p,y){p=p.length?bn(p,function(P){return Ft(P)?function(H){return Wr(H,P.length===1?P[0]:P)}:P}):[Bi];var E=-1;return p=bn(p,Hi(Mt())),function(P,H){var te=P.length;for(P.sort(H);te--;)P[te]=P[te].value;return P}(yc(l,function(P,H,te){return{criteria:bn(p,function(ue){return ue(P)}),index:++E,value:P}}),function(P,H){return function(te,ue,ve){for(var Ge=-1,He=te.criteria,Ke=ue.criteria,mt=He.length,vt=ve.length;++Ge<mt;){var At=Ip(He[Ge],Ke[Ge]);if(At){if(Ge>=vt)return At;var qe=ve[Ge];return At*(qe=="desc"?-1:1)}}return te.index-ue.index}(P,H,y)})}function Hu(l,p,y){for(var E=-1,P=p.length,H={};++E<P;){var te=p[E],ue=Wr(l,te);y(ue,te)&&Sn(H,Lr(te,l),ue)}return H}function Ir(l,p,y,E){var P=E?mp:_s,H=-1,te=p.length,ue=l;for(l===p&&(p=si(p)),y&&(ue=bn(l,Hi(y)));++H<te;)for(var ve=0,Ge=p[H],He=y?y(Ge):Ge;(ve=P(ue,He,ve,E))>-1;)ue!==l&&rh.call(ue,ve,1),rh.call(l,ve,1);return l}function Ps(l,p){for(var y=l?p.length:0,E=y-1;y--;){var P=p[y];if(y==E||P!==H){var H=P;Pi(P)?rh.call(l,P,1):ga(l,P)}}return l}function Vo(l,p){return l+Lu(Du()*(p-l+1))}function zu(l,p){var y="";if(!l||p<1||p>9007199254740991)return y;do p%2&&(y+=l),(p=Lu(p/2))&&(l+=l);while(p);return y}function Wt(l,p){return Oc(Dp(l,p,Bi),l+"")}function bc(l){return po(Zr(l))}function wc(l,p){var y=Zr(l);return Zu(y,fo(p,0,y.length))}function Sn(l,p,y,E){if(!Dn(l))return l;for(var P=-1,H=(p=Lr(p,l)).length,te=H-1,ue=l;ue!=null&&++P<H;){var ve=gr(p[P]),Ge=y;if(ve==="__proto__"||ve==="constructor"||ve==="prototype")return l;if(P!=te){var He=ue[ve];(Ge=E?E(He,ve,ue):void 0)===void 0&&(Ge=Dn(He)?He:Pi(p[P+1])?[]:{})}Go(ue,ve,Ge),ue=ue[ve]}return l}var Pp=lo?function(l,p){return lo.set(l,p),l}:Bi,fi=Cu?function(l,p){return Cu(l,"toString",{configurable:!0,enumerable:!1,value:Ra(p),writable:!0})}:Bi;function Rp(l){return Zu(Zr(l))}function Gn(l,p,y){var E=-1,P=l.length;p<0&&(p=-p>P?0:P+p),(y=y>P?P:y)<0&&(y+=P),P=p>y?0:y-p>>>0,p>>>=0;for(var H=ut(P);++E<P;)H[E]=l[E+p];return H}function Vu(l,p){var y;return Di(l,function(E,P,H){return!(y=p(E,P,H))}),!!y}function ma(l,p,y){var E=0,P=l==null?E:l.length;if(typeof p=="number"&&p==p&&P<=2147483647){for(;E<P;){var H=E+P>>>1,te=l[H];te!==null&&!rr(te)&&(y?te<=p:te<p)?E=H+1:P=H}return P}return ch(l,p,Bi,y)}function ch(l,p,y,E){var P=0,H=l==null?0:l.length;if(H===0)return 0;for(var te=(p=y(p))!=p,ue=p===null,ve=rr(p),Ge=p===void 0;P<H;){var He=Lu((P+H)/2),Ke=y(l[He]),mt=Ke!==void 0,vt=Ke===null,At=Ke==Ke,qe=rr(Ke);if(te)var Qe=E||At;else Qe=Ge?At&&(E||mt):ue?At&&mt&&(E||!vt):ve?At&&mt&&!vt&&(E||!qe):!vt&&!qe&&(E?Ke<=p:Ke<p);Qe?P=He+1:H=He}return Qn(H,4294967294)}function ju(l,p){for(var y=-1,E=l.length,P=0,H=[];++y<E;){var te=l[y],ue=p?p(te):te;if(!y||!vr(ue,ve)){var ve=ue;H[P++]=te===0?0:te}}return H}function ft(l){return typeof l=="number"?l:rr(l)?NaN:+l}function Zn(l){if(typeof l=="string")return l;if(Ft(l))return bn(l,Zn)+"";if(rr(l))return pi?pi.call(l):"";var p=l+"";return p=="0"&&1/l==-1/0?"-0":p}function on(l,p,y){var E=-1,P=aa,H=l.length,te=!0,ue=[],ve=ue;if(y)te=!1,P=gu;else if(H>=200){var Ge=p?null:Rc(l);if(Ge)return Fo(Ge);te=!1,P=ha,ve=new cr}else ve=p?[]:ue;e:for(;++E<H;){var He=l[E],Ke=p?p(He):He;if(He=y||He!==0?He:0,te&&Ke==Ke){for(var mt=ve.length;mt--;)if(ve[mt]===Ke)continue e;p&&ve.push(Ke),ue.push(He)}else P(ve,Ke,y)||(ve!==ue&&ve.push(Ke),ue.push(He))}return ue}function ga(l,p){return(l=Np(l,p=Lr(p,l)))==null||delete l[gr(ir(p))]}function Yt(l,p,y,E){return Sn(l,p,y(Wr(l,p)),E)}function dh(l,p,y,E){for(var P=l.length,H=E?P:-1;(E?H--:++H<P)&&p(l[H],H,l););return y?Gn(l,E?0:H,E?H+1:P):Gn(l,E?H+1:0,E?P:H)}function Tc(l,p){var y=l;return y instanceof kt&&(y=y.value()),vu(p,function(E,P){return P.func.apply(P.thisArg,so([E],P.args))},y)}function Wu(l,p,y){var E=l.length;if(E<2)return E?on(l[0]):[];for(var P=-1,H=ut(E);++P<E;)for(var te=l[P],ue=-1;++ue<E;)ue!=P&&(H[P]=Ho(H[P]||te,l[ue],p,y));return on(ct(H,1),p,y)}function Sc(l,p,y){for(var E=-1,P=l.length,H=p.length,te={};++E<P;){var ue=E<H?p[E]:void 0;y(te,l[E],ue)}return te}function va(l){return En(l)?l:[]}function Xu(l){return typeof l=="function"?l:Bi}function Lr(l,p){return Ft(l)?l:lt(l,p)?[l]:$u(nn(l))}var Cp=Wt;function rt(l,p,y){var E=l.length;return y=y===void 0?E:y,!p&&y>=E?l:Gn(l,p,y)}var Ec=Nm||function(l){return Ln.clearTimeout(l)};function Mc(l,p){if(p)return l.slice();var y=l.length,E=bp?bp(y):new l.constructor(y);return l.copy(E),E}function Ac(l){var p=new l.constructor(l.byteLength);return new Pu(p).set(new Pu(l)),p}function Rs(l,p){var y=p?Ac(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.length)}function Ip(l,p){if(l!==p){var y=l!==void 0,E=l===null,P=l==l,H=rr(l),te=p!==void 0,ue=p===null,ve=p==p,Ge=rr(p);if(!ue&&!Ge&&!H&&l>p||H&&te&&ve&&!ue&&!Ge||E&&te&&ve||!y&&ve||!P)return 1;if(!E&&!H&&!Ge&&l<p||Ge&&y&&P&&!E&&!H||ue&&y&&P||!te&&P||!ve)return-1}return 0}function tr(l,p,y,E){for(var P=-1,H=l.length,te=y.length,ue=-1,ve=p.length,Ge=wn(H-te,0),He=ut(ve+Ge),Ke=!E;++ue<ve;)He[ue]=p[ue];for(;++P<te;)(Ke||P<H)&&(He[y[P]]=l[P]);for(;Ge--;)He[ue++]=l[P++];return He}function Yu(l,p,y,E){for(var P=-1,H=l.length,te=-1,ue=y.length,ve=-1,Ge=p.length,He=wn(H-ue,0),Ke=ut(He+Ge),mt=!E;++P<He;)Ke[P]=l[P];for(var vt=P;++ve<Ge;)Ke[vt+ve]=p[ve];for(;++te<ue;)(mt||P<H)&&(Ke[vt+y[te]]=l[P++]);return Ke}function si(l,p){var y=-1,E=l.length;for(p||(p=ut(E));++y<E;)p[y]=l[y];return p}function Hn(l,p,y,E){var P=!y;y||(y={});for(var H=-1,te=p.length;++H<te;){var ue=p[H],ve=E?E(y[ue],l[ue],ue,y,l):void 0;ve===void 0&&(ve=l[ue]),P?zr(y,ue,ve):Go(y,ue,ve)}return y}function jo(l,p){return function(y,E){var P=Ft(y)?Kl:fc,H=p?p():{};return P(y,l,Mt(E,2),H)}}function On(l){return Wt(function(p,y){var E=-1,P=y.length,H=P>1?y[P-1]:void 0,te=P>2?y[2]:void 0;for(H=l.length>3&&typeof H=="function"?(P--,H):void 0,te&&Ct(y[0],y[1],te)&&(H=P<3?void 0:H,P=1),p=_n(p);++E<P;){var ue=y[E];ue&&l(p,ue,E,H)}return p})}function St(l,p){return function(y,E){if(y==null)return y;if(!Wi(y))return l(y,E);for(var P=y.length,H=p?P:-1,te=_n(y);(p?H--:++H<P)&&E(te[H],H,te)!==!1;);return y}}function Pc(l){return function(p,y,E){for(var P=-1,H=_n(p),te=E(p),ue=te.length;ue--;){var ve=te[l?ue:++P];if(y(H[ve],ve,H)===!1)break}return p}}function Cs(l){return function(p){var y=ys(p=nn(p))?_i(p):void 0,E=y?y[0]:p.charAt(0),P=y?rt(y,1).join(""):p.slice(1);return E[l]()+P}}function Wo(l){return function(p){return vu(qc(zs(p).replace(Ja,"")),l,"")}}function fr(l){return function(){var p=arguments;switch(p.length){case 0:return new l;case 1:return new l(p[0]);case 2:return new l(p[0],p[1]);case 3:return new l(p[0],p[1],p[2]);case 4:return new l(p[0],p[1],p[2],p[3]);case 5:return new l(p[0],p[1],p[2],p[3],p[4]);case 6:return new l(p[0],p[1],p[2],p[3],p[4],p[5]);case 7:return new l(p[0],p[1],p[2],p[3],p[4],p[5],p[6])}var y=ko(l.prototype),E=l.apply(y,p);return Dn(E)?E:y}}function go(l){return function(p,y,E){var P=_n(p);if(!Wi(p)){var H=Mt(y,3);p=hi(p),y=function(ue){return H(P[ue],ue,P)}}var te=l(p,y,E);return te>-1?P[H?p[te]:te]:void 0}}function vo(l){return qr(function(p){var y=p.length,E=y,P=Rn.prototype.thru;for(l&&p.reverse();E--;){var H=p[E];if(typeof H!="function")throw new zi(ne);if(P&&!te&&Ds(H)=="wrapper")var te=new Rn([],!0)}for(E=te?E:y;++E<y;){var ue=Ds(H=p[E]),ve=ue=="wrapper"?$n(H):void 0;te=ve&&nr(ve[0])&&ve[1]==424&&!ve[4].length&&ve[9]==1?te[Ds(ve[0])].apply(te,ve[3]):H.length==1&&nr(H)?te[ue]():te.thru(H)}return function(){var Ge=arguments,He=Ge[0];if(te&&Ge.length==1&&Ft(He))return te.plant(He).value();for(var Ke=0,mt=y?p[Ke].apply(this,Ge):He;++Ke<y;)mt=p[Ke].call(this,mt);return mt}})}function _a(l,p,y,E,P,H,te,ue,ve,Ge){var He=128&p,Ke=1&p,mt=2&p,vt=24&p,At=512&p,qe=mt?void 0:fr(l);return function Qe(){for(var Tt=arguments.length,pt=ut(Tt),wt=Tt;wt--;)pt[wt]=arguments[wt];if(vt)var Rt=Or(Qe),zt=gp(pt,Rt);if(E&&(pt=tr(pt,E,P,vt)),H&&(pt=Yu(pt,H,te,vt)),Tt-=zt,vt&&Tt<Ge){var bt=ao(pt,Rt);return fh(l,p,_a,Qe.placeholder,y,pt,bt,ue,ve,Ge-Tt)}var It=Ke?y:this,zn=mt?It[l]:l;return Tt=pt.length,ue?pt=Hm(pt,ue):At&&Tt>1&&pt.reverse(),He&&ve<Tt&&(pt.length=ve),this&&this!==Ln&&this instanceof Qe&&(zn=qe||fr(zn)),zn.apply(It,pt)}}function qu(l,p){return function(y,E){return function(P,H,te,ue){return jr(P,function(ve,Ge,He){H(ue,te(ve),Ge,He)}),ue}(y,l,p(E),{})}}function ya(l,p){return function(y,E){var P;if(y===void 0&&E===void 0)return p;if(y!==void 0&&(P=y),E!==void 0){if(P===void 0)return E;typeof y=="string"||typeof E=="string"?(y=Zn(y),E=Zn(E)):(y=ft(y),E=ft(E)),P=l(y,E)}return P}}function xa(l){return qr(function(p){return p=bn(p,Hi(Mt())),Wt(function(y){var E=this;return l(p,function(P){return Oi(P,E,y)})})})}function Is(l,p){var y=(p=p===void 0?" ":Zn(p)).length;if(y<2)return y?zu(p,l):p;var E=zu(p,Iu(l/ho(p)));return ys(p)?rt(_i(E),0,l).join(""):E.slice(0,l)}function ph(l){return function(p,y,E){return E&&typeof E!="number"&&Ct(p,y,E)&&(y=E=void 0),p=yo(p),y===void 0?(y=p,p=0):y=yo(y),function(P,H,te,ue){for(var ve=-1,Ge=wn(Iu((H-P)/(te||1)),0),He=ut(Ge);Ge--;)He[ue?Ge:++ve]=P,P+=te;return He}(p,y,E=E===void 0?p<y?1:-1:yo(E),l)}}function Ls(l){return function(p,y){return typeof p=="string"&&typeof y=="string"||(p=or(p),y=or(y)),l(p,y)}}function fh(l,p,y,E,P,H,te,ue,ve,Ge){var He=8&p;p|=He?32:64,4&(p&=~(He?64:32))||(p&=-4);var Ke=[l,p,P,He?H:void 0,He?te:void 0,He?void 0:H,He?void 0:te,ue,ve,Ge],mt=y.apply(void 0,Ke);return nr(l)&&Fp(mt,Ke),mt.placeholder=E,Bp(mt,l,p)}function ba(l){var p=Ki[l];return function(y,E){if(y=or(y),(E=E==null?0:Qn(Xt(E),292))&&uo(y)){var P=(nn(y)+"e").split("e");return+((P=(nn(p(P[0]+"e"+(+P[1]+E)))+"e").split("e"))[0]+"e"+(+P[1]-E))}return p(y)}}var Rc=Ts&&1/Fo(new Ts([,-0]))[1]==1/0?function(l){return new Ts(l)}:Ca;function mh(l){return function(p){var y=ai(p);return y==A?Su(p):y==G?Qa(p):function(E,P){return bn(P,function(H){return[H,E[H]]})}(p,l(p))}}function sn(l,p,y,E,P,H,te,ue){var ve=2&p;if(!ve&&typeof l!="function")throw new zi(ne);var Ge=E?E.length:0;if(Ge||(p&=-97,E=P=void 0),te=te===void 0?te:wn(Xt(te),0),ue=ue===void 0?ue:Xt(ue),Ge-=P?P.length:0,64&p){var He=E,Ke=P;E=P=void 0}var mt=ve?void 0:$n(l),vt=[l,p,y,E,P,He,Ke,H,te,ue];if(mt&&function(qe,Qe){var Tt=qe[1],pt=Qe[1],wt=Tt|pt,Rt=wt<131,zt=pt==128&&Tt==8||pt==128&&Tt==256&&qe[7].length<=Qe[8]||pt==384&&Qe[7].length<=Qe[8]&&Tt==8;if(!Rt&&!zt)return qe;1&pt&&(qe[2]=Qe[2],wt|=1&Tt?0:4);var bt=Qe[3];if(bt){var It=qe[3];qe[3]=It?tr(It,bt,Qe[4]):bt,qe[4]=It?ao(qe[3],B):Qe[4]}(bt=Qe[5])&&(It=qe[5],qe[5]=It?Yu(It,bt,Qe[6]):bt,qe[6]=It?ao(qe[5],B):Qe[6]),(bt=Qe[7])&&(qe[7]=bt),128&pt&&(qe[8]=qe[8]==null?Qe[8]:Qn(qe[8],Qe[8])),qe[9]==null&&(qe[9]=Qe[9]),qe[0]=Qe[0],qe[1]=wt}(vt,mt),l=vt[0],p=vt[1],y=vt[2],E=vt[3],P=vt[4],!(ue=vt[9]=vt[9]===void 0?ve?0:l.length:wn(vt[9]-Ge,0))&&24&p&&(p&=-25),p&&p!=1)At=p==8||p==16?function(qe,Qe,Tt){var pt=fr(qe);return function wt(){for(var Rt=arguments.length,zt=ut(Rt),bt=Rt,It=Or(wt);bt--;)zt[bt]=arguments[bt];var zn=Rt<3&&zt[0]!==It&&zt[Rt-1]!==It?[]:ao(zt,It);if((Rt-=zn.length)<Tt)return fh(qe,Qe,_a,wt.placeholder,void 0,zt,zn,void 0,void 0,Tt-Rt);var wi=this&&this!==Ln&&this instanceof wt?pt:qe;return Oi(wi,this,zt)}}(l,p,ue):p!=32&&p!=33||P.length?_a.apply(void 0,vt):function(qe,Qe,Tt,pt){var wt=1&Qe,Rt=fr(qe);return function zt(){for(var bt=-1,It=arguments.length,zn=-1,wi=pt.length,Vn=ut(wi+It),Fn=this&&this!==Ln&&this instanceof zt?Rt:qe;++zn<wi;)Vn[zn]=pt[zn];for(;It--;)Vn[zn++]=arguments[++bt];return Oi(Fn,wt?Tt:this,Vn)}}(l,p,y,E);else var At=function(qe,Qe,Tt){var pt=1&Qe,wt=fr(qe);return function Rt(){var zt=this&&this!==Ln&&this instanceof Rt?wt:qe;return zt.apply(pt?Tt:this,arguments)}}(l,p,y);return Bp((mt?Pp:Fp)(At,vt),l,p)}function gh(l,p,y,E){return l===void 0||vr(l,ur[y])&&!an.call(E,y)?p:l}function Yr(l,p,y,E,P,H){return Dn(l)&&Dn(p)&&(H.set(p,l),jt(l,p,void 0,Yr,H),H.delete(p)),l}function wa(l){return Ma(l)?void 0:l}function bi(l,p,y,E,P,H){var te=1&y,ue=l.length,ve=p.length;if(ue!=ve&&!(te&&ve>ue))return!1;var Ge=H.get(l),He=H.get(p);if(Ge&&He)return Ge==p&&He==l;var Ke=-1,mt=!0,vt=2&y?new cr:void 0;for(H.set(l,p),H.set(p,l);++Ke<ue;){var At=l[Ke],qe=p[Ke];if(E)var Qe=te?E(qe,At,Ke,p,l,H):E(At,qe,Ke,l,p,H);if(Qe!==void 0){if(Qe)continue;mt=!1;break}if(vt){if(!_u(p,function(Tt,pt){if(!ha(vt,pt)&&(At===Tt||P(At,Tt,y,E,H)))return vt.push(pt)})){mt=!1;break}}else if(At!==qe&&!P(At,qe,y,E,H)){mt=!1;break}}return H.delete(l),H.delete(p),mt}function qr(l){return Oc(Dp(l,void 0,Fc),l+"")}function Ni(l){return ji(l,hi,mr)}function Os(l){return ji(l,mi,Fs)}var $n=lo?function(l){return lo.get(l)}:Ca;function Ds(l){for(var p=l.name+"",y=lr[p],E=an.call(lr,p)?y.length:0;E--;){var P=y[E],H=P.func;if(H==null||H==l)return P.name}return p}function Or(l){return(an.call(w,"placeholder")?w:l).placeholder}function Mt(){var l=w.iteratee||hl;return l=l===hl?Ep:l,arguments.length?l(arguments[0],arguments[1]):l}function Ta(l,p){var y,E,P=l.__data__;return((E=typeof(y=p))=="string"||E=="number"||E=="symbol"||E=="boolean"?y!=="__proto__":y===null)?P[typeof p=="string"?"string":"hash"]:P.map}function Cc(l){for(var p=hi(l),y=p.length;y--;){var E=p[y],P=l[E];p[y]=[E,P,Lp(P)]}return p}function Ns(l,p){var y=function(E,P){return E==null?void 0:E[P]}(l,p);return fa(y)?y:void 0}var mr=cc?function(l){return l==null?[]:(l=_n(l),kr(cc(l),function(p){return Tp.call(l,p)}))}:dl,Fs=cc?function(l){for(var p=[];l;)so(p,mr(l)),l=Ru(l);return p}:dl,ai=Ai;function Sa(l,p,y){for(var E=-1,P=(p=Lr(p,l)).length,H=!1;++E<P;){var te=gr(p[E]);if(!(H=l!=null&&y(l,te)))break;l=l[te]}return H||++E!=P?H:!!(P=l==null?0:l.length)&&tl(P)&&Pi(te,P)&&(Ft(l)||qo(l))}function Ic(l){return typeof l.constructor!="function"||vh(l)?{}:ko(Ru(l))}function km(l){return Ft(l)||qo(l)||!!(bs&&l&&l[bs])}function Pi(l,p){var y=typeof l;return!!(p=p==null?9007199254740991:p)&&(y=="number"||y!="symbol"&&np.test(l))&&l>-1&&l%1==0&&l<p}function Ct(l,p,y){if(!Dn(y))return!1;var E=typeof p;return!!(E=="number"?Wi(y)&&Pi(p,y.length):E=="string"&&p in y)&&vr(y[p],l)}function lt(l,p){if(Ft(l))return!1;var y=typeof l;return!(y!="number"&&y!="symbol"&&y!="boolean"&&l!=null&&!rr(l))||xn.test(l)||!In.test(l)||p!=null&&l in _n(p)}function nr(l){var p=Ds(l),y=w[p];if(typeof y!="function"||!(p in kt.prototype))return!1;if(l===y)return!0;var E=$n(y);return!!E&&l===E[0]}(sh&&ai(new sh(new ArrayBuffer(1)))!=Ze||ua&&ai(new ua)!=A||Nu&&ai(Nu.resolve())!="[object Promise]"||Ts&&ai(new Ts)!=G||$e&&ai(new $e)!=Je)&&(ai=function(l){var p=Ai(l),y=p==z?l.constructor:void 0,E=y?Xo(y):"";if(E)switch(E){case Um:return Ze;case qn:return A;case pc:return"[object Promise]";case cn:return G;case Ar:return Je}return p});var Gm=ih?Dr:Ia;function vh(l){var p=l&&l.constructor;return l===(typeof p=="function"&&p.prototype||ur)}function Lp(l){return l==l&&!Dn(l)}function Op(l,p){return function(y){return y!=null&&y[l]===p&&(p!==void 0||l in _n(y))}}function Dp(l,p,y){return p=wn(p===void 0?l.length-1:p,0),function(){for(var E=arguments,P=-1,H=wn(E.length-p,0),te=ut(H);++P<H;)te[P]=E[p+P];P=-1;for(var ue=ut(p+1);++P<p;)ue[P]=E[P];return ue[p]=y(te),Oi(l,this,ue)}}function Np(l,p){return p.length<2?l:Wr(l,Gn(p,0,-1))}function Hm(l,p){for(var y=l.length,E=Qn(p.length,y),P=si(l);E--;){var H=p[E];l[E]=Pi(H,y)?P[H]:void 0}return l}function Lc(l,p){if((p!=="constructor"||typeof l[p]!="function")&&p!="__proto__")return l[p]}var Fp=Up(Pp),_h=Bm||function(l,p){return Ln.setTimeout(l,p)},Oc=Up(fi);function Bp(l,p,y){var E=p+"";return Oc(l,function(P,H){var te=H.length;if(!te)return P;var ue=te-1;return H[ue]=(te>1?"& ":"")+H[ue],H=H.join(te>2?", ":" "),P.replace(Ei,`{
/* [wrapped with `+H+`] */
`)}(E,function(P,H){return Gi(ie,function(te){var ue="_."+te[0];H&te[1]&&!aa(P,ue)&&P.push(ue)}),P.sort()}(function(P){var H=P.match(ki);return H?H[1].split(Mr):[]}(E),y)))}function Up(l){var p=0,y=0;return function(){var E=Qi(),P=16-(E-y);if(y=E,P>0){if(++p>=800)return arguments[0]}else p=0;return l.apply(void 0,arguments)}}function Zu(l,p){var y=-1,E=l.length,P=E-1;for(p=p===void 0?E:p;++y<p;){var H=Vo(y,P),te=l[H];l[H]=l[y],l[y]=te}return l.length=p,l}var $u=function(l){var p=yh(l,function(E){return y.size===500&&y.clear(),E}),y=p.cache;return p}(function(l){var p=[];return l.charCodeAt(0)===46&&p.push(""),l.replace(fn,function(y,E,P,H){p.push(P?H.replace($d,"$1"):E||y)}),p});function gr(l){if(typeof l=="string"||rr(l))return l;var p=l+"";return p=="0"&&1/l==-1/0?"-0":p}function Xo(l){if(l!=null){try{return Eu.call(l)}catch{}try{return l+""}catch{}}return""}function kp(l){if(l instanceof kt)return l.clone();var p=new Rn(l.__wrapped__,l.__chain__);return p.__actions__=si(l.__actions__),p.__index__=l.__index__,p.__values__=l.__values__,p}var zm=Wt(function(l,p){return En(l)?Ho(l,ct(p,1,En,!0)):[]}),Gp=Wt(function(l,p){var y=ir(p);return En(y)&&(y=void 0),En(l)?Ho(l,ct(p,1,En,!0),Mt(y,2)):[]}),Hp=Wt(function(l,p){var y=ir(p);return En(y)&&(y=void 0),En(l)?Ho(l,ct(p,1,En,!0),void 0,y):[]});function Dc(l,p,y){var E=l==null?0:l.length;if(!E)return-1;var P=y==null?0:Xt(y);return P<0&&(P=wn(E+P,0)),Ka(l,Mt(p,3),P)}function Nc(l,p,y){var E=l==null?0:l.length;if(!E)return-1;var P=E-1;return y!==void 0&&(P=Xt(y),P=y<0?wn(E+P,0):Qn(P,E-1)),Ka(l,Mt(p,3),P,!0)}function Fc(l){return(l==null?0:l.length)?ct(l,1):[]}function Bc(l){return l&&l.length?l[0]:void 0}var Ea=Wt(function(l){var p=bn(l,va);return p.length&&p[0]===l[0]?vc(p):[]}),Fi=Wt(function(l){var p=ir(l),y=bn(l,va);return p===ir(y)?p=void 0:y.pop(),y.length&&y[0]===l[0]?vc(y,Mt(p,2)):[]}),Ri=Wt(function(l){var p=ir(l),y=bn(l,va);return(p=typeof p=="function"?p:void 0)&&y.pop(),y.length&&y[0]===l[0]?vc(y,void 0,p):[]});function ir(l){var p=l==null?0:l.length;return p?l[p-1]:void 0}var Vm=Wt(zp);function zp(l,p){return l&&l.length&&p&&p.length?Ir(l,p):l}var jm=qr(function(l,p){var y=l==null?0:l.length,E=lh(l,p);return Ps(l,bn(p,function(P){return Pi(P,y)?+P:P}).sort(Ip)),E});function Uc(l){return l==null?l:oh.call(l)}var Wm=Wt(function(l){return on(ct(l,1,En,!0))}),Xm=Wt(function(l){var p=ir(l);return En(p)&&(p=void 0),on(ct(l,1,En,!0),Mt(p,2))}),Ym=Wt(function(l){var p=ir(l);return p=typeof p=="function"?p:void 0,on(ct(l,1,En,!0),void 0,p)});function kc(l){if(!l||!l.length)return[];var p=0;return l=kr(l,function(y){if(En(y))return p=wn(y.length,p),!0}),wu(p,function(y){return bn(l,yu(y))})}function Vp(l,p){if(!l||!l.length)return[];var y=kc(l);return p==null?y:bn(y,function(E){return Oi(p,void 0,E)})}var qm=Wt(function(l,p){return En(l)?Ho(l,p):[]}),Zm=Wt(function(l){return Wu(kr(l,En))}),$m=Wt(function(l){var p=ir(l);return En(p)&&(p=void 0),Wu(kr(l,En),Mt(p,2))}),Jm=Wt(function(l){var p=ir(l);return p=typeof p=="function"?p:void 0,Wu(kr(l,En),void 0,p)}),Km=Wt(kc),Qm=Wt(function(l){var p=l.length,y=p>1?l[p-1]:void 0;return y=typeof y=="function"?(l.pop(),y):void 0,Vp(l,y)});function jp(l){var p=w(l);return p.__chain__=!0,p}function Ju(l,p){return p(l)}var eg=qr(function(l){var p=l.length,y=p?l[0]:0,E=this.__wrapped__,P=function(H){return lh(H,l)};return!(p>1||this.__actions__.length)&&E instanceof kt&&Pi(y)?((E=E.slice(y,+y+(p?1:0))).__actions__.push({func:Ju,args:[P],thisArg:void 0}),new Rn(E,this.__chain__).thru(function(H){return p&&!H.length&&H.push(void 0),H})):this.thru(P)}),tg=jo(function(l,p,y){an.call(l,y)?++l[y]:zr(l,y,1)}),ng=go(Dc),ig=go(Nc);function Wp(l,p){return(Ft(l)?Gi:Di)(l,Mt(p,3))}function Xp(l,p){return(Ft(l)?Ql:Bu)(l,Mt(p,3))}var rg=jo(function(l,p,y){an.call(l,y)?l[y].push(p):zr(l,y,[p])}),og=Wt(function(l,p,y){var E=-1,P=typeof p=="function",H=Wi(l)?ut(l.length):[];return Di(l,function(te){H[++E]=P?Oi(p,te,y):da(te,p,y)}),H}),sg=jo(function(l,p,y){zr(l,y,p)});function Ku(l,p){return(Ft(l)?bn:yc)(l,Mt(p,3))}var ag=jo(function(l,p,y){l[y?0:1].push(p)},function(){return[[],[]]}),hg=Wt(function(l,p){if(l==null)return[];var y=p.length;return y>1&&Ct(l,p[0],p[1])?p=[]:y>2&&Ct(p[0],p[1],p[2])&&(p=[p[0]]),Xr(l,ct(p,1),[])}),Qu=Fm||function(){return Ln.Date.now()};function Yp(l,p,y){return p=y?void 0:p,sn(l,128,void 0,void 0,void 0,void 0,p=l&&p==null?l.length:p)}function qp(l,p){var y;if(typeof p!="function")throw new zi(ne);return l=Xt(l),function(){return--l>0&&(y=p.apply(this,arguments)),l<=1&&(p=void 0),y}}var Gc=Wt(function(l,p,y){var E=1;if(y.length){var P=ao(y,Or(Gc));E|=32}return sn(l,E,p,y,P)}),Zp=Wt(function(l,p,y){var E=3;if(y.length){var P=ao(y,Or(Zp));E|=32}return sn(p,E,l,y,P)});function $p(l,p,y){var E,P,H,te,ue,ve,Ge=0,He=!1,Ke=!1,mt=!0;if(typeof l!="function")throw new zi(ne);function vt(wt){var Rt=E,zt=P;return E=P=void 0,Ge=wt,te=l.apply(zt,Rt)}function At(wt){return Ge=wt,ue=_h(Qe,p),He?vt(wt):te}function qe(wt){var Rt=wt-ve;return ve===void 0||Rt>=p||Rt<0||Ke&&wt-Ge>=H}function Qe(){var wt=Qu();if(qe(wt))return Tt(wt);ue=_h(Qe,function(Rt){var zt=p-(Rt-ve);return Ke?Qn(zt,H-(Rt-Ge)):zt}(wt))}function Tt(wt){return ue=void 0,mt&&E?vt(wt):(E=P=void 0,te)}function pt(){var wt=Qu(),Rt=qe(wt);if(E=arguments,P=this,ve=wt,Rt){if(ue===void 0)return At(ve);if(Ke)return Ec(ue),ue=_h(Qe,p),vt(ve)}return ue===void 0&&(ue=_h(Qe,p)),te}return p=or(p)||0,Dn(y)&&(He=!!y.leading,H=(Ke="maxWait"in y)?wn(or(y.maxWait)||0,p):H,mt="trailing"in y?!!y.trailing:mt),pt.cancel=function(){ue!==void 0&&Ec(ue),Ge=0,E=ve=P=ue=void 0},pt.flush=function(){return ue===void 0?te:Tt(Qu())},pt}var ug=Wt(function(l,p){return Fu(l,1,p)}),lg=Wt(function(l,p,y){return Fu(l,or(p)||0,y)});function yh(l,p){if(typeof l!="function"||p!=null&&typeof p!="function")throw new zi(ne);var y=function(){var E=arguments,P=p?p.apply(this,E):E[0],H=y.cache;if(H.has(P))return H.get(P);var te=l.apply(this,E);return y.cache=H.set(P,te)||H,te};return y.cache=new(yh.Cache||Vi),y}function xh(l){if(typeof l!="function")throw new zi(ne);return function(){var p=arguments;switch(p.length){case 0:return!l.call(this);case 1:return!l.call(this,p[0]);case 2:return!l.call(this,p[0],p[1]);case 3:return!l.call(this,p[0],p[1],p[2])}return!l.apply(this,p)}}yh.Cache=Vi;var Hc=Cp(function(l,p){var y=(p=p.length==1&&Ft(p[0])?bn(p[0],Hi(Mt())):bn(ct(p,1),Hi(Mt()))).length;return Wt(function(E){for(var P=-1,H=Qn(E.length,y);++P<H;)E[P]=p[P].call(this,E[P]);return Oi(l,this,E)})}),el=Wt(function(l,p){return sn(l,32,void 0,p,ao(p,Or(el)))}),Jp=Wt(function(l,p){return sn(l,64,void 0,p,ao(p,Or(Jp)))}),Yo=qr(function(l,p){return sn(l,256,void 0,void 0,void 0,p)});function vr(l,p){return l===p||l!=l&&p!=p}var cg=Ls(ku),Kp=Ls(function(l,p){return l>=p}),qo=As(function(){return arguments}())?As:function(l){return Nn(l)&&an.call(l,"callee")&&!Tp.call(l,"callee")},Ft=ut.isArray,dg=$l?Hi($l):function(l){return Nn(l)&&Ai(l)==dt};function Wi(l){return l!=null&&tl(l.length)&&!Dr(l)}function En(l){return Nn(l)&&Wi(l)}var _o=dc||Ia,Qp=Jl?Hi(Jl):function(l){return Nn(l)&&Ai(l)==Te};function zc(l){if(!Nn(l))return!1;var p=Ai(l);return p==Ne||p=="[object DOMException]"||typeof l.message=="string"&&typeof l.name=="string"&&!Ma(l)}function Dr(l){if(!Dn(l))return!1;var p=Ai(l);return p==Le||p==S||p=="[object AsyncFunction]"||p=="[object Proxy]"}function ef(l){return typeof l=="number"&&l==Xt(l)}function tl(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=9007199254740991}function Dn(l){var p=typeof l;return l!=null&&(p=="object"||p=="function")}function Nn(l){return l!=null&&typeof l=="object"}var tf=du?Hi(du):function(l){return Nn(l)&&ai(l)==A};function Vc(l){return typeof l=="number"||Nn(l)&&Ai(l)==I}function Ma(l){if(!Nn(l)||Ai(l)!=z)return!1;var p=Ru(l);if(p===null)return!0;var y=an.call(p,"constructor")&&p.constructor;return typeof y=="function"&&y instanceof y&&Eu.call(y)==Lm}var jc=pu?Hi(pu):function(l){return Nn(l)&&Ai(l)==L},nf=fu?Hi(fu):function(l){return Nn(l)&&ai(l)==G};function nl(l){return typeof l=="string"||!Ft(l)&&Nn(l)&&Ai(l)==j}function rr(l){return typeof l=="symbol"||Nn(l)&&Ai(l)==J}var Bs=mu?Hi(mu):function(l){return Nn(l)&&tl(l.length)&&!!ln[Ai(l)]},rf=Ls(Gu),pg=Ls(function(l,p){return l<=p});function of(l){if(!l)return[];if(Wi(l))return nl(l)?_i(l):si(l);if(Gr&&l[Gr])return function(y){for(var E,P=[];!(E=y.next()).done;)P.push(E.value);return P}(l[Gr]());var p=ai(l);return(p==A?Su:p==G?Fo:Zr)(l)}function yo(l){return l?(l=or(l))===1/0||l===-1/0?17976931348623157e292*(l<0?-1:1):l==l?l:0:l===0?l:0}function Xt(l){var p=yo(l),y=p%1;return p==p?y?p-y:p:0}function sf(l){return l?fo(Xt(l),0,4294967295):0}function or(l){if(typeof l=="number")return l;if(rr(l))return NaN;if(Dn(l)){var p=typeof l.valueOf=="function"?l.valueOf():l;l=Dn(p)?p+"":p}if(typeof l!="string")return l===0?l:+l;l=oc(l);var y=Qd.test(l);return y||tp.test(l)?cp(l.slice(2),y?2:8):Kd.test(l)?NaN:+l}function af(l){return Hn(l,mi(l))}function nn(l){return l==null?"":Zn(l)}var il=On(function(l,p){if(vh(p)||Wi(p))Hn(p,hi(p),l);else for(var y in p)an.call(p,y)&&Go(l,y,p[y])}),Wc=On(function(l,p){Hn(p,mi(p),l)}),rl=On(function(l,p,y,E){Hn(p,mi(p),l,E)}),fg=On(function(l,p,y,E){Hn(p,hi(p),l,E)}),hf=qr(lh),Xc=Wt(function(l,p){l=_n(l);var y=-1,E=p.length,P=E>2?p[2]:void 0;for(P&&Ct(p[0],p[1],P)&&(E=1);++y<E;)for(var H=p[y],te=mi(H),ue=-1,ve=te.length;++ue<ve;){var Ge=te[ue],He=l[Ge];(He===void 0||vr(He,ur[Ge])&&!an.call(l,Ge))&&(l[Ge]=H[Ge])}return l}),Us=Wt(function(l){return l.push(void 0,Yr),Oi(Aa,void 0,l)});function Yc(l,p,y){var E=l==null?void 0:Wr(l,p);return E===void 0?y:E}function bh(l,p){return l!=null&&Sa(l,p,gc)}var mg=qu(function(l,p,y){p!=null&&typeof p.toString!="function"&&(p=Mu.call(p)),l[p]=y},Ra(Bi)),gg=qu(function(l,p,y){p!=null&&typeof p.toString!="function"&&(p=Mu.call(p)),an.call(l,p)?l[p].push(y):l[p]=[y]},Mt),dn=Wt(da);function hi(l){return Wi(l)?co(l):_c(l)}function mi(l){return Wi(l)?co(l,!0):Mp(l)}var wh=On(function(l,p,y){jt(l,p,y)}),Aa=On(function(l,p,y,E){jt(l,p,y,E)}),ks=qr(function(l,p){var y={};if(l==null)return y;var E=!1;p=bn(p,function(H){return H=Lr(H,l),E||(E=H.length>1),H}),Hn(l,Os(l),y),E&&(y=oi(y,7,wa));for(var P=p.length;P--;)ga(y,p[P]);return y}),Jn=qr(function(l,p){return l==null?{}:function(y,E){return Hu(y,E,function(P,H){return bh(y,H)})}(l,p)});function xo(l,p){if(l==null)return{};var y=bn(Os(l),function(E){return[E]});return p=Mt(p),Hu(l,y,function(E,P){return p(E,P[0])})}var Th=mh(hi),Gs=mh(mi);function Zr(l){return l==null?[]:Tu(l,hi(l))}var Pa=Wo(function(l,p,y){return p=p.toLowerCase(),l+(y?Hs(p):p)});function Hs(l){return Mh(nn(l).toLowerCase())}function zs(l){return(l=nn(l))&&l.replace(lu,vp).replace(ap,"")}var Sh=Wo(function(l,p,y){return l+(y?"-":"")+p.toLowerCase()}),uf=Wo(function(l,p,y){return l+(y?" ":"")+p.toLowerCase()}),ol=Cs("toLowerCase"),Eh=Wo(function(l,p,y){return l+(y?"_":"")+p.toLowerCase()}),sl=Wo(function(l,p,y){return l+(y?" ":"")+Mh(p)}),lf=Wo(function(l,p,y){return l+(y?" ":"")+p.toUpperCase()}),Mh=Cs("toUpperCase");function qc(l,p,y){return l=nn(l),(p=y?void 0:p)===void 0?function(E){return hp.test(E)}(l)?function(E){return E.match(ro)||[]}(l):function(E){return E.match(Zd)||[]}(l):l.match(p)||[]}var Ah=Wt(function(l,p){try{return Oi(l,void 0,p)}catch(y){return zc(y)?y:new Zt(y)}}),al=qr(function(l,p){return Gi(p,function(y){y=gr(y),zr(l,y,Gc(l[y],l))}),l});function Ra(l){return function(){return l}}var cf=vo(),df=vo(!0);function Bi(l){return l}function hl(l){return Ep(typeof l=="function"?l:oi(l,1))}var pf=Wt(function(l,p){return function(y){return da(y,l,p)}}),vg=Wt(function(l,p){return function(y){return da(l,y,p)}});function ul(l,p,y){var E=hi(p),P=Cr(p,E);y!=null||Dn(p)&&(P.length||!E.length)||(y=p,p=l,l=this,P=Cr(p,hi(p)));var H=!(Dn(y)&&"chain"in y&&!y.chain),te=Dr(l);return Gi(P,function(ue){var ve=p[ue];l[ue]=ve,te&&(l.prototype[ue]=function(){var Ge=this.__chain__;if(H||Ge){var He=l(this.__wrapped__),Ke=He.__actions__=si(this.__actions__);return Ke.push({func:ve,args:arguments,thisArg:l}),He.__chain__=Ge,He}return ve.apply(l,so([this.value()],arguments))})}),l}function Ca(){}var ll=xa(bn),Zo=xa(ec),ff=xa(_u);function mf(l){return lt(l)?yu(gr(l)):function(p){return function(y){return Wr(y,p)}}(l)}var cl=ph(),gf=ph(!0);function dl(){return[]}function Ia(){return!1}var Ph=ya(function(l,p){return l+p},0),Zc=ba("ceil"),gi=ya(function(l,p){return l/p},1),vf=ba("floor"),pl,_f=ya(function(l,p){return l*p},1),$c=ba("round"),fl=ya(function(l,p){return l-p},0);return w.after=function(l,p){if(typeof p!="function")throw new zi(ne);return l=Xt(l),function(){if(--l<1)return p.apply(this,arguments)}},w.ary=Yp,w.assign=il,w.assignIn=Wc,w.assignInWith=rl,w.assignWith=fg,w.at=hf,w.before=qp,w.bind=Gc,w.bindAll=al,w.bindKey=Zp,w.castArray=function(){if(!arguments.length)return[];var l=arguments[0];return Ft(l)?l:[l]},w.chain=jp,w.chunk=function(l,p,y){p=(y?Ct(l,p,y):p===void 0)?1:wn(Xt(p),0);var E=l==null?0:l.length;if(!E||p<1)return[];for(var P=0,H=0,te=ut(Iu(E/p));P<E;)te[H++]=Gn(l,P,P+=p);return te},w.compact=function(l){for(var p=-1,y=l==null?0:l.length,E=0,P=[];++p<y;){var H=l[p];H&&(P[E++]=H)}return P},w.concat=function(){var l=arguments.length;if(!l)return[];for(var p=ut(l-1),y=arguments[0],E=l;E--;)p[E-1]=arguments[E];return so(Ft(y)?si(y):[y],ct(p,1))},w.cond=function(l){var p=l==null?0:l.length,y=Mt();return l=p?bn(l,function(E){if(typeof E[1]!="function")throw new zi(ne);return[y(E[0]),E[1]]}):[],Wt(function(E){for(var P=-1;++P<p;){var H=l[P];if(Oi(H[0],this,E))return Oi(H[1],this,E)}})},w.conforms=function(l){return function(p){var y=hi(p);return function(E){return Vr(E,p,y)}}(oi(l,1))},w.constant=Ra,w.countBy=tg,w.create=function(l,p){var y=ko(l);return p==null?y:Sp(y,p)},w.curry=function l(p,y,E){var P=sn(p,8,void 0,void 0,void 0,void 0,void 0,y=E?void 0:y);return P.placeholder=l.placeholder,P},w.curryRight=function l(p,y,E){var P=sn(p,16,void 0,void 0,void 0,void 0,void 0,y=E?void 0:y);return P.placeholder=l.placeholder,P},w.debounce=$p,w.defaults=Xc,w.defaultsDeep=Us,w.defer=ug,w.delay=lg,w.difference=zm,w.differenceBy=Gp,w.differenceWith=Hp,w.drop=function(l,p,y){var E=l==null?0:l.length;return E?Gn(l,(p=y||p===void 0?1:Xt(p))<0?0:p,E):[]},w.dropRight=function(l,p,y){var E=l==null?0:l.length;return E?Gn(l,0,(p=E-(p=y||p===void 0?1:Xt(p)))<0?0:p):[]},w.dropRightWhile=function(l,p){return l&&l.length?dh(l,Mt(p,3),!0,!0):[]},w.dropWhile=function(l,p){return l&&l.length?dh(l,Mt(p,3),!0):[]},w.fill=function(l,p,y,E){var P=l==null?0:l.length;return P?(y&&typeof y!="number"&&Ct(l,p,y)&&(y=0,E=P),function(H,te,ue,ve){var Ge=H.length;for((ue=Xt(ue))<0&&(ue=-ue>Ge?0:Ge+ue),(ve=ve===void 0||ve>Ge?Ge:Xt(ve))<0&&(ve+=Ge),ve=ue>ve?0:sf(ve);ue<ve;)H[ue++]=te;return H}(l,p,y,E)):[]},w.filter=function(l,p){return(Ft(l)?kr:mo)(l,Mt(p,3))},w.flatMap=function(l,p){return ct(Ku(l,p),1)},w.flatMapDeep=function(l,p){return ct(Ku(l,p),1/0)},w.flatMapDepth=function(l,p,y){return y=y===void 0?1:Xt(y),ct(Ku(l,p),y)},w.flatten=Fc,w.flattenDeep=function(l){return(l==null?0:l.length)?ct(l,1/0):[]},w.flattenDepth=function(l,p){return(l==null?0:l.length)?ct(l,p=p===void 0?1:Xt(p)):[]},w.flip=function(l){return sn(l,512)},w.flow=cf,w.flowRight=df,w.fromPairs=function(l){for(var p=-1,y=l==null?0:l.length,E={};++p<y;){var P=l[p];E[P[0]]=P[1]}return E},w.functions=function(l){return l==null?[]:Cr(l,hi(l))},w.functionsIn=function(l){return l==null?[]:Cr(l,mi(l))},w.groupBy=rg,w.initial=function(l){return(l==null?0:l.length)?Gn(l,0,-1):[]},w.intersection=Ea,w.intersectionBy=Fi,w.intersectionWith=Ri,w.invert=mg,w.invertBy=gg,w.invokeMap=og,w.iteratee=hl,w.keyBy=sg,w.keys=hi,w.keysIn=mi,w.map=Ku,w.mapKeys=function(l,p){var y={};return p=Mt(p,3),jr(l,function(E,P,H){zr(y,p(E,P,H),E)}),y},w.mapValues=function(l,p){var y={};return p=Mt(p,3),jr(l,function(E,P,H){zr(y,P,p(E,P,H))}),y},w.matches=function(l){return Ap(oi(l,1))},w.matchesProperty=function(l,p){return xc(l,oi(p,1))},w.memoize=yh,w.merge=wh,w.mergeWith=Aa,w.method=pf,w.methodOf=vg,w.mixin=ul,w.negate=xh,w.nthArg=function(l){return l=Xt(l),Wt(function(p){return pr(p,l)})},w.omit=ks,w.omitBy=function(l,p){return xo(l,xh(Mt(p)))},w.once=function(l){return qp(2,l)},w.orderBy=function(l,p,y,E){return l==null?[]:(Ft(p)||(p=p==null?[]:[p]),Ft(y=E?void 0:y)||(y=y==null?[]:[y]),Xr(l,p,y))},w.over=ll,w.overArgs=Hc,w.overEvery=Zo,w.overSome=ff,w.partial=el,w.partialRight=Jp,w.partition=ag,w.pick=Jn,w.pickBy=xo,w.property=mf,w.propertyOf=function(l){return function(p){return l==null?void 0:Wr(l,p)}},w.pull=Vm,w.pullAll=zp,w.pullAllBy=function(l,p,y){return l&&l.length&&p&&p.length?Ir(l,p,Mt(y,2)):l},w.pullAllWith=function(l,p,y){return l&&l.length&&p&&p.length?Ir(l,p,void 0,y):l},w.pullAt=jm,w.range=cl,w.rangeRight=gf,w.rearg=Yo,w.reject=function(l,p){return(Ft(l)?kr:mo)(l,xh(Mt(p,3)))},w.remove=function(l,p){var y=[];if(!l||!l.length)return y;var E=-1,P=[],H=l.length;for(p=Mt(p,3);++E<H;){var te=l[E];p(te,E,l)&&(y.push(te),P.push(E))}return Ps(l,P),y},w.rest=function(l,p){if(typeof l!="function")throw new zi(ne);return Wt(l,p=p===void 0?p:Xt(p))},w.reverse=Uc,w.sampleSize=function(l,p,y){return p=(y?Ct(l,p,y):p===void 0)?1:Xt(p),(Ft(l)?Es:wc)(l,p)},w.set=function(l,p,y){return l==null?l:Sn(l,p,y)},w.setWith=function(l,p,y,E){return E=typeof E=="function"?E:void 0,l==null?l:Sn(l,p,y,E)},w.shuffle=function(l){return(Ft(l)?uh:Rp)(l)},w.slice=function(l,p,y){var E=l==null?0:l.length;return E?(y&&typeof y!="number"&&Ct(l,p,y)?(p=0,y=E):(p=p==null?0:Xt(p),y=y===void 0?E:Xt(y)),Gn(l,p,y)):[]},w.sortBy=hg,w.sortedUniq=function(l){return l&&l.length?ju(l):[]},w.sortedUniqBy=function(l,p){return l&&l.length?ju(l,Mt(p,2)):[]},w.split=function(l,p,y){return y&&typeof y!="number"&&Ct(l,p,y)&&(p=y=void 0),(y=y===void 0?4294967295:y>>>0)?(l=nn(l))&&(typeof p=="string"||p!=null&&!jc(p))&&!(p=Zn(p))&&ys(l)?rt(_i(l),0,y):l.split(p,y):[]},w.spread=function(l,p){if(typeof l!="function")throw new zi(ne);return p=p==null?0:wn(Xt(p),0),Wt(function(y){var E=y[p],P=rt(y,0,p);return E&&so(P,E),Oi(l,this,P)})},w.tail=function(l){var p=l==null?0:l.length;return p?Gn(l,1,p):[]},w.take=function(l,p,y){return l&&l.length?Gn(l,0,(p=y||p===void 0?1:Xt(p))<0?0:p):[]},w.takeRight=function(l,p,y){var E=l==null?0:l.length;return E?Gn(l,(p=E-(p=y||p===void 0?1:Xt(p)))<0?0:p,E):[]},w.takeRightWhile=function(l,p){return l&&l.length?dh(l,Mt(p,3),!1,!0):[]},w.takeWhile=function(l,p){return l&&l.length?dh(l,Mt(p,3)):[]},w.tap=function(l,p){return p(l),l},w.throttle=function(l,p,y){var E=!0,P=!0;if(typeof l!="function")throw new zi(ne);return Dn(y)&&(E="leading"in y?!!y.leading:E,P="trailing"in y?!!y.trailing:P),$p(l,p,{leading:E,maxWait:p,trailing:P})},w.thru=Ju,w.toArray=of,w.toPairs=Th,w.toPairsIn=Gs,w.toPath=function(l){return Ft(l)?bn(l,gr):rr(l)?[l]:si($u(nn(l)))},w.toPlainObject=af,w.transform=function(l,p,y){var E=Ft(l),P=E||_o(l)||Bs(l);if(p=Mt(p,4),y==null){var H=l&&l.constructor;y=P?E?new H:[]:Dn(l)&&Dr(H)?ko(Ru(l)):{}}return(P?Gi:jr)(l,function(te,ue,ve){return p(y,te,ue,ve)}),y},w.unary=function(l){return Yp(l,1)},w.union=Wm,w.unionBy=Xm,w.unionWith=Ym,w.uniq=function(l){return l&&l.length?on(l):[]},w.uniqBy=function(l,p){return l&&l.length?on(l,Mt(p,2)):[]},w.uniqWith=function(l,p){return p=typeof p=="function"?p:void 0,l&&l.length?on(l,void 0,p):[]},w.unset=function(l,p){return l==null||ga(l,p)},w.unzip=kc,w.unzipWith=Vp,w.update=function(l,p,y){return l==null?l:Yt(l,p,Xu(y))},w.updateWith=function(l,p,y,E){return E=typeof E=="function"?E:void 0,l==null?l:Yt(l,p,Xu(y),E)},w.values=Zr,w.valuesIn=function(l){return l==null?[]:Tu(l,mi(l))},w.without=qm,w.words=qc,w.wrap=function(l,p){return el(Xu(p),l)},w.xor=Zm,w.xorBy=$m,w.xorWith=Jm,w.zip=Km,w.zipObject=function(l,p){return Sc(l||[],p||[],Go)},w.zipObjectDeep=function(l,p){return Sc(l||[],p||[],Sn)},w.zipWith=Qm,w.entries=Th,w.entriesIn=Gs,w.extend=Wc,w.extendWith=rl,ul(w,w),w.add=Ph,w.attempt=Ah,w.camelCase=Pa,w.capitalize=Hs,w.ceil=Zc,w.clamp=function(l,p,y){return y===void 0&&(y=p,p=void 0),y!==void 0&&(y=(y=or(y))==y?y:0),p!==void 0&&(p=(p=or(p))==p?p:0),fo(or(l),p,y)},w.clone=function(l){return oi(l,4)},w.cloneDeep=function(l){return oi(l,5)},w.cloneDeepWith=function(l,p){return oi(l,5,p=typeof p=="function"?p:void 0)},w.cloneWith=function(l,p){return oi(l,4,p=typeof p=="function"?p:void 0)},w.conformsTo=function(l,p){return p==null||Vr(l,p,hi(p))},w.deburr=zs,w.defaultTo=function(l,p){return l==null||l!=l?p:l},w.divide=gi,w.endsWith=function(l,p,y){l=nn(l),p=Zn(p);var E=l.length,P=y=y===void 0?E:fo(Xt(y),0,E);return(y-=p.length)>=0&&l.slice(y,P)==p},w.eq=vr,w.escape=function(l){return(l=nn(l))&&Kt.test(l)?l.replace(Jt,_p):l},w.escapeRegExp=function(l){return(l=nn(l))&&vn.test(l)?l.replace(Wn,"\\$&"):l},w.every=function(l,p,y){var E=Ft(l)?ec:Uu;return y&&Ct(l,p,y)&&(p=void 0),E(l,Mt(p,3))},w.find=ng,w.findIndex=Dc,w.findKey=function(l,p){return tc(l,Mt(p,3),jr)},w.findLast=ig,w.findLastIndex=Nc,w.findLastKey=function(l,p){return tc(l,Mt(p,3),mc)},w.floor=vf,w.forEach=Wp,w.forEachRight=Xp,w.forIn=function(l,p){return l==null?l:zo(l,Mt(p,3),mi)},w.forInRight=function(l,p){return l==null?l:dr(l,Mt(p,3),mi)},w.forOwn=function(l,p){return l&&jr(l,Mt(p,3))},w.forOwnRight=function(l,p){return l&&mc(l,Mt(p,3))},w.get=Yc,w.gt=cg,w.gte=Kp,w.has=function(l,p){return l!=null&&Sa(l,p,Ms)},w.hasIn=bh,w.head=Bc,w.identity=Bi,w.includes=function(l,p,y,E){l=Wi(l)?l:Zr(l),y=y&&!E?Xt(y):0;var P=l.length;return y<0&&(y=wn(P+y,0)),nl(l)?y<=P&&l.indexOf(p,y)>-1:!!P&&_s(l,p,y)>-1},w.indexOf=function(l,p,y){var E=l==null?0:l.length;if(!E)return-1;var P=y==null?0:Xt(y);return P<0&&(P=wn(E+P,0)),_s(l,p,P)},w.inRange=function(l,p,y){return p=yo(p),y===void 0?(y=p,p=0):y=yo(y),function(E,P,H){return E>=Qn(P,H)&&E<wn(P,H)}(l=or(l),p,y)},w.invoke=dn,w.isArguments=qo,w.isArray=Ft,w.isArrayBuffer=dg,w.isArrayLike=Wi,w.isArrayLikeObject=En,w.isBoolean=function(l){return l===!0||l===!1||Nn(l)&&Ai(l)==re},w.isBuffer=_o,w.isDate=Qp,w.isElement=function(l){return Nn(l)&&l.nodeType===1&&!Ma(l)},w.isEmpty=function(l){if(l==null)return!0;if(Wi(l)&&(Ft(l)||typeof l=="string"||typeof l.splice=="function"||_o(l)||Bs(l)||qo(l)))return!l.length;var p=ai(l);if(p==A||p==G)return!l.size;if(vh(l))return!_c(l).length;for(var y in l)if(an.call(l,y))return!1;return!0},w.isEqual=function(l,p){return er(l,p)},w.isEqualWith=function(l,p,y){var E=(y=typeof y=="function"?y:void 0)?y(l,p):void 0;return E===void 0?er(l,p,void 0,y):!!E},w.isError=zc,w.isFinite=function(l){return typeof l=="number"&&uo(l)},w.isFunction=Dr,w.isInteger=ef,w.isLength=tl,w.isMap=tf,w.isMatch=function(l,p){return l===p||pa(l,p,Cc(p))},w.isMatchWith=function(l,p,y){return y=typeof y=="function"?y:void 0,pa(l,p,Cc(p),y)},w.isNaN=function(l){return Vc(l)&&l!=+l},w.isNative=function(l){if(Gm(l))throw new Zt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return fa(l)},w.isNil=function(l){return l==null},w.isNull=function(l){return l===null},w.isNumber=Vc,w.isObject=Dn,w.isObjectLike=Nn,w.isPlainObject=Ma,w.isRegExp=jc,w.isSafeInteger=function(l){return ef(l)&&l>=-9007199254740991&&l<=9007199254740991},w.isSet=nf,w.isString=nl,w.isSymbol=rr,w.isTypedArray=Bs,w.isUndefined=function(l){return l===void 0},w.isWeakMap=function(l){return Nn(l)&&ai(l)==Je},w.isWeakSet=function(l){return Nn(l)&&Ai(l)=="[object WeakSet]"},w.join=function(l,p){return l==null?"":yi.call(l,p)},w.kebabCase=Sh,w.last=ir,w.lastIndexOf=function(l,p,y){var E=l==null?0:l.length;if(!E)return-1;var P=E;return y!==void 0&&(P=(P=Xt(y))<0?wn(E+P,0):Qn(P,E-1)),p==p?function(H,te,ue){for(var ve=ue+1;ve--;)if(H[ve]===te)return ve;return ve}(l,p,P):Ka(l,nc,P,!0)},w.lowerCase=uf,w.lowerFirst=ol,w.lt=rf,w.lte=pg,w.max=function(l){return l&&l.length?ca(l,Bi,ku):void 0},w.maxBy=function(l,p){return l&&l.length?ca(l,Mt(p,2),ku):void 0},w.mean=function(l){return ic(l,Bi)},w.meanBy=function(l,p){return ic(l,Mt(p,2))},w.min=function(l){return l&&l.length?ca(l,Bi,Gu):void 0},w.minBy=function(l,p){return l&&l.length?ca(l,Mt(p,2),Gu):void 0},w.stubArray=dl,w.stubFalse=Ia,w.stubObject=function(){return{}},w.stubString=function(){return""},w.stubTrue=function(){return!0},w.multiply=_f,w.nth=function(l,p){return l&&l.length?pr(l,Xt(p)):void 0},w.noConflict=function(){return Ln._===this&&(Ln._=Om),this},w.noop=Ca,w.now=Qu,w.pad=function(l,p,y){l=nn(l);var E=(p=Xt(p))?ho(l):0;if(!p||E>=p)return l;var P=(p-E)/2;return Is(Lu(P),y)+l+Is(Iu(P),y)},w.padEnd=function(l,p,y){l=nn(l);var E=(p=Xt(p))?ho(l):0;return p&&E<p?l+Is(p-E,y):l},w.padStart=function(l,p,y){l=nn(l);var E=(p=Xt(p))?ho(l):0;return p&&E<p?Is(p-E,y)+l:l},w.parseInt=function(l,p,y){return y||p==null?p=0:p&&(p=+p),xi(nn(l).replace(ri,""),p||0)},w.random=function(l,p,y){if(y&&typeof y!="boolean"&&Ct(l,p,y)&&(p=y=void 0),y===void 0&&(typeof p=="boolean"?(y=p,p=void 0):typeof l=="boolean"&&(y=l,l=void 0)),l===void 0&&p===void 0?(l=0,p=1):(l=yo(l),p===void 0?(p=l,l=0):p=yo(p)),l>p){var E=l;l=p,p=E}if(y||l%1||p%1){var P=Du();return Qn(l+P*(p-l+$i("1e-"+((P+"").length-1))),p)}return Vo(l,p)},w.reduce=function(l,p,y){var E=Ft(l)?vu:rc,P=arguments.length<3;return E(l,Mt(p,4),y,P,Di)},w.reduceRight=function(l,p,y){var E=Ft(l)?pp:rc,P=arguments.length<3;return E(l,Mt(p,4),y,P,Bu)},w.repeat=function(l,p,y){return p=(y?Ct(l,p,y):p===void 0)?1:Xt(p),zu(nn(l),p)},w.replace=function(){var l=arguments,p=nn(l[0]);return l.length<3?p:p.replace(l[1],l[2])},w.result=function(l,p,y){var E=-1,P=(p=Lr(p,l)).length;for(P||(P=1,l=void 0);++E<P;){var H=l==null?void 0:l[gr(p[E])];H===void 0&&(E=P,H=y),l=Dr(H)?H.call(l):H}return l},w.round=$c,w.runInContext=be,w.sample=function(l){return(Ft(l)?po:bc)(l)},w.size=function(l){if(l==null)return 0;if(Wi(l))return nl(l)?ho(l):l.length;var p=ai(l);return p==A||p==G?l.size:_c(l).length},w.snakeCase=Eh,w.some=function(l,p,y){var E=Ft(l)?_u:Vu;return y&&Ct(l,p,y)&&(p=void 0),E(l,Mt(p,3))},w.sortedIndex=function(l,p){return ma(l,p)},w.sortedIndexBy=function(l,p,y){return ch(l,p,Mt(y,2))},w.sortedIndexOf=function(l,p){var y=l==null?0:l.length;if(y){var E=ma(l,p);if(E<y&&vr(l[E],p))return E}return-1},w.sortedLastIndex=function(l,p){return ma(l,p,!0)},w.sortedLastIndexBy=function(l,p,y){return ch(l,p,Mt(y,2),!0)},w.sortedLastIndexOf=function(l,p){if(l==null?0:l.length){var y=ma(l,p,!0)-1;if(vr(l[y],p))return y}return-1},w.startCase=sl,w.startsWith=function(l,p,y){return l=nn(l),y=y==null?0:fo(Xt(y),0,l.length),p=Zn(p),l.slice(y,y+p.length)==p},w.subtract=fl,w.sum=function(l){return l&&l.length?bu(l,Bi):0},w.sumBy=function(l,p){return l&&l.length?bu(l,Mt(p,2)):0},w.template=function(l,p,y){var E=w.templateSettings;y&&Ct(l,p,y)&&(p=void 0),l=nn(l),p=rl({},p,E,gh);var P,H,te=rl({},p.imports,E.imports,gh),ue=hi(te),ve=Tu(te,ue),Ge=0,He=p.interpolate||Lo,Ke="__p += '",mt=th((p.escape||Lo).source+"|"+He.source+"|"+(He===yt?Jd:Lo).source+"|"+(p.evaluate||Lo).source+"|$","g"),vt="//# sourceURL="+(an.call(p,"sourceURL")?(p.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++lp+"]")+`
`;l.replace(mt,function(Qe,Tt,pt,wt,Rt,zt){return pt||(pt=wt),Ke+=l.slice(Ge,zt).replace(Wa,yp),Tt&&(P=!0,Ke+=`' +
__e(`+Tt+`) +
'`),Rt&&(H=!0,Ke+=`';
`+Rt+`;
__p += '`),pt&&(Ke+=`' +
((__t = (`+pt+`)) == null ? '' : __t) +
'`),Ge=zt+Qe.length,Qe}),Ke+=`';
`;var At=an.call(p,"variable")&&p.variable;if(At){if(ja.test(At))throw new Zt("Invalid `variable` option passed into `_.template`")}else Ke=`with (obj) {
`+Ke+`
}
`;Ke=(H?Ke.replace(Be,""):Ke).replace(Xe,"$1").replace(ot,"$1;"),Ke="function("+(At||"obj")+`) {
`+(At?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(P?", __e = _.escape":"")+(H?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Ke+`return __p
}`;var qe=Ah(function(){return kn(ue,vt+"return "+Ke).apply(void 0,ve)});if(qe.source=Ke,zc(qe))throw qe;return qe},w.times=function(l,p){if((l=Xt(l))<1||l>9007199254740991)return[];var y=4294967295,E=Qn(l,4294967295);l-=4294967295;for(var P=wu(E,p=Mt(p));++y<l;)p(y);return P},w.toFinite=yo,w.toInteger=Xt,w.toLength=sf,w.toLower=function(l){return nn(l).toLowerCase()},w.toNumber=or,w.toSafeInteger=function(l){return l?fo(Xt(l),-9007199254740991,9007199254740991):l===0?l:0},w.toString=nn,w.toUpper=function(l){return nn(l).toUpperCase()},w.trim=function(l,p,y){if((l=nn(l))&&(y||p===void 0))return oc(l);if(!l||!(p=Zn(p)))return l;var E=_i(l),P=_i(p);return rt(E,sc(E,P),ac(E,P)+1).join("")},w.trimEnd=function(l,p,y){if((l=nn(l))&&(y||p===void 0))return l.slice(0,Bo(l)+1);if(!l||!(p=Zn(p)))return l;var E=_i(l);return rt(E,0,ac(E,_i(p))+1).join("")},w.trimStart=function(l,p,y){if((l=nn(l))&&(y||p===void 0))return l.replace(ri,"");if(!l||!(p=Zn(p)))return l;var E=_i(l);return rt(E,sc(E,_i(p))).join("")},w.truncate=function(l,p){var y=30,E="...";if(Dn(p)){var P="separator"in p?p.separator:P;y="length"in p?Xt(p.length):y,E="omission"in p?Zn(p.omission):E}var H=(l=nn(l)).length;if(ys(l)){var te=_i(l);H=te.length}if(y>=H)return l;var ue=y-ho(E);if(ue<1)return E;var ve=te?rt(te,0,ue).join(""):l.slice(0,ue);if(P===void 0)return ve+E;if(te&&(ue+=ve.length-ue),jc(P)){if(l.slice(ue).search(P)){var Ge,He=ve;for(P.global||(P=th(P.source,nn(io.exec(P))+"g")),P.lastIndex=0;Ge=P.exec(He);)var Ke=Ge.index;ve=ve.slice(0,Ke===void 0?ue:Ke)}}else if(l.indexOf(Zn(P),ue)!=ue){var mt=ve.lastIndexOf(P);mt>-1&&(ve=ve.slice(0,mt))}return ve+E},w.unescape=function(l){return(l=nn(l))&&st.test(l)?l.replace(nt,eh):l},w.uniqueId=function(l){var p=++Im;return nn(l)+p},w.upperCase=lf,w.upperFirst=Mh,w.each=Wp,w.eachRight=Xp,w.first=Bc,ul(w,(pl={},jr(w,function(l,p){an.call(w.prototype,p)||(pl[p]=l)}),pl),{chain:!1}),w.VERSION="4.17.21",Gi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){w[l].placeholder=w}),Gi(["drop","take"],function(l,p){kt.prototype[l]=function(y){y=y===void 0?1:wn(Xt(y),0);var E=this.__filtered__&&!p?new kt(this):this.clone();return E.__filtered__?E.__takeCount__=Qn(y,E.__takeCount__):E.__views__.push({size:Qn(y,4294967295),type:l+(E.__dir__<0?"Right":"")}),E},kt.prototype[l+"Right"]=function(y){return this.reverse()[l](y).reverse()}}),Gi(["filter","map","takeWhile"],function(l,p){var y=p+1,E=y==1||y==3;kt.prototype[l]=function(P){var H=this.clone();return H.__iteratees__.push({iteratee:Mt(P,3),type:y}),H.__filtered__=H.__filtered__||E,H}}),Gi(["head","last"],function(l,p){var y="take"+(p?"Right":"");kt.prototype[l]=function(){return this[y](1).value()[0]}}),Gi(["initial","tail"],function(l,p){var y="drop"+(p?"":"Right");kt.prototype[l]=function(){return this.__filtered__?new kt(this):this[y](1)}}),kt.prototype.compact=function(){return this.filter(Bi)},kt.prototype.find=function(l){return this.filter(l).head()},kt.prototype.findLast=function(l){return this.reverse().find(l)},kt.prototype.invokeMap=Wt(function(l,p){return typeof l=="function"?new kt(this):this.map(function(y){return da(y,l,p)})}),kt.prototype.reject=function(l){return this.filter(xh(Mt(l)))},kt.prototype.slice=function(l,p){l=Xt(l);var y=this;return y.__filtered__&&(l>0||p<0)?new kt(y):(l<0?y=y.takeRight(-l):l&&(y=y.drop(l)),p!==void 0&&(y=(p=Xt(p))<0?y.dropRight(-p):y.take(p-l)),y)},kt.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},kt.prototype.toArray=function(){return this.take(4294967295)},jr(kt.prototype,function(l,p){var y=/^(?:filter|find|map|reject)|While$/.test(p),E=/^(?:head|last)$/.test(p),P=w[E?"take"+(p=="last"?"Right":""):p],H=E||/^find/.test(p);P&&(w.prototype[p]=function(){var te=this.__wrapped__,ue=E?[1]:arguments,ve=te instanceof kt,Ge=ue[0],He=ve||Ft(te),Ke=function(Tt){var pt=P.apply(w,so([Tt],ue));return E&&mt?pt[0]:pt};He&&y&&typeof Ge=="function"&&Ge.length!=1&&(ve=He=!1);var mt=this.__chain__,vt=!!this.__actions__.length,At=H&&!mt,qe=ve&&!vt;if(!H&&He){te=qe?te:new kt(this);var Qe=l.apply(te,ue);return Qe.__actions__.push({func:Ju,args:[Ke],thisArg:void 0}),new Rn(Qe,mt)}return At&&qe?l.apply(this,ue):(Qe=this.thru(Ke),At?E?Qe.value()[0]:Qe.value():Qe)})}),Gi(["pop","push","shift","sort","splice","unshift"],function(l){var p=nh[l],y=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",E=/^(?:pop|shift)$/.test(l);w.prototype[l]=function(){var P=arguments;if(E&&!this.__chain__){var H=this.value();return p.apply(Ft(H)?H:[],P)}return this[y](function(te){return p.apply(Ft(te)?te:[],P)})}}),jr(kt.prototype,function(l,p){var y=w[p];if(y){var E=y.name+"";an.call(lr,E)||(lr[E]=[]),lr[E].push({name:p,func:y})}}),lr[_a(void 0,2).name]=[{name:"wrapper",func:void 0}],kt.prototype.clone=function(){var l=new kt(this.__wrapped__);return l.__actions__=si(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=si(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=si(this.__views__),l},kt.prototype.reverse=function(){if(this.__filtered__){var l=new kt(this);l.__dir__=-1,l.__filtered__=!0}else(l=this.clone()).__dir__*=-1;return l},kt.prototype.value=function(){var l=this.__wrapped__.value(),p=this.__dir__,y=Ft(l),E=p<0,P=y?l.length:0,H=function(zt,bt,It){for(var zn=-1,wi=It.length;++zn<wi;){var Vn=It[zn],Fn=Vn.size;switch(Vn.type){case"drop":zt+=Fn;break;case"dropRight":bt-=Fn;break;case"take":bt=Qn(bt,zt+Fn);break;case"takeRight":zt=wn(zt,bt-Fn)}}return{start:zt,end:bt}}(0,P,this.__views__),te=H.start,ue=H.end,ve=ue-te,Ge=E?ue:te-1,He=this.__iteratees__,Ke=He.length,mt=0,vt=Qn(ve,this.__takeCount__);if(!y||!E&&P==ve&&vt==ve)return Tc(l,this.__actions__);var At=[];e:for(;ve--&&mt<vt;){for(var qe=-1,Qe=l[Ge+=p];++qe<Ke;){var Tt=He[qe],pt=Tt.iteratee,wt=Tt.type,Rt=pt(Qe);if(wt==2)Qe=Rt;else if(!Rt){if(wt==1)continue e;break e}}At[mt++]=Qe}return At},w.prototype.at=eg,w.prototype.chain=function(){return jp(this)},w.prototype.commit=function(){return new Rn(this.value(),this.__chain__)},w.prototype.next=function(){this.__values__===void 0&&(this.__values__=of(this.value()));var l=this.__index__>=this.__values__.length;return{done:l,value:l?void 0:this.__values__[this.__index__++]}},w.prototype.plant=function(l){for(var p,y=this;y instanceof hh;){var E=kp(y);E.__index__=0,E.__values__=void 0,p?P.__wrapped__=E:p=E;var P=E;y=y.__wrapped__}return P.__wrapped__=l,p},w.prototype.reverse=function(){var l=this.__wrapped__;if(l instanceof kt){var p=l;return this.__actions__.length&&(p=new kt(this)),(p=p.reverse()).__actions__.push({func:Ju,args:[Uc],thisArg:void 0}),new Rn(p,this.__chain__)}return this.thru(Uc)},w.prototype.toJSON=w.prototype.valueOf=w.prototype.value=function(){return Tc(this.__wrapped__,this.__actions__)},w.prototype.first=w.prototype.head,Gr&&(w.prototype[Gr]=function(){return this}),w}();Ln._=xs,(N=function(){return xs}.call(ce,_,ce,ee))===void 0||(ee.exports=N)}).call(this)}).call(this,_(4),_(8)(tt))},function(tt,ce,_){Object.defineProperty(ce,"__esModule",{value:!0});var b=function(){function ie(V,K){for(var re=0;re<K.length;re++){var Te=K[re];Te.enumerable=Te.enumerable||!1,Te.configurable=!0,"value"in Te&&(Te.writable=!0),Object.defineProperty(V,Te.key,Te)}}return function(V,K,re){return K&&ie(V.prototype,K),re&&ie(V,re),V}}();function ee(ie,V){if(!(ie instanceof V))throw new TypeError("Cannot call a class as a function")}var N=function(){function ie(V,K,re){K===void 0&&(K=!1),ee(this,ie),this._fn=V,this._once=K,this._thisArg=re,this._next=this._prev=this._owner=null}return b(ie,[{key:"detach",value:function(){return this._owner!==null&&(this._owner.detach(this),!0)}}]),ie}();function ne(ie,V){return ie._head?(ie._tail._next=V,V._prev=ie._tail,ie._tail=V):(ie._head=V,ie._tail=V),V._owner=ie,V}var B=function(){function ie(){ee(this,ie),this._head=this._tail=void 0}return b(ie,[{key:"handlers",value:function(){var V=!(arguments.length<=0||arguments[0]===void 0)&&arguments[0],K=this._head;if(V)return!!K;for(var re=[];K;)re.push(K),K=K._next;return re}},{key:"has",value:function(V){if(!(V instanceof N))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return V._owner===this}},{key:"dispatch",value:function(){var V=this._head;if(!V)return!1;for(;V;)V._once&&this.detach(V),V._fn.apply(V._thisArg,arguments),V=V._next;return!0}},{key:"add",value:function(V){var K=arguments.length<=1||arguments[1]===void 0?null:arguments[1];if(typeof V!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return ne(this,new N(V,!1,K))}},{key:"once",value:function(V){var K=arguments.length<=1||arguments[1]===void 0?null:arguments[1];if(typeof V!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return ne(this,new N(V,!0,K))}},{key:"detach",value:function(V){if(!(V instanceof N))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return V._owner!==this||(V._prev&&(V._prev._next=V._next),V._next&&(V._next._prev=V._prev),V===this._head?(this._head=V._next,V._next===null&&(this._tail=null)):V===this._tail&&(this._tail=V._prev,this._tail._next=null),V._owner=null),this}},{key:"detachAll",value:function(){var V=this._head;if(!V)return this;for(this._head=this._tail=null;V;)V._owner=null,V=V._next;return this}}]),ie}();B.MiniSignalBinding=N,ce.default=B,tt.exports=ce.default},function(tt,ce,_){var b;(function(ee){function N(L,G){var j=(65535&L)+(65535&G);return(L>>16)+(G>>16)+(j>>16)<<16|65535&j}function ne(L,G,j,J,Je,dt){return N((Ze=N(N(G,L),N(J,dt)))<<(se=Je)|Ze>>>32-se,j);var Ze,se}function B(L,G,j,J,Je,dt,Ze){return ne(G&j|~G&J,L,G,Je,dt,Ze)}function ie(L,G,j,J,Je,dt,Ze){return ne(G&J|j&~J,L,G,Je,dt,Ze)}function V(L,G,j,J,Je,dt,Ze){return ne(G^j^J,L,G,Je,dt,Ze)}function K(L,G,j,J,Je,dt,Ze){return ne(j^(G|~J),L,G,Je,dt,Ze)}function re(L,G){var j,J,Je,dt,Ze;L[G>>5]|=128<<G%32,L[14+(G+64>>>9<<4)]=G;var se=1732584193,Ae=-271733879,Re=-1732584194,k=271733878;for(j=0;j<L.length;j+=16)J=se,Je=Ae,dt=Re,Ze=k,se=B(se,Ae,Re,k,L[j],7,-680876936),k=B(k,se,Ae,Re,L[j+1],12,-389564586),Re=B(Re,k,se,Ae,L[j+2],17,606105819),Ae=B(Ae,Re,k,se,L[j+3],22,-1044525330),se=B(se,Ae,Re,k,L[j+4],7,-176418897),k=B(k,se,Ae,Re,L[j+5],12,1200080426),Re=B(Re,k,se,Ae,L[j+6],17,-1473231341),Ae=B(Ae,Re,k,se,L[j+7],22,-45705983),se=B(se,Ae,Re,k,L[j+8],7,1770035416),k=B(k,se,Ae,Re,L[j+9],12,-1958414417),Re=B(Re,k,se,Ae,L[j+10],17,-42063),Ae=B(Ae,Re,k,se,L[j+11],22,-1990404162),se=B(se,Ae,Re,k,L[j+12],7,1804603682),k=B(k,se,Ae,Re,L[j+13],12,-40341101),Re=B(Re,k,se,Ae,L[j+14],17,-1502002290),se=ie(se,Ae=B(Ae,Re,k,se,L[j+15],22,1236535329),Re,k,L[j+1],5,-165796510),k=ie(k,se,Ae,Re,L[j+6],9,-1069501632),Re=ie(Re,k,se,Ae,L[j+11],14,643717713),Ae=ie(Ae,Re,k,se,L[j],20,-373897302),se=ie(se,Ae,Re,k,L[j+5],5,-701558691),k=ie(k,se,Ae,Re,L[j+10],9,38016083),Re=ie(Re,k,se,Ae,L[j+15],14,-660478335),Ae=ie(Ae,Re,k,se,L[j+4],20,-405537848),se=ie(se,Ae,Re,k,L[j+9],5,568446438),k=ie(k,se,Ae,Re,L[j+14],9,-1019803690),Re=ie(Re,k,se,Ae,L[j+3],14,-187363961),Ae=ie(Ae,Re,k,se,L[j+8],20,1163531501),se=ie(se,Ae,Re,k,L[j+13],5,-1444681467),k=ie(k,se,Ae,Re,L[j+2],9,-51403784),Re=ie(Re,k,se,Ae,L[j+7],14,1735328473),se=V(se,Ae=ie(Ae,Re,k,se,L[j+12],20,-1926607734),Re,k,L[j+5],4,-378558),k=V(k,se,Ae,Re,L[j+8],11,-2022574463),Re=V(Re,k,se,Ae,L[j+11],16,1839030562),Ae=V(Ae,Re,k,se,L[j+14],23,-35309556),se=V(se,Ae,Re,k,L[j+1],4,-1530992060),k=V(k,se,Ae,Re,L[j+4],11,1272893353),Re=V(Re,k,se,Ae,L[j+7],16,-155497632),Ae=V(Ae,Re,k,se,L[j+10],23,-1094730640),se=V(se,Ae,Re,k,L[j+13],4,681279174),k=V(k,se,Ae,Re,L[j],11,-358537222),Re=V(Re,k,se,Ae,L[j+3],16,-722521979),Ae=V(Ae,Re,k,se,L[j+6],23,76029189),se=V(se,Ae,Re,k,L[j+9],4,-640364487),k=V(k,se,Ae,Re,L[j+12],11,-421815835),Re=V(Re,k,se,Ae,L[j+15],16,530742520),se=K(se,Ae=V(Ae,Re,k,se,L[j+2],23,-995338651),Re,k,L[j],6,-198630844),k=K(k,se,Ae,Re,L[j+7],10,1126891415),Re=K(Re,k,se,Ae,L[j+14],15,-1416354905),Ae=K(Ae,Re,k,se,L[j+5],21,-57434055),se=K(se,Ae,Re,k,L[j+12],6,1700485571),k=K(k,se,Ae,Re,L[j+3],10,-1894986606),Re=K(Re,k,se,Ae,L[j+10],15,-1051523),Ae=K(Ae,Re,k,se,L[j+1],21,-2054922799),se=K(se,Ae,Re,k,L[j+8],6,1873313359),k=K(k,se,Ae,Re,L[j+15],10,-30611744),Re=K(Re,k,se,Ae,L[j+6],15,-1560198380),Ae=K(Ae,Re,k,se,L[j+13],21,1309151649),se=K(se,Ae,Re,k,L[j+4],6,-145523070),k=K(k,se,Ae,Re,L[j+11],10,-1120210379),Re=K(Re,k,se,Ae,L[j+2],15,718787259),Ae=K(Ae,Re,k,se,L[j+9],21,-343485551),se=N(se,J),Ae=N(Ae,Je),Re=N(Re,dt),k=N(k,Ze);return[se,Ae,Re,k]}function Te(L){var G,j="",J=32*L.length;for(G=0;G<J;G+=8)j+=String.fromCharCode(L[G>>5]>>>G%32&255);return j}function Ne(L){var G,j=[];for(j[(L.length>>2)-1]=void 0,G=0;G<j.length;G+=1)j[G]=0;var J=8*L.length;for(G=0;G<J;G+=8)j[G>>5]|=(255&L.charCodeAt(G/8))<<G%32;return j}function Le(L){var G,j,J="";for(j=0;j<L.length;j+=1)G=L.charCodeAt(j),J+="0123456789abcdef".charAt(G>>>4&15)+"0123456789abcdef".charAt(15&G);return J}function S(L){return unescape(encodeURIComponent(L))}function A(L){return function(G){return Te(re(Ne(G),8*G.length))}(S(L))}function I(L,G){return function(j,J){var Je,dt,Ze=Ne(j),se=[],Ae=[];for(se[15]=Ae[15]=void 0,Ze.length>16&&(Ze=re(Ze,8*j.length)),Je=0;Je<16;Je+=1)se[Je]=909522486^Ze[Je],Ae[Je]=1549556828^Ze[Je];return dt=re(se.concat(Ne(J)),512+8*J.length),Te(re(Ae.concat(dt),640))}(S(L),S(G))}function z(L,G,j){return G?j?I(G,L):Le(I(G,L)):j?A(L):Le(A(L))}(b=function(){return z}.call(ce,_,ce,tt))===void 0||(tt.exports=b)})()},function(tt,ce){var _;_=function(){return this}();try{_=_||new Function("return this")()}catch{typeof window=="object"&&(_=window)}tt.exports=_},function(tt,ce,_){var b=_(21),ee=_(22);function N(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}ce.parse=L,ce.resolve=function(G,j){return L(G,!1,!0).resolve(j)},ce.resolveObject=function(G,j){return G?L(G,!1,!0).resolveObject(j):j},ce.format=function(G){return ee.isString(G)&&(G=L(G)),G instanceof N?G.format():N.prototype.format.call(G)},ce.Url=N;var ne=/^([a-z0-9.+-]+:)/i,B=/:[0-9]*$/,ie=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,V=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),K=["'"].concat(V),re=["%","/","?",";","#"].concat(K),Te=["/","?","#"],Ne=/^[+a-z0-9A-Z_-]{0,63}$/,Le=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,S={javascript:!0,"javascript:":!0},A={javascript:!0,"javascript:":!0},I={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},z=_(23);function L(G,j,J){if(G&&ee.isObject(G)&&G instanceof N)return G;var Je=new N;return Je.parse(G,j,J),Je}N.prototype.parse=function(G,j,J){if(!ee.isString(G))throw new TypeError("Parameter 'url' must be a string, not "+typeof G);var Je=G.indexOf("?"),dt=Je!==-1&&Je<G.indexOf("#")?"?":"#",Ze=G.split(dt);Ze[0]=Ze[0].replace(/\\/g,"/");var se=G=Ze.join(dt);if(se=se.trim(),!J&&G.split("#").length===1){var Ae=ie.exec(se);if(Ae)return this.path=se,this.href=se,this.pathname=Ae[1],Ae[2]?(this.search=Ae[2],this.query=j?z.parse(this.search.substr(1)):this.search.substr(1)):j&&(this.search="",this.query={}),this}var Re=ne.exec(se);if(Re){var k=(Re=Re[0]).toLowerCase();this.protocol=k,se=se.substr(Re.length)}if(J||Re||se.match(/^\/\/[^@\/]+@[^@\/]+/)){var xe=se.substr(0,2)==="//";!xe||Re&&A[Re]||(se=se.substr(2),this.slashes=!0)}if(!A[Re]&&(xe||Re&&!I[Re])){for(var Ee,Ie,Se=-1,Be=0;Be<Te.length;Be++)(Xe=se.indexOf(Te[Be]))!==-1&&(Se===-1||Xe<Se)&&(Se=Xe);for((Ie=Se===-1?se.lastIndexOf("@"):se.lastIndexOf("@",Se))!==-1&&(Ee=se.slice(0,Ie),se=se.slice(Ie+1),this.auth=decodeURIComponent(Ee)),Se=-1,Be=0;Be<re.length;Be++){var Xe;(Xe=se.indexOf(re[Be]))!==-1&&(Se===-1||Xe<Se)&&(Se=Xe)}Se===-1&&(Se=se.length),this.host=se.slice(0,Se),se=se.slice(Se),this.parseHost(),this.hostname=this.hostname||"";var ot=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ot)for(var nt=this.hostname.split(/\./),Jt=(Be=0,nt.length);Be<Jt;Be++){var st=nt[Be];if(st&&!st.match(Ne)){for(var Kt="",Nt=0,Ht=st.length;Nt<Ht;Nt++)st.charCodeAt(Nt)>127?Kt+="x":Kt+=st[Nt];if(!Kt.match(Ne)){var yt=nt.slice(0,Be),In=nt.slice(Be+1),xn=st.match(Le);xn&&(yt.push(xn[1]),In.unshift(xn[2])),In.length&&(se="/"+In.join(".")+se),this.hostname=yt.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),ot||(this.hostname=b.toASCII(this.hostname));var fn=this.port?":"+this.port:"",Wn=this.hostname||"";this.host=Wn+fn,this.href+=this.host,ot&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),se[0]!=="/"&&(se="/"+se))}if(!S[k])for(Be=0,Jt=K.length;Be<Jt;Be++){var vn=K[Be];if(se.indexOf(vn)!==-1){var ri=encodeURIComponent(vn);ri===vn&&(ri=escape(vn)),se=se.split(vn).join(ri)}}var Li=se.indexOf("#");Li!==-1&&(this.hash=se.substr(Li),se=se.slice(0,Li));var Ei=se.indexOf("?");if(Ei!==-1?(this.search=se.substr(Ei),this.query=se.substr(Ei+1),j&&(this.query=z.parse(this.query)),se=se.slice(0,Ei)):j&&(this.search="",this.query={}),se&&(this.pathname=se),I[k]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){fn=this.pathname||"";var ki=this.search||"";this.path=fn+ki}return this.href=this.format(),this},N.prototype.format=function(){var G=this.auth||"";G&&(G=(G=encodeURIComponent(G)).replace(/%3A/i,":"),G+="@");var j=this.protocol||"",J=this.pathname||"",Je=this.hash||"",dt=!1,Ze="";this.host?dt=G+this.host:this.hostname&&(dt=G+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(dt+=":"+this.port)),this.query&&ee.isObject(this.query)&&Object.keys(this.query).length&&(Ze=z.stringify(this.query));var se=this.search||Ze&&"?"+Ze||"";return j&&j.substr(-1)!==":"&&(j+=":"),this.slashes||(!j||I[j])&&dt!==!1?(dt="//"+(dt||""),J&&J.charAt(0)!=="/"&&(J="/"+J)):dt||(dt=""),Je&&Je.charAt(0)!=="#"&&(Je="#"+Je),se&&se.charAt(0)!=="?"&&(se="?"+se),j+dt+(J=J.replace(/[?#]/g,function(Ae){return encodeURIComponent(Ae)}))+(se=se.replace("#","%23"))+Je},N.prototype.resolve=function(G){return this.resolveObject(L(G,!1,!0)).format()},N.prototype.resolveObject=function(G){if(ee.isString(G)){var j=new N;j.parse(G,!1,!0),G=j}for(var J=new N,Je=Object.keys(this),dt=0;dt<Je.length;dt++){var Ze=Je[dt];J[Ze]=this[Ze]}if(J.hash=G.hash,G.href==="")return J.href=J.format(),J;if(G.slashes&&!G.protocol){for(var se=Object.keys(G),Ae=0;Ae<se.length;Ae++){var Re=se[Ae];Re!=="protocol"&&(J[Re]=G[Re])}return I[J.protocol]&&J.hostname&&!J.pathname&&(J.path=J.pathname="/"),J.href=J.format(),J}if(G.protocol&&G.protocol!==J.protocol){if(!I[G.protocol]){for(var k=Object.keys(G),xe=0;xe<k.length;xe++){var Ee=k[xe];J[Ee]=G[Ee]}return J.href=J.format(),J}if(J.protocol=G.protocol,G.host||A[G.protocol])J.pathname=G.pathname;else{for(var Ie=(G.pathname||"").split("/");Ie.length&&!(G.host=Ie.shift()););G.host||(G.host=""),G.hostname||(G.hostname=""),Ie[0]!==""&&Ie.unshift(""),Ie.length<2&&Ie.unshift(""),J.pathname=Ie.join("/")}if(J.search=G.search,J.query=G.query,J.host=G.host||"",J.auth=G.auth,J.hostname=G.hostname||G.host,J.port=G.port,J.pathname||J.search){var Se=J.pathname||"",Be=J.search||"";J.path=Se+Be}return J.slashes=J.slashes||G.slashes,J.href=J.format(),J}var Xe=J.pathname&&J.pathname.charAt(0)==="/",ot=G.host||G.pathname&&G.pathname.charAt(0)==="/",nt=ot||Xe||J.host&&G.pathname,Jt=nt,st=J.pathname&&J.pathname.split("/")||[],Kt=(Ie=G.pathname&&G.pathname.split("/")||[],J.protocol&&!I[J.protocol]);if(Kt&&(J.hostname="",J.port=null,J.host&&(st[0]===""?st[0]=J.host:st.unshift(J.host)),J.host="",G.protocol&&(G.hostname=null,G.port=null,G.host&&(Ie[0]===""?Ie[0]=G.host:Ie.unshift(G.host)),G.host=null),nt=nt&&(Ie[0]===""||st[0]==="")),ot)J.host=G.host||G.host===""?G.host:J.host,J.hostname=G.hostname||G.hostname===""?G.hostname:J.hostname,J.search=G.search,J.query=G.query,st=Ie;else if(Ie.length)st||(st=[]),st.pop(),st=st.concat(Ie),J.search=G.search,J.query=G.query;else if(!ee.isNullOrUndefined(G.search))return Kt&&(J.hostname=J.host=st.shift(),(xn=!!(J.host&&J.host.indexOf("@")>0)&&J.host.split("@"))&&(J.auth=xn.shift(),J.host=J.hostname=xn.shift())),J.search=G.search,J.query=G.query,ee.isNull(J.pathname)&&ee.isNull(J.search)||(J.path=(J.pathname?J.pathname:"")+(J.search?J.search:"")),J.href=J.format(),J;if(!st.length)return J.pathname=null,J.search?J.path="/"+J.search:J.path=null,J.href=J.format(),J;for(var Nt=st.slice(-1)[0],Ht=(J.host||G.host||st.length>1)&&(Nt==="."||Nt==="..")||Nt==="",yt=0,In=st.length;In>=0;In--)(Nt=st[In])==="."?st.splice(In,1):Nt===".."?(st.splice(In,1),yt++):yt&&(st.splice(In,1),yt--);if(!nt&&!Jt)for(;yt--;yt)st.unshift("..");!nt||st[0]===""||st[0]&&st[0].charAt(0)==="/"||st.unshift(""),Ht&&st.join("/").substr(-1)!=="/"&&st.push("");var xn,fn=st[0]===""||st[0]&&st[0].charAt(0)==="/";return Kt&&(J.hostname=J.host=fn?"":st.length?st.shift():"",(xn=!!(J.host&&J.host.indexOf("@")>0)&&J.host.split("@"))&&(J.auth=xn.shift(),J.host=J.hostname=xn.shift())),(nt=nt||J.host&&st.length)&&!fn&&st.unshift(""),st.length?J.pathname=st.join("/"):(J.pathname=null,J.path=null),ee.isNull(J.pathname)&&ee.isNull(J.search)||(J.path=(J.pathname?J.pathname:"")+(J.search?J.search:"")),J.auth=G.auth||J.auth,J.slashes=J.slashes||G.slashes,J.href=J.format(),J},N.prototype.parseHost=function(){var G=this.host,j=B.exec(G);j&&((j=j[0])!==":"&&(this.port=j.substr(1)),G=G.substr(0,G.length-j.length)),G&&(this.hostname=G)}},function(tt,ce,_){tt.exports=function(b,ee){if(b){ee=ee||{};for(var N={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},ne=N.parser[ee.strictMode?"strict":"loose"].exec(b),B={},ie=14;ie--;)B[N.key[ie]]=ne[ie]||"";return B[N.q.name]={},B[N.key[12]].replace(N.q.parser,function(V,K,re){K&&(B[N.q.name][K]=re)}),B}}},function(tt,ce,_){var b=_(26);tt.exports=function(ee,N){N=N||{};var ne=new b,B=N.inPlace||!1,ie=ee.map(function(K){return B?K:{width:K.width,height:K.height,item:K}});ie=ie.sort(function(K,re){return re.width*re.height-K.width*K.height}),ne.fit(ie);var V={width:ie.reduce(function(K,re){return Math.max(K,re.x+re.width)},0),height:ie.reduce(function(K,re){return Math.max(K,re.y+re.height)},0)};return B||(V.items=ie),V}},function(tt,ce){tt.exports=function(_){return _.webpackPolyfill||(_.deprecate=function(){},_.paths=[],_.children||(_.children=[]),Object.defineProperty(_,"loaded",{enumerable:!0,get:function(){return _.l}}),Object.defineProperty(_,"id",{enumerable:!0,get:function(){return _.i}}),_.webpackPolyfill=1),_}},function(tt,ce,_){var b=Object.prototype.hasOwnProperty,ee="~";function N(){}function ne(K,re,Te){this.fn=K,this.context=re,this.once=Te||!1}function B(K,re,Te,Ne,Le){if(typeof Te!="function")throw new TypeError("The listener must be a function");var S=new ne(Te,Ne||K,Le),A=ee?ee+re:re;return K._events[A]?K._events[A].fn?K._events[A]=[K._events[A],S]:K._events[A].push(S):(K._events[A]=S,K._eventsCount++),K}function ie(K,re){--K._eventsCount==0?K._events=new N:delete K._events[re]}function V(){this._events=new N,this._eventsCount=0}Object.create&&(N.prototype=Object.create(null),new N().__proto__||(ee=!1)),V.prototype.eventNames=function(){var K,re,Te=[];if(this._eventsCount===0)return Te;for(re in K=this._events)b.call(K,re)&&Te.push(ee?re.slice(1):re);return Object.getOwnPropertySymbols?Te.concat(Object.getOwnPropertySymbols(K)):Te},V.prototype.listeners=function(K){var re=ee?ee+K:K,Te=this._events[re];if(!Te)return[];if(Te.fn)return[Te.fn];for(var Ne=0,Le=Te.length,S=new Array(Le);Ne<Le;Ne++)S[Ne]=Te[Ne].fn;return S},V.prototype.listenerCount=function(K){var re=ee?ee+K:K,Te=this._events[re];return Te?Te.fn?1:Te.length:0},V.prototype.emit=function(K,re,Te,Ne,Le,S){var A=ee?ee+K:K;if(!this._events[A])return!1;var I,z,L=this._events[A],G=arguments.length;if(L.fn){switch(L.once&&this.removeListener(K,L.fn,void 0,!0),G){case 1:return L.fn.call(L.context),!0;case 2:return L.fn.call(L.context,re),!0;case 3:return L.fn.call(L.context,re,Te),!0;case 4:return L.fn.call(L.context,re,Te,Ne),!0;case 5:return L.fn.call(L.context,re,Te,Ne,Le),!0;case 6:return L.fn.call(L.context,re,Te,Ne,Le,S),!0}for(z=1,I=new Array(G-1);z<G;z++)I[z-1]=arguments[z];L.fn.apply(L.context,I)}else{var j,J=L.length;for(z=0;z<J;z++)switch(L[z].once&&this.removeListener(K,L[z].fn,void 0,!0),G){case 1:L[z].fn.call(L[z].context);break;case 2:L[z].fn.call(L[z].context,re);break;case 3:L[z].fn.call(L[z].context,re,Te);break;case 4:L[z].fn.call(L[z].context,re,Te,Ne);break;default:if(!I)for(j=1,I=new Array(G-1);j<G;j++)I[j-1]=arguments[j];L[z].fn.apply(L[z].context,I)}}return!0},V.prototype.on=function(K,re,Te){return B(this,K,re,Te,!1)},V.prototype.once=function(K,re,Te){return B(this,K,re,Te,!0)},V.prototype.removeListener=function(K,re,Te,Ne){var Le=ee?ee+K:K;if(!this._events[Le])return this;if(!re)return ie(this,Le),this;var S=this._events[Le];if(S.fn)S.fn!==re||Ne&&!S.once||Te&&S.context!==Te||ie(this,Le);else{for(var A=0,I=[],z=S.length;A<z;A++)(S[A].fn!==re||Ne&&!S[A].once||Te&&S[A].context!==Te)&&I.push(S[A]);I.length?this._events[Le]=I.length===1?I[0]:I:ie(this,Le)}return this},V.prototype.removeAllListeners=function(K){var re;return K?(re=ee?ee+K:K,this._events[re]&&ie(this,re)):(this._events=new N,this._eventsCount=0),this},V.prototype.off=V.prototype.removeListener,V.prototype.addListener=V.prototype.on,V.prefixed=ee,V.EventEmitter=V,tt.exports=V},function(tt,ce,_){function b(k,xe,Ee){Ee=Ee||2;var Ie,Se,Be,Xe,ot,nt,Jt,st=xe&&xe.length,Kt=st?xe[0]*Ee:k.length,Nt=ee(k,0,Kt,Ee,!0),Ht=[];if(!Nt||Nt.next===Nt.prev)return Ht;if(st&&(Nt=function(In,xn,fn,Wn){var vn,ri,Li,Ei,ki,Mr=[];for(vn=0,ri=xn.length;vn<ri;vn++)Li=xn[vn]*Wn,Ei=vn<ri-1?xn[vn+1]*Wn:In.length,(ki=ee(In,Li,Ei,Wn,!1))===ki.next&&(ki.steiner=!0),Mr.push(S(ki));for(Mr.sort(re),vn=0;vn<Mr.length;vn++)fn=N(fn=Te(Mr[vn],fn),fn.next);return fn}(k,xe,Nt,Ee)),k.length>80*Ee){Ie=Be=k[0],Se=Xe=k[1];for(var yt=Ee;yt<Kt;yt+=Ee)(ot=k[yt])<Ie&&(Ie=ot),(nt=k[yt+1])<Se&&(Se=nt),ot>Be&&(Be=ot),nt>Xe&&(Xe=nt);Jt=(Jt=Math.max(Be-Ie,Xe-Se))!==0?1/Jt:0}return ne(Nt,Ht,Ee,Ie,Se,Jt),Ht}function ee(k,xe,Ee,Ie,Se){var Be,Xe;if(Se===Re(k,xe,Ee,Ie)>0)for(Be=xe;Be<Ee;Be+=Ie)Xe=Ze(Be,k[Be],k[Be+1],Xe);else for(Be=Ee-Ie;Be>=xe;Be-=Ie)Xe=Ze(Be,k[Be],k[Be+1],Xe);return Xe&&L(Xe,Xe.next)&&(se(Xe),Xe=Xe.next),Xe}function N(k,xe){if(!k)return k;xe||(xe=k);var Ee,Ie=k;do if(Ee=!1,Ie.steiner||!L(Ie,Ie.next)&&z(Ie.prev,Ie,Ie.next)!==0)Ie=Ie.next;else{if(se(Ie),(Ie=xe=Ie.prev)===Ie.next)break;Ee=!0}while(Ee||Ie!==xe);return xe}function ne(k,xe,Ee,Ie,Se,Be,Xe){if(k){!Xe&&Be&&function(st,Kt,Nt,Ht){var yt=st;do yt.z===null&&(yt.z=Le(yt.x,yt.y,Kt,Nt,Ht)),yt.prevZ=yt.prev,yt.nextZ=yt.next,yt=yt.next;while(yt!==st);yt.prevZ.nextZ=null,yt.prevZ=null,function(In){var xn,fn,Wn,vn,ri,Li,Ei,ki,Mr=1;do{for(fn=In,In=null,ri=null,Li=0;fn;){for(Li++,Wn=fn,Ei=0,xn=0;xn<Mr&&(Ei++,Wn=Wn.nextZ);xn++);for(ki=Mr;Ei>0||ki>0&&Wn;)Ei!==0&&(ki===0||!Wn||fn.z<=Wn.z)?(vn=fn,fn=fn.nextZ,Ei--):(vn=Wn,Wn=Wn.nextZ,ki--),ri?ri.nextZ=vn:In=vn,vn.prevZ=ri,ri=vn;fn=Wn}ri.nextZ=null,Mr*=2}while(Li>1)}(yt)}(k,Ie,Se,Be);for(var ot,nt,Jt=k;k.prev!==k.next;)if(ot=k.prev,nt=k.next,Be?ie(k,Ie,Se,Be):B(k))xe.push(ot.i/Ee),xe.push(k.i/Ee),xe.push(nt.i/Ee),se(k),k=nt.next,Jt=nt.next;else if((k=nt)===Jt){Xe?Xe===1?ne(k=V(N(k),xe,Ee),xe,Ee,Ie,Se,Be,2):Xe===2&&K(k,xe,Ee,Ie,Se,Be):ne(N(k),xe,Ee,Ie,Se,Be,1);break}}}function B(k){var xe=k.prev,Ee=k,Ie=k.next;if(z(xe,Ee,Ie)>=0)return!1;for(var Se=k.next.next;Se!==k.prev;){if(A(xe.x,xe.y,Ee.x,Ee.y,Ie.x,Ie.y,Se.x,Se.y)&&z(Se.prev,Se,Se.next)>=0)return!1;Se=Se.next}return!0}function ie(k,xe,Ee,Ie){var Se=k.prev,Be=k,Xe=k.next;if(z(Se,Be,Xe)>=0)return!1;for(var ot=Se.x<Be.x?Se.x<Xe.x?Se.x:Xe.x:Be.x<Xe.x?Be.x:Xe.x,nt=Se.y<Be.y?Se.y<Xe.y?Se.y:Xe.y:Be.y<Xe.y?Be.y:Xe.y,Jt=Se.x>Be.x?Se.x>Xe.x?Se.x:Xe.x:Be.x>Xe.x?Be.x:Xe.x,st=Se.y>Be.y?Se.y>Xe.y?Se.y:Xe.y:Be.y>Xe.y?Be.y:Xe.y,Kt=Le(ot,nt,xe,Ee,Ie),Nt=Le(Jt,st,xe,Ee,Ie),Ht=k.prevZ,yt=k.nextZ;Ht&&Ht.z>=Kt&&yt&&yt.z<=Nt;){if(Ht!==k.prev&&Ht!==k.next&&A(Se.x,Se.y,Be.x,Be.y,Xe.x,Xe.y,Ht.x,Ht.y)&&z(Ht.prev,Ht,Ht.next)>=0||(Ht=Ht.prevZ,yt!==k.prev&&yt!==k.next&&A(Se.x,Se.y,Be.x,Be.y,Xe.x,Xe.y,yt.x,yt.y)&&z(yt.prev,yt,yt.next)>=0))return!1;yt=yt.nextZ}for(;Ht&&Ht.z>=Kt;){if(Ht!==k.prev&&Ht!==k.next&&A(Se.x,Se.y,Be.x,Be.y,Xe.x,Xe.y,Ht.x,Ht.y)&&z(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.prevZ}for(;yt&&yt.z<=Nt;){if(yt!==k.prev&&yt!==k.next&&A(Se.x,Se.y,Be.x,Be.y,Xe.x,Xe.y,yt.x,yt.y)&&z(yt.prev,yt,yt.next)>=0)return!1;yt=yt.nextZ}return!0}function V(k,xe,Ee){var Ie=k;do{var Se=Ie.prev,Be=Ie.next.next;!L(Se,Be)&&G(Se,Ie,Ie.next,Be)&&Je(Se,Be)&&Je(Be,Se)&&(xe.push(Se.i/Ee),xe.push(Ie.i/Ee),xe.push(Be.i/Ee),se(Ie),se(Ie.next),Ie=k=Be),Ie=Ie.next}while(Ie!==k);return N(Ie)}function K(k,xe,Ee,Ie,Se,Be){var Xe=k;do{for(var ot=Xe.next.next;ot!==Xe.prev;){if(Xe.i!==ot.i&&I(Xe,ot)){var nt=dt(Xe,ot);return Xe=N(Xe,Xe.next),nt=N(nt,nt.next),ne(Xe,xe,Ee,Ie,Se,Be),void ne(nt,xe,Ee,Ie,Se,Be)}ot=ot.next}Xe=Xe.next}while(Xe!==k)}function re(k,xe){return k.x-xe.x}function Te(k,xe){var Ee=function(Be,Xe){var ot,nt=Xe,Jt=Be.x,st=Be.y,Kt=-1/0;do{if(st<=nt.y&&st>=nt.next.y&&nt.next.y!==nt.y){var Nt=nt.x+(st-nt.y)*(nt.next.x-nt.x)/(nt.next.y-nt.y);if(Nt<=Jt&&Nt>Kt){if(Kt=Nt,Nt===Jt){if(st===nt.y)return nt;if(st===nt.next.y)return nt.next}ot=nt.x<nt.next.x?nt:nt.next}}nt=nt.next}while(nt!==Xe);if(!ot)return null;if(Jt===Kt)return ot;var Ht,yt=ot,In=ot.x,xn=ot.y,fn=1/0;nt=ot;do Jt>=nt.x&&nt.x>=In&&Jt!==nt.x&&A(st<xn?Jt:Kt,st,In,xn,st<xn?Kt:Jt,st,nt.x,nt.y)&&(Ht=Math.abs(st-nt.y)/(Jt-nt.x),Je(nt,Be)&&(Ht<fn||Ht===fn&&(nt.x>ot.x||nt.x===ot.x&&Ne(ot,nt)))&&(ot=nt,fn=Ht)),nt=nt.next;while(nt!==yt);return ot}(k,xe);if(!Ee)return xe;var Ie=dt(Ee,k),Se=N(Ee,Ee.next);return N(Ie,Ie.next),xe===Ee?Se:xe}function Ne(k,xe){return z(k.prev,k,xe.prev)<0&&z(xe.next,k,k.next)<0}function Le(k,xe,Ee,Ie,Se){return(k=1431655765&((k=858993459&((k=252645135&((k=16711935&((k=32767*(k-Ee)*Se)|k<<8))|k<<4))|k<<2))|k<<1))|(xe=1431655765&((xe=858993459&((xe=252645135&((xe=16711935&((xe=32767*(xe-Ie)*Se)|xe<<8))|xe<<4))|xe<<2))|xe<<1))<<1}function S(k){var xe=k,Ee=k;do(xe.x<Ee.x||xe.x===Ee.x&&xe.y<Ee.y)&&(Ee=xe),xe=xe.next;while(xe!==k);return Ee}function A(k,xe,Ee,Ie,Se,Be,Xe,ot){return(Se-Xe)*(xe-ot)-(k-Xe)*(Be-ot)>=0&&(k-Xe)*(Ie-ot)-(Ee-Xe)*(xe-ot)>=0&&(Ee-Xe)*(Be-ot)-(Se-Xe)*(Ie-ot)>=0}function I(k,xe){return k.next.i!==xe.i&&k.prev.i!==xe.i&&!function(Ee,Ie){var Se=Ee;do{if(Se.i!==Ee.i&&Se.next.i!==Ee.i&&Se.i!==Ie.i&&Se.next.i!==Ie.i&&G(Se,Se.next,Ee,Ie))return!0;Se=Se.next}while(Se!==Ee);return!1}(k,xe)&&(Je(k,xe)&&Je(xe,k)&&function(Ee,Ie){var Se=Ee,Be=!1,Xe=(Ee.x+Ie.x)/2,ot=(Ee.y+Ie.y)/2;do Se.y>ot!=Se.next.y>ot&&Se.next.y!==Se.y&&Xe<(Se.next.x-Se.x)*(ot-Se.y)/(Se.next.y-Se.y)+Se.x&&(Be=!Be),Se=Se.next;while(Se!==Ee);return Be}(k,xe)&&(z(k.prev,k,xe.prev)||z(k,xe.prev,xe))||L(k,xe)&&z(k.prev,k,k.next)>0&&z(xe.prev,xe,xe.next)>0)}function z(k,xe,Ee){return(xe.y-k.y)*(Ee.x-xe.x)-(xe.x-k.x)*(Ee.y-xe.y)}function L(k,xe){return k.x===xe.x&&k.y===xe.y}function G(k,xe,Ee,Ie){var Se=J(z(k,xe,Ee)),Be=J(z(k,xe,Ie)),Xe=J(z(Ee,Ie,k)),ot=J(z(Ee,Ie,xe));return Se!==Be&&Xe!==ot||!(Se!==0||!j(k,Ee,xe))||!(Be!==0||!j(k,Ie,xe))||!(Xe!==0||!j(Ee,k,Ie))||!(ot!==0||!j(Ee,xe,Ie))}function j(k,xe,Ee){return xe.x<=Math.max(k.x,Ee.x)&&xe.x>=Math.min(k.x,Ee.x)&&xe.y<=Math.max(k.y,Ee.y)&&xe.y>=Math.min(k.y,Ee.y)}function J(k){return k>0?1:k<0?-1:0}function Je(k,xe){return z(k.prev,k,k.next)<0?z(k,xe,k.next)>=0&&z(k,k.prev,xe)>=0:z(k,xe,k.prev)<0||z(k,k.next,xe)<0}function dt(k,xe){var Ee=new Ae(k.i,k.x,k.y),Ie=new Ae(xe.i,xe.x,xe.y),Se=k.next,Be=xe.prev;return k.next=xe,xe.prev=k,Ee.next=Se,Se.prev=Ee,Ie.next=Ee,Ee.prev=Ie,Be.next=Ie,Ie.prev=Be,Ie}function Ze(k,xe,Ee,Ie){var Se=new Ae(k,xe,Ee);return Ie?(Se.next=Ie.next,Se.prev=Ie,Ie.next.prev=Se,Ie.next=Se):(Se.prev=Se,Se.next=Se),Se}function se(k){k.next.prev=k.prev,k.prev.next=k.next,k.prevZ&&(k.prevZ.nextZ=k.nextZ),k.nextZ&&(k.nextZ.prevZ=k.prevZ)}function Ae(k,xe,Ee){this.i=k,this.x=xe,this.y=Ee,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Re(k,xe,Ee,Ie){for(var Se=0,Be=xe,Xe=Ee-Ie;Be<Ee;Be+=Ie)Se+=(k[Xe]-k[Be])*(k[Be+1]+k[Xe+1]),Xe=Be;return Se}tt.exports=b,tt.exports.default=b,b.deviation=function(k,xe,Ee,Ie){var Se=xe&&xe.length,Be=Se?xe[0]*Ee:k.length,Xe=Math.abs(Re(k,0,Be,Ee));if(Se)for(var ot=0,nt=xe.length;ot<nt;ot++){var Jt=xe[ot]*Ee,st=ot<nt-1?xe[ot+1]*Ee:k.length;Xe-=Math.abs(Re(k,Jt,st,Ee))}var Kt=0;for(ot=0;ot<Ie.length;ot+=3){var Nt=Ie[ot]*Ee,Ht=Ie[ot+1]*Ee,yt=Ie[ot+2]*Ee;Kt+=Math.abs((k[Nt]-k[yt])*(k[Ht+1]-k[Nt+1])-(k[Nt]-k[Ht])*(k[yt+1]-k[Nt+1]))}return Xe===0&&Kt===0?0:Math.abs((Kt-Xe)/Xe)},b.flatten=function(k){for(var xe=k[0][0].length,Ee={vertices:[],holes:[],dimensions:xe},Ie=0,Se=0;Se<k.length;Se++){for(var Be=0;Be<k[Se].length;Be++)for(var Xe=0;Xe<xe;Xe++)Ee.vertices.push(k[Se][Be][Xe]);Se>0&&(Ie+=k[Se-1].length,Ee.holes.push(Ie))}return Ee}},function(tt,ce,_){(function(b){var ee=_(12),N=_(13),ne=setTimeout;function B(A){return Boolean(A&&A.length!==void 0)}function ie(){}function V(A){if(!(this instanceof V))throw new TypeError("Promises must be constructed via new");if(typeof A!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],S(A,this)}function K(A,I){for(;A._state===3;)A=A._value;A._state!==0?(A._handled=!0,V._immediateFn(function(){var z=A._state===1?I.onFulfilled:I.onRejected;if(z!==null){var L;try{L=z(A._value)}catch(G){return void Te(I.promise,G)}re(I.promise,L)}else(A._state===1?re:Te)(I.promise,A._value)})):A._deferreds.push(I)}function re(A,I){try{if(I===A)throw new TypeError("A promise cannot be resolved with itself.");if(I&&(typeof I=="object"||typeof I=="function")){var z=I.then;if(I instanceof V)return A._state=3,A._value=I,void Ne(A);if(typeof z=="function")return void S((L=z,G=I,function(){L.apply(G,arguments)}),A)}A._state=1,A._value=I,Ne(A)}catch(j){Te(A,j)}var L,G}function Te(A,I){A._state=2,A._value=I,Ne(A)}function Ne(A){A._state===2&&A._deferreds.length===0&&V._immediateFn(function(){A._handled||V._unhandledRejectionFn(A._value)});for(var I=0,z=A._deferreds.length;I<z;I++)K(A,A._deferreds[I]);A._deferreds=null}function Le(A,I,z){this.onFulfilled=typeof A=="function"?A:null,this.onRejected=typeof I=="function"?I:null,this.promise=z}function S(A,I){var z=!1;try{A(function(L){z||(z=!0,re(I,L))},function(L){z||(z=!0,Te(I,L))})}catch(L){if(z)return;z=!0,Te(I,L)}}V.prototype.catch=function(A){return this.then(null,A)},V.prototype.then=function(A,I){var z=new this.constructor(ie);return K(this,new Le(A,I,z)),z},V.prototype.finally=ee.a,V.all=function(A){return new V(function(I,z){if(!B(A))return z(new TypeError("Promise.all accepts an array"));var L=Array.prototype.slice.call(A);if(L.length===0)return I([]);var G=L.length;function j(Je,dt){try{if(dt&&(typeof dt=="object"||typeof dt=="function")){var Ze=dt.then;if(typeof Ze=="function")return void Ze.call(dt,function(se){j(Je,se)},z)}L[Je]=dt,--G==0&&I(L)}catch(se){z(se)}}for(var J=0;J<L.length;J++)j(J,L[J])})},V.allSettled=N.a,V.resolve=function(A){return A&&typeof A=="object"&&A.constructor===V?A:new V(function(I){I(A)})},V.reject=function(A){return new V(function(I,z){z(A)})},V.race=function(A){return new V(function(I,z){if(!B(A))return z(new TypeError("Promise.race accepts an array"));for(var L=0,G=A.length;L<G;L++)V.resolve(A[L]).then(I,z)})},V._immediateFn=typeof b=="function"&&function(A){b(A)}||function(A){ne(A,0)},V._unhandledRejectionFn=function(A){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",A)},ce.a=V}).call(this,_(18).setImmediate)},function(tt,ce,_){ce.a=function(b){var ee=this.constructor;return this.then(function(N){return ee.resolve(b()).then(function(){return N})},function(N){return ee.resolve(b()).then(function(){return ee.reject(N)})})}},function(tt,ce,_){ce.a=function(b){return new this(function(ee,N){if(!b||b.length===void 0)return N(new TypeError(typeof b+" "+b+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var ne=Array.prototype.slice.call(b);if(ne.length===0)return ee([]);var B=ne.length;function ie(K,re){if(re&&(typeof re=="object"||typeof re=="function")){var Te=re.then;if(typeof Te=="function")return void Te.call(re,function(Ne){ie(K,Ne)},function(Ne){ne[K]={status:"rejected",reason:Ne},--B==0&&ee(ne)})}ne[K]={status:"fulfilled",value:re},--B==0&&ee(ne)}for(var V=0;V<ne.length;V++)ie(V,ne[V])})}},function(tt,ce,_){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var b=Object.getOwnPropertySymbols,ee=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;function ne(B){if(B==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(B)}tt.exports=function(){try{if(!Object.assign)return!1;var B=new String("abc");if(B[5]="de",Object.getOwnPropertyNames(B)[0]==="5")return!1;for(var ie={},V=0;V<10;V++)ie["_"+String.fromCharCode(V)]=V;if(Object.getOwnPropertyNames(ie).map(function(re){return ie[re]}).join("")!=="0123456789")return!1;var K={};return"abcdefghijklmnopqrst".split("").forEach(function(re){K[re]=re}),Object.keys(Object.assign({},K)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(B,ie){for(var V,K,re=ne(B),Te=1;Te<arguments.length;Te++){for(var Ne in V=Object(arguments[Te]))ee.call(V,Ne)&&(re[Ne]=V[Ne]);if(b){K=b(V);for(var Le=0;Le<K.length;Le++)N.call(V,K[Le])&&(re[K[Le]]=V[K[Le]])}}return re}},function(tt,ce){tt.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
}
`},function(tt,ce){tt.exports=`precision mediump float;
#define KERNEL 7
varying vec2 vTextureCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 inputSize;
uniform float uStartAlpha;
uniform float uEndAlpha;
uniform int uBlur;
void main() {
	float halfHeight = uShapeFilterArea.w / 2.0;
	vec2 cod = vTextureCoord * inputSize.xy;
	if (cod.y < halfHeight) {
		gl_FragColor = texture2D(uSampler, vTextureCoord);
	}
	else {
		float alpha = uStartAlpha - (((cod.y - halfHeight) / halfHeight) * (uStartAlpha - uEndAlpha));
		vec2 cord = vec2(vTextureCoord.x, (uShapeFilterArea.w - cod.y) / inputSize.y);
		vec4 outputColor = texture2D(uSampler, cord);
		outputColor *= alpha;
		gl_FragColor = outputColor;
	}
}
`},function(tt,ce,_){(function(b){var ee;/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){var N=function(){this.init()};N.prototype={init:function(){var S=this||ne;return S._counter=1e3,S._html5AudioPool=[],S.html5PoolSize=10,S._codecs={},S._howls=[],S._muted=!1,S._volume=1,S._canPlayEvent="canplaythrough",S._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,S.masterGain=null,S.noAudio=!1,S.usingWebAudio=!0,S.autoSuspend=!0,S.ctx=null,S.autoUnlock=!0,S._setup(),S},volume:function(S){var A=this||ne;if(S=parseFloat(S),A.ctx||Le(),S!==void 0&&S>=0&&S<=1){if(A._volume=S,A._muted)return A;A.usingWebAudio&&A.masterGain.gain.setValueAtTime(S,ne.ctx.currentTime);for(var I=0;I<A._howls.length;I++)if(!A._howls[I]._webAudio)for(var z=A._howls[I]._getSoundIds(),L=0;L<z.length;L++){var G=A._howls[I]._soundById(z[L]);G&&G._node&&(G._node.volume=G._volume*S)}return A}return A._volume},mute:function(S){var A=this||ne;A.ctx||Le(),A._muted=S,A.usingWebAudio&&A.masterGain.gain.setValueAtTime(S?0:A._volume,ne.ctx.currentTime);for(var I=0;I<A._howls.length;I++)if(!A._howls[I]._webAudio)for(var z=A._howls[I]._getSoundIds(),L=0;L<z.length;L++){var G=A._howls[I]._soundById(z[L]);G&&G._node&&(G._node.muted=!!S||G._muted)}return A},stop:function(){for(var S=this||ne,A=0;A<S._howls.length;A++)S._howls[A].stop();return S},unload:function(){for(var S=this||ne,A=S._howls.length-1;A>=0;A--)S._howls[A].unload();return S.usingWebAudio&&S.ctx&&S.ctx.close!==void 0&&(S.ctx.close(),S.ctx=null,Le()),S},codecs:function(S){return(this||ne)._codecs[S.replace(/^x-/,"")]},_setup:function(){var S=this||ne;if(S.state=S.ctx&&S.ctx.state||"suspended",S._autoSuspend(),!S.usingWebAudio)if(typeof Audio!="undefined")try{new Audio().oncanplaythrough===void 0&&(S._canPlayEvent="canplay")}catch{S.noAudio=!0}else S.noAudio=!0;try{new Audio().muted&&(S.noAudio=!0)}catch{}return S.noAudio||S._setupCodecs(),S},_setupCodecs:function(){var S=this||ne,A=null;try{A=typeof Audio!="undefined"?new Audio:null}catch{return S}if(!A||typeof A.canPlayType!="function")return S;var I=A.canPlayType("audio/mpeg;").replace(/^no$/,""),z=S._navigator?S._navigator.userAgent:"",L=z.match(/OPR\/([0-6].)/g),G=L&&parseInt(L[0].split("/")[1],10)<33,j=z.indexOf("Safari")!==-1&&z.indexOf("Chrome")===-1,J=z.match(/Version\/(.*?) /),Je=j&&J&&parseInt(J[1],10)<15;return S._codecs={mp3:!(G||!I&&!A.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!I,opus:!!A.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!A.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!A.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(A.canPlayType('audio/wav; codecs="1"')||A.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!A.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!A.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(A.canPlayType("audio/x-m4a;")||A.canPlayType("audio/m4a;")||A.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(A.canPlayType("audio/x-m4b;")||A.canPlayType("audio/m4b;")||A.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(A.canPlayType("audio/x-mp4;")||A.canPlayType("audio/mp4;")||A.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(Je||!A.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(Je||!A.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!A.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(A.canPlayType("audio/x-flac;")||A.canPlayType("audio/flac;")).replace(/^no$/,"")},S},_unlockAudio:function(){var S=this||ne;if(!S._audioUnlocked&&S.ctx){S._audioUnlocked=!1,S.autoUnlock=!1,S._mobileUnloaded||S.ctx.sampleRate===44100||(S._mobileUnloaded=!0,S.unload()),S._scratchBuffer=S.ctx.createBuffer(1,1,22050);var A=function(I){for(;S._html5AudioPool.length<S.html5PoolSize;)try{var z=new Audio;z._unlocked=!0,S._releaseHtml5Audio(z)}catch{S.noAudio=!0;break}for(var L=0;L<S._howls.length;L++)if(!S._howls[L]._webAudio)for(var G=S._howls[L]._getSoundIds(),j=0;j<G.length;j++){var J=S._howls[L]._soundById(G[j]);J&&J._node&&!J._node._unlocked&&(J._node._unlocked=!0,J._node.load())}S._autoResume();var Je=S.ctx.createBufferSource();Je.buffer=S._scratchBuffer,Je.connect(S.ctx.destination),Je.start===void 0?Je.noteOn(0):Je.start(0),typeof S.ctx.resume=="function"&&S.ctx.resume(),Je.onended=function(){Je.disconnect(0),S._audioUnlocked=!0,document.removeEventListener("touchstart",A,!0),document.removeEventListener("touchend",A,!0),document.removeEventListener("click",A,!0),document.removeEventListener("keydown",A,!0);for(var dt=0;dt<S._howls.length;dt++)S._howls[dt]._emit("unlock")}};return document.addEventListener("touchstart",A,!0),document.addEventListener("touchend",A,!0),document.addEventListener("click",A,!0),document.addEventListener("keydown",A,!0),S}},_obtainHtml5Audio:function(){var S=this||ne;if(S._html5AudioPool.length)return S._html5AudioPool.pop();var A=new Audio().play();return A&&typeof Promise!="undefined"&&(A instanceof Promise||typeof A.then=="function")&&A.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(S){var A=this||ne;return S._unlocked&&A._html5AudioPool.push(S),A},_autoSuspend:function(){var S=this;if(S.autoSuspend&&S.ctx&&S.ctx.suspend!==void 0&&ne.usingWebAudio){for(var A=0;A<S._howls.length;A++)if(S._howls[A]._webAudio){for(var I=0;I<S._howls[A]._sounds.length;I++)if(!S._howls[A]._sounds[I]._paused)return S}return S._suspendTimer&&clearTimeout(S._suspendTimer),S._suspendTimer=setTimeout(function(){if(S.autoSuspend){S._suspendTimer=null,S.state="suspending";var z=function(){S.state="suspended",S._resumeAfterSuspend&&(delete S._resumeAfterSuspend,S._autoResume())};S.ctx.suspend().then(z,z)}},3e4),S}},_autoResume:function(){var S=this;if(S.ctx&&S.ctx.resume!==void 0&&ne.usingWebAudio)return S.state==="running"&&S.ctx.state!=="interrupted"&&S._suspendTimer?(clearTimeout(S._suspendTimer),S._suspendTimer=null):S.state==="suspended"||S.state==="running"&&S.ctx.state==="interrupted"?(S.ctx.resume().then(function(){S.state="running";for(var A=0;A<S._howls.length;A++)S._howls[A]._emit("resume")}),S._suspendTimer&&(clearTimeout(S._suspendTimer),S._suspendTimer=null)):S.state==="suspending"&&(S._resumeAfterSuspend=!0),S}};var ne=new N,B=function(S){S.src&&S.src.length!==0?this.init(S):console.error("An array of source files must be passed with any new Howl.")};B.prototype={init:function(S){var A=this;return ne.ctx||Le(),A._autoplay=S.autoplay||!1,A._format=typeof S.format!="string"?S.format:[S.format],A._html5=S.html5||!1,A._muted=S.mute||!1,A._loop=S.loop||!1,A._pool=S.pool||5,A._preload=typeof S.preload!="boolean"&&S.preload!=="metadata"||S.preload,A._rate=S.rate||1,A._sprite=S.sprite||{},A._src=typeof S.src!="string"?S.src:[S.src],A._volume=S.volume!==void 0?S.volume:1,A._xhr={method:S.xhr&&S.xhr.method?S.xhr.method:"GET",headers:S.xhr&&S.xhr.headers?S.xhr.headers:null,withCredentials:!(!S.xhr||!S.xhr.withCredentials)&&S.xhr.withCredentials},A._duration=0,A._state="unloaded",A._sounds=[],A._endTimers={},A._queue=[],A._playLock=!1,A._onend=S.onend?[{fn:S.onend}]:[],A._onfade=S.onfade?[{fn:S.onfade}]:[],A._onload=S.onload?[{fn:S.onload}]:[],A._onloaderror=S.onloaderror?[{fn:S.onloaderror}]:[],A._onplayerror=S.onplayerror?[{fn:S.onplayerror}]:[],A._onpause=S.onpause?[{fn:S.onpause}]:[],A._onplay=S.onplay?[{fn:S.onplay}]:[],A._onstop=S.onstop?[{fn:S.onstop}]:[],A._onmute=S.onmute?[{fn:S.onmute}]:[],A._onvolume=S.onvolume?[{fn:S.onvolume}]:[],A._onrate=S.onrate?[{fn:S.onrate}]:[],A._onseek=S.onseek?[{fn:S.onseek}]:[],A._onunlock=S.onunlock?[{fn:S.onunlock}]:[],A._onresume=[],A._webAudio=ne.usingWebAudio&&!A._html5,ne.ctx!==void 0&&ne.ctx&&ne.autoUnlock&&ne._unlockAudio(),ne._howls.push(A),A._autoplay&&A._queue.push({event:"play",action:function(){A.play()}}),A._preload&&A._preload!=="none"&&A.load(),A},load:function(){var S=null;if(ne.noAudio)this._emit("loaderror",null,"No audio support.");else{typeof this._src=="string"&&(this._src=[this._src]);for(var A=0;A<this._src.length;A++){var I,z;if(this._format&&this._format[A])I=this._format[A];else{if(typeof(z=this._src[A])!="string"){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(I=/^data:audio\/([^;,]+);/i.exec(z))||(I=/\.([^.]+)$/.exec(z.split("?",1)[0])),I&&(I=I[1].toLowerCase())}if(I||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),I&&ne.codecs(I)){S=this._src[A];break}}if(S)return this._src=S,this._state="loading",window.location.protocol==="https:"&&S.slice(0,5)==="http:"&&(this._html5=!0,this._webAudio=!1),new ie(this),this._webAudio&&K(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(S,A){var I=this,z=null;if(typeof S=="number")z=S,S=null;else{if(typeof S=="string"&&I._state==="loaded"&&!I._sprite[S])return null;if(S===void 0&&(S="__default",!I._playLock)){for(var L=0,G=0;G<I._sounds.length;G++)I._sounds[G]._paused&&!I._sounds[G]._ended&&(L++,z=I._sounds[G]._id);L===1?S=null:z=null}}var j=z?I._soundById(z):I._inactiveSound();if(!j)return null;if(z&&!S&&(S=j._sprite||"__default"),I._state!=="loaded"){j._sprite=S,j._ended=!1;var J=j._id;return I._queue.push({event:"play",action:function(){I.play(J)}}),J}if(z&&!j._paused)return A||I._loadQueue("play"),j._id;I._webAudio&&ne._autoResume();var Je=Math.max(0,j._seek>0?j._seek:I._sprite[S][0]/1e3),dt=Math.max(0,(I._sprite[S][0]+I._sprite[S][1])/1e3-Je),Ze=1e3*dt/Math.abs(j._rate),se=I._sprite[S][0]/1e3,Ae=(I._sprite[S][0]+I._sprite[S][1])/1e3;j._sprite=S,j._ended=!1;var Re=function(){j._paused=!1,j._seek=Je,j._start=se,j._stop=Ae,j._loop=!(!j._loop&&!I._sprite[S][2])};if(!(Je>=Ae)){var k=j._node;if(I._webAudio){var xe=function(){I._playLock=!1,Re(),I._refreshBuffer(j);var Be=j._muted||I._muted?0:j._volume;k.gain.setValueAtTime(Be,ne.ctx.currentTime),j._playStart=ne.ctx.currentTime,k.bufferSource.start===void 0?j._loop?k.bufferSource.noteGrainOn(0,Je,86400):k.bufferSource.noteGrainOn(0,Je,dt):j._loop?k.bufferSource.start(0,Je,86400):k.bufferSource.start(0,Je,dt),Ze!==1/0&&(I._endTimers[j._id]=setTimeout(I._ended.bind(I,j),Ze)),A||setTimeout(function(){I._emit("play",j._id),I._loadQueue()},0)};ne.state==="running"&&ne.ctx.state!=="interrupted"?xe():(I._playLock=!0,I.once("resume",xe),I._clearTimer(j._id))}else{var Ee=function(){k.currentTime=Je,k.muted=j._muted||I._muted||ne._muted||k.muted,k.volume=j._volume*ne.volume(),k.playbackRate=j._rate;try{var Be=k.play();if(Be&&typeof Promise!="undefined"&&(Be instanceof Promise||typeof Be.then=="function")?(I._playLock=!0,Re(),Be.then(function(){I._playLock=!1,k._unlocked=!0,A?I._loadQueue():I._emit("play",j._id)}).catch(function(){I._playLock=!1,I._emit("playerror",j._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),j._ended=!0,j._paused=!0})):A||(I._playLock=!1,Re(),I._emit("play",j._id)),k.playbackRate=j._rate,k.paused)return void I._emit("playerror",j._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");S!=="__default"||j._loop?I._endTimers[j._id]=setTimeout(I._ended.bind(I,j),Ze):(I._endTimers[j._id]=function(){I._ended(j),k.removeEventListener("ended",I._endTimers[j._id],!1)},k.addEventListener("ended",I._endTimers[j._id],!1))}catch(Xe){I._emit("playerror",j._id,Xe)}};k.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(k.src=I._src,k.load());var Ie=window&&window.ejecta||!k.readyState&&ne._navigator.isCocoonJS;if(k.readyState>=3||Ie)Ee();else{I._playLock=!0,I._state="loading";var Se=function(){I._state="loaded",Ee(),k.removeEventListener(ne._canPlayEvent,Se,!1)};k.addEventListener(ne._canPlayEvent,Se,!1),I._clearTimer(j._id)}}return j._id}I._ended(j)},pause:function(S){var A=this;if(A._state!=="loaded"||A._playLock)return A._queue.push({event:"pause",action:function(){A.pause(S)}}),A;for(var I=A._getSoundIds(S),z=0;z<I.length;z++){A._clearTimer(I[z]);var L=A._soundById(I[z]);if(L&&!L._paused&&(L._seek=A.seek(I[z]),L._rateSeek=0,L._paused=!0,A._stopFade(I[z]),L._node))if(A._webAudio){if(!L._node.bufferSource)continue;L._node.bufferSource.stop===void 0?L._node.bufferSource.noteOff(0):L._node.bufferSource.stop(0),A._cleanBuffer(L._node)}else isNaN(L._node.duration)&&L._node.duration!==1/0||L._node.pause();arguments[1]||A._emit("pause",L?L._id:null)}return A},stop:function(S,A){var I=this;if(I._state!=="loaded"||I._playLock)return I._queue.push({event:"stop",action:function(){I.stop(S)}}),I;for(var z=I._getSoundIds(S),L=0;L<z.length;L++){I._clearTimer(z[L]);var G=I._soundById(z[L]);G&&(G._seek=G._start||0,G._rateSeek=0,G._paused=!0,G._ended=!0,I._stopFade(z[L]),G._node&&(I._webAudio?G._node.bufferSource&&(G._node.bufferSource.stop===void 0?G._node.bufferSource.noteOff(0):G._node.bufferSource.stop(0),I._cleanBuffer(G._node)):isNaN(G._node.duration)&&G._node.duration!==1/0||(G._node.currentTime=G._start||0,G._node.pause(),G._node.duration===1/0&&I._clearSound(G._node))),A||I._emit("stop",G._id))}return I},mute:function(S,A){var I=this;if(I._state!=="loaded"||I._playLock)return I._queue.push({event:"mute",action:function(){I.mute(S,A)}}),I;if(A===void 0){if(typeof S!="boolean")return I._muted;I._muted=S}for(var z=I._getSoundIds(A),L=0;L<z.length;L++){var G=I._soundById(z[L]);G&&(G._muted=S,G._interval&&I._stopFade(G._id),I._webAudio&&G._node?G._node.gain.setValueAtTime(S?0:G._volume,ne.ctx.currentTime):G._node&&(G._node.muted=!!ne._muted||S),I._emit("mute",G._id))}return I},volume:function(){var S,A,I,z=this,L=arguments;if(L.length===0)return z._volume;if(L.length===1||L.length===2&&L[1]===void 0){var G=z._getSoundIds(),j=G.indexOf(L[0]);j>=0?A=parseInt(L[0],10):S=parseFloat(L[0])}else L.length>=2&&(S=parseFloat(L[0]),A=parseInt(L[1],10));if(!(S!==void 0&&S>=0&&S<=1))return(I=A?z._soundById(A):z._sounds[0])?I._volume:0;if(z._state!=="loaded"||z._playLock)return z._queue.push({event:"volume",action:function(){z.volume.apply(z,L)}}),z;A===void 0&&(z._volume=S),A=z._getSoundIds(A);for(var J=0;J<A.length;J++)(I=z._soundById(A[J]))&&(I._volume=S,L[2]||z._stopFade(A[J]),z._webAudio&&I._node&&!I._muted?I._node.gain.setValueAtTime(S,ne.ctx.currentTime):I._node&&!I._muted&&(I._node.volume=S*ne.volume()),z._emit("volume",I._id));return z},fade:function(S,A,I,z){var L=this;if(L._state!=="loaded"||L._playLock)return L._queue.push({event:"fade",action:function(){L.fade(S,A,I,z)}}),L;S=Math.min(Math.max(0,parseFloat(S)),1),A=Math.min(Math.max(0,parseFloat(A)),1),I=parseFloat(I),L.volume(S,z);for(var G=L._getSoundIds(z),j=0;j<G.length;j++){var J=L._soundById(G[j]);if(J){if(z||L._stopFade(G[j]),L._webAudio&&!J._muted){var Je=ne.ctx.currentTime,dt=Je+I/1e3;J._volume=S,J._node.gain.setValueAtTime(S,Je),J._node.gain.linearRampToValueAtTime(A,dt)}L._startFadeInterval(J,S,A,I,G[j],z===void 0)}}return L},_startFadeInterval:function(S,A,I,z,L,G){var j=this,J=A,Je=I-A,dt=Math.abs(Je/.01),Ze=Math.max(4,dt>0?z/dt:z),se=Date.now();S._fadeTo=I,S._interval=setInterval(function(){var Ae=(Date.now()-se)/z;se=Date.now(),J+=Je*Ae,J=Math.round(100*J)/100,J=Je<0?Math.max(I,J):Math.min(I,J),j._webAudio?S._volume=J:j.volume(J,S._id,!0),G&&(j._volume=J),(I<A&&J<=I||I>A&&J>=I)&&(clearInterval(S._interval),S._interval=null,S._fadeTo=null,j.volume(I,S._id),j._emit("fade",S._id))},Ze)},_stopFade:function(S){var A=this._soundById(S);return A&&A._interval&&(this._webAudio&&A._node.gain.cancelScheduledValues(ne.ctx.currentTime),clearInterval(A._interval),A._interval=null,this.volume(A._fadeTo,S),A._fadeTo=null,this._emit("fade",S)),this},loop:function(){var S,A,I,z=this,L=arguments;if(L.length===0)return z._loop;if(L.length===1){if(typeof L[0]!="boolean")return!!(I=z._soundById(parseInt(L[0],10)))&&I._loop;S=L[0],z._loop=S}else L.length===2&&(S=L[0],A=parseInt(L[1],10));for(var G=z._getSoundIds(A),j=0;j<G.length;j++)(I=z._soundById(G[j]))&&(I._loop=S,z._webAudio&&I._node&&I._node.bufferSource&&(I._node.bufferSource.loop=S,S&&(I._node.bufferSource.loopStart=I._start||0,I._node.bufferSource.loopEnd=I._stop,z.playing(G[j])&&(z.pause(G[j],!0),z.play(G[j],!0)))));return z},rate:function(){var S,A,I,z=this,L=arguments;if(L.length===0)A=z._sounds[0]._id;else if(L.length===1){var G=z._getSoundIds(),j=G.indexOf(L[0]);j>=0?A=parseInt(L[0],10):S=parseFloat(L[0])}else L.length===2&&(S=parseFloat(L[0]),A=parseInt(L[1],10));if(typeof S!="number")return(I=z._soundById(A))?I._rate:z._rate;if(z._state!=="loaded"||z._playLock)return z._queue.push({event:"rate",action:function(){z.rate.apply(z,L)}}),z;A===void 0&&(z._rate=S),A=z._getSoundIds(A);for(var J=0;J<A.length;J++)if(I=z._soundById(A[J])){z.playing(A[J])&&(I._rateSeek=z.seek(A[J]),I._playStart=z._webAudio?ne.ctx.currentTime:I._playStart),I._rate=S,z._webAudio&&I._node&&I._node.bufferSource?I._node.bufferSource.playbackRate.setValueAtTime(S,ne.ctx.currentTime):I._node&&(I._node.playbackRate=S);var Je=z.seek(A[J]),dt=(z._sprite[I._sprite][0]+z._sprite[I._sprite][1])/1e3-Je,Ze=1e3*dt/Math.abs(I._rate);!z._endTimers[A[J]]&&I._paused||(z._clearTimer(A[J]),z._endTimers[A[J]]=setTimeout(z._ended.bind(z,I),Ze)),z._emit("rate",I._id)}return z},seek:function(){var S,A,I=this,z=arguments;if(z.length===0)I._sounds.length&&(A=I._sounds[0]._id);else if(z.length===1){var L=I._getSoundIds(),G=L.indexOf(z[0]);G>=0?A=parseInt(z[0],10):I._sounds.length&&(A=I._sounds[0]._id,S=parseFloat(z[0]))}else z.length===2&&(S=parseFloat(z[0]),A=parseInt(z[1],10));if(A===void 0)return 0;if(typeof S=="number"&&(I._state!=="loaded"||I._playLock))return I._queue.push({event:"seek",action:function(){I.seek.apply(I,z)}}),I;var j=I._soundById(A);if(j){if(!(typeof S=="number"&&S>=0)){if(I._webAudio){var J=I.playing(A)?ne.ctx.currentTime-j._playStart:0,Je=j._rateSeek?j._rateSeek-j._seek:0;return j._seek+(Je+J*Math.abs(j._rate))}return j._node.currentTime}var dt=I.playing(A);dt&&I.pause(A,!0),j._seek=S,j._ended=!1,I._clearTimer(A),I._webAudio||!j._node||isNaN(j._node.duration)||(j._node.currentTime=S);var Ze=function(){dt&&I.play(A,!0),I._emit("seek",A)};if(dt&&!I._webAudio){var se=function(){I._playLock?setTimeout(se,0):Ze()};setTimeout(se,0)}else Ze()}return I},playing:function(S){if(typeof S=="number"){var A=this._soundById(S);return!!A&&!A._paused}for(var I=0;I<this._sounds.length;I++)if(!this._sounds[I]._paused)return!0;return!1},duration:function(S){var A=this._duration,I=this._soundById(S);return I&&(A=this._sprite[I._sprite][1]/1e3),A},state:function(){return this._state},unload:function(){for(var S=this,A=S._sounds,I=0;I<A.length;I++)A[I]._paused||S.stop(A[I]._id),S._webAudio||(S._clearSound(A[I]._node),A[I]._node.removeEventListener("error",A[I]._errorFn,!1),A[I]._node.removeEventListener(ne._canPlayEvent,A[I]._loadFn,!1),A[I]._node.removeEventListener("ended",A[I]._endFn,!1),ne._releaseHtml5Audio(A[I]._node)),delete A[I]._node,S._clearTimer(A[I]._id);var z=ne._howls.indexOf(S);z>=0&&ne._howls.splice(z,1);var L=!0;for(I=0;I<ne._howls.length;I++)if(ne._howls[I]._src===S._src||S._src.indexOf(ne._howls[I]._src)>=0){L=!1;break}return V&&L&&delete V[S._src],ne.noAudio=!1,S._state="unloaded",S._sounds=[],S=null,null},on:function(S,A,I,z){var L=this["_on"+S];return typeof A=="function"&&L.push(z?{id:I,fn:A,once:z}:{id:I,fn:A}),this},off:function(S,A,I){var z=this["_on"+S],L=0;if(typeof A=="number"&&(I=A,A=null),A||I)for(L=0;L<z.length;L++){var G=I===z[L].id;if(A===z[L].fn&&G||!A&&G){z.splice(L,1);break}}else if(S)this["_on"+S]=[];else{var j=Object.keys(this);for(L=0;L<j.length;L++)j[L].indexOf("_on")===0&&Array.isArray(this[j[L]])&&(this[j[L]]=[])}return this},once:function(S,A,I){return this.on(S,A,I,1),this},_emit:function(S,A,I){for(var z=this["_on"+S],L=z.length-1;L>=0;L--)z[L].id&&z[L].id!==A&&S!=="load"||(setTimeout(function(G){G.call(this,A,I)}.bind(this,z[L].fn),0),z[L].once&&this.off(S,z[L].fn,z[L].id));return this._loadQueue(S),this},_loadQueue:function(S){if(this._queue.length>0){var A=this._queue[0];A.event===S&&(this._queue.shift(),this._loadQueue()),S||A.action()}return this},_ended:function(S){var A=S._sprite;if(!this._webAudio&&S._node&&!S._node.paused&&!S._node.ended&&S._node.currentTime<S._stop)return setTimeout(this._ended.bind(this,S),100),this;var I=!(!S._loop&&!this._sprite[A][2]);if(this._emit("end",S._id),!this._webAudio&&I&&this.stop(S._id,!0).play(S._id),this._webAudio&&I){this._emit("play",S._id),S._seek=S._start||0,S._rateSeek=0,S._playStart=ne.ctx.currentTime;var z=1e3*(S._stop-S._start)/Math.abs(S._rate);this._endTimers[S._id]=setTimeout(this._ended.bind(this,S),z)}return this._webAudio&&!I&&(S._paused=!0,S._ended=!0,S._seek=S._start||0,S._rateSeek=0,this._clearTimer(S._id),this._cleanBuffer(S._node),ne._autoSuspend()),this._webAudio||I||this.stop(S._id,!0),this},_clearTimer:function(S){if(this._endTimers[S]){if(typeof this._endTimers[S]!="function")clearTimeout(this._endTimers[S]);else{var A=this._soundById(S);A&&A._node&&A._node.removeEventListener("ended",this._endTimers[S],!1)}delete this._endTimers[S]}return this},_soundById:function(S){for(var A=0;A<this._sounds.length;A++)if(S===this._sounds[A]._id)return this._sounds[A];return null},_inactiveSound:function(){this._drain();for(var S=0;S<this._sounds.length;S++)if(this._sounds[S]._ended)return this._sounds[S].reset();return new ie(this)},_drain:function(){var S=this._pool,A=0,I=0;if(!(this._sounds.length<S)){for(I=0;I<this._sounds.length;I++)this._sounds[I]._ended&&A++;for(I=this._sounds.length-1;I>=0;I--){if(A<=S)return;this._sounds[I]._ended&&(this._webAudio&&this._sounds[I]._node&&this._sounds[I]._node.disconnect(0),this._sounds.splice(I,1),A--)}}},_getSoundIds:function(S){if(S===void 0){for(var A=[],I=0;I<this._sounds.length;I++)A.push(this._sounds[I]._id);return A}return[S]},_refreshBuffer:function(S){return S._node.bufferSource=ne.ctx.createBufferSource(),S._node.bufferSource.buffer=V[this._src],S._panner?S._node.bufferSource.connect(S._panner):S._node.bufferSource.connect(S._node),S._node.bufferSource.loop=S._loop,S._loop&&(S._node.bufferSource.loopStart=S._start||0,S._node.bufferSource.loopEnd=S._stop||0),S._node.bufferSource.playbackRate.setValueAtTime(S._rate,ne.ctx.currentTime),this},_cleanBuffer:function(S){var A=ne._navigator&&ne._navigator.vendor.indexOf("Apple")>=0;if(ne._scratchBuffer&&S.bufferSource&&(S.bufferSource.onended=null,S.bufferSource.disconnect(0),A))try{S.bufferSource.buffer=ne._scratchBuffer}catch{}return S.bufferSource=null,this},_clearSound:function(S){/MSIE |Trident\//.test(ne._navigator&&ne._navigator.userAgent)||(S.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var ie=function(S){this._parent=S,this.init()};ie.prototype={init:function(){var S=this._parent;return this._muted=S._muted,this._loop=S._loop,this._volume=S._volume,this._rate=S._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++ne._counter,S._sounds.push(this),this.create(),this},create:function(){var S=this._parent,A=ne._muted||this._muted||this._parent._muted?0:this._volume;return S._webAudio?(this._node=ne.ctx.createGain===void 0?ne.ctx.createGainNode():ne.ctx.createGain(),this._node.gain.setValueAtTime(A,ne.ctx.currentTime),this._node.paused=!0,this._node.connect(ne.masterGain)):ne.noAudio||(this._node=ne._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(ne._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=S._src,this._node.preload=S._preload===!0?"auto":S._preload,this._node.volume=A*ne.volume(),this._node.load()),this},reset:function(){var S=this._parent;return this._muted=S._muted,this._loop=S._loop,this._volume=S._volume,this._rate=S._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++ne._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var S=this._parent;S._duration=Math.ceil(10*this._node.duration)/10,Object.keys(S._sprite).length===0&&(S._sprite={__default:[0,1e3*S._duration]}),S._state!=="loaded"&&(S._state="loaded",S._emit("load"),S._loadQueue()),this._node.removeEventListener(ne._canPlayEvent,this._loadFn,!1)},_endListener:function(){var S=this._parent;S._duration===1/0&&(S._duration=Math.ceil(10*this._node.duration)/10,S._sprite.__default[1]===1/0&&(S._sprite.__default[1]=1e3*S._duration),S._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}};var V={},K=function(S){var A=S._src;if(V[A])return S._duration=V[A].duration,void Ne(S);if(/^data:[^;]+;base64,/.test(A)){for(var I=atob(A.split(",")[1]),z=new Uint8Array(I.length),L=0;L<I.length;++L)z[L]=I.charCodeAt(L);Te(z.buffer,S)}else{var G=new XMLHttpRequest;G.open(S._xhr.method,A,!0),G.withCredentials=S._xhr.withCredentials,G.responseType="arraybuffer",S._xhr.headers&&Object.keys(S._xhr.headers).forEach(function(j){G.setRequestHeader(j,S._xhr.headers[j])}),G.onload=function(){var j=(G.status+"")[0];j==="0"||j==="2"||j==="3"?Te(G.response,S):S._emit("loaderror",null,"Failed loading audio file with status: "+G.status+".")},G.onerror=function(){S._webAudio&&(S._html5=!0,S._webAudio=!1,S._sounds=[],delete V[A],S.load())},re(G)}},re=function(S){try{S.send()}catch{S.onerror()}},Te=function(S,A){var I=function(){A._emit("loaderror",null,"Decoding audio data failed.")},z=function(L){L&&A._sounds.length>0?(V[A._src]=L,Ne(A,L)):I()};typeof Promise!="undefined"&&ne.ctx.decodeAudioData.length===1?ne.ctx.decodeAudioData(S).then(z).catch(I):ne.ctx.decodeAudioData(S,z,I)},Ne=function(S,A){A&&!S._duration&&(S._duration=A.duration),Object.keys(S._sprite).length===0&&(S._sprite={__default:[0,1e3*S._duration]}),S._state!=="loaded"&&(S._state="loaded",S._emit("load"),S._loadQueue())},Le=function(){if(ne.usingWebAudio){try{typeof AudioContext!="undefined"?ne.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?ne.ctx=new webkitAudioContext:ne.usingWebAudio=!1}catch{ne.usingWebAudio=!1}ne.ctx||(ne.usingWebAudio=!1);var S=/iP(hone|od|ad)/.test(ne._navigator&&ne._navigator.platform),A=ne._navigator&&ne._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),I=A?parseInt(A[1],10):null;if(S&&I&&I<9){var z=/safari/.test(ne._navigator&&ne._navigator.userAgent.toLowerCase());ne._navigator&&!z&&(ne.usingWebAudio=!1)}ne.usingWebAudio&&(ne.masterGain=ne.ctx.createGain===void 0?ne.ctx.createGainNode():ne.ctx.createGain(),ne.masterGain.gain.setValueAtTime(ne._muted?0:ne._volume,ne.ctx.currentTime),ne.masterGain.connect(ne.ctx.destination)),ne._setup()}};(ee=function(){return{Howler:ne,Howl:B}}.apply(ce,[]))===void 0||(tt.exports=ee),ce.Howler=ne,ce.Howl=B,b!==void 0?(b.HowlerGlobal=N,b.Howler=ne,b.Howl=B,b.Sound=ie):typeof window!="undefined"&&(window.HowlerGlobal=N,window.Howler=ne,window.Howl=B,window.Sound=ie)})(),function(){var N;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(B){if(!this.ctx||!this.ctx.listener)return this;for(var ie=this._howls.length-1;ie>=0;ie--)this._howls[ie].stereo(B);return this},HowlerGlobal.prototype.pos=function(B,ie,V){return this.ctx&&this.ctx.listener?(ie=typeof ie!="number"?this._pos[1]:ie,V=typeof V!="number"?this._pos[2]:V,typeof B!="number"?this._pos:(this._pos=[B,ie,V],this.ctx.listener.positionX!==void 0?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(B,ie,V,K,re,Te){if(!this.ctx||!this.ctx.listener)return this;var Ne=this._orientation;return ie=typeof ie!="number"?Ne[1]:ie,V=typeof V!="number"?Ne[2]:V,K=typeof K!="number"?Ne[3]:K,re=typeof re!="number"?Ne[4]:re,Te=typeof Te!="number"?Ne[5]:Te,typeof B!="number"?Ne:(this._orientation=[B,ie,V,K,re,Te],this.ctx.listener.forwardX!==void 0?(this.ctx.listener.forwardX.setTargetAtTime(B,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(ie,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(V,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(K,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(re,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(Te,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(B,ie,V,K,re,Te),this)},Howl.prototype.init=(N=Howl.prototype.init,function(B){return this._orientation=B.orientation||[1,0,0],this._stereo=B.stereo||null,this._pos=B.pos||null,this._pannerAttr={coneInnerAngle:B.coneInnerAngle!==void 0?B.coneInnerAngle:360,coneOuterAngle:B.coneOuterAngle!==void 0?B.coneOuterAngle:360,coneOuterGain:B.coneOuterGain!==void 0?B.coneOuterGain:0,distanceModel:B.distanceModel!==void 0?B.distanceModel:"inverse",maxDistance:B.maxDistance!==void 0?B.maxDistance:1e4,panningModel:B.panningModel!==void 0?B.panningModel:"HRTF",refDistance:B.refDistance!==void 0?B.refDistance:1,rolloffFactor:B.rolloffFactor!==void 0?B.rolloffFactor:1},this._onstereo=B.onstereo?[{fn:B.onstereo}]:[],this._onpos=B.onpos?[{fn:B.onpos}]:[],this._onorientation=B.onorientation?[{fn:B.onorientation}]:[],N.call(this,B)}),Howl.prototype.stereo=function(B,ie){var V=this;if(!V._webAudio)return V;if(V._state!=="loaded")return V._queue.push({event:"stereo",action:function(){V.stereo(B,ie)}}),V;var K=Howler.ctx.createStereoPanner===void 0?"spatial":"stereo";if(ie===void 0){if(typeof B!="number")return V._stereo;V._stereo=B,V._pos=[B,0,0]}for(var re=V._getSoundIds(ie),Te=0;Te<re.length;Te++){var Ne=V._soundById(re[Te]);if(Ne){if(typeof B!="number")return Ne._stereo;Ne._stereo=B,Ne._pos=[B,0,0],Ne._node&&(Ne._pannerAttr.panningModel="equalpower",Ne._panner&&Ne._panner.pan||ne(Ne,K),K==="spatial"?Ne._panner.positionX!==void 0?(Ne._panner.positionX.setValueAtTime(B,Howler.ctx.currentTime),Ne._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),Ne._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):Ne._panner.setPosition(B,0,0):Ne._panner.pan.setValueAtTime(B,Howler.ctx.currentTime)),V._emit("stereo",Ne._id)}}return V},Howl.prototype.pos=function(B,ie,V,K){var re=this;if(!re._webAudio)return re;if(re._state!=="loaded")return re._queue.push({event:"pos",action:function(){re.pos(B,ie,V,K)}}),re;if(ie=typeof ie!="number"?0:ie,V=typeof V!="number"?-.5:V,K===void 0){if(typeof B!="number")return re._pos;re._pos=[B,ie,V]}for(var Te=re._getSoundIds(K),Ne=0;Ne<Te.length;Ne++){var Le=re._soundById(Te[Ne]);if(Le){if(typeof B!="number")return Le._pos;Le._pos=[B,ie,V],Le._node&&(Le._panner&&!Le._panner.pan||ne(Le,"spatial"),Le._panner.positionX!==void 0?(Le._panner.positionX.setValueAtTime(B,Howler.ctx.currentTime),Le._panner.positionY.setValueAtTime(ie,Howler.ctx.currentTime),Le._panner.positionZ.setValueAtTime(V,Howler.ctx.currentTime)):Le._panner.setPosition(B,ie,V)),re._emit("pos",Le._id)}}return re},Howl.prototype.orientation=function(B,ie,V,K){var re=this;if(!re._webAudio)return re;if(re._state!=="loaded")return re._queue.push({event:"orientation",action:function(){re.orientation(B,ie,V,K)}}),re;if(ie=typeof ie!="number"?re._orientation[1]:ie,V=typeof V!="number"?re._orientation[2]:V,K===void 0){if(typeof B!="number")return re._orientation;re._orientation=[B,ie,V]}for(var Te=re._getSoundIds(K),Ne=0;Ne<Te.length;Ne++){var Le=re._soundById(Te[Ne]);if(Le){if(typeof B!="number")return Le._orientation;Le._orientation=[B,ie,V],Le._node&&(Le._panner||(Le._pos||(Le._pos=re._pos||[0,0,-.5]),ne(Le,"spatial")),Le._panner.orientationX!==void 0?(Le._panner.orientationX.setValueAtTime(B,Howler.ctx.currentTime),Le._panner.orientationY.setValueAtTime(ie,Howler.ctx.currentTime),Le._panner.orientationZ.setValueAtTime(V,Howler.ctx.currentTime)):Le._panner.setOrientation(B,ie,V)),re._emit("orientation",Le._id)}}return re},Howl.prototype.pannerAttr=function(){var B,ie,V,K=this,re=arguments;if(!K._webAudio)return K;if(re.length===0)return K._pannerAttr;if(re.length===1){if(typeof re[0]!="object")return(V=K._soundById(parseInt(re[0],10)))?V._pannerAttr:K._pannerAttr;B=re[0],ie===void 0&&(B.pannerAttr||(B.pannerAttr={coneInnerAngle:B.coneInnerAngle,coneOuterAngle:B.coneOuterAngle,coneOuterGain:B.coneOuterGain,distanceModel:B.distanceModel,maxDistance:B.maxDistance,refDistance:B.refDistance,rolloffFactor:B.rolloffFactor,panningModel:B.panningModel}),K._pannerAttr={coneInnerAngle:B.pannerAttr.coneInnerAngle!==void 0?B.pannerAttr.coneInnerAngle:K._coneInnerAngle,coneOuterAngle:B.pannerAttr.coneOuterAngle!==void 0?B.pannerAttr.coneOuterAngle:K._coneOuterAngle,coneOuterGain:B.pannerAttr.coneOuterGain!==void 0?B.pannerAttr.coneOuterGain:K._coneOuterGain,distanceModel:B.pannerAttr.distanceModel!==void 0?B.pannerAttr.distanceModel:K._distanceModel,maxDistance:B.pannerAttr.maxDistance!==void 0?B.pannerAttr.maxDistance:K._maxDistance,refDistance:B.pannerAttr.refDistance!==void 0?B.pannerAttr.refDistance:K._refDistance,rolloffFactor:B.pannerAttr.rolloffFactor!==void 0?B.pannerAttr.rolloffFactor:K._rolloffFactor,panningModel:B.pannerAttr.panningModel!==void 0?B.pannerAttr.panningModel:K._panningModel})}else re.length===2&&(B=re[0],ie=parseInt(re[1],10));for(var Te=K._getSoundIds(ie),Ne=0;Ne<Te.length;Ne++)if(V=K._soundById(Te[Ne])){var Le=V._pannerAttr;Le={coneInnerAngle:B.coneInnerAngle!==void 0?B.coneInnerAngle:Le.coneInnerAngle,coneOuterAngle:B.coneOuterAngle!==void 0?B.coneOuterAngle:Le.coneOuterAngle,coneOuterGain:B.coneOuterGain!==void 0?B.coneOuterGain:Le.coneOuterGain,distanceModel:B.distanceModel!==void 0?B.distanceModel:Le.distanceModel,maxDistance:B.maxDistance!==void 0?B.maxDistance:Le.maxDistance,refDistance:B.refDistance!==void 0?B.refDistance:Le.refDistance,rolloffFactor:B.rolloffFactor!==void 0?B.rolloffFactor:Le.rolloffFactor,panningModel:B.panningModel!==void 0?B.panningModel:Le.panningModel};var S=V._panner;S?(S.coneInnerAngle=Le.coneInnerAngle,S.coneOuterAngle=Le.coneOuterAngle,S.coneOuterGain=Le.coneOuterGain,S.distanceModel=Le.distanceModel,S.maxDistance=Le.maxDistance,S.refDistance=Le.refDistance,S.rolloffFactor=Le.rolloffFactor,S.panningModel=Le.panningModel):(V._pos||(V._pos=K._pos||[0,0,-.5]),ne(V,"spatial"))}return K},Sound.prototype.init=function(B){return function(){var ie=this._parent;this._orientation=ie._orientation,this._stereo=ie._stereo,this._pos=ie._pos,this._pannerAttr=ie._pannerAttr,B.call(this),this._stereo?ie.stereo(this._stereo):this._pos&&ie.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(B){return function(){var ie=this._parent;return this._orientation=ie._orientation,this._stereo=ie._stereo,this._pos=ie._pos,this._pannerAttr=ie._pannerAttr,this._stereo?ie.stereo(this._stereo):this._pos?ie.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,ie._refreshBuffer(this)),B.call(this)}}(Sound.prototype.reset);var ne=function(B,ie){(ie=ie||"spatial")==="spatial"?(B._panner=Howler.ctx.createPanner(),B._panner.coneInnerAngle=B._pannerAttr.coneInnerAngle,B._panner.coneOuterAngle=B._pannerAttr.coneOuterAngle,B._panner.coneOuterGain=B._pannerAttr.coneOuterGain,B._panner.distanceModel=B._pannerAttr.distanceModel,B._panner.maxDistance=B._pannerAttr.maxDistance,B._panner.refDistance=B._pannerAttr.refDistance,B._panner.rolloffFactor=B._pannerAttr.rolloffFactor,B._panner.panningModel=B._pannerAttr.panningModel,B._panner.positionX!==void 0?(B._panner.positionX.setValueAtTime(B._pos[0],Howler.ctx.currentTime),B._panner.positionY.setValueAtTime(B._pos[1],Howler.ctx.currentTime),B._panner.positionZ.setValueAtTime(B._pos[2],Howler.ctx.currentTime)):B._panner.setPosition(B._pos[0],B._pos[1],B._pos[2]),B._panner.orientationX!==void 0?(B._panner.orientationX.setValueAtTime(B._orientation[0],Howler.ctx.currentTime),B._panner.orientationY.setValueAtTime(B._orientation[1],Howler.ctx.currentTime),B._panner.orientationZ.setValueAtTime(B._orientation[2],Howler.ctx.currentTime)):B._panner.setOrientation(B._orientation[0],B._orientation[1],B._orientation[2])):(B._panner=Howler.ctx.createStereoPanner(),B._panner.pan.setValueAtTime(B._stereo,Howler.ctx.currentTime)),B._panner.connect(B._node),B._paused||B._parent.pause(B._id,!0).play(B._id,!0)}}()}).call(this,_(4))},function(tt,ce,_){(function(b){var ee=b!==void 0&&b||typeof self!="undefined"&&self||window,N=Function.prototype.apply;function ne(B,ie){this._id=B,this._clearFn=ie}ce.setTimeout=function(){return new ne(N.call(setTimeout,ee,arguments),clearTimeout)},ce.setInterval=function(){return new ne(N.call(setInterval,ee,arguments),clearInterval)},ce.clearTimeout=ce.clearInterval=function(B){B&&B.close()},ne.prototype.unref=ne.prototype.ref=function(){},ne.prototype.close=function(){this._clearFn.call(ee,this._id)},ce.enroll=function(B,ie){clearTimeout(B._idleTimeoutId),B._idleTimeout=ie},ce.unenroll=function(B){clearTimeout(B._idleTimeoutId),B._idleTimeout=-1},ce._unrefActive=ce.active=function(B){clearTimeout(B._idleTimeoutId);var ie=B._idleTimeout;ie>=0&&(B._idleTimeoutId=setTimeout(function(){B._onTimeout&&B._onTimeout()},ie))},_(19),ce.setImmediate=typeof self!="undefined"&&self.setImmediate||b!==void 0&&b.setImmediate||this&&this.setImmediate,ce.clearImmediate=typeof self!="undefined"&&self.clearImmediate||b!==void 0&&b.clearImmediate||this&&this.clearImmediate}).call(this,_(4))},function(tt,ce,_){(function(b,ee){(function(N,ne){if(!N.setImmediate){var B,ie,V,K,re,Te=1,Ne={},Le=!1,S=N.document,A=Object.getPrototypeOf&&Object.getPrototypeOf(N);A=A&&A.setTimeout?A:N,{}.toString.call(N.process)==="[object process]"?B=function(L){ee.nextTick(function(){z(L)})}:function(){if(N.postMessage&&!N.importScripts){var L=!0,G=N.onmessage;return N.onmessage=function(){L=!1},N.postMessage("","*"),N.onmessage=G,L}}()?(K="setImmediate$"+Math.random()+"$",re=function(L){L.source===N&&typeof L.data=="string"&&L.data.indexOf(K)===0&&z(+L.data.slice(K.length))},N.addEventListener?N.addEventListener("message",re,!1):N.attachEvent("onmessage",re),B=function(L){N.postMessage(K+L,"*")}):N.MessageChannel?((V=new MessageChannel).port1.onmessage=function(L){z(L.data)},B=function(L){V.port2.postMessage(L)}):S&&"onreadystatechange"in S.createElement("script")?(ie=S.documentElement,B=function(L){var G=S.createElement("script");G.onreadystatechange=function(){z(L),G.onreadystatechange=null,ie.removeChild(G),G=null},ie.appendChild(G)}):B=function(L){setTimeout(z,0,L)},A.setImmediate=function(L){typeof L!="function"&&(L=new Function(""+L));for(var G=new Array(arguments.length-1),j=0;j<G.length;j++)G[j]=arguments[j+1];var J={callback:L,args:G};return Ne[Te]=J,B(Te),Te++},A.clearImmediate=I}function I(L){delete Ne[L]}function z(L){if(Le)setTimeout(z,0,L);else{var G=Ne[L];if(G){Le=!0;try{(function(j){var J=j.callback,Je=j.args;switch(Je.length){case 0:J();break;case 1:J(Je[0]);break;case 2:J(Je[0],Je[1]);break;case 3:J(Je[0],Je[1],Je[2]);break;default:J.apply(void 0,Je)}})(G)}finally{I(L),Le=!1}}}}})(typeof self=="undefined"?b===void 0?this:b:self)}).call(this,_(4),_(20))},function(tt,ce){var _,b,ee=tt.exports={};function N(){throw new Error("setTimeout has not been defined")}function ne(){throw new Error("clearTimeout has not been defined")}function B(A){if(_===setTimeout)return setTimeout(A,0);if((_===N||!_)&&setTimeout)return _=setTimeout,setTimeout(A,0);try{return _(A,0)}catch{try{return _.call(null,A,0)}catch{return _.call(this,A,0)}}}(function(){try{_=typeof setTimeout=="function"?setTimeout:N}catch{_=N}try{b=typeof clearTimeout=="function"?clearTimeout:ne}catch{b=ne}})();var ie,V=[],K=!1,re=-1;function Te(){K&&ie&&(K=!1,ie.length?V=ie.concat(V):re=-1,V.length&&Ne())}function Ne(){if(!K){var A=B(Te);K=!0;for(var I=V.length;I;){for(ie=V,V=[];++re<I;)ie&&ie[re].run();re=-1,I=V.length}ie=null,K=!1,function(z){if(b===clearTimeout)return clearTimeout(z);if((b===ne||!b)&&clearTimeout)return b=clearTimeout,clearTimeout(z);try{b(z)}catch{try{return b.call(null,z)}catch{return b.call(this,z)}}}(A)}}function Le(A,I){this.fun=A,this.array=I}function S(){}ee.nextTick=function(A){var I=new Array(arguments.length-1);if(arguments.length>1)for(var z=1;z<arguments.length;z++)I[z-1]=arguments[z];V.push(new Le(A,I)),V.length!==1||K||B(Ne)},Le.prototype.run=function(){this.fun.apply(null,this.array)},ee.title="browser",ee.browser=!0,ee.env={},ee.argv=[],ee.version="",ee.versions={},ee.on=S,ee.addListener=S,ee.once=S,ee.off=S,ee.removeListener=S,ee.removeAllListeners=S,ee.emit=S,ee.prependListener=S,ee.prependOnceListener=S,ee.listeners=function(A){return[]},ee.binding=function(A){throw new Error("process.binding is not supported")},ee.cwd=function(){return"/"},ee.chdir=function(A){throw new Error("process.chdir is not supported")},ee.umask=function(){return 0}},function(tt,ce,_){(function(b,ee){var N;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(ne){ce&&ce.nodeType,b&&b.nodeType;var B=typeof ee=="object"&&ee;B.global!==B&&B.window!==B&&B.self;var ie,V=2147483647,K=/^xn--/,re=/[^\x20-\x7E]/,Te=/[\x2E\u3002\uFF0E\uFF61]/g,Ne={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Le=Math.floor,S=String.fromCharCode;function A(Ze){throw new RangeError(Ne[Ze])}function I(Ze,se){for(var Ae=Ze.length,Re=[];Ae--;)Re[Ae]=se(Ze[Ae]);return Re}function z(Ze,se){var Ae=Ze.split("@"),Re="";return Ae.length>1&&(Re=Ae[0]+"@",Ze=Ae[1]),Re+I((Ze=Ze.replace(Te,".")).split("."),se).join(".")}function L(Ze){for(var se,Ae,Re=[],k=0,xe=Ze.length;k<xe;)(se=Ze.charCodeAt(k++))>=55296&&se<=56319&&k<xe?(64512&(Ae=Ze.charCodeAt(k++)))==56320?Re.push(((1023&se)<<10)+(1023&Ae)+65536):(Re.push(se),k--):Re.push(se);return Re}function G(Ze){return I(Ze,function(se){var Ae="";return se>65535&&(Ae+=S((se-=65536)>>>10&1023|55296),se=56320|1023&se),Ae+=S(se)}).join("")}function j(Ze,se){return Ze+22+75*(Ze<26)-((se!=0)<<5)}function J(Ze,se,Ae){var Re=0;for(Ze=Ae?Le(Ze/700):Ze>>1,Ze+=Le(Ze/se);Ze>455;Re+=36)Ze=Le(Ze/35);return Le(Re+36*Ze/(Ze+38))}function Je(Ze){var se,Ae,Re,k,xe,Ee,Ie,Se,Be,Xe,ot,nt=[],Jt=Ze.length,st=0,Kt=128,Nt=72;for((Ae=Ze.lastIndexOf("-"))<0&&(Ae=0),Re=0;Re<Ae;++Re)Ze.charCodeAt(Re)>=128&&A("not-basic"),nt.push(Ze.charCodeAt(Re));for(k=Ae>0?Ae+1:0;k<Jt;){for(xe=st,Ee=1,Ie=36;k>=Jt&&A("invalid-input"),((Se=(ot=Ze.charCodeAt(k++))-48<10?ot-22:ot-65<26?ot-65:ot-97<26?ot-97:36)>=36||Se>Le((V-st)/Ee))&&A("overflow"),st+=Se*Ee,!(Se<(Be=Ie<=Nt?1:Ie>=Nt+26?26:Ie-Nt));Ie+=36)Ee>Le(V/(Xe=36-Be))&&A("overflow"),Ee*=Xe;Nt=J(st-xe,se=nt.length+1,xe==0),Le(st/se)>V-Kt&&A("overflow"),Kt+=Le(st/se),st%=se,nt.splice(st++,0,Kt)}return G(nt)}function dt(Ze){var se,Ae,Re,k,xe,Ee,Ie,Se,Be,Xe,ot,nt,Jt,st,Kt,Nt=[];for(nt=(Ze=L(Ze)).length,se=128,Ae=0,xe=72,Ee=0;Ee<nt;++Ee)(ot=Ze[Ee])<128&&Nt.push(S(ot));for(Re=k=Nt.length,k&&Nt.push("-");Re<nt;){for(Ie=V,Ee=0;Ee<nt;++Ee)(ot=Ze[Ee])>=se&&ot<Ie&&(Ie=ot);for(Ie-se>Le((V-Ae)/(Jt=Re+1))&&A("overflow"),Ae+=(Ie-se)*Jt,se=Ie,Ee=0;Ee<nt;++Ee)if((ot=Ze[Ee])<se&&++Ae>V&&A("overflow"),ot==se){for(Se=Ae,Be=36;!(Se<(Xe=Be<=xe?1:Be>=xe+26?26:Be-xe));Be+=36)Kt=Se-Xe,st=36-Xe,Nt.push(S(j(Xe+Kt%st,0))),Se=Le(Kt/st);Nt.push(S(j(Se,0))),xe=J(Ae,Jt,Re==k),Ae=0,++Re}++Ae,++se}return Nt.join("")}ie={version:"1.4.1",ucs2:{decode:L,encode:G},decode:Je,encode:dt,toASCII:function(Ze){return z(Ze,function(se){return re.test(se)?"xn--"+dt(se):se})},toUnicode:function(Ze){return z(Ze,function(se){return K.test(se)?Je(se.slice(4).toLowerCase()):se})}},(N=function(){return ie}.call(ce,_,ce,b))===void 0||(b.exports=N)})()}).call(this,_(8)(tt),_(4))},function(tt,ce,_){tt.exports={isString:function(b){return typeof b=="string"},isObject:function(b){return typeof b=="object"&&b!==null},isNull:function(b){return b===null},isNullOrUndefined:function(b){return b==null}}},function(tt,ce,_){ce.decode=ce.parse=_(24),ce.encode=ce.stringify=_(25)},function(tt,ce,_){function b(N,ne){return Object.prototype.hasOwnProperty.call(N,ne)}tt.exports=function(N,ne,B,ie){ne=ne||"&",B=B||"=";var V={};if(typeof N!="string"||N.length===0)return V;var K=/\+/g;N=N.split(ne);var re=1e3;ie&&typeof ie.maxKeys=="number"&&(re=ie.maxKeys);var Te=N.length;re>0&&Te>re&&(Te=re);for(var Ne=0;Ne<Te;++Ne){var Le,S,A,I,z=N[Ne].replace(K,"%20"),L=z.indexOf(B);L>=0?(Le=z.substr(0,L),S=z.substr(L+1)):(Le=z,S=""),A=decodeURIComponent(Le),I=decodeURIComponent(S),b(V,A)?ee(V[A])?V[A].push(I):V[A]=[V[A],I]:V[A]=I}return V};var ee=Array.isArray||function(N){return Object.prototype.toString.call(N)==="[object Array]"}},function(tt,ce,_){var b=function(B){switch(typeof B){case"string":return B;case"boolean":return B?"true":"false";case"number":return isFinite(B)?B:"";default:return""}};tt.exports=function(B,ie,V,K){return ie=ie||"&",V=V||"=",B===null&&(B=void 0),typeof B=="object"?N(ne(B),function(re){var Te=encodeURIComponent(b(re))+V;return ee(B[re])?N(B[re],function(Ne){return Te+encodeURIComponent(b(Ne))}).join(ie):Te+encodeURIComponent(b(B[re]))}).join(ie):K?encodeURIComponent(b(K))+V+encodeURIComponent(b(B)):""};var ee=Array.isArray||function(B){return Object.prototype.toString.call(B)==="[object Array]"};function N(B,ie){if(B.map)return B.map(ie);for(var V=[],K=0;K<B.length;K++)V.push(ie(B[K],K));return V}var ne=Object.keys||function(B){var ie=[];for(var V in B)Object.prototype.hasOwnProperty.call(B,V)&&ie.push(V);return ie}},function(tt,ce){var _=function(){};_.prototype={fit:function(b){var ee,N,ne,B,ie=b.length,V=ie>0?b[0].width:0,K=ie>0?b[0].height:0;for(this.root={x:0,y:0,width:V,height:K},ee=0;ee<ie;ee++)ne=b[ee],(N=this.findNode(this.root,ne.width,ne.height))?(B=this.splitNode(N,ne.width,ne.height),ne.x=B.x,ne.y=B.y):(B=this.growNode(ne.width,ne.height),ne.x=B.x,ne.y=B.y)},findNode:function(b,ee,N){return b.used?this.findNode(b.right,ee,N)||this.findNode(b.down,ee,N):ee<=b.width&&N<=b.height?b:null},splitNode:function(b,ee,N){return b.used=!0,b.down={x:b.x,y:b.y+N,width:b.width,height:b.height-N},b.right={x:b.x+ee,y:b.y,width:b.width-ee,height:N},b},growNode:function(b,ee){var N=b<=this.root.width,ne=ee<=this.root.height,B=ne&&this.root.height>=this.root.width+b,ie=N&&this.root.width>=this.root.height+ee;return B?this.growRight(b,ee):ie?this.growDown(b,ee):ne?this.growRight(b,ee):N?this.growDown(b,ee):null},growRight:function(b,ee){var N;return this.root={used:!0,x:0,y:0,width:this.root.width+b,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:b,height:this.root.height}},(N=this.findNode(this.root,b,ee))?this.splitNode(N,b,ee):null},growDown:function(b,ee){var N;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+ee,down:{x:0,y:this.root.height,width:this.root.width,height:ee},right:this.root},(N=this.findNode(this.root,b,ee))?this.splitNode(N,b,ee):null}},tt.exports=_},function(tt,ce,_){_.r(ce),_.d(ce,"SLIDE_EVENTS",function(){return ar}),_.d(ce,"Slide",function(){return _A});var b={};_.r(b),_.d(b,"ACESFilmicToneMapping",function(){return tp}),_.d(b,"AddEquation",function(){return Ee}),_.d(b,"AddOperation",function(){return Jd}),_.d(b,"AdditiveAnimationBlendMode",function(){return be}),_.d(b,"AdditiveBlending",function(){return Ae}),_.d(b,"AlphaFormat",function(){return gn}),_.d(b,"AlwaysDepth",function(){return vn}),_.d(b,"AlwaysStencilFunc",function(){return rh}),_.d(b,"AmbientLight",function(){return Pf}),_.d(b,"AmbientLightProbe",function(){return y_}),_.d(b,"AnimationClip",function(){return rd}),_.d(b,"AnimationLoader",function(){return xw}),_.d(b,"AnimationMixer",function(){return R_}),_.d(b,"AnimationObjectGroup",function(){return P_}),_.d(b,"AnimationUtils",function(){return Bn}),_.d(b,"ArcCurve",function(){return Nr}),_.d(b,"ArrayCamera",function(){return Xc}),_.d(b,"ArrowHelper",function(){return Kw}),_.d(b,"Audio",function(){return jg}),_.d(b,"AudioAnalyser",function(){return M_}),_.d(b,"AudioContext",function(){return Vg}),_.d(b,"AudioListener",function(){return Pw}),_.d(b,"AudioLoader",function(){return v_}),_.d(b,"AxesHelper",function(){return X_}),_.d(b,"AxisHelper",function(){return RT}),_.d(b,"BackSide",function(){return j}),_.d(b,"BasicDepthPacking",function(){return nh}),_.d(b,"BasicShadowMap",function(){return A}),_.d(b,"BinaryTextureLoader",function(){return DT}),_.d(b,"Bone",function(){return ll}),_.d(b,"BooleanKeyframeTrack",function(){return Oh}),_.d(b,"BoundingBoxHelper",function(){return CT}),_.d(b,"Box2",function(){return Al}),_.d(b,"Box3",function(){return Rn}),_.d(b,"Box3Helper",function(){return $w}),_.d(b,"BoxBufferGeometry",function(){return Yr}),_.d(b,"BoxGeometry",function(){return Yr}),_.d(b,"BoxHelper",function(){return j_}),_.d(b,"BufferAttribute",function(){return Yt}),_.d(b,"BufferGeometry",function(){return St}),_.d(b,"BufferGeometryLoader",function(){return d_}),_.d(b,"ByteType",function(){return op}),_.d(b,"Cache",function(){return Nh}),_.d(b,"Camera",function(){return Os}),_.d(b,"CameraHelper",function(){return Zw}),_.d(b,"CanvasRenderer",function(){return FT}),_.d(b,"CanvasTexture",function(){return At}),_.d(b,"CatmullRomCurve3",function(){return ml}),_.d(b,"CineonToneMapping",function(){return ep}),_.d(b,"CircleBufferGeometry",function(){return Qe}),_.d(b,"CircleGeometry",function(){return Qe}),_.d(b,"ClampToEdgeWrapping",function(){return di}),_.d(b,"Clock",function(){return w_}),_.d(b,"Color",function(){return ft}),_.d(b,"ColorKeyframeTrack",function(){return Cg}),_.d(b,"CompressedTexture",function(){return vt}),_.d(b,"CompressedTextureLoader",function(){return bw}),_.d(b,"ConeBufferGeometry",function(){return pt}),_.d(b,"ConeGeometry",function(){return pt}),_.d(b,"CubeCamera",function(){return Ds}),_.d(b,"CubeReflectionMapping",function(){return Lo}),_.d(b,"CubeRefractionMapping",function(){return Wa}),_.d(b,"CubeTexture",function(){return Or}),_.d(b,"CubeTextureLoader",function(){return t_}),_.d(b,"CubeUVReflectionMapping",function(){return ra}),_.d(b,"CubeUVRefractionMapping",function(){return oa}),_.d(b,"CubicBezierCurve",function(){return js}),_.d(b,"CubicBezierCurve3",function(){return Oa}),_.d(b,"CubicInterpolant",function(){return J0}),_.d(b,"CullFaceBack",function(){return Ne}),_.d(b,"CullFaceFront",function(){return Le}),_.d(b,"CullFaceFrontBack",function(){return S}),_.d(b,"CullFaceNone",function(){return Te}),_.d(b,"Curve",function(){return Vn}),_.d(b,"CurvePath",function(){return i_}),_.d(b,"CustomBlending",function(){return xe}),_.d(b,"CustomToneMapping",function(){return np}),_.d(b,"CylinderBufferGeometry",function(){return Tt}),_.d(b,"CylinderGeometry",function(){return Tt}),_.d(b,"Cylindrical",function(){return zw}),_.d(b,"DataTexture",function(){return Zo}),_.d(b,"DataTexture2DArray",function(){return $u}),_.d(b,"DataTexture3D",function(){return gr}),_.d(b,"DataTextureLoader",function(){return n_}),_.d(b,"DataUtils",function(){return eT}),_.d(b,"DecrementStencilOp",function(){return Mu}),_.d(b,"DecrementWrapStencilOp",function(){return Om}),_.d(b,"DefaultLoadingManager",function(){return e_}),_.d(b,"DepthFormat",function(){return Ln}),_.d(b,"DepthStencilFormat",function(){return vs}),_.d(b,"DepthTexture",function(){return qe}),_.d(b,"DirectionalLight",function(){return Af}),_.d(b,"DirectionalLightHelper",function(){return qw}),_.d(b,"DiscreteInterpolant",function(){return K0}),_.d(b,"DodecahedronBufferGeometry",function(){return Rt}),_.d(b,"DodecahedronGeometry",function(){return Rt}),_.d(b,"DoubleSide",function(){return J}),_.d(b,"DstAlphaFactor",function(){return Ht}),_.d(b,"DstColorFactor",function(){return In}),_.d(b,"DynamicBufferAttribute",function(){return yT}),_.d(b,"DynamicCopyUsage",function(){return Iu}),_.d(b,"DynamicDrawUsage",function(){return Gr}),_.d(b,"DynamicReadUsage",function(){return Nm}),_.d(b,"EdgesGeometry",function(){return wi}),_.d(b,"EdgesHelper",function(){return IT}),_.d(b,"EllipseCurve",function(){return Fn}),_.d(b,"EqualDepth",function(){return Ei}),_.d(b,"EqualStencilFunc",function(){return Pu}),_.d(b,"EquirectangularReflectionMapping",function(){return Xa}),_.d(b,"EquirectangularRefractionMapping",function(){return Ya}),_.d(b,"Euler",function(){return Ms}),_.d(b,"EventDispatcher",function(){return uo}),_.d(b,"ExtrudeBufferGeometry",function(){return bo}),_.d(b,"ExtrudeGeometry",function(){return bo}),_.d(b,"FaceColors",function(){return hT}),_.d(b,"FileLoader",function(){return So}),_.d(b,"FlatShading",function(){return Je}),_.d(b,"Float16BufferAttribute",function(){return Cp}),_.d(b,"Float32Attribute",function(){return AT}),_.d(b,"Float32BufferAttribute",function(){return rt}),_.d(b,"Float64Attribute",function(){return PT}),_.d(b,"Float64BufferAttribute",function(){return Ec}),_.d(b,"FloatType",function(){return ro}),_.d(b,"Fog",function(){return wh}),_.d(b,"FogExp2",function(){return mi}),_.d(b,"Font",function(){return zg}),_.d(b,"FontLoader",function(){return Ew}),_.d(b,"FrontSide",function(){return G}),_.d(b,"Frustum",function(){return Sa}),_.d(b,"GLBufferAttribute",function(){return I_}),_.d(b,"GLSL1",function(){return cc}),_.d(b,"GLSL3",function(){return dc}),_.d(b,"GammaEncoding",function(){return kn}),_.d(b,"GreaterDepth",function(){return Mr}),_.d(b,"GreaterEqualDepth",function(){return ki}),_.d(b,"GreaterEqualStencilFunc",function(){return Tp}),_.d(b,"GreaterStencilFunc",function(){return Ru}),_.d(b,"GridHelper",function(){return H_}),_.d(b,"Group",function(){return Us}),_.d(b,"HalfFloatType",function(){return gs}),_.d(b,"HemisphereLight",function(){return Og}),_.d(b,"HemisphereLightHelper",function(){return Xw}),_.d(b,"HemisphereLightProbe",function(){return __}),_.d(b,"IcosahedronBufferGeometry",function(){return vl}),_.d(b,"IcosahedronGeometry",function(){return vl}),_.d(b,"ImageBitmapLoader",function(){return m_}),_.d(b,"ImageLoader",function(){return od}),_.d(b,"ImageUtils",function(){return lr}),_.d(b,"ImmediateRenderObject",function(){return F_}),_.d(b,"IncrementStencilOp",function(){return xp}),_.d(b,"IncrementWrapStencilOp",function(){return Lm}),_.d(b,"InstancedBufferAttribute",function(){return Hg}),_.d(b,"InstancedBufferGeometry",function(){return Gg}),_.d(b,"InstancedInterleavedBuffer",function(){return C_}),_.d(b,"InstancedMesh",function(){return Zc}),_.d(b,"Int16Attribute",function(){return TT}),_.d(b,"Int16BufferAttribute",function(){return Sc}),_.d(b,"Int32Attribute",function(){return ET}),_.d(b,"Int32BufferAttribute",function(){return Xu}),_.d(b,"Int8Attribute",function(){return xT}),_.d(b,"Int8BufferAttribute",function(){return dh}),_.d(b,"IntType",function(){return ap}),_.d(b,"InterleavedBuffer",function(){return ks}),_.d(b,"InterleavedBufferAttribute",function(){return xo}),_.d(b,"Interpolant",function(){return Xs}),_.d(b,"InterpolateDiscrete",function(){return Fo}),_.d(b,"InterpolateLinear",function(){return Qa}),_.d(b,"InterpolateSmooth",function(){return ho}),_.d(b,"InvertStencilOp",function(){return Dm}),_.d(b,"JSONLoader",function(){return BT}),_.d(b,"KeepStencilOp",function(){return an}),_.d(b,"KeyframeTrack",function(){return wo}),_.d(b,"LOD",function(){return df}),_.d(b,"LatheBufferGeometry",function(){return _l}),_.d(b,"LatheGeometry",function(){return _l}),_.d(b,"Layers",function(){return gc}),_.d(b,"LensFlare",function(){return kT}),_.d(b,"LessDepth",function(){return ri}),_.d(b,"LessEqualDepth",function(){return Li}),_.d(b,"LessEqualStencilFunc",function(){return bp}),_.d(b,"LessStencilFunc",function(){return Uo}),_.d(b,"Light",function(){return Eo}),_.d(b,"LightProbe",function(){return ad}),_.d(b,"Line",function(){return l}),_.d(b,"Line3",function(){return N_}),_.d(b,"LineBasicMaterial",function(){return gi}),_.d(b,"LineCurve",function(){return Da}),_.d(b,"LineCurve3",function(){return Rh}),_.d(b,"LineDashedMaterial",function(){return Pg}),_.d(b,"LineLoop",function(){return P}),_.d(b,"LinePieces",function(){return sT}),_.d(b,"LineSegments",function(){return E}),_.d(b,"LineStrip",function(){return oT}),_.d(b,"LinearEncoding",function(){return xt}),_.d(b,"LinearFilter",function(){return Yn}),_.d(b,"LinearInterpolant",function(){return Rg}),_.d(b,"LinearMipMapLinearFilter",function(){return rp}),_.d(b,"LinearMipMapNearestFilter",function(){return ip}),_.d(b,"LinearMipmapLinearFilter",function(){return fs}),_.d(b,"LinearMipmapNearestFilter",function(){return Do}),_.d(b,"LinearToneMapping",function(){return Kd}),_.d(b,"Loader",function(){return Xi}),_.d(b,"LoaderUtils",function(){return Rf}),_.d(b,"LoadingManager",function(){return Ig}),_.d(b,"LogLuvEncoding",function(){return _n}),_.d(b,"LoopOnce",function(){return Su}),_.d(b,"LoopPingPong",function(){return ao}),_.d(b,"LoopRepeat",function(){return hc}),_.d(b,"LuminanceAlphaFormat",function(){return ql}),_.d(b,"LuminanceFormat",function(){return cp}),_.d(b,"MOUSE",function(){return K}),_.d(b,"Material",function(){return fi}),_.d(b,"MaterialLoader",function(){return c_}),_.d(b,"Math",function(){return Ts}),_.d(b,"MathUtils",function(){return Ts}),_.d(b,"Matrix3",function(){return Tn}),_.d(b,"Matrix4",function(){return ct}),_.d(b,"MaxEquation",function(){return Xe}),_.d(b,"Mesh",function(){return sn}),_.d(b,"MeshBasicMaterial",function(){return Zn}),_.d(b,"MeshDepthMaterial",function(){return nn}),_.d(b,"MeshDistanceMaterial",function(){return il}),_.d(b,"MeshFaceMaterial",function(){return lT}),_.d(b,"MeshLambertMaterial",function(){return Mf}),_.d(b,"MeshMatcapMaterial",function(){return Ag}),_.d(b,"MeshNormalMaterial",function(){return Mg}),_.d(b,"MeshPhongMaterial",function(){return Ef}),_.d(b,"MeshPhysicalMaterial",function(){return Sg}),_.d(b,"MeshStandardMaterial",function(){return Sf}),_.d(b,"MeshToonMaterial",function(){return Eg}),_.d(b,"MinEquation",function(){return Be}),_.d(b,"MirroredRepeatWrapping",function(){return qa}),_.d(b,"MixOperation",function(){return $d}),_.d(b,"MultiMaterial",function(){return cT}),_.d(b,"MultiplyBlending",function(){return k}),_.d(b,"MultiplyOperation",function(){return ja}),_.d(b,"NearestFilter",function(){return Xn}),_.d(b,"NearestMipMapLinearFilter",function(){return Yl}),_.d(b,"NearestMipMapNearestFilter",function(){return Xl}),_.d(b,"NearestMipmapLinearFilter",function(){return $a}),_.d(b,"NearestMipmapNearestFilter",function(){return Za}),_.d(b,"NeverDepth",function(){return Wn}),_.d(b,"NeverStencilFunc",function(){return Au}),_.d(b,"NoBlending",function(){return Ze}),_.d(b,"NoColors",function(){return aT}),_.d(b,"NoToneMapping",function(){return io}),_.d(b,"NormalAnimationBlendMode",function(){return xs}),_.d(b,"NormalBlending",function(){return se}),_.d(b,"NotEqualDepth",function(){return Zd}),_.d(b,"NotEqualStencilFunc",function(){return wp}),_.d(b,"NumberKeyframeTrack",function(){return nd}),_.d(b,"Object3D",function(){return jt}),_.d(b,"ObjectLoader",function(){return ww}),_.d(b,"ObjectSpaceNormalMap",function(){return ih}),_.d(b,"OctahedronBufferGeometry",function(){return Ch}),_.d(b,"OctahedronGeometry",function(){return Ch}),_.d(b,"OneFactor",function(){return nt}),_.d(b,"OneMinusDstAlphaFactor",function(){return yt}),_.d(b,"OneMinusDstColorFactor",function(){return xn}),_.d(b,"OneMinusSrcAlphaFactor",function(){return Nt}),_.d(b,"OneMinusSrcColorFactor",function(){return st}),_.d(b,"OrthographicCamera",function(){return Ml}),_.d(b,"PCFShadowMap",function(){return I}),_.d(b,"PCFSoftShadowMap",function(){return z}),_.d(b,"PMREMGenerator",function(){return nT}),_.d(b,"ParametricBufferGeometry",function(){return td}),_.d(b,"ParametricGeometry",function(){return td}),_.d(b,"Particle",function(){return pT}),_.d(b,"ParticleBasicMaterial",function(){return gT}),_.d(b,"ParticleSystem",function(){return fT}),_.d(b,"ParticleSystemMaterial",function(){return vT}),_.d(b,"Path",function(){return Fh}),_.d(b,"PerspectiveCamera",function(){return $n}),_.d(b,"Plane",function(){return mr}),_.d(b,"PlaneBufferGeometry",function(){return Pi}),_.d(b,"PlaneGeometry",function(){return Pi}),_.d(b,"PlaneHelper",function(){return Jw}),_.d(b,"PointCloud",function(){return dT}),_.d(b,"PointCloudMaterial",function(){return mT}),_.d(b,"PointLight",function(){return Bg}),_.d(b,"PointLightHelper",function(){return jw}),_.d(b,"Points",function(){return He}),_.d(b,"PointsMaterial",function(){return H}),_.d(b,"PolarGridHelper",function(){return Yw}),_.d(b,"PolyhedronBufferGeometry",function(){return wt}),_.d(b,"PolyhedronGeometry",function(){return wt}),_.d(b,"PositionalAudio",function(){return Cw}),_.d(b,"PropertyBinding",function(){return un}),_.d(b,"PropertyMixer",function(){return A_}),_.d(b,"QuadraticBezierCurve",function(){return Ws}),_.d(b,"QuadraticBezierCurve3",function(){return _g}),_.d(b,"Quaternion",function(){return pi}),_.d(b,"QuaternionKeyframeTrack",function(){return El}),_.d(b,"QuaternionLinearInterpolant",function(){return Q0}),_.d(b,"REVISION",function(){return V}),_.d(b,"RGBADepthPacking",function(){return lc}),_.d(b,"RGBAFormat",function(){return $i}),_.d(b,"RGBAIntegerFormat",function(){return Jl}),_.d(b,"RGBA_ASTC_10x10_Format",function(){return nc}),_.d(b,"RGBA_ASTC_10x5_Format",function(){return Ka}),_.d(b,"RGBA_ASTC_10x6_Format",function(){return _s}),_.d(b,"RGBA_ASTC_10x8_Format",function(){return mp}),_.d(b,"RGBA_ASTC_12x10_Format",function(){return ic}),_.d(b,"RGBA_ASTC_12x12_Format",function(){return yu}),_.d(b,"RGBA_ASTC_4x4_Format",function(){return gu}),_.d(b,"RGBA_ASTC_5x4_Format",function(){return bn}),_.d(b,"RGBA_ASTC_5x5_Format",function(){return so}),_.d(b,"RGBA_ASTC_6x5_Format",function(){return vu}),_.d(b,"RGBA_ASTC_6x6_Format",function(){return pp}),_.d(b,"RGBA_ASTC_8x5_Format",function(){return _u}),_.d(b,"RGBA_ASTC_8x6_Format",function(){return fp}),_.d(b,"RGBA_ASTC_8x8_Format",function(){return tc}),_.d(b,"RGBA_BPTC_Format",function(){return xu}),_.d(b,"RGBA_ETC2_EAC_Format",function(){return aa}),_.d(b,"RGBA_PVRTC_2BPPV1_Format",function(){return Ql}),_.d(b,"RGBA_PVRTC_4BPPV1_Format",function(){return Gi}),_.d(b,"RGBA_S3TC_DXT1_Format",function(){return pu}),_.d(b,"RGBA_S3TC_DXT3_Format",function(){return fu}),_.d(b,"RGBA_S3TC_DXT5_Format",function(){return mu}),_.d(b,"RGBDEncoding",function(){return zi}),_.d(b,"RGBEEncoding",function(){return Ki}),_.d(b,"RGBEFormat",function(){return dp}),_.d(b,"RGBFormat",function(){return oo}),_.d(b,"RGBIntegerFormat",function(){return $l}),_.d(b,"RGBM16Encoding",function(){return uc}),_.d(b,"RGBM7Encoding",function(){return th}),_.d(b,"RGB_ETC1_Format",function(){return ec}),_.d(b,"RGB_ETC2_Format",function(){return kr}),_.d(b,"RGB_PVRTC_2BPPV1_Format",function(){return Kl}),_.d(b,"RGB_PVRTC_4BPPV1_Format",function(){return Oi}),_.d(b,"RGB_S3TC_DXT1_Format",function(){return du}),_.d(b,"RGFormat",function(){return cu}),_.d(b,"RGIntegerFormat",function(){return Ji}),_.d(b,"RawShaderMaterial",function(){return Sl}),_.d(b,"Ray",function(){return mo}),_.d(b,"Raycaster",function(){return Gw}),_.d(b,"RectAreaLight",function(){return Ug}),_.d(b,"RedFormat",function(){return sa}),_.d(b,"RedIntegerFormat",function(){return Zl}),_.d(b,"ReinhardToneMapping",function(){return Qd}),_.d(b,"RepeatWrapping",function(){return Oo}),_.d(b,"ReplaceStencilOp",function(){return Im}),_.d(b,"ReverseSubtractEquation",function(){return Se}),_.d(b,"RingBufferGeometry",function(){return yl}),_.d(b,"RingGeometry",function(){return yl}),_.d(b,"SRGB8_ALPHA8_ASTC_10x10_Format",function(){return _p}),_.d(b,"SRGB8_ALPHA8_ASTC_10x5_Format",function(){return ac}),_.d(b,"SRGB8_ALPHA8_ASTC_10x6_Format",function(){return gp}),_.d(b,"SRGB8_ALPHA8_ASTC_10x8_Format",function(){return vp}),_.d(b,"SRGB8_ALPHA8_ASTC_12x10_Format",function(){return yp}),_.d(b,"SRGB8_ALPHA8_ASTC_12x12_Format",function(){return ys}),_.d(b,"SRGB8_ALPHA8_ASTC_4x4_Format",function(){return rc}),_.d(b,"SRGB8_ALPHA8_ASTC_5x4_Format",function(){return bu}),_.d(b,"SRGB8_ALPHA8_ASTC_5x5_Format",function(){return wu}),_.d(b,"SRGB8_ALPHA8_ASTC_6x5_Format",function(){return oc}),_.d(b,"SRGB8_ALPHA8_ASTC_6x6_Format",function(){return Hi}),_.d(b,"SRGB8_ALPHA8_ASTC_8x5_Format",function(){return Tu}),_.d(b,"SRGB8_ALPHA8_ASTC_8x6_Format",function(){return ha}),_.d(b,"SRGB8_ALPHA8_ASTC_8x8_Format",function(){return sc}),_.d(b,"Scene",function(){return Aa}),_.d(b,"SceneUtils",function(){return UT}),_.d(b,"ShaderChunk",function(){return Ct}),_.d(b,"ShaderLib",function(){return nr}),_.d(b,"ShaderMaterial",function(){return Ni}),_.d(b,"ShadowMaterial",function(){return Tg}),_.d(b,"Shape",function(){return Fa}),_.d(b,"ShapeBufferGeometry",function(){return Ih}),_.d(b,"ShapeGeometry",function(){return Ih}),_.d(b,"ShapePath",function(){return g_}),_.d(b,"ShapeUtils",function(){return Qo}),_.d(b,"ShortType",function(){return sp}),_.d(b,"Skeleton",function(){return cl}),_.d(b,"SkeletonHelper",function(){return U_}),_.d(b,"SkinnedMesh",function(){return Ca}),_.d(b,"SmoothShading",function(){return dt}),_.d(b,"Sphere",function(){return oi}),_.d(b,"SphereBufferGeometry",function(){return Lh}),_.d(b,"SphereGeometry",function(){return Lh}),_.d(b,"Spherical",function(){return Hw}),_.d(b,"SphericalHarmonics3",function(){return kg}),_.d(b,"SplineCurve",function(){return yf}),_.d(b,"SpotLight",function(){return Ng}),_.d(b,"SpotLightHelper",function(){return Vw}),_.d(b,"Sprite",function(){return Ah}),_.d(b,"SpriteMaterial",function(){return Th}),_.d(b,"SrcAlphaFactor",function(){return Kt}),_.d(b,"SrcAlphaSaturateFactor",function(){return fn}),_.d(b,"SrcColorFactor",function(){return Jt}),_.d(b,"StaticCopyUsage",function(){return Bm}),_.d(b,"StaticDrawUsage",function(){return bs}),_.d(b,"StaticReadUsage",function(){return Cu}),_.d(b,"StereoCamera",function(){return Mw}),_.d(b,"StreamCopyUsage",function(){return Lu}),_.d(b,"StreamDrawUsage",function(){return ws}),_.d(b,"StreamReadUsage",function(){return Fm}),_.d(b,"StringKeyframeTrack",function(){return Dh}),_.d(b,"SubtractEquation",function(){return Ie}),_.d(b,"SubtractiveBlending",function(){return Re}),_.d(b,"TOUCH",function(){return re}),_.d(b,"TangentSpaceNormalMap",function(){return ur}),_.d(b,"TetrahedronBufferGeometry",function(){return xl}),_.d(b,"TetrahedronGeometry",function(){return xl}),_.d(b,"TextBufferGeometry",function(){return Tf}),_.d(b,"TextGeometry",function(){return Tf}),_.d(b,"Texture",function(){return qn}),_.d(b,"TextureLoader",function(){return Lg}),_.d(b,"TorusBufferGeometry",function(){return bl}),_.d(b,"TorusGeometry",function(){return bl}),_.d(b,"TorusKnotBufferGeometry",function(){return wl}),_.d(b,"TorusKnotGeometry",function(){return wl}),_.d(b,"Triangle",function(){return Sn}),_.d(b,"TriangleFanDrawMode",function(){return ut}),_.d(b,"TriangleStripDrawMode",function(){return Ye}),_.d(b,"TrianglesDrawMode",function(){return Ve}),_.d(b,"TubeBufferGeometry",function(){return Tl}),_.d(b,"TubeGeometry",function(){return Tl}),_.d(b,"UVMapping",function(){return lu}),_.d(b,"Uint16Attribute",function(){return ST}),_.d(b,"Uint16BufferAttribute",function(){return va}),_.d(b,"Uint32Attribute",function(){return MT}),_.d(b,"Uint32BufferAttribute",function(){return Lr}),_.d(b,"Uint8Attribute",function(){return bT}),_.d(b,"Uint8BufferAttribute",function(){return Tc}),_.d(b,"Uint8ClampedAttribute",function(){return wT}),_.d(b,"Uint8ClampedBufferAttribute",function(){return Wu}),_.d(b,"Uniform",function(){return If}),_.d(b,"UniformsLib",function(){return lt}),_.d(b,"UniformsUtils",function(){return qr}),_.d(b,"UnsignedByteType",function(){return No}),_.d(b,"UnsignedInt248Type",function(){return ln}),_.d(b,"UnsignedIntType",function(){return ms}),_.d(b,"UnsignedShort4444Type",function(){return hp}),_.d(b,"UnsignedShort5551Type",function(){return up}),_.d(b,"UnsignedShort565Type",function(){return lp}),_.d(b,"UnsignedShortType",function(){return Ja}),_.d(b,"VSMShadowMap",function(){return L}),_.d(b,"Vector2",function(){return $e}),_.d(b,"Vector3",function(){return w}),_.d(b,"Vector4",function(){return cn}),_.d(b,"VectorKeyframeTrack",function(){return id}),_.d(b,"Vertex",function(){return _T}),_.d(b,"VertexColors",function(){return uT}),_.d(b,"VideoTexture",function(){return mt}),_.d(b,"WebGL1Renderer",function(){return hi}),_.d(b,"WebGLCubeRenderTarget",function(){return Mt}),_.d(b,"WebGLMultipleRenderTargets",function(){return ah}),_.d(b,"WebGLMultisampleRenderTarget",function(){return Ss}),_.d(b,"WebGLRenderTarget",function(){return Ar}),_.d(b,"WebGLRenderTargetCube",function(){return NT}),_.d(b,"WebGLRenderer",function(){return dn}),_.d(b,"WebGLUtils",function(){return hf}),_.d(b,"WireframeGeometry",function(){return wg}),_.d(b,"WireframeHelper",function(){return LT}),_.d(b,"WrapAroundEnding",function(){return eh}),_.d(b,"XHRLoader",function(){return OT}),_.d(b,"ZeroCurvatureEnding",function(){return _i}),_.d(b,"ZeroFactor",function(){return ot}),_.d(b,"ZeroSlopeEnding",function(){return Bo}),_.d(b,"ZeroStencilOp",function(){return Eu}),_.d(b,"sRGBEncoding",function(){return Zt});var ee={};_.r(ee),_.d(ee,"isMobile",function(){return Kr}),_.d(ee,"EventEmitter",function(){return Il.a}),_.d(ee,"earcut",function(){return hv.a}),_.d(ee,"BaseTextureCache",function(){return eo}),_.d(ee,"CanvasRenderTarget",function(){return xv}),_.d(ee,"DATA_URI",function(){return By}),_.d(ee,"ProgramCache",function(){return yv}),_.d(ee,"TextureCache",function(){return br}),_.d(ee,"clearTextureCache",function(){return oS}),_.d(ee,"correctBlendMode",function(){return mv}),_.d(ee,"createIndicesForQuads",function(){return Oy}),_.d(ee,"decomposeDataUri",function(){return sS}),_.d(ee,"deprecation",function(){return Zh}),_.d(ee,"destroyTextureCache",function(){return rS}),_.d(ee,"determineCrossOrigin",function(){return Uy}),_.d(ee,"getBufferType",function(){return Dy}),_.d(ee,"getResolutionOfUrl",function(){return fd}),_.d(ee,"hex2rgb",function(){return Wh}),_.d(ee,"hex2string",function(){return dv}),_.d(ee,"interleaveTypedArrays",function(){return nS}),_.d(ee,"isPow2",function(){return vv}),_.d(ee,"isWebGLSupported",function(){return Iy}),_.d(ee,"log2",function(){return _v}),_.d(ee,"nextPow2",function(){return pd}),_.d(ee,"premultiplyBlendMode",function(){return fv}),_.d(ee,"premultiplyRgba",function(){return Ly}),_.d(ee,"premultiplyTint",function(){return Vf}),_.d(ee,"premultiplyTintToRgba",function(){return gv}),_.d(ee,"removeItems",function(){return Xh}),_.d(ee,"rgb2hex",function(){return eS}),_.d(ee,"sayHello",function(){return Cy}),_.d(ee,"sign",function(){return Yh}),_.d(ee,"skipHello",function(){return KT}),_.d(ee,"string2hex",function(){return pv}),_.d(ee,"trimCanvas",function(){return Fy}),_.d(ee,"uid",function(){return qh}),_.d(ee,"url",function(){return jh});var N={};_.r(N),_.d(N,"utils",function(){return ee}),_.d(N,"AccessibilityManager",function(){return Xy}),_.d(N,"accessibleTarget",function(){return Wy}),_.d(N,"InteractionData",function(){return Av}),_.d(N,"InteractionEvent",function(){return Zy}),_.d(N,"InteractionManager",function(){return Jy}),_.d(N,"InteractionTrackingData",function(){return Xf}),_.d(N,"interactiveTarget",function(){return $y}),_.d(N,"Application",function(){return Sd}),_.d(N,"AbstractBatchRenderer",function(){return Ax}),_.d(N,"AbstractMultiResource",function(){return Zf}),_.d(N,"AbstractRenderer",function(){return Sx}),_.d(N,"ArrayResource",function(){return Pv}),_.d(N,"Attribute",function(){return Dv}),_.d(N,"BaseImageResource",function(){return ss}),_.d(N,"BaseRenderTexture",function(){return Lv}),_.d(N,"BaseTexture",function(){return mn}),_.d(N,"BatchDrawCall",function(){return hm}),_.d(N,"BatchGeometry",function(){return t0}),_.d(N,"BatchPluginFactory",function(){return Ix}),_.d(N,"BatchRenderer",function(){return Lx}),_.d(N,"BatchShaderGenerator",function(){return Px}),_.d(N,"BatchSystem",function(){return Uv}),_.d(N,"BatchTextureArray",function(){return um}),_.d(N,"Buffer",function(){return Ii}),_.d(N,"BufferResource",function(){return Ll}),_.d(N,"CanvasResource",function(){return $f}),_.d(N,"ContextSystem",function(){return kv}),_.d(N,"CubeResource",function(){return Rv}),_.d(N,"Filter",function(){return Sr}),_.d(N,"FilterState",function(){return ox}),_.d(N,"FilterSystem",function(){return Bv}),_.d(N,"Framebuffer",function(){return Qf}),_.d(N,"FramebufferSystem",function(){return Gv}),_.d(N,"GLFramebuffer",function(){return ax}),_.d(N,"GLProgram",function(){return bx}),_.d(N,"GLTexture",function(){return am}),_.d(N,"Geometry",function(){return nu}),_.d(N,"GeometrySystem",function(){return zv}),_.d(N,"IGLUniformData",function(){return ES}),_.d(N,"INSTALLED",function(){return _d}),_.d(N,"ImageBitmapResource",function(){return Iv}),_.d(N,"ImageResource",function(){return Jf}),_.d(N,"MaskData",function(){return hx}),_.d(N,"MaskSystem",function(){return jv}),_.d(N,"ObjectRenderer",function(){return yd}),_.d(N,"Program",function(){return wd}),_.d(N,"ProjectionSystem",function(){return Yv}),_.d(N,"Quad",function(){return rx}),_.d(N,"QuadUv",function(){return Nv}),_.d(N,"RenderTexture",function(){return to}),_.d(N,"RenderTexturePool",function(){return tx}),_.d(N,"RenderTextureSystem",function(){return qv}),_.d(N,"Renderer",function(){return Js}),_.d(N,"Resource",function(){return tu}),_.d(N,"SVGResource",function(){return Cv}),_.d(N,"ScissorSystem",function(){return Wv}),_.d(N,"Shader",function(){return $s}),_.d(N,"ShaderSystem",function(){return Zv}),_.d(N,"SpriteMaskFilter",function(){return yx}),_.d(N,"State",function(){return Ga}),_.d(N,"StateSystem",function(){return $v}),_.d(N,"StencilSystem",function(){return Xv}),_.d(N,"System",function(){return Tr}),_.d(N,"Texture",function(){return Ot}),_.d(N,"TextureGCSystem",function(){return Jv}),_.d(N,"TextureMatrix",function(){return sm}),_.d(N,"TextureSystem",function(){return Kv}),_.d(N,"TextureUvs",function(){return Ov}),_.d(N,"UniformGroup",function(){return ka}),_.d(N,"VideoResource",function(){return Kf}),_.d(N,"ViewableBuffer",function(){return lm}),_.d(N,"autoDetectRenderer",function(){return Ex}),_.d(N,"autoDetectResource",function(){return qf}),_.d(N,"checkMaxIfStatementsInShader",function(){return vx}),_.d(N,"defaultFilterVertex",function(){return e0}),_.d(N,"defaultVertex",function(){return Mx}),_.d(N,"resources",function(){return Ox}),_.d(N,"systems",function(){return Dx}),_.d(N,"uniformParsers",function(){return rm}),_.d(N,"Extract",function(){return Fx}),_.d(N,"AppLoaderPlugin",function(){return Wx}),_.d(N,"Loader",function(){return as}),_.d(N,"LoaderResource",function(){return no}),_.d(N,"TextureLoader",function(){return jx}),_.d(N,"BlobResource",function(){return qx}),_.d(N,"CompressedTextureLoader",function(){return Zx}),_.d(N,"CompressedTextureResource",function(){return pm}),_.d(N,"DDSLoader",function(){return Jx}),_.d(N,"FORMATS_TO_COMPONENTS",function(){return Qx}),_.d(N,"INTERNAL_FORMATS",function(){return qt}),_.d(N,"INTERNAL_FORMAT_TO_BYTES_PER_PIXEL",function(){return Ed}),_.d(N,"KTXLoader",function(){return t1}),_.d(N,"TYPES_TO_BYTES_PER_COMPONENT",function(){return s0}),_.d(N,"TYPES_TO_BYTES_PER_PIXEL",function(){return e1}),_.d(N,"ParticleContainer",function(){return aE}),_.d(N,"ParticleRenderer",function(){return o1}),_.d(N,"BasePrepare",function(){return x1}),_.d(N,"CountLimiter",function(){return y1}),_.d(N,"Prepare",function(){return w1}),_.d(N,"TimeLimiter",function(){return TE}),_.d(N,"Spritesheet",function(){return T1}),_.d(N,"SpritesheetLoader",function(){return S1}),_.d(N,"TilingSprite",function(){return SE}),_.d(N,"TilingSpriteRenderer",function(){return P1}),_.d(N,"BitmapFont",function(){return Gl}),_.d(N,"BitmapFontData",function(){return Ld}),_.d(N,"BitmapFontLoader",function(){return B1}),_.d(N,"BitmapText",function(){return PE}),_.d(N,"Ticker",function(){return Ci}),_.d(N,"TickerPlugin",function(){return Yy}),_.d(N,"UPDATE_PRIORITY",function(){return wr}),_.d(N,"ALPHA_MODES",function(){return os}),_.d(N,"BLEND_MODES",function(){return Dt}),_.d(N,"BUFFER_BITS",function(){return cd}),_.d(N,"CLEAR_MODES",function(){return Zs}),_.d(N,"DRAW_MODES",function(){return Qr}),_.d(N,"ENV",function(){return ns}),_.d(N,"FORMATS",function(){return Mo}),_.d(N,"GC_MODES",function(){return zf}),_.d(N,"MASK_TYPES",function(){return xr}),_.d(N,"MIPMAP_MODES",function(){return qs}),_.d(N,"MSAA_QUALITY",function(){return Vh}),_.d(N,"PRECISION",function(){return Ao}),_.d(N,"RENDERER_TYPE",function(){return Cl}),_.d(N,"SAMPLER_TYPES",function(){return dd}),_.d(N,"SCALE_MODES",function(){return is}),_.d(N,"TARGETS",function(){return Ua}),_.d(N,"TYPES",function(){return yn}),_.d(N,"WRAP_MODES",function(){return rs}),_.d(N,"Bounds",function(){return vd}),_.d(N,"Container",function(){return Ti}),_.d(N,"DisplayObject",function(){return ci}),_.d(N,"TemporaryDisplayObject",function(){return Ev}),_.d(N,"FillStyle",function(){return a0}),_.d(N,"GRAPHICS_CURVES",function(){return Dl}),_.d(N,"Graphics",function(){return na}),_.d(N,"GraphicsData",function(){return f0}),_.d(N,"GraphicsGeometry",function(){return p1}),_.d(N,"LINE_CAP",function(){return ta}),_.d(N,"LINE_JOIN",function(){return ea}),_.d(N,"LineStyle",function(){return f1}),_.d(N,"graphicsUtils",function(){return lE}),_.d(N,"Circle",function(){return Hy}),_.d(N,"DEG_TO_RAD",function(){return Gy}),_.d(N,"Ellipse",function(){return zy}),_.d(N,"Matrix",function(){return li}),_.d(N,"ObservablePoint",function(){return $h}),_.d(N,"PI_2",function(){return md}),_.d(N,"Point",function(){return ni}),_.d(N,"Polygon",function(){return gd}),_.d(N,"RAD_TO_DEG",function(){return ky}),_.d(N,"Rectangle",function(){return en}),_.d(N,"RoundedRectangle",function(){return bv}),_.d(N,"SHAPES",function(){return ti}),_.d(N,"Transform",function(){return Tv}),_.d(N,"groupD8",function(){return jn}),_.d(N,"Mesh",function(){return su}),_.d(N,"MeshBatchUvs",function(){return C1}),_.d(N,"MeshGeometry",function(){return Id}),_.d(N,"MeshMaterial",function(){return Cd}),_.d(N,"NineSlicePlane",function(){return kE}),_.d(N,"PlaneGeometry",function(){return lb}),_.d(N,"RopeGeometry",function(){return cb}),_.d(N,"SimpleMesh",function(){return UE}),_.d(N,"SimplePlane",function(){return db}),_.d(N,"SimpleRope",function(){return BE}),_.d(N,"Runner",function(){return Ui}),_.d(N,"Sprite",function(){return Un}),_.d(N,"AnimatedSprite",function(){return E0}),_.d(N,"TEXT_GRADIENT",function(){return kl}),_.d(N,"Text",function(){return _m}),_.d(N,"TextMetrics",function(){return Fr}),_.d(N,"TextStyle",function(){return ou}),_.d(N,"isMobile",function(){return Kr}),_.d(N,"settings",function(){return Et}),_.d(N,"VERSION",function(){return GE}),_.d(N,"filters",function(){return Dd});var ne=_(0),B=_.n(ne),ie=_(1);/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const V="130",K={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},re={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Te=0,Ne=1,Le=2,S=3,A=0,I=1,z=2,L=3,G=0,j=1,J=2,Je=1,dt=2,Ze=0,se=1,Ae=2,Re=3,k=4,xe=5,Ee=100,Ie=101,Se=102,Be=103,Xe=104,ot=200,nt=201,Jt=202,st=203,Kt=204,Nt=205,Ht=206,yt=207,In=208,xn=209,fn=210,Wn=0,vn=1,ri=2,Li=3,Ei=4,ki=5,Mr=6,Zd=7,ja=0,$d=1,Jd=2,io=0,Kd=1,Qd=2,ep=3,tp=4,np=5,lu=300,Lo=301,Wa=302,Xa=303,Ya=304,ra=306,oa=307,Oo=1e3,di=1001,qa=1002,Xn=1003,Za=1004,Xl=1004,$a=1005,Yl=1005,Yn=1006,Do=1007,ip=1007,fs=1008,rp=1008,No=1009,op=1010,sp=1011,Ja=1012,ap=1013,ms=1014,ro=1015,gs=1016,hp=1017,up=1018,lp=1019,ln=1020,gn=1021,oo=1022,$i=1023,cp=1024,ql=1025,dp=$i,Ln=1026,vs=1027,sa=1028,Zl=1029,cu=1030,Ji=1031,$l=1032,Jl=1033,du=33776,pu=33777,fu=33778,mu=33779,Oi=35840,Kl=35841,Gi=35842,Ql=35843,ec=36196,kr=37492,aa=37496,gu=37808,bn=37809,so=37810,vu=37811,pp=37812,_u=37813,fp=37814,tc=37815,Ka=37816,_s=37817,mp=37818,nc=37819,ic=37820,yu=37821,xu=36492,rc=37840,bu=37841,wu=37842,oc=37843,Hi=37844,Tu=37845,ha=37846,sc=37847,ac=37848,gp=37849,vp=37850,_p=37851,yp=37852,ys=37853,Su=2200,hc=2201,ao=2202,Fo=2300,Qa=2301,ho=2302,_i=2400,Bo=2401,eh=2402,xs=2500,be=2501,Ve=0,Ye=1,ut=2,xt=3e3,Zt=3001,kn=3007,Ki=3002,_n=3003,th=3004,uc=3005,zi=3006,nh=3200,lc=3201,ur=0,ih=1,Eu=0,an=7680,Im=7681,xp=7682,Mu=7683,Lm=34055,Om=34056,Dm=5386,Au=512,Uo=513,Pu=514,bp=515,Ru=516,wp=517,Tp=518,rh=519,bs=35044,Gr=35048,ws=35040,Cu=35045,Nm=35049,Fm=35041,Bm=35046,Iu=35050,Lu=35042,cc="100",dc="300 es";class uo{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const n=t.slice(0);for(let i=0,o=n.length;i<o;i++)n[i].call(this,e);e.target=null}}}const yi=[];for(let r=0;r<256;r++)yi[r]=(r<16?"0":"")+r.toString(16);let Ou=1234567;const wn=Math.PI/180,Qn=180/Math.PI;function Qi(){const r=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(yi[255&r]+yi[r>>8&255]+yi[r>>16&255]+yi[r>>24&255]+"-"+yi[255&e]+yi[e>>8&255]+"-"+yi[e>>16&15|64]+yi[e>>24&255]+"-"+yi[63&t|128]+yi[t>>8&255]+"-"+yi[t>>16&255]+yi[t>>24&255]+yi[255&n]+yi[n>>8&255]+yi[n>>16&255]+yi[n>>24&255]).toUpperCase()}function xi(r,e,t){return Math.max(e,Math.min(t,r))}function Du(r,e){return(r%e+e)%e}function oh(r,e,t){return(1-t)*r+t*e}function sh(r){return(r&r-1)==0&&r!==0}function ua(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function Nu(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}var Ts=Object.freeze({__proto__:null,DEG2RAD:wn,RAD2DEG:Qn,generateUUID:Qi,clamp:xi,euclideanModulo:Du,mapLinear:function(r,e,t,n,i){return n+(r-e)*(i-n)/(t-e)},inverseLerp:function(r,e,t){return r!==e?(t-r)/(e-r):0},lerp:oh,damp:function(r,e,t,n){return oh(r,e,1-Math.exp(-t*n))},pingpong:function(r,e=1){return e-Math.abs(Du(r,2*e)-e)},smoothstep:function(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e))*r*(3-2*r)},smootherstep:function(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e))*r*r*(r*(6*r-15)+10)},randInt:function(r,e){return r+Math.floor(Math.random()*(e-r+1))},randFloat:function(r,e){return r+Math.random()*(e-r)},randFloatSpread:function(r){return r*(.5-Math.random())},seededRandom:function(r){return r!==void 0&&(Ou=r%2147483647),Ou=16807*Ou%2147483647,(Ou-1)/2147483646},degToRad:function(r){return r*wn},radToDeg:function(r){return r*Qn},isPowerOfTwo:sh,ceilPowerOfTwo:ua,floorPowerOfTwo:Nu,setQuaternionFromProperEuler:function(r,e,t,n,i){const o=Math.cos,s=Math.sin,a=o(t/2),h=s(t/2),u=o((e+n)/2),c=s((e+n)/2),d=o((e-n)/2),f=s((e-n)/2),m=o((n-e)/2),g=s((n-e)/2);switch(i){case"XYX":r.set(a*c,h*d,h*f,a*u);break;case"YZY":r.set(h*f,a*c,h*d,a*u);break;case"ZXZ":r.set(h*d,h*f,a*c,a*u);break;case"XZX":r.set(a*c,h*g,h*m,a*u);break;case"YXY":r.set(h*m,a*c,h*g,a*u);break;case"ZYZ":r.set(h*g,h*m,a*c,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}});class $e{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),o=this.x-e.x,s=this.y-e.y;return this.x=o*n-s*i+e.x,this.y=o*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}$e.prototype.isVector2=!0;class Tn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,o,s,a,h,u){const c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=o,c[5]=h,c[6]=n,c[7]=s,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,o=this.elements,s=n[0],a=n[3],h=n[6],u=n[1],c=n[4],d=n[7],f=n[2],m=n[5],g=n[8],v=i[0],x=i[3],T=i[6],M=i[1],C=i[4],D=i[7],R=i[2],F=i[5],O=i[8];return o[0]=s*v+a*M+h*R,o[3]=s*x+a*C+h*F,o[6]=s*T+a*D+h*O,o[1]=u*v+c*M+d*R,o[4]=u*x+c*C+d*F,o[7]=u*T+c*D+d*O,o[2]=f*v+m*M+g*R,o[5]=f*x+m*C+g*F,o[8]=f*T+m*D+g*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],h=e[6],u=e[7],c=e[8];return t*s*c-t*a*u-n*o*c+n*a*h+i*o*u-i*s*h}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],h=e[6],u=e[7],c=e[8],d=c*s-a*u,f=a*h-c*o,m=u*o-s*h,g=t*d+n*f+i*m;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/g;return e[0]=d*v,e[1]=(i*u-c*n)*v,e[2]=(a*n-i*s)*v,e[3]=f*v,e[4]=(c*t-i*h)*v,e[5]=(i*o-a*t)*v,e[6]=m*v,e[7]=(n*h-u*t)*v,e[8]=(s*t-n*o)*v,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,o,s,a){const h=Math.cos(o),u=Math.sin(o);return this.set(n*h,n*u,-n*(h*s+u*a)+s+e,-i*u,i*h,-i*(-u*s+h*a)+a+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),i=this.elements,o=i[0],s=i[3],a=i[6],h=i[1],u=i[4],c=i[7];return i[0]=t*o+n*h,i[3]=t*s+n*u,i[6]=t*a+n*c,i[1]=-n*o+t*h,i[4]=-n*s+t*u,i[7]=-n*a+t*c,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}let lo;Tn.prototype.isMatrix3=!0;class lr{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement=="undefined")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{lo===void 0&&(lo=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),lo.width=e.width,lo.height=e.height;const n=lo.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=lo}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}}let Um=0;class qn extends uo{constructor(e=qn.DEFAULT_IMAGE,t=qn.DEFAULT_MAPPING,n=di,i=di,o=Yn,s=fs,a=$i,h=No,u=1,c=xt){super(),Object.defineProperty(this,"id",{value:Um++}),this.uuid=Qi(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=o,this.minFilter=s,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=h,this.offset=new $e(0,0),this.repeat=new $e(1,1),this.center=new $e(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Tn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const i=this.image;if(i.uuid===void 0&&(i.uuid=Qi()),!t&&e.images[i.uuid]===void 0){let o;if(Array.isArray(i)){o=[];for(let s=0,a=i.length;s<a;s++)i[s].isDataTexture?o.push(pc(i[s].image)):o.push(pc(i[s]))}else o=pc(i);e.images[i.uuid]={uuid:i.uuid,url:o}}n.image=i.uuid}return t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==lu)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Oo:e.x=e.x-Math.floor(e.x);break;case di:e.x=e.x<0?0:1;break;case qa:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Oo:e.y=e.y-Math.floor(e.y);break;case di:e.y=e.y<0?0:1;break;case qa:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&this.version++}}function pc(r){return typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&r instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&r instanceof ImageBitmap?lr.getDataURL(r):r.data?{data:Array.prototype.slice.call(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}qn.DEFAULT_IMAGE=void 0,qn.DEFAULT_MAPPING=lu,qn.prototype.isTexture=!0;class cn{constructor(e=0,t=0,n=0,i=1){this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,o=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*o,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*o,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*o,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,o;const s=e.elements,a=s[0],h=s[4],u=s[8],c=s[1],d=s[5],f=s[9],m=s[2],g=s[6],v=s[10];if(Math.abs(h-c)<.01&&Math.abs(u-m)<.01&&Math.abs(f-g)<.01){if(Math.abs(h+c)<.1&&Math.abs(u+m)<.1&&Math.abs(f+g)<.1&&Math.abs(a+d+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const T=(a+1)/2,M=(d+1)/2,C=(v+1)/2,D=(h+c)/4,R=(u+m)/4,F=(f+g)/4;return T>M&&T>C?T<.01?(n=0,i=.707106781,o=.707106781):(n=Math.sqrt(T),i=D/n,o=R/n):M>C?M<.01?(n=.707106781,i=0,o=.707106781):(i=Math.sqrt(M),n=D/i,o=F/i):C<.01?(n=.707106781,i=.707106781,o=0):(o=Math.sqrt(C),n=R/o,i=F/o),this.set(n,i,o,t),this}let x=Math.sqrt((g-f)*(g-f)+(u-m)*(u-m)+(c-h)*(c-h));return Math.abs(x)<.001&&(x=1),this.x=(g-f)/x,this.y=(u-m)/x,this.z=(c-h)/x,this.w=Math.acos((a+d+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}cn.prototype.isVector4=!0;class Ar extends uo{constructor(e,t,n={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new cn(0,0,e,t),this.scissorTest=!1,this.viewport=new cn(0,0,e,t),this.texture=new qn(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=n.generateMipmaps!==void 0&&n.generateMipmaps,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Yn,this.depthBuffer=n.depthBuffer===void 0||n.depthBuffer,this.stencilBuffer=n.stencilBuffer!==void 0&&n.stencilBuffer,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=sw({},this.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Ar.prototype.isWebGLRenderTarget=!0;class ah extends Ar{constructor(e,t,n){super(e,t);const i=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=i.clone()}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,o=this.texture.length;i<o;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}ah.prototype.isWebGLMultipleRenderTargets=!0;class Ss extends Ar{constructor(e,t,n){super(e,t,n),this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}Ss.prototype.isWebGLMultisampleRenderTarget=!0;class pi{constructor(e=0,t=0,n=0,i=1){this._x=e,this._y=t,this._z=n,this._w=i}static slerp(e,t,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,i)}static slerpFlat(e,t,n,i,o,s,a){let h=n[i+0],u=n[i+1],c=n[i+2],d=n[i+3];const f=o[s+0],m=o[s+1],g=o[s+2],v=o[s+3];if(a===0)return e[t+0]=h,e[t+1]=u,e[t+2]=c,void(e[t+3]=d);if(a===1)return e[t+0]=f,e[t+1]=m,e[t+2]=g,void(e[t+3]=v);if(d!==v||h!==f||u!==m||c!==g){let x=1-a;const T=h*f+u*m+c*g+d*v,M=T>=0?1:-1,C=1-T*T;if(C>Number.EPSILON){const R=Math.sqrt(C),F=Math.atan2(R,T*M);x=Math.sin(x*F)/R,a=Math.sin(a*F)/R}const D=a*M;if(h=h*x+f*D,u=u*x+m*D,c=c*x+g*D,d=d*x+v*D,x===1-a){const R=1/Math.sqrt(h*h+u*u+c*c+d*d);h*=R,u*=R,c*=R,d*=R}}e[t]=h,e[t+1]=u,e[t+2]=c,e[t+3]=d}static multiplyQuaternionsFlat(e,t,n,i,o,s){const a=n[i],h=n[i+1],u=n[i+2],c=n[i+3],d=o[s],f=o[s+1],m=o[s+2],g=o[s+3];return e[t]=a*g+c*d+h*m-u*f,e[t+1]=h*g+c*f+u*d-a*m,e[t+2]=u*g+c*m+a*f-h*d,e[t+3]=c*g-a*d-h*f-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,i=e._y,o=e._z,s=e._order,a=Math.cos,h=Math.sin,u=a(n/2),c=a(i/2),d=a(o/2),f=h(n/2),m=h(i/2),g=h(o/2);switch(s){case"XYZ":this._x=f*c*d+u*m*g,this._y=u*m*d-f*c*g,this._z=u*c*g+f*m*d,this._w=u*c*d-f*m*g;break;case"YXZ":this._x=f*c*d+u*m*g,this._y=u*m*d-f*c*g,this._z=u*c*g-f*m*d,this._w=u*c*d+f*m*g;break;case"ZXY":this._x=f*c*d-u*m*g,this._y=u*m*d+f*c*g,this._z=u*c*g+f*m*d,this._w=u*c*d-f*m*g;break;case"ZYX":this._x=f*c*d-u*m*g,this._y=u*m*d+f*c*g,this._z=u*c*g-f*m*d,this._w=u*c*d+f*m*g;break;case"YZX":this._x=f*c*d+u*m*g,this._y=u*m*d+f*c*g,this._z=u*c*g-f*m*d,this._w=u*c*d-f*m*g;break;case"XZY":this._x=f*c*d-u*m*g,this._y=u*m*d-f*c*g,this._z=u*c*g+f*m*d,this._w=u*c*d+f*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],o=t[8],s=t[1],a=t[5],h=t[9],u=t[2],c=t[6],d=t[10],f=n+a+d;if(f>0){const m=.5/Math.sqrt(f+1);this._w=.25/m,this._x=(c-h)*m,this._y=(o-u)*m,this._z=(s-i)*m}else if(n>a&&n>d){const m=2*Math.sqrt(1+n-a-d);this._w=(c-h)/m,this._x=.25*m,this._y=(i+s)/m,this._z=(o+u)/m}else if(a>d){const m=2*Math.sqrt(1+a-n-d);this._w=(o-u)/m,this._x=(i+s)/m,this._y=.25*m,this._z=(h+c)/m}else{const m=2*Math.sqrt(1+d-n-a);this._w=(s-i)/m,this._x=(o+u)/m,this._y=(h+c)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(xi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,o=e._z,s=e._w,a=t._x,h=t._y,u=t._z,c=t._w;return this._x=n*c+s*a+i*u-o*h,this._y=i*c+s*h+o*a-n*u,this._z=o*c+s*u+n*h-i*a,this._w=s*c-n*a-i*h-o*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,o=this._z,s=this._w;let a=s*e._w+n*e._x+i*e._y+o*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=n,this._y=i,this._z=o,this;const h=1-a*a;if(h<=Number.EPSILON){const m=1-t;return this._w=m*s+t*this._w,this._x=m*n+t*this._x,this._y=m*i+t*this._y,this._z=m*o+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(h),c=Math.atan2(u,a),d=Math.sin((1-t)*c)/u,f=Math.sin(t*c)/u;return this._w=s*d+this._w*f,this._x=n*d+this._x*f,this._y=i*d+this._y*f,this._z=o*d+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,n){this.copy(e).slerp(t,n)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}pi.prototype.isQuaternion=!0;class w{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(hh.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(hh.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,o=e.elements;return this.x=o[0]*t+o[3]*n+o[6]*i,this.y=o[1]*t+o[4]*n+o[7]*i,this.z=o[2]*t+o[5]*n+o[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,o=e.elements,s=1/(o[3]*t+o[7]*n+o[11]*i+o[15]);return this.x=(o[0]*t+o[4]*n+o[8]*i+o[12])*s,this.y=(o[1]*t+o[5]*n+o[9]*i+o[13])*s,this.z=(o[2]*t+o[6]*n+o[10]*i+o[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,o=e.x,s=e.y,a=e.z,h=e.w,u=h*t+s*i-a*n,c=h*n+a*t-o*i,d=h*i+o*n-s*t,f=-o*t-s*n-a*i;return this.x=u*h+f*-o+c*-a-d*-s,this.y=c*h+f*-s+d*-o-u*-a,this.z=d*h+f*-a+u*-s-c*-o,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i,this.y=o[1]*t+o[5]*n+o[9]*i,this.z=o[2]*t+o[6]*n+o[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,o=e.z,s=t.x,a=t.y,h=t.z;return this.x=i*h-o*a,this.y=o*s-n*h,this.z=n*a-i*s,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return ko.copy(this).projectOnVector(e),this.sub(ko)}reflect(e){return this.sub(ko.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(xi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}w.prototype.isVector3=!0;const ko=new w,hh=new pi;class Rn{constructor(e=new w(1/0,1/0,1/0),t=new w(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,o=-1/0,s=-1/0,a=-1/0;for(let h=0,u=e.length;h<u;h+=3){const c=e[h],d=e[h+1],f=e[h+2];c<t&&(t=c),d<n&&(n=d),f<i&&(i=f),c>o&&(o=c),d>s&&(s=d),f>a&&(a=f)}return this.min.set(t,n,i),this.max.set(o,s,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,o=-1/0,s=-1/0,a=-1/0;for(let h=0,u=e.count;h<u;h++){const c=e.getX(h),d=e.getY(h),f=e.getZ(h);c<t&&(t=c),d<n&&(n=d),f<i&&(i=f),c>o&&(o=c),d>s&&(s=d),f>a&&(a=f)}return this.min.set(t,n,i),this.max.set(o,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Pr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;t!==void 0&&(t.boundingBox===null&&t.computeBoundingBox(),Rr.copy(t.boundingBox),Rr.applyMatrix4(e.matrixWorld),this.union(Rr));const n=e.children;for(let i=0,o=n.length;i<o;i++)this.expandByObject(n[i]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Pr),Pr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(uh),la.subVectors(this.max,uh),Vi.subVectors(e.a,uh),cr.subVectors(e.b,uh),Mi.subVectors(e.c,uh),co.subVectors(cr,Vi),po.subVectors(Mi,cr),Es.subVectors(Vi,Mi);let t=[0,-co.z,co.y,0,-po.z,po.y,0,-Es.z,Es.y,co.z,0,-co.x,po.z,0,-po.x,Es.z,0,-Es.x,-co.y,co.x,0,-po.y,po.x,0,-Es.y,Es.x,0];return!!fc(t,Vi,cr,Mi,la)&&(t=[1,0,0,0,1,0,0,0,1],!!fc(t,Vi,cr,Mi,la)&&(Go.crossVectors(co,po),t=[Go.x,Go.y,Go.z],fc(t,Vi,cr,Mi,la)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Pr.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Pr).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(kt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),kt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),kt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),kt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),kt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),kt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),kt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),kt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(kt)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Rn.prototype.isBox3=!0;const kt=[new w,new w,new w,new w,new w,new w,new w,new w],Pr=new w,Rr=new Rn,Vi=new w,cr=new w,Mi=new w,co=new w,po=new w,Es=new w,uh=new w,la=new w,Go=new w,Hr=new w;function fc(r,e,t,n,i){for(let o=0,s=r.length-3;o<=s;o+=3){Hr.fromArray(r,o);const a=i.x*Math.abs(Hr.x)+i.y*Math.abs(Hr.y)+i.z*Math.abs(Hr.z),h=e.dot(Hr),u=t.dot(Hr),c=n.dot(Hr);if(Math.max(-Math.max(h,u,c),Math.min(h,u,c))>a)return!1}return!0}const Sp=new Rn,zr=new w,lh=new w,fo=new w;class oi{constructor(e=new w,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):Sp.setFromPoints(e).getCenter(n);let i=0;for(let o=0,s=e.length;o<s;o++)i=Math.max(i,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){fo.subVectors(e,this.center);const t=fo.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=.5*(n-this.radius);this.center.add(fo.multiplyScalar(i/n)),this.radius+=i}return this}union(e){return lh.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(zr.copy(e.center).add(lh)),this.expandByPoint(zr.copy(e.center).sub(lh)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Vr=new w,Fu=new w,Ho=new w,Di=new w,Bu=new w,Uu=new w,ca=new w;class mo{constructor(e=new w,t=new w(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Vr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Vr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Vr.copy(this.direction).multiplyScalar(t).add(this.origin),Vr.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){Fu.copy(e).add(t).multiplyScalar(.5),Ho.copy(t).sub(e).normalize(),Di.copy(this.origin).sub(Fu);const o=.5*e.distanceTo(t),s=-this.direction.dot(Ho),a=Di.dot(this.direction),h=-Di.dot(Ho),u=Di.lengthSq(),c=Math.abs(1-s*s);let d,f,m,g;if(c>0)if(d=s*h-a,f=s*a-h,g=o*c,d>=0)if(f>=-g)if(f<=g){const v=1/c;d*=v,f*=v,m=d*(d+s*f+2*a)+f*(s*d+f+2*h)+u}else f=o,d=Math.max(0,-(s*f+a)),m=-d*d+f*(f+2*h)+u;else f=-o,d=Math.max(0,-(s*f+a)),m=-d*d+f*(f+2*h)+u;else f<=-g?(d=Math.max(0,-(-s*o+a)),f=d>0?-o:Math.min(Math.max(-o,-h),o),m=-d*d+f*(f+2*h)+u):f<=g?(d=0,f=Math.min(Math.max(-o,-h),o),m=f*(f+2*h)+u):(d=Math.max(0,-(s*o+a)),f=d>0?o:Math.min(Math.max(-o,-h),o),m=-d*d+f*(f+2*h)+u);else f=s>0?-o:o,d=Math.max(0,-(s*f+a)),m=-d*d+f*(f+2*h)+u;return n&&n.copy(this.direction).multiplyScalar(d).add(this.origin),i&&i.copy(Ho).multiplyScalar(f).add(Fu),m}intersectSphere(e,t){Vr.subVectors(e.center,this.origin);const n=Vr.dot(this.direction),i=Vr.dot(Vr)-n*n,o=e.radius*e.radius;if(i>o)return null;const s=Math.sqrt(o-i),a=n-s,h=n+s;return a<0&&h<0?null:a<0?this.at(h,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0?!0:e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,o,s,a,h;const u=1/this.direction.x,c=1/this.direction.y,d=1/this.direction.z,f=this.origin;return u>=0?(n=(e.min.x-f.x)*u,i=(e.max.x-f.x)*u):(n=(e.max.x-f.x)*u,i=(e.min.x-f.x)*u),c>=0?(o=(e.min.y-f.y)*c,s=(e.max.y-f.y)*c):(o=(e.max.y-f.y)*c,s=(e.min.y-f.y)*c),n>s||o>i?null:((o>n||n!=n)&&(n=o),(s<i||i!=i)&&(i=s),d>=0?(a=(e.min.z-f.z)*d,h=(e.max.z-f.z)*d):(a=(e.max.z-f.z)*d,h=(e.min.z-f.z)*d),n>h||a>i?null:((a>n||n!=n)&&(n=a),(h<i||i!=i)&&(i=h),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return this.intersectBox(e,Vr)!==null}intersectTriangle(e,t,n,i,o){Bu.subVectors(t,e),Uu.subVectors(n,e),ca.crossVectors(Bu,Uu);let s,a=this.direction.dot(ca);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}Di.subVectors(this.origin,e);const h=s*this.direction.dot(Uu.crossVectors(Di,Uu));if(h<0)return null;const u=s*this.direction.dot(Bu.cross(Di));if(u<0||h+u>a)return null;const c=-s*Di.dot(ca);return c<0?null:this.at(c/a,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ct{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,o,s,a,h,u,c,d,f,m,g,v,x){const T=this.elements;return T[0]=e,T[4]=t,T[8]=n,T[12]=i,T[1]=o,T[5]=s,T[9]=a,T[13]=h,T[2]=u,T[6]=c,T[10]=d,T[14]=f,T[3]=m,T[7]=g,T[11]=v,T[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ct().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/zo.setFromMatrixColumn(e,0).length(),o=1/zo.setFromMatrixColumn(e,1).length(),s=1/zo.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*o,t[5]=n[5]*o,t[6]=n[6]*o,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,i=e.y,o=e.z,s=Math.cos(n),a=Math.sin(n),h=Math.cos(i),u=Math.sin(i),c=Math.cos(o),d=Math.sin(o);if(e.order==="XYZ"){const f=s*c,m=s*d,g=a*c,v=a*d;t[0]=h*c,t[4]=-h*d,t[8]=u,t[1]=m+g*u,t[5]=f-v*u,t[9]=-a*h,t[2]=v-f*u,t[6]=g+m*u,t[10]=s*h}else if(e.order==="YXZ"){const f=h*c,m=h*d,g=u*c,v=u*d;t[0]=f+v*a,t[4]=g*a-m,t[8]=s*u,t[1]=s*d,t[5]=s*c,t[9]=-a,t[2]=m*a-g,t[6]=v+f*a,t[10]=s*h}else if(e.order==="ZXY"){const f=h*c,m=h*d,g=u*c,v=u*d;t[0]=f-v*a,t[4]=-s*d,t[8]=g+m*a,t[1]=m+g*a,t[5]=s*c,t[9]=v-f*a,t[2]=-s*u,t[6]=a,t[10]=s*h}else if(e.order==="ZYX"){const f=s*c,m=s*d,g=a*c,v=a*d;t[0]=h*c,t[4]=g*u-m,t[8]=f*u+v,t[1]=h*d,t[5]=v*u+f,t[9]=m*u-g,t[2]=-u,t[6]=a*h,t[10]=s*h}else if(e.order==="YZX"){const f=s*h,m=s*u,g=a*h,v=a*u;t[0]=h*c,t[4]=v-f*d,t[8]=g*d+m,t[1]=d,t[5]=s*c,t[9]=-a*c,t[2]=-u*c,t[6]=m*d+g,t[10]=f-v*d}else if(e.order==="XZY"){const f=s*h,m=s*u,g=a*h,v=a*u;t[0]=h*c,t[4]=-d,t[8]=u*c,t[1]=f*d+v,t[5]=s*c,t[9]=m*d-g,t[2]=g*d-m,t[6]=a*c,t[10]=v*d+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(jr,e,mc)}lookAt(e,t,n){const i=this.elements;return ji.subVectors(e,t),ji.lengthSq()===0&&(ji.z=1),ji.normalize(),Cr.crossVectors(n,ji),Cr.lengthSq()===0&&(Math.abs(n.z)===1?ji.x+=1e-4:ji.z+=1e-4,ji.normalize(),Cr.crossVectors(n,ji)),Cr.normalize(),Wr.crossVectors(ji,Cr),i[0]=Cr.x,i[4]=Wr.x,i[8]=ji.x,i[1]=Cr.y,i[5]=Wr.y,i[9]=ji.y,i[2]=Cr.z,i[6]=Wr.z,i[10]=ji.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,o=this.elements,s=n[0],a=n[4],h=n[8],u=n[12],c=n[1],d=n[5],f=n[9],m=n[13],g=n[2],v=n[6],x=n[10],T=n[14],M=n[3],C=n[7],D=n[11],R=n[15],F=i[0],O=i[4],U=i[8],he=i[12],Q=i[1],X=i[5],Z=i[9],q=i[13],oe=i[2],fe=i[6],me=i[10],le=i[14],pe=i[3],Pe=i[7],Ue=i[11],Fe=i[15];return o[0]=s*F+a*Q+h*oe+u*pe,o[4]=s*O+a*X+h*fe+u*Pe,o[8]=s*U+a*Z+h*me+u*Ue,o[12]=s*he+a*q+h*le+u*Fe,o[1]=c*F+d*Q+f*oe+m*pe,o[5]=c*O+d*X+f*fe+m*Pe,o[9]=c*U+d*Z+f*me+m*Ue,o[13]=c*he+d*q+f*le+m*Fe,o[2]=g*F+v*Q+x*oe+T*pe,o[6]=g*O+v*X+x*fe+T*Pe,o[10]=g*U+v*Z+x*me+T*Ue,o[14]=g*he+v*q+x*le+T*Fe,o[3]=M*F+C*Q+D*oe+R*pe,o[7]=M*O+C*X+D*fe+R*Pe,o[11]=M*U+C*Z+D*me+R*Ue,o[15]=M*he+C*q+D*le+R*Fe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],o=e[12],s=e[1],a=e[5],h=e[9],u=e[13],c=e[2],d=e[6],f=e[10],m=e[14];return e[3]*(+o*h*d-i*u*d-o*a*f+n*u*f+i*a*m-n*h*m)+e[7]*(+t*h*m-t*u*f+o*s*f-i*s*m+i*u*c-o*h*c)+e[11]*(+t*u*d-t*a*m-o*s*d+n*s*m+o*a*c-n*u*c)+e[15]*(-i*a*c-t*h*d+t*a*f+i*s*d-n*s*f+n*h*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],h=e[6],u=e[7],c=e[8],d=e[9],f=e[10],m=e[11],g=e[12],v=e[13],x=e[14],T=e[15],M=d*x*u-v*f*u+v*h*m-a*x*m-d*h*T+a*f*T,C=g*f*u-c*x*u-g*h*m+s*x*m+c*h*T-s*f*T,D=c*v*u-g*d*u+g*a*m-s*v*m-c*a*T+s*d*T,R=g*d*h-c*v*h-g*a*f+s*v*f+c*a*x-s*d*x,F=t*M+n*C+i*D+o*R;if(F===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const O=1/F;return e[0]=M*O,e[1]=(v*f*o-d*x*o-v*i*m+n*x*m+d*i*T-n*f*T)*O,e[2]=(a*x*o-v*h*o+v*i*u-n*x*u-a*i*T+n*h*T)*O,e[3]=(d*h*o-a*f*o-d*i*u+n*f*u+a*i*m-n*h*m)*O,e[4]=C*O,e[5]=(c*x*o-g*f*o+g*i*m-t*x*m-c*i*T+t*f*T)*O,e[6]=(g*h*o-s*x*o-g*i*u+t*x*u+s*i*T-t*h*T)*O,e[7]=(s*f*o-c*h*o+c*i*u-t*f*u-s*i*m+t*h*m)*O,e[8]=D*O,e[9]=(g*d*o-c*v*o-g*n*m+t*v*m+c*n*T-t*d*T)*O,e[10]=(s*v*o-g*a*o+g*n*u-t*v*u-s*n*T+t*a*T)*O,e[11]=(c*a*o-s*d*o-c*n*u+t*d*u+s*n*m-t*a*m)*O,e[12]=R*O,e[13]=(c*v*i-g*d*i+g*n*f-t*v*f-c*n*x+t*d*x)*O,e[14]=(g*a*i-s*v*i-g*n*h+t*v*h+s*n*x-t*a*x)*O,e[15]=(s*d*i-c*a*i+c*n*h-t*d*h-s*n*f+t*a*f)*O,this}scale(e){const t=this.elements,n=e.x,i=e.y,o=e.z;return t[0]*=n,t[4]*=i,t[8]*=o,t[1]*=n,t[5]*=i,t[9]*=o,t[2]*=n,t[6]*=i,t[10]*=o,t[3]*=n,t[7]*=i,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),o=1-n,s=e.x,a=e.y,h=e.z,u=o*s,c=o*a;return this.set(u*s+n,u*a-i*h,u*h+i*a,0,u*a+i*h,c*a+n,c*h-i*s,0,u*h-i*a,c*h+i*s,o*h*h+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,o,s){return this.set(1,n,o,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,o=t._x,s=t._y,a=t._z,h=t._w,u=o+o,c=s+s,d=a+a,f=o*u,m=o*c,g=o*d,v=s*c,x=s*d,T=a*d,M=h*u,C=h*c,D=h*d,R=n.x,F=n.y,O=n.z;return i[0]=(1-(v+T))*R,i[1]=(m+D)*R,i[2]=(g-C)*R,i[3]=0,i[4]=(m-D)*F,i[5]=(1-(f+T))*F,i[6]=(x+M)*F,i[7]=0,i[8]=(g+C)*O,i[9]=(x-M)*O,i[10]=(1-(f+v))*O,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let o=zo.set(i[0],i[1],i[2]).length();const s=zo.set(i[4],i[5],i[6]).length(),a=zo.set(i[8],i[9],i[10]).length();this.determinant()<0&&(o=-o),e.x=i[12],e.y=i[13],e.z=i[14],dr.copy(this);const h=1/o,u=1/s,c=1/a;return dr.elements[0]*=h,dr.elements[1]*=h,dr.elements[2]*=h,dr.elements[4]*=u,dr.elements[5]*=u,dr.elements[6]*=u,dr.elements[8]*=c,dr.elements[9]*=c,dr.elements[10]*=c,t.setFromRotationMatrix(dr),n.x=o,n.y=s,n.z=a,this}makePerspective(e,t,n,i,o,s){s===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,h=2*o/(t-e),u=2*o/(n-i),c=(t+e)/(t-e),d=(n+i)/(n-i),f=-(s+o)/(s-o),m=-2*s*o/(s-o);return a[0]=h,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=m,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,i,o,s){const a=this.elements,h=1/(t-e),u=1/(n-i),c=1/(s-o),d=(t+e)*h,f=(n+i)*u,m=(s+o)*c;return a[0]=2*h,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-m,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}ct.prototype.isMatrix4=!0;const zo=new w,dr=new ct,jr=new w(0,0,0),mc=new w(1,1,1),Cr=new w,Wr=new w,ji=new w,Ai=new ct,ku=new pi;class Ms{constructor(e=0,t=0,n=0,i=Ms.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,o=i[0],s=i[4],a=i[8],h=i[1],u=i[5],c=i[9],d=i[2],f=i[6],m=i[10];switch(t){case"XYZ":this._y=Math.asin(xi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,m),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-xi(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(h,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(xi(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,m),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(h,o));break;case"ZYX":this._y=Math.asin(-xi(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,m),this._z=Math.atan2(h,o)):(this._x=0,this._z=Math.atan2(-s,u));break;case"YZX":this._z=Math.asin(xi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-xi(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-c,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Ai.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Ai,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return ku.setFromEuler(this),this.setFromQuaternion(ku,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new w(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Ms.prototype.isEuler=!0,Ms.DefaultOrder="XYZ",Ms.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class gc{constructor(){this.mask=1}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}}let vc=0;const da=new w,As=new pi,er=new ct,pa=new w,fa=new w,Ep=new w,_c=new pi,Mp=new w(1,0,0),Gu=new w(0,1,0),yc=new w(0,0,1),Ap={type:"added"},xc={type:"removed"};class jt extends uo{constructor(){super(),Object.defineProperty(this,"id",{value:vc++}),this.uuid=Qi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=jt.DefaultUp.clone();const e=new w,t=new Ms,n=new pi,i=new w(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new ct},normalMatrix:{value:new Tn}}),this.matrix=new ct,this.matrixWorld=new ct,this.matrixAutoUpdate=jt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new gc,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return As.setFromAxisAngle(e,t),this.quaternion.multiply(As),this}rotateOnWorldAxis(e,t){return As.setFromAxisAngle(e,t),this.quaternion.premultiply(As),this}rotateX(e){return this.rotateOnAxis(Mp,e)}rotateY(e){return this.rotateOnAxis(Gu,e)}rotateZ(e){return this.rotateOnAxis(yc,e)}translateOnAxis(e,t){return da.copy(e).applyQuaternion(this.quaternion),this.position.add(da.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Mp,e)}translateY(e){return this.translateOnAxis(Gu,e)}translateZ(e){return this.translateOnAxis(yc,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(er.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?pa.copy(e):pa.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),fa.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?er.lookAt(fa,pa,this.up):er.lookAt(pa,fa,this.up),this.quaternion.setFromRotationMatrix(er),i&&(er.extractRotation(i.matrixWorld),As.setFromRotationMatrix(er),this.quaternion.premultiply(As.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Ap)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(xc)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(xc)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),er.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),er.multiply(e.parent.matrixWorld)),e.applyMatrix4(er),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fa,e,Ep),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fa,_c,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let o=0,s=i.length;o<s;o++)i[o].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function o(a,h){return a[h.uuid]===void 0&&(a[h.uuid]=h.toJSON(e)),h.uuid}if(i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=o(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const h=a.shapes;if(Array.isArray(h))for(let u=0,c=h.length;u<c;u++){const d=h[u];o(e.shapes,d)}else o(e.shapes,h)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let h=0,u=this.material.length;h<u;h++)a.push(o(e.materials,this.material[h]));i.material=a}else i.material=o(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const h=this.animations[a];i.animations.push(o(e.animations,h))}}if(t){const a=s(e.geometries),h=s(e.materials),u=s(e.textures),c=s(e.images),d=s(e.shapes),f=s(e.skeletons),m=s(e.animations);a.length>0&&(n.geometries=a),h.length>0&&(n.materials=h),u.length>0&&(n.textures=u),c.length>0&&(n.images=c),d.length>0&&(n.shapes=d),f.length>0&&(n.skeletons=f),m.length>0&&(n.animations=m)}return n.object=i,n;function s(a){const h=[];for(const u in a){const c=a[u];delete c.metadata,h.push(c)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}jt.DefaultUp=new w(0,1,0),jt.DefaultMatrixAutoUpdate=!0,jt.prototype.isObject3D=!0;const pr=new w,Xr=new w,Hu=new w,Ir=new w,Ps=new w,Vo=new w,zu=new w,Wt=new w,bc=new w,wc=new w;class Sn{constructor(e=new w,t=new w,n=new w){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),pr.subVectors(e,t),i.cross(pr);const o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}static getBarycoord(e,t,n,i,o){pr.subVectors(i,t),Xr.subVectors(n,t),Hu.subVectors(e,t);const s=pr.dot(pr),a=pr.dot(Xr),h=pr.dot(Hu),u=Xr.dot(Xr),c=Xr.dot(Hu),d=s*u-a*a;if(d===0)return o.set(-2,-1,-1);const f=1/d,m=(u*h-a*c)*f,g=(s*c-a*h)*f;return o.set(1-m-g,g,m)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Ir),Ir.x>=0&&Ir.y>=0&&Ir.x+Ir.y<=1}static getUV(e,t,n,i,o,s,a,h){return this.getBarycoord(e,t,n,i,Ir),h.set(0,0),h.addScaledVector(o,Ir.x),h.addScaledVector(s,Ir.y),h.addScaledVector(a,Ir.z),h}static isFrontFacing(e,t,n,i){return pr.subVectors(n,t),Xr.subVectors(e,t),pr.cross(Xr).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return pr.subVectors(this.c,this.b),Xr.subVectors(this.a,this.b),.5*pr.cross(Xr).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Sn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Sn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,o){return Sn.getUV(e,this.a,this.b,this.c,t,n,i,o)}containsPoint(e){return Sn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Sn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,o=this.c;let s,a;Ps.subVectors(i,n),Vo.subVectors(o,n),Wt.subVectors(e,n);const h=Ps.dot(Wt),u=Vo.dot(Wt);if(h<=0&&u<=0)return t.copy(n);bc.subVectors(e,i);const c=Ps.dot(bc),d=Vo.dot(bc);if(c>=0&&d<=c)return t.copy(i);const f=h*d-c*u;if(f<=0&&h>=0&&c<=0)return s=h/(h-c),t.copy(n).addScaledVector(Ps,s);wc.subVectors(e,o);const m=Ps.dot(wc),g=Vo.dot(wc);if(g>=0&&m<=g)return t.copy(o);const v=m*u-h*g;if(v<=0&&u>=0&&g<=0)return a=u/(u-g),t.copy(n).addScaledVector(Vo,a);const x=c*g-m*d;if(x<=0&&d-c>=0&&m-g>=0)return zu.subVectors(o,i),a=(d-c)/(d-c+(m-g)),t.copy(i).addScaledVector(zu,a);const T=1/(x+v+f);return s=v*T,a=f*T,t.copy(n).addScaledVector(Ps,s).addScaledVector(Vo,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Pp=0;class fi extends uo{constructor(){super(),Object.defineProperty(this,"id",{value:Pp++}),this.uuid=Qi(),this.name="",this.type="Material",this.fog=!0,this.blending=se,this.side=G,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Kt,this.blendDst=Nt,this.blendEquation=Ee,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Li,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=rh,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=an,this.stencilZFail=an,this.stencilZPass=an,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===Je;continue}const i=this[t];i!==void 0?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(o){const s=[];for(const a in o){const h=o[a];delete h.metadata,s.push(h)}return s}if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==se&&(n.blending=this.blending),this.side!==G&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.morphNormals===!0&&(n.morphNormals=!0),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),t){const o=i(e.textures),s=i(e.images);o.length>0&&(n.textures=o),s.length>0&&(n.images=s)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let o=0;o!==i;++o)n[o]=t[o].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}fi.prototype.isMaterial=!0;const Rp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Gn={h:0,s:0,l:0},Vu={h:0,s:0,l:0};function ma(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+6*(e-r)*t:t<.5?e:t<2/3?r+6*(e-r)*(2/3-t):r}function ch(r){return r<.04045?.0773993808*r:Math.pow(.9478672986*r+.0521327014,2.4)}function ju(r){return r<.0031308?12.92*r:1.055*Math.pow(r,.41666)-.055}class ft{constructor(e,t,n){return t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,t,n){return this.r=e,this.g=t,this.b=n,this}setHSL(e,t,n){if(e=Du(e,1),t=xi(t,0,1),n=xi(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,o=2*n-i;this.r=ma(o,i,e+1/3),this.g=ma(o,i,e),this.b=ma(o,i,e-1/3)}return this}setStyle(e){function t(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let i;const o=n[1],s=n[2];switch(o){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[4]),this;if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[4]),this;break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const a=parseFloat(i[1])/360,h=parseInt(i[2],10)/100,u=parseInt(i[3],10)/100;return t(i[4]),this.setHSL(a,h,u)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=n[1],o=i.length;if(o===3)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(o===6)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const t=Rp[e.toLowerCase()];return t!==void 0?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,t=2){return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}copyLinearToGamma(e,t=2){const n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=ch(e.r),this.g=ch(e.g),this.b=ch(e.b),this}copyLinearToSRGB(e){return this.r=ju(e.r),this.g=ju(e.g),this.b=ju(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const t=this.r,n=this.g,i=this.b,o=Math.max(t,n,i),s=Math.min(t,n,i);let a,h;const u=(s+o)/2;if(s===o)a=0,h=0;else{const c=o-s;switch(h=u<=.5?c/(o+s):c/(2-o-s),o){case t:a=(n-i)/c+(n<i?6:0);break;case n:a=(i-t)/c+2;break;case i:a=(t-n)/c+4}a/=6}return e.h=a,e.s=h,e.l=u,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,t,n){return this.getHSL(Gn),Gn.h+=e,Gn.s+=t,Gn.l+=n,this.setHSL(Gn.h,Gn.s,Gn.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Gn),e.getHSL(Vu);const n=oh(Gn.h,Vu.h,t),i=oh(Gn.s,Vu.s,t),o=oh(Gn.l,Vu.l,t);return this.setHSL(n,i,o),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}ft.NAMES=Rp,ft.prototype.isColor=!0,ft.prototype.r=1,ft.prototype.g=1,ft.prototype.b=1;class Zn extends fi{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ja,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.morphTargets=e.morphTargets,this}}Zn.prototype.isMeshBasicMaterial=!0;const on=new w,ga=new $e;class Yt{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n===!0,this.usage=bs,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,o=this.itemSize;i<o;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let i=0,o=e.length;i<o;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new ft),t[n++]=s.r,t[n++]=s.g,t[n++]=s.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let i=0,o=e.length;i<o;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new $e),t[n++]=s.x,t[n++]=s.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let i=0,o=e.length;i<o;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new w),t[n++]=s.x,t[n++]=s.y,t[n++]=s.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let i=0,o=e.length;i<o;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new cn),t[n++]=s.x,t[n++]=s.y,t[n++]=s.z,t[n++]=s.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)ga.fromBufferAttribute(this,t),ga.applyMatrix3(e),this.setXY(t,ga.x,ga.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)on.fromBufferAttribute(this,t),on.applyMatrix3(e),this.setXYZ(t,on.x,on.y,on.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)on.x=this.getX(t),on.y=this.getY(t),on.z=this.getZ(t),on.applyMatrix4(e),this.setXYZ(t,on.x,on.y,on.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)on.x=this.getX(t),on.y=this.getY(t),on.z=this.getZ(t),on.applyNormalMatrix(e),this.setXYZ(t,on.x,on.y,on.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)on.x=this.getX(t),on.y=this.getY(t),on.z=this.getZ(t),on.transformDirection(e),this.setXYZ(t,on.x,on.y,on.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,o){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==bs&&(e.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(e.updateRange=this.updateRange),e}}Yt.prototype.isBufferAttribute=!0;class dh extends Yt{constructor(e,t,n){super(new Int8Array(e),t,n)}}class Tc extends Yt{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class Wu extends Yt{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class Sc extends Yt{constructor(e,t,n){super(new Int16Array(e),t,n)}}class va extends Yt{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Xu extends Yt{constructor(e,t,n){super(new Int32Array(e),t,n)}}class Lr extends Yt{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Cp extends Yt{constructor(e,t,n){super(new Uint16Array(e),t,n)}}Cp.prototype.isFloat16BufferAttribute=!0;class rt extends Yt{constructor(e,t,n){super(new Float32Array(e),t,n)}}class Ec extends Yt{constructor(e,t,n){super(new Float64Array(e),t,n)}}function Mc(r){if(r.length===0)return-1/0;let e=r[0];for(let t=1,n=r.length;t<n;++t)r[t]>e&&(e=r[t]);return e}const Ac={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Rs(r,e){return new Ac[r](e)}let Ip=0;const tr=new ct,Yu=new jt,si=new w,Hn=new Rn,jo=new Rn,On=new w;class St extends uo{constructor(){super(),Object.defineProperty(this,"id",{value:Ip++}),this.uuid=Qi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Mc(e)>65535?Lr:va)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new Tn().getNormalMatrix(e);n.applyNormalMatrix(o),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return tr.makeRotationFromQuaternion(e),this.applyMatrix4(tr),this}rotateX(e){return tr.makeRotationX(e),this.applyMatrix4(tr),this}rotateY(e){return tr.makeRotationY(e),this.applyMatrix4(tr),this}rotateZ(e){return tr.makeRotationZ(e),this.applyMatrix4(tr),this}translate(e,t,n){return tr.makeTranslation(e,t,n),this.applyMatrix4(tr),this}scale(e,t,n){return tr.makeScale(e,t,n),this.applyMatrix4(tr),this}lookAt(e){return Yu.lookAt(e),Yu.updateMatrix(),this.applyMatrix4(Yu.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(si).negate(),this.translate(si.x,si.y,si.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const o=e[n];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new rt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Rn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new w(-1/0,-1/0,-1/0),new w(1/0,1/0,1/0));if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const o=t[n];Hn.setFromBufferAttribute(o),this.morphTargetsRelative?(On.addVectors(this.boundingBox.min,Hn.min),this.boundingBox.expandByPoint(On),On.addVectors(this.boundingBox.max,Hn.max),this.boundingBox.expandByPoint(On)):(this.boundingBox.expandByPoint(Hn.min),this.boundingBox.expandByPoint(Hn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new oi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new w,1/0);if(e){const n=this.boundingSphere.center;if(Hn.setFromBufferAttribute(e),t)for(let o=0,s=t.length;o<s;o++){const a=t[o];jo.setFromBufferAttribute(a),this.morphTargetsRelative?(On.addVectors(Hn.min,jo.min),Hn.expandByPoint(On),On.addVectors(Hn.max,jo.max),Hn.expandByPoint(On)):(Hn.expandByPoint(jo.min),Hn.expandByPoint(jo.max))}Hn.getCenter(n);let i=0;for(let o=0,s=e.count;o<s;o++)On.fromBufferAttribute(e,o),i=Math.max(i,n.distanceToSquared(On));if(t)for(let o=0,s=t.length;o<s;o++){const a=t[o],h=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)On.fromBufferAttribute(a,u),h&&(si.fromBufferAttribute(e,u),On.add(si)),i=Math.max(i,n.distanceToSquared(On))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeFaceNormals(){}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,i=t.position.array,o=t.normal.array,s=t.uv.array,a=i.length/3;t.tangent===void 0&&this.setAttribute("tangent",new Yt(new Float32Array(4*a),4));const h=t.tangent.array,u=[],c=[];for(let Q=0;Q<a;Q++)u[Q]=new w,c[Q]=new w;const d=new w,f=new w,m=new w,g=new $e,v=new $e,x=new $e,T=new w,M=new w;function C(Q,X,Z){d.fromArray(i,3*Q),f.fromArray(i,3*X),m.fromArray(i,3*Z),g.fromArray(s,2*Q),v.fromArray(s,2*X),x.fromArray(s,2*Z),f.sub(d),m.sub(d),v.sub(g),x.sub(g);const q=1/(v.x*x.y-x.x*v.y);isFinite(q)&&(T.copy(f).multiplyScalar(x.y).addScaledVector(m,-v.y).multiplyScalar(q),M.copy(m).multiplyScalar(v.x).addScaledVector(f,-x.x).multiplyScalar(q),u[Q].add(T),u[X].add(T),u[Z].add(T),c[Q].add(M),c[X].add(M),c[Z].add(M))}let D=this.groups;D.length===0&&(D=[{start:0,count:n.length}]);for(let Q=0,X=D.length;Q<X;++Q){const Z=D[Q],q=Z.start;for(let oe=q,fe=q+Z.count;oe<fe;oe+=3)C(n[oe+0],n[oe+1],n[oe+2])}const R=new w,F=new w,O=new w,U=new w;function he(Q){O.fromArray(o,3*Q),U.copy(O);const X=u[Q];R.copy(X),R.sub(O.multiplyScalar(O.dot(X))).normalize(),F.crossVectors(U,X);const Z=F.dot(c[Q])<0?-1:1;h[4*Q]=R.x,h[4*Q+1]=R.y,h[4*Q+2]=R.z,h[4*Q+3]=Z}for(let Q=0,X=D.length;Q<X;++Q){const Z=D[Q],q=Z.start;for(let oe=q,fe=q+Z.count;oe<fe;oe+=3)he(n[oe+0]),he(n[oe+1]),he(n[oe+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Yt(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let f=0,m=n.count;f<m;f++)n.setXYZ(f,0,0,0);const i=new w,o=new w,s=new w,a=new w,h=new w,u=new w,c=new w,d=new w;if(e)for(let f=0,m=e.count;f<m;f+=3){const g=e.getX(f+0),v=e.getX(f+1),x=e.getX(f+2);i.fromBufferAttribute(t,g),o.fromBufferAttribute(t,v),s.fromBufferAttribute(t,x),c.subVectors(s,o),d.subVectors(i,o),c.cross(d),a.fromBufferAttribute(n,g),h.fromBufferAttribute(n,v),u.fromBufferAttribute(n,x),a.add(c),h.add(c),u.add(c),n.setXYZ(g,a.x,a.y,a.z),n.setXYZ(v,h.x,h.y,h.z),n.setXYZ(x,u.x,u.y,u.z)}else for(let f=0,m=t.count;f<m;f+=3)i.fromBufferAttribute(t,f+0),o.fromBufferAttribute(t,f+1),s.fromBufferAttribute(t,f+2),c.subVectors(s,o),d.subVectors(i,o),c.cross(d),n.setXYZ(f+0,c.x,c.y,c.z),n.setXYZ(f+1,c.x,c.y,c.z),n.setXYZ(f+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(e.attributes[i]===void 0)continue;const o=n[i].array,s=e.attributes[i],a=s.array,h=s.itemSize*t,u=Math.min(a.length,o.length-h);for(let c=0,d=h;c<u;c++,d++)o[d]=a[c]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)On.fromBufferAttribute(e,t),On.normalize(),e.setXYZ(t,On.x,On.y,On.z)}toNonIndexed(){function e(a,h){const u=a.array,c=a.itemSize,d=a.normalized,f=new u.constructor(h.length*c);let m=0,g=0;for(let v=0,x=h.length;v<x;v++){m=a.isInterleavedBufferAttribute?h[v]*a.data.stride+a.offset:h[v]*c;for(let T=0;T<c;T++)f[g++]=u[m++]}return new Yt(f,c,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new St,n=this.index.array,i=this.attributes;for(const a in i){const h=e(i[a],n);t.setAttribute(a,h)}const o=this.morphAttributes;for(const a in o){const h=[],u=o[a];for(let c=0,d=u.length;c<d;c++){const f=e(u[c],n);h.push(f)}t.morphAttributes[a]=h}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,h=s.length;a<h;a++){const u=s[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const u in h)h[u]!==void 0&&(e[u]=h[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const h in n){const u=n[h];e.data.attributes[h]=u.toJSON(e.data)}const i={};let o=!1;for(const h in this.morphAttributes){const u=this.morphAttributes[h],c=[];for(let d=0,f=u.length;d<f;d++){const m=u[d];c.push(m.toJSON(e.data))}c.length>0&&(i[h]=c,o=!0)}o&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new St().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const i=e.attributes;for(const u in i){const c=i[u];this.setAttribute(u,c.clone(t))}const o=e.morphAttributes;for(const u in o){const c=[],d=o[u];for(let f=0,m=d.length;f<m;f++)c.push(d[f].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let u=0,c=s.length;u<c;u++){const d=s[u];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}St.prototype.isBufferGeometry=!0;const Pc=new ct,Cs=new mo,Wo=new oi,fr=new w,go=new w,vo=new w,_a=new w,qu=new w,ya=new w,xa=new w,Is=new w,ph=new w,Ls=new $e,fh=new $e,ba=new $e,Rc=new w,mh=new w;class sn extends jt{constructor(e=new St,t=new Zn){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=i.length;o<s;o++){const a=i[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const n=this.geometry,i=this.material,o=this.matrixWorld;if(i===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Wo.copy(n.boundingSphere),Wo.applyMatrix4(o),e.ray.intersectsSphere(Wo)===!1)||(Pc.copy(o).invert(),Cs.copy(e.ray).applyMatrix4(Pc),n.boundingBox!==null&&Cs.intersectsBox(n.boundingBox)===!1))return;let s;if(n.isBufferGeometry){const a=n.index,h=n.attributes.position,u=n.morphAttributes.position,c=n.morphTargetsRelative,d=n.attributes.uv,f=n.attributes.uv2,m=n.groups,g=n.drawRange;if(a!==null)if(Array.isArray(i))for(let v=0,x=m.length;v<x;v++){const T=m[v],M=i[T.materialIndex];for(let C=Math.max(T.start,g.start),D=Math.min(T.start+T.count,g.start+g.count);C<D;C+=3){const R=a.getX(C),F=a.getX(C+1),O=a.getX(C+2);s=gh(this,M,e,Cs,h,u,c,d,f,R,F,O),s&&(s.faceIndex=Math.floor(C/3),s.face.materialIndex=T.materialIndex,t.push(s))}}else for(let v=Math.max(0,g.start),x=Math.min(a.count,g.start+g.count);v<x;v+=3){const T=a.getX(v),M=a.getX(v+1),C=a.getX(v+2);s=gh(this,i,e,Cs,h,u,c,d,f,T,M,C),s&&(s.faceIndex=Math.floor(v/3),t.push(s))}else if(h!==void 0)if(Array.isArray(i))for(let v=0,x=m.length;v<x;v++){const T=m[v],M=i[T.materialIndex];for(let C=Math.max(T.start,g.start),D=Math.min(T.start+T.count,g.start+g.count);C<D;C+=3)s=gh(this,M,e,Cs,h,u,c,d,f,C,C+1,C+2),s&&(s.faceIndex=Math.floor(C/3),s.face.materialIndex=T.materialIndex,t.push(s))}else for(let v=Math.max(0,g.start),x=Math.min(h.count,g.start+g.count);v<x;v+=3)s=gh(this,i,e,Cs,h,u,c,d,f,v,v+1,v+2),s&&(s.faceIndex=Math.floor(v/3),t.push(s))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function gh(r,e,t,n,i,o,s,a,h,u,c,d){fr.fromBufferAttribute(i,u),go.fromBufferAttribute(i,c),vo.fromBufferAttribute(i,d);const f=r.morphTargetInfluences;if(e.morphTargets&&o&&f){xa.set(0,0,0),Is.set(0,0,0),ph.set(0,0,0);for(let g=0,v=o.length;g<v;g++){const x=f[g],T=o[g];x!==0&&(_a.fromBufferAttribute(T,u),qu.fromBufferAttribute(T,c),ya.fromBufferAttribute(T,d),s?(xa.addScaledVector(_a,x),Is.addScaledVector(qu,x),ph.addScaledVector(ya,x)):(xa.addScaledVector(_a.sub(fr),x),Is.addScaledVector(qu.sub(go),x),ph.addScaledVector(ya.sub(vo),x)))}fr.add(xa),go.add(Is),vo.add(ph)}r.isSkinnedMesh&&(r.boneTransform(u,fr),r.boneTransform(c,go),r.boneTransform(d,vo));const m=function(g,v,x,T,M,C,D,R){let F;if(F=v.side===j?T.intersectTriangle(D,C,M,!0,R):T.intersectTriangle(M,C,D,v.side!==J,R),F===null)return null;mh.copy(R),mh.applyMatrix4(g.matrixWorld);const O=x.ray.origin.distanceTo(mh);return O<x.near||O>x.far?null:{distance:O,point:mh.clone(),object:g}}(r,e,t,n,fr,go,vo,Rc);if(m){a&&(Ls.fromBufferAttribute(a,u),fh.fromBufferAttribute(a,c),ba.fromBufferAttribute(a,d),m.uv=Sn.getUV(Rc,fr,go,vo,Ls,fh,ba,new $e)),h&&(Ls.fromBufferAttribute(h,u),fh.fromBufferAttribute(h,c),ba.fromBufferAttribute(h,d),m.uv2=Sn.getUV(Rc,fr,go,vo,Ls,fh,ba,new $e));const g={a:u,b:c,c:d,normal:new w,materialIndex:0};Sn.getNormal(fr,go,vo,g.normal),m.face=g}return m}sn.prototype.isMesh=!0;class Yr extends St{constructor(e=1,t=1,n=1,i=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:o,depthSegments:s};const a=this;i=Math.floor(i),o=Math.floor(o),s=Math.floor(s);const h=[],u=[],c=[],d=[];let f=0,m=0;function g(v,x,T,M,C,D,R,F,O,U,he){const Q=D/O,X=R/U,Z=D/2,q=R/2,oe=F/2,fe=O+1,me=U+1;let le=0,pe=0;const Pe=new w;for(let Ue=0;Ue<me;Ue++){const Fe=Ue*X-q;for(let Y=0;Y<fe;Y++){const $=Y*Q-Z;Pe[v]=$*M,Pe[x]=Fe*C,Pe[T]=oe,u.push(Pe.x,Pe.y,Pe.z),Pe[v]=0,Pe[x]=0,Pe[T]=F>0?1:-1,c.push(Pe.x,Pe.y,Pe.z),d.push(Y/O),d.push(1-Ue/U),le+=1}}for(let Ue=0;Ue<U;Ue++)for(let Fe=0;Fe<O;Fe++){const Y=f+Fe+fe*Ue,$=f+Fe+fe*(Ue+1),Me=f+(Fe+1)+fe*(Ue+1),De=f+(Fe+1)+fe*Ue;h.push(Y,$,De),h.push($,Me,De),pe+=6}a.addGroup(m,pe,he),m+=pe,f+=le}g("z","y","x",-1,-1,n,t,e,s,o,0),g("z","y","x",1,-1,n,t,-e,s,o,1),g("x","z","y",1,1,e,n,t,i,s,2),g("x","z","y",1,-1,e,n,-t,i,s,3),g("x","y","z",1,-1,e,t,n,i,o,4),g("x","y","z",-1,-1,e,t,-n,i,o,5),this.setIndex(h),this.setAttribute("position",new rt(u,3)),this.setAttribute("normal",new rt(c,3)),this.setAttribute("uv",new rt(d,2))}static fromJSON(e){return new Yr(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function wa(r){const e={};for(const t in r){e[t]={};for(const n in r[t]){const i=r[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function bi(r){const e={};for(let t=0;t<r.length;t++){const n=wa(r[t]);for(const i in n)e[i]=n[i]}return e}const qr={clone:wa,merge:bi};class Ni extends fi{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=wa(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}Ni.prototype.isShaderMaterial=!0;class Os extends jt{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new ct,this.projectionMatrix=new ct,this.projectionMatrixInverse=new ct}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}Os.prototype.isCamera=!0;class $n extends Os{constructor(e=50,t=1,n=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Qn*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*wn*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Qn*Math.atan(Math.tan(.5*wn*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,o,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*wn*this.fov)/this.zoom,n=2*t,i=this.aspect*n,o=-.5*i;const s=this.view;if(this.view!==null&&this.view.enabled){const h=s.fullWidth,u=s.fullHeight;o+=s.offsetX*i/h,t-=s.offsetY*n/u,i*=s.width/h,n*=s.height/u}const a=this.filmOffset;a!==0&&(o+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}$n.prototype.isPerspectiveCamera=!0;class Ds extends jt{constructor(e,t,n){if(super(),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const i=new $n(90,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new w(1,0,0)),this.add(i);const o=new $n(90,1,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new w(-1,0,0)),this.add(o);const s=new $n(90,1,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new w(0,1,0)),this.add(s);const a=new $n(90,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new w(0,-1,0)),this.add(a);const h=new $n(90,1,e,t);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new w(0,0,1)),this.add(h);const u=new $n(90,1,e,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new w(0,0,-1)),this.add(u)}update(e,t){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[i,o,s,a,h,u]=this.children,c=e.xr.enabled,d=e.getRenderTarget();e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,o),e.setRenderTarget(n,2),e.render(t,s),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,h),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,u),e.setRenderTarget(d),e.xr.enabled=c}}class Or extends qn{constructor(e,t,n,i,o,s,a,h,u,c){super(e=e!==void 0?e:[],t=t!==void 0?t:Lo,n,i,o,s,a=a!==void 0?a:oo,h,u,c),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}Or.prototype.isCubeTexture=!0;class Mt extends Ar{constructor(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),super(e,e,t),t=t||{},this.texture=new Or(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.generateMipmaps=t.generateMipmaps!==void 0&&t.generateMipmaps,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Yn,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=$i,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Yr(5,5,5),o=new Ni({name:"CubemapFromEquirect",uniforms:wa(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:j,blending:Ze});o.uniforms.tEquirect.value=t;const s=new sn(i,o),a=t.minFilter;return t.minFilter===fs&&(t.minFilter=Yn),new Ds(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,n,i){const o=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(o)}}Mt.prototype.isWebGLCubeRenderTarget=!0;const Ta=new w,Cc=new w,Ns=new Tn;class mr{constructor(e=new w(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=Ta.subVectors(n,t).cross(Cc.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(Ta),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/i;return o<0||o>1?null:t.copy(n).multiplyScalar(o).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Ns.getNormalMatrix(e),i=this.coplanarPoint(Ta).applyMatrix4(e),o=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}mr.prototype.isPlane=!0;const Fs=new oi,ai=new w;class Sa{constructor(e=new mr,t=new mr,n=new mr,i=new mr,o=new mr,s=new mr){this.planes=[e,t,n,i,o,s]}set(e,t,n,i,o,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(o),a[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,i=n[0],o=n[1],s=n[2],a=n[3],h=n[4],u=n[5],c=n[6],d=n[7],f=n[8],m=n[9],g=n[10],v=n[11],x=n[12],T=n[13],M=n[14],C=n[15];return t[0].setComponents(a-i,d-h,v-f,C-x).normalize(),t[1].setComponents(a+i,d+h,v+f,C+x).normalize(),t[2].setComponents(a+o,d+u,v+m,C+T).normalize(),t[3].setComponents(a-o,d-u,v-m,C-T).normalize(),t[4].setComponents(a-s,d-c,v-g,C-M).normalize(),t[5].setComponents(a+s,d+c,v+g,C+M).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Fs.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Fs)}intersectsSprite(e){return Fs.center.set(0,0,0),Fs.radius=.7071067811865476,Fs.applyMatrix4(e.matrixWorld),this.intersectsSphere(Fs)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(ai.x=i.normal.x>0?e.max.x:e.min.x,ai.y=i.normal.y>0?e.max.y:e.min.y,ai.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(ai)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Ic(){let r=null,e=!1,t=null,n=null;function i(o,s){t(o,s),n=r.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=r.requestAnimationFrame(i),e=!0)},stop:function(){r.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){r=o}}}function km(r,e){const t=e.isWebGL2,n=new WeakMap;return{get:function(i){return i.isInterleavedBufferAttribute&&(i=i.data),n.get(i)},remove:function(i){i.isInterleavedBufferAttribute&&(i=i.data);const o=n.get(i);o&&(r.deleteBuffer(o.buffer),n.delete(i))},update:function(i,o){if(i.isGLBufferAttribute){const a=n.get(i);return void((!a||a.version<i.version)&&n.set(i,{buffer:i.buffer,type:i.type,bytesPerElement:i.elementSize,version:i.version}))}i.isInterleavedBufferAttribute&&(i=i.data);const s=n.get(i);s===void 0?n.set(i,function(a,h){const u=a.array,c=a.usage,d=r.createBuffer();r.bindBuffer(h,d),r.bufferData(h,u,c),a.onUploadCallback();let f=5126;return u instanceof Float32Array?f=5126:u instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):u instanceof Uint16Array?a.isFloat16BufferAttribute?t?f=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):f=5123:u instanceof Int16Array?f=5122:u instanceof Uint32Array?f=5125:u instanceof Int32Array?f=5124:u instanceof Int8Array?f=5120:(u instanceof Uint8Array||u instanceof Uint8ClampedArray)&&(f=5121),{buffer:d,type:f,bytesPerElement:u.BYTES_PER_ELEMENT,version:a.version}}(i,o)):s.version<i.version&&(function(a,h,u){const c=h.array,d=h.updateRange;r.bindBuffer(u,a),d.count===-1?r.bufferSubData(u,0,c):(t?r.bufferSubData(u,d.offset*c.BYTES_PER_ELEMENT,c,d.offset,d.count):r.bufferSubData(u,d.offset*c.BYTES_PER_ELEMENT,c.subarray(d.offset,d.offset+d.count)),d.count=-1)}(s.buffer,i,o),s.version=i.version)}}}class Pi extends St{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const o=e/2,s=t/2,a=Math.floor(n),h=Math.floor(i),u=a+1,c=h+1,d=e/a,f=t/h,m=[],g=[],v=[],x=[];for(let T=0;T<c;T++){const M=T*f-s;for(let C=0;C<u;C++){const D=C*d-o;g.push(D,-M,0),v.push(0,0,1),x.push(C/a),x.push(1-T/h)}}for(let T=0;T<h;T++)for(let M=0;M<a;M++){const C=M+u*T,D=M+u*(T+1),R=M+1+u*(T+1),F=M+1+u*T;m.push(C,D,F),m.push(D,R,F)}this.setIndex(m),this.setAttribute("position",new rt(g,3)),this.setAttribute("normal",new rt(v,3)),this.setAttribute("uv",new rt(x,2))}static fromJSON(e){return new Pi(e.width,e.height,e.widthSegments,e.heightSegments)}}const Ct={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotVH ) {
	float fresnel = exp2( ( -5.55473 * dotVH - 6.98316 ) * dotVH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment:`#ifdef USE_TRANSMISSION
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSNMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition.xyz / vWorldPosition.w;
	vec3 v = normalize( cameraPosition - pos );
	float ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );
	vec3 transmission = transmissionFactor * getIBLVolumeRefraction(
		normal, v, roughnessFactor, material.diffuseColor, totalSpecular,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission, transmissionFactor );
#endif`,transmission_pars_fragment:`#ifdef USE_TRANSMISSION
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec4 vWorldPosition;
	vec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {
		vec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);
		vec3 modelScale;
		modelScale.x = length(vec3(modelMatrix[0].xyz));
		modelScale.y = length(vec3(modelMatrix[1].xyz));
		modelScale.z = length(vec3(modelMatrix[2].xyz));
		return normalize(refractionVector) * thickness * modelScale;
	}
	float applyIorToRoughness(float roughness, float ior) {
		return roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);
	}
	vec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {
		float framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);
		return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;
	}
	vec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {
		if (attenuationDistance == 0.0) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;
			vec3 transmittance = exp(-attenuationCoefficient * transmissionDistance);			return transmittance * radiance;
		}
	}
	vec3 getIBLVolumeRefraction(vec3 n, vec3 v, float perceptualRoughness, vec3 baseColor, vec3 specularColor,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance) {
		vec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);
		vec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);
		return (1.0 - specularColor) * attenuatedColor * baseColor;
	}
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform vec3 attenuationColor;
	uniform float attenuationDistance;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <transmission_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#ifdef USE_TRANSMISSION
	varying vec4 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition;
#endif
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},lt={common:{diffuse:{value:new ft(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Tn},uv2Transform:{value:new Tn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new $e(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ft(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ft(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Tn}},sprite:{diffuse:{value:new ft(16777215)},opacity:{value:1},center:{value:new $e(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Tn}}},nr={basic:{uniforms:bi([lt.common,lt.specularmap,lt.envmap,lt.aomap,lt.lightmap,lt.fog]),vertexShader:Ct.meshbasic_vert,fragmentShader:Ct.meshbasic_frag},lambert:{uniforms:bi([lt.common,lt.specularmap,lt.envmap,lt.aomap,lt.lightmap,lt.emissivemap,lt.fog,lt.lights,{emissive:{value:new ft(0)}}]),vertexShader:Ct.meshlambert_vert,fragmentShader:Ct.meshlambert_frag},phong:{uniforms:bi([lt.common,lt.specularmap,lt.envmap,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.fog,lt.lights,{emissive:{value:new ft(0)},specular:{value:new ft(1118481)},shininess:{value:30}}]),vertexShader:Ct.meshphong_vert,fragmentShader:Ct.meshphong_frag},standard:{uniforms:bi([lt.common,lt.envmap,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.roughnessmap,lt.metalnessmap,lt.fog,lt.lights,{emissive:{value:new ft(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ct.meshphysical_vert,fragmentShader:Ct.meshphysical_frag},toon:{uniforms:bi([lt.common,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.gradientmap,lt.fog,lt.lights,{emissive:{value:new ft(0)}}]),vertexShader:Ct.meshtoon_vert,fragmentShader:Ct.meshtoon_frag},matcap:{uniforms:bi([lt.common,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.fog,{matcap:{value:null}}]),vertexShader:Ct.meshmatcap_vert,fragmentShader:Ct.meshmatcap_frag},points:{uniforms:bi([lt.points,lt.fog]),vertexShader:Ct.points_vert,fragmentShader:Ct.points_frag},dashed:{uniforms:bi([lt.common,lt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ct.linedashed_vert,fragmentShader:Ct.linedashed_frag},depth:{uniforms:bi([lt.common,lt.displacementmap]),vertexShader:Ct.depth_vert,fragmentShader:Ct.depth_frag},normal:{uniforms:bi([lt.common,lt.bumpmap,lt.normalmap,lt.displacementmap,{opacity:{value:1}}]),vertexShader:Ct.normal_vert,fragmentShader:Ct.normal_frag},sprite:{uniforms:bi([lt.sprite,lt.fog]),vertexShader:Ct.sprite_vert,fragmentShader:Ct.sprite_frag},background:{uniforms:{uvTransform:{value:new Tn},t2D:{value:null}},vertexShader:Ct.background_vert,fragmentShader:Ct.background_frag},cube:{uniforms:bi([lt.envmap,{opacity:{value:1}}]),vertexShader:Ct.cube_vert,fragmentShader:Ct.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ct.equirect_vert,fragmentShader:Ct.equirect_frag},distanceRGBA:{uniforms:bi([lt.common,lt.displacementmap,{referencePosition:{value:new w},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ct.distanceRGBA_vert,fragmentShader:Ct.distanceRGBA_frag},shadow:{uniforms:bi([lt.lights,lt.fog,{color:{value:new ft(0)},opacity:{value:1}}]),vertexShader:Ct.shadow_vert,fragmentShader:Ct.shadow_frag}};function Gm(r,e,t,n,i){const o=new ft(0);let s,a,h=0,u=null,c=0,d=null;function f(m,g){t.buffers.color.setClear(m.r,m.g,m.b,g,i)}return{getClearColor:function(){return o},setClearColor:function(m,g=1){o.set(m),h=g,f(o,h)},getClearAlpha:function(){return h},setClearAlpha:function(m){h=m,f(o,h)},render:function(m,g){let v=!1,x=g.isScene===!0?g.background:null;x&&x.isTexture&&(x=e.get(x));const T=r.xr,M=T.getSession&&T.getSession();M&&M.environmentBlendMode==="additive"&&(x=null),x===null?f(o,h):x&&x.isColor&&(f(x,1),v=!0),(r.autoClear||v)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),x&&(x.isCubeTexture||x.mapping===ra)?(a===void 0&&(a=new sn(new Yr(1,1,1),new Ni({name:"BackgroundCubeMaterial",uniforms:wa(nr.cube.uniforms),vertexShader:nr.cube.vertexShader,fragmentShader:nr.cube.fragmentShader,side:j,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(C,D,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a)),a.material.uniforms.envMap.value=x,a.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x._needsFlipEnvMap?-1:1,u===x&&c===x.version&&d===r.toneMapping||(a.material.needsUpdate=!0,u=x,c=x.version,d=r.toneMapping),m.unshift(a,a.geometry,a.material,0,0,null)):x&&x.isTexture&&(s===void 0&&(s=new sn(new Pi(2,2),new Ni({name:"BackgroundMaterial",uniforms:wa(nr.background.uniforms),vertexShader:nr.background.vertexShader,fragmentShader:nr.background.fragmentShader,side:G,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(s)),s.material.uniforms.t2D.value=x,x.matrixAutoUpdate===!0&&x.updateMatrix(),s.material.uniforms.uvTransform.value.copy(x.matrix),u===x&&c===x.version&&d===r.toneMapping||(s.material.needsUpdate=!0,u=x,c=x.version,d=r.toneMapping),m.unshift(s,s.geometry,s.material,0,0,null))}}}function vh(r,e,t,n){const i=r.getParameter(34921),o=n.isWebGL2?null:e.get("OES_vertex_array_object"),s=n.isWebGL2||o!==null,a={},h=f(null);let u=h;function c(D){return n.isWebGL2?r.bindVertexArray(D):o.bindVertexArrayOES(D)}function d(D){return n.isWebGL2?r.deleteVertexArray(D):o.deleteVertexArrayOES(D)}function f(D){const R=[],F=[],O=[];for(let U=0;U<i;U++)R[U]=0,F[U]=0,O[U]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:R,enabledAttributes:F,attributeDivisors:O,object:D,attributes:{},index:null}}function m(){const D=u.newAttributes;for(let R=0,F=D.length;R<F;R++)D[R]=0}function g(D){v(D,0)}function v(D,R){const F=u.newAttributes,O=u.enabledAttributes,U=u.attributeDivisors;F[D]=1,O[D]===0&&(r.enableVertexAttribArray(D),O[D]=1),U[D]!==R&&((n.isWebGL2?r:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](D,R),U[D]=R)}function x(){const D=u.newAttributes,R=u.enabledAttributes;for(let F=0,O=R.length;F<O;F++)R[F]!==D[F]&&(r.disableVertexAttribArray(F),R[F]=0)}function T(D,R,F,O,U,he){n.isWebGL2!==!0||F!==5124&&F!==5125?r.vertexAttribPointer(D,R,F,O,U,he):r.vertexAttribIPointer(D,R,F,U,he)}function M(){C(),u!==h&&(u=h,c(u.object))}function C(){h.geometry=null,h.program=null,h.wireframe=!1}return{setup:function(D,R,F,O,U){let he=!1;if(s){const Q=function(X,Z,q){const oe=q.wireframe===!0;let fe=a[X.id];fe===void 0&&(fe={},a[X.id]=fe);let me=fe[Z.id];me===void 0&&(me={},fe[Z.id]=me);let le=me[oe];return le===void 0&&(le=f(n.isWebGL2?r.createVertexArray():o.createVertexArrayOES()),me[oe]=le),le}(O,F,R);u!==Q&&(u=Q,c(u.object)),he=function(X,Z){const q=u.attributes,oe=X.attributes;let fe=0;for(const me in oe){const le=q[me],pe=oe[me];if(le===void 0||le.attribute!==pe||le.data!==pe.data)return!0;fe++}return u.attributesNum!==fe||u.index!==Z}(O,U),he&&function(X,Z){const q={},oe=X.attributes;let fe=0;for(const me in oe){const le=oe[me],pe={};pe.attribute=le,le.data&&(pe.data=le.data),q[me]=pe,fe++}u.attributes=q,u.attributesNum=fe,u.index=Z}(O,U)}else{const Q=R.wireframe===!0;u.geometry===O.id&&u.program===F.id&&u.wireframe===Q||(u.geometry=O.id,u.program=F.id,u.wireframe=Q,he=!0)}D.isInstancedMesh===!0&&(he=!0),U!==null&&t.update(U,34963),he&&(function(Q,X,Z,q){if(n.isWebGL2===!1&&(Q.isInstancedMesh||q.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;m();const oe=q.attributes,fe=Z.getAttributes(),me=X.defaultAttributeValues;for(const le in fe){const pe=fe[le];if(pe>=0){const Pe=oe[le];if(Pe!==void 0){const Ue=Pe.normalized,Fe=Pe.itemSize,Y=t.get(Pe);if(Y===void 0)continue;const $=Y.buffer,Me=Y.type,De=Y.bytesPerElement;if(Pe.isInterleavedBufferAttribute){const we=Pe.data,ke=we.stride,We=Pe.offset;we&&we.isInstancedInterleavedBuffer?(v(pe,we.meshPerAttribute),q._maxInstanceCount===void 0&&(q._maxInstanceCount=we.meshPerAttribute*we.count)):g(pe),r.bindBuffer(34962,$),T(pe,Fe,Me,Ue,ke*De,We*De)}else Pe.isInstancedBufferAttribute?(v(pe,Pe.meshPerAttribute),q._maxInstanceCount===void 0&&(q._maxInstanceCount=Pe.meshPerAttribute*Pe.count)):g(pe),r.bindBuffer(34962,$),T(pe,Fe,Me,Ue,0,0)}else if(le==="instanceMatrix"){const Ue=t.get(Q.instanceMatrix);if(Ue===void 0)continue;const Fe=Ue.buffer,Y=Ue.type;v(pe+0,1),v(pe+1,1),v(pe+2,1),v(pe+3,1),r.bindBuffer(34962,Fe),r.vertexAttribPointer(pe+0,4,Y,!1,64,0),r.vertexAttribPointer(pe+1,4,Y,!1,64,16),r.vertexAttribPointer(pe+2,4,Y,!1,64,32),r.vertexAttribPointer(pe+3,4,Y,!1,64,48)}else if(le==="instanceColor"){const Ue=t.get(Q.instanceColor);if(Ue===void 0)continue;const Fe=Ue.buffer,Y=Ue.type;v(pe,1),r.bindBuffer(34962,Fe),r.vertexAttribPointer(pe,3,Y,!1,12,0)}else if(me!==void 0){const Ue=me[le];if(Ue!==void 0)switch(Ue.length){case 2:r.vertexAttrib2fv(pe,Ue);break;case 3:r.vertexAttrib3fv(pe,Ue);break;case 4:r.vertexAttrib4fv(pe,Ue);break;default:r.vertexAttrib1fv(pe,Ue)}}}}x()}(D,R,F,O),U!==null&&r.bindBuffer(34963,t.get(U).buffer))},reset:M,resetDefaultState:C,dispose:function(){M();for(const D in a){const R=a[D];for(const F in R){const O=R[F];for(const U in O)d(O[U].object),delete O[U];delete R[F]}delete a[D]}},releaseStatesOfGeometry:function(D){if(a[D.id]===void 0)return;const R=a[D.id];for(const F in R){const O=R[F];for(const U in O)d(O[U].object),delete O[U];delete R[F]}delete a[D.id]},releaseStatesOfProgram:function(D){for(const R in a){const F=a[R];if(F[D.id]===void 0)continue;const O=F[D.id];for(const U in O)d(O[U].object),delete O[U];delete F[D.id]}},initAttributes:m,enableAttribute:g,disableUnusedAttributes:x}}function Lp(r,e,t,n){const i=n.isWebGL2;let o;this.setMode=function(s){o=s},this.render=function(s,a){r.drawArrays(o,s,a),t.update(a,o,1)},this.renderInstances=function(s,a,h){if(h===0)return;let u,c;if(i)u=r,c="drawArraysInstanced";else if(u=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",u===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[c](o,s,a,h),t.update(a,o,h)}}function Op(r,e,t){let n;function i(D){if(D==="highp"){if(r.getShaderPrecisionFormat(35633,36338).precision>0&&r.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";D="mediump"}return D==="mediump"&&r.getShaderPrecisionFormat(35633,36337).precision>0&&r.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext!="undefined"&&r instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&r instanceof WebGL2ComputeRenderingContext;let s=t.precision!==void 0?t.precision:"highp";const a=i(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);const h=o||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,c=r.getParameter(34930),d=r.getParameter(35660),f=r.getParameter(3379),m=r.getParameter(34076),g=r.getParameter(34921),v=r.getParameter(36347),x=r.getParameter(36348),T=r.getParameter(36349),M=d>0,C=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:h,getMaxAnisotropy:function(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const D=e.get("EXT_texture_filter_anisotropic");n=r.getParameter(D.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:m,maxAttributes:g,maxVertexUniforms:v,maxVaryings:x,maxFragmentUniforms:T,vertexTextures:M,floatFragmentTextures:C,floatVertexTextures:M&&C,maxSamples:o?r.getParameter(36183):0}}function Dp(r){const e=this;let t=null,n=0,i=!1,o=!1;const s=new mr,a=new Tn,h={value:null,needsUpdate:!1};function u(){h.value!==t&&(h.value=t,h.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function c(d,f,m,g){const v=d!==null?d.length:0;let x=null;if(v!==0){if(x=h.value,g!==!0||x===null){const T=m+4*v,M=f.matrixWorldInverse;a.getNormalMatrix(M),(x===null||x.length<T)&&(x=new Float32Array(T));for(let C=0,D=m;C!==v;++C,D+=4)s.copy(d[C]).applyMatrix4(M,a),s.normal.toArray(x,D),x[D+3]=s.constant}h.value=x,h.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,x}this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(d,f,m){const g=d.length!==0||f||n!==0||i;return i=f,t=c(d,m,0),n=d.length,g},this.beginShadows=function(){o=!0,c(null)},this.endShadows=function(){o=!1,u()},this.setState=function(d,f,m){const g=d.clippingPlanes,v=d.clipIntersection,x=d.clipShadows,T=r.get(d);if(!i||g===null||g.length===0||o&&!x)o?c(null):u();else{const M=o?0:n,C=4*M;let D=T.clippingState||null;h.value=D,D=c(g,f,C,m);for(let R=0;R!==C;++R)D[R]=t[R];T.clippingState=D,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=M}}}function Np(r){let e=new WeakMap;function t(i,o){return o===Xa?i.mapping=Lo:o===Ya&&(i.mapping=Wa),i}function n(i){const o=i.target;o.removeEventListener("dispose",n);const s=e.get(o);s!==void 0&&(e.delete(o),s.dispose())}return{get:function(i){if(i&&i.isTexture){const o=i.mapping;if(o===Xa||o===Ya){if(e.has(i))return t(e.get(i).texture,i.mapping);{const s=i.image;if(s&&s.height>0){const a=r.getRenderTarget(),h=new Mt(s.height/2);return h.fromEquirectangularTexture(r,i),e.set(i,h),r.setRenderTarget(a),i.addEventListener("dispose",n),t(h.texture,i.mapping)}return null}}}return i},dispose:function(){e=new WeakMap}}}function Hm(r){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=r.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float")},get:function(n){const i=t(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function Lc(r,e,t,n){const i={},o=new WeakMap;function s(h){const u=h.target;u.index!==null&&e.remove(u.index);for(const d in u.attributes)e.remove(u.attributes[d]);u.removeEventListener("dispose",s),delete i[u.id];const c=o.get(u);c&&(e.remove(c),o.delete(u)),n.releaseStatesOfGeometry(u),u.isInstancedBufferGeometry===!0&&delete u._maxInstanceCount,t.memory.geometries--}function a(h){const u=[],c=h.index,d=h.attributes.position;let f=0;if(c!==null){const v=c.array;f=c.version;for(let x=0,T=v.length;x<T;x+=3){const M=v[x+0],C=v[x+1],D=v[x+2];u.push(M,C,C,D,D,M)}}else{const v=d.array;f=d.version;for(let x=0,T=v.length/3-1;x<T;x+=3){const M=x+0,C=x+1,D=x+2;u.push(M,C,C,D,D,M)}}const m=new(Mc(u)>65535?Lr:va)(u,1);m.version=f;const g=o.get(h);g&&e.remove(g),o.set(h,m)}return{get:function(h,u){return i[u.id]===!0||(u.addEventListener("dispose",s),i[u.id]=!0,t.memory.geometries++),u},update:function(h){const u=h.attributes;for(const d in u)e.update(u[d],34962);const c=h.morphAttributes;for(const d in c){const f=c[d];for(let m=0,g=f.length;m<g;m++)e.update(f[m],34962)}},getWireframeAttribute:function(h){const u=o.get(h);if(u){const c=h.index;c!==null&&u.version<c.version&&a(h)}else a(h);return o.get(h)}}}function Fp(r,e,t,n){const i=n.isWebGL2;let o,s,a;this.setMode=function(h){o=h},this.setIndex=function(h){s=h.type,a=h.bytesPerElement},this.render=function(h,u){r.drawElements(o,u,s,h*a),t.update(u,o,1)},this.renderInstances=function(h,u,c){if(c===0)return;let d,f;if(i)d=r,f="drawElementsInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawElementsInstancedANGLE",d===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[f](o,u,s,h*a,c),t.update(u,o,c)}}function _h(r){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,i){switch(e.calls++,n){case 4:e.triangles+=i*(t/3);break;case 1:e.lines+=i*(t/2);break;case 3:e.lines+=i*(t-1);break;case 2:e.lines+=i*t;break;case 0:e.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Oc(r,e){return r[0]-e[0]}function Bp(r,e){return Math.abs(e[1])-Math.abs(r[1])}function Up(r){const e={},t=new Float32Array(8),n=[];for(let i=0;i<8;i++)n[i]=[i,0];return{update:function(i,o,s,a){const h=i.morphTargetInfluences,u=h===void 0?0:h.length;let c=e[o.id];if(c===void 0||c.length!==u){c=[];for(let v=0;v<u;v++)c[v]=[v,0];e[o.id]=c}for(let v=0;v<u;v++){const x=c[v];x[0]=v,x[1]=h[v]}c.sort(Bp);for(let v=0;v<8;v++)v<u&&c[v][1]?(n[v][0]=c[v][0],n[v][1]=c[v][1]):(n[v][0]=Number.MAX_SAFE_INTEGER,n[v][1]=0);n.sort(Oc);const d=s.morphTargets&&o.morphAttributes.position,f=s.morphNormals&&o.morphAttributes.normal;let m=0;for(let v=0;v<8;v++){const x=n[v],T=x[0],M=x[1];T!==Number.MAX_SAFE_INTEGER&&M?(d&&o.getAttribute("morphTarget"+v)!==d[T]&&o.setAttribute("morphTarget"+v,d[T]),f&&o.getAttribute("morphNormal"+v)!==f[T]&&o.setAttribute("morphNormal"+v,f[T]),t[v]=M,m+=M):(d&&o.hasAttribute("morphTarget"+v)===!0&&o.deleteAttribute("morphTarget"+v),f&&o.hasAttribute("morphNormal"+v)===!0&&o.deleteAttribute("morphNormal"+v),t[v]=0)}const g=o.morphTargetsRelative?1:1-m;a.getUniforms().setValue(r,"morphTargetBaseInfluence",g),a.getUniforms().setValue(r,"morphTargetInfluences",t)}}}function Zu(r,e,t,n){let i=new WeakMap;function o(s){const a=s.target;a.removeEventListener("dispose",o),t.remove(a.instanceMatrix),a.instanceColor!==null&&t.remove(a.instanceColor)}return{update:function(s){const a=n.render.frame,h=s.geometry,u=e.get(s,h);return i.get(u)!==a&&(e.update(u),i.set(u,a)),s.isInstancedMesh&&(s.hasEventListener("dispose",o)===!1&&s.addEventListener("dispose",o),t.update(s.instanceMatrix,34962),s.instanceColor!==null&&t.update(s.instanceColor,34962)),u},dispose:function(){i=new WeakMap}}}nr.physical={uniforms:bi([nr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new $e(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new ft(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new $e},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ft(0)}}]),vertexShader:Ct.meshphysical_vert,fragmentShader:Ct.meshphysical_frag};class $u extends qn{constructor(e=null,t=1,n=1,i=1){super(null),this.image={data:e,width:t,height:n,depth:i},this.magFilter=Xn,this.minFilter=Xn,this.wrapR=di,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}$u.prototype.isDataTexture2DArray=!0;class gr extends qn{constructor(e=null,t=1,n=1,i=1){super(null),this.image={data:e,width:t,height:n,depth:i},this.magFilter=Xn,this.minFilter=Xn,this.wrapR=di,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}gr.prototype.isDataTexture3D=!0;const Xo=new qn,kp=new $u,zm=new gr,Gp=new Or,Hp=[],Dc=[],Nc=new Float32Array(16),Fc=new Float32Array(9),Bc=new Float32Array(4);function Ea(r,e,t){const n=r[0];if(n<=0||n>0)return r;const i=e*t;let o=Hp[i];if(o===void 0&&(o=new Float32Array(i),Hp[i]=o),e!==0){n.toArray(o,0);for(let s=1,a=0;s!==e;++s)a+=t,r[s].toArray(o,a)}return o}function Fi(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}function Ri(r,e){for(let t=0,n=e.length;t<n;t++)r[t]=e[t]}function ir(r,e){let t=Dc[e];t===void 0&&(t=new Int32Array(e),Dc[e]=t);for(let n=0;n!==e;++n)t[n]=r.allocateTextureUnit();return t}function Vm(r,e){const t=this.cache;t[0]!==e&&(r.uniform1f(this.addr,e),t[0]=e)}function zp(r,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(r.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Fi(t,e))return;r.uniform2fv(this.addr,e),Ri(t,e)}}function jm(r,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(r.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)t[0]===e.r&&t[1]===e.g&&t[2]===e.b||(r.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Fi(t,e))return;r.uniform3fv(this.addr,e),Ri(t,e)}}function Uc(r,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Fi(t,e))return;r.uniform4fv(this.addr,e),Ri(t,e)}}function Wm(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Fi(t,e))return;r.uniformMatrix2fv(this.addr,!1,e),Ri(t,e)}else{if(Fi(t,n))return;Bc.set(n),r.uniformMatrix2fv(this.addr,!1,Bc),Ri(t,n)}}function Xm(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Fi(t,e))return;r.uniformMatrix3fv(this.addr,!1,e),Ri(t,e)}else{if(Fi(t,n))return;Fc.set(n),r.uniformMatrix3fv(this.addr,!1,Fc),Ri(t,n)}}function Ym(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Fi(t,e))return;r.uniformMatrix4fv(this.addr,!1,e),Ri(t,e)}else{if(Fi(t,n))return;Nc.set(n),r.uniformMatrix4fv(this.addr,!1,Nc),Ri(t,n)}}function kc(r,e){const t=this.cache;t[0]!==e&&(r.uniform1i(this.addr,e),t[0]=e)}function Vp(r,e){const t=this.cache;Fi(t,e)||(r.uniform2iv(this.addr,e),Ri(t,e))}function qm(r,e){const t=this.cache;Fi(t,e)||(r.uniform3iv(this.addr,e),Ri(t,e))}function Zm(r,e){const t=this.cache;Fi(t,e)||(r.uniform4iv(this.addr,e),Ri(t,e))}function $m(r,e){const t=this.cache;t[0]!==e&&(r.uniform1ui(this.addr,e),t[0]=e)}function Jm(r,e){const t=this.cache;Fi(t,e)||(r.uniform2uiv(this.addr,e),Ri(t,e))}function Km(r,e){const t=this.cache;Fi(t,e)||(r.uniform3uiv(this.addr,e),Ri(t,e))}function Qm(r,e){const t=this.cache;Fi(t,e)||(r.uniform4uiv(this.addr,e),Ri(t,e))}function jp(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.safeSetTexture2D(e||Xo,i)}function Ju(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||zm,i)}function eg(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.safeSetTextureCube(e||Gp,i)}function tg(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||kp,i)}function ng(r,e){r.uniform1fv(this.addr,e)}function ig(r,e){const t=Ea(e,this.size,2);r.uniform2fv(this.addr,t)}function Wp(r,e){const t=Ea(e,this.size,3);r.uniform3fv(this.addr,t)}function Xp(r,e){const t=Ea(e,this.size,4);r.uniform4fv(this.addr,t)}function rg(r,e){const t=Ea(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,t)}function og(r,e){const t=Ea(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,t)}function sg(r,e){const t=Ea(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,t)}function Ku(r,e){r.uniform1iv(this.addr,e)}function ag(r,e){r.uniform2iv(this.addr,e)}function hg(r,e){r.uniform3iv(this.addr,e)}function Qu(r,e){r.uniform4iv(this.addr,e)}function Yp(r,e){r.uniform1uiv(this.addr,e)}function qp(r,e){r.uniform2uiv(this.addr,e)}function Gc(r,e){r.uniform3uiv(this.addr,e)}function Zp(r,e){r.uniform4uiv(this.addr,e)}function $p(r,e,t){const n=e.length,i=ir(t,n);r.uniform1iv(this.addr,i);for(let o=0;o!==n;++o)t.safeSetTexture2D(e[o]||Xo,i[o])}function ug(r,e,t){const n=e.length,i=ir(t,n);r.uniform1iv(this.addr,i);for(let o=0;o!==n;++o)t.safeSetTextureCube(e[o]||Gp,i[o])}function lg(r,e,t){this.id=r,this.addr=t,this.cache=[],this.setValue=function(n){switch(n){case 5126:return Vm;case 35664:return zp;case 35665:return jm;case 35666:return Uc;case 35674:return Wm;case 35675:return Xm;case 35676:return Ym;case 5124:case 35670:return kc;case 35667:case 35671:return Vp;case 35668:case 35672:return qm;case 35669:case 35673:return Zm;case 5125:return $m;case 36294:return Jm;case 36295:return Km;case 36296:return Qm;case 35678:case 36198:case 36298:case 36306:case 35682:return jp;case 35679:case 36299:case 36307:return Ju;case 35680:case 36300:case 36308:case 36293:return eg;case 36289:case 36303:case 36311:case 36292:return tg}}(e.type)}function yh(r,e,t){this.id=r,this.addr=t,this.cache=[],this.size=e.size,this.setValue=function(n){switch(n){case 5126:return ng;case 35664:return ig;case 35665:return Wp;case 35666:return Xp;case 35674:return rg;case 35675:return og;case 35676:return sg;case 5124:case 35670:return Ku;case 35667:case 35671:return ag;case 35668:case 35672:return hg;case 35669:case 35673:return Qu;case 5125:return Yp;case 36294:return qp;case 36295:return Gc;case 36296:return Zp;case 35678:case 36198:case 36298:case 36306:case 35682:return $p;case 35680:case 36300:case 36308:case 36293:return ug}}(e.type)}function xh(r){this.id=r,this.seq=[],this.map={}}yh.prototype.updateCache=function(r){const e=this.cache;r instanceof Float32Array&&e.length!==r.length&&(this.cache=new Float32Array(r.length)),Ri(e,r)},xh.prototype.setValue=function(r,e,t){const n=this.seq;for(let i=0,o=n.length;i!==o;++i){const s=n[i];s.setValue(r,e[s.id],t)}};const Hc=/(\w+)(\])?(\[|\.)?/g;function el(r,e){r.seq.push(e),r.map[e.id]=e}function Jp(r,e,t){const n=r.name,i=n.length;for(Hc.lastIndex=0;;){const o=Hc.exec(n),s=Hc.lastIndex;let a=o[1];const h=o[2]==="]",u=o[3];if(h&&(a|=0),u===void 0||u==="["&&s+2===i){el(t,u===void 0?new lg(a,r,e):new yh(a,r,e));break}{let c=t.map[a];c===void 0&&(c=new xh(a),el(t,c)),t=c}}}function Yo(r,e){this.seq=[],this.map={};const t=r.getProgramParameter(e,35718);for(let n=0;n<t;++n){const i=r.getActiveUniform(e,n);Jp(i,r.getUniformLocation(e,i.name),this)}}function vr(r,e,t){const n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n}Yo.prototype.setValue=function(r,e,t,n){const i=this.map[e];i!==void 0&&i.setValue(r,t,n)},Yo.prototype.setOptional=function(r,e,t){const n=e[t];n!==void 0&&this.setValue(r,t,n)},Yo.upload=function(r,e,t,n){for(let i=0,o=e.length;i!==o;++i){const s=e[i],a=t[s.id];a.needsUpdate!==!1&&s.setValue(r,a.value,n)}},Yo.seqWithValue=function(r,e){const t=[];for(let n=0,i=r.length;n!==i;++n){const o=r[n];o.id in e&&t.push(o)}return t};let cg=0;function Kp(r){switch(r){case xt:return["Linear","( value )"];case Zt:return["sRGB","( value )"];case Ki:return["RGBE","( value )"];case th:return["RGBM","( value, 7.0 )"];case uc:return["RGBM","( value, 16.0 )"];case zi:return["RGBD","( value, 256.0 )"];case kn:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case _n:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",r),["Linear","( value )"]}}function qo(r,e,t){const n=r.getShaderParameter(e,35713),i=r.getShaderInfoLog(e).trim();return n&&i===""?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+t+`
`+i+function(o){const s=o.split(`
`);for(let a=0;a<s.length;a++)s[a]=a+1+": "+s[a];return s.join(`
`)}(r.getShaderSource(e))}function Ft(r,e){const t=Kp(e);return"vec4 "+r+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function dg(r,e){const t=Kp(e);return"vec4 "+r+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Wi(r,e){let t;switch(e){case Kd:t="Linear";break;case Qd:t="Reinhard";break;case ep:t="OptimizedCineon";break;case tp:t="ACESFilmic";break;case np:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+r+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function En(r){return r!==""}function _o(r,e){return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Qp(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const zc=/^[ \t]*#include +<([\w\d./]+)>/gm;function Dr(r){return r.replace(zc,ef)}function ef(r,e){const t=Ct[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return Dr(t)}const tl=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Dn=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Nn(r){return r.replace(Dn,Vc).replace(tl,tf)}function tf(r,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Vc(r,e,t,n)}function Vc(r,e,t,n){let i="";for(let o=parseInt(e);o<parseInt(t);o++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function Ma(r){let e="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function jc(r,e,t,n){const i=r.getContext(),o=t.defines;let s=t.vertexShader,a=t.fragmentShader;const h=function(U){let he="SHADOWMAP_TYPE_BASIC";return U.shadowMapType===I?he="SHADOWMAP_TYPE_PCF":U.shadowMapType===z?he="SHADOWMAP_TYPE_PCF_SOFT":U.shadowMapType===L&&(he="SHADOWMAP_TYPE_VSM"),he}(t),u=function(U){let he="ENVMAP_TYPE_CUBE";if(U.envMap)switch(U.envMapMode){case Lo:case Wa:he="ENVMAP_TYPE_CUBE";break;case ra:case oa:he="ENVMAP_TYPE_CUBE_UV"}return he}(t),c=function(U){let he="ENVMAP_MODE_REFLECTION";if(U.envMap)switch(U.envMapMode){case Wa:case oa:he="ENVMAP_MODE_REFRACTION"}return he}(t),d=function(U){let he="ENVMAP_BLENDING_NONE";if(U.envMap)switch(U.combine){case ja:he="ENVMAP_BLENDING_MULTIPLY";break;case $d:he="ENVMAP_BLENDING_MIX";break;case Jd:he="ENVMAP_BLENDING_ADD"}return he}(t),f=r.gammaFactor>0?r.gammaFactor:1,m=t.isWebGL2?"":function(U){return[U.extensionDerivatives||U.envMapCubeUV||U.bumpMap||U.tangentSpaceNormalMap||U.clearcoatNormalMap||U.flatShading||U.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(U.extensionFragDepth||U.logarithmicDepthBuffer)&&U.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",U.extensionDrawBuffers&&U.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(U.extensionShaderTextureLOD||U.envMap||U.transmission>0)&&U.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(En).join(`
`)}(t),g=function(U){const he=[];for(const Q in U){const X=U[Q];X!==!1&&he.push("#define "+Q+" "+X)}return he.join(`
`)}(o),v=i.createProgram();let x,T,M=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(x=[g].filter(En).join(`
`),x.length>0&&(x+=`
`),T=[m,g].filter(En).join(`
`),T.length>0&&(T+=`
`)):(x=[Ma(t),"#define SHADER_NAME "+t.shaderName,g,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+f,"#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(En).join(`
`),T=[m,Ma(t),"#define SHADER_NAME "+t.shaderName,g,t.alphaTest?"#define ALPHATEST "+t.alphaTest+(t.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+f,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.sheen?"#define USE_SHEEN":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==io?"#define TONE_MAPPING":"",t.toneMapping!==io?Ct.tonemapping_pars_fragment:"",t.toneMapping!==io?Wi("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",Ct.encodings_pars_fragment,t.map?Ft("mapTexelToLinear",t.mapEncoding):"",t.matcap?Ft("matcapTexelToLinear",t.matcapEncoding):"",t.envMap?Ft("envMapTexelToLinear",t.envMapEncoding):"",t.emissiveMap?Ft("emissiveMapTexelToLinear",t.emissiveMapEncoding):"",t.lightMap?Ft("lightMapTexelToLinear",t.lightMapEncoding):"",dg("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(En).join(`
`)),s=Dr(s),s=_o(s,t),s=Qp(s,t),a=Dr(a),a=_o(a,t),a=Qp(a,t),s=Nn(s),a=Nn(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(M=`#version 300 es
`,x=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+x,T=["#define varying in",t.glslVersion===dc?"":"out highp vec4 pc_fragColor;",t.glslVersion===dc?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);const C=M+T+a,D=vr(i,35633,M+x+s),R=vr(i,35632,C);if(i.attachShader(v,D),i.attachShader(v,R),t.index0AttributeName!==void 0?i.bindAttribLocation(v,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(v,0,"position"),i.linkProgram(v),r.debug.checkShaderErrors){const U=i.getProgramInfoLog(v).trim(),he=i.getShaderInfoLog(D).trim(),Q=i.getShaderInfoLog(R).trim();let X=!0,Z=!0;if(i.getProgramParameter(v,35714)===!1){X=!1;const q=qo(i,D,"vertex"),oe=qo(i,R,"fragment");console.error("THREE.WebGLProgram: shader error: ",i.getError(),"35715",i.getProgramParameter(v,35715),"gl.getProgramInfoLog",U,q,oe)}else U!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",U):he!==""&&Q!==""||(Z=!1);Z&&(this.diagnostics={runnable:X,programLog:U,vertexShader:{log:he,prefix:x},fragmentShader:{log:Q,prefix:T}})}let F,O;return i.deleteShader(D),i.deleteShader(R),this.getUniforms=function(){return F===void 0&&(F=new Yo(i,v)),F},this.getAttributes=function(){return O===void 0&&(O=function(U,he){const Q={},X=U.getProgramParameter(he,35721);for(let Z=0;Z<X;Z++){const q=U.getActiveAttrib(he,Z).name;Q[q]=U.getAttribLocation(he,q)}return Q}(i,v)),O},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(v),this.program=void 0},this.name=t.shaderName,this.id=cg++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=D,this.fragmentShader=R,this}function nf(r,e,t,n,i,o){const s=[],a=n.isWebGL2,h=n.logarithmicDepthBuffer,u=n.floatVertexTextures,c=n.maxVertexUniforms,d=n.vertexTextures;let f=n.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},g=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmission","transmissionMap","thicknessMap"];function v(x){let T;return x&&x.isTexture?T=x.encoding:x&&x.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),T=x.texture.encoding):T=xt,T}return{getParameters:function(x,T,M,C,D){const R=C.fog,F=x.isMeshStandardMaterial?C.environment:null,O=e.get(x.envMap||F),U=m[x.type],he=D.isSkinnedMesh?function(q){const oe=q.skeleton.bones;if(u)return 1024;{const fe=c,me=Math.floor((fe-20)/4),le=Math.min(me,oe.length);return le<oe.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+oe.length+" bones. This GPU supports "+le+"."),0):le}}(D):0;let Q,X;if(x.precision!==null&&(f=n.getMaxPrecision(x.precision),f!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",f,"instead.")),U){const q=nr[U];Q=q.vertexShader,X=q.fragmentShader}else Q=x.vertexShader,X=x.fragmentShader;const Z=r.getRenderTarget();return{isWebGL2:a,shaderID:U,shaderName:x.type,vertexShader:Q,fragmentShader:X,defines:x.defines,isRawShaderMaterial:x.isRawShaderMaterial===!0,glslVersion:x.glslVersion,precision:f,instancing:D.isInstancedMesh===!0,instancingColor:D.isInstancedMesh===!0&&D.instanceColor!==null,supportsVertexTextures:d,outputEncoding:Z!==null?v(Z.texture):r.outputEncoding,map:!!x.map,mapEncoding:v(x.map),matcap:!!x.matcap,matcapEncoding:v(x.matcap),envMap:!!O,envMapMode:O&&O.mapping,envMapEncoding:v(O),envMapCubeUV:!!O&&(O.mapping===ra||O.mapping===oa),lightMap:!!x.lightMap,lightMapEncoding:v(x.lightMap),aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,emissiveMapEncoding:v(x.emissiveMap),bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:x.normalMapType===ih,tangentSpaceNormalMap:x.normalMapType===ur,clearcoatMap:!!x.clearcoatMap,clearcoatRoughnessMap:!!x.clearcoatRoughnessMap,clearcoatNormalMap:!!x.clearcoatNormalMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,alphaMap:!!x.alphaMap,gradientMap:!!x.gradientMap,sheen:!!x.sheen,transmission:!!x.transmission,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:x.normalMap&&x.vertexTangents,vertexColors:x.vertexColors,vertexAlphas:x.vertexColors===!0&&D.geometry&&D.geometry.attributes.color&&D.geometry.attributes.color.itemSize===4,vertexUvs:!!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatMap||x.clearcoatRoughnessMap||x.clearcoatNormalMap||x.displacementMap||x.transmissionMap||x.thicknessMap),uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.transmission||x.transmissionMap||x.thicknessMap||!x.displacementMap),fog:!!R,useFog:x.fog,fogExp2:R&&R.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:h,skinning:D.isSkinnedMesh===!0&&he>0,maxBones:he,useVertexTexture:u,morphTargets:x.morphTargets,morphNormals:x.morphNormals,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:r.shadowMap.enabled&&M.length>0,shadowMapType:r.shadowMap.type,toneMapping:x.toneMapped?r.toneMapping:io,physicallyCorrectLights:r.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,alphaTest:x.alphaTest,doubleSided:x.side===J,flipSided:x.side===j,depthPacking:x.depthPacking!==void 0&&x.depthPacking,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||t.has("EXT_frag_depth"),rendererExtensionDrawBuffers:a||t.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||t.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}},getProgramCacheKey:function(x){const T=[];if(x.shaderID?T.push(x.shaderID):(T.push(x.fragmentShader),T.push(x.vertexShader)),x.defines!==void 0)for(const M in x.defines)T.push(M),T.push(x.defines[M]);if(x.isRawShaderMaterial===!1){for(let M=0;M<g.length;M++)T.push(x[g[M]]);T.push(r.outputEncoding),T.push(r.gammaFactor)}return T.push(x.customProgramCacheKey),T.join()},getUniforms:function(x){const T=m[x.type];let M;if(T){const C=nr[T];M=qr.clone(C.uniforms)}else M=x.uniforms;return M},acquireProgram:function(x,T){let M;for(let C=0,D=s.length;C<D;C++){const R=s[C];if(R.cacheKey===T){M=R,++M.usedTimes;break}}return M===void 0&&(M=new jc(r,T,x,i),s.push(M)),M},releaseProgram:function(x){if(--x.usedTimes==0){const T=s.indexOf(x);s[T]=s[s.length-1],s.pop(),x.destroy()}},programs:s}}function nl(){let r=new WeakMap;return{get:function(e){let t=r.get(e);return t===void 0&&(t={},r.set(e,t)),t},remove:function(e){r.delete(e)},update:function(e,t,n){r.get(e)[t]=n},dispose:function(){r=new WeakMap}}}function rr(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.program!==e.program?r.program.id-e.program.id:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function Bs(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function rf(r){const e=[];let t=0;const n=[],i=[],o=[],s={id:-1};function a(h,u,c,d,f,m){let g=e[t];const v=r.get(c);return g===void 0?(g={id:h.id,object:h,geometry:u,material:c,program:v.program||s,groupOrder:d,renderOrder:h.renderOrder,z:f,group:m},e[t]=g):(g.id=h.id,g.object=h,g.geometry=u,g.material=c,g.program=v.program||s,g.groupOrder=d,g.renderOrder=h.renderOrder,g.z=f,g.group=m),t++,g}return{opaque:n,transmissive:i,transparent:o,init:function(){t=0,n.length=0,i.length=0,o.length=0},push:function(h,u,c,d,f,m){const g=a(h,u,c,d,f,m);c.transmission>0?i.push(g):c.transparent===!0?o.push(g):n.push(g)},unshift:function(h,u,c,d,f,m){const g=a(h,u,c,d,f,m);c.transmission>0?i.unshift(g):c.transparent===!0?o.unshift(g):n.unshift(g)},finish:function(){for(let h=t,u=e.length;h<u;h++){const c=e[h];if(c.id===null)break;c.id=null,c.object=null,c.geometry=null,c.material=null,c.program=null,c.group=null}},sort:function(h,u){n.length>1&&n.sort(h||rr),i.length>1&&i.sort(u||Bs),o.length>1&&o.sort(u||Bs)}}}function pg(r){let e=new WeakMap;return{get:function(t,n){let i;return e.has(t)===!1?(i=new rf(r),e.set(t,[i])):n>=e.get(t).length?(i=new rf(r),e.get(t).push(i)):i=e.get(t)[n],i},dispose:function(){e=new WeakMap}}}function of(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new w,color:new ft};break;case"SpotLight":t={position:new w,direction:new w,color:new ft,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new w,color:new ft,distance:0,decay:0};break;case"HemisphereLight":t={direction:new w,skyColor:new ft,groundColor:new ft};break;case"RectAreaLight":t={color:new ft,position:new w,halfWidth:new w,halfHeight:new w}}return r[e.id]=t,t}}}let yo=0;function Xt(r,e){return(e.castShadow?1:0)-(r.castShadow?1:0)}function sf(r,e){const t=new of,n=function(){const h={};return{get:function(u){if(h[u.id]!==void 0)return h[u.id];let c;switch(u.type){case"DirectionalLight":case"SpotLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $e};break;case"PointLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $e,shadowCameraNear:1,shadowCameraFar:1e3}}return h[u.id]=c,c}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let h=0;h<9;h++)i.probe.push(new w);const o=new w,s=new ct,a=new ct;return{setup:function(h){let u=0,c=0,d=0;for(let R=0;R<9;R++)i.probe[R].set(0,0,0);let f=0,m=0,g=0,v=0,x=0,T=0,M=0,C=0;h.sort(Xt);for(let R=0,F=h.length;R<F;R++){const O=h[R],U=O.color,he=O.intensity,Q=O.distance,X=O.shadow&&O.shadow.map?O.shadow.map.texture:null;if(O.isAmbientLight)u+=U.r*he,c+=U.g*he,d+=U.b*he;else if(O.isLightProbe)for(let Z=0;Z<9;Z++)i.probe[Z].addScaledVector(O.sh.coefficients[Z],he);else if(O.isDirectionalLight){const Z=t.get(O);if(Z.color.copy(O.color).multiplyScalar(O.intensity),O.castShadow){const q=O.shadow,oe=n.get(O);oe.shadowBias=q.bias,oe.shadowNormalBias=q.normalBias,oe.shadowRadius=q.radius,oe.shadowMapSize=q.mapSize,i.directionalShadow[f]=oe,i.directionalShadowMap[f]=X,i.directionalShadowMatrix[f]=O.shadow.matrix,T++}i.directional[f]=Z,f++}else if(O.isSpotLight){const Z=t.get(O);if(Z.position.setFromMatrixPosition(O.matrixWorld),Z.color.copy(U).multiplyScalar(he),Z.distance=Q,Z.coneCos=Math.cos(O.angle),Z.penumbraCos=Math.cos(O.angle*(1-O.penumbra)),Z.decay=O.decay,O.castShadow){const q=O.shadow,oe=n.get(O);oe.shadowBias=q.bias,oe.shadowNormalBias=q.normalBias,oe.shadowRadius=q.radius,oe.shadowMapSize=q.mapSize,i.spotShadow[g]=oe,i.spotShadowMap[g]=X,i.spotShadowMatrix[g]=O.shadow.matrix,C++}i.spot[g]=Z,g++}else if(O.isRectAreaLight){const Z=t.get(O);Z.color.copy(U).multiplyScalar(he),Z.halfWidth.set(.5*O.width,0,0),Z.halfHeight.set(0,.5*O.height,0),i.rectArea[v]=Z,v++}else if(O.isPointLight){const Z=t.get(O);if(Z.color.copy(O.color).multiplyScalar(O.intensity),Z.distance=O.distance,Z.decay=O.decay,O.castShadow){const q=O.shadow,oe=n.get(O);oe.shadowBias=q.bias,oe.shadowNormalBias=q.normalBias,oe.shadowRadius=q.radius,oe.shadowMapSize=q.mapSize,oe.shadowCameraNear=q.camera.near,oe.shadowCameraFar=q.camera.far,i.pointShadow[m]=oe,i.pointShadowMap[m]=X,i.pointShadowMatrix[m]=O.shadow.matrix,M++}i.point[m]=Z,m++}else if(O.isHemisphereLight){const Z=t.get(O);Z.skyColor.copy(O.color).multiplyScalar(he),Z.groundColor.copy(O.groundColor).multiplyScalar(he),i.hemi[x]=Z,x++}}v>0&&(e.isWebGL2||r.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=lt.LTC_FLOAT_1,i.rectAreaLTC2=lt.LTC_FLOAT_2):r.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=lt.LTC_HALF_1,i.rectAreaLTC2=lt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=u,i.ambient[1]=c,i.ambient[2]=d;const D=i.hash;D.directionalLength===f&&D.pointLength===m&&D.spotLength===g&&D.rectAreaLength===v&&D.hemiLength===x&&D.numDirectionalShadows===T&&D.numPointShadows===M&&D.numSpotShadows===C||(i.directional.length=f,i.spot.length=g,i.rectArea.length=v,i.point.length=m,i.hemi.length=x,i.directionalShadow.length=T,i.directionalShadowMap.length=T,i.pointShadow.length=M,i.pointShadowMap.length=M,i.spotShadow.length=C,i.spotShadowMap.length=C,i.directionalShadowMatrix.length=T,i.pointShadowMatrix.length=M,i.spotShadowMatrix.length=C,D.directionalLength=f,D.pointLength=m,D.spotLength=g,D.rectAreaLength=v,D.hemiLength=x,D.numDirectionalShadows=T,D.numPointShadows=M,D.numSpotShadows=C,i.version=yo++)},setupView:function(h,u){let c=0,d=0,f=0,m=0,g=0;const v=u.matrixWorldInverse;for(let x=0,T=h.length;x<T;x++){const M=h[x];if(M.isDirectionalLight){const C=i.directional[c];C.direction.setFromMatrixPosition(M.matrixWorld),o.setFromMatrixPosition(M.target.matrixWorld),C.direction.sub(o),C.direction.transformDirection(v),c++}else if(M.isSpotLight){const C=i.spot[f];C.position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(v),C.direction.setFromMatrixPosition(M.matrixWorld),o.setFromMatrixPosition(M.target.matrixWorld),C.direction.sub(o),C.direction.transformDirection(v),f++}else if(M.isRectAreaLight){const C=i.rectArea[m];C.position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(v),a.identity(),s.copy(M.matrixWorld),s.premultiply(v),a.extractRotation(s),C.halfWidth.set(.5*M.width,0,0),C.halfHeight.set(0,.5*M.height,0),C.halfWidth.applyMatrix4(a),C.halfHeight.applyMatrix4(a),m++}else if(M.isPointLight){const C=i.point[d];C.position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(v),d++}else if(M.isHemisphereLight){const C=i.hemi[g];C.direction.setFromMatrixPosition(M.matrixWorld),C.direction.transformDirection(v),C.direction.normalize(),g++}}},state:i}}function or(r,e){const t=new sf(r,e),n=[],i=[];return{init:function(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:t},setupLights:function(){t.setup(n)},setupLightsView:function(o){t.setupView(n,o)},pushLight:function(o){n.push(o)},pushShadow:function(o){i.push(o)}}}function af(r,e){let t=new WeakMap;return{get:function(n,i=0){let o;return t.has(n)===!1?(o=new or(r,e),t.set(n,[o])):i>=t.get(n).length?(o=new or(r,e),t.get(n).push(o)):o=t.get(n)[i],o},dispose:function(){t=new WeakMap}}}class nn extends fi{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=nh,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}nn.prototype.isMeshDepthMaterial=!0;class il extends fi{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new w,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}il.prototype.isMeshDistanceMaterial=!0;function Wc(r,e,t){let n=new Sa;const i=new $e,o=new $e,s=new cn,a=[],h=[],u={},c=t.maxTextureSize,d={0:j,1:G,2:J},f=new Ni({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new $e},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),m=f.clone();m.defines.HORIZONTAL_PASS=1;const g=new St;g.setAttribute("position",new Yt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new sn(g,f),x=this;function T(F,O){const U=e.update(v);f.uniforms.shadow_pass.value=F.map.texture,f.uniforms.resolution.value=F.mapSize,f.uniforms.radius.value=F.radius,r.setRenderTarget(F.mapPass),r.clear(),r.renderBufferDirect(O,null,U,f,v,null),m.uniforms.shadow_pass.value=F.mapPass.texture,m.uniforms.resolution.value=F.mapSize,m.uniforms.radius.value=F.radius,r.setRenderTarget(F.map),r.clear(),r.renderBufferDirect(O,null,U,m,v,null)}function M(F){const O=F<<0;let U=a[O];return U===void 0&&(U=new nn({depthPacking:lc,morphTargets:F}),a[O]=U),U}function C(F){const O=F<<0;let U=h[O];return U===void 0&&(U=new il({morphTargets:F}),h[O]=U),U}function D(F,O,U,he,Q,X,Z){let q=null,oe=M,fe=F.customDepthMaterial;if(he.isPointLight===!0&&(oe=C,fe=F.customDistanceMaterial),fe===void 0){let me=!1;U.morphTargets===!0&&(me=O.morphAttributes&&O.morphAttributes.position&&O.morphAttributes.position.length>0),q=oe(me)}else q=fe;if(r.localClippingEnabled&&U.clipShadows===!0&&U.clippingPlanes.length!==0){const me=q.uuid,le=U.uuid;let pe=u[me];pe===void 0&&(pe={},u[me]=pe);let Pe=pe[le];Pe===void 0&&(Pe=q.clone(),pe[le]=Pe),q=Pe}return q.visible=U.visible,q.wireframe=U.wireframe,q.side=Z===L?U.shadowSide!==null?U.shadowSide:U.side:U.shadowSide!==null?U.shadowSide:d[U.side],q.clipShadows=U.clipShadows,q.clippingPlanes=U.clippingPlanes,q.clipIntersection=U.clipIntersection,q.wireframeLinewidth=U.wireframeLinewidth,q.linewidth=U.linewidth,he.isPointLight===!0&&q.isMeshDistanceMaterial===!0&&(q.referencePosition.setFromMatrixPosition(he.matrixWorld),q.nearDistance=Q,q.farDistance=X),q}function R(F,O,U,he,Q){if(F.visible===!1)return;if(F.layers.test(O.layers)&&(F.isMesh||F.isLine||F.isPoints)&&(F.castShadow||F.receiveShadow&&Q===L)&&(!F.frustumCulled||n.intersectsObject(F))){F.modelViewMatrix.multiplyMatrices(U.matrixWorldInverse,F.matrixWorld);const Z=e.update(F),q=F.material;if(Array.isArray(q)){const oe=Z.groups;for(let fe=0,me=oe.length;fe<me;fe++){const le=oe[fe],pe=q[le.materialIndex];if(pe&&pe.visible){const Pe=D(F,Z,pe,he,U.near,U.far,Q);r.renderBufferDirect(U,null,Z,Pe,F,le)}}}else if(q.visible){const oe=D(F,Z,q,he,U.near,U.far,Q);r.renderBufferDirect(U,null,Z,oe,F,null)}}const X=F.children;for(let Z=0,q=X.length;Z<q;Z++)R(X[Z],O,U,he,Q)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=I,this.render=function(F,O,U){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||F.length===0)return;const he=r.getRenderTarget(),Q=r.getActiveCubeFace(),X=r.getActiveMipmapLevel(),Z=r.state;Z.setBlending(Ze),Z.buffers.color.setClear(1,1,1,1),Z.buffers.depth.setTest(!0),Z.setScissorTest(!1);for(let q=0,oe=F.length;q<oe;q++){const fe=F[q],me=fe.shadow;if(me===void 0){console.warn("THREE.WebGLShadowMap:",fe,"has no shadow.");continue}if(me.autoUpdate===!1&&me.needsUpdate===!1)continue;i.copy(me.mapSize);const le=me.getFrameExtents();if(i.multiply(le),o.copy(me.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(o.x=Math.floor(c/le.x),i.x=o.x*le.x,me.mapSize.x=o.x),i.y>c&&(o.y=Math.floor(c/le.y),i.y=o.y*le.y,me.mapSize.y=o.y)),me.map===null&&!me.isPointLightShadow&&this.type===L){const Pe={minFilter:Yn,magFilter:Yn,format:$i};me.map=new Ar(i.x,i.y,Pe),me.map.texture.name=fe.name+".shadowMap",me.mapPass=new Ar(i.x,i.y,Pe),me.camera.updateProjectionMatrix()}if(me.map===null){const Pe={minFilter:Xn,magFilter:Xn,format:$i};me.map=new Ar(i.x,i.y,Pe),me.map.texture.name=fe.name+".shadowMap",me.camera.updateProjectionMatrix()}r.setRenderTarget(me.map),r.clear();const pe=me.getViewportCount();for(let Pe=0;Pe<pe;Pe++){const Ue=me.getViewport(Pe);s.set(o.x*Ue.x,o.y*Ue.y,o.x*Ue.z,o.y*Ue.w),Z.viewport(s),me.updateMatrices(fe,Pe),n=me.getFrustum(),R(O,U,me.camera,fe,this.type)}me.isPointLightShadow||this.type!==L||T(me,U),me.needsUpdate=!1}x.needsUpdate=!1,r.setRenderTarget(he,Q,X)}}function rl(r,e,t){const n=t.isWebGL2,i=new function(){let W=!1;const de=new cn;let _e=null;const ye=new cn(0,0,0,0);return{setMask:function(Oe){_e===Oe||W||(r.colorMask(Oe,Oe,Oe,Oe),_e=Oe)},setLocked:function(Oe){W=Oe},setClear:function(Oe,ht,_t,gt,Ut){Ut===!0&&(Oe*=gt,ht*=gt,_t*=gt),de.set(Oe,ht,_t,gt),ye.equals(de)===!1&&(r.clearColor(Oe,ht,_t,gt),ye.copy(de))},reset:function(){W=!1,_e=null,ye.set(-1,0,0,0)}}},o=new function(){let W=!1,de=null,_e=null,ye=null;return{setTest:function(Oe){Oe?Fe(2929):Y(2929)},setMask:function(Oe){de===Oe||W||(r.depthMask(Oe),de=Oe)},setFunc:function(Oe){if(_e!==Oe){if(Oe)switch(Oe){case Wn:r.depthFunc(512);break;case vn:r.depthFunc(519);break;case ri:r.depthFunc(513);break;case Li:r.depthFunc(515);break;case Ei:r.depthFunc(514);break;case ki:r.depthFunc(518);break;case Mr:r.depthFunc(516);break;case Zd:r.depthFunc(517);break;default:r.depthFunc(515)}else r.depthFunc(515);_e=Oe}},setLocked:function(Oe){W=Oe},setClear:function(Oe){ye!==Oe&&(r.clearDepth(Oe),ye=Oe)},reset:function(){W=!1,de=null,_e=null,ye=null}}},s=new function(){let W=!1,de=null,_e=null,ye=null,Oe=null,ht=null,_t=null,gt=null,Ut=null;return{setTest:function(Vt){W||(Vt?Fe(2960):Y(2960))},setMask:function(Vt){de===Vt||W||(r.stencilMask(Vt),de=Vt)},setFunc:function(Vt,ii,An){_e===Vt&&ye===ii&&Oe===An||(r.stencilFunc(Vt,ii,An),_e=Vt,ye=ii,Oe=An)},setOp:function(Vt,ii,An){ht===Vt&&_t===ii&&gt===An||(r.stencilOp(Vt,ii,An),ht=Vt,_t=ii,gt=An)},setLocked:function(Vt){W=Vt},setClear:function(Vt){Ut!==Vt&&(r.clearStencil(Vt),Ut=Vt)},reset:function(){W=!1,de=null,_e=null,ye=null,Oe=null,ht=null,_t=null,gt=null,Ut=null}}};let a={},h=null,u={},c=null,d=!1,f=null,m=null,g=null,v=null,x=null,T=null,M=null,C=!1,D=null,R=null,F=null,O=null,U=null;const he=r.getParameter(35661);let Q=!1,X=0;const Z=r.getParameter(7938);Z.indexOf("WebGL")!==-1?(X=parseFloat(/^WebGL (\d)/.exec(Z)[1]),Q=X>=1):Z.indexOf("OpenGL ES")!==-1&&(X=parseFloat(/^OpenGL ES (\d)/.exec(Z)[1]),Q=X>=2);let q=null,oe={};const fe=r.getParameter(3088),me=r.getParameter(2978),le=new cn().fromArray(fe),pe=new cn().fromArray(me);function Pe(W,de,_e){const ye=new Uint8Array(4),Oe=r.createTexture();r.bindTexture(W,Oe),r.texParameteri(W,10241,9728),r.texParameteri(W,10240,9728);for(let ht=0;ht<_e;ht++)r.texImage2D(de+ht,0,6408,1,1,0,6408,5121,ye);return Oe}const Ue={};function Fe(W){a[W]!==!0&&(r.enable(W),a[W]=!0)}function Y(W){a[W]!==!1&&(r.disable(W),a[W]=!1)}Ue[3553]=Pe(3553,3553,1),Ue[34067]=Pe(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),s.setClear(0),Fe(2929),o.setFunc(Li),we(!1),ke(Ne),Fe(2884),De(Ze);const $={[Ee]:32774,[Ie]:32778,[Se]:32779};if(n)$[Be]=32775,$[Xe]=32776;else{const W=e.get("EXT_blend_minmax");W!==null&&($[Be]=W.MIN_EXT,$[Xe]=W.MAX_EXT)}const Me={[ot]:0,[nt]:1,[Jt]:768,[Kt]:770,[fn]:776,[In]:774,[Ht]:772,[st]:769,[Nt]:771,[xn]:775,[yt]:773};function De(W,de,_e,ye,Oe,ht,_t,gt){if(W!==Ze){if(d===!1&&(Fe(3042),d=!0),W===xe)Oe=Oe||de,ht=ht||_e,_t=_t||ye,de===m&&Oe===x||(r.blendEquationSeparate($[de],$[Oe]),m=de,x=Oe),_e===g&&ye===v&&ht===T&&_t===M||(r.blendFuncSeparate(Me[_e],Me[ye],Me[ht],Me[_t]),g=_e,v=ye,T=ht,M=_t),f=W,C=null;else if(W!==f||gt!==C){if(m===Ee&&x===Ee||(r.blendEquation(32774),m=Ee,x=Ee),gt)switch(W){case se:r.blendFuncSeparate(1,771,1,771);break;case Ae:r.blendFunc(1,1);break;case Re:r.blendFuncSeparate(0,0,769,771);break;case k:r.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",W)}else switch(W){case se:r.blendFuncSeparate(770,771,1,771);break;case Ae:r.blendFunc(770,1);break;case Re:r.blendFunc(0,769);break;case k:r.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",W)}g=null,v=null,T=null,M=null,f=W,C=gt}}else d===!0&&(Y(3042),d=!1)}function we(W){D!==W&&(W?r.frontFace(2304):r.frontFace(2305),D=W)}function ke(W){W!==Te?(Fe(2884),W!==R&&(W===Ne?r.cullFace(1029):W===Le?r.cullFace(1028):r.cullFace(1032))):Y(2884),R=W}function We(W,de,_e){W?(Fe(32823),O===de&&U===_e||(r.polygonOffset(de,_e),O=de,U=_e)):Y(32823)}function ge(W){W===void 0&&(W=33984+he-1),q!==W&&(r.activeTexture(W),q=W)}return{buffers:{color:i,depth:o,stencil:s},enable:Fe,disable:Y,bindFramebuffer:function(W,de){return de===null&&h!==null&&(de=h),u[W]!==de&&(r.bindFramebuffer(W,de),u[W]=de,n&&(W===36009&&(u[36160]=de),W===36160&&(u[36009]=de)),!0)},bindXRFramebuffer:function(W){W!==h&&(r.bindFramebuffer(36160,W),h=W)},useProgram:function(W){return c!==W&&(r.useProgram(W),c=W,!0)},setBlending:De,setMaterial:function(W,de){W.side===J?Y(2884):Fe(2884);let _e=W.side===j;de&&(_e=!_e),we(_e),W.blending===se&&W.transparent===!1?De(Ze):De(W.blending,W.blendEquation,W.blendSrc,W.blendDst,W.blendEquationAlpha,W.blendSrcAlpha,W.blendDstAlpha,W.premultipliedAlpha),o.setFunc(W.depthFunc),o.setTest(W.depthTest),o.setMask(W.depthWrite),i.setMask(W.colorWrite);const ye=W.stencilWrite;s.setTest(ye),ye&&(s.setMask(W.stencilWriteMask),s.setFunc(W.stencilFunc,W.stencilRef,W.stencilFuncMask),s.setOp(W.stencilFail,W.stencilZFail,W.stencilZPass)),We(W.polygonOffset,W.polygonOffsetFactor,W.polygonOffsetUnits),W.alphaToCoverage===!0?Fe(32926):Y(32926)},setFlipSided:we,setCullFace:ke,setLineWidth:function(W){W!==F&&(Q&&r.lineWidth(W),F=W)},setPolygonOffset:We,setScissorTest:function(W){W?Fe(3089):Y(3089)},activeTexture:ge,bindTexture:function(W,de){q===null&&ge();let _e=oe[q];_e===void 0&&(_e={type:void 0,texture:void 0},oe[q]=_e),_e.type===W&&_e.texture===de||(r.bindTexture(W,de||Ue[W]),_e.type=W,_e.texture=de)},unbindTexture:function(){const W=oe[q];W!==void 0&&W.type!==void 0&&(r.bindTexture(W.type,null),W.type=void 0,W.texture=void 0)},compressedTexImage2D:function(){try{r.compressedTexImage2D.apply(r,arguments)}catch(W){console.error("THREE.WebGLState:",W)}},texImage2D:function(){try{r.texImage2D.apply(r,arguments)}catch(W){console.error("THREE.WebGLState:",W)}},texImage3D:function(){try{r.texImage3D.apply(r,arguments)}catch(W){console.error("THREE.WebGLState:",W)}},scissor:function(W){le.equals(W)===!1&&(r.scissor(W.x,W.y,W.z,W.w),le.copy(W))},viewport:function(W){pe.equals(W)===!1&&(r.viewport(W.x,W.y,W.z,W.w),pe.copy(W))},reset:function(){r.disable(3042),r.disable(2884),r.disable(2929),r.disable(32823),r.disable(3089),r.disable(2960),r.disable(32926),r.blendEquation(32774),r.blendFunc(1,0),r.blendFuncSeparate(1,0,1,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(513),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(519,0,4294967295),r.stencilOp(7680,7680,7680),r.clearStencil(0),r.cullFace(1029),r.frontFace(2305),r.polygonOffset(0,0),r.activeTexture(33984),r.bindFramebuffer(36160,null),n===!0&&(r.bindFramebuffer(36009,null),r.bindFramebuffer(36008,null)),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),a={},q=null,oe={},h=null,u={},c=null,d=!1,f=null,m=null,g=null,v=null,x=null,T=null,M=null,C=!1,D=null,R=null,F=null,O=null,U=null,le.set(0,0,r.canvas.width,r.canvas.height),pe.set(0,0,r.canvas.width,r.canvas.height),i.reset(),o.reset(),s.reset()}}}function fg(r,e,t,n,i,o,s){const a=i.isWebGL2,h=i.maxTextures,u=i.maxCubemapSize,c=i.maxTextureSize,d=i.maxSamples,f=new WeakMap;let m,g=!1;try{g=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(Y,$){return g?new OffscreenCanvas(Y,$):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function x(Y,$,Me,De){let we=1;if((Y.width>De||Y.height>De)&&(we=De/Math.max(Y.width,Y.height)),we<1||$===!0){if(typeof HTMLImageElement!="undefined"&&Y instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&Y instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&Y instanceof ImageBitmap){const ke=$?Nu:Math.floor,We=ke(we*Y.width),ge=ke(we*Y.height);m===void 0&&(m=v(We,ge));const W=Me?v(We,ge):m;return W.width=We,W.height=ge,W.getContext("2d").drawImage(Y,0,0,We,ge),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Y.width+"x"+Y.height+") to ("+We+"x"+ge+")."),W}return"data"in Y&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Y.width+"x"+Y.height+")."),Y}return Y}function T(Y){return sh(Y.width)&&sh(Y.height)}function M(Y,$){return Y.generateMipmaps&&$&&Y.minFilter!==Xn&&Y.minFilter!==Yn}function C(Y,$,Me,De,we=1){r.generateMipmap(Y),n.get($).__maxMipLevel=Math.log2(Math.max(Me,De,we))}function D(Y,$,Me){if(a===!1)return $;if(Y!==null){if(r[Y]!==void 0)return r[Y];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Y+"'")}let De=$;return $===6403&&(Me===5126&&(De=33326),Me===5131&&(De=33325),Me===5121&&(De=33321)),$===6407&&(Me===5126&&(De=34837),Me===5131&&(De=34843),Me===5121&&(De=32849)),$===6408&&(Me===5126&&(De=34836),Me===5131&&(De=34842),Me===5121&&(De=32856)),De!==33325&&De!==33326&&De!==34842&&De!==34836||e.get("EXT_color_buffer_float"),De}function R(Y){return Y===Xn||Y===Za||Y===$a?9728:9729}function F(Y){const $=Y.target;$.removeEventListener("dispose",F),function(Me){const De=n.get(Me);De.__webglInit!==void 0&&(r.deleteTexture(De.__webglTexture),n.remove(Me))}($),$.isVideoTexture&&f.delete($),s.memory.textures--}function O(Y){const $=Y.target;$.removeEventListener("dispose",O),function(Me){const De=Me.texture,we=n.get(Me),ke=n.get(De);if(!!Me){if(ke.__webglTexture!==void 0&&(r.deleteTexture(ke.__webglTexture),s.memory.textures--),Me.depthTexture&&Me.depthTexture.dispose(),Me.isWebGLCubeRenderTarget)for(let We=0;We<6;We++)r.deleteFramebuffer(we.__webglFramebuffer[We]),we.__webglDepthbuffer&&r.deleteRenderbuffer(we.__webglDepthbuffer[We]);else r.deleteFramebuffer(we.__webglFramebuffer),we.__webglDepthbuffer&&r.deleteRenderbuffer(we.__webglDepthbuffer),we.__webglMultisampledFramebuffer&&r.deleteFramebuffer(we.__webglMultisampledFramebuffer),we.__webglColorRenderbuffer&&r.deleteRenderbuffer(we.__webglColorRenderbuffer),we.__webglDepthRenderbuffer&&r.deleteRenderbuffer(we.__webglDepthRenderbuffer);if(Me.isWebGLMultipleRenderTargets)for(let We=0,ge=De.length;We<ge;We++){const W=n.get(De[We]);W.__webglTexture&&(r.deleteTexture(W.__webglTexture),s.memory.textures--),n.remove(De[We])}n.remove(De),n.remove(Me)}}($)}let U=0;function he(Y,$){const Me=n.get(Y);if(Y.isVideoTexture&&function(De){const we=s.render.frame;f.get(De)!==we&&(f.set(De,we),De.update())}(Y),Y.version>0&&Me.__version!==Y.version){const De=Y.image;if(De===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(De.complete!==!1)return void fe(Me,Y,$);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+$),t.bindTexture(3553,Me.__webglTexture)}function Q(Y,$){const Me=n.get(Y);Y.version>0&&Me.__version!==Y.version?function(De,we,ke){if(we.image.length!==6)return;oe(De,we),t.activeTexture(33984+ke),t.bindTexture(34067,De.__webglTexture),r.pixelStorei(37440,we.flipY),r.pixelStorei(37441,we.premultiplyAlpha),r.pixelStorei(3317,we.unpackAlignment),r.pixelStorei(37443,0);const We=we&&(we.isCompressedTexture||we.image[0].isCompressedTexture),ge=we.image[0]&&we.image[0].isDataTexture,W=[];for(let gt=0;gt<6;gt++)W[gt]=We||ge?ge?we.image[gt].image:we.image[gt]:x(we.image[gt],!1,!0,u);const de=W[0],_e=T(de)||a,ye=o.convert(we.format),Oe=o.convert(we.type),ht=D(we.internalFormat,ye,Oe);let _t;if(q(34067,we,_e),We){for(let gt=0;gt<6;gt++){_t=W[gt].mipmaps;for(let Ut=0;Ut<_t.length;Ut++){const Vt=_t[Ut];we.format!==$i&&we.format!==oo?ye!==null?t.compressedTexImage2D(34069+gt,Ut,ht,Vt.width,Vt.height,0,Vt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):t.texImage2D(34069+gt,Ut,ht,Vt.width,Vt.height,0,ye,Oe,Vt.data)}}De.__maxMipLevel=_t.length-1}else{_t=we.mipmaps;for(let gt=0;gt<6;gt++)if(ge){t.texImage2D(34069+gt,0,ht,W[gt].width,W[gt].height,0,ye,Oe,W[gt].data);for(let Ut=0;Ut<_t.length;Ut++){const Vt=_t[Ut].image[gt].image;t.texImage2D(34069+gt,Ut+1,ht,Vt.width,Vt.height,0,ye,Oe,Vt.data)}}else{t.texImage2D(34069+gt,0,ht,ye,Oe,W[gt]);for(let Ut=0;Ut<_t.length;Ut++){const Vt=_t[Ut];t.texImage2D(34069+gt,Ut+1,ht,ye,Oe,Vt.image[gt])}}De.__maxMipLevel=_t.length}M(we,_e)&&C(34067,we,de.width,de.height),De.__version=we.version,we.onUpdate&&we.onUpdate(we)}(Me,Y,$):(t.activeTexture(33984+$),t.bindTexture(34067,Me.__webglTexture))}const X={[Oo]:10497,[di]:33071,[qa]:33648},Z={[Xn]:9728,[Za]:9984,[$a]:9986,[Yn]:9729,[Do]:9985,[fs]:9987};function q(Y,$,Me){if(Me?(r.texParameteri(Y,10242,X[$.wrapS]),r.texParameteri(Y,10243,X[$.wrapT]),Y!==32879&&Y!==35866||r.texParameteri(Y,32882,X[$.wrapR]),r.texParameteri(Y,10240,Z[$.magFilter]),r.texParameteri(Y,10241,Z[$.minFilter])):(r.texParameteri(Y,10242,33071),r.texParameteri(Y,10243,33071),Y!==32879&&Y!==35866||r.texParameteri(Y,32882,33071),$.wrapS===di&&$.wrapT===di||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),r.texParameteri(Y,10240,R($.magFilter)),r.texParameteri(Y,10241,R($.minFilter)),$.minFilter!==Xn&&$.minFilter!==Yn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const De=e.get("EXT_texture_filter_anisotropic");if($.type===ro&&e.has("OES_texture_float_linear")===!1||a===!1&&$.type===gs&&e.has("OES_texture_half_float_linear")===!1)return;($.anisotropy>1||n.get($).__currentAnisotropy)&&(r.texParameterf(Y,De.TEXTURE_MAX_ANISOTROPY_EXT,Math.min($.anisotropy,i.getMaxAnisotropy())),n.get($).__currentAnisotropy=$.anisotropy)}}function oe(Y,$){Y.__webglInit===void 0&&(Y.__webglInit=!0,$.addEventListener("dispose",F),Y.__webglTexture=r.createTexture(),s.memory.textures++)}function fe(Y,$,Me){let De=3553;$.isDataTexture2DArray&&(De=35866),$.isDataTexture3D&&(De=32879),oe(Y,$),t.activeTexture(33984+Me),t.bindTexture(De,Y.__webglTexture),r.pixelStorei(37440,$.flipY),r.pixelStorei(37441,$.premultiplyAlpha),r.pixelStorei(3317,$.unpackAlignment),r.pixelStorei(37443,0);const we=function(Oe){return!a&&(Oe.wrapS!==di||Oe.wrapT!==di||Oe.minFilter!==Xn&&Oe.minFilter!==Yn)}($)&&T($.image)===!1,ke=x($.image,we,!1,c),We=T(ke)||a,ge=o.convert($.format);let W,de=o.convert($.type),_e=D($.internalFormat,ge,de);q(De,$,We);const ye=$.mipmaps;if($.isDepthTexture)_e=6402,a?_e=$.type===ro?36012:$.type===ms?33190:$.type===ln?35056:33189:$.type===ro&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),$.format===Ln&&_e===6402&&$.type!==Ja&&$.type!==ms&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),$.type=Ja,de=o.convert($.type)),$.format===vs&&_e===6402&&(_e=34041,$.type!==ln&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),$.type=ln,de=o.convert($.type))),t.texImage2D(3553,0,_e,ke.width,ke.height,0,ge,de,null);else if($.isDataTexture)if(ye.length>0&&We){for(let Oe=0,ht=ye.length;Oe<ht;Oe++)W=ye[Oe],t.texImage2D(3553,Oe,_e,W.width,W.height,0,ge,de,W.data);$.generateMipmaps=!1,Y.__maxMipLevel=ye.length-1}else t.texImage2D(3553,0,_e,ke.width,ke.height,0,ge,de,ke.data),Y.__maxMipLevel=0;else if($.isCompressedTexture){for(let Oe=0,ht=ye.length;Oe<ht;Oe++)W=ye[Oe],$.format!==$i&&$.format!==oo?ge!==null?t.compressedTexImage2D(3553,Oe,_e,W.width,W.height,0,W.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(3553,Oe,_e,W.width,W.height,0,ge,de,W.data);Y.__maxMipLevel=ye.length-1}else if($.isDataTexture2DArray)t.texImage3D(35866,0,_e,ke.width,ke.height,ke.depth,0,ge,de,ke.data),Y.__maxMipLevel=0;else if($.isDataTexture3D)t.texImage3D(32879,0,_e,ke.width,ke.height,ke.depth,0,ge,de,ke.data),Y.__maxMipLevel=0;else if(ye.length>0&&We){for(let Oe=0,ht=ye.length;Oe<ht;Oe++)W=ye[Oe],t.texImage2D(3553,Oe,_e,ge,de,W);$.generateMipmaps=!1,Y.__maxMipLevel=ye.length-1}else t.texImage2D(3553,0,_e,ge,de,ke),Y.__maxMipLevel=0;M($,We)&&C(De,$,ke.width,ke.height),Y.__version=$.version,$.onUpdate&&$.onUpdate($)}function me(Y,$,Me,De,we){const ke=o.convert(Me.format),We=o.convert(Me.type),ge=D(Me.internalFormat,ke,We);we===32879||we===35866?t.texImage3D(we,0,ge,$.width,$.height,$.depth,0,ke,We,null):t.texImage2D(we,0,ge,$.width,$.height,0,ke,We,null),t.bindFramebuffer(36160,Y),r.framebufferTexture2D(36160,De,we,n.get(Me).__webglTexture,0),t.bindFramebuffer(36160,null)}function le(Y,$,Me){if(r.bindRenderbuffer(36161,Y),$.depthBuffer&&!$.stencilBuffer){let De=33189;if(Me){const we=$.depthTexture;we&&we.isDepthTexture&&(we.type===ro?De=36012:we.type===ms&&(De=33190));const ke=Pe($);r.renderbufferStorageMultisample(36161,ke,De,$.width,$.height)}else r.renderbufferStorage(36161,De,$.width,$.height);r.framebufferRenderbuffer(36160,36096,36161,Y)}else if($.depthBuffer&&$.stencilBuffer){if(Me){const De=Pe($);r.renderbufferStorageMultisample(36161,De,35056,$.width,$.height)}else r.renderbufferStorage(36161,34041,$.width,$.height);r.framebufferRenderbuffer(36160,33306,36161,Y)}else{const De=$.isWebGLMultipleRenderTargets===!0?$.texture[0]:$.texture,we=o.convert(De.format),ke=o.convert(De.type),We=D(De.internalFormat,we,ke);if(Me){const ge=Pe($);r.renderbufferStorageMultisample(36161,ge,We,$.width,$.height)}else r.renderbufferStorage(36161,We,$.width,$.height)}r.bindRenderbuffer(36161,null)}function pe(Y){const $=n.get(Y),Me=Y.isWebGLCubeRenderTarget===!0;if(Y.depthTexture){if(Me)throw new Error("target.depthTexture not supported in Cube render targets");(function(De,we){if(we&&we.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,De),!we.depthTexture||!we.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(we.depthTexture).__webglTexture&&we.depthTexture.image.width===we.width&&we.depthTexture.image.height===we.height||(we.depthTexture.image.width=we.width,we.depthTexture.image.height=we.height,we.depthTexture.needsUpdate=!0),he(we.depthTexture,0);const ke=n.get(we.depthTexture).__webglTexture;if(we.depthTexture.format===Ln)r.framebufferTexture2D(36160,36096,3553,ke,0);else{if(we.depthTexture.format!==vs)throw new Error("Unknown depthTexture format");r.framebufferTexture2D(36160,33306,3553,ke,0)}})($.__webglFramebuffer,Y)}else if(Me){$.__webglDepthbuffer=[];for(let De=0;De<6;De++)t.bindFramebuffer(36160,$.__webglFramebuffer[De]),$.__webglDepthbuffer[De]=r.createRenderbuffer(),le($.__webglDepthbuffer[De],Y,!1)}else t.bindFramebuffer(36160,$.__webglFramebuffer),$.__webglDepthbuffer=r.createRenderbuffer(),le($.__webglDepthbuffer,Y,!1);t.bindFramebuffer(36160,null)}function Pe(Y){return a&&Y.isWebGLMultisampleRenderTarget?Math.min(d,Y.samples):0}let Ue=!1,Fe=!1;this.allocateTextureUnit=function(){const Y=U;return Y>=h&&console.warn("THREE.WebGLTextures: Trying to use "+Y+" texture units while this GPU supports only "+h),U+=1,Y},this.resetTextureUnits=function(){U=0},this.setTexture2D=he,this.setTexture2DArray=function(Y,$){const Me=n.get(Y);Y.version>0&&Me.__version!==Y.version?fe(Me,Y,$):(t.activeTexture(33984+$),t.bindTexture(35866,Me.__webglTexture))},this.setTexture3D=function(Y,$){const Me=n.get(Y);Y.version>0&&Me.__version!==Y.version?fe(Me,Y,$):(t.activeTexture(33984+$),t.bindTexture(32879,Me.__webglTexture))},this.setTextureCube=Q,this.setupRenderTarget=function(Y){const $=Y.texture,Me=n.get(Y),De=n.get($);Y.addEventListener("dispose",O),Y.isWebGLMultipleRenderTargets!==!0&&(De.__webglTexture=r.createTexture(),De.__version=$.version,s.memory.textures++);const we=Y.isWebGLCubeRenderTarget===!0,ke=Y.isWebGLMultipleRenderTargets===!0,We=Y.isWebGLMultisampleRenderTarget===!0,ge=$.isDataTexture3D||$.isDataTexture2DArray,W=T(Y)||a;if(!a||$.format!==oo||$.type!==ro&&$.type!==gs||($.format=$i,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),we){Me.__webglFramebuffer=[];for(let de=0;de<6;de++)Me.__webglFramebuffer[de]=r.createFramebuffer()}else if(Me.__webglFramebuffer=r.createFramebuffer(),ke)if(i.drawBuffers){const de=Y.texture;for(let _e=0,ye=de.length;_e<ye;_e++){const Oe=n.get(de[_e]);Oe.__webglTexture===void 0&&(Oe.__webglTexture=r.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(We)if(a){Me.__webglMultisampledFramebuffer=r.createFramebuffer(),Me.__webglColorRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(36161,Me.__webglColorRenderbuffer);const de=o.convert($.format),_e=o.convert($.type),ye=D($.internalFormat,de,_e),Oe=Pe(Y);r.renderbufferStorageMultisample(36161,Oe,ye,Y.width,Y.height),t.bindFramebuffer(36160,Me.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064,36161,Me.__webglColorRenderbuffer),r.bindRenderbuffer(36161,null),Y.depthBuffer&&(Me.__webglDepthRenderbuffer=r.createRenderbuffer(),le(Me.__webglDepthRenderbuffer,Y,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(we){t.bindTexture(34067,De.__webglTexture),q(34067,$,W);for(let de=0;de<6;de++)me(Me.__webglFramebuffer[de],Y,$,36064,34069+de);M($,W)&&C(34067,$,Y.width,Y.height),t.bindTexture(34067,null)}else if(ke){const de=Y.texture;for(let _e=0,ye=de.length;_e<ye;_e++){const Oe=de[_e],ht=n.get(Oe);t.bindTexture(3553,ht.__webglTexture),q(3553,Oe,W),me(Me.__webglFramebuffer,Y,Oe,36064+_e,3553),M(Oe,W)&&C(3553,Oe,Y.width,Y.height)}t.bindTexture(3553,null)}else{let de=3553;ge&&(a?de=$.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(de,De.__webglTexture),q(de,$,W),me(Me.__webglFramebuffer,Y,$,36064,de),M($,W)&&C(de,$,Y.width,Y.height,Y.depth),t.bindTexture(de,null)}Y.depthBuffer&&pe(Y)},this.updateRenderTargetMipmap=function(Y){const $=T(Y)||a,Me=Y.isWebGLMultipleRenderTargets===!0?Y.texture:[Y.texture];for(let De=0,we=Me.length;De<we;De++){const ke=Me[De];if(M(ke,$)){const We=Y.isWebGLCubeRenderTarget?34067:3553,ge=n.get(ke).__webglTexture;t.bindTexture(We,ge),C(We,ke,Y.width,Y.height),t.bindTexture(We,null)}}},this.updateMultisampleRenderTarget=function(Y){if(Y.isWebGLMultisampleRenderTarget)if(a){const $=Y.width,Me=Y.height;let De=16384;Y.depthBuffer&&(De|=256),Y.stencilBuffer&&(De|=1024);const we=n.get(Y);t.bindFramebuffer(36008,we.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,we.__webglFramebuffer),r.blitFramebuffer(0,0,$,Me,0,0,$,Me,De,9728),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,we.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Y,$){Y&&Y.isWebGLRenderTarget&&(Ue===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Ue=!0),Y=Y.texture),he(Y,$)},this.safeSetTextureCube=function(Y,$){Y&&Y.isWebGLCubeRenderTarget&&(Fe===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Fe=!0),Y=Y.texture),Q(Y,$)}}function hf(r,e,t){const n=t.isWebGL2;return{convert:function(i){let o;if(i===No)return 5121;if(i===hp)return 32819;if(i===up)return 32820;if(i===lp)return 33635;if(i===op)return 5120;if(i===sp)return 5122;if(i===Ja)return 5123;if(i===ap)return 5124;if(i===ms)return 5125;if(i===ro)return 5126;if(i===gs)return n?5131:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(i===gn)return 6406;if(i===oo)return 6407;if(i===$i)return 6408;if(i===cp)return 6409;if(i===ql)return 6410;if(i===Ln)return 6402;if(i===vs)return 34041;if(i===sa)return 6403;if(i===Zl)return 36244;if(i===cu)return 33319;if(i===Ji)return 33320;if(i===$l)return 36248;if(i===Jl)return 36249;if(i===du||i===pu||i===fu||i===mu){if(o=e.get("WEBGL_compressed_texture_s3tc"),o===null)return null;if(i===du)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===pu)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===fu)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===mu)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(i===Oi||i===Kl||i===Gi||i===Ql){if(o=e.get("WEBGL_compressed_texture_pvrtc"),o===null)return null;if(i===Oi)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Kl)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===Gi)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===Ql)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===ec)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if((i===kr||i===aa)&&(o=e.get("WEBGL_compressed_texture_etc"),o!==null)){if(i===kr)return o.COMPRESSED_RGB8_ETC2;if(i===aa)return o.COMPRESSED_RGBA8_ETC2_EAC}return i===gu||i===bn||i===so||i===vu||i===pp||i===_u||i===fp||i===tc||i===Ka||i===_s||i===mp||i===nc||i===ic||i===yu||i===rc||i===bu||i===wu||i===oc||i===Hi||i===Tu||i===ha||i===sc||i===ac||i===gp||i===vp||i===_p||i===yp||i===ys?(o=e.get("WEBGL_compressed_texture_astc"),o!==null?i:null):i===xu?(o=e.get("EXT_texture_compression_bptc"),o!==null?i:null):i===ln?n?34042:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class Xc extends $n{constructor(e=[]){super(),this.cameras=e}}Xc.prototype.isArrayCamera=!0;class Us extends jt{constructor(){super(),this.type="Group"}}Us.prototype.isGroup=!0;const Yc={type:"move"};class bh{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Us,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Us,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new w,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new w),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Us,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new w,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new w),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,o=null,s=null;const a=this._targetRay,h=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(a!==null&&(i=t.getPose(e.targetRaySpace,n),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Yc))),u&&e.hand){s=!0;for(const v of e.hand.values()){const x=t.getJointPose(v,n);if(u.joints[v.jointName]===void 0){const M=new Us;M.matrixAutoUpdate=!1,M.visible=!1,u.joints[v.jointName]=M,u.add(M)}const T=u.joints[v.jointName];x!==null&&(T.matrix.fromArray(x.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.jointRadius=x.radius),T.visible=x!==null}const c=u.joints["index-finger-tip"],d=u.joints["thumb-tip"],f=c.position.distanceTo(d.position),m=.02,g=.005;u.inputState.pinching&&f>m+g?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&f<=m-g&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,n),o!==null&&(h.matrix.fromArray(o.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),o.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(o.linearVelocity)):h.hasLinearVelocity=!1,o.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(o.angularVelocity)):h.hasAngularVelocity=!1));return a!==null&&(a.visible=i!==null),h!==null&&(h.visible=o!==null),u!==null&&(u.visible=s!==null),this}}class mg extends uo{constructor(e,t){super();const n=this,i=e.state;let o=null,s=1,a=null,h="local-floor",u=null,c=null,d=null,f=null;const m=[],g=new Map,v=new $n;v.layers.enable(1),v.viewport=new cn;const x=new $n;x.layers.enable(2),x.viewport=new cn;const T=[v,x],M=new Xc;M.layers.enable(1),M.layers.enable(2);let C=null,D=null;function R(q){const oe=g.get(q.inputSource);oe&&oe.dispatchEvent({type:q.type,data:q.inputSource})}function F(){g.forEach(function(q,oe){q.disconnect(oe)}),g.clear(),C=null,D=null,i.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),Z.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function O(q){const oe=o.inputSources;for(let fe=0;fe<m.length;fe++)g.set(oe[fe],m[fe]);for(let fe=0;fe<q.removed.length;fe++){const me=q.removed[fe],le=g.get(me);le&&(le.dispatchEvent({type:"disconnected",data:me}),g.delete(me))}for(let fe=0;fe<q.added.length;fe++){const me=q.added[fe],le=g.get(me);le&&le.dispatchEvent({type:"connected",data:me})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let oe=m[q];return oe===void 0&&(oe=new bh,m[q]=oe),oe.getTargetRaySpace()},this.getControllerGrip=function(q){let oe=m[q];return oe===void 0&&(oe=new bh,m[q]=oe),oe.getGripSpace()},this.getHand=function(q){let oe=m[q];return oe===void 0&&(oe=new bh,m[q]=oe),oe.getHandSpace()},this.setFramebufferScaleFactor=function(q){s=q,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){h=q,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return o},this.setSession=async function(q){if(o=q,o!==null){o.addEventListener("select",R),o.addEventListener("selectstart",R),o.addEventListener("selectend",R),o.addEventListener("squeeze",R),o.addEventListener("squeezestart",R),o.addEventListener("squeezeend",R),o.addEventListener("end",F),o.addEventListener("inputsourceschange",O);const oe=t.getContextAttributes();if(oe.xrCompatible!==!0&&await t.makeXRCompatible(),o.renderState.layers===void 0){const fe={antialias:oe.antialias,alpha:oe.alpha,depth:oe.depth,stencil:oe.stencil,framebufferScaleFactor:s},me=new XRWebGLLayer(o,t,fe);o.updateRenderState({baseLayer:me})}else{let fe=0;oe.depth&&(fe=oe.stencil?34041:6402);const me={colorFormat:oe.alpha?6408:6407,depthFormat:fe,scaleFactor:s};c=new XRWebGLBinding(o,t),f=c.createProjectionLayer(me),d=t.createFramebuffer(),o.updateRenderState({layers:[f]})}a=await o.requestReferenceSpace(h),Z.setContext(o),Z.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const U=new w,he=new w;function Q(q,oe){oe===null?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(oe.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(o===null)return;M.near=x.near=v.near=q.near,M.far=x.far=v.far=q.far,C===M.near&&D===M.far||(o.updateRenderState({depthNear:M.near,depthFar:M.far}),C=M.near,D=M.far);const oe=q.parent,fe=M.cameras;Q(M,oe);for(let le=0;le<fe.length;le++)Q(fe[le],oe);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),q.position.copy(M.position),q.quaternion.copy(M.quaternion),q.scale.copy(M.scale),q.matrix.copy(M.matrix),q.matrixWorld.copy(M.matrixWorld);const me=q.children;for(let le=0,pe=me.length;le<pe;le++)me[le].updateMatrixWorld(!0);fe.length===2?function(le,pe,Pe){U.setFromMatrixPosition(pe.matrixWorld),he.setFromMatrixPosition(Pe.matrixWorld);const Ue=U.distanceTo(he),Fe=pe.projectionMatrix.elements,Y=Pe.projectionMatrix.elements,$=Fe[14]/(Fe[10]-1),Me=Fe[14]/(Fe[10]+1),De=(Fe[9]+1)/Fe[5],we=(Fe[9]-1)/Fe[5],ke=(Fe[8]-1)/Fe[0],We=(Y[8]+1)/Y[0],ge=$*ke,W=$*We,de=Ue/(-ke+We),_e=de*-ke;pe.matrixWorld.decompose(le.position,le.quaternion,le.scale),le.translateX(_e),le.translateZ(de),le.matrixWorld.compose(le.position,le.quaternion,le.scale),le.matrixWorldInverse.copy(le.matrixWorld).invert();const ye=$+de,Oe=Me+de,ht=ge-_e,_t=W+(Ue-_e),gt=De*Me/Oe*ye,Ut=we*Me/Oe*ye;le.projectionMatrix.makePerspective(ht,_t,gt,Ut,ye,Oe)}(M,v,x):M.projectionMatrix.copy(v.projectionMatrix)},this.getCamera=function(){return M};let X=null;const Z=new Ic;Z.setAnimationLoop(function(q,oe){if(u=oe.getViewerPose(a),u!==null){const me=u.views,le=o.renderState.baseLayer;o.renderState.layers===void 0&&i.bindXRFramebuffer(le.framebuffer);let pe=!1;me.length!==M.cameras.length&&(M.cameras.length=0,pe=!0);for(let Pe=0;Pe<me.length;Pe++){const Ue=me[Pe];let Fe=null;if(o.renderState.layers===void 0)Fe=le.getViewport(Ue);else{const $=c.getViewSubImage(f,Ue);i.bindXRFramebuffer(d),t.framebufferTexture2D(36160,36064,3553,$.colorTexture,0),$.depthStencilTexture!==void 0&&t.framebufferTexture2D(36160,36096,3553,$.depthStencilTexture,0),Fe=$.viewport}const Y=T[Pe];Y.matrix.fromArray(Ue.transform.matrix),Y.projectionMatrix.fromArray(Ue.projectionMatrix),Y.viewport.set(Fe.x,Fe.y,Fe.width,Fe.height),Pe===0&&M.matrix.copy(Y.matrix),pe===!0&&M.cameras.push(Y)}}const fe=o.inputSources;for(let me=0;me<m.length;me++){const le=m[me],pe=fe[me];le.update(pe,oe,a)}X&&X(q,oe)}),this.setAnimationLoop=function(q){X=q},this.dispose=function(){}}}function gg(r){function e(n,i){n.opacity.value=i.opacity,i.color&&n.diffuse.value.copy(i.color),i.emissive&&n.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(n.map.value=i.map),i.alphaMap&&(n.alphaMap.value=i.alphaMap),i.specularMap&&(n.specularMap.value=i.specularMap);const o=r.get(i).envMap;if(o){n.envMap.value=o,n.flipEnvMap.value=o.isCubeTexture&&o._needsFlipEnvMap?-1:1,n.reflectivity.value=i.reflectivity,n.refractionRatio.value=i.refractionRatio;const h=r.get(o).__maxMipLevel;h!==void 0&&(n.maxMipLevel.value=h)}let s,a;i.lightMap&&(n.lightMap.value=i.lightMap,n.lightMapIntensity.value=i.lightMapIntensity),i.aoMap&&(n.aoMap.value=i.aoMap,n.aoMapIntensity.value=i.aoMapIntensity),i.map?s=i.map:i.specularMap?s=i.specularMap:i.displacementMap?s=i.displacementMap:i.normalMap?s=i.normalMap:i.bumpMap?s=i.bumpMap:i.roughnessMap?s=i.roughnessMap:i.metalnessMap?s=i.metalnessMap:i.alphaMap?s=i.alphaMap:i.emissiveMap?s=i.emissiveMap:i.clearcoatMap?s=i.clearcoatMap:i.clearcoatNormalMap?s=i.clearcoatNormalMap:i.clearcoatRoughnessMap&&(s=i.clearcoatRoughnessMap),s!==void 0&&(s.isWebGLRenderTarget&&(s=s.texture),s.matrixAutoUpdate===!0&&s.updateMatrix(),n.uvTransform.value.copy(s.matrix)),i.aoMap?a=i.aoMap:i.lightMap&&(a=i.lightMap),a!==void 0&&(a.isWebGLRenderTarget&&(a=a.texture),a.matrixAutoUpdate===!0&&a.updateMatrix(),n.uv2Transform.value.copy(a.matrix))}function t(n,i){n.roughness.value=i.roughness,n.metalness.value=i.metalness,i.roughnessMap&&(n.roughnessMap.value=i.roughnessMap),i.metalnessMap&&(n.metalnessMap.value=i.metalnessMap),i.emissiveMap&&(n.emissiveMap.value=i.emissiveMap),i.bumpMap&&(n.bumpMap.value=i.bumpMap,n.bumpScale.value=i.bumpScale,i.side===j&&(n.bumpScale.value*=-1)),i.normalMap&&(n.normalMap.value=i.normalMap,n.normalScale.value.copy(i.normalScale),i.side===j&&n.normalScale.value.negate()),i.displacementMap&&(n.displacementMap.value=i.displacementMap,n.displacementScale.value=i.displacementScale,n.displacementBias.value=i.displacementBias),r.get(i).envMap&&(n.envMapIntensity.value=i.envMapIntensity)}return{refreshFogUniforms:function(n,i){n.fogColor.value.copy(i.color),i.isFog?(n.fogNear.value=i.near,n.fogFar.value=i.far):i.isFogExp2&&(n.fogDensity.value=i.density)},refreshMaterialUniforms:function(n,i,o,s,a){i.isMeshBasicMaterial?e(n,i):i.isMeshLambertMaterial?(e(n,i),function(h,u){u.emissiveMap&&(h.emissiveMap.value=u.emissiveMap)}(n,i)):i.isMeshToonMaterial?(e(n,i),function(h,u){u.gradientMap&&(h.gradientMap.value=u.gradientMap),u.emissiveMap&&(h.emissiveMap.value=u.emissiveMap),u.bumpMap&&(h.bumpMap.value=u.bumpMap,h.bumpScale.value=u.bumpScale,u.side===j&&(h.bumpScale.value*=-1)),u.normalMap&&(h.normalMap.value=u.normalMap,h.normalScale.value.copy(u.normalScale),u.side===j&&h.normalScale.value.negate()),u.displacementMap&&(h.displacementMap.value=u.displacementMap,h.displacementScale.value=u.displacementScale,h.displacementBias.value=u.displacementBias)}(n,i)):i.isMeshPhongMaterial?(e(n,i),function(h,u){h.specular.value.copy(u.specular),h.shininess.value=Math.max(u.shininess,1e-4),u.emissiveMap&&(h.emissiveMap.value=u.emissiveMap),u.bumpMap&&(h.bumpMap.value=u.bumpMap,h.bumpScale.value=u.bumpScale,u.side===j&&(h.bumpScale.value*=-1)),u.normalMap&&(h.normalMap.value=u.normalMap,h.normalScale.value.copy(u.normalScale),u.side===j&&h.normalScale.value.negate()),u.displacementMap&&(h.displacementMap.value=u.displacementMap,h.displacementScale.value=u.displacementScale,h.displacementBias.value=u.displacementBias)}(n,i)):i.isMeshStandardMaterial?(e(n,i),i.isMeshPhysicalMaterial?function(h,u,c){t(h,u),h.reflectivity.value=u.reflectivity,h.clearcoat.value=u.clearcoat,h.clearcoatRoughness.value=u.clearcoatRoughness,u.sheen&&h.sheen.value.copy(u.sheen),u.clearcoatMap&&(h.clearcoatMap.value=u.clearcoatMap),u.clearcoatRoughnessMap&&(h.clearcoatRoughnessMap.value=u.clearcoatRoughnessMap),u.clearcoatNormalMap&&(h.clearcoatNormalScale.value.copy(u.clearcoatNormalScale),h.clearcoatNormalMap.value=u.clearcoatNormalMap,u.side===j&&h.clearcoatNormalScale.value.negate()),h.transmission.value=u.transmission,u.transmissionMap&&(h.transmissionMap.value=u.transmissionMap),u.transmission>0&&(h.transmissionSamplerMap.value=c.texture,h.transmissionSamplerSize.value.set(c.width,c.height)),h.thickness.value=u.thickness,u.thicknessMap&&(h.thicknessMap.value=u.thicknessMap),h.attenuationDistance.value=u.attenuationDistance,h.attenuationColor.value.copy(u.attenuationColor)}(n,i,a):t(n,i)):i.isMeshMatcapMaterial?(e(n,i),function(h,u){u.matcap&&(h.matcap.value=u.matcap),u.bumpMap&&(h.bumpMap.value=u.bumpMap,h.bumpScale.value=u.bumpScale,u.side===j&&(h.bumpScale.value*=-1)),u.normalMap&&(h.normalMap.value=u.normalMap,h.normalScale.value.copy(u.normalScale),u.side===j&&h.normalScale.value.negate()),u.displacementMap&&(h.displacementMap.value=u.displacementMap,h.displacementScale.value=u.displacementScale,h.displacementBias.value=u.displacementBias)}(n,i)):i.isMeshDepthMaterial?(e(n,i),function(h,u){u.displacementMap&&(h.displacementMap.value=u.displacementMap,h.displacementScale.value=u.displacementScale,h.displacementBias.value=u.displacementBias)}(n,i)):i.isMeshDistanceMaterial?(e(n,i),function(h,u){u.displacementMap&&(h.displacementMap.value=u.displacementMap,h.displacementScale.value=u.displacementScale,h.displacementBias.value=u.displacementBias),h.referencePosition.value.copy(u.referencePosition),h.nearDistance.value=u.nearDistance,h.farDistance.value=u.farDistance}(n,i)):i.isMeshNormalMaterial?(e(n,i),function(h,u){u.bumpMap&&(h.bumpMap.value=u.bumpMap,h.bumpScale.value=u.bumpScale,u.side===j&&(h.bumpScale.value*=-1)),u.normalMap&&(h.normalMap.value=u.normalMap,h.normalScale.value.copy(u.normalScale),u.side===j&&h.normalScale.value.negate()),u.displacementMap&&(h.displacementMap.value=u.displacementMap,h.displacementScale.value=u.displacementScale,h.displacementBias.value=u.displacementBias)}(n,i)):i.isLineBasicMaterial?(function(h,u){h.diffuse.value.copy(u.color),h.opacity.value=u.opacity}(n,i),i.isLineDashedMaterial&&function(h,u){h.dashSize.value=u.dashSize,h.totalSize.value=u.dashSize+u.gapSize,h.scale.value=u.scale}(n,i)):i.isPointsMaterial?function(h,u,c,d){h.diffuse.value.copy(u.color),h.opacity.value=u.opacity,h.size.value=u.size*c,h.scale.value=.5*d,u.map&&(h.map.value=u.map),u.alphaMap&&(h.alphaMap.value=u.alphaMap);let f;u.map?f=u.map:u.alphaMap&&(f=u.alphaMap),f!==void 0&&(f.matrixAutoUpdate===!0&&f.updateMatrix(),h.uvTransform.value.copy(f.matrix))}(n,i,o,s):i.isSpriteMaterial?function(h,u){h.diffuse.value.copy(u.color),h.opacity.value=u.opacity,h.rotation.value=u.rotation,u.map&&(h.map.value=u.map),u.alphaMap&&(h.alphaMap.value=u.alphaMap);let c;u.map?c=u.map:u.alphaMap&&(c=u.alphaMap),c!==void 0&&(c.matrixAutoUpdate===!0&&c.updateMatrix(),h.uvTransform.value.copy(c.matrix))}(n,i):i.isShadowMaterial?(n.color.value.copy(i.color),n.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function dn(r={}){const e=r.canvas!==void 0?r.canvas:function(){const ae=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return ae.style.display="block",ae}(),t=r.context!==void 0?r.context:null,n=r.alpha!==void 0&&r.alpha,i=r.depth===void 0||r.depth,o=r.stencil===void 0||r.stencil,s=r.antialias!==void 0&&r.antialias,a=r.premultipliedAlpha===void 0||r.premultipliedAlpha,h=r.preserveDrawingBuffer!==void 0&&r.preserveDrawingBuffer,u=r.powerPreference!==void 0?r.powerPreference:"default",c=r.failIfMajorPerformanceCaveat!==void 0&&r.failIfMajorPerformanceCaveat;let d=null,f=null;const m=[],g=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=xt,this.physicallyCorrectLights=!1,this.toneMapping=io,this.toneMappingExposure=1;const v=this;let x=!1,T=0,M=0,C=null,D=-1,R=null;const F=new cn,O=new cn;let U=null,he=e.width,Q=e.height,X=1,Z=null,q=null;const oe=new cn(0,0,he,Q),fe=new cn(0,0,he,Q);let me=!1;const le=[],pe=new Sa;let Pe=!1,Ue=!1,Fe=null;const Y=new ct,$=new w,Me={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function De(){return C===null?X:1}let we,ke,We,ge,W,de,_e,ye,Oe,ht,_t,gt,Ut,Vt,ii,An,Ro,Wd,Xd,Yd,hr,Er,et=t;function qb(ae,ze){for(let Ce=0;Ce<ae.length;Ce++){const je=ae[Ce],it=e.getContext(je,ze);if(it!==null)return it}return null}try{const ae={alpha:n,depth:i,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:h,powerPreference:u,failIfMajorPerformanceCaveat:c};if(e.addEventListener("webglcontextlost",$b,!1),e.addEventListener("webglcontextrestored",Jb,!1),et===null){const ze=["webgl2","webgl","experimental-webgl"];if(v.isWebGL1Renderer===!0&&ze.shift(),et=qb(ze,ae),et===null)throw qb(ze)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}et.getShaderPrecisionFormat===void 0&&(et.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ae){throw console.error("THREE.WebGLRenderer: "+ae.message),ae}function Zb(){we=new Hm(et),ke=new Op(et,we,r),we.init(ke),hr=new hf(et,we,ke),We=new rl(et,we,ke),le[0]=1029,ge=new _h(et),W=new nl,de=new fg(et,we,We,W,ke,hr,ge),_e=new Np(v),ye=new km(et,ke),Er=new vh(et,we,ye,ke),Oe=new Lc(et,ye,ge,Er),ht=new Zu(et,Oe,ye,ge),Wd=new Up(et),ii=new Dp(W),_t=new nf(v,_e,we,ke,Er,ii),gt=new gg(W),Ut=new pg(W),Vt=new af(we,ke),Ro=new Gm(v,_e,We,ht,a),An=new Wc(v,ht,ke),Xd=new Lp(et,we,ge,ke),Yd=new Fp(et,we,ge,ke),ge.programs=_t.programs,v.capabilities=ke,v.extensions=we,v.properties=W,v.renderLists=Ut,v.shadowMap=An,v.state=We,v.info=ge}Zb();const Br=new mg(v,et);function $b(ae){ae.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function Jb(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;const ae=ge.autoReset,ze=An.enabled,Ce=An.autoUpdate,je=An.needsUpdate,it=An.type;Zb(),ge.autoReset=ae,An.enabled=ze,An.autoUpdate=Ce,An.needsUpdate=je,An.type=it}function Kb(ae){const ze=ae.target;ze.removeEventListener("dispose",Kb),function(Ce){(function(je){const it=W.get(je).programs;it!==void 0&&it.forEach(function(hn){_t.releaseProgram(hn)})})(Ce),W.remove(Ce)}(ze)}this.xr=Br,this.getContext=function(){return et},this.getContextAttributes=function(){return et.getContextAttributes()},this.forceContextLoss=function(){const ae=we.get("WEBGL_lose_context");ae&&ae.loseContext()},this.forceContextRestore=function(){const ae=we.get("WEBGL_lose_context");ae&&ae.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(ae){ae!==void 0&&(X=ae,this.setSize(he,Q,!1))},this.getSize=function(ae){return ae.set(he,Q)},this.setSize=function(ae,ze,Ce){Br.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(he=ae,Q=ze,e.width=Math.floor(ae*X),e.height=Math.floor(ze*X),Ce!==!1&&(e.style.width=ae+"px",e.style.height=ze+"px"),this.setViewport(0,0,ae,ze))},this.getDrawingBufferSize=function(ae){return ae.set(he*X,Q*X).floor()},this.setDrawingBufferSize=function(ae,ze,Ce){he=ae,Q=ze,X=Ce,e.width=Math.floor(ae*Ce),e.height=Math.floor(ze*Ce),this.setViewport(0,0,ae,ze)},this.getCurrentViewport=function(ae){return ae.copy(F)},this.getViewport=function(ae){return ae.copy(oe)},this.setViewport=function(ae,ze,Ce,je){ae.isVector4?oe.set(ae.x,ae.y,ae.z,ae.w):oe.set(ae,ze,Ce,je),We.viewport(F.copy(oe).multiplyScalar(X).floor())},this.getScissor=function(ae){return ae.copy(fe)},this.setScissor=function(ae,ze,Ce,je){ae.isVector4?fe.set(ae.x,ae.y,ae.z,ae.w):fe.set(ae,ze,Ce,je),We.scissor(O.copy(fe).multiplyScalar(X).floor())},this.getScissorTest=function(){return me},this.setScissorTest=function(ae){We.setScissorTest(me=ae)},this.setOpaqueSort=function(ae){Z=ae},this.setTransparentSort=function(ae){q=ae},this.getClearColor=function(ae){return ae.copy(Ro.getClearColor())},this.setClearColor=function(){Ro.setClearColor.apply(Ro,arguments)},this.getClearAlpha=function(){return Ro.getClearAlpha()},this.setClearAlpha=function(){Ro.setClearAlpha.apply(Ro,arguments)},this.clear=function(ae,ze,Ce){let je=0;(ae===void 0||ae)&&(je|=16384),(ze===void 0||ze)&&(je|=256),(Ce===void 0||Ce)&&(je|=1024),et.clear(je)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",$b,!1),e.removeEventListener("webglcontextrestored",Jb,!1),Ut.dispose(),Vt.dispose(),W.dispose(),_e.dispose(),ht.dispose(),Er.dispose(),Br.dispose(),Br.removeEventListener("sessionstart",Qb),Br.removeEventListener("sessionend",ew),Fe&&(Fe.dispose(),Fe=null),uu.stop()},this.renderBufferImmediate=function(ae,ze){Er.initAttributes();const Ce=W.get(ae);ae.hasPositions&&!Ce.position&&(Ce.position=et.createBuffer()),ae.hasNormals&&!Ce.normal&&(Ce.normal=et.createBuffer()),ae.hasUvs&&!Ce.uv&&(Ce.uv=et.createBuffer()),ae.hasColors&&!Ce.color&&(Ce.color=et.createBuffer());const je=ze.getAttributes();ae.hasPositions&&(et.bindBuffer(34962,Ce.position),et.bufferData(34962,ae.positionArray,35048),Er.enableAttribute(je.position),et.vertexAttribPointer(je.position,3,5126,!1,0,0)),ae.hasNormals&&(et.bindBuffer(34962,Ce.normal),et.bufferData(34962,ae.normalArray,35048),Er.enableAttribute(je.normal),et.vertexAttribPointer(je.normal,3,5126,!1,0,0)),ae.hasUvs&&(et.bindBuffer(34962,Ce.uv),et.bufferData(34962,ae.uvArray,35048),Er.enableAttribute(je.uv),et.vertexAttribPointer(je.uv,2,5126,!1,0,0)),ae.hasColors&&(et.bindBuffer(34962,Ce.color),et.bufferData(34962,ae.colorArray,35048),Er.enableAttribute(je.color),et.vertexAttribPointer(je.color,3,5126,!1,0,0)),Er.disableUnusedAttributes(),et.drawArrays(4,0,ae.count),ae.count=0},this.renderBufferDirect=function(ae,ze,Ce,je,it,hn){ze===null&&(ze=Me);const Gt=it.isMesh&&it.matrixWorld.determinant()<0,at=iw(ae,ze,je,it);We.setMaterial(je,Gt);let $t=Ce.index;const Pt=Ce.attributes.position;if($t===null){if(Pt===void 0||Pt.count===0)return}else if($t.count===0)return;let rn,Bt=1;je.wireframe===!0&&($t=Oe.getWireframeAttribute(Ce),Bt=2),(je.morphTargets||je.morphNormals)&&Wd.update(it,Ce,je,at),Er.setup(it,je,at,Ce,$t);let tn=Xd;$t!==null&&(rn=ye.get($t),tn=Yd,tn.setIndex(rn));const vi=$t!==null?$t.count:Pt.count,Cn=Ce.drawRange.start*Bt,Co=Ce.drawRange.count*Bt,Pn=hn!==null?hn.start*Bt:0,ps=hn!==null?hn.count*Bt:1/0,Si=Math.max(Cn,Pn),Ur=Math.min(vi,Cn+Co,Pn+ps)-1,Zi=Math.max(0,Ur-Si+1);if(Zi!==0){if(it.isMesh)je.wireframe===!0?(We.setLineWidth(je.wireframeLinewidth*De()),tn.setMode(1)):tn.setMode(4);else if(it.isLine){let qd=je.linewidth;qd===void 0&&(qd=1),We.setLineWidth(qd*De()),it.isLineSegments?tn.setMode(1):it.isLineLoop?tn.setMode(2):tn.setMode(3)}else it.isPoints?tn.setMode(0):it.isSprite&&tn.setMode(4);if(it.isInstancedMesh)tn.renderInstances(Si,Zi,it.count);else if(Ce.isInstancedBufferGeometry){const qd=Math.min(Ce.instanceCount,Ce._maxInstanceCount);tn.renderInstances(Si,Zi,qd)}else tn.render(Si,Zi)}},this.compile=function(ae,ze){f=Vt.get(ae),f.init(),ae.traverseVisible(function(Ce){Ce.isLight&&Ce.layers.test(ze.layers)&&(f.pushLight(Ce),Ce.castShadow&&f.pushShadow(Ce))}),f.setupLights(),ae.traverse(function(Ce){const je=Ce.material;if(je)if(Array.isArray(je))for(let it=0;it<je.length;it++)z0(je[it],ae,Ce);else z0(je,ae,Ce)})};let H0=null;function Qb(){uu.stop()}function ew(){uu.start()}const uu=new Ic;function Cm(ae,ze,Ce){const je=ze.isScene===!0?ze.overrideMaterial:null;for(let it=0,hn=ae.length;it<hn;it++){const Gt=ae[it],at=Gt.object,$t=Gt.geometry,Pt=je===null?Gt.material:je,rn=Gt.group;if(Ce.isArrayCamera){const Bt=Ce.cameras;for(let tn=0,vi=Bt.length;tn<vi;tn++){const Cn=Bt[tn];at.layers.test(Cn.layers)&&(We.viewport(F.copy(Cn.viewport)),f.setupLightsView(Cn),tw(at,ze,Cn,$t,Pt,rn))}}else tw(at,ze,Ce,$t,Pt,rn)}}function tw(ae,ze,Ce,je,it,hn){if(ae.onBeforeRender(v,ze,Ce,je,it,hn),ae.modelViewMatrix.multiplyMatrices(Ce.matrixWorldInverse,ae.matrixWorld),ae.normalMatrix.getNormalMatrix(ae.modelViewMatrix),ae.isImmediateRenderObject){const Gt=iw(Ce,ze,it,ae);We.setMaterial(it),Er.reset(),function(at,$t){at.render(function(Pt){v.renderBufferImmediate(Pt,$t)})}(ae,Gt)}else it.transparent===!0&&it.side===J?(it.side=j,it.needsUpdate=!0,v.renderBufferDirect(Ce,ze,je,it,ae,hn),it.side=G,it.needsUpdate=!0,v.renderBufferDirect(Ce,ze,je,it,ae,hn),it.side=J):v.renderBufferDirect(Ce,ze,je,it,ae,hn);ae.onAfterRender(v,ze,Ce,je,it,hn)}function z0(ae,ze,Ce){ze.isScene!==!0&&(ze=Me);const je=W.get(ae),it=f.state.lights,hn=f.state.shadowsArray,Gt=it.state.version,at=_t.getParameters(ae,it.state,hn,ze,Ce),$t=_t.getProgramCacheKey(at);let Pt=je.programs;je.environment=ae.isMeshStandardMaterial?ze.environment:null,je.fog=ze.fog,je.envMap=_e.get(ae.envMap||je.environment),Pt===void 0&&(ae.addEventListener("dispose",Kb),Pt=new Map,je.programs=Pt);let rn=Pt.get($t);if(rn!==void 0){if(je.currentProgram===rn&&je.lightsStateVersion===Gt)return nw(ae,at),rn}else at.uniforms=_t.getUniforms(ae),ae.onBuild(at,v),ae.onBeforeCompile(at,v),rn=_t.acquireProgram(at,$t),Pt.set($t,rn),je.uniforms=at.uniforms;const Bt=je.uniforms;(ae.isShaderMaterial||ae.isRawShaderMaterial)&&ae.clipping!==!0||(Bt.clippingPlanes=ii.uniform),nw(ae,at),je.needsLights=function(Cn){return Cn.isMeshLambertMaterial||Cn.isMeshToonMaterial||Cn.isMeshPhongMaterial||Cn.isMeshStandardMaterial||Cn.isShadowMaterial||Cn.isShaderMaterial&&Cn.lights===!0}(ae),je.lightsStateVersion=Gt,je.needsLights&&(Bt.ambientLightColor.value=it.state.ambient,Bt.lightProbe.value=it.state.probe,Bt.directionalLights.value=it.state.directional,Bt.directionalLightShadows.value=it.state.directionalShadow,Bt.spotLights.value=it.state.spot,Bt.spotLightShadows.value=it.state.spotShadow,Bt.rectAreaLights.value=it.state.rectArea,Bt.ltc_1.value=it.state.rectAreaLTC1,Bt.ltc_2.value=it.state.rectAreaLTC2,Bt.pointLights.value=it.state.point,Bt.pointLightShadows.value=it.state.pointShadow,Bt.hemisphereLights.value=it.state.hemi,Bt.directionalShadowMap.value=it.state.directionalShadowMap,Bt.directionalShadowMatrix.value=it.state.directionalShadowMatrix,Bt.spotShadowMap.value=it.state.spotShadowMap,Bt.spotShadowMatrix.value=it.state.spotShadowMatrix,Bt.pointShadowMap.value=it.state.pointShadowMap,Bt.pointShadowMatrix.value=it.state.pointShadowMatrix);const tn=rn.getUniforms(),vi=Yo.seqWithValue(tn.seq,Bt);return je.currentProgram=rn,je.uniformsList=vi,rn}function nw(ae,ze){const Ce=W.get(ae);Ce.outputEncoding=ze.outputEncoding,Ce.instancing=ze.instancing,Ce.skinning=ze.skinning,Ce.numClippingPlanes=ze.numClippingPlanes,Ce.numIntersection=ze.numClipIntersection,Ce.vertexAlphas=ze.vertexAlphas}function iw(ae,ze,Ce,je){ze.isScene!==!0&&(ze=Me),de.resetTextureUnits();const it=ze.fog,hn=Ce.isMeshStandardMaterial?ze.environment:null,Gt=C===null?v.outputEncoding:C.texture.encoding,at=_e.get(Ce.envMap||hn),$t=Ce.vertexColors===!0&&je.geometry&&je.geometry.attributes.color&&je.geometry.attributes.color.itemSize===4,Pt=W.get(Ce),rn=f.state.lights;if(Pe===!0&&(Ue===!0||ae!==R)){const Zi=ae===R&&Ce.id===D;ii.setState(Ce,ae,Zi)}let Bt=!1;Ce.version===Pt.__version?Pt.needsLights&&Pt.lightsStateVersion!==rn.state.version||Pt.outputEncoding!==Gt||je.isInstancedMesh&&Pt.instancing===!1?Bt=!0:je.isInstancedMesh||Pt.instancing!==!0?je.isSkinnedMesh&&Pt.skinning===!1?Bt=!0:je.isSkinnedMesh||Pt.skinning!==!0?Pt.envMap!==at||Ce.fog&&Pt.fog!==it?Bt=!0:Pt.numClippingPlanes===void 0||Pt.numClippingPlanes===ii.numPlanes&&Pt.numIntersection===ii.numIntersection?Pt.vertexAlphas!==$t&&(Bt=!0):Bt=!0:Bt=!0:Bt=!0:(Bt=!0,Pt.__version=Ce.version);let tn=Pt.currentProgram;Bt===!0&&(tn=z0(Ce,ze,je));let vi=!1,Cn=!1,Co=!1;const Pn=tn.getUniforms(),ps=Pt.uniforms;if(We.useProgram(tn.program)&&(vi=!0,Cn=!0,Co=!0),Ce.id!==D&&(D=Ce.id,Cn=!0),vi||R!==ae){if(Pn.setValue(et,"projectionMatrix",ae.projectionMatrix),ke.logarithmicDepthBuffer&&Pn.setValue(et,"logDepthBufFC",2/(Math.log(ae.far+1)/Math.LN2)),R!==ae&&(R=ae,Cn=!0,Co=!0),Ce.isShaderMaterial||Ce.isMeshPhongMaterial||Ce.isMeshToonMaterial||Ce.isMeshStandardMaterial||Ce.envMap){const Zi=Pn.map.cameraPosition;Zi!==void 0&&Zi.setValue(et,$.setFromMatrixPosition(ae.matrixWorld))}(Ce.isMeshPhongMaterial||Ce.isMeshToonMaterial||Ce.isMeshLambertMaterial||Ce.isMeshBasicMaterial||Ce.isMeshStandardMaterial||Ce.isShaderMaterial)&&Pn.setValue(et,"isOrthographic",ae.isOrthographicCamera===!0),(Ce.isMeshPhongMaterial||Ce.isMeshToonMaterial||Ce.isMeshLambertMaterial||Ce.isMeshBasicMaterial||Ce.isMeshStandardMaterial||Ce.isShaderMaterial||Ce.isShadowMaterial||je.isSkinnedMesh)&&Pn.setValue(et,"viewMatrix",ae.matrixWorldInverse)}if(je.isSkinnedMesh){Pn.setOptional(et,je,"bindMatrix"),Pn.setOptional(et,je,"bindMatrixInverse");const Zi=je.skeleton;Zi&&(ke.floatVertexTextures?(Zi.boneTexture===null&&Zi.computeBoneTexture(),Pn.setValue(et,"boneTexture",Zi.boneTexture,de),Pn.setValue(et,"boneTextureSize",Zi.boneTextureSize)):Pn.setOptional(et,Zi,"boneMatrices"))}var Si,Ur;return(Cn||Pt.receiveShadow!==je.receiveShadow)&&(Pt.receiveShadow=je.receiveShadow,Pn.setValue(et,"receiveShadow",je.receiveShadow)),Cn&&(Pn.setValue(et,"toneMappingExposure",v.toneMappingExposure),Pt.needsLights&&(Ur=Co,(Si=ps).ambientLightColor.needsUpdate=Ur,Si.lightProbe.needsUpdate=Ur,Si.directionalLights.needsUpdate=Ur,Si.directionalLightShadows.needsUpdate=Ur,Si.pointLights.needsUpdate=Ur,Si.pointLightShadows.needsUpdate=Ur,Si.spotLights.needsUpdate=Ur,Si.spotLightShadows.needsUpdate=Ur,Si.rectAreaLights.needsUpdate=Ur,Si.hemisphereLights.needsUpdate=Ur),it&&Ce.fog&&gt.refreshFogUniforms(ps,it),gt.refreshMaterialUniforms(ps,Ce,X,Q,Fe),Yo.upload(et,Pt.uniformsList,ps,de)),Ce.isShaderMaterial&&Ce.uniformsNeedUpdate===!0&&(Yo.upload(et,Pt.uniformsList,ps,de),Ce.uniformsNeedUpdate=!1),Ce.isSpriteMaterial&&Pn.setValue(et,"center",je.center),Pn.setValue(et,"modelViewMatrix",je.modelViewMatrix),Pn.setValue(et,"normalMatrix",je.normalMatrix),Pn.setValue(et,"modelMatrix",je.matrixWorld),tn}uu.setAnimationLoop(function(ae){H0&&H0(ae)}),typeof window!="undefined"&&uu.setContext(window),this.setAnimationLoop=function(ae){H0=ae,Br.setAnimationLoop(ae),ae===null?uu.stop():uu.start()},Br.addEventListener("sessionstart",Qb),Br.addEventListener("sessionend",ew),this.render=function(ae,ze){if(ze!==void 0&&ze.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(x===!0)return;ae.autoUpdate===!0&&ae.updateMatrixWorld(),ze.parent===null&&ze.updateMatrixWorld(),Br.enabled===!0&&Br.isPresenting===!0&&(Br.cameraAutoUpdate===!0&&Br.updateCamera(ze),ze=Br.getCamera()),ae.isScene===!0&&ae.onBeforeRender(v,ae,ze,C),f=Vt.get(ae,g.length),f.init(),g.push(f),Y.multiplyMatrices(ze.projectionMatrix,ze.matrixWorldInverse),pe.setFromProjectionMatrix(Y),Ue=this.localClippingEnabled,Pe=ii.init(this.clippingPlanes,Ue,ze),d=Ut.get(ae,m.length),d.init(),m.push(d),function Gt(at,$t,Pt,rn){if(at.visible===!1)return;if(at.layers.test($t.layers)){if(at.isGroup)Pt=at.renderOrder;else if(at.isLOD)at.autoUpdate===!0&&at.update($t);else if(at.isLight)f.pushLight(at),at.castShadow&&f.pushShadow(at);else if(at.isSprite){if(!at.frustumCulled||pe.intersectsSprite(at)){rn&&$.setFromMatrixPosition(at.matrixWorld).applyMatrix4(Y);const tn=ht.update(at),vi=at.material;vi.visible&&d.push(at,tn,vi,Pt,$.z,null)}}else if(at.isImmediateRenderObject)rn&&$.setFromMatrixPosition(at.matrixWorld).applyMatrix4(Y),d.push(at,null,at.material,Pt,$.z,null);else if((at.isMesh||at.isLine||at.isPoints)&&(at.isSkinnedMesh&&at.skeleton.frame!==ge.render.frame&&(at.skeleton.update(),at.skeleton.frame=ge.render.frame),!at.frustumCulled||pe.intersectsObject(at))){rn&&$.setFromMatrixPosition(at.matrixWorld).applyMatrix4(Y);const tn=ht.update(at),vi=at.material;if(Array.isArray(vi)){const Cn=tn.groups;for(let Co=0,Pn=Cn.length;Co<Pn;Co++){const ps=Cn[Co],Si=vi[ps.materialIndex];Si&&Si.visible&&d.push(at,tn,Si,Pt,$.z,ps)}}else vi.visible&&d.push(at,tn,vi,Pt,$.z,null)}}const Bt=at.children;for(let tn=0,vi=Bt.length;tn<vi;tn++)Gt(Bt[tn],$t,Pt,rn)}(ae,ze,0,v.sortObjects),d.finish(),v.sortObjects===!0&&d.sort(Z,q),Pe===!0&&ii.beginShadows();const Ce=f.state.shadowsArray;An.render(Ce,ae,ze),f.setupLights(),f.setupLightsView(ze),Pe===!0&&ii.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ro.render(d,ae);const je=d.opaque,it=d.transmissive,hn=d.transparent;je.length>0&&Cm(je,ae,ze),it.length>0&&function(Gt,at,$t,Pt){if(Fe===null){const tn=s===!0&&ke.isWebGL2===!0;Fe=new(tn?Ss:Ar)(1024,1024,{generateMipmaps:!0,type:hr.convert(gs)!==null?gs:No,minFilter:fs,magFilter:Xn,wrapS:di,wrapT:di})}const rn=v.getRenderTarget();v.setRenderTarget(Fe),v.clear();const Bt=v.toneMapping;v.toneMapping=io,Cm(Gt,$t,Pt),v.toneMapping=Bt,de.updateMultisampleRenderTarget(Fe),de.updateRenderTargetMipmap(Fe),v.setRenderTarget(rn),Cm(at,$t,Pt)}(je,it,ae,ze),hn.length>0&&Cm(hn,ae,ze),C!==null&&(de.updateMultisampleRenderTarget(C),de.updateRenderTargetMipmap(C)),ae.isScene===!0&&ae.onAfterRender(v,ae,ze),We.buffers.depth.setTest(!0),We.buffers.depth.setMask(!0),We.buffers.color.setMask(!0),We.setPolygonOffset(!1),Er.resetDefaultState(),D=-1,R=null,g.pop(),f=g.length>0?g[g.length-1]:null,m.pop(),d=m.length>0?m[m.length-1]:null},this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return M},this.getRenderTarget=function(){return C},this.setRenderTarget=function(ae,ze=0,Ce=0){C=ae,T=ze,M=Ce,ae&&W.get(ae).__webglFramebuffer===void 0&&de.setupRenderTarget(ae);let je=null,it=!1,hn=!1;if(ae){const Gt=ae.texture;(Gt.isDataTexture3D||Gt.isDataTexture2DArray)&&(hn=!0);const at=W.get(ae).__webglFramebuffer;ae.isWebGLCubeRenderTarget?(je=at[ze],it=!0):je=ae.isWebGLMultisampleRenderTarget?W.get(ae).__webglMultisampledFramebuffer:at,F.copy(ae.viewport),O.copy(ae.scissor),U=ae.scissorTest}else F.copy(oe).multiplyScalar(X).floor(),O.copy(fe).multiplyScalar(X).floor(),U=me;if(We.bindFramebuffer(36160,je)&&ke.drawBuffers){let Gt=!1;if(ae)if(ae.isWebGLMultipleRenderTargets){const at=ae.texture;if(le.length!==at.length||le[0]!==36064){for(let $t=0,Pt=at.length;$t<Pt;$t++)le[$t]=36064+$t;le.length=at.length,Gt=!0}}else le.length===1&&le[0]===36064||(le[0]=36064,le.length=1,Gt=!0);else le.length===1&&le[0]===1029||(le[0]=1029,le.length=1,Gt=!0);Gt&&(ke.isWebGL2?et.drawBuffers(le):we.get("WEBGL_draw_buffers").drawBuffersWEBGL(le))}if(We.viewport(F),We.scissor(O),We.setScissorTest(U),it){const Gt=W.get(ae.texture);et.framebufferTexture2D(36160,36064,34069+ze,Gt.__webglTexture,Ce)}else if(hn){const Gt=W.get(ae.texture),at=ze||0;et.framebufferTextureLayer(36160,36064,Gt.__webglTexture,Ce||0,at)}},this.readRenderTargetPixels=function(ae,ze,Ce,je,it,hn,Gt){if(!ae||!ae.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let at=W.get(ae).__webglFramebuffer;if(ae.isWebGLCubeRenderTarget&&Gt!==void 0&&(at=at[Gt]),at){We.bindFramebuffer(36160,at);try{const $t=ae.texture,Pt=$t.format,rn=$t.type;if(Pt!==$i&&hr.convert(Pt)!==et.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Bt=rn===gs&&(we.has("EXT_color_buffer_half_float")||ke.isWebGL2&&we.has("EXT_color_buffer_float"));if(!(rn===No||hr.convert(rn)===et.getParameter(35738)||rn===ro&&(ke.isWebGL2||we.has("OES_texture_float")||we.has("WEBGL_color_buffer_float"))||Bt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");et.checkFramebufferStatus(36160)===36053?ze>=0&&ze<=ae.width-je&&Ce>=0&&Ce<=ae.height-it&&et.readPixels(ze,Ce,je,it,hr.convert(Pt),hr.convert(rn),hn):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const $t=C!==null?W.get(C).__webglFramebuffer:null;We.bindFramebuffer(36160,$t)}}},this.copyFramebufferToTexture=function(ae,ze,Ce=0){const je=Math.pow(2,-Ce),it=Math.floor(ze.image.width*je),hn=Math.floor(ze.image.height*je);let Gt=hr.convert(ze.format);ke.isWebGL2&&(Gt===6407&&(Gt=32849),Gt===6408&&(Gt=32856)),de.setTexture2D(ze,0),et.copyTexImage2D(3553,Ce,Gt,ae.x,ae.y,it,hn,0),We.unbindTexture()},this.copyTextureToTexture=function(ae,ze,Ce,je=0){const it=ze.image.width,hn=ze.image.height,Gt=hr.convert(Ce.format),at=hr.convert(Ce.type);de.setTexture2D(Ce,0),et.pixelStorei(37440,Ce.flipY),et.pixelStorei(37441,Ce.premultiplyAlpha),et.pixelStorei(3317,Ce.unpackAlignment),ze.isDataTexture?et.texSubImage2D(3553,je,ae.x,ae.y,it,hn,Gt,at,ze.image.data):ze.isCompressedTexture?et.compressedTexSubImage2D(3553,je,ae.x,ae.y,ze.mipmaps[0].width,ze.mipmaps[0].height,Gt,ze.mipmaps[0].data):et.texSubImage2D(3553,je,ae.x,ae.y,Gt,at,ze.image),je===0&&Ce.generateMipmaps&&et.generateMipmap(3553),We.unbindTexture()},this.copyTextureToTexture3D=function(ae,ze,Ce,je,it=0){if(v.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const hn=ae.max.x-ae.min.x+1,Gt=ae.max.y-ae.min.y+1,at=ae.max.z-ae.min.z+1,$t=hr.convert(je.format),Pt=hr.convert(je.type);let rn;if(je.isDataTexture3D)de.setTexture3D(je,0),rn=32879;else{if(!je.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");de.setTexture2DArray(je,0),rn=35866}et.pixelStorei(37440,je.flipY),et.pixelStorei(37441,je.premultiplyAlpha),et.pixelStorei(3317,je.unpackAlignment);const Bt=et.getParameter(3314),tn=et.getParameter(32878),vi=et.getParameter(3316),Cn=et.getParameter(3315),Co=et.getParameter(32877),Pn=Ce.isCompressedTexture?Ce.mipmaps[0]:Ce.image;et.pixelStorei(3314,Pn.width),et.pixelStorei(32878,Pn.height),et.pixelStorei(3316,ae.min.x),et.pixelStorei(3315,ae.min.y),et.pixelStorei(32877,ae.min.z),Ce.isDataTexture||Ce.isDataTexture3D?et.texSubImage3D(rn,it,ze.x,ze.y,ze.z,hn,Gt,at,$t,Pt,Pn.data):Ce.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),et.compressedTexSubImage3D(rn,it,ze.x,ze.y,ze.z,hn,Gt,at,$t,Pn.data)):et.texSubImage3D(rn,it,ze.x,ze.y,ze.z,hn,Gt,at,$t,Pt,Pn),et.pixelStorei(3314,Bt),et.pixelStorei(32878,tn),et.pixelStorei(3316,vi),et.pixelStorei(3315,Cn),et.pixelStorei(32877,Co),it===0&&je.generateMipmaps&&et.generateMipmap(rn),We.unbindTexture()},this.initTexture=function(ae){de.setTexture2D(ae,0),We.unbindTexture()},this.resetState=function(){T=0,M=0,C=null,We.reset(),Er.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class hi extends dn{}hi.prototype.isWebGL1Renderer=!0;class mi{constructor(e,t=25e-5){this.name="",this.color=new ft(e),this.density=t}clone(){return new mi(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}mi.prototype.isFogExp2=!0;class wh{constructor(e,t=1,n=1e3){this.name="",this.color=new ft(e),this.near=t,this.far=n}clone(){return new wh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}wh.prototype.isFog=!0;class Aa extends jt{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}}Aa.prototype.isScene=!0;class ks{constructor(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=bs,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Qi()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,o=this.stride;i<o;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Qi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Qi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}ks.prototype.isInterleavedBuffer=!0;const Jn=new w;class xo{constructor(e,t,n,i=!1){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Jn.x=this.getX(t),Jn.y=this.getY(t),Jn.z=this.getZ(t),Jn.applyMatrix4(e),this.setXYZ(t,Jn.x,Jn.y,Jn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Jn.x=this.getX(t),Jn.y=this.getY(t),Jn.z=this.getZ(t),Jn.applyNormalMatrix(e),this.setXYZ(t,Jn.x,Jn.y,Jn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Jn.x=this.getX(t),Jn.y=this.getY(t),Jn.z=this.getZ(t),Jn.transformDirection(e),this.setXYZ(t,Jn.x,Jn.y,Jn.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[i+o])}return new Yt(new this.array.constructor(t),this.itemSize,this.normalized)}return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new xo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[i+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}xo.prototype.isInterleavedBufferAttribute=!0;class Th extends fi{constructor(e){super(),this.type="SpriteMaterial",this.color=new ft(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let Gs;Th.prototype.isSpriteMaterial=!0;const Zr=new w,Pa=new w,Hs=new w,zs=new $e,Sh=new $e,uf=new ct,ol=new w,Eh=new w,sl=new w,lf=new $e,Mh=new $e,qc=new $e;class Ah extends jt{constructor(e){if(super(),this.type="Sprite",Gs===void 0){Gs=new St;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new ks(t,5);Gs.setIndex([0,1,2,0,2,3]),Gs.setAttribute("position",new xo(n,3,0,!1)),Gs.setAttribute("uv",new xo(n,2,3,!1))}this.geometry=Gs,this.material=e!==void 0?e:new Th,this.center=new $e(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Pa.setFromMatrixScale(this.matrixWorld),uf.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Hs.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Pa.multiplyScalar(-Hs.z);const n=this.material.rotation;let i,o;n!==0&&(o=Math.cos(n),i=Math.sin(n));const s=this.center;al(ol.set(-.5,-.5,0),Hs,s,Pa,i,o),al(Eh.set(.5,-.5,0),Hs,s,Pa,i,o),al(sl.set(.5,.5,0),Hs,s,Pa,i,o),lf.set(0,0),Mh.set(1,0),qc.set(1,1);let a=e.ray.intersectTriangle(ol,Eh,sl,!1,Zr);if(a===null&&(al(Eh.set(-.5,.5,0),Hs,s,Pa,i,o),Mh.set(0,1),a=e.ray.intersectTriangle(ol,sl,Eh,!1,Zr),a===null))return;const h=e.ray.origin.distanceTo(Zr);h<e.near||h>e.far||t.push({distance:h,point:Zr.clone(),uv:Sn.getUV(Zr,ol,Eh,sl,lf,Mh,qc,new $e),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function al(r,e,t,n,i,o){zs.subVectors(r,t).addScalar(.5).multiply(n),i!==void 0?(Sh.x=o*zs.x-i*zs.y,Sh.y=i*zs.x+o*zs.y):Sh.copy(zs),r.copy(e),r.x+=Sh.x,r.y+=Sh.y,r.applyMatrix4(uf)}Ah.prototype.isSprite=!0;const Ra=new w,cf=new w;class df extends jt{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const o=t[n];this.addLevel(o.object.clone(),o.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const n=this.levels;let i;for(i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Ra.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(Ra);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Ra.setFromMatrixPosition(e.matrixWorld),cf.setFromMatrixPosition(this.matrixWorld);const n=Ra.distanceTo(cf)/e.zoom;let i,o;for(t[0].object.visible=!0,i=1,o=t.length;i<o&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(this._currentLevel=i-1;i<o;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,o=n.length;i<o;i++){const s=n[i];t.object.levels.push({object:s.object.uuid,distance:s.distance})}return t}}const Bi=new w,hl=new cn,pf=new cn,vg=new w,ul=new ct;class Ca extends sn{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ct,this.bindMatrixInverse=new ct}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new cn,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,i=this.geometry;hl.fromBufferAttribute(i.attributes.skinIndex,e),pf.fromBufferAttribute(i.attributes.skinWeight,e),Bi.fromBufferAttribute(i.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const s=pf.getComponent(o);if(s!==0){const a=hl.getComponent(o);ul.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(vg.copy(Bi).applyMatrix4(ul),s)}}return t.applyMatrix4(this.bindMatrixInverse)}}Ca.prototype.isSkinnedMesh=!0;class ll extends jt{constructor(){super(),this.type="Bone"}}ll.prototype.isBone=!0;class Zo extends qn{constructor(e=null,t=1,n=1,i,o,s,a,h,u=Xn,c=Xn,d,f){super(null,s,a,h,u,c,i,o,d,f),this.image={data:e,width:t,height:n},this.magFilter=u,this.minFilter=c,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Zo.prototype.isDataTexture=!0;const ff=new ct,mf=new ct;class cl{constructor(e=[],t=[]){this.uuid=Qi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new ct)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new ct;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let o=0,s=e.length;o<s;o++){const a=e[o]?e[o].matrixWorld:mf;ff.multiplyMatrices(a,t[o]),ff.toArray(n,16*o)}i!==null&&(i.needsUpdate=!0)}clone(){return new cl(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=ua(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Zo(t,e,e,$i,ro);return this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const o=e.bones[n];let s=t[o];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),s=new ll),this.bones.push(s),this.boneInverses.push(new ct().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,o=t.length;i<o;i++){const s=t[i];e.bones.push(s.uuid);const a=n[i];e.boneInverses.push(a.toArray())}return e}}const gf=new ct,dl=new ct,Ia=[],Ph=new sn;class Zc extends sn{constructor(e,t,n){super(e,t),this.instanceMatrix=new Yt(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Ph.geometry=this.geometry,Ph.material=this.material,Ph.material!==void 0)for(let o=0;o<i;o++){this.getMatrixAt(o,gf),dl.multiplyMatrices(n,gf),Ph.matrixWorld=dl,Ph.raycast(e,Ia);for(let s=0,a=Ia.length;s<a;s++){const h=Ia[s];h.instanceId=o,h.object=this,t.push(h)}Ia.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Yt(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Zc.prototype.isInstancedMesh=!0;class gi extends fi{constructor(e){super(),this.type="LineBasicMaterial",this.color=new ft(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this}}gi.prototype.isLineBasicMaterial=!0;const vf=new w,pl=new w,_f=new ct,$c=new mo,fl=new oi;class l extends jt{constructor(e=new St,t=new gi){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,o=t.count;i<o;i++)vf.fromBufferAttribute(t,i-1),pl.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=vf.distanceTo(pl);e.setAttribute("lineDistance",new rt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,o=e.params.Line.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),fl.copy(n.boundingSphere),fl.applyMatrix4(i),fl.radius+=o,e.ray.intersectsSphere(fl)===!1)return;_f.copy(i).invert(),$c.copy(e.ray).applyMatrix4(_f);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),h=a*a,u=new w,c=new w,d=new w,f=new w,m=this.isLineSegments?2:1;if(n.isBufferGeometry){const g=n.index,v=n.attributes.position;if(g!==null)for(let x=Math.max(0,s.start),T=Math.min(g.count,s.start+s.count)-1;x<T;x+=m){const M=g.getX(x),C=g.getX(x+1);if(u.fromBufferAttribute(v,M),c.fromBufferAttribute(v,C),$c.distanceSqToSegment(u,c,f,d)>h)continue;f.applyMatrix4(this.matrixWorld);const D=e.ray.origin.distanceTo(f);D<e.near||D>e.far||t.push({distance:D,point:d.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}else for(let x=Math.max(0,s.start),T=Math.min(v.count,s.start+s.count)-1;x<T;x+=m){if(u.fromBufferAttribute(v,x),c.fromBufferAttribute(v,x+1),$c.distanceSqToSegment(u,c,f,d)>h)continue;f.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(f);M<e.near||M>e.far||t.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=i.length;o<s;o++){const a=i[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}l.prototype.isLine=!0;const p=new w,y=new w;class E extends l{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,o=t.count;i<o;i+=2)p.fromBufferAttribute(t,i),y.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+p.distanceTo(y);e.setAttribute("lineDistance",new rt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}E.prototype.isLineSegments=!0;class P extends l{constructor(e,t){super(e,t),this.type="LineLoop"}}P.prototype.isLineLoop=!0;class H extends fi{constructor(e){super(),this.type="PointsMaterial",this.color=new ft(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this}}H.prototype.isPointsMaterial=!0;const te=new ct,ue=new mo,ve=new oi,Ge=new w;class He extends jt{constructor(e=new St,t=new H){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,o=e.params.Points.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),ve.copy(n.boundingSphere),ve.applyMatrix4(i),ve.radius+=o,e.ray.intersectsSphere(ve)===!1)return;te.copy(i).invert(),ue.copy(e.ray).applyMatrix4(te);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),h=a*a;if(n.isBufferGeometry){const u=n.index,c=n.attributes.position;if(u!==null)for(let d=Math.max(0,s.start),f=Math.min(u.count,s.start+s.count);d<f;d++){const m=u.getX(d);Ge.fromBufferAttribute(c,m),Ke(Ge,m,h,i,e,t,this)}else for(let d=Math.max(0,s.start),f=Math.min(c.count,s.start+s.count);d<f;d++)Ge.fromBufferAttribute(c,d),Ke(Ge,d,h,i,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=i.length;o<s;o++){const a=i[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function Ke(r,e,t,n,i,o,s){const a=ue.distanceSqToPoint(r);if(a<t){const h=new w;ue.closestPointToPoint(r,h),h.applyMatrix4(n);const u=i.ray.origin.distanceTo(h);if(u<i.near||u>i.far)return;o.push({distance:u,distanceToRay:Math.sqrt(a),point:h,index:e,face:null,object:s})}}He.prototype.isPoints=!0;class mt extends qn{constructor(e,t,n,i,o,s,a,h,u){super(e,t,n,i,o,s,a,h,u),this.format=a!==void 0?a:oo,this.minFilter=s!==void 0?s:Yn,this.magFilter=o!==void 0?o:Yn,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function d(){c.needsUpdate=!0,e.requestVideoFrameCallback(d)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}mt.prototype.isVideoTexture=!0;class vt extends qn{constructor(e,t,n,i,o,s,a,h,u,c,d,f){super(null,s,a,h,u,c,i,o,d,f),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}vt.prototype.isCompressedTexture=!0;class At extends qn{constructor(e,t,n,i,o,s,a,h,u){super(e,t,n,i,o,s,a,h,u),this.needsUpdate=!0}}At.prototype.isCanvasTexture=!0;class qe extends qn{constructor(e,t,n,i,o,s,a,h,u,c){if((c=c!==void 0?c:Ln)!==Ln&&c!==vs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&c===Ln&&(n=Ja),n===void 0&&c===vs&&(n=ln),super(null,i,o,s,a,h,c,n,u),this.image={width:e,height:t},this.magFilter=a!==void 0?a:Xn,this.minFilter=h!==void 0?h:Xn,this.flipY=!1,this.generateMipmaps=!1}}qe.prototype.isDepthTexture=!0;class Qe extends St{constructor(e=1,t=8,n=0,i=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const o=[],s=[],a=[],h=[],u=new w,c=new $e;s.push(0,0,0),a.push(0,0,1),h.push(.5,.5);for(let d=0,f=3;d<=t;d++,f+=3){const m=n+d/t*i;u.x=e*Math.cos(m),u.y=e*Math.sin(m),s.push(u.x,u.y,u.z),a.push(0,0,1),c.x=(s[f]/e+1)/2,c.y=(s[f+1]/e+1)/2,h.push(c.x,c.y)}for(let d=1;d<=t;d++)o.push(d,d+1,0);this.setIndex(o),this.setAttribute("position",new rt(s,3)),this.setAttribute("normal",new rt(a,3)),this.setAttribute("uv",new rt(h,2))}static fromJSON(e){return new Qe(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Tt extends St{constructor(e=1,t=1,n=1,i=8,o=1,s=!1,a=0,h=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:o,openEnded:s,thetaStart:a,thetaLength:h};const u=this;i=Math.floor(i),o=Math.floor(o);const c=[],d=[],f=[],m=[];let g=0;const v=[],x=n/2;let T=0;function M(C){const D=g,R=new $e,F=new w;let O=0;const U=C===!0?e:t,he=C===!0?1:-1;for(let X=1;X<=i;X++)d.push(0,x*he,0),f.push(0,he,0),m.push(.5,.5),g++;const Q=g;for(let X=0;X<=i;X++){const Z=X/i*h+a,q=Math.cos(Z),oe=Math.sin(Z);F.x=U*oe,F.y=x*he,F.z=U*q,d.push(F.x,F.y,F.z),f.push(0,he,0),R.x=.5*q+.5,R.y=.5*oe*he+.5,m.push(R.x,R.y),g++}for(let X=0;X<i;X++){const Z=D+X,q=Q+X;C===!0?c.push(q,q+1,Z):c.push(q+1,q,Z),O+=3}u.addGroup(T,O,C===!0?1:2),T+=O}(function(){const C=new w,D=new w;let R=0;const F=(t-e)/n;for(let O=0;O<=o;O++){const U=[],he=O/o,Q=he*(t-e)+e;for(let X=0;X<=i;X++){const Z=X/i,q=Z*h+a,oe=Math.sin(q),fe=Math.cos(q);D.x=Q*oe,D.y=-he*n+x,D.z=Q*fe,d.push(D.x,D.y,D.z),C.set(oe,F,fe).normalize(),f.push(C.x,C.y,C.z),m.push(Z,1-he),U.push(g++)}v.push(U)}for(let O=0;O<i;O++)for(let U=0;U<o;U++){const he=v[U][O],Q=v[U+1][O],X=v[U+1][O+1],Z=v[U][O+1];c.push(he,Q,Z),c.push(Q,X,Z),R+=6}u.addGroup(T,R,0),T+=R})(),s===!1&&(e>0&&M(!0),t>0&&M(!1)),this.setIndex(c),this.setAttribute("position",new rt(d,3)),this.setAttribute("normal",new rt(f,3)),this.setAttribute("uv",new rt(m,2))}static fromJSON(e){return new Tt(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class pt extends Tt{constructor(e=1,t=1,n=8,i=1,o=!1,s=0,a=2*Math.PI){super(0,e,t,n,i,o,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:s,thetaLength:a}}static fromJSON(e){return new pt(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class wt extends St{constructor(e,t,n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const o=[],s=[];function a(f,m,g,v){const x=v+1,T=[];for(let M=0;M<=x;M++){T[M]=[];const C=f.clone().lerp(g,M/x),D=m.clone().lerp(g,M/x),R=x-M;for(let F=0;F<=R;F++)T[M][F]=F===0&&M===x?C:C.clone().lerp(D,F/R)}for(let M=0;M<x;M++)for(let C=0;C<2*(x-M)-1;C++){const D=Math.floor(C/2);C%2==0?(h(T[M][D+1]),h(T[M+1][D]),h(T[M][D])):(h(T[M][D+1]),h(T[M+1][D+1]),h(T[M+1][D]))}}function h(f){o.push(f.x,f.y,f.z)}function u(f,m){const g=3*f;m.x=e[g+0],m.y=e[g+1],m.z=e[g+2]}function c(f,m,g,v){v<0&&f.x===1&&(s[m]=f.x-1),g.x===0&&g.z===0&&(s[m]=v/2/Math.PI+.5)}function d(f){return Math.atan2(f.z,-f.x)}(function(f){const m=new w,g=new w,v=new w;for(let x=0;x<t.length;x+=3)u(t[x+0],m),u(t[x+1],g),u(t[x+2],v),a(m,g,v,f)})(i),function(f){const m=new w;for(let g=0;g<o.length;g+=3)m.x=o[g+0],m.y=o[g+1],m.z=o[g+2],m.normalize().multiplyScalar(f),o[g+0]=m.x,o[g+1]=m.y,o[g+2]=m.z}(n),function(){const f=new w;for(let g=0;g<o.length;g+=3){f.x=o[g+0],f.y=o[g+1],f.z=o[g+2];const v=d(f)/2/Math.PI+.5,x=(m=f,Math.atan2(-m.y,Math.sqrt(m.x*m.x+m.z*m.z))/Math.PI+.5);s.push(v,1-x)}var m;(function(){const g=new w,v=new w,x=new w,T=new w,M=new $e,C=new $e,D=new $e;for(let R=0,F=0;R<o.length;R+=9,F+=6){g.set(o[R+0],o[R+1],o[R+2]),v.set(o[R+3],o[R+4],o[R+5]),x.set(o[R+6],o[R+7],o[R+8]),M.set(s[F+0],s[F+1]),C.set(s[F+2],s[F+3]),D.set(s[F+4],s[F+5]),T.copy(g).add(v).add(x).divideScalar(3);const O=d(T);c(M,F+0,g,O),c(C,F+2,v,O),c(D,F+4,x,O)}})(),function(){for(let g=0;g<s.length;g+=6){const v=s[g+0],x=s[g+2],T=s[g+4],M=Math.max(v,x,T),C=Math.min(v,x,T);M>.9&&C<.1&&(v<.2&&(s[g+0]+=1),x<.2&&(s[g+2]+=1),T<.2&&(s[g+4]+=1))}}()}(),this.setAttribute("position",new rt(o,3)),this.setAttribute("normal",new rt(o.slice(),3)),this.setAttribute("uv",new rt(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new wt(e.vertices,e.indices,e.radius,e.details)}}class Rt extends wt{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Rt(e.radius,e.detail)}}const zt=new w,bt=new w,It=new w,zn=new Sn;class wi extends St{constructor(e,t){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=t!==void 0?t:1,e.isGeometry===!0)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const n=Math.pow(10,4),i=Math.cos(wn*t),o=e.getIndex(),s=e.getAttribute("position"),a=o?o.count:s.count,h=[0,0,0],u=["a","b","c"],c=new Array(3),d={},f=[];for(let m=0;m<a;m+=3){o?(h[0]=o.getX(m),h[1]=o.getX(m+1),h[2]=o.getX(m+2)):(h[0]=m,h[1]=m+1,h[2]=m+2);const{a:g,b:v,c:x}=zn;if(g.fromBufferAttribute(s,h[0]),v.fromBufferAttribute(s,h[1]),x.fromBufferAttribute(s,h[2]),zn.getNormal(It),c[0]=`${Math.round(g.x*n)},${Math.round(g.y*n)},${Math.round(g.z*n)}`,c[1]=`${Math.round(v.x*n)},${Math.round(v.y*n)},${Math.round(v.z*n)}`,c[2]=`${Math.round(x.x*n)},${Math.round(x.y*n)},${Math.round(x.z*n)}`,c[0]!==c[1]&&c[1]!==c[2]&&c[2]!==c[0])for(let T=0;T<3;T++){const M=(T+1)%3,C=c[T],D=c[M],R=zn[u[T]],F=zn[u[M]],O=`${C}_${D}`,U=`${D}_${C}`;U in d&&d[U]?(It.dot(d[U].normal)<=i&&(f.push(R.x,R.y,R.z),f.push(F.x,F.y,F.z)),d[U]=null):O in d||(d[O]={index0:h[T],index1:h[M],normal:It.clone()})}}for(const m in d)if(d[m]){const{index0:g,index1:v}=d[m];zt.fromBufferAttribute(s,g),bt.fromBufferAttribute(s,v),f.push(zt.x,zt.y,zt.z),f.push(bt.x,bt.y,bt.z)}this.setAttribute("position",new rt(f,3))}}class Vn{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),o=0;t.push(0);for(let s=1;s<=e;s++)n=this.getPoint(s/e),o+=n.distanceTo(i),t.push(o),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const o=n.length;let s;s=t||e*n[o-1];let a,h=0,u=o-1;for(;h<=u;)if(i=Math.floor(h+(u-h)/2),a=n[i]-s,a<0)h=i+1;else{if(!(a>0)){u=i;break}u=i-1}if(i=u,n[i]===s)return i/(o-1);const c=n[i];return(i+(s-c)/(n[i+1]-c))/(o-1)}getTangent(e,t){let n=e-1e-4,i=e+1e-4;n<0&&(n=0),i>1&&(i=1);const o=this.getPoint(n),s=this.getPoint(i),a=t||(o.isVector2?new $e:new w);return a.copy(s).sub(o).normalize(),a}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new w,i=[],o=[],s=[],a=new w,h=new ct;for(let m=0;m<=e;m++){const g=m/e;i[m]=this.getTangentAt(g,new w),i[m].normalize()}o[0]=new w,s[0]=new w;let u=Number.MAX_VALUE;const c=Math.abs(i[0].x),d=Math.abs(i[0].y),f=Math.abs(i[0].z);c<=u&&(u=c,n.set(1,0,0)),d<=u&&(u=d,n.set(0,1,0)),f<=u&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),o[0].crossVectors(i[0],a),s[0].crossVectors(i[0],o[0]);for(let m=1;m<=e;m++){if(o[m]=o[m-1].clone(),s[m]=s[m-1].clone(),a.crossVectors(i[m-1],i[m]),a.length()>Number.EPSILON){a.normalize();const g=Math.acos(xi(i[m-1].dot(i[m]),-1,1));o[m].applyMatrix4(h.makeRotationAxis(a,g))}s[m].crossVectors(i[m],o[m])}if(t===!0){let m=Math.acos(xi(o[0].dot(o[e]),-1,1));m/=e,i[0].dot(a.crossVectors(o[0],o[e]))>0&&(m=-m);for(let g=1;g<=e;g++)o[g].applyMatrix4(h.makeRotationAxis(i[g],m*g)),s[g].crossVectors(i[g],o[g])}return{tangents:i,normals:o,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Fn extends Vn{constructor(e=0,t=0,n=1,i=1,o=0,s=2*Math.PI,a=!1,h=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=o,this.aEndAngle=s,this.aClockwise=a,this.aRotation=h}getPoint(e,t){const n=t||new $e,i=2*Math.PI;let o=this.aEndAngle-this.aStartAngle;const s=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=i;for(;o>i;)o-=i;o<Number.EPSILON&&(o=s?0:i),this.aClockwise!==!0||s||(o===i?o=-i:o-=i);const a=this.aStartAngle+e*o;let h=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),f=h-this.aX,m=u-this.aY;h=f*c-m*d+this.aX,u=f*d+m*c+this.aY}return n.set(h,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Fn.prototype.isEllipseCurve=!0;class Nr extends Fn{constructor(e,t,n,i,o,s){super(e,t,n,n,i,o,s),this.type="ArcCurve"}}function $r(){let r=0,e=0,t=0,n=0;function i(o,s,a,h){r=o,e=a,t=-3*o+3*s-2*a-h,n=2*o-2*s+a+h}return{initCatmullRom:function(o,s,a,h,u){i(s,a,u*(a-o),u*(h-s))},initNonuniformCatmullRom:function(o,s,a,h,u,c,d){let f=(s-o)/u-(a-o)/(u+c)+(a-s)/c,m=(a-s)/c-(h-s)/(c+d)+(h-a)/d;f*=c,m*=c,i(s,a,f,m)},calc:function(o){const s=o*o;return r+e*o+t*s+n*(s*o)}}}Nr.prototype.isArcCurve=!0;const $o=new w,La=new $r,Jo=new $r,Jr=new $r;class ml extends Vn{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new w){const n=t,i=this.points,o=i.length,s=(o-(this.closed?0:1))*e;let a,h,u=Math.floor(s),c=s-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/o)+1)*o:c===0&&u===o-1&&(u=o-2,c=1),this.closed||u>0?a=i[(u-1)%o]:($o.subVectors(i[0],i[1]).add(i[0]),a=$o);const d=i[u%o],f=i[(u+1)%o];if(this.closed||u+2<o?h=i[(u+2)%o]:($o.subVectors(i[o-1],i[o-2]).add(i[o-1]),h=$o),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let g=Math.pow(a.distanceToSquared(d),m),v=Math.pow(d.distanceToSquared(f),m),x=Math.pow(f.distanceToSquared(h),m);v<1e-4&&(v=1),g<1e-4&&(g=v),x<1e-4&&(x=v),La.initNonuniformCatmullRom(a.x,d.x,f.x,h.x,g,v,x),Jo.initNonuniformCatmullRom(a.y,d.y,f.y,h.y,g,v,x),Jr.initNonuniformCatmullRom(a.z,d.z,f.z,h.z,g,v,x)}else this.curveType==="catmullrom"&&(La.initCatmullRom(a.x,d.x,f.x,h.x,this.tension),Jo.initCatmullRom(a.y,d.y,f.y,h.y,this.tension),Jr.initCatmullRom(a.z,d.z,f.z,h.z,this.tension));return n.set(La.calc(c),Jo.calc(c),Jr.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new w().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Jc(r,e,t,n,i){const o=.5*(n-e),s=.5*(i-t),a=r*r;return(2*t-2*n+o+s)*(r*a)+(-3*t+3*n-2*o-s)*a+o*r+t}function Ko(r,e,t,n){return function(i,o){const s=1-i;return s*s*o}(r,e)+function(i,o){return 2*(1-i)*i*o}(r,t)+function(i,o){return i*i*o}(r,n)}function Vs(r,e,t,n,i){return function(o,s){const a=1-o;return a*a*a*s}(r,e)+function(o,s){const a=1-o;return 3*a*a*o*s}(r,t)+function(o,s){return 3*(1-o)*o*o*s}(r,n)+function(o,s){return o*o*o*s}(r,i)}ml.prototype.isCatmullRomCurve3=!0;class js extends Vn{constructor(e=new $e,t=new $e,n=new $e,i=new $e){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new $e){const n=t,i=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(Vs(e,i.x,o.x,s.x,a.x),Vs(e,i.y,o.y,s.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}js.prototype.isCubicBezierCurve=!0;class Oa extends Vn{constructor(e=new w,t=new w,n=new w,i=new w){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new w){const n=t,i=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(Vs(e,i.x,o.x,s.x,a.x),Vs(e,i.y,o.y,s.y,a.y),Vs(e,i.z,o.z,s.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Oa.prototype.isCubicBezierCurve3=!0;class Da extends Vn{constructor(e=new $e,t=new $e){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new $e){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new $e;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Da.prototype.isLineCurve=!0;class Rh extends Vn{constructor(e=new w,t=new w){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new w){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Ws extends Vn{constructor(e=new $e,t=new $e,n=new $e){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new $e){const n=t,i=this.v0,o=this.v1,s=this.v2;return n.set(Ko(e,i.x,o.x,s.x),Ko(e,i.y,o.y,s.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Ws.prototype.isQuadraticBezierCurve=!0;class _g extends Vn{constructor(e=new w,t=new w,n=new w){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new w){const n=t,i=this.v0,o=this.v1,s=this.v2;return n.set(Ko(e,i.x,o.x,s.x),Ko(e,i.y,o.y,s.y),Ko(e,i.z,o.z,s.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}_g.prototype.isQuadraticBezierCurve3=!0;class yf extends Vn{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new $e){const n=t,i=this.points,o=(i.length-1)*e,s=Math.floor(o),a=o-s,h=i[s===0?s:s-1],u=i[s],c=i[s>i.length-2?i.length-1:s+1],d=i[s>i.length-3?i.length-1:s+2];return n.set(Jc(a,h.x,u.x,c.x,d.x),Jc(a,h.y,u.y,c.y,d.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new $e().fromArray(i))}return this}}yf.prototype.isSplineCurve=!0;var yg=Object.freeze({__proto__:null,ArcCurve:Nr,CatmullRomCurve3:ml,CubicBezierCurve:js,CubicBezierCurve3:Oa,EllipseCurve:Fn,LineCurve:Da,LineCurve3:Rh,QuadraticBezierCurve:Ws,QuadraticBezierCurve3:_g,SplineCurve:yf});const aw=function(r,e,t=2){const n=e&&e.length,i=n?e[0]*t:r.length;let o=j0(r,0,i,t,!0);const s=[];if(!o||o.next===o.prev)return s;let a,h,u,c,d,f,m;if(n&&(o=function(g,v,x,T){const M=[];let C,D,R,F,O;for(C=0,D=v.length;C<D;C++)R=v[C]*T,F=C<D-1?v[C+1]*T:g.length,O=j0(g,R,F,T,!1),O===O.next&&(O.steiner=!0),M.push(mw(O));for(M.sort(dw),C=0;C<M.length;C++)pw(M[C],x),x=Na(x,x.next);return x}(r,e,o,t)),r.length>80*t){a=u=r[0],h=c=r[1];for(let g=t;g<i;g+=t)d=r[g],f=r[g+1],d<a&&(a=d),f<h&&(h=f),d>u&&(u=d),f>c&&(c=f);m=Math.max(u-a,c-h),m=m!==0?1/m:0}return Kc(o,s,t,a,h,m),s};function j0(r,e,t,n,i){let o,s;if(i===function(a,h,u,c){let d=0;for(let f=h,m=u-c;f<u;f+=c)d+=(a[m]-a[f])*(a[f+1]+a[m+1]),m=f;return d}(r,e,t,n)>0)for(o=e;o<t;o+=n)s=Y0(o,r[o],r[o+1],s);else for(o=t-n;o>=e;o-=n)s=Y0(o,r[o],r[o+1],s);return s&&xf(s,s.next)&&(ed(s),s=s.next),s}function Na(r,e){if(!r)return r;e||(e=r);let t,n=r;do if(t=!1,n.steiner||!xf(n,n.next)&&Kn(n.prev,n,n.next)!==0)n=n.next;else{if(ed(n),n=e=n.prev,n===n.next)break;t=!0}while(t||n!==e);return e}function Kc(r,e,t,n,i,o,s){if(!r)return;!s&&o&&function(c,d,f,m){let g=c;do g.z===null&&(g.z=xg(g.x,g.y,d,f,m)),g.prevZ=g.prev,g.nextZ=g.next,g=g.next;while(g!==c);g.prevZ.nextZ=null,g.prevZ=null,function(v){let x,T,M,C,D,R,F,O,U=1;do{for(T=v,v=null,D=null,R=0;T;){for(R++,M=T,F=0,x=0;x<U&&(F++,M=M.nextZ,M);x++);for(O=U;F>0||O>0&&M;)F!==0&&(O===0||!M||T.z<=M.z)?(C=T,T=T.nextZ,F--):(C=M,M=M.nextZ,O--),D?D.nextZ=C:v=C,C.prevZ=D,D=C;T=M}D.nextZ=null,U*=2}while(R>1)}(g)}(r,n,i,o);let a,h,u=r;for(;r.prev!==r.next;)if(a=r.prev,h=r.next,o?uw(r,n,i,o):hw(r))e.push(a.i/t),e.push(r.i/t),e.push(h.i/t),ed(r),r=h.next,u=h.next;else if((r=h)===u){s?s===1?Kc(r=lw(Na(r),e,t),e,t,n,i,o,2):s===2&&cw(r,e,t,n,i,o):Kc(Na(r),e,t,n,i,o,1);break}}function hw(r){const e=r.prev,t=r,n=r.next;if(Kn(e,t,n)>=0)return!1;let i=r.next.next;for(;i!==r.prev;){if(gl(e.x,e.y,t.x,t.y,n.x,n.y,i.x,i.y)&&Kn(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function uw(r,e,t,n){const i=r.prev,o=r,s=r.next;if(Kn(i,o,s)>=0)return!1;const a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,h=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,u=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,c=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,d=xg(a,h,e,t,n),f=xg(u,c,e,t,n);let m=r.prevZ,g=r.nextZ;for(;m&&m.z>=d&&g&&g.z<=f;){if(m!==r.prev&&m!==r.next&&gl(i.x,i.y,o.x,o.y,s.x,s.y,m.x,m.y)&&Kn(m.prev,m,m.next)>=0||(m=m.prevZ,g!==r.prev&&g!==r.next&&gl(i.x,i.y,o.x,o.y,s.x,s.y,g.x,g.y)&&Kn(g.prev,g,g.next)>=0))return!1;g=g.nextZ}for(;m&&m.z>=d;){if(m!==r.prev&&m!==r.next&&gl(i.x,i.y,o.x,o.y,s.x,s.y,m.x,m.y)&&Kn(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;g&&g.z<=f;){if(g!==r.prev&&g!==r.next&&gl(i.x,i.y,o.x,o.y,s.x,s.y,g.x,g.y)&&Kn(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function lw(r,e,t){let n=r;do{const i=n.prev,o=n.next.next;!xf(i,o)&&W0(i,n,n.next,o)&&Qc(i,o)&&Qc(o,i)&&(e.push(i.i/t),e.push(n.i/t),e.push(o.i/t),ed(n),ed(n.next),n=r=o),n=n.next}while(n!==r);return Na(n)}function cw(r,e,t,n,i,o){let s=r;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&gw(s,a)){let h=X0(s,a);return s=Na(s,s.next),h=Na(h,h.next),Kc(s,e,t,n,i,o),void Kc(h,e,t,n,i,o)}a=a.next}s=s.next}while(s!==r)}function dw(r,e){return r.x-e.x}function pw(r,e){if(e=function(t,n){let i=n;const o=t.x,s=t.y;let a,h=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){const g=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(g<=o&&g>h){if(h=g,g===o){if(s===i.y)return i;if(s===i.next.y)return i.next}a=i.x<i.next.x?i:i.next}}i=i.next}while(i!==n);if(!a)return null;if(o===h)return a;const u=a,c=a.x,d=a.y;let f,m=1/0;i=a;do o>=i.x&&i.x>=c&&o!==i.x&&gl(s<d?o:h,s,c,d,s<d?h:o,s,i.x,i.y)&&(f=Math.abs(s-i.y)/(o-i.x),Qc(i,t)&&(f<m||f===m&&(i.x>a.x||i.x===a.x&&fw(a,i)))&&(a=i,m=f)),i=i.next;while(i!==u);return a}(r,e)){const t=X0(e,r);Na(e,e.next),Na(t,t.next)}}function fw(r,e){return Kn(r.prev,r,e.prev)<0&&Kn(e.next,r,r.next)<0}function xg(r,e,t,n,i){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-t)*i)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function mw(r){let e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function gl(r,e,t,n,i,o,s,a){return(i-s)*(e-a)-(r-s)*(o-a)>=0&&(r-s)*(n-a)-(t-s)*(e-a)>=0&&(t-s)*(o-a)-(i-s)*(n-a)>=0}function gw(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(t,n){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==n.i&&i.next.i!==n.i&&W0(i,i.next,t,n))return!0;i=i.next}while(i!==t);return!1}(r,e)&&(Qc(r,e)&&Qc(e,r)&&function(t,n){let i=t,o=!1;const s=(t.x+n.x)/2,a=(t.y+n.y)/2;do i.y>a!=i.next.y>a&&i.next.y!==i.y&&s<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(o=!o),i=i.next;while(i!==t);return o}(r,e)&&(Kn(r.prev,r,e.prev)||Kn(r,e.prev,e))||xf(r,e)&&Kn(r.prev,r,r.next)>0&&Kn(e.prev,e,e.next)>0)}function Kn(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function xf(r,e){return r.x===e.x&&r.y===e.y}function W0(r,e,t,n){const i=wf(Kn(r,e,t)),o=wf(Kn(r,e,n)),s=wf(Kn(t,n,r)),a=wf(Kn(t,n,e));return i!==o&&s!==a||!(i!==0||!bf(r,t,e))||!(o!==0||!bf(r,n,e))||!(s!==0||!bf(t,r,n))||!(a!==0||!bf(t,e,n))}function bf(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function wf(r){return r>0?1:r<0?-1:0}function Qc(r,e){return Kn(r.prev,r,r.next)<0?Kn(r,e,r.next)>=0&&Kn(r,r.prev,e)>=0:Kn(r,e,r.prev)<0||Kn(r,r.next,e)<0}function X0(r,e){const t=new bg(r.i,r.x,r.y),n=new bg(e.i,e.x,e.y),i=r.next,o=e.prev;return r.next=e,e.prev=r,t.next=i,i.prev=t,n.next=t,t.prev=n,o.next=n,n.prev=o,n}function Y0(r,e,t,n){const i=new bg(r,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function ed(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function bg(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Qo{static area(e){const t=e.length;let n=0;for(let i=t-1,o=0;o<t;i=o++)n+=e[i].x*e[o].y-e[o].x*e[i].y;return .5*n}static isClockWise(e){return Qo.area(e)<0}static triangulateShape(e,t){const n=[],i=[],o=[];q0(e),Z0(n,e);let s=e.length;t.forEach(q0);for(let h=0;h<t.length;h++)i.push(s),s+=t[h].length,Z0(n,t[h]);const a=aw(n,i);for(let h=0;h<a.length;h+=3)o.push(a.slice(h,h+3));return o}}function q0(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function Z0(r,e){for(let t=0;t<e.length;t++)r.push(e[t].x),r.push(e[t].y)}class bo extends St{constructor(e,t){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],o=[];for(let a=0,h=e.length;a<h;a++)s(e[a]);function s(a){const h=[],u=t.curveSegments!==void 0?t.curveSegments:12,c=t.steps!==void 0?t.steps:1;let d=t.depth!==void 0?t.depth:100,f=t.bevelEnabled===void 0||t.bevelEnabled,m=t.bevelThickness!==void 0?t.bevelThickness:6,g=t.bevelSize!==void 0?t.bevelSize:m-2,v=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3;const T=t.extrudePath,M=t.UVGenerator!==void 0?t.UVGenerator:vw;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),d=t.amount);let C,D,R,F,O,U=!1;T&&(C=T.getSpacedPoints(c),U=!0,f=!1,D=T.computeFrenetFrames(c,!1),R=new w,F=new w,O=new w),f||(x=0,m=0,g=0,v=0);const he=a.extractPoints(u);let Q=he.shape;const X=he.holes;if(!Qo.isClockWise(Q)){Q=Q.reverse();for(let ge=0,W=X.length;ge<W;ge++){const de=X[ge];Qo.isClockWise(de)&&(X[ge]=de.reverse())}}const Z=Qo.triangulateShape(Q,X),q=Q;for(let ge=0,W=X.length;ge<W;ge++){const de=X[ge];Q=Q.concat(de)}function oe(ge,W,de){return W||console.error("THREE.ExtrudeGeometry: vec does not exist"),W.clone().multiplyScalar(de).add(ge)}const fe=Q.length,me=Z.length;function le(ge,W,de){let _e,ye,Oe;const ht=ge.x-W.x,_t=ge.y-W.y,gt=de.x-ge.x,Ut=de.y-ge.y,Vt=ht*ht+_t*_t,ii=ht*Ut-_t*gt;if(Math.abs(ii)>Number.EPSILON){const An=Math.sqrt(Vt),Ro=Math.sqrt(gt*gt+Ut*Ut),Wd=W.x-_t/An,Xd=W.y+ht/An,Yd=((de.x-Ut/Ro-Wd)*Ut-(de.y+gt/Ro-Xd)*gt)/(ht*Ut-_t*gt);_e=Wd+ht*Yd-ge.x,ye=Xd+_t*Yd-ge.y;const hr=_e*_e+ye*ye;if(hr<=2)return new $e(_e,ye);Oe=Math.sqrt(hr/2)}else{let An=!1;ht>Number.EPSILON?gt>Number.EPSILON&&(An=!0):ht<-Number.EPSILON?gt<-Number.EPSILON&&(An=!0):Math.sign(_t)===Math.sign(Ut)&&(An=!0),An?(_e=-_t,ye=ht,Oe=Math.sqrt(Vt)):(_e=ht,ye=_t,Oe=Math.sqrt(Vt/2))}return new $e(_e/Oe,ye/Oe)}const pe=[];for(let ge=0,W=q.length,de=W-1,_e=ge+1;ge<W;ge++,de++,_e++)de===W&&(de=0),_e===W&&(_e=0),pe[ge]=le(q[ge],q[de],q[_e]);const Pe=[];let Ue,Fe=pe.concat();for(let ge=0,W=X.length;ge<W;ge++){const de=X[ge];Ue=[];for(let _e=0,ye=de.length,Oe=ye-1,ht=_e+1;_e<ye;_e++,Oe++,ht++)Oe===ye&&(Oe=0),ht===ye&&(ht=0),Ue[_e]=le(de[_e],de[Oe],de[ht]);Pe.push(Ue),Fe=Fe.concat(Ue)}for(let ge=0;ge<x;ge++){const W=ge/x,de=m*Math.cos(W*Math.PI/2),_e=g*Math.sin(W*Math.PI/2)+v;for(let ye=0,Oe=q.length;ye<Oe;ye++){const ht=oe(q[ye],pe[ye],_e);Me(ht.x,ht.y,-de)}for(let ye=0,Oe=X.length;ye<Oe;ye++){const ht=X[ye];Ue=Pe[ye];for(let _t=0,gt=ht.length;_t<gt;_t++){const Ut=oe(ht[_t],Ue[_t],_e);Me(Ut.x,Ut.y,-de)}}}const Y=g+v;for(let ge=0;ge<fe;ge++){const W=f?oe(Q[ge],Fe[ge],Y):Q[ge];U?(F.copy(D.normals[0]).multiplyScalar(W.x),R.copy(D.binormals[0]).multiplyScalar(W.y),O.copy(C[0]).add(F).add(R),Me(O.x,O.y,O.z)):Me(W.x,W.y,0)}for(let ge=1;ge<=c;ge++)for(let W=0;W<fe;W++){const de=f?oe(Q[W],Fe[W],Y):Q[W];U?(F.copy(D.normals[ge]).multiplyScalar(de.x),R.copy(D.binormals[ge]).multiplyScalar(de.y),O.copy(C[ge]).add(F).add(R),Me(O.x,O.y,O.z)):Me(de.x,de.y,d/c*ge)}for(let ge=x-1;ge>=0;ge--){const W=ge/x,de=m*Math.cos(W*Math.PI/2),_e=g*Math.sin(W*Math.PI/2)+v;for(let ye=0,Oe=q.length;ye<Oe;ye++){const ht=oe(q[ye],pe[ye],_e);Me(ht.x,ht.y,d+de)}for(let ye=0,Oe=X.length;ye<Oe;ye++){const ht=X[ye];Ue=Pe[ye];for(let _t=0,gt=ht.length;_t<gt;_t++){const Ut=oe(ht[_t],Ue[_t],_e);U?Me(Ut.x,Ut.y+C[c-1].y,C[c-1].x+de):Me(Ut.x,Ut.y,d+de)}}}function $(ge,W){let de=ge.length;for(;--de>=0;){const _e=de;let ye=de-1;ye<0&&(ye=ge.length-1);for(let Oe=0,ht=c+2*x;Oe<ht;Oe++){const _t=fe*Oe,gt=fe*(Oe+1);we(W+_e+_t,W+ye+_t,W+ye+gt,W+_e+gt)}}}function Me(ge,W,de){h.push(ge),h.push(W),h.push(de)}function De(ge,W,de){ke(ge),ke(W),ke(de);const _e=i.length/3,ye=M.generateTopUV(n,i,_e-3,_e-2,_e-1);We(ye[0]),We(ye[1]),We(ye[2])}function we(ge,W,de,_e){ke(ge),ke(W),ke(_e),ke(W),ke(de),ke(_e);const ye=i.length/3,Oe=M.generateSideWallUV(n,i,ye-6,ye-3,ye-2,ye-1);We(Oe[0]),We(Oe[1]),We(Oe[3]),We(Oe[1]),We(Oe[2]),We(Oe[3])}function ke(ge){i.push(h[3*ge+0]),i.push(h[3*ge+1]),i.push(h[3*ge+2])}function We(ge){o.push(ge.x),o.push(ge.y)}(function(){const ge=i.length/3;if(f){let W=0,de=fe*W;for(let _e=0;_e<me;_e++){const ye=Z[_e];De(ye[2]+de,ye[1]+de,ye[0]+de)}W=c+2*x,de=fe*W;for(let _e=0;_e<me;_e++){const ye=Z[_e];De(ye[0]+de,ye[1]+de,ye[2]+de)}}else{for(let W=0;W<me;W++){const de=Z[W];De(de[2],de[1],de[0])}for(let W=0;W<me;W++){const de=Z[W];De(de[0]+fe*c,de[1]+fe*c,de[2]+fe*c)}}n.addGroup(ge,i.length/3-ge,0)})(),function(){const ge=i.length/3;let W=0;$(q,W),W+=q.length;for(let de=0,_e=X.length;de<_e;de++){const ye=X[de];$(ye,W),W+=ye.length}n.addGroup(ge,i.length/3-ge,1)}()}this.setAttribute("position",new rt(i,3)),this.setAttribute("uv",new rt(o,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(t,n,i){if(i.shapes=[],Array.isArray(t))for(let o=0,s=t.length;o<s;o++){const a=t[o];i.shapes.push(a.uuid)}else i.shapes.push(t.uuid);return n.extrudePath!==void 0&&(i.options.extrudePath=n.extrudePath.toJSON()),i}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let o=0,s=e.shapes.length;o<s;o++){const a=t[e.shapes[o]];n.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new yg[i.type]().fromJSON(i)),new bo(n,e.options)}}const vw={generateTopUV:function(r,e,t,n,i){const o=e[3*t],s=e[3*t+1],a=e[3*n],h=e[3*n+1],u=e[3*i],c=e[3*i+1];return[new $e(o,s),new $e(a,h),new $e(u,c)]},generateSideWallUV:function(r,e,t,n,i,o){const s=e[3*t],a=e[3*t+1],h=e[3*t+2],u=e[3*n],c=e[3*n+1],d=e[3*n+2],f=e[3*i],m=e[3*i+1],g=e[3*i+2],v=e[3*o],x=e[3*o+1],T=e[3*o+2];return Math.abs(a-c)<Math.abs(s-u)?[new $e(s,1-h),new $e(u,1-d),new $e(f,1-g),new $e(v,1-T)]:[new $e(a,1-h),new $e(c,1-d),new $e(m,1-g),new $e(x,1-T)]}};class vl extends wt{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new vl(e.radius,e.detail)}}class _l extends St{constructor(e,t=12,n=0,i=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=xi(i,0,2*Math.PI);const o=[],s=[],a=[],h=1/t,u=new w,c=new $e;for(let d=0;d<=t;d++){const f=n+d*h*i,m=Math.sin(f),g=Math.cos(f);for(let v=0;v<=e.length-1;v++)u.x=e[v].x*m,u.y=e[v].y,u.z=e[v].x*g,s.push(u.x,u.y,u.z),c.x=d/t,c.y=v/(e.length-1),a.push(c.x,c.y)}for(let d=0;d<t;d++)for(let f=0;f<e.length-1;f++){const m=f+d*e.length,g=m,v=m+e.length,x=m+e.length+1,T=m+1;o.push(g,v,T),o.push(v,x,T)}if(this.setIndex(o),this.setAttribute("position",new rt(s,3)),this.setAttribute("uv",new rt(a,2)),this.computeVertexNormals(),i===2*Math.PI){const d=this.attributes.normal.array,f=new w,m=new w,g=new w,v=t*e.length*3;for(let x=0,T=0;x<e.length;x++,T+=3)f.x=d[T+0],f.y=d[T+1],f.z=d[T+2],m.x=d[v+T+0],m.y=d[v+T+1],m.z=d[v+T+2],g.addVectors(f,m).normalize(),d[T+0]=d[v+T+0]=g.x,d[T+1]=d[v+T+1]=g.y,d[T+2]=d[v+T+2]=g.z}}static fromJSON(e){return new _l(e.points,e.segments,e.phiStart,e.phiLength)}}class Ch extends wt{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ch(e.radius,e.detail)}}class td extends St{constructor(e,t,n){super(),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};const i=[],o=[],s=[],a=[],h=1e-5,u=new w,c=new w,d=new w,f=new w,m=new w;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const g=t+1;for(let v=0;v<=n;v++){const x=v/n;for(let T=0;T<=t;T++){const M=T/t;e(M,x,c),o.push(c.x,c.y,c.z),M-h>=0?(e(M-h,x,d),f.subVectors(c,d)):(e(M+h,x,d),f.subVectors(d,c)),x-h>=0?(e(M,x-h,d),m.subVectors(c,d)):(e(M,x+h,d),m.subVectors(d,c)),u.crossVectors(f,m).normalize(),s.push(u.x,u.y,u.z),a.push(M,x)}}for(let v=0;v<n;v++)for(let x=0;x<t;x++){const T=v*g+x,M=v*g+x+1,C=(v+1)*g+x+1,D=(v+1)*g+x;i.push(T,M,D),i.push(M,C,D)}this.setIndex(i),this.setAttribute("position",new rt(o,3)),this.setAttribute("normal",new rt(s,3)),this.setAttribute("uv",new rt(a,2))}}class yl extends St{constructor(e=.5,t=1,n=8,i=1,o=0,s=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:o,thetaLength:s},n=Math.max(3,n);const a=[],h=[],u=[],c=[];let d=e;const f=(t-e)/(i=Math.max(1,i)),m=new w,g=new $e;for(let v=0;v<=i;v++){for(let x=0;x<=n;x++){const T=o+x/n*s;m.x=d*Math.cos(T),m.y=d*Math.sin(T),h.push(m.x,m.y,m.z),u.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,c.push(g.x,g.y)}d+=f}for(let v=0;v<i;v++){const x=v*(n+1);for(let T=0;T<n;T++){const M=T+x,C=M,D=M+n+1,R=M+n+2,F=M+1;a.push(C,D,F),a.push(D,R,F)}}this.setIndex(a),this.setAttribute("position",new rt(h,3)),this.setAttribute("normal",new rt(u,3)),this.setAttribute("uv",new rt(c,2))}static fromJSON(e){return new yl(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Ih extends St{constructor(e,t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],o=[],s=[];let a=0,h=0;if(Array.isArray(e)===!1)u(e);else for(let c=0;c<e.length;c++)u(e[c]),this.addGroup(a,h,c),a+=h,h=0;function u(c){const d=i.length/3,f=c.extractPoints(t);let m=f.shape;const g=f.holes;Qo.isClockWise(m)===!1&&(m=m.reverse());for(let x=0,T=g.length;x<T;x++){const M=g[x];Qo.isClockWise(M)===!0&&(g[x]=M.reverse())}const v=Qo.triangulateShape(m,g);for(let x=0,T=g.length;x<T;x++){const M=g[x];m=m.concat(M)}for(let x=0,T=m.length;x<T;x++){const M=m[x];i.push(M.x,M.y,0),o.push(0,0,1),s.push(M.x,M.y)}for(let x=0,T=v.length;x<T;x++){const M=v[x],C=M[0]+d,D=M[1]+d,R=M[2]+d;n.push(C,D,R),h+=3}}this.setIndex(n),this.setAttribute("position",new rt(i,3)),this.setAttribute("normal",new rt(o,3)),this.setAttribute("uv",new rt(s,2))}toJSON(){const e=super.toJSON();return function(t,n){if(n.shapes=[],Array.isArray(t))for(let i=0,o=t.length;i<o;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let i=0,o=e.shapes.length;i<o;i++){const s=t[e.shapes[i]];n.push(s)}return new Ih(n,e.curveSegments)}}class Lh extends St{constructor(e=1,t=8,n=6,i=0,o=2*Math.PI,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:o,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const h=Math.min(s+a,Math.PI);let u=0;const c=[],d=new w,f=new w,m=[],g=[],v=[],x=[];for(let T=0;T<=n;T++){const M=[],C=T/n;let D=0;T==0&&s==0?D=.5/t:T==n&&h==Math.PI&&(D=-.5/t);for(let R=0;R<=t;R++){const F=R/t;d.x=-e*Math.cos(i+F*o)*Math.sin(s+C*a),d.y=e*Math.cos(s+C*a),d.z=e*Math.sin(i+F*o)*Math.sin(s+C*a),g.push(d.x,d.y,d.z),f.copy(d).normalize(),v.push(f.x,f.y,f.z),x.push(F+D,1-C),M.push(u++)}c.push(M)}for(let T=0;T<n;T++)for(let M=0;M<t;M++){const C=c[T][M+1],D=c[T][M],R=c[T+1][M],F=c[T+1][M+1];(T!==0||s>0)&&m.push(C,D,F),(T!==n-1||h<Math.PI)&&m.push(D,R,F)}this.setIndex(m),this.setAttribute("position",new rt(g,3)),this.setAttribute("normal",new rt(v,3)),this.setAttribute("uv",new rt(x,2))}static fromJSON(e){return new Lh(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class xl extends wt{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new xl(e.radius,e.detail)}}class Tf extends bo{constructor(e,t={}){const n=t.font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new St;const i=n.generateShapes(e,t.size);t.depth=t.height!==void 0?t.height:50,t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),super(i,t),this.type="TextGeometry"}}class bl extends St{constructor(e=1,t=.4,n=8,i=6,o=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:o},n=Math.floor(n),i=Math.floor(i);const s=[],a=[],h=[],u=[],c=new w,d=new w,f=new w;for(let m=0;m<=n;m++)for(let g=0;g<=i;g++){const v=g/i*o,x=m/n*Math.PI*2;d.x=(e+t*Math.cos(x))*Math.cos(v),d.y=(e+t*Math.cos(x))*Math.sin(v),d.z=t*Math.sin(x),a.push(d.x,d.y,d.z),c.x=e*Math.cos(v),c.y=e*Math.sin(v),f.subVectors(d,c).normalize(),h.push(f.x,f.y,f.z),u.push(g/i),u.push(m/n)}for(let m=1;m<=n;m++)for(let g=1;g<=i;g++){const v=(i+1)*m+g-1,x=(i+1)*(m-1)+g-1,T=(i+1)*(m-1)+g,M=(i+1)*m+g;s.push(v,x,M),s.push(x,T,M)}this.setIndex(s),this.setAttribute("position",new rt(a,3)),this.setAttribute("normal",new rt(h,3)),this.setAttribute("uv",new rt(u,2))}static fromJSON(e){return new bl(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class wl extends St{constructor(e=1,t=.4,n=64,i=8,o=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:o,q:s},n=Math.floor(n),i=Math.floor(i);const a=[],h=[],u=[],c=[],d=new w,f=new w,m=new w,g=new w,v=new w,x=new w,T=new w;for(let C=0;C<=n;++C){const D=C/n*o*Math.PI*2;M(D,o,s,e,m),M(D+.01,o,s,e,g),x.subVectors(g,m),T.addVectors(g,m),v.crossVectors(x,T),T.crossVectors(v,x),v.normalize(),T.normalize();for(let R=0;R<=i;++R){const F=R/i*Math.PI*2,O=-t*Math.cos(F),U=t*Math.sin(F);d.x=m.x+(O*T.x+U*v.x),d.y=m.y+(O*T.y+U*v.y),d.z=m.z+(O*T.z+U*v.z),h.push(d.x,d.y,d.z),f.subVectors(d,m).normalize(),u.push(f.x,f.y,f.z),c.push(C/n),c.push(R/i)}}for(let C=1;C<=n;C++)for(let D=1;D<=i;D++){const R=(i+1)*(C-1)+(D-1),F=(i+1)*C+(D-1),O=(i+1)*C+D,U=(i+1)*(C-1)+D;a.push(R,F,U),a.push(F,O,U)}function M(C,D,R,F,O){const U=Math.cos(C),he=Math.sin(C),Q=R/D*C,X=Math.cos(Q);O.x=F*(2+X)*.5*U,O.y=F*(2+X)*he*.5,O.z=F*Math.sin(Q)*.5}this.setIndex(a),this.setAttribute("position",new rt(h,3)),this.setAttribute("normal",new rt(u,3)),this.setAttribute("uv",new rt(c,2))}static fromJSON(e){return new wl(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Tl extends St{constructor(e,t=64,n=1,i=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:o};const s=e.computeFrenetFrames(t,o);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const a=new w,h=new w,u=new $e;let c=new w;const d=[],f=[],m=[],g=[];function v(x){c=e.getPointAt(x/t,c);const T=s.normals[x],M=s.binormals[x];for(let C=0;C<=i;C++){const D=C/i*Math.PI*2,R=Math.sin(D),F=-Math.cos(D);h.x=F*T.x+R*M.x,h.y=F*T.y+R*M.y,h.z=F*T.z+R*M.z,h.normalize(),f.push(h.x,h.y,h.z),a.x=c.x+n*h.x,a.y=c.y+n*h.y,a.z=c.z+n*h.z,d.push(a.x,a.y,a.z)}}(function(){for(let x=0;x<t;x++)v(x);v(o===!1?t:0),function(){for(let x=0;x<=t;x++)for(let T=0;T<=i;T++)u.x=x/t,u.y=T/i,m.push(u.x,u.y)}(),function(){for(let x=1;x<=t;x++)for(let T=1;T<=i;T++){const M=(i+1)*(x-1)+(T-1),C=(i+1)*x+(T-1),D=(i+1)*x+T,R=(i+1)*(x-1)+T;g.push(M,C,R),g.push(C,D,R)}}()})(),this.setIndex(g),this.setAttribute("position",new rt(d,3)),this.setAttribute("normal",new rt(f,3)),this.setAttribute("uv",new rt(m,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Tl(new yg[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class wg extends St{constructor(e){if(super(),this.type="WireframeGeometry",e.isGeometry===!0)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const t=[],n=[0,0],i={},o=new w;if(e.index!==null){const s=e.attributes.position,a=e.index;let h=e.groups;h.length===0&&(h=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,c=h.length;u<c;++u){const d=h[u],f=d.start;for(let m=f,g=f+d.count;m<g;m+=3)for(let v=0;v<3;v++){const x=a.getX(m+v),T=a.getX(m+(v+1)%3);n[0]=Math.min(x,T),n[1]=Math.max(x,T);const M=n[0]+","+n[1];i[M]===void 0&&(i[M]={index1:n[0],index2:n[1]})}}for(const u in i){const c=i[u];o.fromBufferAttribute(s,c.index1),t.push(o.x,o.y,o.z),o.fromBufferAttribute(s,c.index2),t.push(o.x,o.y,o.z)}}else{const s=e.attributes.position;for(let a=0,h=s.count/3;a<h;a++)for(let u=0;u<3;u++){const c=3*a+u;o.fromBufferAttribute(s,c),t.push(o.x,o.y,o.z);const d=3*a+(u+1)%3;o.fromBufferAttribute(s,d),t.push(o.x,o.y,o.z)}}this.setAttribute("position",new rt(t,3))}}var $0=Object.freeze({__proto__:null,BoxGeometry:Yr,BoxBufferGeometry:Yr,CircleGeometry:Qe,CircleBufferGeometry:Qe,ConeGeometry:pt,ConeBufferGeometry:pt,CylinderGeometry:Tt,CylinderBufferGeometry:Tt,DodecahedronGeometry:Rt,DodecahedronBufferGeometry:Rt,EdgesGeometry:wi,ExtrudeGeometry:bo,ExtrudeBufferGeometry:bo,IcosahedronGeometry:vl,IcosahedronBufferGeometry:vl,LatheGeometry:_l,LatheBufferGeometry:_l,OctahedronGeometry:Ch,OctahedronBufferGeometry:Ch,ParametricGeometry:td,ParametricBufferGeometry:td,PlaneGeometry:Pi,PlaneBufferGeometry:Pi,PolyhedronGeometry:wt,PolyhedronBufferGeometry:wt,RingGeometry:yl,RingBufferGeometry:yl,ShapeGeometry:Ih,ShapeBufferGeometry:Ih,SphereGeometry:Lh,SphereBufferGeometry:Lh,TetrahedronGeometry:xl,TetrahedronBufferGeometry:xl,TextGeometry:Tf,TextBufferGeometry:Tf,TorusGeometry:bl,TorusBufferGeometry:bl,TorusKnotGeometry:wl,TorusKnotBufferGeometry:wl,TubeGeometry:Tl,TubeBufferGeometry:Tl,WireframeGeometry:wg});class Tg extends fi{constructor(e){super(),this.type="ShadowMaterial",this.color=new ft(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}Tg.prototype.isShadowMaterial=!0;class Sl extends Ni{constructor(e){super(e),this.type="RawShaderMaterial"}}Sl.prototype.isRawShaderMaterial=!0;class Sf extends fi{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ft(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ur,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this}}Sf.prototype.isMeshStandardMaterial=!0;class Sg extends Sf{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new $e(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(t){this.reflectivity=xi(2.5*(t-1)/(t+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new ft(1,1,1),this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new ft).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this}}Sg.prototype.isMeshPhysicalMaterial=!0;class Ef extends fi{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new ft(16777215),this.specular=new ft(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ur,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ja,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}Ef.prototype.isMeshPhongMaterial=!0;class Eg extends fi{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ft(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ur,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}Eg.prototype.isMeshToonMaterial=!0;class Mg extends fi{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ur,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}Mg.prototype.isMeshNormalMaterial=!0;class Mf extends fi{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ja,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}Mf.prototype.isMeshLambertMaterial=!0;class Ag extends fi{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ft(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ur,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}Ag.prototype.isMeshMatcapMaterial=!0;class Pg extends gi{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}Pg.prototype.isLineDashedMaterial=!0;var _w=Object.freeze({__proto__:null,ShadowMaterial:Tg,SpriteMaterial:Th,RawShaderMaterial:Sl,ShaderMaterial:Ni,PointsMaterial:H,MeshPhysicalMaterial:Sg,MeshStandardMaterial:Sf,MeshPhongMaterial:Ef,MeshToonMaterial:Eg,MeshNormalMaterial:Mg,MeshLambertMaterial:Mf,MeshDepthMaterial:nn,MeshDistanceMaterial:il,MeshBasicMaterial:Zn,MeshMatcapMaterial:Ag,LineDashedMaterial:Pg,LineBasicMaterial:gi,Material:fi});const Bn={arraySlice:function(r,e,t){return Bn.isTypedArray(r)?new r.constructor(r.subarray(e,t!==void 0?t:r.length)):r.slice(e,t)},convertArray:function(r,e,t){return!r||!t&&r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)},isTypedArray:function(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)},getKeyframeOrder:function(r){const e=r.length,t=new Array(e);for(let n=0;n!==e;++n)t[n]=n;return t.sort(function(n,i){return r[n]-r[i]}),t},sortedArray:function(r,e,t){const n=r.length,i=new r.constructor(n);for(let o=0,s=0;s!==n;++o){const a=t[o]*e;for(let h=0;h!==e;++h)i[s++]=r[a+h]}return i},flattenJSON:function(r,e,t,n){let i=1,o=r[0];for(;o!==void 0&&o[n]===void 0;)o=r[i++];if(o===void 0)return;let s=o[n];if(s!==void 0)if(Array.isArray(s))do s=o[n],s!==void 0&&(e.push(o.time),t.push.apply(t,s)),o=r[i++];while(o!==void 0);else if(s.toArray!==void 0)do s=o[n],s!==void 0&&(e.push(o.time),s.toArray(t,t.length)),o=r[i++];while(o!==void 0);else do s=o[n],s!==void 0&&(e.push(o.time),t.push(s)),o=r[i++];while(o!==void 0)},subclip:function(r,e,t,n,i=30){const o=r.clone();o.name=e;const s=[];for(let h=0;h<o.tracks.length;++h){const u=o.tracks[h],c=u.getValueSize(),d=[],f=[];for(let m=0;m<u.times.length;++m){const g=u.times[m]*i;if(!(g<t||g>=n)){d.push(u.times[m]);for(let v=0;v<c;++v)f.push(u.values[m*c+v])}}d.length!==0&&(u.times=Bn.convertArray(d,u.times.constructor),u.values=Bn.convertArray(f,u.values.constructor),s.push(u))}o.tracks=s;let a=1/0;for(let h=0;h<o.tracks.length;++h)a>o.tracks[h].times[0]&&(a=o.tracks[h].times[0]);for(let h=0;h<o.tracks.length;++h)o.tracks[h].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(r,e=0,t=r,n=30){n<=0&&(n=30);const i=t.tracks.length,o=e/n;for(let s=0;s<i;++s){const a=t.tracks[s],h=a.ValueTypeName;if(h==="bool"||h==="string")continue;const u=r.tracks.find(function(T){return T.name===a.name&&T.ValueTypeName===h});if(u===void 0)continue;let c=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=d/3);let f=0;const m=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=m/3);const g=a.times.length-1;let v;if(o<=a.times[0]){const T=c,M=d-c;v=Bn.arraySlice(a.values,T,M)}else if(o>=a.times[g]){const T=g*d+c,M=T+d-c;v=Bn.arraySlice(a.values,T,M)}else{const T=a.createInterpolant(),M=c,C=d-c;T.evaluate(o),v=Bn.arraySlice(T.resultBuffer,M,C)}h==="quaternion"&&new pi().fromArray(v).normalize().conjugate().toArray(v);const x=u.times.length;for(let T=0;T<x;++T){const M=T*m+f;if(h==="quaternion")pi.multiplyQuaternionsFlat(u.values,M,v,0,u.values,M);else{const C=m-2*f;for(let D=0;D<C;++D)u.values[M+D]-=v[D]}}}return r.blendMode=be,r}};class Xs{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],o=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let a=n+2;;){if(i===void 0){if(e<o)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,o)}if(n===a)break;if(o=i,i=t[++n],e<i)break t}s=t.length;break n}if(e>=o)break e;{const a=t[1];e<a&&(n=2,o=a);for(let h=n-2;;){if(o===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===h)break;if(i=o,o=t[--n-1],e>=o)break t}s=n,n=0}}for(;n<s;){const a=n+s>>>1;e<t[a]?s=a:n=a+1}if(i=t[n],o=t[n-1],o===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(i===void 0)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,o,e)}this._cachedIndex=n,this.intervalChanged_(n,o,i)}return this.interpolate_(n,o,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,o=e*i;for(let s=0;s!==i;++s)t[s]=n[o+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Xs.prototype.beforeStart_=Xs.prototype.copySampleValue_,Xs.prototype.afterEnd_=Xs.prototype.copySampleValue_;class J0 extends Xs{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:_i,endingEnd:_i}}intervalChanged_(e,t,n){const i=this.parameterPositions;let o=e-2,s=e+1,a=i[o],h=i[s];if(a===void 0)switch(this.getSettings_().endingStart){case Bo:o=e,a=2*t-n;break;case eh:o=i.length-2,a=t+i[o]-i[o+1];break;default:o=e,a=n}if(h===void 0)switch(this.getSettings_().endingEnd){case Bo:s=e,h=2*n-t;break;case eh:s=1,h=n+i[1]-i[0];break;default:s=e-1,h=t}const u=.5*(n-t),c=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(h-n),this._offsetPrev=o*c,this._offsetNext=s*c}interpolate_(e,t,n,i){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,h=e*a,u=h-a,c=this._offsetPrev,d=this._offsetNext,f=this._weightPrev,m=this._weightNext,g=(n-t)/(i-t),v=g*g,x=v*g,T=-f*x+2*f*v-f*g,M=(1+f)*x+(-1.5-2*f)*v+(-.5+f)*g+1,C=(-1-m)*x+(1.5+m)*v+.5*g,D=m*x-m*v;for(let R=0;R!==a;++R)o[R]=T*s[c+R]+M*s[u+R]+C*s[h+R]+D*s[d+R];return o}}class Rg extends Xs{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,h=e*a,u=h-a,c=(n-t)/(i-t),d=1-c;for(let f=0;f!==a;++f)o[f]=s[u+f]*d+s[h+f]*c;return o}}class K0 extends Xs{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class wo{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Bn.convertArray(t,this.TimeBufferType),this.values=Bn.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Bn.convertArray(e.times,Array),values:Bn.convertArray(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new K0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Rg(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new J0(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Fo:t=this.InterpolantFactoryMethodDiscrete;break;case Qa:t=this.InterpolantFactoryMethodLinear;break;case ho:t=this.InterpolantFactoryMethodSmooth}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Fo;case this.InterpolantFactoryMethodLinear:return Qa;case this.InterpolantFactoryMethodSmooth:return ho}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let o=0,s=i-1;for(;o!==i&&n[o]<e;)++o;for(;s!==-1&&n[s]>t;)--s;if(++s,o!==0||s!==i){o>=s&&(s=Math.max(s,1),o=s-1);const a=this.getValueSize();this.times=Bn.arraySlice(n,o,s),this.values=Bn.arraySlice(this.values,o*a,s*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,o=n.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==o;a++){const h=n[a];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,h),e=!1;break}if(s!==null&&s>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,h,s),e=!1;break}s=h}if(i!==void 0&&Bn.isTypedArray(i))for(let a=0,h=i.length;a!==h;++a){const u=i[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=Bn.arraySlice(this.times),t=Bn.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===ho,o=e.length-1;let s=1;for(let a=1;a<o;++a){let h=!1;const u=e[a];if(u!==e[a+1]&&(a!==1||u!==e[0]))if(i)h=!0;else{const c=a*n,d=c-n,f=c+n;for(let m=0;m!==n;++m){const g=t[c+m];if(g!==t[d+m]||g!==t[f+m]){h=!0;break}}}if(h){if(a!==s){e[s]=e[a];const c=a*n,d=s*n;for(let f=0;f!==n;++f)t[d+f]=t[c+f]}++s}}if(o>0){e[s]=e[o];for(let a=o*n,h=s*n,u=0;u!==n;++u)t[h+u]=t[a+u];++s}return s!==e.length?(this.times=Bn.arraySlice(e,0,s),this.values=Bn.arraySlice(t,0,s*n)):(this.times=e,this.values=t),this}clone(){const e=Bn.arraySlice(this.times,0),t=Bn.arraySlice(this.values,0),n=new this.constructor(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}wo.prototype.TimeBufferType=Float32Array,wo.prototype.ValueBufferType=Float32Array,wo.prototype.DefaultInterpolation=Qa;class Oh extends wo{}Oh.prototype.ValueTypeName="bool",Oh.prototype.ValueBufferType=Array,Oh.prototype.DefaultInterpolation=Fo,Oh.prototype.InterpolantFactoryMethodLinear=void 0,Oh.prototype.InterpolantFactoryMethodSmooth=void 0;class Cg extends wo{}Cg.prototype.ValueTypeName="color";class nd extends wo{}nd.prototype.ValueTypeName="number";class Q0 extends Xs{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,h=(n-t)/(i-t);let u=e*a;for(let c=u+a;u!==c;u+=4)pi.slerpFlat(o,0,s,u-a,s,u,h);return o}}class El extends wo{InterpolantFactoryMethodLinear(e){return new Q0(this.times,this.values,this.getValueSize(),e)}}El.prototype.ValueTypeName="quaternion",El.prototype.DefaultInterpolation=Qa,El.prototype.InterpolantFactoryMethodSmooth=void 0;class Dh extends wo{}Dh.prototype.ValueTypeName="string",Dh.prototype.ValueBufferType=Array,Dh.prototype.DefaultInterpolation=Fo,Dh.prototype.InterpolantFactoryMethodLinear=void 0,Dh.prototype.InterpolantFactoryMethodSmooth=void 0;class id extends wo{}id.prototype.ValueTypeName="vector";class rd{constructor(e,t=-1,n,i=xs){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=Qi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let s=0,a=n.length;s!==a;++s)t.push(yw(n[s]).scale(i));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,s=n.length;o!==s;++o)t.push(wo.toJSON(n[o]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const o=t.length,s=[];for(let a=0;a<o;a++){let h=[],u=[];h.push((a+o-1)%o,a,(a+1)%o),u.push(0,1,0);const c=Bn.getKeyframeOrder(h);h=Bn.sortedArray(h,1,c),u=Bn.sortedArray(u,1,c),i||h[0]!==0||(h.push(o),u.push(u[0])),s.push(new nd(".morphTargetInfluences["+t[a].name+"]",h,u).scale(1/n))}return new this(e,-1,s)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,h=e.length;a<h;a++){const u=e[a],c=u.name.match(o);if(c&&c.length>1){const d=c[1];let f=i[d];f||(i[d]=f=[]),f.push(u)}}const s=[];for(const a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],t,n));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(c,d,f,m,g){if(f.length!==0){const v=[],x=[];Bn.flattenJSON(f,v,x,m),v.length!==0&&g.push(new c(d,v,x))}},i=[],o=e.name||"default",s=e.fps||30,a=e.blendMode;let h=e.length||-1;const u=e.hierarchy||[];for(let c=0;c<u.length;c++){const d=u[c].keys;if(d&&d.length!==0)if(d[0].morphTargets){const f={};let m;for(m=0;m<d.length;m++)if(d[m].morphTargets)for(let g=0;g<d[m].morphTargets.length;g++)f[d[m].morphTargets[g]]=-1;for(const g in f){const v=[],x=[];for(let T=0;T!==d[m].morphTargets.length;++T){const M=d[m];v.push(M.time),x.push(M.morphTarget===g?1:0)}i.push(new nd(".morphTargetInfluence["+g+"]",v,x))}h=f.length*(s||1)}else{const f=".bones["+t[c].name+"]";n(id,f+".position",d,"pos",i),n(El,f+".quaternion",d,"rot",i),n(id,f+".scale",d,"scl",i)}}return i.length===0?null:new this(o,h,i,a)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const i=this.tracks[t];e=Math.max(e,i.times[i.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function yw(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return nd;case"vector":case"vector2":case"vector3":case"vector4":return id;case"color":return Cg;case"quaternion":return El;case"bool":case"boolean":return Oh;case"string":return Dh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(r.type);if(r.times===void 0){const t=[],n=[];Bn.flattenJSON(r.keys,t,n,"value"),r.times=t,r.values=n}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const Nh={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class Ig{constructor(e,t,n){const i=this;let o=!1,s=0,a=0,h;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(c){a++,o===!1&&i.onStart!==void 0&&i.onStart(c,s,a),o=!0},this.itemEnd=function(c){s++,i.onProgress!==void 0&&i.onProgress(c,s,a),s===a&&(o=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return h?h(c):c},this.setURLModifier=function(c){return h=c,this},this.addHandler=function(c,d){return u.push(c,d),this},this.removeHandler=function(c){const d=u.indexOf(c);return d!==-1&&u.splice(d,2),this},this.getHandler=function(c){for(let d=0,f=u.length;d<f;d+=2){const m=u[d],g=u[d+1];if(m.global&&(m.lastIndex=0),m.test(c))return g}return null}}}const e_=new Ig;class Xi{constructor(e){this.manager=e!==void 0?e:e_,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,o){n.load(e,i,t,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const To={};class So extends Xi{constructor(e){super(e)}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=Nh.get(e);if(s!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;if(To[e]!==void 0)return void To[e].push({onLoad:t,onProgress:n,onError:i});const a=e.match(/^data:(.*?)(;base64)?,(.*)$/);let h;if(a){const u=a[1],c=!!a[2];let d=a[3];d=decodeURIComponent(d),c&&(d=atob(d));try{let f;const m=(this.responseType||"").toLowerCase();switch(m){case"arraybuffer":case"blob":const g=new Uint8Array(d.length);for(let x=0;x<d.length;x++)g[x]=d.charCodeAt(x);f=m==="blob"?new Blob([g.buffer],{type:u}):g.buffer;break;case"document":f=new DOMParser().parseFromString(d,u);break;case"json":f=JSON.parse(d);break;default:f=d}setTimeout(function(){t&&t(f),o.manager.itemEnd(e)},0)}catch(f){setTimeout(function(){i&&i(f),o.manager.itemError(e),o.manager.itemEnd(e)},0)}}else{To[e]=[],To[e].push({onLoad:t,onProgress:n,onError:i}),h=new XMLHttpRequest,h.open("GET",e,!0),h.addEventListener("load",function(u){const c=this.response,d=To[e];if(delete To[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Nh.add(e,c);for(let f=0,m=d.length;f<m;f++){const g=d[f];g.onLoad&&g.onLoad(c)}o.manager.itemEnd(e)}else{for(let f=0,m=d.length;f<m;f++){const g=d[f];g.onError&&g.onError(u)}o.manager.itemError(e),o.manager.itemEnd(e)}},!1),h.addEventListener("progress",function(u){const c=To[e];for(let d=0,f=c.length;d<f;d++){const m=c[d];m.onProgress&&m.onProgress(u)}},!1),h.addEventListener("error",function(u){const c=To[e];delete To[e];for(let d=0,f=c.length;d<f;d++){const m=c[d];m.onError&&m.onError(u)}o.manager.itemError(e),o.manager.itemEnd(e)},!1),h.addEventListener("abort",function(u){const c=To[e];delete To[e];for(let d=0,f=c.length;d<f;d++){const m=c[d];m.onError&&m.onError(u)}o.manager.itemError(e),o.manager.itemEnd(e)},!1),this.responseType!==void 0&&(h.responseType=this.responseType),this.withCredentials!==void 0&&(h.withCredentials=this.withCredentials),h.overrideMimeType&&h.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const u in this.requestHeader)h.setRequestHeader(u,this.requestHeader[u]);h.send(null)}return o.manager.itemStart(e),h}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class xw extends Xi{constructor(e){super(e)}load(e,t,n,i){const o=this,s=new So(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){try{t(o.parse(JSON.parse(a)))}catch(h){i?i(h):console.error(h),o.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=rd.parse(e[n]);t.push(i)}return t}}class bw extends Xi{constructor(e){super(e)}load(e,t,n,i){const o=this,s=[],a=new vt,h=new So(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(o.withCredentials);let u=0;function c(d){h.load(e[d],function(f){const m=o.parse(f,!0);s[d]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},u+=1,u===6&&(m.mipmapCount===1&&(a.minFilter=Yn),a.image=s,a.format=m.format,a.needsUpdate=!0,t&&t(a))},n,i)}if(Array.isArray(e))for(let d=0,f=e.length;d<f;++d)c(d);else h.load(e,function(d){const f=o.parse(d,!0);if(f.isCubemap){const m=f.mipmaps.length/f.mipmapCount;for(let g=0;g<m;g++){s[g]={mipmaps:[]};for(let v=0;v<f.mipmapCount;v++)s[g].mipmaps.push(f.mipmaps[g*f.mipmapCount+v]),s[g].format=f.format,s[g].width=f.width,s[g].height=f.height}a.image=s}else a.image.width=f.width,a.image.height=f.height,a.mipmaps=f.mipmaps;f.mipmapCount===1&&(a.minFilter=Yn),a.format=f.format,a.needsUpdate=!0,t&&t(a)},n,i);return a}}class od extends Xi{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=Nh.get(e);if(s!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;const a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function h(){a.removeEventListener("load",h,!1),a.removeEventListener("error",u,!1),Nh.add(e,this),t&&t(this),o.manager.itemEnd(e)}function u(c){a.removeEventListener("load",h,!1),a.removeEventListener("error",u,!1),i&&i(c),o.manager.itemError(e),o.manager.itemEnd(e)}return a.addEventListener("load",h,!1),a.addEventListener("error",u,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(e),a.src=e,a}}class t_ extends Xi{constructor(e){super(e)}load(e,t,n,i){const o=new Or,s=new od(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function h(u){s.load(e[u],function(c){o.images[u]=c,a++,a===6&&(o.needsUpdate=!0,t&&t(o))},void 0,i)}for(let u=0;u<e.length;++u)h(u);return o}}class n_ extends Xi{constructor(e){super(e)}load(e,t,n,i){const o=this,s=new Zo,a=new So(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(o.withCredentials),a.load(e,function(h){const u=o.parse(h);u&&(u.image!==void 0?s.image=u.image:u.data!==void 0&&(s.image.width=u.width,s.image.height=u.height,s.image.data=u.data),s.wrapS=u.wrapS!==void 0?u.wrapS:di,s.wrapT=u.wrapT!==void 0?u.wrapT:di,s.magFilter=u.magFilter!==void 0?u.magFilter:Yn,s.minFilter=u.minFilter!==void 0?u.minFilter:Yn,s.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.encoding!==void 0&&(s.encoding=u.encoding),u.flipY!==void 0&&(s.flipY=u.flipY),u.format!==void 0&&(s.format=u.format),u.type!==void 0&&(s.type=u.type),u.mipmaps!==void 0&&(s.mipmaps=u.mipmaps,s.minFilter=fs),u.mipmapCount===1&&(s.minFilter=Yn),u.generateMipmaps!==void 0&&(s.generateMipmaps=u.generateMipmaps),s.needsUpdate=!0,t&&t(s,u))},n,i),s}}class Lg extends Xi{constructor(e){super(e)}load(e,t,n,i){const o=new qn,s=new od(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){o.image=a;const h=e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0;o.format=h?oo:$i,o.needsUpdate=!0,t!==void 0&&t(o)},n,i),o}}class i_ extends Vn{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Da(t,e))}getPoint(e){const t=e*this.getLength(),n=this.getCurveLengths();let i=0;for(;i<n.length;){if(n[i]>=t){const o=n[i]-t,s=this.curves[i],a=s.getLength(),h=a===0?0:1-o/a;return s.getPointAt(h)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,o=this.curves;i<o.length;i++){const s=o[i],a=s&&s.isEllipseCurve?2*e:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?e*s.points.length:e,h=s.getPoints(a);for(let u=0;u<h.length;u++){const c=h[u];n&&n.equals(c)||(t.push(c),n=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new yg[i.type]().fromJSON(i))}return this}}class Fh extends i_{constructor(e){super(),this.type="Path",this.currentPoint=new $e,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Da(this.currentPoint.clone(),new $e(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const o=new Ws(this.currentPoint.clone(),new $e(e,t),new $e(n,i));return this.curves.push(o),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,o,s){const a=new js(this.currentPoint.clone(),new $e(e,t),new $e(n,i),new $e(o,s));return this.curves.push(a),this.currentPoint.set(o,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new yf(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,o,s){const a=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(e+a,t+h,n,i,o,s),this}absarc(e,t,n,i,o,s){return this.absellipse(e,t,n,n,i,o,s),this}ellipse(e,t,n,i,o,s,a,h){const u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,t+c,n,i,o,s,a,h),this}absellipse(e,t,n,i,o,s,a,h){const u=new Fn(e,t,n,i,o,s,a,h);if(this.curves.length>0){const d=u.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(u);const c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Fa extends Fh{constructor(e){super(e),this.uuid=Qi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new Fh().fromJSON(i))}return this}}class Eo extends jt{constructor(e,t=1){super(),this.type="Light",this.color=new ft(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}Eo.prototype.isLight=!0;class Og extends Eo{constructor(e,t,n){super(e,n),this.type="HemisphereLight",this.position.copy(jt.DefaultUp),this.updateMatrix(),this.groundColor=new ft(t)}copy(e){return Eo.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}Og.prototype.isHemisphereLight=!0;const r_=new ct,o_=new w,s_=new w;class Dg{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new $e(512,512),this.map=null,this.mapPass=null,this.matrix=new ct,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Sa,this._frameExtents=new $e(1,1),this._viewportCount=1,this._viewports=[new cn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;o_.setFromMatrixPosition(e.matrixWorld),t.position.copy(o_),s_.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(s_),t.updateMatrixWorld(),r_.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r_),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class a_ extends Dg{constructor(){super(new $n(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,n=2*Qn*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;n===t.fov&&i===t.aspect&&o===t.far||(t.fov=n,t.aspect=i,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}a_.prototype.isSpotLightShadow=!0;class Ng extends Eo{constructor(e,t,n=0,i=Math.PI/3,o=0,s=1){super(e,t),this.type="SpotLight",this.position.copy(jt.DefaultUp),this.updateMatrix(),this.target=new jt,this.distance=n,this.angle=i,this.penumbra=o,this.decay=s,this.shadow=new a_}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Ng.prototype.isSpotLight=!0;const h_=new ct,sd=new w,Fg=new w;class u_ extends Dg{constructor(){super(new $n(90,1,.5,500)),this._frameExtents=new $e(4,2),this._viewportCount=6,this._viewports=[new cn(2,1,1,1),new cn(0,1,1,1),new cn(3,1,1,1),new cn(1,1,1,1),new cn(3,0,1,1),new cn(1,0,1,1)],this._cubeDirections=[new w(1,0,0),new w(-1,0,0),new w(0,0,1),new w(0,0,-1),new w(0,1,0),new w(0,-1,0)],this._cubeUps=[new w(0,1,0),new w(0,1,0),new w(0,1,0),new w(0,1,0),new w(0,0,1),new w(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,o=e.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),sd.setFromMatrixPosition(e.matrixWorld),n.position.copy(sd),Fg.copy(n.position),Fg.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Fg),n.updateMatrixWorld(),i.makeTranslation(-sd.x,-sd.y,-sd.z),h_.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(h_)}}u_.prototype.isPointLightShadow=!0;class Bg extends Eo{constructor(e,t,n=0,i=1){super(e,t),this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new u_}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}Bg.prototype.isPointLight=!0;class Ml extends Os{constructor(e=-1,t=1,n=1,i=-1,o=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,o,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let o=n-e,s=n+e,a=i+t,h=i-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=u*this.view.offsetX,s=o+u*this.view.width,a-=c*this.view.offsetY,h=a-c*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,h,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}Ml.prototype.isOrthographicCamera=!0;class l_ extends Dg{constructor(){super(new Ml(-5,5,5,-5,.5,500))}}l_.prototype.isDirectionalLightShadow=!0;class Af extends Eo{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(jt.DefaultUp),this.updateMatrix(),this.target=new jt,this.shadow=new l_}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Af.prototype.isDirectionalLight=!0;class Pf extends Eo{constructor(e,t){super(e,t),this.type="AmbientLight"}}Pf.prototype.isAmbientLight=!0;class Ug extends Eo{constructor(e,t,n=10,i=10){super(e,t),this.type="RectAreaLight",this.width=n,this.height=i}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}Ug.prototype.isRectAreaLight=!0;class kg{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new w)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,o=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*i),t.addScaledVector(s[2],.488603*o),t.addScaledVector(s[3],.488603*n),t.addScaledVector(s[4],n*i*1.092548),t.addScaledVector(s[5],i*o*1.092548),t.addScaledVector(s[6],.315392*(3*o*o-1)),t.addScaledVector(s[7],n*o*1.092548),t.addScaledVector(s[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,o=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*i),t.addScaledVector(s[2],1.023328*o),t.addScaledVector(s[3],1.023328*n),t.addScaledVector(s[4],.858086*n*i),t.addScaledVector(s[5],.858086*i*o),t.addScaledVector(s[6],.743125*o*o-.247708),t.addScaledVector(s[7],.858086*n*o),t.addScaledVector(s[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const n=e.x,i=e.y,o=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*o,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*o,t[6]=.315392*(3*o*o-1),t[7]=1.092548*n*o,t[8]=.546274*(n*n-i*i)}}kg.prototype.isSphericalHarmonics3=!0;class ad extends Eo{constructor(e=new kg,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}ad.prototype.isLightProbe=!0;class c_ extends Xi{constructor(e){super(e),this.textures={}}load(e,t,n,i){const o=this,s=new So(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(e,function(a){try{t(o.parse(JSON.parse(a)))}catch(h){i?i(h):console.error(h),o.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(o){return t[o]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",o),t[o]}const i=new _w[e.type];if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=new ft().setHex(e.sheen)),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==1&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.morphTargets!==void 0&&(i.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(i.morphNormals=e.morphNormals),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.vertexTangents!==void 0&&(i.vertexTangents=e.vertexTangents),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const o in e.uniforms){const s=e.uniforms[o];switch(i.uniforms[o]={},s.type){case"t":i.uniforms[o].value=n(s.value);break;case"c":i.uniforms[o].value=new ft().setHex(s.value);break;case"v2":i.uniforms[o].value=new $e().fromArray(s.value);break;case"v3":i.uniforms[o].value=new w().fromArray(s.value);break;case"v4":i.uniforms[o].value=new cn().fromArray(s.value);break;case"m3":i.uniforms[o].value=new Tn().fromArray(s.value);break;case"m4":i.uniforms[o].value=new ct().fromArray(s.value);break;default:i.uniforms[o].value=s.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(const o in e.extensions)i.extensions[o]=e.extensions[o];if(e.shading!==void 0&&(i.flatShading=e.shading===1),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let o=e.normalScale;Array.isArray(o)===!1&&(o=[o,o]),i.normalScale=new $e().fromArray(o)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new $e().fromArray(e.clearcoatNormalScale)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),i}setTextures(e){return this.textures=e,this}}class Rf{static decodeText(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.substr(0,t+1)}}class Gg extends St{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}Gg.prototype.isInstancedBufferGeometry=!0;class Hg extends Yt{constructor(e,t,n,i=1){typeof n=="number"&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}Hg.prototype.isInstancedBufferAttribute=!0;class d_ extends Xi{constructor(e){super(e)}load(e,t,n,i){const o=this,s=new So(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(e,function(a){try{t(o.parse(JSON.parse(a)))}catch(h){i?i(h):console.error(h),o.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(d,f){if(t[f]!==void 0)return t[f];const m=d.interleavedBuffers[f],g=function(T,M){if(n[M]!==void 0)return n[M];const C=T.arrayBuffers[M],D=new Uint32Array(C).buffer;return n[M]=D,D}(d,m.buffer),v=Rs(m.type,g),x=new ks(v,m.stride);return x.uuid=m.uuid,t[f]=x,x}const o=e.isInstancedBufferGeometry?new Gg:new St,s=e.data.index;if(s!==void 0){const d=Rs(s.type,s.array);o.setIndex(new Yt(d,1))}const a=e.data.attributes;for(const d in a){const f=a[d];let m;if(f.isInterleavedBufferAttribute){const g=i(e.data,f.data);m=new xo(g,f.itemSize,f.offset,f.normalized)}else{const g=Rs(f.type,f.array);m=new(f.isInstancedBufferAttribute?Hg:Yt)(g,f.itemSize,f.normalized)}f.name!==void 0&&(m.name=f.name),f.usage!==void 0&&m.setUsage(f.usage),f.updateRange!==void 0&&(m.updateRange.offset=f.updateRange.offset,m.updateRange.count=f.updateRange.count),o.setAttribute(d,m)}const h=e.data.morphAttributes;if(h)for(const d in h){const f=h[d],m=[];for(let g=0,v=f.length;g<v;g++){const x=f[g];let T;if(x.isInterleavedBufferAttribute){const M=i(e.data,x.data);T=new xo(M,x.itemSize,x.offset,x.normalized)}else{const M=Rs(x.type,x.array);T=new Yt(M,x.itemSize,x.normalized)}x.name!==void 0&&(T.name=x.name),m.push(T)}o.morphAttributes[d]=m}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const u=e.data.groups||e.data.drawcalls||e.data.offsets;if(u!==void 0)for(let d=0,f=u.length;d!==f;++d){const m=u[d];o.addGroup(m.start,m.count,m.materialIndex)}const c=e.data.boundingSphere;if(c!==void 0){const d=new w;c.center!==void 0&&d.fromArray(c.center),o.boundingSphere=new oi(d,c.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class ww extends Xi{constructor(e){super(e)}load(e,t,n,i){const o=this,s=this.path===""?Rf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const a=new So(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(h){let u=null;try{u=JSON.parse(h)}catch(d){return i!==void 0&&i(d),void console.error("THREE:ObjectLoader: Can't parse "+e+".",d.message)}const c=u.metadata;c!==void 0&&c.type!==void 0&&c.type.toLowerCase()!=="geometry"?o.parse(u,t):console.error("THREE.ObjectLoader: Can't load "+e)},n,i)}async loadAsync(e,t){const n=this.path===""?Rf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const i=new So(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const o=await i.loadAsync(e,t),s=JSON.parse(o),a=s.metadata;if(a===void 0||a.type===void 0||a.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(s)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,i),s=this.parseImages(e.images,function(){t!==void 0&&t(u)}),a=this.parseTextures(e.textures,s),h=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,o,h,a,n),c=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,c),t!==void 0){let d=!1;for(const f in s)if(s[f]instanceof HTMLImageElement){d=!0;break}d===!1&&t(u)}return u}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),o=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,o),a=this.parseMaterials(e.materials,s),h=this.parseObject(e.object,i,a,s,t),u=this.parseSkeletons(e.skeletons,h);return this.bindSkeletons(h,u),h}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const o=new Fa().fromJSON(e[n]);t[o.uuid]=o}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(o){o.isBone&&(i[o.uuid]=o)}),e!==void 0)for(let o=0,s=e.length;o<s;o++){const a=new cl().fromJSON(e[o],i);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new d_;for(let o=0,s=e.length;o<s;o++){let a;const h=e[o];switch(h.type){case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(h);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:h.type in $0?a=$0[h.type].fromJSON(h,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${h.type}"`)}a.uuid=h.uuid,h.name!==void 0&&(a.name=h.name),a.isBufferGeometry===!0&&h.userData!==void 0&&(a.userData=h.userData),n[h.uuid]=a}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const o=new c_;o.setTextures(t);for(let s=0,a=e.length;s<a;s++){const h=e[s];if(h.type==="MultiMaterial"){const u=[];for(let c=0;c<h.materials.length;c++){const d=h.materials[c];n[d.uuid]===void 0&&(n[d.uuid]=o.parse(d)),u.push(n[d.uuid])}i[h.uuid]=u}else n[h.uuid]===void 0&&(n[h.uuid]=o.parse(h)),i[h.uuid]=n[h.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],o=rd.parse(i);t[o.uuid]=o}return t}parseImages(e,t){const n=this,i={};let o;function s(a){if(typeof a=="string"){const h=a;return function(u){return n.manager.itemStart(u),o.load(u,function(){n.manager.itemEnd(u)},void 0,function(){n.manager.itemError(u),n.manager.itemEnd(u)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h)}return a.data?{data:Rs(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){const a=new Ig(t);o=new od(a),o.setCrossOrigin(this.crossOrigin);for(let h=0,u=e.length;h<u;h++){const c=e[h],d=c.url;if(Array.isArray(d)){i[c.uuid]=[];for(let f=0,m=d.length;f<m;f++){const g=s(d[f]);g!==null&&(g instanceof HTMLImageElement?i[c.uuid].push(g):i[c.uuid].push(new Zo(g.data,g.width,g.height)))}}else{const f=s(c.url);f!==null&&(i[c.uuid]=f)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function o(s){if(typeof s=="string"){const a=s,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await i.loadAsync(h)}return s.data?{data:Rs(s.type,s.data),width:s.width,height:s.height}:null}if(e!==void 0&&e.length>0){i=new od(this.manager),i.setCrossOrigin(this.crossOrigin);for(let s=0,a=e.length;s<a;s++){const h=e[s],u=h.url;if(Array.isArray(u)){n[h.uuid]=[];for(let c=0,d=u.length;c<d;c++){const f=u[c],m=await o(f);m!==null&&(m instanceof HTMLImageElement?n[h.uuid].push(m):n[h.uuid].push(new Zo(m.data,m.width,m.height)))}}else{const c=await o(h.url);c!==null&&(n[h.uuid]=c)}}}return n}parseTextures(e,t){function n(o,s){return typeof o=="number"?o:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",o),s[o])}const i={};if(e!==void 0)for(let o=0,s=e.length;o<s;o++){const a=e[o];let h;a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const u=t[a.image];Array.isArray(u)?(h=new Or(u),u.length===6&&(h.needsUpdate=!0)):(h=u&&u.data?new Zo(u.data,u.width,u.height):new qn(u),u&&(h.needsUpdate=!0)),h.uuid=a.uuid,a.name!==void 0&&(h.name=a.name),a.mapping!==void 0&&(h.mapping=n(a.mapping,Tw)),a.offset!==void 0&&h.offset.fromArray(a.offset),a.repeat!==void 0&&h.repeat.fromArray(a.repeat),a.center!==void 0&&h.center.fromArray(a.center),a.rotation!==void 0&&(h.rotation=a.rotation),a.wrap!==void 0&&(h.wrapS=n(a.wrap[0],p_),h.wrapT=n(a.wrap[1],p_)),a.format!==void 0&&(h.format=a.format),a.type!==void 0&&(h.type=a.type),a.encoding!==void 0&&(h.encoding=a.encoding),a.minFilter!==void 0&&(h.minFilter=n(a.minFilter,f_)),a.magFilter!==void 0&&(h.magFilter=n(a.magFilter,f_)),a.anisotropy!==void 0&&(h.anisotropy=a.anisotropy),a.flipY!==void 0&&(h.flipY=a.flipY),a.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(h.unpackAlignment=a.unpackAlignment),i[a.uuid]=h}return i}parseObject(e,t,n,i,o){let s,a,h;function u(f){return t[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",f),t[f]}function c(f){if(f!==void 0){if(Array.isArray(f)){const m=[];for(let g=0,v=f.length;g<v;g++){const x=f[g];n[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),m.push(n[x])}return m}return n[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",f),n[f]}}function d(f){return i[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",f),i[f]}switch(e.type){case"Scene":s=new Aa,e.background!==void 0&&(Number.isInteger(e.background)?s.background=new ft(e.background):s.background=d(e.background)),e.environment!==void 0&&(s.environment=d(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?s.fog=new wh(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(s.fog=new mi(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":s=new $n(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(s.focus=e.focus),e.zoom!==void 0&&(s.zoom=e.zoom),e.filmGauge!==void 0&&(s.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(s.filmOffset=e.filmOffset),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new Ml(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(s.zoom=e.zoom),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new Pf(e.color,e.intensity);break;case"DirectionalLight":s=new Af(e.color,e.intensity);break;case"PointLight":s=new Bg(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new Ug(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new Ng(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new Og(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=new ad().fromJSON(e);break;case"SkinnedMesh":a=u(e.geometry),h=c(e.material),s=new Ca(a,h),e.bindMode!==void 0&&(s.bindMode=e.bindMode),e.bindMatrix!==void 0&&s.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(s.skeleton=e.skeleton);break;case"Mesh":a=u(e.geometry),h=c(e.material),s=new sn(a,h);break;case"InstancedMesh":a=u(e.geometry),h=c(e.material);const f=e.count,m=e.instanceMatrix,g=e.instanceColor;s=new Zc(a,h,f),s.instanceMatrix=new Yt(new Float32Array(m.array),16),g!==void 0&&(s.instanceColor=new Yt(new Float32Array(g.array),g.itemSize));break;case"LOD":s=new df;break;case"Line":s=new l(u(e.geometry),c(e.material));break;case"LineLoop":s=new P(u(e.geometry),c(e.material));break;case"LineSegments":s=new E(u(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new He(u(e.geometry),c(e.material));break;case"Sprite":s=new Ah(c(e.material));break;case"Group":s=new Us;break;case"Bone":s=new ll;break;default:s=new jt}if(s.uuid=e.uuid,e.name!==void 0&&(s.name=e.name),e.matrix!==void 0?(s.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(e.position!==void 0&&s.position.fromArray(e.position),e.rotation!==void 0&&s.rotation.fromArray(e.rotation),e.quaternion!==void 0&&s.quaternion.fromArray(e.quaternion),e.scale!==void 0&&s.scale.fromArray(e.scale)),e.castShadow!==void 0&&(s.castShadow=e.castShadow),e.receiveShadow!==void 0&&(s.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(s.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(s.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(s.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&s.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(s.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(s.visible=e.visible),e.frustumCulled!==void 0&&(s.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(s.renderOrder=e.renderOrder),e.userData!==void 0&&(s.userData=e.userData),e.layers!==void 0&&(s.layers.mask=e.layers),e.children!==void 0){const f=e.children;for(let m=0;m<f.length;m++)s.add(this.parseObject(f[m],t,n,i,o))}if(e.animations!==void 0){const f=e.animations;for(let m=0;m<f.length;m++){const g=f[m];s.animations.push(o[g])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(s.autoUpdate=e.autoUpdate);const f=e.levels;for(let m=0;m<f.length;m++){const g=f[m],v=s.getObjectByProperty("uuid",g.object);v!==void 0&&s.addLevel(v,g.distance)}}return s}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const Tw={UVMapping:lu,CubeReflectionMapping:Lo,CubeRefractionMapping:Wa,EquirectangularReflectionMapping:Xa,EquirectangularRefractionMapping:Ya,CubeUVReflectionMapping:ra,CubeUVRefractionMapping:oa},p_={RepeatWrapping:Oo,ClampToEdgeWrapping:di,MirroredRepeatWrapping:qa},f_={NearestFilter:Xn,NearestMipmapNearestFilter:Za,NearestMipmapLinearFilter:$a,LinearFilter:Yn,LinearMipmapNearestFilter:Do,LinearMipmapLinearFilter:fs};class m_ extends Xi{constructor(e){super(e),typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=Nh.get(e);if(s!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(h){Nh.add(e,h),t&&t(h),o.manager.itemEnd(e)}).catch(function(h){i&&i(h),o.manager.itemError(e),o.manager.itemEnd(e)}),o.manager.itemStart(e)}}m_.prototype.isImageBitmapLoader=!0;class g_{constructor(){this.type="ShapePath",this.color=new ft,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Fh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,o,s){return this.currentPath.bezierCurveTo(e,t,n,i,o,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(M){const C=[];for(let D=0,R=M.length;D<R;D++){const F=M[D],O=new Fa;O.curves=F.curves,C.push(O)}return C}function i(M,C){const D=C.length;let R=!1;for(let F=D-1,O=0;O<D;F=O++){let U=C[F],he=C[O],Q=he.x-U.x,X=he.y-U.y;if(Math.abs(X)>Number.EPSILON){if(X<0&&(U=C[O],Q=-Q,he=C[F],X=-X),M.y<U.y||M.y>he.y)continue;if(M.y===U.y){if(M.x===U.x)return!0}else{const Z=X*(M.x-U.x)-Q*(M.y-U.y);if(Z===0)return!0;if(Z<0)continue;R=!R}}else{if(M.y!==U.y)continue;if(he.x<=M.x&&M.x<=U.x||U.x<=M.x&&M.x<=he.x)return!0}}return R}const o=Qo.isClockWise,s=this.subPaths;if(s.length===0)return[];if(t===!0)return n(s);let a,h,u;const c=[];if(s.length===1)return h=s[0],u=new Fa,u.curves=h.curves,c.push(u),c;let d=!o(s[0].getPoints());d=e?!d:d;const f=[],m=[];let g,v,x=[],T=0;m[T]=void 0,x[T]=[];for(let M=0,C=s.length;M<C;M++)h=s[M],g=h.getPoints(),a=o(g),a=e?!a:a,a?(!d&&m[T]&&T++,m[T]={s:new Fa,p:g},m[T].s.curves=h.curves,d&&T++,x[T]=[]):x[T].push({h,p:g[0]});if(!m[0])return n(s);if(m.length>1){let M=!1;const C=[];for(let D=0,R=m.length;D<R;D++)f[D]=[];for(let D=0,R=m.length;D<R;D++){const F=x[D];for(let O=0;O<F.length;O++){const U=F[O];let he=!0;for(let Q=0;Q<m.length;Q++)i(U.p,m[Q].p)&&(D!==Q&&C.push({froms:D,tos:Q,hole:O}),he?(he=!1,f[Q].push(U)):M=!0);he&&f[D].push(U)}}C.length>0&&(M||(x=f))}for(let M=0,C=m.length;M<C;M++){u=m[M].s,c.push(u),v=x[M];for(let D=0,R=v.length;D<R;D++)u.holes.push(v[D].h)}return c}}class zg{constructor(e){this.type="Font",this.data=e}generateShapes(e,t=100){const n=[],i=function(o,s,a){const h=Array.from(o),u=s/a.resolution,c=(a.boundingBox.yMax-a.boundingBox.yMin+a.underlineThickness)*u,d=[];let f=0,m=0;for(let g=0;g<h.length;g++){const v=h[g];if(v===`
`)f=0,m-=c;else{const x=Sw(v,u,f,m,a);f+=x.offsetX,d.push(x.path)}}return d}(e,t,this.data);for(let o=0,s=i.length;o<s;o++)Array.prototype.push.apply(n,i[o].toShapes());return n}}function Sw(r,e,t,n,i){const o=i.glyphs[r]||i.glyphs["?"];if(!o)return void console.error('THREE.Font: character "'+r+'" does not exists in font family '+i.familyName+".");const s=new g_;let a,h,u,c,d,f,m,g;if(o.o){const v=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let x=0,T=v.length;x<T;)switch(v[x++]){case"m":a=v[x++]*e+t,h=v[x++]*e+n,s.moveTo(a,h);break;case"l":a=v[x++]*e+t,h=v[x++]*e+n,s.lineTo(a,h);break;case"q":u=v[x++]*e+t,c=v[x++]*e+n,d=v[x++]*e+t,f=v[x++]*e+n,s.quadraticCurveTo(d,f,u,c);break;case"b":u=v[x++]*e+t,c=v[x++]*e+n,d=v[x++]*e+t,f=v[x++]*e+n,m=v[x++]*e+t,g=v[x++]*e+n,s.bezierCurveTo(d,f,m,g,u,c)}}return{offsetX:o.ha*e,path:s}}zg.prototype.isFont=!0;class Ew extends Xi{constructor(e){super(e)}load(e,t,n,i){const o=this,s=new So(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(o.withCredentials),s.load(e,function(a){let h;try{h=JSON.parse(a)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),h=JSON.parse(a.substring(65,a.length-2))}const u=o.parse(h);t&&t(u)},n,i)}parse(e){return new zg(e)}}let Cf;const Vg={getContext:function(){return Cf===void 0&&(Cf=new(window.AudioContext||window.webkitAudioContext)),Cf},setContext:function(r){Cf=r}};class v_ extends Xi{constructor(e){super(e)}load(e,t,n,i){const o=this,s=new So(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){try{const h=a.slice(0);Vg.getContext().decodeAudioData(h,function(u){t(u)})}catch(h){i?i(h):console.error(h),o.manager.itemError(e)}},n,i)}}class __ extends ad{constructor(e,t,n=1){super(void 0,n);const i=new ft().set(e),o=new ft().set(t),s=new w(i.r,i.g,i.b),a=new w(o.r,o.g,o.b),h=Math.sqrt(Math.PI),u=h*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(a).multiplyScalar(h),this.sh.coefficients[1].copy(s).sub(a).multiplyScalar(u)}}__.prototype.isHemisphereLightProbe=!0;class y_ extends ad{constructor(e,t=1){super(void 0,t);const n=new ft().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}y_.prototype.isAmbientLightProbe=!0;const x_=new ct,b_=new ct;class Mw{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new $n,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new $n,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;const n=e.projectionMatrix.clone(),i=t.eyeSep/2,o=i*t.near/t.focus,s=t.near*Math.tan(wn*t.fov*.5)/t.zoom;let a,h;b_.elements[12]=-i,x_.elements[12]=i,a=-s*t.aspect+o,h=s*t.aspect+o,n.elements[0]=2*t.near/(h-a),n.elements[8]=(h+a)/(h-a),this.cameraL.projectionMatrix.copy(n),a=-s*t.aspect-o,h=s*t.aspect-o,n.elements[0]=2*t.near/(h-a),n.elements[8]=(h+a)/(h-a),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(b_),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(x_)}}class w_{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=T_(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=T_();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function T_(){return(typeof performance=="undefined"?Date:performance).now()}const Bh=new w,S_=new pi,Aw=new w,Uh=new w;class Pw extends jt{constructor(){super(),this.type="AudioListener",this.context=Vg.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new w_}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Bh,S_,Aw),Uh.set(0,0,-1).applyQuaternion(S_),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Bh.x,i),t.positionY.linearRampToValueAtTime(Bh.y,i),t.positionZ.linearRampToValueAtTime(Bh.z,i),t.forwardX.linearRampToValueAtTime(Uh.x,i),t.forwardY.linearRampToValueAtTime(Uh.y,i),t.forwardZ.linearRampToValueAtTime(Uh.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(Bh.x,Bh.y,Bh.z),t.setOrientation(Uh.x,Uh.y,Uh.z,n.x,n.y,n.z)}}class jg extends jt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl!==!1)return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl!==!1)return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const kh=new w,E_=new pi,Rw=new w,Gh=new w;class Cw extends jg{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(kh,E_,Rw),Gh.set(0,0,1).applyQuaternion(E_);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(kh.x,n),t.positionY.linearRampToValueAtTime(kh.y,n),t.positionZ.linearRampToValueAtTime(kh.z,n),t.orientationX.linearRampToValueAtTime(Gh.x,n),t.orientationY.linearRampToValueAtTime(Gh.y,n),t.orientationZ.linearRampToValueAtTime(Gh.z,n)}else t.setPosition(kh.x,kh.y,kh.z),t.setOrientation(Gh.x,Gh.y,Gh.z)}}class M_{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class A_{constructor(e,t,n){let i,o,s;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,o=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,o=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,o=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=o,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,o=e*i+i;let s=this.cumulativeWeight;if(s===0){for(let a=0;a!==i;++a)n[o+a]=n[a];s=t}else{s+=t;const a=t/s;this._mixBufferRegion(n,o,0,a,i)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,o=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const h=t*this._origIndex;this._mixBufferRegion(n,i,h,1-o,t)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let h=t,u=t+t;h!==u;++h)if(n[h]!==n[h+t]){a.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let o=n,s=i;o!==s;++o)t[o]=t[i+o%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,o){if(i>=.5)for(let s=0;s!==o;++s)e[t+s]=e[n+s]}_slerp(e,t,n,i){pi.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,o){const s=this._workIndex*o;pi.multiplyQuaternionsFlat(e,s,e,t,e,n),pi.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,n,i,o){const s=1-i;for(let a=0;a!==o;++a){const h=t+a;e[h]=e[h]*s+e[n+a]*i}}_lerpAdditive(e,t,n,i,o){for(let s=0;s!==o;++s){const a=t+s;e[a]=e[a]+e[n+s]*i}}}const Iw=new RegExp("[\\[\\]\\.:\\/]","g"),Lw="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Ow=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Dw=/(WCOD+)?/.source.replace("WCOD",Lw),Nw=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Fw=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Bw=new RegExp("^"+Ow+Dw+Nw+Fw+"$"),Uw=["material","materials","bones"];class un{constructor(e,t,n){this.path=t,this.parsedPath=n||un.parseTrackName(t),this.node=un.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new un.Composite(e,t,n):new un(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Iw,"")}static parseTrackName(e){const t=Bw.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const o=n.nodeName.substring(i+1);Uw.indexOf(o)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=o)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(!t||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(o){for(let s=0;s<o.length;s++){const a=o[s];if(a.name===t||a.uuid===t)return a;const h=n(a.children);if(h)return h}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.node[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,o=n.length;i!==o;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,o=n.length;i!==o;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,o=n.length;i!==o;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,o=n.length;i!==o;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let o=t.propertyIndex;if(e||(e=un.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let u=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;default:if(e[n]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(u!==void 0){if(e[u]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[u]}}const s=e[i];if(s===void 0){const u=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(o!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}h=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=o}else s.fromArray!==void 0&&s.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(h=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}un.Composite=class{constructor(r,e,t){const n=t||un.parseTrackName(e);this._targetGroup=r,this._bindings=r.subscribe_(e,n)}getValue(r,e){this.bind();const t=this._targetGroup.nCachedObjects_,n=this._bindings[t];n!==void 0&&n.getValue(r,e)}setValue(r,e){const t=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=t.length;n!==i;++n)t[n].setValue(r,e)}bind(){const r=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=r.length;e!==t;++e)r[e].bind()}unbind(){const r=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=r.length;e!==t;++e)r[e].unbind()}},un.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},un.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},un.prototype.GetterByBindingType=[un.prototype._getValue_direct,un.prototype._getValue_array,un.prototype._getValue_arrayElement,un.prototype._getValue_toArray],un.prototype.SetterByBindingTypeAndVersioning=[[un.prototype._setValue_direct,un.prototype._setValue_direct_setNeedsUpdate,un.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[un.prototype._setValue_array,un.prototype._setValue_array_setNeedsUpdate,un.prototype._setValue_array_setMatrixWorldNeedsUpdate],[un.prototype._setValue_arrayElement,un.prototype._setValue_arrayElement_setNeedsUpdate,un.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[un.prototype._setValue_fromArray,un.prototype._setValue_fromArray_setNeedsUpdate,un.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class P_{constructor(){this.uuid=Qi(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,o=this._bindings,s=o.length;let a,h=e.length,u=this.nCachedObjects_;for(let c=0,d=arguments.length;c!==d;++c){const f=arguments[c],m=f.uuid;let g=t[m];if(g===void 0){g=h++,t[m]=g,e.push(f);for(let v=0,x=s;v!==x;++v)o[v].push(new un(f,n[v],i[v]))}else if(g<u){a=e[g];const v=--u,x=e[v];t[x.uuid]=g,e[g]=x,t[m]=v,e[v]=f;for(let T=0,M=s;T!==M;++T){const C=o[T],D=C[v];let R=C[g];C[g]=D,R===void 0&&(R=new un(f,n[T],i[T])),C[v]=R}}else e[g]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let o=this.nCachedObjects_;for(let s=0,a=arguments.length;s!==a;++s){const h=arguments[s],u=h.uuid,c=t[u];if(c!==void 0&&c>=o){const d=o++,f=e[d];t[f.uuid]=c,e[c]=f,t[u]=d,e[d]=h;for(let m=0,g=i;m!==g;++m){const v=n[m],x=v[d],T=v[c];v[c]=x,v[d]=T}}}this.nCachedObjects_=o}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let o=this.nCachedObjects_,s=e.length;for(let a=0,h=arguments.length;a!==h;++a){const u=arguments[a].uuid,c=t[u];if(c!==void 0)if(delete t[u],c<o){const d=--o,f=e[d],m=--s,g=e[m];t[f.uuid]=c,e[c]=f,t[g.uuid]=d,e[d]=g,e.pop();for(let v=0,x=i;v!==x;++v){const T=n[v],M=T[d],C=T[m];T[c]=M,T[d]=C,T.pop()}}else{const d=--s,f=e[d];d>0&&(t[f.uuid]=c),e[c]=f,e.pop();for(let m=0,g=i;m!==g;++m){const v=n[m];v[c]=v[d],v.pop()}}}this.nCachedObjects_=o}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const o=this._bindings;if(i!==void 0)return o[i];const s=this._paths,a=this._parsedPaths,h=this._objects,u=h.length,c=this.nCachedObjects_,d=new Array(u);i=o.length,n[e]=i,s.push(e),a.push(t),o.push(d);for(let f=c,m=h.length;f!==m;++f){const g=h[f];d[f]=new un(g,e,t)}return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,o=this._parsedPaths,s=this._bindings,a=s.length-1,h=s[a];t[e[a]]=n,s[n]=h,s.pop(),o[n]=o[a],o.pop(),i[n]=i[a],i.pop()}}}P_.prototype.isAnimationObjectGroup=!0;class kw{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const o=t.tracks,s=o.length,a=new Array(s),h={endingStart:_i,endingEnd:_i};for(let u=0;u!==s;++u){const c=o[u].createInterpolant(null);a[u]=c,c.settings=h}this._interpolantSettings=h,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=hc,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const i=this._clip.duration,o=e._clip.duration,s=o/i,a=i/o;e.warp(1,s,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,o=i.time,s=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const h=a.parameterPositions,u=a.sampleValues;return h[0]=o,h[1]=o+n,u[0]=e/s,u[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);const o=this._startTime;if(o!==null){const h=(e-o)*n;if(h<0||n===0)return;this._startTime=null,t=n*h}t*=this._updateTimeScale(e);const s=this._updateTime(t),a=this._updateWeight(e);if(a>0){const h=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case be:for(let c=0,d=h.length;c!==d;++c)h[c].evaluate(s),u[c].accumulateAdditive(a);break;case xs:default:for(let c=0,d=h.length;c!==d;++c)h[c].evaluate(s),u[c].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,o=this._loopCount;const s=n===ao;if(e===0)return o===-1?i:s&&(1&o)==1?t-i:i;if(n===Su){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,o+=Math.abs(a);const h=this.repetitions-o;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(h===1){const u=e<0;this._setEndings(u,!u,s)}else this._setEndings(!1,!1,s);this._loopCount=o,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(s&&(1&o)==1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=Bo,i.endingEnd=Bo):(i.endingStart=e?this.zeroSlopeAtStart?Bo:_i:eh,i.endingEnd=t?this.zeroSlopeAtEnd?Bo:_i:eh)}_scheduleFading(e,t,n){const i=this._mixer,o=i.time;let s=this._weightInterpolant;s===null&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const a=s.parameterPositions,h=s.sampleValues;return a[0]=o,h[0]=t,a[1]=o+e,h[1]=n,this}}class R_ extends uo{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,o=i.length,s=e._propertyBindings,a=e._interpolants,h=n.uuid,u=this._bindingsByRootAndName;let c=u[h];c===void 0&&(c={},u[h]=c);for(let d=0;d!==o;++d){const f=i[d],m=f.name;let g=c[m];if(g!==void 0)s[d]=g;else{if(g=s[d],g!==void 0){g._cacheIndex===null&&(++g.referenceCount,this._addInactiveBinding(g,h,m));continue}const v=t&&t._propertyBindings[d].binding.parsedPath;g=new A_(un.create(n,m,v),f.ValueTypeName,f.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,h,m),s[d]=g}a[d].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,o=this._actionsByClip[i];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const o=t[n];o.useCount++==0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const o=t[n];--o.useCount==0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,o=this._actionsByClip;let s=o[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=s;else{const a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const o=e._clip.uuid,s=this._actionsByClip,a=s[o],h=a.knownActions,u=h[h.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,h[c]=u,h.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],h.length===0&&delete s[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const o=t[n];--o.referenceCount==0&&this._removeInactiveBinding(o)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,o=t[i];e._cacheIndex=i,t[i]=e,o._cacheIndex=n,t[n]=o}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,o=t[i];e._cacheIndex=i,t[i]=e,o._cacheIndex=n,t[n]=o}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,o=this._bindings;let s=i[t];s===void 0&&(s={},i[t]=s),s[n]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,o=n.path,s=this._bindingsByRootAndName,a=s[i],h=t[t.length-1],u=e._cacheIndex;h._cacheIndex=u,t[u]=h,t.pop(),delete a[o],Object.keys(a).length===0&&delete s[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,o=t[i];e._cacheIndex=i,t[i]=e,o._cacheIndex=n,t[n]=o}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,o=t[i];e._cacheIndex=i,t[i]=e,o._cacheIndex=n,t[n]=o}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new Rg(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,o=t[i];e.__cacheIndex=i,t[i]=e,o.__cacheIndex=n,t[n]=o}clipAction(e,t,n){const i=t||this._root,o=i.uuid;let s=typeof e=="string"?rd.findByName(i,e):e;const a=s!==null?s.uuid:e,h=this._actionsByClip[a];let u=null;if(n===void 0&&(n=s!==null?s.blendMode:xs),h!==void 0){const d=h.actionByRoot[o];if(d!==void 0&&d.blendMode===n)return d;u=h.knownActions[0],s===null&&(s=u._clip)}if(s===null)return null;const c=new kw(this,s,t,n);return this._bindAction(c,u),this._addInactiveAction(c,a,o),c}existingAction(e,t){const n=t||this._root,i=n.uuid,o=typeof e=="string"?rd.findByName(n,e):e,s=o?o.uuid:e,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,o=Math.sign(e),s=this._accuIndex^=1;for(let u=0;u!==n;++u)t[u]._update(i,e,o,s);const a=this._bindings,h=this._nActiveBindings;for(let u=0;u!==h;++u)a[u].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,o=i[n];if(o!==void 0){const s=o.knownActions;for(let a=0,h=s.length;a!==h;++a){const u=s[a];this._deactivateAction(u);const c=u._cacheIndex,d=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,d._cacheIndex=c,t[c]=d,t.pop(),this._removeInactiveBindingsForAction(u)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const s=n[o].actionByRoot[t];s!==void 0&&(this._deactivateAction(s),this._removeInactiveAction(s))}const i=this._bindingsByRootAndName[t];if(i!==void 0)for(const o in i){const s=i[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}R_.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class If{constructor(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new If(this.value.clone===void 0?this.value:this.value.clone())}}class C_ extends ks{constructor(e,t,n=1){super(e,t),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}C_.prototype.isInstancedInterleavedBuffer=!0;class I_{constructor(e,t,n,i,o){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}I_.prototype.isGLBufferAttribute=!0;class Gw{constructor(e,t,n=0,i=1/0){this.ray=new mo(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new gc,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!1,n=[]){return Wg(e,this,n,t),n.sort(L_),n}intersectObjects(e,t=!1,n=[]){for(let i=0,o=e.length;i<o;i++)Wg(e[i],this,n,t);return n.sort(L_),n}}function L_(r,e){return r.distance-e.distance}function Wg(r,e,t,n){if(r.layers.test(e.layers)&&r.raycast(e,t),n===!0){const i=r.children;for(let o=0,s=i.length;o<s;o++)Wg(i[o],e,t,!0)}}class Hw{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(xi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class zw{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}const O_=new $e;class Al{constructor(e=new $e(1/0,1/0),t=new $e(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=O_.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return O_.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Al.prototype.isBox2=!0;const D_=new w,Lf=new w;class N_{constructor(e=new w,t=new w){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){D_.subVectors(e,this.start),Lf.subVectors(this.end,this.start);const n=Lf.dot(Lf);let i=Lf.dot(D_)/n;return t&&(i=xi(i,0,1)),i}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class F_ extends jt{constructor(e){super(),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}F_.prototype.isImmediateRenderObject=!0;const B_=new w;class Vw extends jt{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new St,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,h=32;s<h;s++,a++){const u=s/h*Math.PI*2,c=a/h*Math.PI*2;i.push(Math.cos(u),Math.sin(u),1,Math.cos(c),Math.sin(c),1)}n.setAttribute("position",new rt(i,3));const o=new gi({fog:!1,toneMapped:!1});this.cone=new E(n,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),B_.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(B_),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ba=new w,Of=new ct,Xg=new ct;class U_ extends E{constructor(e){const t=function h(u){const c=[];u&&u.isBone&&c.push(u);for(let d=0;d<u.children.length;d++)c.push.apply(c,h(u.children[d]));return c}(e),n=new St,i=[],o=[],s=new ft(0,0,1),a=new ft(0,1,0);for(let h=0;h<t.length;h++){const u=t[h];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),o.push(s.r,s.g,s.b),o.push(a.r,a.g,a.b))}n.setAttribute("position",new rt(i,3)),n.setAttribute("color",new rt(o,3)),super(n,new gi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");Xg.copy(this.root.matrixWorld).invert();for(let o=0,s=0;o<t.length;o++){const a=t[o];a.parent&&a.parent.isBone&&(Of.multiplyMatrices(Xg,a.matrixWorld),Ba.setFromMatrixPosition(Of),i.setXYZ(s,Ba.x,Ba.y,Ba.z),Of.multiplyMatrices(Xg,a.parent.matrixWorld),Ba.setFromMatrixPosition(Of),i.setXYZ(s+1,Ba.x,Ba.y,Ba.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}class jw extends sn{constructor(e,t,n){super(new Lh(t,4,2),new Zn({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Ww=new w,k_=new ft,G_=new ft;class Xw extends jt{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const i=new Ch(t);i.rotateY(.5*Math.PI),this.material=new Zn({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const o=i.getAttribute("position"),s=new Float32Array(3*o.count);i.setAttribute("color",new Yt(s,3)),this.add(new sn(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");k_.copy(this.light.color),G_.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const o=n<i/2?k_:G_;t.setXYZ(n,o.r,o.g,o.b)}t.needsUpdate=!0}e.lookAt(Ww.setFromMatrixPosition(this.light.matrixWorld).negate())}}class H_ extends E{constructor(e=10,t=10,n=4473924,i=8947848){n=new ft(n),i=new ft(i);const o=t/2,s=e/t,a=e/2,h=[],u=[];for(let d=0,f=0,m=-a;d<=t;d++,m+=s){h.push(-a,0,m,a,0,m),h.push(m,0,-a,m,0,a);const g=d===o?n:i;g.toArray(u,f),f+=3,g.toArray(u,f),f+=3,g.toArray(u,f),f+=3,g.toArray(u,f),f+=3}const c=new St;c.setAttribute("position",new rt(h,3)),c.setAttribute("color",new rt(u,3)),super(c,new gi({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class Yw extends E{constructor(e=10,t=16,n=8,i=64,o=4473924,s=8947848){o=new ft(o),s=new ft(s);const a=[],h=[];for(let c=0;c<=t;c++){const d=c/t*(2*Math.PI),f=Math.sin(d)*e,m=Math.cos(d)*e;a.push(0,0,0),a.push(f,0,m);const g=1&c?o:s;h.push(g.r,g.g,g.b),h.push(g.r,g.g,g.b)}for(let c=0;c<=n;c++){const d=1&c?o:s,f=e-e/n*c;for(let m=0;m<i;m++){let g=m/i*(2*Math.PI),v=Math.sin(g)*f,x=Math.cos(g)*f;a.push(v,0,x),h.push(d.r,d.g,d.b),g=(m+1)/i*(2*Math.PI),v=Math.sin(g)*f,x=Math.cos(g)*f,a.push(v,0,x),h.push(d.r,d.g,d.b)}}const u=new St;u.setAttribute("position",new rt(a,3)),u.setAttribute("color",new rt(h,3)),super(u,new gi({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const z_=new w,Df=new w,V_=new w;class qw extends jt{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,t===void 0&&(t=1);let i=new St;i.setAttribute("position",new rt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const o=new gi({fog:!1,toneMapped:!1});this.lightPlane=new l(i,o),this.add(this.lightPlane),i=new St,i.setAttribute("position",new rt([0,0,0,0,0,1],3)),this.targetLine=new l(i,o),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){z_.setFromMatrixPosition(this.light.matrixWorld),Df.setFromMatrixPosition(this.light.target.matrixWorld),V_.subVectors(Df,z_),this.lightPlane.lookAt(Df),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Df),this.targetLine.scale.z=V_.length()}}const Nf=new w,ei=new Os;class Zw extends E{constructor(e){const t=new St,n=new gi({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],o=[],s={},a=new ft(16755200),h=new ft(16711680),u=new ft(43775),c=new ft(16777215),d=new ft(3355443);function f(g,v,x){m(g,x),m(v,x)}function m(g,v){i.push(0,0,0),o.push(v.r,v.g,v.b),s[g]===void 0&&(s[g]=[]),s[g].push(i.length/3-1)}f("n1","n2",a),f("n2","n4",a),f("n4","n3",a),f("n3","n1",a),f("f1","f2",a),f("f2","f4",a),f("f4","f3",a),f("f3","f1",a),f("n1","f1",a),f("n2","f2",a),f("n3","f3",a),f("n4","f4",a),f("p","n1",h),f("p","n2",h),f("p","n3",h),f("p","n4",h),f("u1","u2",u),f("u2","u3",u),f("u3","u1",u),f("c","t",c),f("p","c",d),f("cn1","cn2",d),f("cn3","cn4",d),f("cf1","cf2",d),f("cf3","cf4",d),t.setAttribute("position",new rt(i,3)),t.setAttribute("color",new rt(o,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){const e=this.geometry,t=this.pointMap;ei.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ui("c",t,e,ei,0,0,-1),ui("t",t,e,ei,0,0,1),ui("n1",t,e,ei,-1,-1,-1),ui("n2",t,e,ei,1,-1,-1),ui("n3",t,e,ei,-1,1,-1),ui("n4",t,e,ei,1,1,-1),ui("f1",t,e,ei,-1,-1,1),ui("f2",t,e,ei,1,-1,1),ui("f3",t,e,ei,-1,1,1),ui("f4",t,e,ei,1,1,1),ui("u1",t,e,ei,.7,1.1,-1),ui("u2",t,e,ei,-.7,1.1,-1),ui("u3",t,e,ei,0,2,-1),ui("cf1",t,e,ei,-1,0,1),ui("cf2",t,e,ei,1,0,1),ui("cf3",t,e,ei,0,-1,1),ui("cf4",t,e,ei,0,1,1),ui("cn1",t,e,ei,-1,0,-1),ui("cn2",t,e,ei,1,0,-1),ui("cn3",t,e,ei,0,-1,-1),ui("cn4",t,e,ei,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ui(r,e,t,n,i,o,s){Nf.set(i,o,s).unproject(n);const a=e[r];if(a!==void 0){const h=t.getAttribute("position");for(let u=0,c=a.length;u<c;u++)h.setXYZ(a[u],Nf.x,Nf.y,Nf.z)}}const Ff=new Rn;class j_ extends E{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),o=new St;o.setIndex(new Yt(n,1)),o.setAttribute("position",new Yt(i,3)),super(o,new gi({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Ff.setFromObject(this.object),Ff.isEmpty())return;const t=Ff.min,n=Ff.max,i=this.geometry.attributes.position,o=i.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=t.x,o[4]=n.y,o[5]=n.z,o[6]=t.x,o[7]=t.y,o[8]=n.z,o[9]=n.x,o[10]=t.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=t.z,o[15]=t.x,o[16]=n.y,o[17]=t.z,o[18]=t.x,o[19]=t.y,o[20]=t.z,o[21]=n.x,o[22]=t.y,o[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return E.prototype.copy.call(this,e),this.object=e.object,this}}class $w extends E{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new St;i.setIndex(new Yt(n,1)),i.setAttribute("position",new rt([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new gi({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class Jw extends l{constructor(e,t=1,n=16776960){const i=n,o=new St;o.setAttribute("position",new rt([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),o.computeBoundingSphere(),super(o,new gi({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const s=new St;s.setAttribute("position",new rt([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),s.computeBoundingSphere(),this.add(new sn(s,new Zn({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?j:G,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const W_=new w;let Bf,Yg;class Kw extends jt{constructor(e=new w(0,0,1),t=new w(0,0,0),n=1,i=16776960,o=.2*n,s=.2*o){super(),this.type="ArrowHelper",Bf===void 0&&(Bf=new St,Bf.setAttribute("position",new rt([0,0,0,0,1,0],3)),Yg=new Tt(0,.5,1,5,1),Yg.translate(0,-.5,0)),this.position.copy(t),this.line=new l(Bf,new gi({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new sn(Yg,new Zn({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,o,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{W_.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(W_,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class X_ extends E{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new St;n.setAttribute("position",new rt(t,3)),n.setAttribute("color",new rt([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new gi({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const i=new ft,o=this.geometry.attributes.color.array;return i.set(e),i.toArray(o,0),i.toArray(o,3),i.set(t),i.toArray(o,6),i.toArray(o,9),i.set(n),i.toArray(o,12),i.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const Y_=new Float32Array(1),Qw=new Int32Array(Y_.buffer);class eT{static toHalfFloat(e){Y_[0]=e;const t=Qw[0];let n=t>>16&32768,i=t>>12&2047;const o=t>>23&255;return o<103?n:o>142?(n|=31744,n|=(o==255?0:1)&&8388607&t,n):o<113?(i|=2048,n|=(i>>114-o)+(i>>113-o&1),n):(n|=o-112<<10|i>>1,n+=1&i,n)}}const es=Math.pow(2,8),q_=[.125,.215,.35,.446,.526,.582],Z_=5+q_.length,ts={[xt]:0,[Zt]:1,[Ki]:2,[th]:3,[uc]:4,[zi]:5,[kn]:6},Hh=new Zn({side:j,depthWrite:!1,depthTest:!1}),tT=new sn(new Yr,Hh),qg=new Ml,{_lodPlanes:hd,_sizeLods:$_,_sigmas:Uf}=rT(),J_=new ft;let Zg=null;const zh=(1+Math.sqrt(5))/2,Pl=1/zh,K_=[new w(1,1,1),new w(-1,1,1),new w(1,1,-1),new w(-1,1,-1),new w(0,zh,Pl),new w(0,zh,-Pl),new w(Pl,0,zh),new w(-Pl,0,zh),new w(zh,Pl,0),new w(-zh,Pl,0)];function Q_(r){const e=Math.max(r.r,r.g,r.b),t=Math.min(Math.max(Math.ceil(Math.log2(e)),-128),127);return r.multiplyScalar(Math.pow(2,-t)),(t+128)/255}class nT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(t){const n=new Float32Array(t),i=new w(0,1,0);return new Sl({name:"SphericalGaussianBlur",defines:{n:t},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i},inputEncoding:{value:ts[xt]},outputEncoding:{value:ts[xt]}},vertexShader:$g(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			${Jg()}

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Ze,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){Zg=this._renderer.getRenderTarget();const o=this._allocateTargets();return this._sceneToCubeUV(e,n,i,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=ny(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=ty(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let e=0;e<hd.length;e++)hd[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Zg),e.scissorTest=!1,kf(e,0,0,e.width,e.height)}_fromTexture(e){Zg=this._renderer.getRenderTarget();const t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}_allocateTargets(e){const t={magFilter:Xn,minFilter:Xn,generateMipmaps:!1,type:No,format:dp,encoding:iT(e)?e.encoding:Ki,depthBuffer:!1},n=ey(t);return n.depthBuffer=!e,this._pingPongRenderTarget=ey(t),n}_compileMaterial(e){const t=new sn(hd[0],e);this._renderer.compile(t,qg)}_sceneToCubeUV(e,t,n,i){const o=new $n(90,1,t,n),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],h=this._renderer,u=h.autoClear,c=h.outputEncoding,d=h.toneMapping;h.getClearColor(J_),h.toneMapping=io,h.outputEncoding=xt,h.autoClear=!1;let f=!1;const m=e.background;if(m){if(m.isColor){Hh.color.copy(m).convertSRGBToLinear(),e.background=null;const g=Q_(Hh.color);Hh.opacity=g,f=!0}}else{Hh.color.copy(J_).convertSRGBToLinear();const g=Q_(Hh.color);Hh.opacity=g,f=!0}for(let g=0;g<6;g++){const v=g%3;v==0?(o.up.set(0,s[g],0),o.lookAt(a[g],0,0)):v==1?(o.up.set(0,0,s[g]),o.lookAt(0,a[g],0)):(o.up.set(0,s[g],0),o.lookAt(0,0,a[g])),kf(i,v*es,g>2?es:0,es,es),h.setRenderTarget(i),f&&h.render(tT,o),h.render(e,o)}h.toneMapping=d,h.outputEncoding=c,h.autoClear=u}_textureToCubeUV(e,t){const n=this._renderer;e.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=ny()):this._equirectShader==null&&(this._equirectShader=ty());const i=e.isCubeTexture?this._cubemapShader:this._equirectShader,o=new sn(hd[0],i),s=i.uniforms;s.envMap.value=e,e.isCubeTexture||s.texelSize.value.set(1/e.image.width,1/e.image.height),s.inputEncoding.value=ts[e.encoding],s.outputEncoding.value=ts[t.texture.encoding],kf(t,0,0,3*es,2*es),n.setRenderTarget(t),n.render(o,qg)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<Z_;i++){const o=Math.sqrt(Uf[i]*Uf[i]-Uf[i-1]*Uf[i-1]),s=K_[(i-1)%K_.length];this._blur(e,i-1,i,o,s)}t.autoClear=n}_blur(e,t,n,i,o){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",o),this._halfBlur(s,e,n,n,i,"longitudinal",o)}_halfBlur(e,t,n,i,o,s,a){const h=this._renderer,u=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new sn(hd[i],u),d=u.uniforms,f=$_[n]-1,m=isFinite(o)?Math.PI/(2*f):2*Math.PI/39,g=o/m,v=isFinite(o)?1+Math.floor(3*g):20;v>20&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${v} samples when the maximum is set to 20`);const x=[];let T=0;for(let C=0;C<20;++C){const D=C/g,R=Math.exp(-D*D/2);x.push(R),C==0?T+=R:C<v&&(T+=2*R)}for(let C=0;C<x.length;C++)x[C]=x[C]/T;d.envMap.value=e.texture,d.samples.value=v,d.weights.value=x,d.latitudinal.value=s==="latitudinal",a&&(d.poleAxis.value=a),d.dTheta.value=m,d.mipInt.value=8-n,d.inputEncoding.value=ts[e.texture.encoding],d.outputEncoding.value=ts[e.texture.encoding];const M=$_[i];kf(t,3*Math.max(0,es-2*M),(i===0?0:2*es)+2*M*(i>4?i-8+4:0),3*M,2*M),h.setRenderTarget(t),h.render(c,qg)}}function iT(r){return r!==void 0&&r.type===No&&(r.encoding===xt||r.encoding===Zt||r.encoding===kn)}function rT(){const r=[],e=[],t=[];let n=8;for(let i=0;i<Z_;i++){const o=Math.pow(2,n);e.push(o);let s=1/o;i>4?s=q_[i-8+4-1]:i==0&&(s=0),t.push(s);const a=1/(o-1),h=-a/2,u=1+a/2,c=[h,h,u,h,u,u,h,h,u,u,h,u],d=6,f=6,m=3,g=2,v=1,x=new Float32Array(m*f*d),T=new Float32Array(g*f*d),M=new Float32Array(v*f*d);for(let D=0;D<d;D++){const R=D%3*2/3-1,F=D>2?0:-1,O=[R,F,0,R+2/3,F,0,R+2/3,F+1,0,R,F,0,R+2/3,F+1,0,R,F+1,0];x.set(O,m*f*D),T.set(c,g*f*D);const U=[D,D,D,D,D,D];M.set(U,v*f*D)}const C=new St;C.setAttribute("position",new Yt(x,m)),C.setAttribute("uv",new Yt(T,g)),C.setAttribute("faceIndex",new Yt(M,v)),r.push(C),n>4&&n--}return{_lodPlanes:r,_sizeLods:e,_sigmas:t}}function ey(r){const e=new Ar(3*es,3*es,r);return e.texture.mapping=ra,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function kf(r,e,t,n,i){r.viewport.set(e,t,n,i),r.scissor.set(e,t,n,i)}function ty(){const r=new $e(1,1);return new Sl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:r},inputEncoding:{value:ts[xt]},outputEncoding:{value:ts[xt]}},vertexShader:$g(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${Jg()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Ze,depthTest:!1,depthWrite:!1})}function ny(){return new Sl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:ts[xt]},outputEncoding:{value:ts[xt]}},vertexShader:$g(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${Jg()}

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Ze,depthTest:!1,depthWrite:!1})}function $g(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Jg(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}const oT=0,sT=1,aT=0,hT=1,uT=2;function lT(r){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),r}function cT(r=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),r.isMultiMaterial=!0,r.materials=r,r.clone=function(){return r.slice()},r}function dT(r,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new He(r,e)}function pT(r){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Ah(r)}function fT(r,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new He(r,e)}function mT(r){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new H(r)}function gT(r){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new H(r)}function vT(r){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new H(r)}function _T(r,e,t){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new w(r,e,t)}function yT(r,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Yt(r,e).setUsage(Gr)}function xT(r,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new dh(r,e)}function bT(r,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Tc(r,e)}function wT(r,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Wu(r,e)}function TT(r,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Sc(r,e)}function ST(r,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new va(r,e)}function ET(r,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Xu(r,e)}function MT(r,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Lr(r,e)}function AT(r,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new rt(r,e)}function PT(r,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Ec(r,e)}function RT(r){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new X_(r)}function CT(r,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new j_(r,e)}function IT(r,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new E(new wi(r.geometry),new gi({color:e!==void 0?e:16777215}))}function LT(r,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new E(new wg(r.geometry),new gi({color:e!==void 0?e:16777215}))}function OT(r){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new So(r)}function DT(r){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new n_(r)}function NT(r,e,t){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Mt(r,t)}function FT(){console.error("THREE.CanvasRenderer has been removed")}function BT(){console.error("THREE.JSONLoader has been removed.")}Vn.create=function(r,e){return console.log("THREE.Curve.create() has been deprecated"),r.prototype=Object.create(Vn.prototype),r.prototype.constructor=r,r.prototype.getPoint=e,r},Fh.prototype.fromPoints=function(r){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(r)},H_.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},U_.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Xi.prototype.extractUrlBase=function(r){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Rf.extractUrlBase(r)},Xi.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Al.prototype.center=function(r){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(r)},Al.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Al.prototype.isIntersectionBox=function(r){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},Al.prototype.size=function(r){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(r)},Rn.prototype.center=function(r){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(r)},Rn.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Rn.prototype.isIntersectionBox=function(r){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},Rn.prototype.isIntersectionSphere=function(r){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)},Rn.prototype.size=function(r){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(r)},oi.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Sa.prototype.setFromMatrix=function(r){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(r)},N_.prototype.center=function(r){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(r)},Tn.prototype.flattenToArrayOffset=function(r,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,e)},Tn.prototype.multiplyVector3=function(r){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)},Tn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Tn.prototype.applyToBufferAttribute=function(r){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)},Tn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Tn.prototype.getInverse=function(r){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(r).invert()},ct.prototype.extractPosition=function(r){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(r)},ct.prototype.flattenToArrayOffset=function(r,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,e)},ct.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new w().setFromMatrixColumn(this,3)},ct.prototype.setRotationFromQuaternion=function(r){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(r)},ct.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},ct.prototype.multiplyVector3=function(r){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},ct.prototype.multiplyVector4=function(r){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},ct.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},ct.prototype.rotateAxis=function(r){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),r.transformDirection(this)},ct.prototype.crossVector=function(r){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},ct.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},ct.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},ct.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},ct.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},ct.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},ct.prototype.applyToBufferAttribute=function(r){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},ct.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},ct.prototype.makeFrustum=function(r,e,t,n,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(r,e,n,t,i,o)},ct.prototype.getInverse=function(r){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(r).invert()},mr.prototype.isIntersectionLine=function(r){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(r)},pi.prototype.multiplyVector3=function(r){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),r.applyQuaternion(this)},pi.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},mo.prototype.isIntersectionBox=function(r){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},mo.prototype.isIntersectionPlane=function(r){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(r)},mo.prototype.isIntersectionSphere=function(r){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)},Sn.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Sn.prototype.barycoordFromPoint=function(r,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(r,e)},Sn.prototype.midpoint=function(r){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(r)},Sn.prototypenormal=function(r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(r)},Sn.prototype.plane=function(r){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(r)},Sn.barycoordFromPoint=function(r,e,t,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Sn.getBarycoord(r,e,t,n,i)},Sn.normal=function(r,e,t,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Sn.getNormal(r,e,t,n)},Fa.prototype.extractAllPoints=function(r){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(r)},Fa.prototype.extrude=function(r){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new bo(this,r)},Fa.prototype.makeGeometry=function(r){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Ih(this,r)},$e.prototype.fromAttribute=function(r,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,e,t)},$e.prototype.distanceToManhattan=function(r){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)},$e.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},w.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},w.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},w.prototype.getPositionFromMatrix=function(r){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(r)},w.prototype.getScaleFromMatrix=function(r){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(r)},w.prototype.getColumnFromMatrix=function(r,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,r)},w.prototype.applyProjection=function(r){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(r)},w.prototype.fromAttribute=function(r,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,e,t)},w.prototype.distanceToManhattan=function(r){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)},w.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},cn.prototype.fromAttribute=function(r,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,e,t)},cn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},jt.prototype.getChildByName=function(r){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(r)},jt.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},jt.prototype.translate=function(r,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,r)},jt.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},jt.prototype.applyMatrix=function(r){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)},Object.defineProperties(jt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(r){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=r}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),sn.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(sn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Ve},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Ca.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},$n.prototype.setLens=function(r,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),e!==void 0&&(this.filmGauge=e),this.setFocalLength(r)},Object.defineProperties(Eo.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(r){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=r}},shadowCameraLeft:{set:function(r){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=r}},shadowCameraRight:{set:function(r){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=r}},shadowCameraTop:{set:function(r){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=r}},shadowCameraBottom:{set:function(r){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=r}},shadowCameraNear:{set:function(r){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=r}},shadowCameraFar:{set:function(r){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=r}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(r){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=r}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(r){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=r}},shadowMapHeight:{set:function(r){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=r}}}),Object.defineProperties(Yt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Gr},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Gr)}}}),Yt.prototype.setDynamic=function(r){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?Gr:bs),this},Yt.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Yt.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},St.prototype.addIndex=function(r){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(r)},St.prototype.addAttribute=function(r,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?r==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(r,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(r,new Yt(arguments[1],arguments[2])))},St.prototype.addDrawCall=function(r,e,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(r,e)},St.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},St.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},St.prototype.removeAttribute=function(r){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(r)},St.prototype.applyMatrix=function(r){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)},Object.defineProperties(St.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),ks.prototype.setDynamic=function(r){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?Gr:bs),this},ks.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},bo.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},bo.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},bo.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Aa.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},If.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(fi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ft}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(r){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===Je}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(r){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=r}}}),Object.defineProperties(Ni.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(r){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=r}}}),dn.prototype.clearTarget=function(r,e,t,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(r),this.clear(e,t,n)},dn.prototype.animate=function(r){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(r)},dn.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},dn.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},dn.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},dn.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},dn.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},dn.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},dn.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},dn.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},dn.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},dn.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},dn.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},dn.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},dn.prototype.enableScissorTest=function(r){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(r)},dn.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},dn.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},dn.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},dn.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},dn.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},dn.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},dn.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},dn.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},dn.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},dn.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(dn.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=r}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=r}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(r){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=r===!0?Zt:xt}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Wc.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Ar.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=r}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=r}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=r}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=r}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(r){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=r}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(r){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=r}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(r){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=r}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(r){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=r}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(r){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=r}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(r){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=r}}}),jg.prototype.load=function(r){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return new v_().load(r,function(t){e.setBuffer(t)}),this},M_.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ds.prototype.updateCubeMap=function(r,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(r,e)},Ds.prototype.clear=function(r,e,t,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(r,e,t,n)},lr.crossOrigin=void 0,lr.loadTexture=function(r,e,t,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const i=new Lg;i.setCrossOrigin(this.crossOrigin);const o=i.load(r,t,void 0,n);return e&&(o.mapping=e),o},lr.loadTextureCube=function(r,e,t,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const i=new t_;i.setCrossOrigin(this.crossOrigin);const o=i.load(r,t,void 0,n);return e&&(o.mapping=e),o},lr.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},lr.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const UT={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function kT(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:V}})),typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=V);const _r=`
vec4 blendSrcOver(vec4 src, vec4 dist) {
    vec4 result = vec4(0.0, 0.0, 0.0, 0.0);

    src.r *= src.a;
    src.g *= src.a;
    src.b *= src.a;

    result.a = src.a + dist.a * (1.0 - src.a);
    result.r = (src.r + dist.r * (1.0 - src.a)) / result.a;
    result.g = (src.g + dist.g * (1.0 - src.a)) / result.a;
    result.b = (src.b + dist.b * (1.0 - src.a)) / result.a;

    return result;
}
`,yr=`
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
    float pi = 3.14159265358;
    float current;
    float duration = 1.0;
    if (timePercent < start) {
        current = 0.0;
    } else if (timePercent > end) {
        current = 1.0;
    } else {
        current = (timePercent - start) / (end - start);
    }

    if (timing == 0) {        // \u7EBF\u6027
        return (current / duration) * (to - from) + from;
    } else if (timing == 1) { // easeIn
        current = current / duration;
        return (to - from) * current * current + from;
    } else if (timing == 2) { // easeOut
        current = current / duration;
        return -1.0 * (to - from) * current * (current - 2.0) + from;
    } else if (timing == 3) { // easeInOut
        current /= duration / 2.0;
        if (current < 1.0) {
            return (to - from) / 2.0 * current * current + from;
        }
        current--;
        return - (to - from) / 2.0 * (current * (current - 2.0) - 1.0) + from;
    }
}
`,Kg=`
float easeInFloat(float t, float b, float c, float d) {
    t = t / d;
    return c * t * t + b;
}
`;class GT{constructor(){this.camera=new Ml(10,10,10,10),this.camera.position.z=100,this.camera.position.x=0,this.camera.position.y=0}focus(e,t){e.position.z=50}updateAspect(e,t){this.camera.left=-1*e/2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=-1*t/2,this.camera.updateProjectionMatrix()}}class Yi{constructor(){this.camera=new GT,this.mesh=new sn,this.material=null,this.geometry=null}addObjects(e){this.mesh.position.z=50,e.add(this.mesh)}setTexture(e,t,n,i){this.camera.updateAspect(n,i),this.geometry=new Pi(n,i,1,1),this.material=new Ni({fragmentShader:this.fragmentShader,vertexShader:`
varying vec2 vUv;
void main(){
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`}),this.material.uniforms={width:{value:n},height:{value:i},texturePrev:{value:e},textureNext:{value:t},timePercent:{value:0}},this.mesh.geometry=this.geometry,this.mesh.material=this.material}updateAnimation(e){this.material.uniforms.timePercent.value=e}dispose(){var e,t;(e=this.geometry)===null||e===void 0||e.dispose(),(t=this.material)===null||t===void 0||t.dispose()}}class Gf{constructor(){this.camera=new $n(60,1,1,2e3),this.camera.position.z=1e3,this.camera.position.x=0,this.camera.position.y=0}updateAspect(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}focus(e,t){const n=.5*t/Math.tan(Math.PI/6);e.position.z=1e3-n}}class ud{constructor(){this.geometry=new St,this.material=null,this.camera=new Gf,this.mesh=new sn,this.textureWidth=0,this.textureHeight=0,this.prevTexture=new qn,this.nextTexture=new qn}horizontalSegments(){return Math.ceil(this.verticalSegments*this.textureWidth/this.textureHeight)}initMesh(e,t){const n=[],i=[],o=[],s=this.verticalSegments,a=this.horizontalSegments(),h=e/2,u=t/2,c=e/a,d=t/s,f=this.extraAttributes(),m=Object.keys(f),g=m.reduce((v,x)=>(v[x]=[],v),{});for(let v=0;v<s;v++){const x=v*d-u;for(let T=0;T<a;T++){const M=T*c-h;i.push(M,-x,0),o.push(1*T/a,1-1*v/s),m.forEach(C=>g[C].push(...f[C].generator(v,T))),i.push(M+c,-x,0),o.push(1*(T+1)/a,1-1*v/s),m.forEach(C=>g[C].push(...f[C].generator(v,T))),i.push(M,-x-d,0),o.push(1*T/a,1-1*(v+1)/s),m.forEach(C=>g[C].push(...f[C].generator(v,T))),i.push(M+c,-x-d,0),o.push(1*(T+1)/a,1-1*(v+1)/s),m.forEach(C=>g[C].push(...f[C].generator(v,T)))}}for(let v=0;v<s*a;v++){const x=4*v,T=x+1,M=x+2,C=x+3;n.push(T,x,C),n.push(x,M,C)}return this.geometry.setIndex(n),this.geometry.setAttribute("position",new rt(i,3)),this.geometry.setAttribute("uv",new rt(new Float32Array(o),2)),m.forEach(v=>{this.geometry.setAttribute(v,new rt(new Float32Array(g[v]),f[v].itemSize))}),{verticalSegments:s,horizontalSegments:a,segmentWidth:c,segmentHeight:d}}initObject(){this.material=new Ni({fragmentShader:this.fragmentShader,vertexShader:this.vertexShader,side:J})}setTexture(e,t,n,i){this.textureHeight=i,this.textureWidth=n,this.prevTexture=e,this.nextTexture=t,this.initObject();const{verticalSegments:o,horizontalSegments:s,segmentWidth:a,segmentHeight:h}=this.initMesh(n,i);this.material.uniforms={segmentWidth:{value:a},segmentHeight:{value:h},verticalSegments:{value:o},horizontalSegments:{value:s},timePercent:{value:0},texturePrev:{value:e},textureNext:{value:t}},this.mesh.geometry=this.geometry,this.camera.updateAspect(n,i),this.camera.focus(this.mesh,i),this.material.transparent=!0,this.mesh.material=this.material}addObjects(e){e.add(this.mesh)}updateAnimation(e){this.material.uniforms.timePercent.value=e}dispose(){var e,t;(e=this.geometry)===null||e===void 0||e.dispose(),(t=this.material)===null||t===void 0||t.dispose()}}class iy extends ud{constructor(){super(...arguments),this.duration=1250,this.fragmentShader=((e=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float shadowAlpha;

${e.map(t=>t+`
`).join(`
`)}

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);

    vec4 shadow = vec4(0.0, 0.0, 0.0, shadowAlpha);

    gl_FragColor = blendSrcOver(shadow, srcColor);
}
`)([_r]),this.vertexShader=((e=[])=>`
#define PI 3.14159265358

uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;

varying vec2 vUv;
varying float shadowAlpha;

${e.map(t=>t+`
`).join(`
`)}

mat2 rotateOrigin(float angle) {
    return mat2(
        cos(angle), sin(angle),
        -sin(angle), cos(angle)
    ); 
}

void main() {
    float halfWidth = segmentWidth * horizontalSegments * 0.5;
    float halfHeight = segmentHeight * verticalSegments * 0.5;
    vUv = uv;
    vec2 shadowPosition = vec2(position.xy);
    float rotateAngle = PI * 0.27;
    float min_r = halfWidth * 0.05;
    shadowPosition = rotateOrigin(rotateAngle) * shadowPosition;

    vec4 newPosition = vec4(shadowPosition.xy, position.z, 1.0);

    float line = interpolationFloat(0.0, halfWidth * 2.8, 0.0, 1.0, timePercent, 1);
    float dis2BaseLine = halfWidth - newPosition.x;
    float dis2Line = line - dis2BaseLine;
    float L = line <= halfWidth * 2.0 ? line : halfWidth * 2.0;
    float r = L / PI;
    r = r < min_r ? min_r : r;
    float angle = dis2Line / r;

    if (dis2Line > 0.0 && dis2Line < line * 0.5 && r > min_r) {
        shadowAlpha = interpolationFloat(0.0, 0.3, 0.0, line * 0.5, dis2Line, 0);
    } else {
        shadowAlpha = 0.0;
    }

    if (dis2BaseLine < line) {
        newPosition.x = sin(angle) * r + halfWidth - line;
        newPosition.z = (r - cos(angle) * r) * 0.5;
    }
    
    vec2 finalPosition = vec2(newPosition.xy);
    finalPosition = rotateOrigin(-rotateAngle) * finalPosition;

    gl_Position = projectionMatrix * modelViewMatrix * vec4(finalPosition.xy, newPosition.z, 1.0);
}
`)([yr,Kg]),this.verticalSegments=100}addObjects(e){e.add(this.mesh),e.background=this.nextTexture}extraAttributes(){return{}}}const HT=new w(0,-0,0).multiplyScalar(.1);class zT{constructor(e,t,n,i,o){this.position=new w,this.previous=new w,this.original=new w,this.a=new w(0,0,0),this.mass=i,this.invMass=1/i,this.tmp=new w,this.tmp2=new w,o(e,t,this.position),o(e,t,this.previous),o(e,t,this.original)}addForce(e){this.a.add(this.tmp2.copy(e).multiplyScalar(this.invMass))}integrate(e,t,n){const i=.25*Math.PI,o=.25*-Math.PI,s=new Tn,a=new Tn;s.set(Math.cos(i),-Math.sin(i),0,Math.sin(i),Math.cos(i),0,0,0,1),a.set(Math.cos(o),-Math.sin(o),0,Math.sin(o),Math.cos(o),0,0,0,1);const h=this.tmp.subVectors(this.position,this.previous);h.multiplyScalar(.97).add(this.position),h.add(this.a.multiplyScalar(e)),this.tmp=this.previous,this.previous=this.position,this.position=h,this.a.set(0,0,0)}}class VT{constructor(e,t,n){this.width=e,this.height=t;const i=[],o=[];for(let a=0;a<=t;a++)for(let h=0;h<=e;h++)i.push(new zT(h/e,a/t,0,.1,n));for(let a=0;a<t;a++)for(let h=0;h<e;h++)o.push([i[s(h,a)],i[s(h,a+1)],25]),o.push([i[s(h,a)],i[s(h+1,a)],25]);for(let a=e,h=0;h<t;h++)o.push([i[s(a,h)],i[s(a,h+1)],25]);for(let a=t,h=0;h<e;h++)o.push([i[s(h,a)],i[s(h+1,a)],25]);function s(a,h){return a+h*(e+1)}this.particles=i,this.constraints=o,this.index=s}}const jT={RandomLines:class extends Yi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=((r=[])=>`
uniform float lines[26];
varying vec2 vUv;
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;

${r.map(e=>e+`
`)}

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);
    float middleAlpha = 0.0;
    float endAlpha = 0.0;
    float headLength = 0.0;

    if (timePercent < 0.5) {
        middleAlpha = 1.0;
        endAlpha = 1.0 - timePercent / 0.5;
    } else {
        middleAlpha = 1.0 - (timePercent - 0.5) / 0.5;
        endAlpha = 0.0;
    }

    for ( int i = 0; i < 26; i ++ ) {
        float halfDis = lines[i] / 2.0;
        float middleX = headLength + halfDis;
        headLength += lines[i];

        if (abs(vUv.x - middleX) <= halfDis) {
            srcColor.a = endAlpha + (halfDis - abs(vUv.x - middleX)) / halfDis * (middleAlpha - endAlpha);
            gl_FragColor = blendSrcOver(srcColor, distColor);
            return;
        }
    }
    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`)([_r])}genRandomLines(){let r=[1];for(let t=20;t--;){let n=r.sort((h,u)=>u-h)[0],i=r.indexOf(n),o=Math.random(),s=n*o,a=n*(1-o);r.splice(i,1),r.push(s,a)}let e=r.length;for(;e;){let t=Math.floor(Math.random()*e--);[r[t],r[e]]=[r[e],r[t]]}return r}setTexture(r,e,t,n){super.setTexture(r,e,t,n),this.material.uniforms.lines={value:this.genRandomLines()},this.material.vertexShader=`
varying vec2 vUv;
void main(){
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );;
}
`}},Shape:class extends Yi{constructor(){super(...arguments),this.duration=800,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;

varying vec2 vUv;
${r.map(e=>e+`
`)}

// \u5C06 uv \u5750\u6807\u53D8\u6362\u5230\u4EE5 [0.5, 0.5] \u4E3A\u539F\u70B9\u7684\u5750\u6807
vec2 transform(vec2 uv) {
    uv.y = uv.y * height / width;
    return uv - vec2(0.5, 0.5 * height / width);
}

void main(){
    float maxR;
    float ringR;
    float radiusMin;
    float radiusMax;
    float dist;
    vec2 uv = vec2(vUv.x, vUv.y);
    maxR = length(transform(vec2(1.0, 1.0)));
    ringR = 1.0 / 6.0;
    
    radiusMin = timePercent * maxR;
    radiusMax = radiusMin + ringR;
    dist = length(transform(uv));
    
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);

    if (dist < radiusMin) {
        srcColor.a = 0.0;
    } else if (dist >= radiusMin && dist <= radiusMax) {
        srcColor.a = (dist - radiusMin) / ringR;
    } else {
        srcColor.a = 1.0;
    }
    
    if (timePercent >= 1.0) {
        srcColor.a = 0.0;
    } else if (timePercent == 0.0) {
        srcColor.a = 1.0;
    }

    gl_FragColor = blendSrcOver(srcColor, distColor);;
}
`)([_r])}},Ripples:class extends Yi{constructor(){super(...arguments),this.duration=1400,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;

varying vec2 vUv;
${r.map(e=>e+`
`)}

// \u5C06 uv \u5750\u6807\u53D8\u6362\u5230\u4EE5 [0.5, 0.5] \u4E3A\u539F\u70B9\u7684\u5750\u6807
vec2 transform(vec2 uv) {
    uv.y = uv.y * height / width;
    return uv - vec2(0.5, 0.5 * height / width);
}

vec2 offset(float progress[4], float band, float amp, float radius) {
    vec2 tc = vUv.xy;
    vec2 uv = vec2(0.0, 0.0);
    vec2 p;
    float len;
    vec2 uv_offset;
    float wave_width = band * radius;

    for (int i = 0; i < 4; i += 1) {
        if (progress[i] == -1.0) {
            continue;
        }

        p = (tc - vec2(0.5, 0.5));
        p.x = p.x * width / height;
        len = length(p);

        float current_progress = progress[i];
        float current_radius = radius * current_progress;
        float damp_factor = 1.0;
        if (current_progress > .5) {
            damp_factor = (1.0 - current_progress) * 2.0;
        }

        float cut_factor = clamp(wave_width * damp_factor - abs(current_radius - len), 0.0, 1.0);
        float waves_factor = 4.0 * len / radius;
        uv_offset = (p / len) * cos((waves_factor - current_progress * 10.0) * 3.14) * amp * cut_factor;

        uv += uv_offset;
    }
    return uv;
}

void main(){
    float maxR;
    float ringR;
    float radiusMin;
    float radiusMax;
    float dist;
    float progress[4];
    vec2 uv = vUv.xy;
    vec2 uvOffset = vec2(0.0, 0.0);
    maxR = length(transform(vec2(1.0, 1.0)));
    ringR = 1.0 / 6.0;
    
    radiusMin = timePercent * maxR;
    radiusMax = radiusMin + ringR;
    dist = length(transform(uv));

    for (int i = 0; i < 4; i++) {
        progress[i] = timePercent + 0.1 * float(i);
        if (progress[i] < 0.0) {
            progress[i] = 0.0;
        }
    }
    uvOffset = offset(progress, 0.2, 0.3, 1.0);
    
    vec4 srcColor = texture2D(texturePrev, fract(vUv + uvOffset));
    vec4 distColor = texture2D(textureNext, fract(vUv + uvOffset));

    if (dist < radiusMin) {
        srcColor.a = 0.0;
    } else if (dist >= radiusMin && dist <= radiusMax) {
        srcColor.a = (dist - radiusMin) / ringR;
    } else {
        srcColor.a = 1.0;
    }
    
    if (timePercent >= 1.0) {
        srcColor.a = 0.0;
    } else if (timePercent == 0.0) {
        srcColor.a = 1.0;
    }

    gl_FragColor = blendSrcOver(srcColor, distColor);;
}
`)([_r])}},Erase:class extends Yi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;

varying vec2 vUv;
${r.map(e=>e+`
`)}

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);

    float alphaStart = timePercent > 0.5 ? (timePercent - 0.5) / 0.5 * 1.0 : 1.0;
    float alphaEnd = timePercent < 0.5 ? (0.5 - timePercent) / 0.5 * 1.0 : 0.0;
    float rectStart = 0.5 * (1.0 - timePercent);
    float rectEnd = rectStart + 0.5;
    
    if (timePercent <= 0.33) {
        alphaStart = 1.0;
        alphaEnd = (1.0 - (timePercent / 0.33)) * 1.0;
        rectStart = 0.5;
        rectEnd = 1.0;
    } else if (timePercent > 0.33 && timePercent <= 0.66) {
        alphaStart = 1.0;
        alphaEnd = 0.0;
        rectEnd = 1.0 - (timePercent - 0.33) / 0.33 * 0.5;
        rectStart = rectEnd - 0.5;
    } else {
        alphaStart = (1.0 - timePercent) / (1.0 - 0.66) * 1.0;
        alphaEnd = 0.0;
        rectStart = 0.0;
        rectEnd = 0.5;
    }
    
    if (vUv.x >= rectEnd) {
        srcColor.a = 0.0;
    } else if (vUv.x <= rectStart) {
        srcColor.a = 1.0;
    } else {
        srcColor.a = alphaStart - (vUv.x - rectStart) / 0.5 * (alphaStart - alphaEnd);
    }
    
    gl_FragColor = blendSrcOver(srcColor, distColor);;
}
`)([_r])}},Dissolve:class extends Yi{constructor(){super(...arguments),this.duration=1200,this.fragmentShader=`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform sampler2D dissolveTexture;
varying vec2 vUv;

void main(){
    vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);
    vec4 dissolveColor = texture2D(dissolveTexture, vUv);
    
    if (dissolveColor.r == 0.0) {
        result = srcColor;
    } else {
        result = distColor;
    }
    
    gl_FragColor = result;
}
`,this.dissolveIndices={}}random40(){return Math.ceil(40*Math.random())}setTexture(r,e,t,n){super.setTexture(r,e,t,n);for(let i=0;i<1600;i++){let o=this.random40(),s=this.random40();for(;this.dissolveIndices[`${o}_${s}`]!==void 0;)o=this.random40(),s=this.random40();this.dissolveIndices[`${o}_${s}`]=0}this.material.uniforms.dissolveTexture={value:this.genDissolveToTexture()}}genDissolveToTexture(){var r=new Uint8Array(4800);for(let e=0;e<1600;e++){const t=e%40+1,n=Math.floor(e/40)+1,i=3*e;this.dissolveIndices[`${t}_${n}`]===0?(r[i]=0,r[i+1]=0,r[i+2]=0):(r[i]=255,r[i+1]=255,r[i+2]=255)}return new Zo(r,40,40,oo)}updateAnimation(r){const e=1600*r-Object.keys(this.dissolveIndices).filter(t=>this.dissolveIndices[t]===1).length;for(let t=0;t<e;t++){const n=Object.keys(this.dissolveIndices).filter(o=>this.dissolveIndices[o]===0),i=Math.ceil(Math.random()*n.length)-1;this.dissolveIndices[n[i]]=1}this.material.uniforms.dissolveTexture.value=this.genDissolveToTexture()}},Smooth:class extends Yi{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);
    vec4 result = vec4(0.0, 0.0, 0.0, 0.0);

    if (timePercent < 0.5) {
        float stagePercent = timePercent / 0.5;
        result = srcColor + stagePercent * (1.0 - srcColor);
    } else {
        float stagePercent = (timePercent - 0.5) / 0.5;
        result = 1.0 - stagePercent * (1.0 - distColor);
    }
    
    gl_FragColor = result;
}
`}},FadeInOut:class extends Yi{constructor(){super(...arguments),this.duration=700,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

${r.map(e=>e+`
`)}

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);

    srcColor.a = 1.0 - timePercent;
    
    gl_FragColor = blendSrcOver(srcColor, distColor);;
}
`)([_r])}},Push:class extends Yi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
    float line = interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 3);

    if (vUv.y > line) {
        vec2 uv = vUv.xy;
        uv.y -= line;
        result = texture2D(texturePrev, uv);
    } else {
        vec2 uv = vUv.xy;
        uv.y += 1.0 - line;
        result = texture2D(textureNext, uv);
    }
    
    gl_FragColor = result;
}
`)([yr])}},Separation:class extends Yi{constructor(){super(...arguments),this.duration=1500,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);
    vec2 rectLeft = vec2(0.25, 0.5);
    vec2 rectRight = vec2(0.5, 0.75);
    vec2 alphaLeft = vec2(1.0, 1.0);
    vec2 alphaRight = vec2(1.0, 1.0);
    
    
    
    if (timePercent <= 0.333) {
        alphaLeft.y = 1.0 - timePercent / 0.333;
        alphaRight.x = 1.0 - timePercent / 0.333;
    } else if (timePercent <= 0.666 && timePercent > 0.333) {
        rectLeft.x -= (timePercent - 0.333) / 0.333 * 0.25;
        rectLeft.y = rectLeft.x + 0.25;
        
        rectRight.y += (timePercent - 0.333) / 0.333 * 0.25;
        rectRight.x = rectRight.y - 0.25;
        alphaLeft.y = 0.0;
        alphaRight.x = 0.0;
    } else {
        rectLeft = vec2(0.0, 0.25);
        rectRight = vec2(0.75, 1.0);
        alphaLeft.y = 0.0;
        alphaRight.x = 0.0;
        
        alphaLeft.x = 1.0 - (timePercent - 0.666) / (1.0 - 0.666);
        alphaRight.y = 1.0 - (timePercent - 0.666) / (1.0 - 0.666);
    }
    
    if (vUv.x < rectLeft.x || vUv.x > rectRight.y) {
        srcColor.a = 1.0;
    } else if (vUv.x > rectLeft.y && vUv.x < rectRight.x) {
        srcColor.a = 0.0;
    } else {
        if (vUv.x >= rectLeft.x && vUv.x <= rectLeft.y) {
            srcColor.a = alphaLeft.x - (vUv.x - rectLeft.x) / (rectLeft.y - rectLeft.x) * (alphaLeft.x - alphaLeft.y);
        } else {
            srcColor.a = alphaRight.y - (rectRight.y - vUv.x) / (rectLeft.y - rectLeft.x) * (alphaRight.y - alphaRight.x);
        }
    }
    
    gl_FragColor = blendSrcOver(srcColor, distColor);;
}
`)([_r])}},Display:class extends Yi{constructor(){super(...arguments),this.duration=3400,this.fragmentShader=`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

void main() {
    vec4 uv4 = vec4(vUv.x, vUv.y, 1.0, 1.0);
    float scale = 1.0;
    float transform = 0.0;

    if (timePercent < 0.5) {
        scale = 1.0 - (timePercent / 0.5) * 0.05;
        transform = (1.0 - scale) * 0.5;
    } else {
        scale = 0.95 + ((timePercent - 0.5) / 0.5) * 0.05;
        transform = (1.0 - scale) * 0.5;
    }

    mat4 matrix = mat4(
        scale, 0.0, 0.0, 0.0,
        0.0, scale, 0.0, 0.0,
        0.0, 0.0, 1.0, 0.0,
        transform, transform, 0.0, 1.0
    );
    
    vec4 uv = matrix * uv4;
    
    vec4 srcColor = texture2D(texturePrev, uv.xy);
    vec4 distColor = texture2D(textureNext, uv.xy);
    vec4 result = timePercent < 0.5 ? srcColor : distColor;
    vec3 start;
    vec3 end;
    vec3 white = vec3(1.0, 1.0, 1.0);

    if (timePercent < 0.25 || timePercent > 0.75) {
        result *= 1.0;
    } else if (timePercent >= 0.25 && timePercent <= 0.5) {
        if (timePercent <= 0.375) {
            start = result.rgb;
            end = start + (timePercent - 0.25) / 0.125 * (white - result.rgb);
        } else {
            start = result.rgb + (timePercent - 0.375) / 0.125 * (white - result.rgb);
            end = white; 
        }

        result = vec4(start - vUv.x * (start - end), result.a);
    } else if (timePercent > 0.5 && timePercent <= 0.75) {
        if (timePercent < 0.625) {
            start = white - (timePercent - 0.5) / 0.125 * (white - result.rgb);
            end = white;
        } else {
            start = result.rgb;
            end = white - (timePercent - 0.625) / 0.125 * (white - result.rgb);
        }
        
        result = vec4(start - vUv.x * (start - end), result.a);
    }
    
    gl_FragColor = result;
}
`}},Uncover:class extends Yi{constructor(){super(...arguments),this.duration=750,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
    float line = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);

    if (vUv.x > line) {
        result = texture2D(textureNext, vUv);
    } else {
        vec2 uv = vUv.xy;
        uv.x = 1.0 - (line - vUv.x);
        result = texture2D(texturePrev, uv);
    }
    
    gl_FragColor = result;
}
`)([yr])}},Cover:class extends Yi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
    float line = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 3);

    if (vUv.x > line) {
        vec2 uv = vUv.xy;
        uv.x = vUv.x - line;
        result = texture2D(textureNext, uv);
    } else {
        result = texture2D(texturePrev, vUv);
    }
    
    gl_FragColor = result;
}
`)([yr])}},Flash:class extends Yi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

mat3 yuv2rgb = mat3(
    1.0, 0.0, 1.13983,
    1.0, -0.39465, -0.58060,
    1.0, 2.03211, 0.0
);

mat3 rgb2yuv = mat3(
    0.2126, 0.7152, 0.0722,
    -0.09991, -0.33609, 0.43600,
    0.615, -0.5586, -0.05639
);

void main() {
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);
    vec3 result;
    float resultAlpha;
    
    if (timePercent < 0.5) {
        result = srcColor.rgb * rgb2yuv;
        result.r += interpolationFloat(0.0, 1.0, 0.0, 0.5, timePercent, 0);
        resultAlpha = srcColor.a;
    } else {
        result = distColor.rgb * rgb2yuv;
        result.r += interpolationFloat(1.0, 0.0, 0.5, 1.0, timePercent, 0);
        resultAlpha = distColor.a;
    }
    result *= yuv2rgb;

    gl_FragColor = vec4(result.rgb, resultAlpha);
}
`)([_r,yr])}},Checkerboard:class extends ud{constructor(){super(...arguments),this.duration=2500,this.fragmentShader=`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float fakePercent;

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);
    vec4 color = srcColor;
    
    if (fakePercent > 0.5) {
        color = distColor;
    }

    if (fakePercent < 0.5 && fakePercent > 0.35) {
        color.a = 0.5;
    }

    gl_FragColor = color;
}
`,this.vertexShader=`
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;

attribute vec2 segment;
attribute float times;

varying vec2 vUv;
// \u7528\u4E8E\u63A7\u5236\u5207\u6362\u753B\u9762\u7684\u5EF6\u8FDF
varying float fakePercent;
void main(){
    vUv = uv;

    float width = segmentWidth * horizontalSegments;
    float height = segmentHeight * verticalSegments;

    vec4 newPosition = vec4(position, 1.0);

    vec2 segmentOrigin = vec2((segment.x + 0.5) * segmentWidth - width * 0.5, height * 0.5 - 1.0 * (segment.y + 0.5) * segmentHeight);

    if (timePercent > times) {
        float percent = (timePercent - times) / 0.7;
        if (percent > 1.0) {
            percent = 1.0;
        }
        
        // \u591A\u65CB\u8F6C 180 \u5EA6, \u4F7F\u4E00\u4E0B\u4E2A\u56FE\u7247\u4E0D\u4F1A\u5DE6\u53F3\u98A0\u5012
        if (percent > 0.5) {
            percent += 1.0;
        }
    
        mat4 matrix = mat4(
            cos(-1.0 * percent * 3.14), 0.0, sin(-1.0 * percent * 3.14), 0.0,
            0.0, 1.0, 0.0, 0.0,
            -sin(-1.0 * percent * 3.14), 0.0, cos(-1.0 * percent * 3.14), 0.0,
            0.0, 0.0, 0.0, 1.0
        );
    
        newPosition.x -= segmentOrigin.x;
        newPosition.y -= segmentOrigin.y;
        newPosition = matrix * newPosition;
        newPosition.x += segmentOrigin.x;
        newPosition.y += segmentOrigin.y;
        
        if (segment.x < horizontalSegments / 2.0) {
            fakePercent = percent - abs(horizontalSegments / 2.0 - segment.x) * (0.25 / horizontalSegments);
        } else {
            fakePercent = percent + abs(horizontalSegments / 2.0 - segment.x) * (0.25 / horizontalSegments);
        }
    }
    
    if (timePercent < 0.0001 || timePercent > 0.9999) {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        return;
    }

    gl_Position = projectionMatrix * modelViewMatrix * newPosition;
}
`,this.vIndex="",this.delay=0,this.verticalSegments=5}extraAttributes(){return{times:{itemSize:1,generator:(r,e)=>(this.vIndex!==`${r}${e}`&&(this.delay=.3*Math.random(),this.vIndex=`${r}${e}`),[this.delay])},segment:{itemSize:2,generator:(r,e)=>[e,r]}}}},Vortex:class{constructor(){this.duration=4e3,this.geometry=new St,this.material=new Ni({fragmentShader:`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);
    vec4 color = srcColor;
    
    if (timePercent > 0.5) {
        color = distColor;
    }
    
    if (timePercent < 0.0001) {
        color = srcColor;
    } else if (timePercent > 0.9999) {
        color = distColor;
    }
    
    
    gl_FragColor = color;
}
`,vertexShader:`
#define PI 3.14159265

uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
uniform float duration;

attribute vec2 segment;
attribute float times;

varying vec2 vUv;

mat4 rotateY(float angle) {
    return mat4(
        cos(angle), 0.0, sin(angle), 0.0,
        0.0, 1.0, 0.0, 0.0,
        -sin(angle), 0.0, cos(angle), 0.0,
        0.0, 0.0, 0.0, 1.0
    );
}

void main(){
    vUv = uv;

    float width = segmentWidth * horizontalSegments;
    float height = segmentHeight * verticalSegments;

    mat4 matrix;
    float stagePercent;
    vec4 newPosition = vec4(position, 1.0);
    float selfTimePercent = (timePercent - times) / (4.0 / 5.0);
    
    if (selfTimePercent < 0.0) {
        selfTimePercent = 0.0;
    } else if (selfTimePercent > 1.0) {
        selfTimePercent = 1.0;
    }
    
    if (selfTimePercent < (2.0 / 5.0)) {
        stagePercent = selfTimePercent / (2.0 / 5.0);
        newPosition.x -= 0.5 * width;
        matrix = rotateY(-1.0 * stagePercent * PI * 0.5);
        newPosition = matrix * newPosition;
        newPosition.x += 0.5 * width;
    } else if (selfTimePercent >= (2.0 / 5.0) && selfTimePercent < (3.0 / 5.0)) {
        stagePercent = (selfTimePercent - (2.0 / 5.0)) / (1.0 / 5.0);

        newPosition.x -= 0.5 * width;
        newPosition = rotateY(-1.0 * PI * 0.5) * newPosition;
        matrix = rotateY(-1.0 * stagePercent * PI * 2.0);
        newPosition = matrix * newPosition;
        newPosition.x += 0.5 * width;
        
        newPosition.x -= width * stagePercent;
    } else {
        float offset = (newPosition.x + 0.5 * width) / width * 2.0 / 5.0;
        
        stagePercent = (selfTimePercent - (1.0 / 5.0)) / (2.0 / 5.0 + offset);
        
        if (stagePercent > 1.0) {
            stagePercent = 1.0;
        }
        
        vec4 vvUvv = vec4(vUv.x - 0.5, vUv.y - 0.5, 0.0, 1.0);
        vvUvv = rotateY(-1.0 * PI) * vvUvv;
        
        vUv = vvUvv.xy + 0.5;
        
        newPosition.x -= 0.5 * width;
        matrix = rotateY(-1.0 * stagePercent * PI * 0.5 - PI * 2.5);
        newPosition = matrix * newPosition;
        newPosition.x += 0.5 * width;
        
        newPosition.x -= width;
        
    }

    
    if (timePercent < 0.0001 || timePercent > 0.9999) {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        return;
    }

    gl_Position = projectionMatrix * modelViewMatrix * newPosition;
}
`,side:J}),this.camera=new Gf,this.mesh=new sn}initData(r,e){const t=[],n=[],i=[],o=[],s=[],a=[],h=Math.ceil(124*r/e),u=r/2,c=e/2,d=r/h,f=e/124;for(let m=0;m<124;m++){const g=m*f-c;for(let v=0;v<h;v++){const x=v*d-u,T=Math.ceil((v+1)/((h+1)/12)),M=.4/T,C=(T-1)*M+Math.random()*M;n.push(x,-g,0),o.push(1*v/h,1-1*m/124),i.push(0,0,1),s.push(v,m),a.push(C),n.push(x+d,-g,0),o.push(1*(v+1)/h,1-1*m/124),i.push(0,0,1),s.push(v,m),a.push(C),n.push(x,-g-f,0),o.push(1*v/h,1-1*(m+1)/124),i.push(0,0,1),s.push(v,m),a.push(C),n.push(x+d,-g-f,0),o.push(1*(v+1)/h,1-1*(m+1)/124),i.push(0,0,1),s.push(v,m),a.push(C)}}for(let m=0;m<124*h;m++){const g=4*m,v=g+1,x=g+2,T=g+3;t.push(v,g,T),t.push(g,x,T)}return this.geometry.setIndex(t),this.geometry.setAttribute("position",new rt(n,3)),this.geometry.setAttribute("normal",new rt(i,3)),this.geometry.setAttribute("uv",new rt(new Float32Array(o),2)),this.geometry.setAttribute("segment",new rt(new Float32Array(s),2)),this.geometry.setAttribute("times",new rt(new Float32Array(a),1)),{verticalSegments:124,horizontalSegments:h,segmentWidth:d,segmentHeight:f}}setTexture(r,e){const{width:t,height:n}=r.image,{verticalSegments:i,horizontalSegments:o,segmentWidth:s,segmentHeight:a}=this.initData(t,n);this.material.uniforms={duration:{value:this.duration},segmentWidth:{value:s},segmentHeight:{value:a},verticalSegments:{value:i},horizontalSegments:{value:o},timePercent:{value:0},texturePrev:{value:r},textureNext:{value:e}},this.camera.updateAspect(t,n),this.camera.focus(this.mesh,n),this.mesh.geometry=this.geometry,new Ef({side:J,vertexColors:!0}).wireframe=!0,this.material.transparent=!0,this.mesh.material=this.material,console.log(b)}addObjects(r){r.add(this.mesh)}updateAnimation(r){this.material.uniforms.timePercent.value=r}dispose(){var r,e;(r=this.geometry)===null||r===void 0||r.dispose(),(e=this.material)===null||e===void 0||e.dispose()}},WindowShades:class{constructor(){this.duration=1600,this.geometry=new St,this.material=new Ni({fragmentShader:`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;

varying vec2 vUv;
varying float vType;
varying float rotatePercent;

mat3 yuv2rgb = mat3(
    1.0, 0.0, 1.13983,
    1.0, -0.39465, -0.58060,
    1.0, 2.03211, 0.0
);

mat3 rgb2yuv = mat3(
    0.2126, 0.7152, 0.0722,
    -0.09991, -0.33609, 0.43600,
    0.615, -0.5586, -0.05639
);

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);
    vec3 srcYuv;
    vec3 distYuv;
    
    if (rotatePercent < 0.5) {
        distYuv = distColor.rgb * rgb2yuv;
        distYuv.r *= 1.0 - abs(rotatePercent - 0.5) / 0.5;
        distColor = vec4(distYuv * yuv2rgb, distColor.a);
    } else {
        srcYuv = distColor.rgb * rgb2yuv;
        srcYuv.r *= abs(rotatePercent - 0.5) / 0.5;
        srcColor = vec4(srcYuv * yuv2rgb, srcColor.a);
    }
    
    vec4 color = vType < 0.5 ? srcColor : distColor;

    gl_FragColor = color;
}
`,vertexShader:`
#define PI 3.14159265
attribute float index;
attribute float type;
attribute float delay;

uniform float timePercent;
uniform float segmentWidth;
uniform float segments;

varying vec2 vUv;
varying float vType;
varying float rotatePercent;

mat4 rotateY(float angle) {
    return mat4(
        cos(angle), 0.0, sin(angle), 0.0,
        0.0, 1.0, 0.0, 0.0,
        -sin(angle), 0.0, cos(angle), 0.0,
        0.0, 0.0, 0.0, 1.0
    );
}

void main(){
    vUv = uv;
    vType = type;

    vec4 newPosition = vec4( position, 1.0 );
    
    float selfPercent = (timePercent - delay) / 0.7;
    rotatePercent = selfPercent;
    if (selfPercent < 0.0) {
        selfPercent = 0.0;
    } else if (selfPercent > 1.0) {
        selfPercent = 1.0;
    }
    
    float offsetX = (segments * segmentWidth) * 0.5 - (index + 0.5) * segmentWidth;
    float offsetZ = segmentWidth * 0.5;
    
    newPosition.x += offsetX;
    newPosition.z += offsetZ;

    newPosition.x *= (0.9) + abs(timePercent - 0.5) / 0.5 * 0.1;
    newPosition.z *= (0.9) + abs(timePercent - 0.5) / 0.5 * 0.1;

    newPosition = rotateY(PI * 0.5 * selfPercent) * newPosition;
    
    newPosition.x -= offsetX;
    newPosition.z -= offsetZ;
    
    gl_Position = projectionMatrix * modelViewMatrix * newPosition;
}
`,side:J}),this.horizontalSegments=16,this.meshToCameraDistance=0,this.camera=new Gf,this.mesh=new sn}initData(r,e){const t=[],n=[],i=[],o=[],s=[],a=[],h=r/2,u=e/2,c=r/this.horizontalSegments;for(let d=0;d<this.horizontalSegments;d++){const f=Math.abs(d-Math.ceil(this.horizontalSegments/2))*(.3/Math.ceil(this.horizontalSegments/2)),m=d*c-h;n.push(m,u,0),i.push(0),o.push(d/this.horizontalSegments,1),s.push(d),a.push(f),n.push(m+c,u,0),i.push(0),o.push((d+1)/this.horizontalSegments,1),s.push(d),a.push(f),n.push(m,-1*u,0),i.push(0),o.push(d/this.horizontalSegments,0),s.push(d),a.push(f),n.push(m+c,-1*u,0),o.push((d+1)/this.horizontalSegments,0),i.push(0),s.push(d),a.push(f),n.push(m+c,u,0),i.push(1),o.push(d/this.horizontalSegments,1),s.push(d),a.push(f),n.push(m+c,u,-1*c),i.push(1),o.push((d+1)/this.horizontalSegments,1),s.push(d),a.push(f),n.push(m+c,-1*u,0),i.push(1),o.push(d/this.horizontalSegments,0),s.push(d),a.push(f),n.push(m+c,-1*u,-1*c),o.push((d+1)/this.horizontalSegments,0),i.push(1),s.push(d),a.push(f)}for(let d=0;d<this.horizontalSegments;d++){const f=8*d,m=f+1,g=f+2,v=f+3,x=f+4,T=f+5,M=f+6,C=f+7;t.push(m,f,v),t.push(f,g,v),t.push(T,x,C),t.push(x,M,C)}this.geometry.setIndex(t),this.geometry.setAttribute("position",new rt(n,3)),this.geometry.setAttribute("uv",new rt(new Float32Array(o),2)),this.geometry.setAttribute("index",new rt(new Float32Array(s),1)),this.geometry.setAttribute("type",new rt(new Float32Array(i),1)),this.geometry.setAttribute("delay",new rt(new Float32Array(a),1))}setTexture(r,e,t,n){this.initData(t,n),this.material.uniforms={segments:{value:this.horizontalSegments},segmentWidth:{value:t/this.horizontalSegments},timePercent:{value:0},texturePrev:{value:r},textureNext:{value:e}},this.meshToCameraDistance=.5*n/Math.tan(Math.PI/6),this.camera.updateAspect(t,n),this.camera.focus(this.mesh,n),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material}addObjects(r){r.add(this.mesh)}updateAnimation(r){this.material.uniforms.timePercent.value=r}dispose(){var r,e;(r=this.geometry)===null||r===void 0||r.dispose(),(e=this.material)===null||e===void 0||e.dispose()}},Curtain:class extends ud{constructor(){super(...arguments),this.duration=6e3,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying vec4 shadow;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);
    
    vec4 color = blendSrcOver(shadow, srcColor);
    
    gl_FragColor = color;
}
`)([_r]),this.vertexShader=((r=[])=>`
#define PI 3.141592653

uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;

attribute float isLeft;

varying vec2 vUv;
varying vec4 shadow;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    vUv = uv;
    float scaleX;
    float transform;
    float displacement;
    vec4 newPosition = vec4(position, 1.0);
    vec4 glPosition = projectionMatrix * modelViewMatrix * newPosition;
    float crestCount = 24.0;
    float width = horizontalSegments * segmentWidth;
    float height = verticalSegments * segmentHeight;
    float heightFactor = (newPosition.y + height * 0.5) / height;
    
    // \u7A97\u5E18\u4E0A\u62C9\u6548\u679C
    float scaleY = interpolationFloat(1.0, 1.05, 0.0, 0.11, timePercent, 0);
    newPosition.y += height * 0.5;
    newPosition.y *= scaleY;
    newPosition.y -= height * 0.5;
    
    newPosition.y += 10.0;
    
    if (timePercent > 0.0 && timePercent < 0.333) {
        // \u7A97\u5E18\u6536\u8D77\u5230\u7EC8\u70B9
        float delay = (1.0 - heightFactor) * 0.1;
        scaleX = interpolationFloat(1.0, 0.5, 0.0 + delay, 0.333, timePercent, 1);
    } else if (timePercent >= 0.333 && timePercent < 0.5) {
        // \u7A97\u5E18\u7531\u7EC8\u70B9\u5411\u5DE6\u6446\u52A8
        float scaleTop = 0.5;
        float scaleBottom = interpolationFloat(0.5, 0.25, 0.333, 0.5, timePercent, 2);
        float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
        scaleX = scaleTop - incr;
    } else if (timePercent >= 0.5 && timePercent < 0.583) {
        // \u7A97\u5E18\u5411\u53F3\u6446\u52A8\u5230\u7EC8\u70B9
        float scaleTop = 0.5;
        float scaleBottom = interpolationFloat(0.25, 0.5, 0.5, 0.583, timePercent, 1);
        float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
        scaleX = scaleTop - incr;
    } else if (timePercent >= 0.583) {
        // \u7A97\u5E18\u7531\u7EC8\u70B9\u5411\u53F3\u6446\u52A8
        float scaleTop = 0.5;
        float scaleBottom = interpolationFloat(0.5, 0.75, 0.583, 0.666, timePercent, 2);
        float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
        scaleX = scaleTop + incr;
    }
    
    if (timePercent > 0.583) {
        displacement = (isLeft < 0.5 ? 1.0 : -1.0) * interpolationFloat(0.0, width / 2.0, 0.583, 1.0, timePercent, 0);
    }

    // \u632F\u5E45
    float ampTop = interpolationFloat(0.0, 1.0, 0.0, 0.11, timePercent, 0);
    float ampBottom = interpolationFloat(0.0, 1.0, 0.11, 0.22, timePercent, 0);
    float amp = ampBottom + heightFactor * abs(ampBottom - ampTop);

    float foo = newPosition.x * (crestCount * PI / width);
    newPosition.z = amp * cos(foo + PI / 2.0) * 20.0;

    transform = (isLeft < 0.5 ? -1.0 : 1.0) * (width * 0.5);
    newPosition.x += transform;
    newPosition.x *= scaleX;
    newPosition.x -= transform;
    
    newPosition.x += displacement;
    
    
    // \u6A21\u62DF\u9634\u5F71
    shadow = vec4(0.0, 0.0, 0.0, 0.0);
    if (newPosition.z < 15.0) {
        float alpha = 0.3 * (1.0 - (newPosition.z + 20.0) / 35.0);
        shadow.a = alpha * amp;
    }

    gl_Position = projectionMatrix * modelViewMatrix * newPosition;
}
`)([yr,Kg]),this.verticalSegments=100}extraAttributes(){return{isLeft:{itemSize:1,generator:(r,e)=>[e<this.horizontalSegments()/2?1:0]}}}addObjects(r){super.addObjects(r),this.mesh.position.z+=20,r.background=this.nextTexture}},Fall:class extends ud{constructor(){super(...arguments),this.zCurveLimit=100,this.duration=2e3,this.verticalSegments=100,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);

    float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
    vec4 shadow = vec4(0.0, 0.0, 0.0, alpha);

    gl_FragColor = blendSrcOver(shadow, srcColor);
}
`)([_r,yr]),this.vertexShader=((r=[])=>`
#define PI 3.14159265

uniform float timePercent;
uniform float aCoefficient;
uniform float zCurveLimit;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;

varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    float halfWidth = segmentWidth * horizontalSegments * 0.5;
    float halfHeight = segmentHeight * verticalSegments * 0.5;
    vUv = uv;
    vec4 newPosition = vec4(position, 1.0);

    float curve;

    float aStart = interpolationFloat(0.00000009, aCoefficient, 0.0, 0.5, timePercent, 0);
    float aEnd = 0.0000009;
    float zStart = interpolationFloat(0.0, zCurveLimit, 0.0, 0.5, timePercent, 0);
    float zEnd = 0.0;
    float a = interpolationFloat(aStart, aEnd, 0.0, halfWidth * 2.0, newPosition.x + halfWidth, 0);
    float z = interpolationFloat(zStart, zEnd, 0.0, halfWidth * 2.0, newPosition.x + halfWidth, 0);
    newPosition.z -= -a * newPosition.y * newPosition.y + z;

    float scaleYStart = interpolationFloat(1.0, 0.8, 0.0, 0.5, timePercent, 0);
    float scaleYEnd = 1.0;
    float scaleY = interpolationFloat(scaleYStart, scaleYEnd, 0.0, halfWidth * 2.0, newPosition.x + halfWidth, 0);
    
    newPosition.y += halfHeight;
    newPosition.y *= scaleY;

    float angle = interpolationFloat(0.0, -(2.0 * PI / 3.0), 0.111, 1.0, timePercent, 1);

    mat4 rotateX = mat4(
        1.0, 0.0, 0.0, 0.0,
        0.0, cos(angle), sin(angle), 0.0,
        0.0, -sin(angle), cos(angle), 0.0,
        0.0, 0.0, 0.0, 1.0
    );

    
    newPosition = rotateX * newPosition;
    
    newPosition.y -= halfHeight;

    gl_Position = projectionMatrix * modelViewMatrix * newPosition;
}
`)([yr,Kg])}extraAttributes(){return{}}setTexture(r,e,t,n){super.setTexture(r,e,t,n),this.material.uniforms.zCurveLimit={value:this.zCurveLimit},this.material.uniforms.aCoefficient={value:this.zCurveLimit/(this.textureHeight/2*(this.textureHeight/2))}}addObjects(r){r.add(this.mesh),r.background=this.nextTexture}updateAnimation(r){this.material.uniforms.timePercent.value=r}},Suspension:class extends iy{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);

    float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
    vec4 shadow = vec4(0.0, 0.0, 0.0, 0.0);

    gl_FragColor = blendSrcOver(shadow, distColor);
}
`)([_r,yr]),this.vertexShader=((r=[])=>`
#define PI 3.14159265358

uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;

varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

mat4 rotateX(float angle) {
    return mat4(
        1.0, 0.0, 0.0, 0.0,
        0.0, cos(angle), sin(angle), 0.0,
        0.0, -sin(angle), cos(angle), 0.0,
        0.0, 0.0, 0.0, 1.0
    );
}

void main(){
    float halfWidth = segmentWidth * horizontalSegments * 0.5;
    float halfHeight = segmentHeight * verticalSegments * 0.5;
    vUv = uv;
    vec4 newPosition = vec4(position, 1.0);
    float delay = interpolationFloat(0.0, 0.08, 0.0, halfWidth * 2.0, halfWidth + newPosition.x, 0);
    
    float arc = halfHeight - newPosition.y;
    float L;
    if (timePercent < 0.8) {
        L = interpolationFloat(halfHeight * 4.0, halfHeight * 22.0, 0.3 + delay, 0.8, timePercent, 0);
    } else {
        L = interpolationFloat(halfHeight * 22.0, halfHeight * 300.0, 0.8, 1.0, timePercent, 0);
    }
    float r = L / (2.0 * PI);
    float angle = PI - arc / r;

    float y = sin(angle) * r;
    float z = cos(angle) * r;

    newPosition.y = halfHeight - y;
    newPosition.z = (z + r) * 0.45;

    float rotateAngle = interpolationFloat(-PI * 0.5, 0.0, 0.0 + delay, 0.4, timePercent, 0);
    newPosition.y -= halfHeight;
    newPosition = rotateX(rotateAngle) * newPosition;
    newPosition.y += halfHeight;
    
    float backRotate1 = interpolationFloat(0.0, PI * 0.03, 0.75, 0.9, timePercent, 0);
    newPosition.y -= halfHeight;
    newPosition = rotateX(backRotate1) * newPosition;
    newPosition.y += halfHeight;
    
    float backRotate2 = interpolationFloat(0.0, -PI * 0.03, 0.8, 1.0, timePercent, 0);
    newPosition.y -= halfHeight;
    newPosition = rotateX(backRotate2) * newPosition;
    newPosition.y += halfHeight;
    

    gl_Position = projectionMatrix * modelViewMatrix * newPosition;
}
`)([yr])}addObjects(r){r.add(this.mesh),r.background=this.prevTexture}},Clock:class extends Yi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=((r=[])=>`
#define PI 3.14159265358

uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;

varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

// \u5C06 uv \u5750\u6807\u53D8\u6362\u5230\u4EE5 [0.5, 0.5] \u4E3A\u539F\u70B9\u7684\u5750\u6807
vec2 transform(vec2 uv) {
    uv.y = uv.y * height / width;
    return uv - vec2(0.5, 0.5 * height / width);
}

void main(){
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);
    
    float shadowAngle = PI / 6.0;
    float clockAngle;
    vec2 a;
    vec2 b = transform(vUv);
    float angle;
    
    if (timePercent < 0.5) {
        a = vec2(0.0, 0.5);
        clockAngle = interpolationFloat(0.0, PI, 0.0, 0.5, timePercent, 0);
        if (b.x > 0.0) {
            angle = acos((a.x * b.x + a.y * b.y) / (sqrt(a.x * a.x + a.y * a.y) * sqrt(b.x * b.x + b.y * b.y)));
            if (angle < clockAngle) {
                if (angle > clockAngle - shadowAngle) {
                    float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
                    srcColor.a = shadowAlpha;
                } else {
                    srcColor.a = 0.0;
                }
            }
        } else {
            srcColor.a = 1.0;
        }
    } else {
        a = vec2(0.0, -0.5);
        clockAngle = interpolationFloat(0.0, PI + shadowAngle, 0.5, 1.0, timePercent, 0);
        if (b.x <= 0.0) {
            angle = acos((a.x * b.x + a.y * b.y) / (sqrt(a.x * a.x + a.y * a.y) * sqrt(b.x * b.x + b.y * b.y)));
            if (angle < clockAngle) {
                if (angle > clockAngle - shadowAngle) {
                    float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
                    srcColor.a = shadowAlpha;
                } else {
                    srcColor.a = 0.0;
                }
            }
        } else {
            srcColor.a = 0.0;
        }
    }

    gl_FragColor = blendSrcOver(srcColor, distColor);
}
`)([yr,_r])}},Combing:class extends Yi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=((r=[])=>`
#define PI 3.14159265358

uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;

varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    vec2 uv = vUv;
    bool useSrc = false;
    vec2 row;
    float delay = 0.02;
    
    for (int i = 0; i < 7; i++) {
        float fi = float(i);
        row.r = fi * 1.0 / 7.0;
        row.g = float(i + 1) * 1.0 / 7.0;
        if (vUv.y <= row.g && vUv.y > row.r) {
            if (i % 2 == 0) {
                float x = interpolationFloat(0.0, 1.0, delay * fi, delay * fi + 0.86, timePercent, 1);
                if (vUv.x < x) {
                    useSrc = false;
                } else {
                    uv.x -= x;
                    useSrc = true;
                }
            } else {
                float x = interpolationFloat(1.0, 0.0, delay * fi, delay * fi + 0.86, timePercent, 1);
                if (vUv.x < x) {
                    uv.x = 1.0 - x + uv.x;
                    useSrc = true;
                } else {
                    useSrc = false;
                }
            }
            break;
        }
    }
    
    vec4 srcColor = texture2D(texturePrev, uv);
    vec4 distColor = texture2D(textureNext, uv);

    gl_FragColor = useSrc ? srcColor : distColor;
}
`)([yr])}},Scale:class extends Yi{constructor(){super(...arguments),this.duration=900,this.fragmentShader=((r=[])=>`
#define PI 3.14159265358

uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;

varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

void main(){
    vec2 uvSrc = vUv;
    vec2 uvDist = vUv;
    
    float scaleSrc = interpolationFloat(1.0, 0.1, 0.0, 1.0, timePercent, 0);
    float scaleDist = interpolationFloat(2.0, 1.0, 0.0, 1.0, timePercent, 0);
    
    uvSrc -= 0.5;
    uvSrc *= scaleSrc;
    uvSrc += 0.5;
    
    uvDist -= 0.5;
    uvDist *= scaleDist;
    uvDist += 0.5;
    
    vec4 srcColor = texture2D(texturePrev, uvSrc);
    srcColor.a = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 0);
    
    vec4 distColor;

    if (uvDist.x > 1.0 || uvDist.x < 0.0 || uvDist.y > 1.0 || uvDist.y < 0.0) {
        distColor = vec4(0.0, 0.0, 0.0, 1.0);
    } else {
        distColor = texture2D(textureNext, uvDist);
    }

    gl_FragColor = blendSrcOver(srcColor, distColor);
}
`)([yr,_r])}},PeelOff:iy,Flip:class extends ud{constructor(){super(...arguments),this.duration=1250,this.fragmentShader=((r=[])=>`
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

void main() {
    vec4 srcColor = texture2D(texturePrev, vUv);
    vec4 distColor = texture2D(textureNext, vUv);

    gl_FragColor = timePercent < 0.5 ? srcColor : distColor;
}
`)([_r]),this.vertexShader=((r=[])=>`
#define PI 3.14159265358

uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;

varying vec2 vUv;

${r.map(e=>e+`
`).join(`
`)}

mat4 rotateY(float angle) {
    return mat4(
        cos(angle), 0.0, sin(angle), 0.0,
        0.0, 1.0, 0.0, 0.0,
        -sin(angle), 0.0, cos(angle), 0.0,
        0.0, 0.0, 0.0, 1.0
    );
}

void main(){
    float halfWidth = segmentWidth * horizontalSegments * 0.5;
    float halfHeight = segmentHeight * verticalSegments * 0.5;
    vUv = uv;
    vec4 newPosition = vec4(position, 1.0);
    float stageOneAngle = PI / 14.0;
    float stageTwoAngle = PI * 12.0 / 14.0;
    float stage_1 = 0.1;
    float stage_2 = 0.8;
    
    if (timePercent < 0.5) {
        newPosition.z = interpolationFloat(0.0, -100.0, 0.0, 0.5, timePercent, 0);
    } else {
        newPosition.z = interpolationFloat(-100.0, 0.0, 0.5, 1.0, timePercent, 0);
    }

    if (timePercent < stage_1) {
        float angle = interpolationFloat(0.0, stageOneAngle, 0.0, stage_1, timePercent, 0);
        newPosition.x += halfWidth;
        newPosition *= rotateY(angle);
        newPosition.x -= halfWidth;
    } else if (timePercent >= stage_1 && timePercent < stage_2) {
        if (timePercent > 0.5) {
            newPosition *= rotateY(PI);
        }
    
        float offset = halfWidth - sin(PI * 0.5 - stageOneAngle) * halfWidth;
        float angle = interpolationFloat(0.0, stageTwoAngle, stage_1, stage_2, timePercent, 0);
        
        newPosition *= rotateY(angle);
        
        newPosition.x += halfWidth;
        newPosition *= rotateY(stageOneAngle);
        newPosition.x -= halfWidth;
        
        newPosition.x += interpolationFloat(0.0, 2.0 * offset, stage_1, stage_2, timePercent, 0);
    } else {
        float angle = interpolationFloat(-stageOneAngle, 0.0, stage_2, 1.0, timePercent, 0);
        newPosition.x -= halfWidth;
        newPosition *= rotateY(angle);
        newPosition.x += halfWidth;
    }

    gl_Position = projectionMatrix * modelViewMatrix * newPosition;
}
`)([yr]),this.verticalSegments=1}extraAttributes(){return{}}},Wind:class{constructor(){this.duration=2e3,this.camera=new Gf,this.mesh=new sn,this.geometry=null,this.material=new Mf({side:J,alphaTest:.5}),this.tmpForce=new w,this.windForce=new w(0,0,0),this.cloth=null,this.nextTexture=null,this.diff=new w,this.xSegs=10,this.ySegs=10,this.width=10,this.height=10,this.enablePins=!0,this.animate=r=>{this.simulate(r),this.render(),requestAnimationFrame(this.animate)}}setTexture(r,e){const t=1024*r.image.height/r.image.width;this.xSegs=Math.ceil(40.96),this.ySegs=Math.ceil(t/25),this.width=25*this.xSegs,this.height=25*this.ySegs;const n=function(i,o){return function(s,a,h){const u=(s-.5)*i,c=(a+.5)*o;h.set(u,c,0)}}(25*this.xSegs,25*this.ySegs);this.cloth=new VT(this.xSegs,this.ySegs,n),this.nextTexture=e,this.camera.updateAspect(1024,t),this.material.map=r,this.geometry=new td(n,this.cloth.width,this.cloth.height),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material,this.mesh.castShadow=!0,this.mesh.position.y-=t,this.mesh.customDepthMaterial=new nn({depthPacking:lc,map:r,alphaTest:.5}),this.camera.focus(this.mesh,t)}addObjects(r){r.add(this.mesh),r.background=this.nextTexture,r.add(new Pf(6710886));const e=new Af(14674943,1);e.position.set(0,0,100),e.position.multiplyScalar(1.3),e.castShadow=!0,e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024;const t=300;e.shadow.camera.left=-t,e.shadow.camera.right=t,e.shadow.camera.top=t,e.shadow.camera.bottom=-t,e.shadow.camera.far=1e3,r.add(e),this.animate(0)}satisfyConstraints(r,e,t){this.diff.subVectors(e.position,r.position);const n=this.diff.length();if(n===0)return;const i=this.diff.multiplyScalar(1-t/n).multiplyScalar(.5);r.position.add(i),e.position.sub(i)}simulate(r){const e=20*Math.abs(Math.cos(r/70));this.windForce.set(Math.abs(Math.sin(r/300)),Math.abs(Math.cos(r/200)),Math.sin(r/1e3)),this.windForce.normalize(),this.windForce.x*=50*e,this.windForce.y*=50*e,this.windForce.z*=.2*e;const t=this.cloth.particles;let n;const i=new w,o=this.geometry.index,s=this.geometry.attributes.normal;for(let u=0,c=o.count;u<c;u+=3)for(let d=0;d<3;d++)n=o.getX(u+d),i.fromBufferAttribute(s,n),this.tmpForce.copy(i).normalize().multiplyScalar(i.dot(this.windForce)),t[n].addForce(this.tmpForce);for(let u=0,c=t.length;u<c;u++){const d=t[u];d.addForce(HT),d.integrate(144e-6,this.width,this.height)}const a=this.cloth.constraints,h=a.length;for(let u=0;u<h;u++){const c=a[u];this.satisfyConstraints(c[0],c[1],c[2])}for(let u=0,c=t.length;u<c;u++){const d=t[u].position;d.y<-250&&(d.y=-250)}if(this.enablePins){let u=new Array(this.xSegs+1).fill("").map((c,d)=>d);for(let c=0;c<this.ySegs+1;c++)u.push(c*(this.xSegs+1));for(let c=0,d=u.length;c<d;c++){const f=t[u[c]];f.position.copy(f.original),f.previous.copy(f.original)}}}render(){const r=this.cloth.particles;for(let e=0,t=r.length;e<t;e++){const n=r[e].position;this.geometry.attributes.position.setXYZ(e,n.x,n.y,n.z)}this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeVertexNormals()}updateAnimation(r){r>.5&&(this.enablePins=!1),r>.9999&&(this.mesh.visible=!1)}dispose(){var r,e;(r=this.geometry)===null||r===void 0||r.dispose(),(e=this.material)===null||e===void 0||e.dispose()}}},ry={linear:(r,e,t,n)=>t*r/n+e,easeIn:(r,e,t,n)=>t*(r/=n)*r+e,strongEaseIn:(r,e,t,n)=>t*(r/=n)*r*r*r*r+e,strongEaseOut:(r,e,t,n)=>t*((r=r/n-1)*r*r*r*r+1)+e,sineaseIn:(r,e,t,n)=>t*(r/=n)*r*r+e,sineaseOut:(r,e,t,n)=>t*((r=r/n-1)*r*r+1)+e};class WT{constructor(){this.startTime=0,this.lastTime=0,this.reverse=!1,this.scene=new Aa,this.delay=0,this.easeFn=ry.linear,this.preset=null,this.onTransactionEnd=()=>{},this.textureLoader=new Lg,this.prevTexture=null,this.nextTexture=null,this.renderer=new dn({alpha:!0,premultipliedAlpha:!0}),this.isPlaying=!1,this.animate=(e=-1)=>{var t,n,i;this.renderer.clear(),e>this.delay&&this.lastTime===0&&(this.lastTime=e,this.startTime=e);let o=0;this.lastTime>0&&o<1&&(o=this.easeFn(e-this.startTime,0,1,(n=(t=this.preset)===null||t===void 0?void 0:t.duration)!==null&&n!==void 0?n:0)),o>1&&(o=1),(i=this.preset)===null||i===void 0||i.updateAnimation(this.reverse?1-o:o),this.rerender(),o<1?window.requestAnimationFrame(this.animate):(this.dispose(),this.onTransactionEnd())}}play(e){var t,n,i;e.onTransactionEnd&&(this.onTransactionEnd=e.onTransactionEnd),this.init(e),this.renderer.setSize(e.stageWidth,e.stageHeight),this.preset=new jT[e.presetType],e.duration&&Number.isInteger(e.duration)&&(this.preset.duration=e.duration),this.prevTexture=this.textureLoader.load(e.prevTextureUrl),this.nextTexture=this.textureLoader.load(e.nextTextureUrl),this.reverse?(t=this.preset)===null||t===void 0||t.setTexture(this.nextTexture,this.prevTexture,e.textureWidth,e.textureHeight):(n=this.preset)===null||n===void 0||n.setTexture(this.prevTexture,this.nextTexture,e.textureWidth,e.textureHeight),(i=this.preset)===null||i===void 0||i.addObjects(this.scene),this.animate(),this.isPlaying=!0}init(e){this.reverse=e.reverse,e.delay&&Number.isInteger(e.delay)&&(this.delay=e.delay),e.easeFn&&(this.easeFn=ry[e.easeFn]),this.startTime=0,this.lastTime=0,this.scene.clear(),this.renderer.shadowMap.enabled=!0,this.renderer.autoClear=!1}rerender(){var e;this.renderer.clear(),((e=this.preset)===null||e===void 0?void 0:e.camera.camera)&&this.renderer.render(this.scene,this.preset.camera.camera)}skip(){var e;(e=this.preset)===null||e===void 0||e.updateAnimation(this.reverse?0:1),this.rerender(),this.dispose(),this.onTransactionEnd()}dispose(){var e,t,n;this.isPlaying=!1,(e=this.preset)===null||e===void 0||e.dispose(),(t=this.prevTexture)===null||t===void 0||t.dispose(),(n=this.nextTexture)===null||n===void 0||n.dispose()}}var XT=_(11),YT=_(14),qT=_.n(YT);/*!
 * @pixi/polyfill - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */if(self.Promise||(self.Promise=XT.a),Object.assign||(Object.assign=qT.a),Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()}),!self.performance||!self.performance.now){var ZT=Date.now();self.performance||(self.performance={}),self.performance.now=function(){return Date.now()-ZT}}for(var Qg=Date.now(),oy=["ms","moz","webkit","o"],ev=0;ev<oy.length&&!self.requestAnimationFrame;++ev){var tv=oy[ev];self.requestAnimationFrame=self[tv+"RequestAnimationFrame"],self.cancelAnimationFrame=self[tv+"CancelAnimationFrame"]||self[tv+"CancelRequestAnimationFrame"]}self.requestAnimationFrame||(self.requestAnimationFrame=function(r){if(typeof r!="function")throw new TypeError(r+"is not a function");var e=Date.now(),t=16+Qg-e;return t<0&&(t=0),Qg=e,self.setTimeout(function(){Qg=Date.now(),r(performance.now())},t)}),self.cancelAnimationFrame||(self.cancelAnimationFrame=function(r){return clearTimeout(r)}),Math.sign||(Math.sign=function(r){return(r=Number(r))===0||isNaN(r)?r:r>0?1:-1}),Number.isInteger||(Number.isInteger=function(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r}),self.ArrayBuffer||(self.ArrayBuffer=Array),self.Float32Array||(self.Float32Array=Array),self.Uint32Array||(self.Uint32Array=Array),self.Uint16Array||(self.Uint16Array=Array),self.Uint8Array||(self.Uint8Array=Array),self.Int32Array||(self.Int32Array=Array);var nv=/iPhone/i,sy=/iPod/i,ay=/iPad/i,hy=/\biOS-universal(?:.+)Mac\b/i,iv=/\bAndroid(?:.+)Mobile\b/i,uy=/Android/i,Rl=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Hf=/Silk/i,Ys=/Windows Phone/i,ly=/\bWindows(?:.+)ARM\b/i,cy=/BlackBerry/i,dy=/BB10/i,py=/Opera Mini/i,fy=/\b(CriOS|Chrome)(?:.+)Mobile/i,my=/Mobile(?:.+)Firefox\b/i,gy=function(r){return r!==void 0&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream=="undefined"};/*!
 * @pixi/settings - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var vy,_y,yy,xy,by,wy,Ty,Sy,Ey,rv,ov,sv,My,Ay,av,ld,Py,Ry,Kr=function(r){var e={userAgent:"",platform:"",maxTouchPoints:0};r||typeof navigator=="undefined"?typeof r=="string"?e.userAgent=r:r&&r.userAgent&&(e={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var t=e.userAgent,n=t.split("[FBAN");n[1]!==void 0&&(t=n[0]),(n=t.split("Twitter"))[1]!==void 0&&(t=n[0]);var i=function(s){return function(a){return a.test(s)}}(t),o={apple:{phone:i(nv)&&!i(Ys),ipod:i(sy),tablet:!i(nv)&&(i(ay)||gy(e))&&!i(Ys),universal:i(hy),device:(i(nv)||i(sy)||i(ay)||i(hy)||gy(e))&&!i(Ys)},amazon:{phone:i(Rl),tablet:!i(Rl)&&i(Hf),device:i(Rl)||i(Hf)},android:{phone:!i(Ys)&&i(Rl)||!i(Ys)&&i(iv),tablet:!i(Ys)&&!i(Rl)&&!i(iv)&&(i(Hf)||i(uy)),device:!i(Ys)&&(i(Rl)||i(Hf)||i(iv)||i(uy))||i(/\bokhttp\b/i)},windows:{phone:i(Ys),tablet:i(ly),device:i(Ys)||i(ly)},other:{blackberry:i(cy),blackberry10:i(dy),opera:i(py),firefox:i(my),chrome:i(fy),device:i(cy)||i(dy)||i(py)||i(my)||i(fy)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}(self.navigator);(function(r){r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2"})(vy||(vy={})),function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS"}(_y||(_y={})),function(r){r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL"}(yy||(yy={})),function(r){r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR"}(xy||(xy={})),function(r){r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(by||(by={})),function(r){r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(wy||(wy={})),function(r){r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Ty||(Ty={})),function(r){r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.FLOAT=5126]="FLOAT",r[r.HALF_FLOAT=36193]="HALF_FLOAT"}(Sy||(Sy={})),function(r){r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT"}(Ey||(Ey={})),function(r){r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR"}(rv||(rv={})),function(r){r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(ov||(ov={})),function(r){r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL"}(sv||(sv={})),function(r){r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(My||(My={})),function(r){r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT"}(Ay||(Ay={})),function(r){r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL"}(av||(av={})),function(r){r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp"}(ld||(ld={})),function(r){r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE"}(Py||(Py={})),function(r){r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH"}(Ry||(Ry={}));var ns,Cl,cd,Dt,Qr,Mo,Ua,yn,dd,is,rs,qs,os,Zs,zf,Ao,xr,Vh,Et={MIPMAP_TEXTURES:sv.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(r){var e=!0;if(Kr.tablet||Kr.phone){var t;Kr.apple.device&&(t=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(t[1],10)<11&&(e=!1),Kr.android.device&&(t=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(t[1],10)<7&&(e=!1)}return e?r:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:av.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:ov.CLAMP,SCALE_MODE:rv.LINEAR,PRECISION_VERTEX:ld.HIGH,PRECISION_FRAGMENT:Kr.apple.device?ld.HIGH:ld.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!Kr.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},$T=_(9),Il=_.n($T),JT=_(10),hv=_.n(JT),uv=_(5);(function(r){r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2"})(ns||(ns={})),function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS"}(Cl||(Cl={})),function(r){r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL"}(cd||(cd={})),function(r){r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR"}(Dt||(Dt={})),function(r){r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Qr||(Qr={})),function(r){r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Mo||(Mo={})),function(r){r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Ua||(Ua={})),function(r){r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.FLOAT=5126]="FLOAT",r[r.HALF_FLOAT=36193]="HALF_FLOAT"}(yn||(yn={})),function(r){r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT"}(dd||(dd={})),function(r){r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR"}(is||(is={})),function(r){r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(rs||(rs={})),function(r){r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL"}(qs||(qs={})),function(r){r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(os||(os={})),function(r){r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT"}(Zs||(Zs={})),function(r){r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL"}(zf||(zf={})),function(r){r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp"}(Ao||(Ao={})),function(r){r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE"}(xr||(xr={})),function(r){r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH"}(Vh||(Vh={}));/*!
 * @pixi/utils - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var jh={parse:uv.parse,format:uv.format,resolve:uv.resolve};Et.RETINA_PREFIX=/@([0-9\.]+)x/,Et.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var lv,cv=!1;function KT(){cv=!0}function Cy(r){var e;if(!cv){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var t=[`
 %c %c %c PixiJS 6.0.4 - \u2730 `+r+` \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=self.console).log.apply(e,t)}else self.console&&self.console.log("PixiJS 6.0.4 - "+r+" - http://www.pixijs.com/");cv=!0}}function Iy(){return lv===void 0&&(lv=function(){var r={stencil:!0,failIfMajorPerformanceCaveat:Et.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!self.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),t=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),n=!(!t||!t.getContextAttributes().stencil);if(t){var i=t.getExtension("WEBGL_lose_context");i&&i.loseContext()}return t=null,n}catch{return!1}}()),lv}var QT={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Wh(r,e){return e===void 0&&(e=[]),e[0]=(r>>16&255)/255,e[1]=(r>>8&255)/255,e[2]=(255&r)/255,e}function dv(r){var e=r.toString(16);return"#"+(e="000000".substr(0,6-e.length)+e)}function pv(r){return typeof r=="string"&&(r=QT[r.toLowerCase()]||r)[0]==="#"&&(r=r.substr(1)),parseInt(r,16)}function eS(r){return(255*r[0]<<16)+(255*r[1]<<8)+(255*r[2]|0)}var fv=function(){for(var r=[],e=[],t=0;t<32;t++)r[t]=t,e[t]=t;r[Dt.NORMAL_NPM]=Dt.NORMAL,r[Dt.ADD_NPM]=Dt.ADD,r[Dt.SCREEN_NPM]=Dt.SCREEN,e[Dt.NORMAL]=Dt.NORMAL_NPM,e[Dt.ADD]=Dt.ADD_NPM,e[Dt.SCREEN]=Dt.SCREEN_NPM;var n=[];return n.push(e),n.push(r),n}();function mv(r,e){return fv[e?1:0][r]}function Ly(r,e,t,n){return t=t||new Float32Array(4),n||n===void 0?(t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e):(t[0]=r[0],t[1]=r[1],t[2]=r[2]),t[3]=e,t}function Vf(r,e){if(e===1)return(255*e<<24)+r;if(e===0)return 0;var t=r>>16&255,n=r>>8&255,i=255&r;return(255*e<<24)+((t=t*e+.5|0)<<16)+((n=n*e+.5|0)<<8)+(i=i*e+.5|0)}function gv(r,e,t,n){return(t=t||new Float32Array(4))[0]=(r>>16&255)/255,t[1]=(r>>8&255)/255,t[2]=(255&r)/255,(n||n===void 0)&&(t[0]*=e,t[1]*=e,t[2]*=e),t[3]=e,t}function Oy(r,e){e===void 0&&(e=null);var t=6*r;if((e=e||new Uint16Array(t)).length!==t)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+t);for(var n=0,i=0;n<t;n+=6,i+=4)e[n+0]=i+0,e[n+1]=i+1,e[n+2]=i+2,e[n+3]=i+0,e[n+4]=i+2,e[n+5]=i+3;return e}function Dy(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}var tS={Float32Array,Uint32Array,Int32Array,Uint8Array};function nS(r,e){for(var t=0,n=0,i={},o=0;o<r.length;o++)n+=e[o],t+=r[o].length;var s=new ArrayBuffer(4*t),a=null,h=0;for(o=0;o<r.length;o++){var u=e[o],c=r[o],d=Dy(c);i[d]||(i[d]=new tS[d](s)),a=i[d];for(var f=0;f<c.length;f++)a[(f/u|0)*n+h+f%u]=c[f];h+=u}return new Float32Array(s)}function pd(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,(r|=r>>>16)+1}function vv(r){return!(r&r-1||!r)}function _v(r){var e=(r>65535?1:0)<<4,t=((r>>>=e)>255?1:0)<<3;return e|=t,e|=t=((r>>>=t)>15?1:0)<<2,(e|=t=((r>>>=t)>3?1:0)<<1)|(r>>>=t)>>1}function Xh(r,e,t){var n,i=r.length;if(!(e>=i||t===0)){var o=i-(t=e+t>i?i-e:t);for(n=e;n<o;++n)r[n]=r[n+t];r.length=o}}function Yh(r){return r===0?0:r<0?-1:1}var iS=0;function qh(){return++iS}var Ny={};function Zh(r,e,t){if(t===void 0&&(t=3),!Ny[e]){var n=new Error().stack;n===void 0?console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+r):(n=n.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+`
Deprecated since v`+r),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+r),console.warn(n))),Ny[e]=!0}}var yv={},br=Object.create(null),eo=Object.create(null);function rS(){var r;for(r in br)br[r].destroy();for(r in eo)eo[r].destroy()}function oS(){var r;for(r in br)delete br[r];for(r in eo)delete eo[r]}var xv=function(){function r(e,t,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||Et.RESOLUTION,this.resize(e,t)}return r.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},r.prototype.resize=function(e,t){this.canvas.width=e*this.resolution,this.canvas.height=t*this.resolution},r.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(r.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=e},enumerable:!1,configurable:!0}),r}();function Fy(r){var e,t,n,i=r.width,o=r.height,s=r.getContext("2d"),a=s.getImageData(0,0,i,o).data,h=a.length,u={top:null,left:null,right:null,bottom:null},c=null;for(e=0;e<h;e+=4)a[e+3]!==0&&(t=e/4%i,n=~~(e/4/i),u.top===null&&(u.top=n),(u.left===null||t<u.left)&&(u.left=t),(u.right===null||u.right<t)&&(u.right=t+1),(u.bottom===null||u.bottom<n)&&(u.bottom=n));return u.top!==null&&(i=u.right-u.left,o=u.bottom-u.top+1,c=s.getImageData(u.left,u.top,i,o)),{height:o,width:i,data:c}}var jf,By=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function sS(r){var e=By.exec(r);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}function Uy(r,e){if(e===void 0&&(e=self.location),r.indexOf("data:")===0)return"";e=e||self.location,jf||(jf=document.createElement("a")),jf.href=r;var t=jh.parse(jf.href),n=!t.port&&e.port===""||t.port===e.port;return t.hostname===e.hostname&&n&&t.protocol===e.protocol?"":"anonymous"}function fd(r,e){var t=Et.RETINA_PREFIX.exec(r);return t?parseFloat(t[1]):e!==void 0?e:1}/*!
 * @pixi/math - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ti,md=2*Math.PI,ky=180/Math.PI,Gy=Math.PI/180;(function(r){r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC"})(ti||(ti={}));var en=function(){function r(e,t,n,i){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=Number(e),this.y=Number(t),this.width=Number(n),this.height=Number(i),this.type=ti.RECT}return Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r,"EMPTY",{get:function(){return new r(0,0,0,0)},enumerable:!1,configurable:!0}),r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},r.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},r.prototype.contains=function(e,t){return!(this.width<=0||this.height<=0)&&e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height},r.prototype.pad=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this},r.prototype.fit=function(e){var t=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),o=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(n-t,0),this.y=i,this.height=Math.max(o-i,0),this},r.prototype.ceil=function(e,t){e===void 0&&(e=1),t===void 0&&(t=.001);var n=Math.ceil((this.x+this.width-t)*e)/e,i=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=n-this.x,this.height=i-this.y,this},r.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),o=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=n-t,this.y=i,this.height=o-i,this},r.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},r}(),Hy=function(){function r(e,t,n){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),this.x=e,this.y=t,this.radius=n,this.type=ti.CIRC}return r.prototype.clone=function(){return new r(this.x,this.y,this.radius)},r.prototype.contains=function(e,t){if(this.radius<=0)return!1;var n=this.radius*this.radius,i=this.x-e,o=this.y-t;return(i*=i)+(o*=o)<=n},r.prototype.getBounds=function(){return new en(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},r.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},r}(),zy=function(){function r(e,t,n,i){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=e,this.y=t,this.width=n,this.height=i,this.type=ti.ELIP}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var n=(e-this.x)/this.width,i=(t-this.y)/this.height;return(n*=n)+(i*=i)<=1},r.prototype.getBounds=function(){return new en(this.x-this.width,this.y-this.height,this.width,this.height)},r.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},r}(),gd=function(){function r(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];var i=Array.isArray(t[0])?t[0]:t;if(typeof i[0]!="number"){for(var o=[],s=0,a=i.length;s<a;s++)o.push(i[s].x,i[s].y);i=o}this.points=i,this.type=ti.POLY,this.closeStroke=!0}return r.prototype.clone=function(){var e=new r(this.points.slice());return e.closeStroke=this.closeStroke,e},r.prototype.contains=function(e,t){for(var n=!1,i=this.points.length/2,o=0,s=i-1;o<i;s=o++){var a=this.points[2*o],h=this.points[2*o+1],u=this.points[2*s],c=this.points[2*s+1];h>t!=c>t&&e<(t-h)/(c-h)*(u-a)+a&&(n=!n)}return n},r.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce(function(e,t){return e+", "+t},"")+"]"},r}(),bv=function(){function r(e,t,n,i,o){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=20),this.x=e,this.y=t,this.width=n,this.height=i,this.radius=o,this.type=ti.RREC}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.radius)},r.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){if(t>=this.y+this.radius&&t<=this.y+this.height-this.radius||e>=this.x+this.radius&&e<=this.x+this.width-this.radius)return!0;var n=e-(this.x+this.radius),i=t-(this.y+this.radius),o=this.radius*this.radius;if(n*n+i*i<=o||(n=e-(this.x+this.width-this.radius))*n+i*i<=o||n*n+(i=t-(this.y+this.height-this.radius))*i<=o||(n=e-(this.x+this.radius))*n+i*i<=o)return!0}return!1},r.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},r}(),ni=function(){function r(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.copyFrom=function(e){return this.set(e.x,e.y),this},r.prototype.copyTo=function(e){return e.set(this.x,this.y),e},r.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},r.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x=e,this.y=t,this},r.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},r}(),$h=function(){function r(e,t,n,i){n===void 0&&(n=0),i===void 0&&(i=0),this._x=n,this._y=i,this.cb=e,this.scope=t}return r.prototype.clone=function(e,t){return e===void 0&&(e=this.cb),t===void 0&&(t=this.scope),new r(e,t,this._x,this._y)},r.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this._x===e&&this._y===t||(this._x=e,this._y=t,this.cb.call(this.scope)),this},r.prototype.copyFrom=function(e){return this._x===e.x&&this._y===e.y||(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this},r.prototype.copyTo=function(e){return e.set(this._x,this._y),e},r.prototype.equals=function(e){return e.x===this._x&&e.y===this._y},r.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(r.prototype,"x",{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),r}(),li=function(){function r(e,t,n,i,o,s){e===void 0&&(e=1),t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=1),o===void 0&&(o=0),s===void 0&&(s=0),this.array=null,this.a=e,this.b=t,this.c=n,this.d=i,this.tx=o,this.ty=s}return r.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},r.prototype.set=function(e,t,n,i,o,s){return this.a=e,this.b=t,this.c=n,this.d=i,this.tx=o,this.ty=s,this},r.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var n=t||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},r.prototype.apply=function(e,t){t=t||new ni;var n=e.x,i=e.y;return t.x=this.a*n+this.c*i+this.tx,t.y=this.b*n+this.d*i+this.ty,t},r.prototype.applyInverse=function(e,t){t=t||new ni;var n=1/(this.a*this.d+this.c*-this.b),i=e.x,o=e.y;return t.x=this.d*n*i+-this.c*n*o+(this.ty*this.c-this.tx*this.d)*n,t.y=this.a*n*o+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,t},r.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},r.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},r.prototype.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),i=this.a,o=this.c,s=this.tx;return this.a=i*t-this.b*n,this.b=i*n+this.b*t,this.c=o*t-this.d*n,this.d=o*n+this.d*t,this.tx=s*t-this.ty*n,this.ty=s*n+this.ty*t,this},r.prototype.append=function(e){var t=this.a,n=this.b,i=this.c,o=this.d;return this.a=e.a*t+e.b*i,this.b=e.a*n+e.b*o,this.c=e.c*t+e.d*i,this.d=e.c*n+e.d*o,this.tx=e.tx*t+e.ty*i+this.tx,this.ty=e.tx*n+e.ty*o+this.ty,this},r.prototype.setTransform=function(e,t,n,i,o,s,a,h,u){return this.a=Math.cos(a+u)*o,this.b=Math.sin(a+u)*o,this.c=-Math.sin(a-h)*s,this.d=Math.cos(a-h)*s,this.tx=e-(n*this.a+i*this.c),this.ty=t-(n*this.b+i*this.d),this},r.prototype.prepend=function(e){var t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){var n=this.a,i=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},r.prototype.decompose=function(e){var t=this.a,n=this.b,i=this.c,o=this.d,s=e.pivot,a=-Math.atan2(-i,o),h=Math.atan2(n,t),u=Math.abs(a+h);return u<1e-5||Math.abs(md-u)<1e-5?(e.rotation=h,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=h),e.scale.x=Math.sqrt(t*t+n*n),e.scale.y=Math.sqrt(i*i+o*o),e.position.x=this.tx+(s.x*t+s.y*i),e.position.y=this.ty+(s.x*n+s.y*o),e},r.prototype.invert=function(){var e=this.a,t=this.b,n=this.c,i=this.d,o=this.tx,s=e*i-t*n;return this.a=i/s,this.b=-t/s,this.c=-n/s,this.d=e/s,this.tx=(n*this.ty-i*o)/s,this.ty=-(e*this.ty-t*o)/s,this},r.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},r.prototype.clone=function(){var e=new r;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},r.prototype.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},r.prototype.copyFrom=function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},r.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(r,"IDENTITY",{get:function(){return new r},enumerable:!1,configurable:!0}),Object.defineProperty(r,"TEMP_MATRIX",{get:function(){return new r},enumerable:!1,configurable:!0}),r}(),Jh=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Kh=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Qh=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],eu=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],wv=[],Vy=[],Wf=Math.sign;(function(){for(var r=0;r<16;r++){var e=[];wv.push(e);for(var t=0;t<16;t++)for(var n=Wf(Jh[r]*Jh[t]+Qh[r]*Kh[t]),i=Wf(Kh[r]*Jh[t]+eu[r]*Kh[t]),o=Wf(Jh[r]*Qh[t]+Qh[r]*eu[t]),s=Wf(Kh[r]*Qh[t]+eu[r]*eu[t]),a=0;a<16;a++)if(Jh[a]===n&&Kh[a]===i&&Qh[a]===o&&eu[a]===s){e.push(a);break}}for(r=0;r<16;r++){var h=new li;h.set(Jh[r],Kh[r],Qh[r],eu[r],0,0),Vy.push(h)}})();var jn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(r){return Jh[r]},uY:function(r){return Kh[r]},vX:function(r){return Qh[r]},vY:function(r){return eu[r]},inv:function(r){return 8&r?15&r:7&-r},add:function(r,e){return wv[r][e]},sub:function(r,e){return wv[r][jn.inv(e)]},rotate180:function(r){return 4^r},isVertical:function(r){return(3&r)==2},byDirection:function(r,e){return 2*Math.abs(r)<=Math.abs(e)?e>=0?jn.S:jn.N:2*Math.abs(e)<=Math.abs(r)?r>0?jn.E:jn.W:e>0?r>0?jn.SE:jn.SW:r>0?jn.NE:jn.NW},matrixAppendRotationInv:function(r,e,t,n){t===void 0&&(t=0),n===void 0&&(n=0);var i=Vy[jn.inv(e)];i.tx=t,i.ty=n,r.append(i)}},Tv=function(){function r(){this.worldTransform=new li,this.localTransform=new li,this.position=new $h(this.onChange,this,0,0),this.scale=new $h(this.onChange,this,1,1),this.pivot=new $h(this.onChange,this,0,0),this.skew=new $h(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return r.prototype.onChange=function(){this._localID++},r.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},r.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},r.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},r.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var n=e.worldTransform,i=this.worldTransform;i.a=t.a*n.a+t.b*n.c,i.b=t.a*n.b+t.b*n.d,i.c=t.c*n.a+t.d*n.c,i.d=t.c*n.b+t.d*n.d,i.tx=t.tx*n.a+t.ty*n.c+n.tx,i.ty=t.tx*n.b+t.ty*n.d+n.ty,this._parentID=e._worldID,this._worldID++}},r.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Object.defineProperty(r.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())},enumerable:!1,configurable:!0}),r.IDENTITY=new r,r}();/*!
 * @pixi/display - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Et.SORTABLE_CHILDREN=!1;var vd=function(){function r(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return r.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},r.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},r.prototype.getRectangle=function(e){return this.minX>this.maxX||this.minY>this.maxY?en.EMPTY:((e=e||new en(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},r.prototype.addPoint=function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},r.prototype.addPointMatrix=function(e,t){var n=e.a,i=e.b,o=e.c,s=e.d,a=e.tx,h=e.ty,u=n*t.x+o*t.y+a,c=i*t.x+s*t.y+h;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)},r.prototype.addQuad=function(e){var t=this.minX,n=this.minY,i=this.maxX,o=this.maxY,s=e[0],a=e[1];t=s<t?s:t,n=a<n?a:n,i=s>i?s:i,o=a>o?a:o,t=(s=e[2])<t?s:t,n=(a=e[3])<n?a:n,i=s>i?s:i,o=a>o?a:o,t=(s=e[4])<t?s:t,n=(a=e[5])<n?a:n,i=s>i?s:i,o=a>o?a:o,t=(s=e[6])<t?s:t,n=(a=e[7])<n?a:n,i=s>i?s:i,o=a>o?a:o,this.minX=t,this.minY=n,this.maxX=i,this.maxY=o},r.prototype.addFrame=function(e,t,n,i,o){this.addFrameMatrix(e.worldTransform,t,n,i,o)},r.prototype.addFrameMatrix=function(e,t,n,i,o){var s=e.a,a=e.b,h=e.c,u=e.d,c=e.tx,d=e.ty,f=this.minX,m=this.minY,g=this.maxX,v=this.maxY,x=s*t+h*n+c,T=a*t+u*n+d;f=x<f?x:f,m=T<m?T:m,g=x>g?x:g,v=T>v?T:v,f=(x=s*i+h*n+c)<f?x:f,m=(T=a*i+u*n+d)<m?T:m,g=x>g?x:g,v=T>v?T:v,f=(x=s*t+h*o+c)<f?x:f,m=(T=a*t+u*o+d)<m?T:m,g=x>g?x:g,v=T>v?T:v,f=(x=s*i+h*o+c)<f?x:f,m=(T=a*i+u*o+d)<m?T:m,g=x>g?x:g,v=T>v?T:v,this.minX=f,this.minY=m,this.maxX=g,this.maxY=v},r.prototype.addVertexData=function(e,t,n){for(var i=this.minX,o=this.minY,s=this.maxX,a=this.maxY,h=t;h<n;h+=2){var u=e[h],c=e[h+1];i=u<i?u:i,o=c<o?c:o,s=u>s?u:s,a=c>a?c:a}this.minX=i,this.minY=o,this.maxX=s,this.maxY=a},r.prototype.addVertices=function(e,t,n,i){this.addVerticesMatrix(e.worldTransform,t,n,i)},r.prototype.addVerticesMatrix=function(e,t,n,i,o,s){o===void 0&&(o=0),s===void 0&&(s=o);for(var a=e.a,h=e.b,u=e.c,c=e.d,d=e.tx,f=e.ty,m=this.minX,g=this.minY,v=this.maxX,x=this.maxY,T=n;T<i;T+=2){var M=t[T],C=t[T+1],D=a*M+u*C+d,R=c*C+h*M+f;m=Math.min(m,D-o),v=Math.max(v,D+o),g=Math.min(g,R-s),x=Math.max(x,R+s)}this.minX=m,this.minY=g,this.maxX=v,this.maxY=x},r.prototype.addBounds=function(e){var t=this.minX,n=this.minY,i=this.maxX,o=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>o?e.maxY:o},r.prototype.addBoundsMask=function(e,t){var n=e.minX>t.minX?e.minX:t.minX,i=e.minY>t.minY?e.minY:t.minY,o=e.maxX<t.maxX?e.maxX:t.maxX,s=e.maxY<t.maxY?e.maxY:t.maxY;if(n<=o&&i<=s){var a=this.minX,h=this.minY,u=this.maxX,c=this.maxY;this.minX=n<a?n:a,this.minY=i<h?i:h,this.maxX=o>u?o:u,this.maxY=s>c?s:c}},r.prototype.addBoundsMatrix=function(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)},r.prototype.addBoundsArea=function(e,t){var n=e.minX>t.x?e.minX:t.x,i=e.minY>t.y?e.minY:t.y,o=e.maxX<t.x+t.width?e.maxX:t.x+t.width,s=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(n<=o&&i<=s){var a=this.minX,h=this.minY,u=this.maxX,c=this.maxY;this.minX=n<a?n:a,this.minY=i<h?i:h,this.maxX=o>u?o:u,this.maxY=s>c?s:c}},r.prototype.pad=function(e,t){e===void 0&&(e=0),t===void 0&&(t=e),this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)},r.prototype.addFramePad=function(e,t,n,i,o,s){e-=o,t-=s,n+=o,i+=s,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>i?this.maxY:i},r}(),jy=function(r,e){return(jy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Sv(r,e){function t(){this.constructor=r}jy(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ci=function(r){function e(){var t=r.call(this)||this;return t.tempDisplayObjectParent=null,t.transform=new Tv,t.alpha=1,t.visible=!0,t.renderable=!0,t.parent=null,t.worldAlpha=1,t._lastSortedIndex=0,t._zIndex=0,t.filterArea=null,t.filters=null,t._enabledFilters=null,t._bounds=new vd,t._localBounds=null,t._boundsID=0,t._boundsRect=null,t._localBoundsRect=null,t._mask=null,t._destroyed=!1,t.isSprite=!1,t.isMask=!1,t}return Sv(e,r),e.mixin=function(t){for(var n=Object.keys(t),i=0;i<n.length;++i){var o=n[i];Object.defineProperty(e.prototype,o,Object.getOwnPropertyDescriptor(t,o))}},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,n){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),n||(this._boundsRect||(this._boundsRect=new en),n=this._boundsRect),this._bounds.getRectangle(n)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new en),t=this._localBoundsRect),this._localBounds||(this._localBounds=new vd);var n=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var o=this._bounds,s=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,t);return this.parent=i,this.transform=n,this._bounds=o,this._bounds.updateID+=this._boundsID-s,a},e.prototype.toGlobal=function(t,n,i){return i===void 0&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,n)},e.prototype.toLocal=function(t,n,i,o){return n&&(t=n.toGlobal(t,i,o)),o||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,n,i,o,s,a,h,u,c){return t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=1),o===void 0&&(o=1),s===void 0&&(s=0),a===void 0&&(a=0),h===void 0&&(h=0),u===void 0&&(u=0),c===void 0&&(c=0),this.position.x=t,this.position.y=n,this.scale.x=i||1,this.scale.y=o||1,this.rotation=s,this.skew.x=a,this.skew.y=h,this.pivot.x=u,this.pivot.y=c,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Ev),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*ky},set:function(t){this.transform.rotation=t*Gy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){var n;this._mask&&((n=this._mask.maskObject||this._mask).renderable=!0,n.isMask=!1),this._mask=t,this._mask&&((n=this._mask.maskObject||this._mask).renderable=!1,n.isMask=!0)},enumerable:!1,configurable:!0}),e}(Il.a),Ev=function(r){function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.sortDirty=null,t}return Sv(e,r),e}(ci);function aS(r,e){return r.zIndex===e.zIndex?r._lastSortedIndex-e._lastSortedIndex:r.zIndex-e.zIndex}ci.prototype.displayObjectUpdateTransform=ci.prototype.updateTransform;var Ti=function(r){function e(){var t=r.call(this)||this;return t.children=[],t.sortableChildren=Et.SORTABLE_CHILDREN,t.sortDirty=!1,t}return Sv(e,r),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,n=[],i=0;i<arguments.length;i++)n[i]=t[i];if(n.length>1)for(var o=0;o<n.length;o++)this.addChild(n[o]);else{var s=n[0];s.parent&&s.parent.removeChild(s),s.parent=this,this.sortDirty=!0,s.transform._parentID=-1,this.children.push(s),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",s,this,this.children.length-1),s.emit("added",this)}return n[0]},e.prototype.addChildAt=function(t,n){if(n<0||n>this.children.length)throw new Error(t+"addChildAt: The index "+n+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(n,0,t),this._boundsID++,this.onChildrenChange(n),t.emit("added",this),this.emit("childAdded",t,this,n),t},e.prototype.swapChildren=function(t,n){if(t!==n){var i=this.getChildIndex(t),o=this.getChildIndex(n);this.children[i]=n,this.children[o]=t,this.onChildrenChange(i<o?i:o)}},e.prototype.getChildIndex=function(t){var n=this.children.indexOf(t);if(n===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return n},e.prototype.setChildIndex=function(t,n){if(n<0||n>=this.children.length)throw new Error("The index "+n+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);Xh(this.children,i,1),this.children.splice(n,0,t),this.onChildrenChange(n)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,n=[],i=0;i<arguments.length;i++)n[i]=t[i];if(n.length>1)for(var o=0;o<n.length;o++)this.removeChild(n[o]);else{var s=n[0],a=this.children.indexOf(s);if(a===-1)return null;s.parent=null,s.transform._parentID=-1,Xh(this.children,a,1),this._boundsID++,this.onChildrenChange(a),s.emit("removed",this),this.emit("childRemoved",s,this,a)}return n[0]},e.prototype.removeChildAt=function(t){var n=this.getChildAt(t);return n.parent=null,n.transform._parentID=-1,Xh(this.children,t,1),this._boundsID++,this.onChildrenChange(t),n.emit("removed",this),this.emit("childRemoved",n,this,t),n},e.prototype.removeChildren=function(t,n){t===void 0&&(t=0),n===void 0&&(n=this.children.length);var i,o=t,s=n-o;if(s>0&&s<=n){i=this.children.splice(o,s);for(var a=0;a<i.length;++a)i[a].parent=null,i[a].transform&&(i[a].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(t),a=0;a<i.length;++a)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,n=0,i=this.children.length;n<i;++n){var o=this.children[n];o._lastSortedIndex=n,t||o.zIndex===0||(t=!0)}t&&this.children.length>1&&this.children.sort(aS),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,n=this.children.length;t<n;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var n=this.children[t];if(n.visible&&n.renderable)if(n.calculateBounds(),n._mask){var i=n._mask.maskObject||n._mask;i.calculateBounds(),this._bounds.addBoundsMask(n._bounds,i._bounds)}else n.filterArea?this._bounds.addBoundsArea(n._bounds,n.filterArea):this._bounds.addBounds(n._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(t,n){n===void 0&&(n=!1);var i=r.prototype.getLocalBounds.call(this,t);if(!n)for(var o=0,s=this.children.length;o<s;++o){var a=this.children[o];a.visible&&a.updateTransform()}return i},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var n=0,i=this.children.length;n<i;++n)this.children[n].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var n=this.filters,i=this._mask;if(n){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var o=0;o<n.length;o++)n[o].enabled&&this._enabledFilters.push(n[o]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t),o=0;for(var s=this.children.length;o<s;o++)this.children[o].render(t);t.batch.flush(),i&&t.mask.pop(this),n&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(t){r.prototype.destroy.call(this),this.sortDirty=!1;var n=typeof t=="boolean"?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(n)for(var o=0;o<i.length;++o)i[o].destroy(t)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var n=this.getLocalBounds().width;this.scale.x=n!==0?t/n:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var n=this.getLocalBounds().height;this.scale.y=n!==0?t/n:1,this._height=t},enumerable:!1,configurable:!0}),e}(ci);Ti.prototype.containerUpdateTransform=Ti.prototype.updateTransform;/*!
 * @pixi/accessibility - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/accessibility is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Wy={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};ci.mixin(Wy);var wr,Xy=function(){function r(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Kr.tablet||Kr.phone)&&this.createTouchHook();var t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.zIndex=2 .toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),self.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(r.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),r.prototype.createTouchHook=function(){var e=this,t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2 .toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",function(){e._isMobileAccessibility=!0,e.activate(),e.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t},r.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},r.prototype.activate=function(){var e;this._isActive||(this._isActive=!0,self.document.addEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)===null||e===void 0||e.appendChild(this.div))},r.prototype.deactivate=function(){var e;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)===null||e===void 0||e.removeChild(this.div))},r.prototype.updateAccessibleObjects=function(e){if(e.visible&&e.accessibleChildren){e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);for(var t=e.children,n=0;n<t.length;n++)this.updateAccessibleObjects(t[n])}},r.prototype.update=function(){var e=performance.now();if(!(Kr.android.device&&e<this.androidUpdateCount)&&(this.androidUpdateCount=e+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),n=t.left,i=t.top,o=t.width,s=t.height,a=this.renderer,h=a.width,u=a.height,c=a.resolution,d=o/h*c,f=s/u*c,m=this.div;m.style.left=n+"px",m.style.top=i+"px",m.style.width=h+"px",m.style.height=u+"px";for(var g=0;g<this.children.length;g++){var v=this.children[g];if(v.renderId!==this.renderId)v._accessibleActive=!1,Xh(this.children,g,1),this.div.removeChild(v._accessibleDiv),this.pool.push(v._accessibleDiv),v._accessibleDiv=null,g--;else{m=v._accessibleDiv;var x=v.hitArea,T=v.worldTransform;v.hitArea?(m.style.left=(T.tx+x.x*T.a)*d+"px",m.style.top=(T.ty+x.y*T.d)*f+"px",m.style.width=x.width*T.a*d+"px",m.style.height=x.height*T.d*f+"px"):(x=v.getBounds(),this.capHitArea(x),m.style.left=x.x*d+"px",m.style.top=x.y*f+"px",m.style.width=x.width*d+"px",m.style.height=x.height*f+"px",m.title!==v.accessibleTitle&&v.accessibleTitle!==null&&(m.title=v.accessibleTitle),m.getAttribute("aria-label")!==v.accessibleHint&&v.accessibleHint!==null&&m.setAttribute("aria-label",v.accessibleHint)),v.accessibleTitle===m.title&&v.tabIndex===m.tabIndex||(m.title=v.accessibleTitle,m.tabIndex=v.tabIndex,this.debug&&this.updateDebugHTML(m))}}this.renderId++}},r.prototype.updateDebugHTML=function(e){e.innerHTML="type: "+e.type+"</br> title : "+e.title+"</br> tabIndex: "+e.tabIndex},r.prototype.capHitArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);var t=this.renderer,n=t.width,i=t.height;e.x+e.width>n&&(e.width=n-e.x),e.y+e.height>i&&(e.height=i-e.y)},r.prototype.addChild=function(e){var t=this.pool.pop();t||((t=document.createElement("button")).style.width="100px",t.style.height="100px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=2 .toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:e.accessibleHint&&e.accessibleHint!==null||(t.title="displayObject "+e.tabIndex),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},r.prototype._onClick=function(e){var t=this.renderer.plugins.interaction,n=e.target.displayObject,i=t.eventData;t.dispatchEvent(n,"click",i),t.dispatchEvent(n,"pointertap",i),t.dispatchEvent(n,"tap",i)},r.prototype._onFocus=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive");var t=this.renderer.plugins.interaction,n=e.target.displayObject,i=t.eventData;t.dispatchEvent(n,"mouseover",i)},r.prototype._onFocusOut=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite");var t=this.renderer.plugins.interaction,n=e.target.displayObject,i=t.eventData;t.dispatchEvent(n,"mouseout",i)},r.prototype._onKeyDown=function(e){e.keyCode===9&&this.activate()},r.prototype._onMouseMove=function(e){e.movementX===0&&e.movementY===0||this.deactivate()},r.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},r}();/*!
 * @pixi/ticker - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Et.TARGET_FPMS=.06,function(r){r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY"}(wr||(wr={}));var Mv=function(){function r(e,t,n,i){t===void 0&&(t=null),n===void 0&&(n=0),i===void 0&&(i=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=n,this.once=i}return r.prototype.match=function(e,t){return t===void 0&&(t=null),this.fn===e&&this.context===t},r.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},r.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},r.prototype.destroy=function(e){e===void 0&&(e=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t},r}(),Ci=function(){function r(){var e=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Mv(null,null,1/0),this.deltaMS=1/Et.TARGET_FPMS,this.elapsedMS=1/Et.TARGET_FPMS,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&e._requestId===null&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return r.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},r.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},r.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},r.prototype.add=function(e,t,n){return n===void 0&&(n=wr.NORMAL),this._addListener(new Mv(e,t,n))},r.prototype.addOnce=function(e,t,n){return n===void 0&&(n=wr.NORMAL),this._addListener(new Mv(e,t,n,!0))},r.prototype._addListener=function(e){var t=this._head.next,n=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(n);break}n=t,t=t.next}e.previous||e.connect(n)}else e.connect(n);return this._startIfPossible(),this},r.prototype.remove=function(e,t){for(var n=this._head.next;n;)n=n.match(e,t)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(r.prototype,"count",{get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e},enumerable:!1,configurable:!0}),r.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},r.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},r.prototype.destroy=function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}},r.prototype.update=function(e){var t;if(e===void 0&&(e=performance.now()),e>this.lastTime){if((t=this.elapsedMS=e-this.lastTime)>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Et.TARGET_FPMS;for(var i=this._head,o=i.next;o;)o=o.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e},Object.defineProperty(r.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,t)/1e3,Et.TARGET_FPMS);this._maxElapsedMS=1/n},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(e===0)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(r,"shared",{get:function(){if(!r._shared){var e=r._shared=new r;e.autoStart=!0,e._protected=!0}return r._shared},enumerable:!1,configurable:!0}),Object.defineProperty(r,"system",{get:function(){if(!r._system){var e=r._system=new r;e.autoStart=!0,e._protected=!0}return r._system},enumerable:!1,configurable:!0}),r}(),Yy=function(){function r(){}return r.init=function(e){var t=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(n){this._ticker&&this._ticker.remove(this.render,this),this._ticker=n,n&&n.add(this.render,this,wr.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Ci.shared:new Ci,e.autoStart&&this.start()},r.destroy=function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}},r}(),Av=function(){function r(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new ni,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(r.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),r.prototype.getLocalPosition=function(e,t,n){return e.worldTransform.applyInverse(n||this.global,t)},r.prototype.copyEvent=function(e){"isPrimary"in e&&e.isPrimary&&(this.isPrimary=!0),this.button="button"in e&&e.button;var t="buttons"in e&&e.buttons;this.buttons=Number.isInteger(t)?t:"which"in e&&e.which,this.width="width"in e&&e.width,this.height="height"in e&&e.height,this.tiltX="tiltX"in e&&e.tiltX,this.tiltY="tiltY"in e&&e.tiltY,this.pointerType="pointerType"in e&&e.pointerType,this.pressure="pressure"in e&&e.pressure,this.rotationAngle="rotationAngle"in e&&e.rotationAngle,this.twist="twist"in e&&e.twist||0,this.tangentialPressure="tangentialPressure"in e&&e.tangentialPressure||0},r.prototype.reset=function(){this.isPrimary=!1},r}(),qy=function(r,e){return(qy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},Zy=function(){function r(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return r.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},r.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},r}(),Xf=function(){function r(e){this._pointerId=e,this._flags=r.FLAGS.NONE}return r.prototype._doSet=function(e,t){this._flags=t?this._flags|e:this._flags&~e},Object.defineProperty(r.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"flags",{get:function(){return this._flags},set:function(e){this._flags=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"none",{get:function(){return this._flags===r.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"over",{get:function(){return(this._flags&r.FLAGS.OVER)!=0},set:function(e){this._doSet(r.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"rightDown",{get:function(){return(this._flags&r.FLAGS.RIGHT_DOWN)!=0},set:function(e){this._doSet(r.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"leftDown",{get:function(){return(this._flags&r.FLAGS.LEFT_DOWN)!=0},set:function(e){this._doSet(r.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),r.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),r}(),hS=function(){function r(){this._tempPoint=new ni}return r.prototype.recursiveFindHit=function(e,t,n,i,o){if(!t||!t.visible)return!1;var s=e.data.global,a=!1,h=o=t.interactive||o,u=!0;if(t.hitArea?(i&&(t.worldTransform.applyInverse(s,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?a=!0:(i=!1,u=!1)),h=!1):t._mask&&i&&(t._mask.containsPoint&&t._mask.containsPoint(s)||(i=!1)),u&&t.interactiveChildren&&t.children)for(var c=t.children,d=c.length-1;d>=0;d--){var f=c[d],m=this.recursiveFindHit(e,f,n,i,h);if(m){if(!f.parent)continue;h=!1,m&&(e.target&&(i=!1),a=!0)}}return o&&(i&&!e.target&&!t.hitArea&&t.containsPoint&&t.containsPoint(s)&&(a=!0),t.interactive&&(a&&!e.target&&(e.target=t),n&&n(e,t,!!a))),a},r.prototype.findHit=function(e,t,n,i){this.recursiveFindHit(e,t,n,i,!1)},r}(),$y={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(r){r?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};ci.mixin($y);var Yf={target:null,data:{global:null}},Jy=function(r){function e(t,n){var i=r.call(this)||this;return n=n||{},i.renderer=t,i.autoPreventDefault=n.autoPreventDefault===void 0||n.autoPreventDefault,i.interactionFrequency=n.interactionFrequency||10,i.mouse=new Av,i.mouse.identifier=1,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[1]=i.mouse,i.interactionDataPool=[],i.eventData=new Zy,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!("PointerEvent"in self),i.supportsTouchEvents="ontouchstart"in self,i.supportsPointerEvents=!!self.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new hS,i._tempDisplayObject=new Ev,i._useSystemTicker=n.useSystemTicker===void 0||n.useSystemTicker,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return function(t,n){function i(){this.constructor=t}qy(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,n){return Yf.target=null,Yf.data.global=t,n||(n=this.lastObjectRendered),this.processInteractive(Yf,n,null,!0),Yf.target},e.prototype.setTargetElement=function(t,n){n===void 0&&(n=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=n,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(Ci.system.add(this.tickerUpdate,this,wr.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(Ci.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(self.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),self.addEventListener("pointercancel",this.onPointerCancel,!0),self.addEventListener("pointerup",this.onPointerUp,!0)):(self.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),self.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(self.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),self.removeEventListener("pointercancel",this.onPointerCancel,!0),self.removeEventListener("pointerup",this.onPointerUp,!0)):(self.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),self.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var n=this.activeInteractionData[t];if(n.originalEvent&&n.pointerType!=="touch"){var i=this.configureInteractionEventForDOMEvent(this.eventData,n.originalEvent,n);this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){t=t||"default";var n=!0;if(self.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(n=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var i=this.cursorStyles[t];if(i)switch(typeof i){case"string":n&&(this.interactionDOMElement.style.cursor=i);break;case"function":i(t);break;case"object":n&&Object.assign(this.interactionDOMElement.style,i)}else n&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,n,i){i.stopPropagationHint&&t!==i.stopsPropagatingAt||(i.currentTarget=t,i.type=n,t.emit(n,i),t[n]&&t[n](i))},e.prototype.delayDispatchEvent=function(t,n,i){this.delayedEvents.push({displayObject:t,eventString:n,eventData:i})},e.prototype.mapPositionToPoint=function(t,n,i){var o;o=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var s=1/this.resolution;t.x=(n-o.left)*(this.interactionDOMElement.width/o.width)*s,t.y=(i-o.top)*(this.interactionDOMElement.height/o.height)*s},e.prototype.processInteractive=function(t,n,i,o){var s=this.search.findHit(t,n,i,o),a=this.delayedEvents;if(!a.length)return s;t.stopPropagationHint=!1;var h=a.length;this.delayedEvents=[];for(var u=0;u<h;u++){var c=a[u],d=c.displayObject,f=c.eventString,m=c.eventData;m.stopsPropagatingAt===d&&(m.stopPropagationHint=!0),this.dispatchEvent(d,f,m)}return s},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||t.pointerType!=="touch"){var n=this.normalizeToPointerData(t);this.autoPreventDefault&&n[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var i=n.length,o=0;o<i;o++){var s=n[o],a=this.getInteractionDataForPointerId(s),h=this.configureInteractionEventForDOMEvent(this.eventData,s,a);if(h.data.originalEvent=t,this.processInteractive(h,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",h),s.pointerType==="touch")this.emit("touchstart",h);else if(s.pointerType==="mouse"||s.pointerType==="pen"){var u=s.button===2;this.emit(u?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,n,i){var o=t.data,s=t.data.identifier;if(i){if(n.trackedPointers[s]||(n.trackedPointers[s]=new Xf(s)),this.dispatchEvent(n,"pointerdown",t),o.pointerType==="touch")this.dispatchEvent(n,"touchstart",t);else if(o.pointerType==="mouse"||o.pointerType==="pen"){var a=o.button===2;a?n.trackedPointers[s].rightDown=!0:n.trackedPointers[s].leftDown=!0,this.dispatchEvent(n,a?"rightdown":"mousedown",t)}}},e.prototype.onPointerComplete=function(t,n,i){for(var o=this.normalizeToPointerData(t),s=o.length,a=t.target!==this.interactionDOMElement?"outside":"",h=0;h<s;h++){var u=o[h],c=this.getInteractionDataForPointerId(u),d=this.configureInteractionEventForDOMEvent(this.eventData,u,c);if(d.data.originalEvent=t,this.processInteractive(d,this.lastObjectRendered,i,n||!a),this.emit(n?"pointercancel":"pointerup"+a,d),u.pointerType==="mouse"||u.pointerType==="pen"){var f=u.button===2;this.emit(f?"rightup"+a:"mouseup"+a,d)}else u.pointerType==="touch"&&(this.emit(n?"touchcancel":"touchend"+a,d),this.releaseInteractionDataForPointerId(u.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&t.pointerType==="touch"||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,n){var i=t.data,o=t.data.identifier;n.trackedPointers[o]!==void 0&&(delete n.trackedPointers[o],this.dispatchEvent(n,"pointercancel",t),i.pointerType==="touch"&&this.dispatchEvent(n,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&t.pointerType==="touch"||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,n,i){var o=t.data,s=t.data.identifier,a=n.trackedPointers[s],h=o.pointerType==="touch",u=o.pointerType==="mouse"||o.pointerType==="pen",c=!1;if(u){var d=o.button===2,f=Xf.FLAGS,m=d?f.RIGHT_DOWN:f.LEFT_DOWN,g=a!==void 0&&a.flags&m;i?(this.dispatchEvent(n,d?"rightup":"mouseup",t),g&&(this.dispatchEvent(n,d?"rightclick":"click",t),c=!0)):g&&this.dispatchEvent(n,d?"rightupoutside":"mouseupoutside",t),a&&(d?a.rightDown=!1:a.leftDown=!1)}i?(this.dispatchEvent(n,"pointerup",t),h&&this.dispatchEvent(n,"touchend",t),a&&(u&&!c||this.dispatchEvent(n,"pointertap",t),h&&(this.dispatchEvent(n,"tap",t),a.over=!1))):a&&(this.dispatchEvent(n,"pointerupoutside",t),h&&this.dispatchEvent(n,"touchendoutside",t)),a&&a.none&&delete n.trackedPointers[s]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||t.pointerType!=="touch"){var n=this.normalizeToPointerData(t);n[0].pointerType!=="mouse"&&n[0].pointerType!=="pen"||(this._didMove=!0,this.cursor=null);for(var i=n.length,o=0;o<i;o++){var s=n[o],a=this.getInteractionDataForPointerId(s),h=this.configureInteractionEventForDOMEvent(this.eventData,s,a);h.data.originalEvent=t,this.processInteractive(h,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",h),s.pointerType==="touch"&&this.emit("touchmove",h),s.pointerType!=="mouse"&&s.pointerType!=="pen"||this.emit("mousemove",h)}n[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,n,i){var o=t.data,s=o.pointerType==="touch",a=o.pointerType==="mouse"||o.pointerType==="pen";a&&this.processPointerOverOut(t,n,i),this.moveWhenInside&&!i||(this.dispatchEvent(n,"pointermove",t),s&&this.dispatchEvent(n,"touchmove",t),a&&this.dispatchEvent(n,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||t.pointerType!=="touch"){var n=this.normalizeToPointerData(t)[0];n.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,i);o.data.originalEvent=n,this.processInteractive(o,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",o),n.pointerType==="mouse"||n.pointerType==="pen"?this.emit("mouseout",o):this.releaseInteractionDataForPointerId(i.identifier)}},e.prototype.processPointerOverOut=function(t,n,i){var o=t.data,s=t.data.identifier,a=o.pointerType==="mouse"||o.pointerType==="pen",h=n.trackedPointers[s];i&&!h&&(h=n.trackedPointers[s]=new Xf(s)),h!==void 0&&(i&&this.mouseOverRenderer?(h.over||(h.over=!0,this.delayDispatchEvent(n,"pointerover",t),a&&this.delayDispatchEvent(n,"mouseover",t)),a&&this.cursor===null&&(this.cursor=n.cursor)):h.over&&(h.over=!1,this.dispatchEvent(n,"pointerout",this.eventData),a&&this.dispatchEvent(n,"mouseout",t),h.none&&delete n.trackedPointers[s]))},e.prototype.onPointerOver=function(t){var n=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,i);o.data.originalEvent=n,n.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",o),n.pointerType!=="mouse"&&n.pointerType!=="pen"||this.emit("mouseover",o)},e.prototype.getInteractionDataForPointerId=function(t){var n,i=t.pointerId;return i===1||t.pointerType==="mouse"?n=this.mouse:this.activeInteractionData[i]?n=this.activeInteractionData[i]:((n=this.interactionDataPool.pop()||new Av).identifier=i,this.activeInteractionData[i]=n),n.copyEvent(t),n},e.prototype.releaseInteractionDataForPointerId=function(t){var n=this.activeInteractionData[t];n&&(delete this.activeInteractionData[t],n.reset(),this.interactionDataPool.push(n))},e.prototype.configureInteractionEventForDOMEvent=function(t,n,i){return t.data=i,this.mapPositionToPoint(i.global,n.clientX,n.clientY),n.pointerType==="touch"&&(n.globalX=i.global.x,n.globalY=i.global.y),i.originalEvent=n,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var n=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,o=t.changedTouches.length;i<o;i++){var s=t.changedTouches[i];s.button===void 0&&(s.button=t.touches.length?1:0),s.buttons===void 0&&(s.buttons=t.touches.length?1:0),s.isPrimary===void 0&&(s.isPrimary=t.touches.length===1&&t.type==="touchstart"),s.width===void 0&&(s.width=s.radiusX||1),s.height===void 0&&(s.height=s.radiusY||1),s.tiltX===void 0&&(s.tiltX=0),s.tiltY===void 0&&(s.tiltY=0),s.pointerType===void 0&&(s.pointerType="touch"),s.pointerId===void 0&&(s.pointerId=s.identifier||0),s.pressure===void 0&&(s.pressure=s.force||.5),s.twist===void 0&&(s.twist=0),s.tangentialPressure===void 0&&(s.tangentialPressure=0),s.layerX===void 0&&(s.layerX=s.offsetX=s.clientX),s.layerY===void 0&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,n.push(s)}else if(self.MouseEvent&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof self.PointerEvent))n.push(t);else{var a=t;a.isPrimary===void 0&&(a.isPrimary=!0),a.width===void 0&&(a.width=1),a.height===void 0&&(a.height=1),a.tiltX===void 0&&(a.tiltX=0),a.tiltY===void 0&&(a.tiltY=0),a.pointerType===void 0&&(a.pointerType="mouse"),a.pointerId===void 0&&(a.pointerId=1),a.pressure===void 0&&(a.pressure=.5),a.twist===void 0&&(a.twist=0),a.tangentialPressure===void 0&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}return n},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e}(Il.a),Ui=function(){function r(e){this.items=[],this._name=e,this._aliasCount=0}return r.prototype.emit=function(e,t,n,i,o,s,a,h){if(arguments.length>8)throw new Error("max arguments reached");var u=this,c=u.name,d=u.items;this._aliasCount++;for(var f=0,m=d.length;f<m;f++)d[f][c](e,t,n,i,o,s,a,h);return d===this.items&&this._aliasCount--,this},r.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},r.prototype.add=function(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this},r.prototype.remove=function(e){var t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},r.prototype.contains=function(e){return this.items.indexOf(e)!==-1},r.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},r.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(r.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),r}();Object.defineProperties(Ui.prototype,{dispatch:{value:Ui.prototype.emit},run:{value:Ui.prototype.emit}}),Et.PREFER_ENV=Kr.any?ns.WEBGL:ns.WEBGL2,Et.STRICT_TEXTURE_CACHE=!1;var _d=[];function qf(r,e){if(!r)return null;var t="";if(typeof r=="string"){var n=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);n&&(t=n[1].toLowerCase())}for(var i=_d.length-1;i>=0;--i){var o=_d[i];if(o.test&&o.test(r,t))return new o(r,e)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ky=function(r,e){return(Ky=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)};function Qt(r,e){function t(){this.constructor=r}Ky(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var tu=function(){function r(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new Ui("setRealSize"),this.onUpdate=new Ui("update"),this.onError=new Ui("onError")}return r.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},r.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},r.prototype.resize=function(e,t){e===this._width&&t===this._height||(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(r.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),r.prototype.update=function(){this.destroyed||this.onUpdate.emit()},r.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),r.prototype.style=function(e,t,n){return!1},r.prototype.dispose=function(){},r.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},r.test=function(e,t){return!1},r}(),Ll=function(r){function e(t,n){var i=this,o=n||{},s=o.width,a=o.height;if(!s||!a)throw new Error("BufferResource width or height invalid");return(i=r.call(this,s,a)||this).data=t,i}return Qt(e,r),e.prototype.upload=function(t,n,i){var o=t.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===os.UNPACK);var s=n.realWidth,a=n.realHeight;return i.width===s&&i.height===a?o.texSubImage2D(n.target,0,0,0,s,a,n.format,n.type,this.data):(i.width=s,i.height=a,o.texImage2D(n.target,0,i.internalFormat,s,a,0,n.format,i.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(tu),uS={scaleMode:is.NEAREST,format:Mo.RGBA,alphaMode:os.NPM},mn=function(r){function e(t,n){t===void 0&&(t=null),n===void 0&&(n=null);var i=r.call(this)||this,o=(n=n||{}).alphaMode,s=n.mipmap,a=n.anisotropicLevel,h=n.scaleMode,u=n.width,c=n.height,d=n.wrapMode,f=n.format,m=n.type,g=n.target,v=n.resolution,x=n.resourceOptions;return!t||t instanceof tu||((t=qf(t,x)).internal=!0),i.width=u||0,i.height=c||0,i.resolution=v||Et.RESOLUTION,i.mipmap=s!==void 0?s:Et.MIPMAP_TEXTURES,i.anisotropicLevel=a!==void 0?a:Et.ANISOTROPIC_LEVEL,i.wrapMode=d||Et.WRAP_MODE,i.scaleMode=h!==void 0?h:Et.SCALE_MODE,i.format=f||Mo.RGBA,i.type=m||yn.UNSIGNED_BYTE,i.target=g||Ua.TEXTURE_2D,i.alphaMode=o!==void 0?o:os.UNPACK,i.uid=qh(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=u>0&&c>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(t),i}return Qt(e,r),Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,n){var i;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),n!==void 0&&n!==this.mipmap&&(this.mipmap=n,i=!0),i&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,n,i){return this.resolution=i||this.resolution,this.width=t,this.height=n,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,n,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=n/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=vv(this.realWidth)&&vv(this.realHeight)},e.prototype.setResolution=function(t){var n=this.resolution;return n===t||(this.resolution=t,this.valid&&(this.width=this.width*n/t,this.height=this.height*n/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete eo[this.cacheId],delete br[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,n,i){i===void 0&&(i=Et.STRICT_TEXTURE_CACHE);var o=typeof t=="string",s=null;if(o)s=t;else{if(!t._pixiId){var a=n&&n.pixiIdPrefix||"pixiid";t._pixiId=a+"_"+qh()}s=t._pixiId}var h=eo[s];if(o&&i&&!h)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return h||((h=new e(t,n)).cacheId=s,e.addToCache(h,s)),h},e.fromBuffer=function(t,n,i,o){t=t||new Float32Array(n*i*4);var s=new Ll(t,{width:n,height:i}),a=t instanceof Float32Array?yn.FLOAT:yn.UNSIGNED_BYTE;return new e(s,Object.assign(uS,o||{width:n,height:i,type:a}))},e.addToCache=function(t,n){n&&(t.textureCacheIds.indexOf(n)===-1&&t.textureCacheIds.push(n),eo[n]&&console.warn("BaseTexture added to the cache with an id ["+n+"] that already had an entry"),eo[n]=t)},e.removeFromCache=function(t){if(typeof t=="string"){var n=eo[t];if(n){var i=n.textureCacheIds.indexOf(t);return i>-1&&n.textureCacheIds.splice(i,1),delete eo[t],n}}else if(t&&t.textureCacheIds){for(var o=0;o<t.textureCacheIds.length;++o)delete eo[t.textureCacheIds[o]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(Il.a),Zf=function(r){function e(t,n){var i=this,o=n||{},s=o.width,a=o.height;(i=r.call(this,s,a)||this).items=[],i.itemDirtyIds=[];for(var h=0;h<t;h++){var u=new mn;i.items.push(u),i.itemDirtyIds.push(-2)}return i.length=t,i._load=null,i.baseTexture=null,i}return Qt(e,r),e.prototype.initFromArray=function(t,n){for(var i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof tu?this.addResourceAt(t[i],i):this.addResourceAt(qf(t[i],n),i))},e.prototype.dispose=function(){for(var t=0,n=this.length;t<n;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,n){if(!this.items[n])throw new Error("Index "+n+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[n].setResource(t),this},e.prototype.bind=function(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");r.prototype.bind.call(this,t);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=t,this.items[n].on("update",t.update,t)},e.prototype.unbind=function(t){r.prototype.unbind.call(this,t);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",t.update,t)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var n=this.items.map(function(i){return i.resource}).filter(function(i){return i}).map(function(i){return i.load()});return this._load=Promise.all(n).then(function(){var i=t.items[0],o=i.realWidth,s=i.realHeight;return t.resize(o,s),Promise.resolve(t)}),this._load},e}(tu),Pv=function(r){function e(t,n){var i,o,s=this,a=n||{},h=a.width,u=a.height;return Array.isArray(t)?(i=t,o=t.length):o=t,s=r.call(this,o,{width:h,height:u})||this,i&&s.initFromArray(i,n),s}return Qt(e,r),e.prototype.addBaseTextureAt=function(t,n){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,n),this},e.prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=Ua.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,n,i){var o=this.length,s=this.itemDirtyIds,a=this.items,h=t.gl;i.dirtyId<0&&h.texImage3D(h.TEXTURE_2D_ARRAY,0,n.format,this._width,this._height,o,0,n.format,n.type,null);for(var u=0;u<o;u++){var c=a[u];s[u]<c.dirtyId&&(s[u]=c.dirtyId,c.valid&&h.texSubImage3D(h.TEXTURE_2D_ARRAY,0,0,0,u,c.resource.width,c.resource.height,1,n.format,n.type,c.resource.source))}return!0},e}(Zf),ss=function(r){function e(t){var n=this,i=t,o=i.naturalWidth||i.videoWidth||i.width,s=i.naturalHeight||i.videoHeight||i.height;return(n=r.call(this,o,s)||this).source=t,n.noSubImage=!1,n}return Qt(e,r),e.crossOrigin=function(t,n,i){i===void 0&&n.indexOf("data:")!==0?t.crossOrigin=Uy(n):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")},e.prototype.upload=function(t,n,i,o){var s=t.gl,a=n.realWidth,h=n.realHeight;return o=o||this.source,s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===os.UNPACK),this.noSubImage||n.target!==s.TEXTURE_2D||i.width!==a||i.height!==h?(i.width=a,i.height=h,s.texImage2D(n.target,0,n.format,n.format,n.type,o)):s.texSubImage2D(s.TEXTURE_2D,0,0,0,n.format,n.type,o),!0},e.prototype.update=function(){if(!this.destroyed){var t=this.source,n=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(n,i),r.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(tu),$f=function(r){function e(t){return r.call(this,t)||this}return Qt(e,r),e.test=function(t){var n=self.OffscreenCanvas;return!!(n&&t instanceof n)||self.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(ss),Rv=function(r){function e(t,n){var i=this,o=n||{},s=o.width,a=o.height,h=o.autoLoad,u=o.linkBaseTexture;if(t&&t.length!==e.SIDES)throw new Error("Invalid length. Got "+t.length+", expected 6");i=r.call(this,6,{width:s,height:a})||this;for(var c=0;c<e.SIDES;c++)i.items[c].target=Ua.TEXTURE_CUBE_MAP_POSITIVE_X+c;return i.linkBaseTexture=u!==!1,t&&i.initFromArray(t,n),h!==!1&&i.load(),i}return Qt(e,r),e.prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=Ua.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,n,i){if(!this.items[n])throw new Error("Index "+n+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,n)}else t.target=Ua.TEXTURE_CUBE_MAP_POSITIVE_X+n,t.parentTextureArray=this.baseTexture,this.items[n]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[n]=t,this},e.prototype.upload=function(t,n,i){for(var o=this.itemDirtyIds,s=0;s<e.SIDES;s++){var a=this.items[s];o[s]<a.dirtyId&&(a.valid&&a.resource?(a.resource.upload(t,a,i),o[s]=a.dirtyId):o[s]<-1&&(t.gl.texImage2D(a.target,0,i.internalFormat,n.realWidth,n.realHeight,0,n.format,i.type,null),o[s]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(Zf),Jf=function(r){function e(t,n){var i=this;if(n=n||{},!(t instanceof HTMLImageElement)){var o=new Image;ss.crossOrigin(o,t,n.crossorigin),o.src=t,t=o}return i=r.call(this,t)||this,!t.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=t.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(n.createBitmap!==void 0?n.createBitmap:Et.CREATE_IMAGE_BITMAP)&&!!self.createImageBitmap,i.alphaMode=typeof n.alphaMode=="number"?n.alphaMode:null,i.bitmap=null,i._load=null,n.autoLoad!==!1&&i.load(),i}return Qt(e,r),e.prototype.load=function(t){var n=this;return this._load||(t!==void 0&&(this.createBitmap=t),this._load=new Promise(function(i,o){var s=n.source;n.url=s.src;var a=function(){n.destroyed||(s.onload=null,s.onerror=null,n.resize(s.width,s.height),n._load=null,n.createBitmap?i(n.process()):i(n))};s.complete&&s.src?a():(s.onload=a,s.onerror=function(h){o(h),n.onError.emit(h)})})),this._load},e.prototype.process=function(){var t=this,n=this.source;return this._process!==null?this._process:this.bitmap===null&&self.createImageBitmap?(this._process=self.createImageBitmap(n,0,0,n.width,n.height,{premultiplyAlpha:this.alphaMode===os.UNPACK?"premultiply":"none"}).then(function(i){return t.destroyed?Promise.reject():(t.bitmap=i,t.update(),t._process=null,Promise.resolve(t))}),this._process):Promise.resolve(this)},e.prototype.upload=function(t,n,i){if(typeof this.alphaMode=="number"&&(n.alphaMode=this.alphaMode),!this.createBitmap)return r.prototype.upload.call(this,t,n,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(r.prototype.upload.call(this,t,n,i,this.bitmap),!this.preserveBitmap){var o=!0,s=n._glTextures;for(var a in s){var h=s[a];if(h!==i&&h.dirtyId!==n.dirtyId){o=!1;break}}o&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,r.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return typeof t=="string"||t instanceof HTMLImageElement},e}(ss),Cv=function(r){function e(t,n){var i=this;return n=n||{},(i=r.call(this,document.createElement("canvas"))||this)._width=0,i._height=0,i.svg=t,i.scale=n.scale||1,i._overrideWidth=n.width,i._overrideHeight=n.height,i._resolve=null,i._crossorigin=n.crossorigin,i._load=null,n.autoLoad!==!1&&i.load(),i}return Qt(e,r),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise(function(n){if(t._resolve=function(){t.resize(t.source.width,t.source.height),n(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()})),this._load},e.prototype._loadSvg=function(){var t=this,n=new Image;ss.crossOrigin(n,this.svg,this._crossorigin),n.src=this.svg,n.onerror=function(i){t._resolve&&(n.onerror=null,t.onError.emit(i))},n.onload=function(){if(t._resolve){var i=n.width,o=n.height;if(!i||!o)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var s=i*t.scale,a=o*t.scale;(t._overrideWidth||t._overrideHeight)&&(s=t._overrideWidth||t._overrideHeight/o*i,a=t._overrideHeight||t._overrideWidth/i*o),s=Math.round(s),a=Math.round(a);var h=t.source;h.width=s,h.height=a,h._pixiId="canvas_"+qh(),h.getContext("2d").drawImage(n,0,0,i,o,0,0,s,a),t._resolve(),t._resolve=null}}},e.getSize=function(t){var n=e.SVG_SIZE.exec(t),i={};return n&&(i[n[1]]=Math.round(parseFloat(n[3])),i[n[5]]=Math.round(parseFloat(n[7]))),i},e.prototype.dispose=function(){r.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,n){return n==="svg"||typeof t=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)||typeof t=="string"&&t.indexOf("<svg")===0},e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(ss),Kf=function(r){function e(t,n){var i=this;if(n=n||{},!(t instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),typeof t=="string"&&(t=[t]);var s=t[0].src||t[0];ss.crossOrigin(o,s,n.crossorigin);for(var a=0;a<t.length;++a){var h=document.createElement("source"),u=t[a],c=u.src,d=u.mime,f=(c=c||t[a]).split("?").shift().toLowerCase(),m=f.substr(f.lastIndexOf(".")+1);d=d||e.MIME_TYPES[m]||"video/"+m,h.src=c,h.type=d,o.appendChild(h)}t=o}return(i=r.call(this,t)||this).noSubImage=!0,i._autoUpdate=!0,i._isConnectedToTicker=!1,i._updateFPS=n.updateFPS||0,i._msToNextUpdate=0,i.autoPlay=n.autoPlay!==!1,i._load=null,i._resolve=null,i._onCanPlay=i._onCanPlay.bind(i),i._onError=i._onError.bind(i),n.autoLoad!==!1&&i.load(),i}return Qt(e,r),e.prototype.update=function(t){if(!this.destroyed){var n=Ci.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(r.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var n=this.source;return(n.readyState===n.HAVE_ENOUGH_DATA||n.readyState===n.HAVE_FUTURE_DATA)&&n.width&&n.height&&(n.complete=!0),n.addEventListener("play",this._onPlayStart.bind(this)),n.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(n.addEventListener("canplay",this._onCanPlay),n.addEventListener("canplaythrough",this._onCanPlay),n.addEventListener("error",this._onError,!0)),this._load=new Promise(function(i){t.valid?i(t):(t._resolve=i,n.load())}),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&t.paused===!1&&t.ended===!1&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return t.readyState===3||t.readyState===4},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ci.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Ci.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var n=this.valid;this.resize(t.videoWidth,t.videoHeight),!n&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&Ci.shared.remove(this.update,this);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),r.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Ci.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ci.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,n){return self.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(n)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(ss),Iv=function(r){function e(t){return r.call(this,t)||this}return Qt(e,r),e.test=function(t){return!!self.createImageBitmap&&t instanceof ImageBitmap},e}(ss);_d.push(Jf,Iv,$f,Kf,Cv,Ll,Rv,Pv);var Qy={__proto__:null,Resource:tu,BaseImageResource:ss,INSTALLED:_d,autoDetectResource:qf,AbstractMultiResource:Zf,ArrayResource:Pv,BufferResource:Ll,CanvasResource:$f,CubeResource:Rv,ImageResource:Jf,SVGResource:Cv,VideoResource:Kf,ImageBitmapResource:Iv},Tr=function(){function r(e){this.renderer=e}return r.prototype.destroy=function(){this.renderer=null},r}(),lS=function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return Qt(e,r),e.prototype.upload=function(t,n,i){var o=t.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===os.UNPACK);var s=n.realWidth,a=n.realHeight;return i.width===s&&i.height===a?o.texSubImage2D(n.target,0,0,0,s,a,n.format,n.type,this.data):(i.width=s,i.height=a,o.texImage2D(n.target,0,t.context.webGLVersion===1?o.DEPTH_COMPONENT:o.DEPTH_COMPONENT16,s,a,0,n.format,n.type,this.data)),!0},e}(Ll),Qf=function(){function r(e,t){this.width=Math.ceil(e||100),this.height=Math.ceil(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Ui("disposeFramebuffer"),this.multisample=Vh.NONE}return Object.defineProperty(r.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),r.prototype.addColorTexture=function(e,t){return e===void 0&&(e=0),this.colorTextures[e]=t||new mn(null,{scaleMode:is.NEAREST,resolution:1,mipmap:qs.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},r.prototype.addDepthTexture=function(e){return this.depthTexture=e||new mn(new lS(null,{width:this.width,height:this.height}),{scaleMode:is.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:qs.OFF,format:Mo.DEPTH_COMPONENT,type:yn.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},r.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},r.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},r.prototype.resize=function(e,t){if(e=Math.ceil(e),t=Math.ceil(t),e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var i=this.colorTextures[n],o=i.resolution;i.setSize(e/o,t/o)}this.depthTexture&&(o=this.depthTexture.resolution,this.depthTexture.setSize(e/o,t/o))}},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},r}(),Lv=function(r){function e(t){var n=this;if(typeof t=="number"){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];t={width:i,height:o,scaleMode:s,resolution:a}}n=r.call(this,null,t)||this;var h=t||{},u=h.width,c=h.height;return n.mipmap=qs.OFF,n.width=Math.ceil(u)||100,n.height=Math.ceil(c)||100,n.valid=!0,n.clearColor=[0,0,0,0],n.framebuffer=new Qf(n.width*n.resolution,n.height*n.resolution).addColorTexture(0,n),n.maskStack=[],n.filterStack=[{}],n}return Qt(e,r),e.prototype.resize=function(t,n){t=Math.ceil(t),n=Math.ceil(n),this.framebuffer.resize(t*this.resolution,n*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),r.prototype.dispose.call(this)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(mn),Ov=function(){function r(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return r.prototype.set=function(e,t,n){var i=t.width,o=t.height;if(n){var s=e.width/2/i,a=e.height/2/o,h=e.x/i+s,u=e.y/o+a;n=jn.add(n,jn.NW),this.x0=h+s*jn.uX(n),this.y0=u+a*jn.uY(n),n=jn.add(n,2),this.x1=h+s*jn.uX(n),this.y1=u+a*jn.uY(n),n=jn.add(n,2),this.x2=h+s*jn.uX(n),this.y2=u+a*jn.uY(n),n=jn.add(n,2),this.x3=h+s*jn.uX(n),this.y3=u+a*jn.uY(n)}else this.x0=e.x/i,this.y0=e.y/o,this.x1=(e.x+e.width)/i,this.y1=e.y/o,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/o,this.x3=e.x/i,this.y3=(e.y+e.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},r.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},r}(),ex=new Ov,Ot=function(r){function e(t,n,i,o,s,a){var h=r.call(this)||this;if(h.noFrame=!1,n||(h.noFrame=!0,n=new en(0,0,1,1)),t instanceof e&&(t=t.baseTexture),h.baseTexture=t,h._frame=n,h.trim=o,h.valid=!1,h._uvs=ex,h.uvMatrix=null,h.orig=i||n,h._rotate=Number(s||0),s===!0)h._rotate=2;else if(h._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return h.defaultAnchor=a?new ni(a.x,a.y):new ni(0,0),h._updateID=0,h.textureCacheIds=[],t.valid?h.noFrame?t.valid&&h.onBaseTextureUpdated(t):h.frame=n:t.once("loaded",h.onBaseTextureUpdated,h),h.noFrame&&t.on("update",h.onBaseTextureUpdated,h),h}return Qt(e,r),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var n=this.baseTexture.resource;n&&n.url&&br[n.url]&&e.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),n=this._frame===this.orig?t:this.orig.clone(),i=new e(this.baseTexture,!this.noFrame&&t,n,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i},e.prototype.updateUvs=function(){this._uvs===ex&&(this._uvs=new Ov),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,n,i){n===void 0&&(n={}),i===void 0&&(i=Et.STRICT_TEXTURE_CACHE);var o=typeof t=="string",s=null;if(o)s=t;else{if(!t._pixiId){var a=n&&n.pixiIdPrefix||"pixiid";t._pixiId=a+"_"+qh()}s=t._pixiId}var h=br[s];if(o&&i&&!h)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return h||(n.resolution||(n.resolution=fd(t)),(h=new e(new mn(t,n))).baseTexture.cacheId=s,mn.addToCache(h.baseTexture,s),e.addToCache(h,s)),h},e.fromURL=function(t,n){var i=Object.assign({autoLoad:!1},n==null?void 0:n.resourceOptions),o=e.from(t,Object.assign({resourceOptions:i},n),!1),s=o.baseTexture.resource;return o.baseTexture.valid?Promise.resolve(o):s.load().then(function(){return Promise.resolve(o)})},e.fromBuffer=function(t,n,i,o){return new e(mn.fromBuffer(t,n,i,o))},e.fromLoader=function(t,n,i,o){var s=new mn(t,Object.assign({scaleMode:Et.SCALE_MODE,resolution:fd(n)},o)),a=s.resource;a instanceof Jf&&(a.url=n);var h=new e(s);return i||(i=n),mn.addToCache(h.baseTexture,i),e.addToCache(h,i),i!==n&&(mn.addToCache(h.baseTexture,n),e.addToCache(h,n)),h.baseTexture.valid?Promise.resolve(h):new Promise(function(u){h.baseTexture.once("loaded",function(){return u(h)})})},e.addToCache=function(t,n){n&&(t.textureCacheIds.indexOf(n)===-1&&t.textureCacheIds.push(n),br[n]&&console.warn("Texture added to the cache with an id ["+n+"] that already had an entry"),br[n]=t)},e.removeFromCache=function(t){if(typeof t=="string"){var n=br[t];if(n){var i=n.textureCacheIds.indexOf(t);return i>-1&&n.textureCacheIds.splice(i,1),delete br[t],n}}else if(t&&t.textureCacheIds){for(var o=0;o<t.textureCacheIds.length;++o)br[t.textureCacheIds[o]]===t&&delete br[t.textureCacheIds[o]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var n=t.x,i=t.y,o=t.width,s=t.height,a=n+o>this.baseTexture.width,h=i+s>this.baseTexture.height;if(a||h){var u=a&&h?"and":"or",c="X: "+n+" + "+o+" = "+(n+o)+" > "+this.baseTexture.width,d="Y: "+i+" + "+s+" = "+(i+s)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+c+" "+u+" "+d)}this.valid=o&&s&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},e}(Il.a);function em(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}Ot.EMPTY=new Ot(new mn),em(Ot.EMPTY),em(Ot.EMPTY.baseTexture),Ot.WHITE=function(){var r=document.createElement("canvas");r.width=16,r.height=16;var e=r.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Ot(new mn(new $f(r)))}(),em(Ot.WHITE),em(Ot.WHITE.baseTexture);var to=function(r){function e(t,n){var i=r.call(this,t,n)||this;return i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return Qt(e,r),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,n,i){i===void 0&&(i=!0),t=Math.ceil(t),n=Math.ceil(n),this.valid=t>0&&n>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=n,i&&this.baseTexture.resize(t,n),this.updateUvs()},e.prototype.setResolution=function(t){var n=this.baseTexture;n.resolution!==t&&(n.setResolution(t),this.resize(n.width,n.height,!1))},e.create=function(t){for(var n=arguments,i=[],o=1;o<arguments.length;o++)i[o-1]=n[o];return typeof t=="number"&&(Zh("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:i[0],scaleMode:i[1],resolution:i[2]}),new e(new Lv(t))},e}(Ot),tx=function(){function r(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return r.prototype.createTexture=function(e,t){var n=new Lv(Object.assign({width:e,height:t,resolution:1},this.textureOptions));return new to(n)},r.prototype.getOptimalTexture=function(e,t,n){n===void 0&&(n=1);var i=r.SCREEN_KEY;e*=n,t*=n,this.enableFullScreen&&e===this._pixelsWidth&&t===this._pixelsHeight||(i=(65535&(e=pd(e)))<<16|65535&(t=pd(t))),this.texturePool[i]||(this.texturePool[i]=[]);var o=this.texturePool[i].pop();return o||(o=this.createTexture(e,t)),o.filterPoolKey=i,o.setResolution(n),o},r.prototype.getFilterTexture=function(e,t){var n=this.getOptimalTexture(e.width,e.height,t||e.resolution);return n.filterFrame=e.filterFrame,n},r.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},r.prototype.returnFilterTexture=function(e){this.returnTexture(e)},r.prototype.clear=function(e){if(e=e!==!1)for(var t in this.texturePool){var n=this.texturePool[t];if(n)for(var i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}},r.prototype.setScreenSize=function(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){var t=r.SCREEN_KEY,n=this.texturePool[t];if(this.enableFullScreen=e.width>0&&e.height>0,n)for(var i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[t]=[],this._pixelsWidth=e.width,this._pixelsHeight=e.height}},r.SCREEN_KEY="screen",r}(),Dv=function(){function r(e,t,n,i,o,s,a){t===void 0&&(t=0),n===void 0&&(n=!1),i===void 0&&(i=yn.FLOAT),this.buffer=e,this.size=t,this.normalized=n,this.type=i,this.stride=o,this.start=s,this.instance=a}return r.prototype.destroy=function(){this.buffer=null},r.from=function(e,t,n,i,o){return new r(e,t,n,i,o)},r}(),cS=0,Ii=function(){function r(e,t,n){t===void 0&&(t=!0),n===void 0&&(n=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=t,this.id=cS++,this.disposeRunner=new Ui("disposeBuffer")}return r.prototype.update=function(e){this.data=e||this.data,this._updateID++},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroy=function(){this.dispose(),this.data=null},r.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new r(e)},r}();function nx(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}var dS={Float32Array,Uint32Array,Int32Array,Uint8Array},ix={5126:4,5123:2,5121:1},pS=0,fS={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},nu=function(){function r(e,t){e===void 0&&(e=[]),t===void 0&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=pS++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Ui("disposeGeometry"),this.refCount=0}return r.prototype.addAttribute=function(e,t,n,i,o,s,a,h){if(n===void 0&&(n=0),i===void 0&&(i=!1),h===void 0&&(h=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Ii||(t instanceof Array&&(t=new Float32Array(t)),t=new Ii(t));var u=e.split("|");if(u.length>1){for(var c=0;c<u.length;c++)this.addAttribute(u[c],t,n,i,o);return this}var d=this.buffers.indexOf(t);return d===-1&&(this.buffers.push(t),d=this.buffers.length-1),this.attributes[e]=new Dv(d,n,i,o,s,a,h),this.instanced=this.instanced||h,this},r.prototype.getAttribute=function(e){return this.attributes[e]},r.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},r.prototype.addIndex=function(e){return e instanceof Ii||(e instanceof Array&&(e=new Uint16Array(e)),e=new Ii(e)),e.index=!0,this.indexBuffer=e,this.buffers.indexOf(e)===-1&&this.buffers.push(e),this},r.prototype.getIndex=function(){return this.indexBuffer},r.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var e,t=[],n=[],i=new Ii;for(e in this.attributes){var o=this.attributes[e],s=this.buffers[o.buffer];t.push(s.data),n.push(o.size*ix[o.type]/4),o.buffer=0}for(i.data=function(a,h){for(var u=0,c=0,d={},f=0;f<a.length;f++)c+=h[f],u+=a[f].length;var m=new ArrayBuffer(4*u),g=null,v=0;for(f=0;f<a.length;f++){var x=h[f],T=a[f],M=nx(T);d[M]||(d[M]=new dS[M](m)),g=d[M];for(var C=0;C<T.length;C++)g[(C/x|0)*c+v+C%x]=T[C];v+=x}return new Float32Array(m)}(t,n),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},r.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},r.prototype.clone=function(){for(var e=new r,t=0;t<this.buffers.length;t++)e.buffers[t]=new Ii(this.buffers[t].data.slice(0));for(var t in this.attributes){var n=this.attributes[t];e.attributes[t]=new Dv(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.index=!0),e},r.merge=function(e){for(var t,n=new r,i=[],o=[],s=[],a=0;a<e.length;a++){t=e[a];for(var h=0;h<t.buffers.length;h++)o[h]=o[h]||0,o[h]+=t.buffers[h].data.length,s[h]=0}for(a=0;a<t.buffers.length;a++)i[a]=new fS[nx(t.buffers[a].data)](o[a]),n.buffers[a]=new Ii(i[a]);for(a=0;a<e.length;a++)for(t=e[a],h=0;h<t.buffers.length;h++)i[h].set(t.buffers[h].data,s[h]),s[h]+=t.buffers[h].data.length;if(n.attributes=t.attributes,t.indexBuffer){n.indexBuffer=n.buffers[t.buffers.indexOf(t.indexBuffer)],n.indexBuffer.index=!0;var u=0,c=0,d=0,f=0;for(a=0;a<t.buffers.length;a++)if(t.buffers[a]!==t.indexBuffer){f=a;break}for(var a in t.attributes){var m=t.attributes[a];(0|m.buffer)===f&&(c+=m.size*ix[m.type]/4)}for(a=0;a<e.length;a++){var g=e[a].indexBuffer.data;for(h=0;h<g.length;h++)n.indexBuffer.data[h+d]+=u;u+=t.buffers[f].data.length/c,d+=g.length}}return n},r}(),rx=function(r){function e(){var t=r.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return Qt(e,r),e}(nu),Nv=function(r){function e(){var t=r.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new Ii(t.vertices),t.uvBuffer=new Ii(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return Qt(e,r),e.prototype.map=function(t,n){var i=0,o=0;return this.uvs[0]=i,this.uvs[1]=o,this.uvs[2]=i+n.width/t.width,this.uvs[3]=o,this.uvs[4]=i+n.width/t.width,this.uvs[5]=o+n.height/t.height,this.uvs[6]=i,this.uvs[7]=o+n.height/t.height,i=n.x,o=n.y,this.vertices[0]=i,this.vertices[1]=o,this.vertices[2]=i+n.width,this.vertices[3]=o,this.vertices[4]=i+n.width,this.vertices[5]=o+n.height,this.vertices[6]=i,this.vertices[7]=o+n.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(nu),mS=0,ka=function(){function r(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=mS++,this.static=!!t}return r.prototype.update=function(){this.dirtyId++},r.prototype.add=function(e,t,n){this.uniforms[e]=new r(t,n)},r.from=function(e,t){return new r(e,t)},r}(),ox=function(){function r(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new en,this.destinationFrame=new en,this.bindingSourceFrame=new en,this.bindingDestinationFrame=new en,this.filters=[],this.transform=null}return r.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},r}(),tm=[new ni,new ni,new ni,new ni],Fv=new li,Bv=function(r){function e(t){var n=r.call(this,t)||this;return n.defaultFilterStack=[{}],n.texturePool=new tx,n.texturePool.setScreenSize(t.view),n.statePool=[],n.quad=new rx,n.quadUv=new Nv,n.tempRect=new en,n.activeState={},n.globalUniforms=new ka({outputFrame:new en,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),n.forceClear=!1,n.useMaxPadding=!1,n}return Qt(e,r),e.prototype.push=function(t,n){for(var i=this.renderer,o=this.defaultFilterStack,s=this.statePool.pop()||new ox,a=this.renderer.renderTexture,h=n[0].resolution,u=n[0].padding,c=n[0].autoFit,d=n[0].legacy,f=1;f<n.length;f++){var m=n[f];h=Math.min(h,m.resolution),u=this.useMaxPadding?Math.max(u,m.padding):u+m.padding,c=c&&m.autoFit,d=d||m.legacy}if(o.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),o.push(s),s.resolution=h,s.legacy=d,s.target=t,s.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),s.sourceFrame.pad(u),c){var g=this.tempRect.copyFrom(a.sourceFrame);i.projection.transform&&this.transformAABB(Fv.copyFrom(i.projection.transform).invert(),g),s.sourceFrame.fit(g)}this.roundFrame(s.sourceFrame,a.current?a.current.resolution:i.resolution,a.sourceFrame,a.destinationFrame,i.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,h),s.filters=n,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;var v=this.tempRect;v.x=0,v.y=0,v.width=s.sourceFrame.width,v.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(a.sourceFrame),s.bindingDestinationFrame.copyFrom(a.destinationFrame),s.transform=i.projection.transform,i.projection.transform=null,a.bind(s.renderTexture,s.sourceFrame,v),i.framebuffer.clear(0,0,0,0)},e.prototype.pop=function(){var t=this.defaultFilterStack,n=t.pop(),i=n.filters;this.activeState=n;var o=this.globalUniforms.uniforms;o.outputFrame=n.sourceFrame,o.resolution=n.resolution;var s=o.inputSize,a=o.inputPixel,h=o.inputClamp;if(s[0]=n.destinationFrame.width,s[1]=n.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],a[0]=s[0]*n.resolution,a[1]=s[1]*n.resolution,a[2]=1/a[0],a[3]=1/a[1],h[0]=.5*a[2],h[1]=.5*a[3],h[2]=n.sourceFrame.width*s[2]-.5*a[2],h[3]=n.sourceFrame.height*s[3]-.5*a[3],n.legacy){var u=o.filterArea;u[0]=n.destinationFrame.width,u[1]=n.destinationFrame.height,u[2]=n.sourceFrame.x,u[3]=n.sourceFrame.y,o.filterClamp=o.inputClamp}this.globalUniforms.update();var c=t[t.length-1];if(n.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,n.renderTexture,c.renderTexture,Zs.BLEND,n),this.returnFilterTexture(n.renderTexture);else{var d=n.renderTexture,f=this.getOptimalFilterTexture(d.width,d.height,n.resolution);f.filterFrame=d.filterFrame;var m=0;for(m=0;m<i.length-1;++m){i[m].apply(this,d,f,Zs.CLEAR,n);var g=d;d=f,f=g}i[m].apply(this,d,c.renderTexture,Zs.BLEND,n),this.returnFilterTexture(d),this.returnFilterTexture(f)}n.clear(),this.statePool.push(n)},e.prototype.bindAndClear=function(t,n){n===void 0&&(n=Zs.CLEAR);var i=this.renderer,o=i.renderTexture,s=i.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,o.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?o.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var h=1&s.stateId||this.forceClear;(n===Zs.CLEAR||n===Zs.BLIT&&h)&&this.renderer.framebuffer.clear(0,0,0,0)},e.prototype.applyFilter=function(t,n,i,o){var s=this.renderer;s.state.set(t.state),this.bindAndClear(i,o),t.uniforms.uSampler=n,t.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(t),t.legacy?(this.quadUv.map(n._frame,n.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(Qr.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(Qr.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,n){var i=this.activeState,o=i.sourceFrame,s=i.destinationFrame,a=n._texture.orig,h=t.set(s.width,0,0,s.height,o.x,o.y),u=n.worldTransform.copyTo(li.TEMP_MATRIX);return u.invert(),h.prepend(u),h.scale(1/a.width,1/a.height),h.translate(n.anchor.x,n.anchor.y),h},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,n,i){return i===void 0&&(i=1),this.texturePool.getOptimalTexture(t,n,i)},e.prototype.getFilterTexture=function(t,n){if(typeof t=="number"){var i=t;t=n,n=i}t=t||this.activeState.renderTexture;var o=this.texturePool.getOptimalTexture(t.width,t.height,n||t.resolution);return o.filterFrame=t.filterFrame,o},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e.prototype.transformAABB=function(t,n){var i=tm[0],o=tm[1],s=tm[2],a=tm[3];i.set(n.left,n.top),o.set(n.left,n.bottom),s.set(n.right,n.top),a.set(n.right,n.bottom),t.apply(i,i),t.apply(o,o),t.apply(s,s),t.apply(a,a);var h=Math.min(i.x,o.x,s.x,a.x),u=Math.min(i.y,o.y,s.y,a.y),c=Math.max(i.x,o.x,s.x,a.x),d=Math.max(i.y,o.y,s.y,a.y);n.x=h,n.y=u,n.width=c-h,n.height=d-u},e.prototype.roundFrame=function(t,n,i,o,s){if(s){var a=s.a,h=s.b,u=s.c,c=s.d;if(!(h===0&&u===0||a===0&&c===0))return}(s=s?Fv.copyFrom(s):Fv.identity()).translate(-i.x,-i.y).scale(o.width/i.width,o.height/i.height).translate(o.x,o.y),this.transformAABB(s,t),t.ceil(n),this.transformAABB(s.invert(),t)},e}(Tr),yd=function(){function r(e){this.renderer=e}return r.prototype.flush=function(){},r.prototype.destroy=function(){this.renderer=null},r.prototype.start=function(){},r.prototype.stop=function(){this.flush()},r.prototype.render=function(e){},r}(),Uv=function(r){function e(t){var n=r.call(this,t)||this;return n.emptyRenderer=new yd(t),n.currentRenderer=n.emptyRenderer,n}return Qt(e,r),e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,n){for(var i=this.renderer.texture.boundTextures,o=n-1;o>=0;--o)t[o]=i[o]||null,t[o]&&(t[o]._batchLocation=o)},e.prototype.boundArray=function(t,n,i,o){for(var s=t.elements,a=t.ids,h=t.count,u=0,c=0;c<h;c++){var d=s[c],f=d._batchLocation;if(f>=0&&f<o&&n[f]===d)a[c]=f;else for(;u<o;){var m=n[u];if(!m||m._batchEnabled!==i||m._batchLocation!==u){a[c]=u,d._batchLocation=u,n[u]=d;break}u++}}},e}(Tr),sx=0,kv=function(r){function e(t){var n=r.call(this,t)||this;return n.webGLVersion=1,n.extensions={},n.supports={uint32Indices:!1},n.handleContextLost=n.handleContextLost.bind(n),n.handleContextRestored=n.handleContextRestored.bind(n),t.view.addEventListener("webglcontextlost",n.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",n.handleContextRestored,!1),n}return Qt(e,r),Object.defineProperty(e.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=sx++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=sx++,this.renderer.runners.contextChange.emit(t)},e.prototype.initFromOptions=function(t){var n=this.createContext(this.renderer.view,t);this.initFromContext(n)},e.prototype.createContext=function(t,n){var i;if(Et.PREFER_ENV>=ns.WEBGL2&&(i=t.getContext("webgl2",n)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",n)||t.getContext("experimental-webgl",n)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl},e.prototype.getExtensions=function(){var t=this.gl,n={anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,n,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,n,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){var n=t.getContextAttributes(),i="WebGL2RenderingContext"in self&&t instanceof self.WebGL2RenderingContext;i&&(this.webGLVersion=2),n.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var o=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=o,o||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},e}(Tr),ax=function(r){this.framebuffer=r,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=Vh.NONE,this.msaaBuffer=null,this.blitFramebuffer=null},gS=new en,Gv=function(r){function e(t){var n=r.call(this,t)||this;return n.managedFramebuffers=[],n.unknownFramebuffer=new Qf(10,10),n.msaaSamples=null,n}return Qt(e,r),e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new en,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var n=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Et.PREFER_ENV===ns.WEBGL_LEGACY&&(n=null,i=null),n?t.drawBuffers=function(o){return n.drawBuffersWEBGL(o)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},e.prototype.bind=function(t,n){var i=this.gl;if(t){var o=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,o.framebuffer)),o.dirtyId!==t.dirtyId&&(o.dirtyId=t.dirtyId,o.dirtyFormat!==t.dirtyFormat?(o.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):o.dirtySize!==t.dirtySize&&(o.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var s=0;s<t.colorTextures.length;s++){var a=t.colorTextures[s];this.renderer.texture.unbind(a.parentTextureArray||a)}t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),n?this.setViewport(n.x,n.y,n.width,n.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),n?this.setViewport(n.x,n.y,n.width,n.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,n,i,o){var s=this.viewport;s.width===i&&s.height===o&&s.x===t&&s.y===n||(s.x=t,s.y=n,s.width=i,s.height=o,this.gl.viewport(t,n,i,o))},Object.defineProperty(e.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),e.prototype.clear=function(t,n,i,o,s){s===void 0&&(s=cd.COLOR|cd.DEPTH);var a=this.gl;a.clearColor(t,n,i,o),a.clear(s)},e.prototype.initFramebuffer=function(t){var n=this.gl,i=new ax(n.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i},e.prototype.resizeFramebuffer=function(t){var n=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height));for(var o=t.colorTextures,s=0;s<o.length;s++)this.renderer.texture.bind(o[s],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var n=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],o=t.colorTextures.length;n.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&(i.msaaBuffer=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.RGBA8,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer));for(var s=[],a=0;a<o;a++)if(!(a===0&&i.multisample>1)){var h=t.colorTextures[a],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+a,h.target,u._glTextures[this.CONTEXT_UID].texture,0),s.push(n.COLOR_ATTACHMENT0+a)}if(s.length>1&&n.drawBuffers(s),t.depthTexture&&this.writeDepthTexture){var c=t.depthTexture;this.renderer.texture.bind(c,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,c._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),t.depthTexture||n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,i.stencil))},e.prototype.detectSamples=function(t){var n=this.msaaSamples,i=Vh.NONE;if(t<=1||n===null)return i;for(var o=0;o<n.length;o++)if(n[o]<=t){i=n[o];break}return i===1&&(i=Vh.NONE),i},e.prototype.blit=function(t,n,i){var o=this.current,s=this.renderer,a=this.gl,h=this.CONTEXT_UID;if(s.context.webGLVersion===2&&o){var u=o.glFramebuffers[h];if(u){if(!t){if(u.multisample<=1)return;u.blitFramebuffer||(u.blitFramebuffer=new Qf(o.width,o.height),u.blitFramebuffer.addColorTexture(0,o.colorTextures[0])),(t=u.blitFramebuffer).width=o.width,t.height=o.height}n||((n=gS).width=o.width,n.height=o.height),i||(i=n);var c=n.width===i.width&&n.height===i.height;this.bind(t),a.bindFramebuffer(a.READ_FRAMEBUFFER,u.framebuffer),a.blitFramebuffer(n.x,n.y,n.width,n.height,i.x,i.y,i.width,i.height,a.COLOR_BUFFER_BIT,c?a.NEAREST:a.LINEAR)}}},e.prototype.disposeFramebuffer=function(t,n){var i=t.glFramebuffers[this.CONTEXT_UID],o=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var s=this.managedFramebuffers.indexOf(t);s>=0&&this.managedFramebuffers.splice(s,1),t.disposeRunner.remove(this),n||(o.deleteFramebuffer(i.framebuffer),i.stencil&&o.deleteRenderbuffer(i.stencil))}},e.prototype.disposeAll=function(t){var n=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<n.length;i++)this.disposeFramebuffer(n[i],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var n=t.glFramebuffers[this.CONTEXT_UID];if(n&&!n.stencil){t.enableStencil();var i=t.width,o=t.height,s=this.gl,a=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,a),s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,i,o),n.stencil=a,s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,a)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new en},e}(Tr),vS=function(r){this.buffer=r||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},Hv={5126:4,5123:2,5121:1},zv=function(r){function e(t){var n=r.call(this,t)||this;return n._activeGeometry=null,n._activeVao=null,n.hasVao=!0,n.hasInstance=!0,n.canUseUInt32ElementIndex=!1,n.managedGeometries={},n.managedBuffers={},n}return Qt(e,r),e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,n=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,n.webGLVersion!==2){var i=this.renderer.context.extensions.vertexArrayObject;Et.PREFER_ENV===ns.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(s){return i.bindVertexArrayOES(s)},t.deleteVertexArray=function(s){return i.deleteVertexArrayOES(s)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(n.webGLVersion!==2){var o=t.getExtension("ANGLE_instanced_arrays");o?(t.vertexAttribDivisor=function(s,a){return o.vertexAttribDivisorANGLE(s,a)},t.drawElementsInstanced=function(s,a,h,u,c){return o.drawElementsInstancedANGLE(s,a,h,u,c)},t.drawArraysInstanced=function(s,a,h,u){return o.drawArraysInstancedANGLE(s,a,h,u)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=n.webGLVersion===2||!!n.extensions.uint32ElementIndex},e.prototype.bind=function(t,n){n=n||this.renderer.shader.shader;var i=this.gl,o=t.glVertexArrayObjects[this.CONTEXT_UID],s=!1;o||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=o={},s=!0);var a=o[n.program.id]||this.initGeometryVao(t,n.program,s);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?i.bindVertexArray(a):this.activateVao(t,n.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,n=this.gl,i=0;i<t.buffers.length;i++){var o=t.buffers[i],s=o._glBuffers[this.CONTEXT_UID];if(o._updateID!==s.updateID){s.updateID=o._updateID;var a=o.index?n.ELEMENT_ARRAY_BUFFER:n.ARRAY_BUFFER;if(n.bindBuffer(a,s.buffer),this._boundBuffer=s,s.byteLength>=o.data.byteLength)n.bufferSubData(a,0,o.data);else{var h=o.static?n.STATIC_DRAW:n.DYNAMIC_DRAW;s.byteLength=o.data.byteLength,n.bufferData(a,o.data,h)}}}},e.prototype.checkCompatibility=function(t,n){var i=t.attributes,o=n.attributeData;for(var s in o)if(!i[s])throw new Error('shader and geometry incompatible, geometry missing the "'+s+'" attribute')},e.prototype.getSignature=function(t,n){var i=t.attributes,o=n.attributeData,s=["g",t.id];for(var a in i)o[a]&&s.push(a);return s.join("-")},e.prototype.initGeometryVao=function(t,n,i){i===void 0&&(i=!0),this.checkCompatibility(t,n);var o=this.gl,s=this.CONTEXT_UID,a=this.getSignature(t,n),h=t.glVertexArrayObjects[this.CONTEXT_UID],u=h[a];if(u)return h[n.id]=u,u;var c=t.buffers,d=t.attributes,f={},m={};for(var g in c)f[g]=0,m[g]=0;for(var g in d)!d[g].size&&n.attributeData[g]?d[g].size=n.attributeData[g].size:d[g].size||console.warn("PIXI Geometry attribute '"+g+"' size cannot be determined (likely the bound shader does not have the attribute)"),f[d[g].buffer]+=d[g].size*Hv[d[g].type];for(var g in d){var v=d[g],x=v.size;v.stride===void 0&&(f[v.buffer]===x*Hv[v.type]?v.stride=0:v.stride=f[v.buffer]),v.start===void 0&&(v.start=m[v.buffer],m[v.buffer]+=x*Hv[v.type])}u=o.createVertexArray(),o.bindVertexArray(u);for(var T=0;T<c.length;T++){var M=c[T];M._glBuffers[s]||(M._glBuffers[s]=new vS(o.createBuffer()),this.managedBuffers[M.id]=M,M.disposeRunner.add(this)),i&&M._glBuffers[s].refCount++}return this.activateVao(t,n),this._activeVao=u,h[n.id]=u,h[a]=u,u},e.prototype.disposeBuffer=function(t,n){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],o=this.gl;t.disposeRunner.remove(this),i&&(n||o.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,n){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],o=this.gl,s=t.buffers;if(t.disposeRunner.remove(this),i){for(var a=0;a<s.length;a++){var h=s[a]._glBuffers[this.CONTEXT_UID];h.refCount--,h.refCount!==0||n||this.disposeBuffer(s[a],n)}if(!n){for(var u in i)if(u[0]==="g"){var c=i[u];this._activeVao===c&&this.unbind(),o.deleteVertexArray(c)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var n=Object.keys(this.managedGeometries),i=0;i<n.length;i++)this.disposeGeometry(this.managedGeometries[n[i]],t);for(n=Object.keys(this.managedBuffers),i=0;i<n.length;i++)this.disposeBuffer(this.managedBuffers[n[i]],t)},e.prototype.activateVao=function(t,n){var i=this.gl,o=this.CONTEXT_UID,s=t.buffers,a=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[o].buffer);var h=null;for(var u in a){var c=a[u],d=s[c.buffer]._glBuffers[o];if(n.attributeData[u]){h!==d&&(i.bindBuffer(i.ARRAY_BUFFER,d.buffer),h=d);var f=n.attributeData[u].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,c.size,c.type||i.FLOAT,c.normalized,c.stride,c.start),c.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(f,1)}}}},e.prototype.draw=function(t,n,i,o){var s=this.gl,a=this._activeGeometry;if(a.indexBuffer){var h=a.indexBuffer.data.BYTES_PER_ELEMENT,u=h===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;h===2||h===4&&this.canUseUInt32ElementIndex?a.instanced?s.drawElementsInstanced(t,n||a.indexBuffer.data.length,u,(i||0)*h,o||1):s.drawElements(t,n||a.indexBuffer.data.length,u,(i||0)*h):console.warn("unsupported index buffer type: uint32")}else a.instanced?s.drawArraysInstanced(t,i,n||a.getSize(),o||1):s.drawArrays(t,i,n||a.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(Tr),hx=function(){function r(e){e===void 0&&(e=null),this.type=xr.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return r.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=xr.NONE,this.autoDetect=!0),this._target=null},r.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},r}();function ux(r,e,t){var n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n}function lx(r,e,t,n){var i=ux(r,r.VERTEX_SHADER,e),o=ux(r,r.FRAGMENT_SHADER,t),s=r.createProgram();if(r.attachShader(s,i),r.attachShader(s,o),n)for(var a in n)r.bindAttribLocation(s,n[a],a);return r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS)||(r.getShaderParameter(i,r.COMPILE_STATUS)||(console.warn(e),console.error(r.getShaderInfoLog(i))),r.getShaderParameter(o,r.COMPILE_STATUS)||(console.warn(t),console.error(r.getShaderInfoLog(o))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",r.getProgramParameter(s,r.VALIDATE_STATUS)),console.error("gl.getError()",r.getError()),r.getProgramInfoLog(s)!==""&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(s)),r.deleteProgram(s),s=null),r.deleteShader(i),r.deleteShader(o),s}function Vv(r){for(var e=new Array(r),t=0;t<e.length;t++)e[t]=!1;return e}function cx(r,e){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Vv(2*e);case"bvec3":return Vv(3*e);case"bvec4":return Vv(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var nm,dx={},xd=dx;function px(){if(xd===dx||xd&&xd.isContextLost()){var r=document.createElement("canvas"),e=void 0;Et.PREFER_ENV>=ns.WEBGL2&&(e=r.getContext("webgl2",{})),e||((e=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),xd=e}return xd}function fx(r,e,t){if(r.substring(0,9)!=="precision"){var n=e;return e===Ao.HIGH&&t!==Ao.HIGH&&(n=Ao.MEDIUM),"precision "+n+` float;
`+r}return t!==Ao.HIGH&&r.substring(0,15)==="precision highp"?r.replace("precision highp","precision mediump"):r}var _S={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function yS(r){return _S[r]}var im=null,mx={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function gx(r,e){if(!im){var t=Object.keys(mx);im={};for(var n=0;n<t.length;++n){var i=t[n];im[r[i]]=mx[i]}}return im[e]}var rm=[{test:function(r){return r.type==="float"&&r.size===1},code:function(r){return`
            if(uv["`+r+'"] !== ud["'+r+`"].value)
            {
                ud["`+r+'"].value = uv["'+r+`"]
                gl.uniform1f(ud["`+r+'"].location, uv["'+r+`"])
            }
            `}},{test:function(r){return(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray},code:function(r){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+r+`"], t);

            if(ud["`+r+`"].value !== t)
            {
                ud["`+r+`"].value = t;
                gl.uniform1i(ud["`+r+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(r,e){return r.type==="mat3"&&r.size===1&&e.a!==void 0},code:function(r){return`
            gl.uniformMatrix3fv(ud["`+r+'"].location, false, uv["'+r+`"].toArray(true));
            `}},{test:function(r,e){return r.type==="vec2"&&r.size===1&&e.x!==void 0},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+r+`"].location, v.x, v.y);
                }`}},{test:function(r){return r.type==="vec2"&&r.size===1},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+r+`"].location, v[0], v[1]);
                }
            `}},{test:function(r,e){return r.type==="vec4"&&r.size===1&&e.width!==void 0},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+r+`"].location, v.x, v.y, v.width, v.height)
                }`}},{test:function(r){return r.type==="vec4"&&r.size===1},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+r+`"].location, v[0], v[1], v[2], v[3])
                }`}}],xS={float:`
    if(cv !== v)
    {
        cv.v = v;
        gl.uniform1f(location, v)
    }`,vec2:`
    if(cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",uint:"gl.uniform1ui(location, v)",uvec2:"gl.uniform2ui(location, v[0], v[1])",uvec3:"gl.uniform3ui(location, v[0], v[1], v[2])",uvec4:"gl.uniform4ui(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},bS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},bd,wS=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function TS(r){for(var e="",t=0;t<r;++t)t>0&&(e+=`
else `),t<r-1&&(e+="if(test == "+t+".0){}");return e}function vx(r,e){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var t=e.createShader(e.FRAGMENT_SHADER);;){var n=wS.replace(/%forloop%/gi,TS(r));if(e.shaderSource(t,n),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS))break;r=r/2|0}return r}var SS=0,om={},wd=function(){function r(e,t,n){n===void 0&&(n="pixi-shader"),this.id=SS++,this.vertexSrc=e||r.defaultVertexSrc,this.fragmentSrc=t||r.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(n=n.replace(/\s+/g,"-"),om[n]?(om[n]++,n+="-"+om[n]):om[n]=1,this.vertexSrc="#define SHADER_NAME "+n+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+n+`
`+this.fragmentSrc,this.vertexSrc=fx(this.vertexSrc,Et.PRECISION_VERTEX,Ao.HIGH),this.fragmentSrc=fx(this.fragmentSrc,Et.PRECISION_FRAGMENT,function(){if(!nm){nm=Ao.MEDIUM;var i=px();if(i&&i.getShaderPrecisionFormat){var o=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);nm=o.precision?Ao.HIGH:Ao.MEDIUM}}return nm}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return r.prototype.extractData=function(e,t){var n=px();if(n){var i=lx(n,e,t);this.attributeData=this.getAttributeData(i,n),this.uniformData=this.getUniformData(i,n),n.deleteProgram(i)}else this.uniformData={},this.attributeData={}},r.prototype.getAttributeData=function(e,t){for(var n={},i=[],o=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),s=0;s<o;s++){var a=t.getActiveAttrib(e,s),h=gx(t,a.type),u={type:h,name:a.name,size:yS(h),location:0};n[a.name]=u,i.push(u)}for(i.sort(function(c,d){return c.name>d.name?1:-1}),s=0;s<i.length;s++)i[s].location=s;return n},r.prototype.getUniformData=function(e,t){for(var n={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),o=0;o<i;o++){var s=t.getActiveUniform(e,o),a=s.name.replace(/\[.*?\]$/,""),h=s.name.match(/\[.*?\]$/),u=gx(t,s.type);n[a]={type:u,size:s.size,isArray:h,value:cx(u,s.size)}}return n},Object.defineProperty(r,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`},enumerable:!1,configurable:!0}),r.from=function(e,t,n){var i=e+t,o=yv[i];return o||(yv[i]=o=new r(e,t,n)),o},r}(),$s=function(){function r(e,t){for(var n in this.program=e,this.uniformGroup=t?t instanceof ka?t:new ka(t):new ka({}),e.uniformData)this.uniformGroup.uniforms[n]instanceof Array&&(this.uniformGroup.uniforms[n]=new Float32Array(this.uniformGroup.uniforms[n]))}return r.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var n in t.uniforms){var i=t.uniforms[n];if(i.group&&this.checkUniformExists(e,i))return!0}return!1},r.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(r.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),r.from=function(e,t,n){return new r(wd.from(e,t),n)},r}(),Ga=function(){function r(){this.data=0,this.blendMode=Dt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(r.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(e){!!(1&this.data)!==e&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(e){!!(2&this.data)!==e&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(e){!!(4&this.data)!==e&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(e){!!(8&this.data)!==e&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(e){!!(32&this.data)!==e&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(e){!!(16&this.data)!==e&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==Dt.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),r.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},r.for2d=function(){var e=new r;return e.depthTest=!1,e.blend=!0,e},r}(),Sr=function(r){function e(t,n,i){var o=this,s=wd.from(t||e.defaultVertexSrc,n||e.defaultFragmentSrc);return(o=r.call(this,s,i)||this).padding=0,o.resolution=Et.FILTER_RESOLUTION,o.enabled=!0,o.autoFit=!0,o.legacy=!!o.program.attributeData.aTextureCoord,o.state=new Ga,o}return Qt(e,r),e.prototype.apply=function(t,n,i,o,s){t.applyFilter(this,n,i,o)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`},enumerable:!1,configurable:!0}),e}($s),_x=new li,sm=function(){function r(e,t){this._texture=e,this.mapCoord=new li,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=t===void 0?.5:t,this.isSimple=!1}return Object.defineProperty(r.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),r.prototype.multiplyUvs=function(e,t){t===void 0&&(t=e);for(var n=this.mapCoord,i=0;i<e.length;i+=2){var o=e[i],s=e[i+1];t[i]=o*n.a+s*n.c+n.tx,t[i+1]=o*n.b+s*n.d+n.ty}return t},r.prototype.update=function(e){var t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var n=t._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var i=t.orig,o=t.trim;o&&(_x.set(i.width/o.width,0,0,i.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(_x));var s=t.baseTexture,a=this.uClampFrame,h=this.clampMargin/s.resolution,u=this.clampOffset;return a[0]=(t._frame.x+h+u)/s.width,a[1]=(t._frame.y+h+u)/s.height,a[2]=(t._frame.x+t._frame.width-h+u)/s.width,a[3]=(t._frame.y+t._frame.height-h+u)/s.height,this.uClampOffset[0]=u/s.realWidth,this.uClampOffset[1]=u/s.realHeight,this.isSimple=t._frame.width===s.width&&t._frame.height===s.height&&t.rotate===0,!0},r}(),yx=function(r){function e(t){var n=this,i=new li;return n=r.call(this,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`)||this,t.renderable=!1,n.maskSprite=t,n.maskMatrix=i,n}return Qt(e,r),e.prototype.apply=function(t,n,i,o){var s=this.maskSprite,a=s._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new sm(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,s).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,n,i,o))},e}(Sr),jv=function(r){function e(t){var n=r.call(this,t)||this;return n.enableScissor=!0,n.alphaMaskPool=[],n.maskDataPool=[],n.maskStack=[],n.alphaMaskIndex=0,n}return Qt(e,r),e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,n){var i=n;if(!i.isMaskData){var o=this.maskDataPool.pop()||new hx;o.pooled=!0,o.maskObject=n,i=o}switch(i.autoDetect&&this.detect(i),i.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),i._target=t,i.type){case xr.SCISSOR:this.maskStack.push(i),this.renderer.scissor.push(i);break;case xr.STENCIL:this.maskStack.push(i),this.renderer.stencil.push(i);break;case xr.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i),this.maskStack.push(i)}},e.prototype.pop=function(t){var n=this.maskStack.pop();if(n&&n._target===t){switch(n.type){case xr.SCISSOR:this.renderer.scissor.pop();break;case xr.STENCIL:this.renderer.stencil.pop(n.maskObject);break;case xr.SPRITE:this.popSpriteMask()}n.reset(),n.pooled&&this.maskDataPool.push(n)}},e.prototype.detect=function(t){var n=t.maskObject;if(n.isSprite)t.type=xr.SPRITE;else if(t.type=xr.STENCIL,this.enableScissor&&n.isFastRect&&n.isFastRect()){var i=n.worldTransform,o=Math.atan2(i.b,i.a),s=Math.atan2(i.d,i.c);o=Math.round(o*(180/Math.PI)*100),s=((s=Math.round(s*(180/Math.PI)*100)-o)%18e3+18e3)%18e3,(o=(o%9e3+9e3)%9e3)==0&&s===9e3&&(t.type=xr.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var n=t.maskObject,i=t._target,o=this.alphaMaskPool[this.alphaMaskIndex];o||(o=this.alphaMaskPool[this.alphaMaskIndex]=[new yx(n)]),o[0].resolution=this.renderer.resolution,o[0].maskSprite=n;var s=i.filterArea;i.filterArea=n.getBounds(!0),this.renderer.filter.push(i,o),i.filterArea=s,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(Tr),xx=function(r){function e(t){var n=r.call(this,t)||this;return n.maskStack=[],n.glConst=0,n}return Qt(e,r),e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var n=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var o=this.getStackLength();o!==i&&(o===0?n.disable(this.glConst):(n.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.maskStack=null},e}(Tr),Wv=function(r){function e(t){var n=r.call(this,t)||this;return n.glConst=WebGLRenderingContext.SCISSOR_TEST,n}return Qt(e,r),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var n=t.maskObject;n.renderable=!0;var i=t._scissorRect,o=n.getBounds(!0),s=this.renderer.gl;n.renderable=!1,i?o.fit(i):s.enable(s.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=o,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,n=this.renderer.renderTexture.current,i=this.renderer.projection,o=i.transform,s=i.sourceFrame,a=i.destinationFrame,h=n?n.resolution:this.renderer.resolution,u=a.width/s.width,c=a.height/s.height,d=((t.x-s.x)*u+a.x)*h,f=((t.y-s.y)*c+a.y)*h,m=t.width*u*h,g=t.height*c*h;o&&(d+=o.tx*h,f+=o.ty*h),n||(f=this.renderer.height-g-f),this.renderer.gl.scissor(d,f,m,g)},e}(xx),Xv=function(r){function e(t){var n=r.call(this,t)||this;return n.glConst=WebGLRenderingContext.STENCIL_TEST,n}return Qt(e,r),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var n=t.maskObject,i=this.renderer.gl,o=t._stencilCounter;o===0&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,o,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),n.renderable=!0,n.render(this.renderer),this.renderer.batch.flush(),this.renderer.framebuffer.blit(),n.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var n=this.renderer.gl;this.getStackLength()===0?(n.disable(n.STENCIL_TEST),n.clear(n.STENCIL_BUFFER_BIT),n.clearStencil(0)):(n.colorMask(!1,!1,!1,!1),n.stencilOp(n.KEEP,n.KEEP,n.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(xx),Yv=function(r){function e(t){var n=r.call(this,t)||this;return n.destinationFrame=null,n.sourceFrame=null,n.defaultFrame=null,n.projectionMatrix=new li,n.transform=null,n}return Qt(e,r),e.prototype.update=function(t,n,i,o){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=n||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,o),this.transform&&this.projectionMatrix.append(this.transform);var s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,n,i,o){var s=this.projectionMatrix,a=o?-1:1;s.identity(),s.a=1/n.width*2,s.d=a*(1/n.height*2),s.tx=-1-n.x*s.a,s.ty=-a-n.y*s.d},e.prototype.setTransform=function(t){},e}(Tr),iu=new en,Td=new en,qv=function(r){function e(t){var n=r.call(this,t)||this;return n.clearColor=t._backgroundColorRgba,n.defaultMaskStack=[],n.current=null,n.sourceFrame=new en,n.destinationFrame=new en,n.viewportFrame=new en,n}return Qt(e,r),e.prototype.bind=function(t,n,i){t===void 0&&(t=null);var o,s,a,h=this.renderer;this.current=t,t?(a=(o=t.baseTexture).resolution,n||(iu.width=t.frame.width,iu.height=t.frame.height,n=iu),i||(Td.x=t.frame.x,Td.y=t.frame.y,Td.width=n.width,Td.height=n.height,i=Td),s=o.framebuffer):(a=h.resolution,n||(iu.width=h.screen.width,iu.height=h.screen.height,n=iu),i||((i=iu).width=n.width,i.height=n.height));var u=this.viewportFrame;u.x=i.x*a,u.y=i.y*a,u.width=i.width*a,u.height=i.height*a,t||(u.y=h.view.height-(u.y+u.height)),this.renderer.framebuffer.bind(s,u),this.renderer.projection.update(i,n,a,!s),t?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(n),this.destinationFrame.copyFrom(i)},e.prototype.clear=function(t,n){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor;var i=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer.screen,s=i.width!==o.width||i.height!==o.height;if(s){var a=this.viewportFrame,h=a.x,u=a.y,c=a.width,d=a.height;this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,u,c,d)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],n),s&&this.renderer.scissor.pop()},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(Tr),ES=function(){},bx=function(){function r(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}}return r.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},r}(),MS=0,wx={textureCount:0},Zv=function(r){function e(t){var n=r.call(this,t)||this;return n.destroyed=!1,n.systemCheck(),n.gl=null,n.shader=null,n.program=null,n.cache={},n.id=MS++,n}return Qt(e,r),e.prototype.systemCheck=function(){if(!function(){if(typeof bd=="boolean")return bd;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");bd=t({a:"b"},"a","b")===!0}catch{bd=!1}return bd}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,n){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,o=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(o.program)),n||(wx.textureCount=0,this.syncUniformGroup(t.uniformGroup,wx)),o},e.prototype.setUniforms=function(t){var n=this.shader.program,i=n.glPrograms[this.renderer.CONTEXT_UID];n.syncUniforms(i.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,n){var i=this.getglProgram();t.static&&t.dirtyId===i.uniformGroups[t.id]||(i.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,n))},e.prototype.syncUniforms=function(t,n,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(n.uniformData,t.uniforms,this.renderer,i)},e.prototype.createSyncGroups=function(t){var n=this.getSignature(t,this.shader.program.uniformData);return this.cache[n]||(this.cache[n]=function(i,o){var s=[`
        var v = null;
        var cv = null
        var t = 0;
        var gl = renderer.gl
    `];for(var a in i.uniforms){var h=o[a];if(h){for(var u=i.uniforms[a],c=!1,d=0;d<rm.length;d++)if(rm[d].test(h,u)){s.push(rm[d].code(a,u)),c=!0;break}if(!c){var f=(h.size===1?xS:bS)[h.type].replace("location",'ud["'+a+'"].location');s.push(`
            cv = ud["`+a+`"].value;
            v = uv["`+a+`"];
            `+f+";")}}else i.uniforms[a].group&&s.push(`
                    renderer.shader.syncUniformGroup(uv["`+a+`"], syncData);
                `)}return new Function("ud","uv","renderer","syncData",s.join(`
`))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[n],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,n){var i=t.uniforms,o=[];for(var s in i)o.push(s),n[s]&&o.push(n[s].type);return o.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var n=this.gl,i=t.program,o={};for(var s in i.attributeData)o[s]=i.attributeData[s].location;var a=lx(n,i.vertexSrc,i.fragmentSrc,o),h={};for(var s in i.uniformData){var u=i.uniformData[s];h[s]={location:n.getUniformLocation(a,s),value:cx(u.type,u.size)}}var c=new bx(a,h);return i.glPrograms[this.renderer.CONTEXT_UID]=c,c},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(Tr),$v=function(r){function e(t){var n=r.call(this,t)||this;return n.gl=null,n.stateId=0,n.polygonOffset=0,n.blendMode=Dt.NONE,n._blendEq=!1,n.map=[],n.map[0]=n.setBlend,n.map[1]=n.setOffset,n.map[2]=n.setCullFace,n.map[3]=n.setDepthTest,n.map[4]=n.setFrontFace,n.map[5]=n.setDepthMask,n.checks=[],n.defaultState=new Ga,n.defaultState.blend=!0,n}return Qt(e,r),e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(n,i){return i===void 0&&(i=[]),i[Dt.NORMAL]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.ADD]=[n.ONE,n.ONE],i[Dt.MULTIPLY]=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.SCREEN]=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.OVERLAY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.DARKEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.LIGHTEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.COLOR_DODGE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.COLOR_BURN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.HARD_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.SOFT_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.DIFFERENCE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.EXCLUSION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.HUE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.SATURATION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.COLOR]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.LUMINOSITY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.NONE]=[0,0],i[Dt.NORMAL_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.ADD_NPM]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],i[Dt.SCREEN_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],i[Dt.SRC_IN]=[n.DST_ALPHA,n.ZERO],i[Dt.SRC_OUT]=[n.ONE_MINUS_DST_ALPHA,n.ZERO],i[Dt.SRC_ATOP]=[n.DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],i[Dt.DST_OVER]=[n.ONE_MINUS_DST_ALPHA,n.ONE],i[Dt.DST_IN]=[n.ZERO,n.SRC_ALPHA],i[Dt.DST_OUT]=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],i[Dt.DST_ATOP]=[n.ONE_MINUS_DST_ALPHA,n.SRC_ALPHA],i[Dt.XOR]=[n.ONE_MINUS_DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],i[Dt.SUBTRACT]=[n.ONE,n.ONE,n.ONE,n.ONE,n.FUNC_REVERSE_SUBTRACT,n.FUNC_ADD],i}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var n=this.stateId^t.data,i=0;n;)1&n&&this.map[i].call(this,!!(t.data&1<<i)),n>>=1,i++;this.stateId=t.data}for(i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var n=0;n<this.map.length;n++)this.map[n].call(this,!!(t.data&1<<n));for(n=0;n<this.checks.length;n++)this.checks[n](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setDepthMask=function(t){this.gl.depthMask(t)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var n=this.blendModes[t],i=this.gl;n.length===2?i.blendFunc(n[0],n[1]):i.blendFuncSeparate(n[0],n[1],n[2],n[3]),n.length===6?(this._blendEq=!0,i.blendEquationSeparate(n[4],n[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,n){this.gl.polygonOffset(t,n)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,n){var i=this.checks.indexOf(t);n&&i===-1?this.checks.push(t):n||i===-1||this.checks.splice(i,1)},e.checkBlendMode=function(t,n){t.setBlendMode(n.blendMode)},e.checkPolygonOffset=function(t,n){t.setPolygonOffset(1,n.polygonOffset)},e}(Tr),Jv=function(r){function e(t){var n=r.call(this,t)||this;return n.count=0,n.checkCount=0,n.maxIdle=Et.GC_MAX_IDLE,n.checkCountMax=Et.GC_MAX_CHECK_COUNT,n.mode=Et.GC_MODE,n}return Qt(e,r),e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==zf.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,n=t.managedTextures,i=!1,o=0;o<n.length;o++){var s=n[o];!s.framebuffer&&this.count-s.touched>this.maxIdle&&(t.destroyTexture(s,!0),n[o]=null,i=!0)}if(i){var a=0;for(o=0;o<n.length;o++)n[o]!==null&&(n[a++]=n[o]);n.length=a}},e.prototype.unload=function(t){var n=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&n.destroyTexture(i);for(var o=t.children.length-1;o>=0;o--)this.unload(t.children[o])},e}(Tr),am=function(r){this.texture=r,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121,this.samplerType=0},Kv=function(r){function e(t){var n=r.call(this,t)||this;return n.boundTextures=[],n.currentLocation=-1,n.managedTextures=[],n._unknownBoundTextures=!1,n.unknownTexture=new mn,n.hasIntegerTextures=!1,n}return Qt(e,r),e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var n=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=n;for(var i=0;i<n;i++)this.boundTextures[i]=null;this.emptyTextures={};var o=new am(t.createTexture());for(t.bindTexture(t.TEXTURE_2D,o.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=o,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new am(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture),i=0;i<6;i++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);for(t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR),i=0;i<this.boundTextures.length;i++)this.bind(null,i)},e.prototype.bind=function(t,n){n===void 0&&(n=0);var i=this.gl;if(t){if((t=t.castToBaseTexture()).parentTextureArray)return;if(t.valid){t.touched=this.renderer.textureGC.count;var o=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[n]!==t&&(this.currentLocation!==n&&(this.currentLocation=n,i.activeTexture(i.TEXTURE0+n)),i.bindTexture(t.target,o.texture)),o.dirtyId!==t.dirtyId&&(this.currentLocation!==n&&(this.currentLocation=n,i.activeTexture(i.TEXTURE0+n)),this.updateTexture(t)),this.boundTextures[n]=t}}else this.currentLocation!==n&&(this.currentLocation=n,i.activeTexture(i.TEXTURE0+n)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[n]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var n=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var o=0;o<i.length;o++)i[o]===this.unknownTexture&&this.bind(null,o)}for(o=0;o<i.length;o++)i[o]===t&&(this.currentLocation!==o&&(n.activeTexture(n.TEXTURE0+o),this.currentLocation=o),n.bindTexture(t.target,this.emptyTextures[t.target].texture),i[o]=null)},e.prototype.ensureSamplerType=function(t){var n=this.boundTextures,i=this.hasIntegerTextures,o=this.CONTEXT_UID;if(i)for(var s=t-1;s>=0;--s){var a=n[s];a&&a._glTextures[o].samplerType!==dd.FLOAT&&this.renderer.texture.unbind(a)}},e.prototype.initTexture=function(t){var n=new am(this.gl.createTexture());return n.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=n,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),n},e.prototype.initTextureType=function(t,n){if(n.internalFormat=t.format,n.type=t.type,this.webGLVersion===2){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(n.internalFormat=i.RGBA32F),t.type===yn.HALF_FLOAT&&(n.type=i.HALF_FLOAT),n.type===i.HALF_FLOAT&&t.format===i.RGBA&&(n.internalFormat=i.RGBA16F)}},e.prototype.updateTexture=function(t){var n=t._glTextures[this.CONTEXT_UID];if(n){var i=this.renderer;if(this.initTextureType(t,n),t.resource&&t.resource.upload(i,t,n))n.samplerType!==dd.FLOAT&&(this.hasIntegerTextures=!0);else{var o=t.realWidth,s=t.realHeight,a=i.gl;(n.width!==o||n.height!==s||n.dirtyId<0)&&(n.width=o,n.height=s,a.texImage2D(t.target,0,n.internalFormat,o,s,0,t.format,n.type,null))}t.dirtyStyleId!==n.dirtyStyleId&&this.updateTextureStyle(t),n.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,n){var i=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!n)){var o=this.managedTextures.indexOf(t);o!==-1&&Xh(this.managedTextures,o,1)}},e.prototype.updateTextureStyle=function(t){var n=t._glTextures[this.CONTEXT_UID];n&&(t.mipmap!==qs.POW2&&this.webGLVersion===2||t.isPowerOfTwo?n.mipmap=t.mipmap>=1:n.mipmap=!1,this.webGLVersion===2||t.isPowerOfTwo?n.wrapMode=t.wrapMode:n.wrapMode=rs.CLAMP,t.resource&&t.resource.style(this.renderer,t,n)||this.setStyle(t,n),n.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,n){var i=this.gl;if(n.mipmap&&t.mipmap!==qs.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,n.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,n.wrapMode),n.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===is.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var o=this.renderer.context.extensions.anisotropicFiltering;if(o&&t.anisotropicLevel>0&&t.scaleMode===is.LINEAR){var s=Math.min(t.anisotropicLevel,i.getParameter(o.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,o.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===is.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===is.LINEAR?i.LINEAR:i.NEAREST)},e}(Tr),Tx={__proto__:null,FilterSystem:Bv,BatchSystem:Uv,ContextSystem:kv,FramebufferSystem:Gv,GeometrySystem:zv,MaskSystem:jv,ScissorSystem:Wv,StencilSystem:Xv,ProjectionSystem:Yv,RenderTextureSystem:qv,ShaderSystem:Zv,StateSystem:$v,TextureGCSystem:Jv,TextureSystem:Kv},Qv=new li,Sx=function(r){function e(t,n){t===void 0&&(t=Cl.UNKNOWN);var i=r.call(this)||this;return n=Object.assign({},Et.RENDER_OPTIONS,n),i.options=n,i.type=t,i.screen=new en(0,0,n.width,n.height),i.view=n.view||document.createElement("canvas"),i.resolution=n.resolution||Et.RESOLUTION,i.useContextAlpha=n.useContextAlpha,i.autoDensity=!!n.autoDensity,i.preserveDrawingBuffer=n.preserveDrawingBuffer,i.clearBeforeRender=n.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=n.backgroundColor||i._backgroundColor,i.backgroundAlpha=n.backgroundAlpha,n.transparent!==void 0&&(Zh("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=n.transparent,i.backgroundAlpha=n.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i}return Qt(e,r),e.prototype.initPlugins=function(t){for(var n in t)this.plugins[n]=new t[n](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,n){this.screen.width=t,this.screen.height=n,this.view.width=t*this.resolution,this.view.height=n*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=n+"px"),this.emit("resize",t,n)},e.prototype.generateTexture=function(t,n,i,o){(o=o||t.getLocalBounds(null,!0)).width===0&&(o.width=1),o.height===0&&(o.height=1);var s=to.create({width:0|o.width,height:0|o.height,scaleMode:n,resolution:i});return Qv.tx=-o.x,Qv.ty=-o.y,this.render(t,{renderTexture:s,clear:!1,transform:Qv,skipUpdateTransform:!!t.parent}),s},e.prototype.destroy=function(t){for(var n in this.plugins)this.plugins[n].destroy(),this.plugins[n]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=Cl.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=dv(t),Wh(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),e}(Il.a),Js=function(r){function e(t){var n=r.call(this,Cl.WEBGL,t)||this;return t=n.options,n.gl=null,n.CONTEXT_UID=0,n.runners={destroy:new Ui("destroy"),contextChange:new Ui("contextChange"),reset:new Ui("reset"),update:new Ui("update"),postrender:new Ui("postrender"),prerender:new Ui("prerender"),resize:new Ui("resize")},n.globalUniforms=new ka({projectionMatrix:new li},!0),n.addSystem(jv,"mask").addSystem(kv,"context").addSystem($v,"state").addSystem(Zv,"shader").addSystem(Kv,"texture").addSystem(zv,"geometry").addSystem(Gv,"framebuffer").addSystem(Wv,"scissor").addSystem(Xv,"stencil").addSystem(Yv,"projection").addSystem(Jv,"textureGC").addSystem(Bv,"filter").addSystem(qv,"renderTexture").addSystem(Uv,"batch"),n.initPlugins(e.__plugins),t.context?n.context.initFromContext(t.context):n.context.initFromOptions({alpha:!!n.useContextAlpha,antialias:t.antialias,premultipliedAlpha:n.useContextAlpha&&n.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:n.options.powerPreference}),n.renderingToScreen=!0,Cy(n.context.webGLVersion===2?"WebGL 2":"WebGL 1"),n.resize(n.options.width,n.options.height),n}return Qt(e,r),e.create=function(t){if(Iy())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.addSystem=function(t,n){n||(n=t.name);var i=new t(this);if(this[n])throw new Error('Whoops! The name "'+n+'" is already in use');for(var o in this[n]=i,this.runners)this.runners[o].add(i);return this},e.prototype.render=function(t,n){var i,o,s,a;if(n&&(n instanceof to?(Zh("6.0.0","Renderer#render arguments changed, use options instead."),i=n,o=arguments[2],s=arguments[3],a=arguments[4]):(i=n.renderTexture,o=n.clear,s=n.transform,a=n.skipUpdateTransform)),this.renderingToScreen=!i,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=s,!this.context.isLost){if(i||(this._lastObjectRendered=t),!a){var h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}this.renderTexture.bind(i),this.batch.currentRenderer.start(),(o!==void 0?o:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),i&&i.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.resize=function(t,n){r.prototype.resize.call(this,t,n),this.runners.resize.emit(t,n)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(t){for(var n in this.runners.destroy.emit(),this.runners)this.runners[n].destroy();r.prototype.destroy.call(this,t),this.gl=null},Object.defineProperty(e.prototype,"extract",{get:function(){return Zh("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,n){e.__plugins=e.__plugins||{},e.__plugins[t]=n},e}(Sx);function Ex(r){return Js.create(r)}var Mx=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,e0=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,hm=function(){this.texArray=null,this.blend=0,this.type=Qr.TRIANGLES,this.start=0,this.size=0,this.data=null},um=function(){function r(){this.elements=[],this.ids=[],this.count=0}return r.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},r}(),lm=function(){function r(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(r.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),r.prototype.view=function(e){return this[e+"View"]},r.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},r.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},r}(),Ax=function(r){function e(t){var n=r.call(this,t)||this;return n.shaderGenerator=null,n.geometryClass=null,n.vertexSize=null,n.state=Ga.for2d(),n.size=4*Et.SPRITE_BATCH_SIZE,n._vertexCount=0,n._indexCount=0,n._bufferedElements=[],n._bufferedTextures=[],n._bufferSize=0,n._shader=null,n._packedGeometries=[],n._packedGeometryPoolSize=2,n._flushId=0,n._aBuffers={},n._iBuffers={},n.MAX_TEXTURES=1,n.renderer.on("prerender",n.onPrerender,n),t.runners.contextChange.add(n),n._dcIndex=0,n._aIndex=0,n._iIndex=0,n._attributeBuffer=null,n._indexBuffer=null,n._tempBoundTextures=[],n}return Qt(e,r),e.prototype.contextChange=function(){var t=this.renderer.gl;Et.PREFER_ENV===ns.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Et.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=vx(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var n=0;n<this._packedGeometryPoolSize;n++)this._packedGeometries[n]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,n=e._textureArrayPool,i=this.size/4,o=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new hm);for(;n.length<o;)n.push(new um);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,n=this.MAX_TEXTURES,i=e._textureArrayPool,o=this.renderer.batch,s=this._tempBoundTextures,a=this.renderer.textureGC.count,h=++mn._globalBatch,u=0,c=i[0],d=0;o.copyBoundTextures(s,n);for(var f=0;f<this._bufferSize;++f){var m=t[f];t[f]=null,m._batchEnabled!==h&&(c.count>=n&&(o.boundArray(c,s,h,n),this.buildDrawCalls(c,d,f),d=f,c=i[++u],++h),m._batchEnabled=h,m.touched=a,c.elements[c.count++]=m)}for(c.count>0&&(o.boundArray(c,s,h,n),this.buildDrawCalls(c,d,this._bufferSize),++u,++h),f=0;f<s.length;f++)s[f]=null;mn._globalBatch=h},e.prototype.buildDrawCalls=function(t,n,i){var o=this._bufferedElements,s=this._attributeBuffer,a=this._indexBuffer,h=this.vertexSize,u=e._drawCallPool,c=this._dcIndex,d=this._aIndex,f=this._iIndex,m=u[c];m.start=this._iIndex,m.texArray=t;for(var g=n;g<i;++g){var v=o[g],x=v._texture.baseTexture,T=fv[x.alphaMode?1:0][v.blendMode];o[g]=null,n<g&&m.blend!==T&&(m.size=f-m.start,n=g,(m=u[++c]).texArray=t,m.start=f),this.packInterleavedGeometry(v,s,a,d,f),d+=v.vertexData.length/2*h,f+=v.indices.length,m.blend=T}n<i&&(m.size=f-m.start,++c),this._dcIndex=c,this._aIndex=d,this._iIndex=f},e.prototype.bindAndClearTexArray=function(t){for(var n=this.renderer.texture,i=0;i<t.count;i++)n.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,n=this._attributeBuffer,i=this._indexBuffer;Et.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(n.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(n.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,n=this.renderer,i=n.gl,o=n.state,s=e._drawCallPool,a=null,h=0;h<t;h++){var u=s[h],c=u.texArray,d=u.type,f=u.size,m=u.start,g=u.blend;a!==c&&(a=c,this.bindAndClearTexArray(c)),this.state.blendMode=g,o.set(this.state),i.drawElements(d,f,i.UNSIGNED_SHORT,2*m)}},e.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),Et.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),r.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var n=pd(Math.ceil(t/8)),i=_v(n),o=8*n;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var s=this._aBuffers[o];return s||(this._aBuffers[o]=s=new lm(o*this.vertexSize*4)),s},e.prototype.getIndexBuffer=function(t){var n=pd(Math.ceil(t/12)),i=_v(n),o=12*n;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);var s=this._iBuffers[i];return s||(this._iBuffers[i]=s=new Uint16Array(o)),s},e.prototype.packInterleavedGeometry=function(t,n,i,o,s){for(var a=n.uint32View,h=n.float32View,u=o/this.vertexSize,c=t.uvs,d=t.indices,f=t.vertexData,m=t._texture.baseTexture._batchLocation,g=Math.min(t.worldAlpha,1),v=g<1&&t._texture.baseTexture.alphaMode?Vf(t._tintRGB,g):t._tintRGB+(255*g<<24),x=0;x<f.length;x+=2)h[o++]=f[x],h[o++]=f[x+1],h[o++]=c[x],h[o++]=c[x+1],a[o++]=v,h[o++]=m;for(x=0;x<d.length;x++)i[s++]=u+d[x]},e._drawCallPool=[],e._textureArrayPool=[],e}(yd),Px=function(){function r(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return r.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),n=0;n<e;n++)t[n]=n;this.defaultGroupCache[e]=ka.from({uSamplers:t},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+e)).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new wd(this.vertexSrc,i)}var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new li,default:this.defaultGroupCache[e]};return new $s(this.programCache[e],o)},r.prototype.generateSampleSrc=function(e){var t="";t+=`
`,t+=`
`;for(var n=0;n<e;n++)n>0&&(t+=`
else `),n<e-1&&(t+="if(vTextureId < "+n+".5)"),t+=`
{`,t+=`
	color = texture2D(uSamplers[`+n+"], vTextureCoord);",t+=`
}`;return t+=`
`,t+=`
`},r}(),t0=function(r){function e(t){t===void 0&&(t=!1);var n=r.call(this)||this;return n._buffer=new Ii(null,t,!1),n._indexBuffer=new Ii(null,t,!0),n.addAttribute("aVertexPosition",n._buffer,2,!1,yn.FLOAT).addAttribute("aTextureCoord",n._buffer,2,!1,yn.FLOAT).addAttribute("aColor",n._buffer,4,!0,yn.UNSIGNED_BYTE).addAttribute("aTextureId",n._buffer,1,!0,yn.FLOAT).addIndex(n._indexBuffer),n}return Qt(e,r),e}(nu),Rx=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,Cx=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Ix=function(){function r(){}return r.create=function(e){var t=Object.assign({vertex:Rx,fragment:Cx,geometryClass:t0,vertexSize:6},e),n=t.vertex,i=t.fragment,o=t.vertexSize,s=t.geometryClass;return function(a){function h(u){var c=a.call(this,u)||this;return c.shaderGenerator=new Px(n,i),c.geometryClass=s,c.vertexSize=o,c}return Qt(h,a),h}(Ax)},Object.defineProperty(r,"defaultVertexSrc",{get:function(){return Rx},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultFragmentTemplate",{get:function(){return Cx},enumerable:!1,configurable:!0}),r}(),Lx=Ix.create(),Ox={},AS=function(r){Object.defineProperty(Ox,r,{get:function(){return Zh("6.0.0","PIXI.systems."+r+" has moved to PIXI."+r),Qy[r]}})};for(var n0 in Qy)AS(n0);var Dx={},PS=function(r){Object.defineProperty(Dx,r,{get:function(){return Zh("6.0.0","PIXI.resources."+r+" has moved to PIXI."+r),Tx[r]}})};for(var n0 in Tx)PS(n0);/*!
 * @pixi/app - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Sd=function(){function r(e){var t=this;this.stage=new Ti,e=Object.assign({forceCanvas:!1},e),this.renderer=Ex(e),r._plugins.forEach(function(n){n.init.call(t,e)})}return r.registerPlugin=function(e){r._plugins.push(e)},r.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(r.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),r.prototype.destroy=function(e,t){var n=this,i=r._plugins.slice(0);i.reverse(),i.forEach(function(o){o.destroy.call(n)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null},r._plugins=[],r}(),RS=function(){function r(){}return r.init=function(e){var t=this;Object.defineProperty(this,"resizeTo",{set:function(n){self.removeEventListener("resize",this.queueResize),this._resizeTo=n,n&&(self.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){t._resizeTo&&(t.cancelResize(),t._resizeId=requestAnimationFrame(function(){return t.resize()}))},this.cancelResize=function(){t._resizeId&&(cancelAnimationFrame(t._resizeId),t._resizeId=null)},this.resize=function(){if(t._resizeTo){var n,i;if(t.cancelResize(),t._resizeTo===self)n=self.innerWidth,i=self.innerHeight;else{var o=t._resizeTo;n=o.clientWidth,i=o.clientHeight}t.renderer.resize(n,i)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null},r.destroy=function(){self.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},r}();Sd.registerPlugin(RS);/*!
 * @pixi/extract - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Nx=new en,Fx=function(){function r(e){this.renderer=e}return r.prototype.image=function(e,t,n){var i=new Image;return i.src=this.base64(e,t,n),i},r.prototype.base64=function(e,t,n){return this.canvas(e).toDataURL(t,n)},r.prototype.canvas=function(e){var t,n,i,o=this.renderer,s=!1,a=!1;e&&(e instanceof to?i=e:(i=this.renderer.generateTexture(e),a=!0)),i?(t=i.baseTexture.resolution,n=i.frame,s=!1,o.renderTexture.bind(i)):(t=this.renderer.resolution,s=!0,(n=Nx).width=this.renderer.width,n.height=this.renderer.height,o.renderTexture.bind(null));var h=Math.floor(n.width*t+1e-4),u=Math.floor(n.height*t+1e-4),c=new xv(h,u,1),d=new Uint8Array(4*h*u),f=o.gl;f.readPixels(n.x*t,n.y*t,h,u,f.RGBA,f.UNSIGNED_BYTE,d);var m=c.context.getImageData(0,0,h,u);if(r.arrayPostDivide(d,m.data),c.context.putImageData(m,0,0),s){var g=new xv(c.width,c.height,1);g.context.scale(1,-1),g.context.drawImage(c.canvas,0,-u),c.destroy(),c=g}return a&&i.destroy(!0),c.canvas},r.prototype.pixels=function(e){var t,n,i,o=this.renderer,s=!1;e&&(e instanceof to?i=e:(i=this.renderer.generateTexture(e),s=!0)),i?(t=i.baseTexture.resolution,n=i.frame,o.renderTexture.bind(i)):(t=o.resolution,(n=Nx).width=o.width,n.height=o.height,o.renderTexture.bind(null));var a=n.width*t,h=n.height*t,u=new Uint8Array(4*a*h),c=o.gl;return c.readPixels(n.x*t,n.y*t,a,h,c.RGBA,c.UNSIGNED_BYTE,u),s&&i.destroy(!0),r.arrayPostDivide(u,u),u},r.prototype.destroy=function(){this.renderer=null},r.arrayPostDivide=function(e,t){for(var n=0;n<e.length;n+=4){var i=t[n+3]=e[n+3];i!==0?(t[n]=Math.round(Math.min(255*e[n]/i,255)),t[n+1]=Math.round(Math.min(255*e[n+1]/i,255)),t[n+2]=Math.round(Math.min(255*e[n+2]/i,255))):(t[n]=e[n],t[n+1]=e[n+1],t[n+2]=e[n+2])}},r}(),CS=_(6),Bx=_.n(CS),IS=_(2),Ks=_.n(IS);/*!
 * resource-loader - v3.0.1
 * https://github.com/pixijs/pixi-sound
 * Compiled Tue, 02 Jul 2019 14:06:18 UTC
 *
 * resource-loader is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */function ru(){}function Ux(r,e,t,n){var i=0,o=r.length;(function s(a){a||i===o?t&&t(a):n?setTimeout(function(){e(r[i++],s)},1):e(r[i++],s)})()}function LS(r){return function(){if(r===null)throw new Error("Callback was already called.");var e=r;r=null,e.apply(this,arguments)}}function OS(r,e){if(e==null)e=1;else if(e===0)throw new Error("Concurrency must not be zero");var t=0,n={_tasks:[],concurrency:e,saturated:ru,unsaturated:ru,buffer:e/4,empty:ru,drain:ru,error:ru,started:!1,paused:!1,push:function(s,a){i(s,!1,a)},kill:function(){t=0,n.drain=ru,n.started=!1,n._tasks=[]},unshift:function(s,a){i(s,!0,a)},process:function(){for(;!n.paused&&t<n.concurrency&&n._tasks.length;){var s=n._tasks.shift();n._tasks.length===0&&n.empty(),(t+=1)===n.concurrency&&n.saturated(),r(s.data,LS(o(s)))}},length:function(){return n._tasks.length},running:function(){return t},idle:function(){return n._tasks.length+t===0},pause:function(){n.paused!==!0&&(n.paused=!0)},resume:function(){if(n.paused!==!1){n.paused=!1;for(var s=1;s<=n.concurrency;s++)n.process()}}};function i(s,a,h){if(h!=null&&typeof h!="function")throw new Error("task callback must be a function");if(n.started=!0,s==null&&n.idle())setTimeout(function(){return n.drain()},1);else{var u={data:s,callback:typeof h=="function"?h:ru};a?n._tasks.unshift(u):n._tasks.push(u),setTimeout(function(){return n.process()},1)}}function o(s){return function(){t-=1,s.callback.apply(s,arguments),arguments[0]!=null&&n.error(arguments[0],s.data),t<=n.concurrency-n.buffer&&n.unsaturated(),n.idle()&&n.drain(),n.process()}}return n}var i0={};function kx(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Gx(r,e,t){return e&&kx(r.prototype,e),t&&kx(r,t),r}var DS=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),cm=null;function NS(){}var Lt=function(){function r(t,n,i){if(typeof t!="string"||typeof n!="string")throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(r.STATUS_FLAGS.DATA_URL,n.indexOf("data:")===0),this.name=t,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=i.crossOrigin===!0?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=r.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=NS,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Ks.a,this.onProgress=new Ks.a,this.onComplete=new Ks.a,this.onAfterMiddleware=new Ks.a}r.setExtensionLoadType=function(t,n){Hx(r._loadTypeMap,t,n)},r.setExtensionXhrType=function(t,n){Hx(r._xhrTypeMap,t,n)};var e=r.prototype;return e.complete=function(){this._clearEvents(),this._finish()},e.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=r.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},e.load=function(t){var n=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout(function(){return t(n)},1);else switch(t&&this.onComplete.once(t),this._setFlag(r.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),this.crossOrigin!==!1&&typeof this.crossOrigin=="string"||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case r.LOAD_TYPE.IMAGE:this.type=r.TYPE.IMAGE,this._loadElement("image");break;case r.LOAD_TYPE.AUDIO:this.type=r.TYPE.AUDIO,this._loadSourceElement("audio");break;case r.LOAD_TYPE.VIDEO:this.type=r.TYPE.VIDEO,this._loadSourceElement("video");break;case r.LOAD_TYPE.XHR:default:DS&&this.crossOrigin?this._loadXdr():this._loadXhr()}},e._hasFlag=function(t){return(this._flags&t)!=0},e._setFlag=function(t,n){this._flags=n?this._flags|t:this._flags&~t},e._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},e._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(r.STATUS_FLAGS.COMPLETE,!0),this._setFlag(r.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},e._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:t==="image"&&window.Image!==void 0?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},e._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:t==="audio"&&window.Audio!==void 0?this.data=new Audio:this.data=document.createElement(t),this.data!==null){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var n=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(n)?n[i]:n));else{var o=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(o)?o[0]:o))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},e._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===r.XHR_RESPONSE_TYPE.JSON||this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=r.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},e._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},e._createSource=function(t,n,i){i||(i=t+"/"+this._getExtension(n));var o=document.createElement("source");return o.src=n,o.type=i,o},e._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},e._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},e._onTimeout=function(){this.abort("Load timed out.")},e._xhrOnError=function(){var t=this.xhr;this.abort(r0(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},e._xhrOnTimeout=function(){var t=this.xhr;this.abort(r0(t)+" Request timed out.")},e._xhrOnAbort=function(){var t=this.xhr;this.abort(r0(t)+" Request was aborted by the user.")},e._xhrOnLoad=function(){var t=this.xhr,n="",i=t.status===void 0?200:t.status;if(t.responseType!==""&&t.responseType!=="text"&&t.responseType!==void 0||(n=t.responseText),i===0&&(n.length>0||t.responseType===r.XHR_RESPONSE_TYPE.BUFFER)?i=200:i===1223&&(i=204),(i/100|0)==2){if(this.xhrType===r.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=r.TYPE.TEXT;else if(this.xhrType===r.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=r.TYPE.JSON}catch(a){return void this.abort("Error trying to parse loaded json: "+a)}else if(this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var o=new DOMParser;this.data=o.parseFromString(n,"text/xml")}else{var s=document.createElement("div");s.innerHTML=n,this.data=s}this.type=r.TYPE.XML}catch(a){return void this.abort("Error trying to parse loaded xml: "+a)}else this.data=t.response||n;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},e._determineCrossOrigin=function(t,n){if(t.indexOf("data:")===0)return"";if(window.origin!==window.location.origin)return"anonymous";n=n||window.location,cm||(cm=document.createElement("a")),cm.href=t;var i=!(t=Bx()(cm.href,{strictMode:!0})).port&&n.port===""||t.port===n.port,o=t.protocol?t.protocol+":":"";return t.host===n.hostname&&i&&o===n.protocol?"":"anonymous"},e._determineXhrType=function(){return r._xhrTypeMap[this.extension]||r.XHR_RESPONSE_TYPE.TEXT},e._determineLoadType=function(){return r._loadTypeMap[this.extension]||r.LOAD_TYPE.XHR},e._getExtension=function(){var t=this.url,n="";if(this.isDataUrl){var i=t.indexOf("/");n=t.substring(i+1,t.indexOf(";",i))}else{var o=t.indexOf("?"),s=t.indexOf("#"),a=Math.min(o>-1?o:t.length,s>-1?s:t.length);n=(t=t.substring(0,a)).substring(t.lastIndexOf(".")+1)}return n.toLowerCase()},e._getMimeFromXhrType=function(t){switch(t){case r.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case r.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case r.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case r.XHR_RESPONSE_TYPE.JSON:return"application/json";case r.XHR_RESPONSE_TYPE.DEFAULT:case r.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},Gx(r,[{key:"isDataUrl",get:function(){return this._hasFlag(r.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(r.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(r.STATUS_FLAGS.LOADING)}}]),r}();function Hx(r,e,t){e&&e.indexOf(".")===0&&(e=e.substring(1)),e&&(r[e]=t)}function r0(r){return r.toString().replace("object ","")}Lt.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},Lt.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},Lt.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},Lt.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},Lt._loadTypeMap={gif:Lt.LOAD_TYPE.IMAGE,png:Lt.LOAD_TYPE.IMAGE,bmp:Lt.LOAD_TYPE.IMAGE,jpg:Lt.LOAD_TYPE.IMAGE,jpeg:Lt.LOAD_TYPE.IMAGE,tif:Lt.LOAD_TYPE.IMAGE,tiff:Lt.LOAD_TYPE.IMAGE,webp:Lt.LOAD_TYPE.IMAGE,tga:Lt.LOAD_TYPE.IMAGE,svg:Lt.LOAD_TYPE.IMAGE,"svg+xml":Lt.LOAD_TYPE.IMAGE,mp3:Lt.LOAD_TYPE.AUDIO,ogg:Lt.LOAD_TYPE.AUDIO,wav:Lt.LOAD_TYPE.AUDIO,mp4:Lt.LOAD_TYPE.VIDEO,webm:Lt.LOAD_TYPE.VIDEO},Lt._xhrTypeMap={xhtml:Lt.XHR_RESPONSE_TYPE.DOCUMENT,html:Lt.XHR_RESPONSE_TYPE.DOCUMENT,htm:Lt.XHR_RESPONSE_TYPE.DOCUMENT,xml:Lt.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Lt.XHR_RESPONSE_TYPE.DOCUMENT,svg:Lt.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Lt.XHR_RESPONSE_TYPE.DOCUMENT,gif:Lt.XHR_RESPONSE_TYPE.BLOB,png:Lt.XHR_RESPONSE_TYPE.BLOB,bmp:Lt.XHR_RESPONSE_TYPE.BLOB,jpg:Lt.XHR_RESPONSE_TYPE.BLOB,jpeg:Lt.XHR_RESPONSE_TYPE.BLOB,tif:Lt.XHR_RESPONSE_TYPE.BLOB,tiff:Lt.XHR_RESPONSE_TYPE.BLOB,webp:Lt.XHR_RESPONSE_TYPE.BLOB,tga:Lt.XHR_RESPONSE_TYPE.BLOB,json:Lt.XHR_RESPONSE_TYPE.JSON,text:Lt.XHR_RESPONSE_TYPE.TEXT,txt:Lt.XHR_RESPONSE_TYPE.TEXT,ttf:Lt.XHR_RESPONSE_TYPE.BUFFER,otf:Lt.XHR_RESPONSE_TYPE.BUFFER},Lt.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var zx=window.URL||window.webkitURL,FS={caching:function(r,e){var t=this;i0[r.url]?(r.data=i0[r.url],r.complete()):r.onComplete.once(function(){return i0[t.url]=t.data}),e()},parsing:function(r,e){if(r.data){if(r.xhr&&r.xhrType===Lt.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&typeof r.data!="string"){if(r.data.type.indexOf("image")===0){var t=zx.createObjectURL(r.data);return r.blob=r.data,r.data=new Image,r.data.src=t,r.type=Lt.TYPE.IMAGE,void(r.data.onload=function(){zx.revokeObjectURL(t),r.data.onload=null,e()})}}else{var n=r.xhr.getResponseHeader("content-type");if(n&&n.indexOf("image")===0)return r.data=new Image,r.data.src="data:"+n+";base64,"+function(i){for(var o="",s=0;s<i.length;){for(var a=[0,0,0],h=[0,0,0,0],u=0;u<a.length;++u)s<i.length?a[u]=255&i.charCodeAt(s++):a[u]=0;switch(h[0]=a[0]>>2,h[1]=(3&a[0])<<4|a[1]>>4,h[2]=(15&a[1])<<2|a[2]>>6,h[3]=63&a[2],s-(i.length-1)){case 2:h[3]=64,h[2]=64;break;case 1:h[3]=64}for(var c=0;c<h.length;++c)o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h[c])}return o}(r.xhr.responseText),r.type=Lt.TYPE.IMAGE,void(r.data.onload=function(){r.data.onload=null,e()})}e()}else e()}},BS=/(#[\w-]+)?$/,Qs=function(){function r(t,n){var i=this;t===void 0&&(t=""),n===void 0&&(n=10),this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(a,h){return i._loadResource(a,h)},this._queue=OS(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new Ks.a,this.onError=new Ks.a,this.onLoad=new Ks.a,this.onStart=new Ks.a,this.onComplete=new Ks.a;for(var o=0;o<r._defaultBeforeMiddleware.length;++o)this.pre(r._defaultBeforeMiddleware[o]);for(var s=0;s<r._defaultAfterMiddleware.length;++s)this.use(r._defaultAfterMiddleware[s])}var e=r.prototype;return e.add=function(t,n,i,o){if(Array.isArray(t)){for(var s=0;s<t.length;++s)this.add(t[s]);return this}if(typeof t=="object"&&(o=n||t.callback||t.onComplete,i=t,n=t.url,t=t.name||t.key||t.url),typeof n!="string"&&(o=i,i=n,n=t),typeof n!="string")throw new Error("No url passed to add resource to loader.");if(typeof i=="function"&&(o=i,i=null),this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(n=this._prepareUrl(n),this.resources[t]=new Lt(t,n,i),typeof o=="function"&&this.resources[t].onAfterMiddleware.once(o),this.loading){for(var a=i.parentResource,h=[],u=0;u<a.children.length;++u)a.children[u].isComplete||h.push(a.children[u]);var c=a.progressChunk*(h.length+1)/(h.length+2);a.children.push(this.resources[t]),a.progressChunk=c;for(var d=0;d<h.length;++d)h[d].progressChunk=c;this.resources[t].progressChunk=c}return this._queue.push(this.resources[t]),this},e.pre=function(t){return this._beforeMiddleware.push(t),this},e.use=function(t){return this._afterMiddleware.push(t),this},e.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var n=this.resources[t];n._onLoadBinding&&n._onLoadBinding.detach(),n.isLoading&&n.abort()}return this.resources={},this},e.load=function(t){if(typeof t=="function"&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var n=100/this._queue._tasks.length,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=n;this._onStart(),this._queue.resume()}return this},e._prepareUrl=function(t){var n,i=Bx()(t,{strictMode:!0});if(n=i.protocol||!i.path||t.indexOf("//")===0?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&t.charAt(0)!=="/"?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var o=BS.exec(n)[0];(n=n.substr(0,n.length-o.length)).indexOf("?")!==-1?n+="&"+this.defaultQueryString:n+="?"+this.defaultQueryString,n+=o}return n},e._loadResource=function(t,n){var i=this;t._dequeue=n,Ux(this._beforeMiddleware,function(o,s){o.call(i,t,function(){s(t.isComplete?{}:null)})},function(){t.isComplete?i._onLoad(t):(t._onLoadBinding=t.onComplete.once(i._onLoad,i),t.load())},!0)},e._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},e._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},e._onLoad=function(t){var n=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),Ux(this._afterMiddleware,function(i,o){i.call(n,t,o)},function(){t.onAfterMiddleware.dispatch(t),n.progress=Math.min(100,n.progress+t.progressChunk),n.onProgress.dispatch(n,t),t.error?n.onError.dispatch(t.error,n,t):n.onLoad.dispatch(n,t),n._resourcesParsing.splice(n._resourcesParsing.indexOf(t),1),n._queue.idle()&&n._resourcesParsing.length===0&&n._onComplete()},!0)},Gx(r,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),r}();Qs._defaultBeforeMiddleware=[],Qs._defaultAfterMiddleware=[],Qs.pre=function(r){return Qs._defaultBeforeMiddleware.push(r),Qs},Qs.use=function(r){return Qs._defaultAfterMiddleware.push(r),Qs};/*!
 * @pixi/loaders - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Vx=function(r,e){return(Vx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},jx=function(){function r(){}return r.add=function(){Lt.setExtensionLoadType("svg",Lt.LOAD_TYPE.XHR),Lt.setExtensionXhrType("svg",Lt.XHR_RESPONSE_TYPE.TEXT)},r.use=function(e,t){if(!e.data||e.type!==Lt.TYPE.IMAGE&&e.extension!=="svg")t();else{var n=e.data,i=e.url,o=e.name,s=e.metadata;Ot.fromLoader(n,i,o,s).then(function(a){e.texture=a,t()}).catch(t)}},r}(),as=function(r){function e(t,n){for(var i=r.call(this,t,n)||this,o=0;o<e._plugins.length;++o){var s=e._plugins[o],a=s.pre,h=s.use;a&&i.pre(a),h&&i.use(h)}return i._protected=!1,i}return function(t,n){function i(){this.constructor=t}Vx(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),e.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(e,"shared",{get:function(){var t=e._shared;return t||((t=new e)._protected=!0,e._shared=t),t},enumerable:!1,configurable:!0}),e.registerPlugin=function(t){return e._plugins.push(t),t.add&&t.add(),e},e._plugins=[],e}(Qs);as.registerPlugin({use:FS.parsing}),as.registerPlugin(jx);var Mn,qt,Wx=function(){function r(){}return r.init=function(e){e=Object.assign({sharedLoader:!1},e),this.loader=e.sharedLoader?as.shared:new as},r.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},r}(),no=Lt;(function(r){r[r.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",r[r.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",r[r.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",r[r.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",r[r.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",r[r.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",r[r.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",r[r.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",r[r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",r[r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",r[r.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",r[r.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"})(qt||(qt={}));var Ed=((Mn={})[qt.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,Mn[qt.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,Mn[qt.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,Mn[qt.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,Mn[qt.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,Mn[qt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,Mn[qt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,Mn[qt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,Mn[qt.COMPRESSED_R11_EAC]=.5,Mn[qt.COMPRESSED_SIGNED_R11_EAC]=.5,Mn[qt.COMPRESSED_RG11_EAC]=1,Mn[qt.COMPRESSED_SIGNED_RG11_EAC]=1,Mn[qt.COMPRESSED_RGB8_ETC2]=.5,Mn[qt.COMPRESSED_RGBA8_ETC2_EAC]=1,Mn[qt.COMPRESSED_SRGB8_ETC2]=.5,Mn[qt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,Mn[qt.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Mn[qt.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Mn[qt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,Mn[qt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,Mn[qt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,Mn[qt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,Mn[qt.COMPRESSED_RGB_ETC1_WEBGL]=.5,Mn[qt.COMPRESSED_RGB_ATC_WEBGL]=.5,Mn[qt.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,Mn[qt.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,Mn),Xx=function(r,e){return(Xx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Yx(r,e){function t(){this.constructor=r}Xx(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function US(r,e){var t,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(u){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||c[0]!==6&&c[0]!==2)){s=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){s.label=c[1];break}if(c[0]===6&&s.label<i[1]){s.label=i[1],i=c;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(c);break}i[2]&&s.ops.pop(),s.trys.pop();continue}c=e.call(r,s)}catch(d){c=[6,d],n=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([h,u])}}}var dm,hs,qx=function(r){function e(t,n){n===void 0&&(n={width:1,height:1,autoLoad:!0});var i,o,s=this;return typeof t=="string"?(i=t,o=new Uint8Array):(i=null,o=t),(s=r.call(this,o,n)||this).origin=i,s.buffer=o?new lm(o):null,s.origin&&n.autoLoad!==!1&&s.load(),o&&o.length&&(s.loaded=!0,s.onBlobLoaded(s.buffer.rawBinaryData)),s}return Yx(e,r),e.prototype.onBlobLoaded=function(t){},e.prototype.load=function(){return t=this,n=void 0,o=function(){var s;return US(this,function(a){switch(a.label){case 0:return[4,fetch(this.origin)];case 1:return[4,a.sent().blob()];case 2:return[4,a.sent().arrayBuffer()];case 3:return s=a.sent(),this.data=new Uint32Array(s),this.buffer=new lm(s),this.loaded=!0,this.onBlobLoaded(s),this.update(),[2,this]}})},new((i=Promise)||(i=Promise))(function(s,a){function h(d){try{c(o.next(d))}catch(f){a(f)}}function u(d){try{c(o.throw(d))}catch(f){a(f)}}function c(d){d.done?s(d.value):new i(function(f){f(d.value)}).then(h,u)}c((o=o.apply(t,n||[])).next())});var t,n,i,o},e}(Ll),pm=function(r){function e(t,n){var i=r.call(this,t,n)||this;return i.format=n.format,i.levels=n.levels||1,i._width=n.width,i._height=n.height,i._extension=e._formatToExtension(i.format),(n.levelBuffers||i.buffer)&&(i._levelBuffers=n.levelBuffers||e._createLevelBuffers(t instanceof Uint8Array?t:i.buffer.uint8View,i.format,i.levels,4,4,i.width,i.height)),i}return Yx(e,r),e.prototype.upload=function(t,n,i){var o=t.gl;if(!t.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var s=0,a=this.levels;s<a;s++){var h=this._levelBuffers[s],u=h.levelID,c=h.levelWidth,d=h.levelHeight,f=h.levelBuffer;o.compressedTexImage2D(o.TEXTURE_2D,u,this.format,c,d,0,f)}return!0},e.prototype.onBlobLoaded=function(){this._levelBuffers=e._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},e._formatToExtension=function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},e._createLevelBuffers=function(t,n,i,o,s,a,h){for(var u=new Array(i),c=t.byteOffset,d=a,f=h,m=d+o-1&~(o-1),g=f+s-1&~(s-1),v=m*g*Ed[n],x=0;x<i;x++)u[x]={levelID:x,levelWidth:i>1?d:m,levelHeight:i>1?f:g,levelBuffer:new Uint8Array(t.buffer,c,v)},c+=v,v=(m=(d=d>>1||1)+o-1&~(o-1))*(g=(f=f>>1||1)+s-1&~(s-1))*Ed[n];return u},e}(qx),Zx=function(){function r(){}return r.use=function(e,t){var n=e.data;if(e.type===no.TYPE.JSON&&n&&n.cacheID&&n.textures){for(var i=n.textures,o=void 0,s=void 0,a=0,h=i.length;a<h;a++){var u=i[a],c=u.src,d=u.format;if(d||(s=c),r.textureFormats[d]){o=c;break}}if(!(o=o||s))return void t(new Error("Cannot load compressed-textures in "+e.url+", make sure you provide a fallback"));if(o===e.url)return void t(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var f={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},m=jh.resolve(e.url.replace(this.baseUrl,""),o),g=n.cacheID;this.add(g,m,f,function(v){if(v.error)t(v.error);else{var x=v.texture,T=x===void 0?null:x,M=v.textures,C=M===void 0?{}:M;Object.assign(e,{texture:T,textures:C}),t()}})}else t()},r.add=function(){var e=document.createElement("canvas").getContext("webgl");if(e){var t={s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};for(var n in r.textureExtensions=t,r.textureFormats={},t){var i=t[n];i&&Object.assign(r.textureFormats,Object.getPrototypeOf(i))}}else console.error("WebGL not available for compressed textures. Silently failing.")},r}();function $x(r,e,t){var n={textures:{},texture:null};return e&&e.map(function(i){return new Ot(new mn(i,Object.assign({mipmap:qs.OFF,alphaMode:os.NO_PREMULTIPLIED_ALPHA},t)))}).forEach(function(i,o){var s=i.baseTexture,a=r+"-"+(o+1);mn.addToCache(s,a),Ot.addToCache(i,a),o===0&&(mn.addToCache(s,r),Ot.addToCache(i,r),n.texture=i),n.textures[a]=i}),n}no.setExtensionXhrType("dds",no.XHR_RESPONSE_TYPE.BUFFER);var Po,o0,kS=3,GS=4,HS=7,zS=19,VS=2,jS=0,WS=1,XS=2,YS=3;(function(r){r[r.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",r[r.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",r[r.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",r[r.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",r[r.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",r[r.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",r[r.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",r[r.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",r[r.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",r[r.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",r[r.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",r[r.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",r[r.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",r[r.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",r[r.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",r[r.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",r[r.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",r[r.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",r[r.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",r[r.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",r[r.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",r[r.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",r[r.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",r[r.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",r[r.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",r[r.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",r[r.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",r[r.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",r[r.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",r[r.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",r[r.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",r[r.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",r[r.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",r[r.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",r[r.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",r[r.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",r[r.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",r[r.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",r[r.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",r[r.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",r[r.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",r[r.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",r[r.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",r[r.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",r[r.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",r[r.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",r[r.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",r[r.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",r[r.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",r[r.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",r[r.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",r[r.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",r[r.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",r[r.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",r[r.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",r[r.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",r[r.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",r[r.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",r[r.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",r[r.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",r[r.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",r[r.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",r[r.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",r[r.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",r[r.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",r[r.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",r[r.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",r[r.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",r[r.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",r[r.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",r[r.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",r[r.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",r[r.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",r[r.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",r[r.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",r[r.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",r[r.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",r[r.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",r[r.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",r[r.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",r[r.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",r[r.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",r[r.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",r[r.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",r[r.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",r[r.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",r[r.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",r[r.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",r[r.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",r[r.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",r[r.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",r[r.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",r[r.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",r[r.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",r[r.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",r[r.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",r[r.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",r[r.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",r[r.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",r[r.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",r[r.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",r[r.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",r[r.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",r[r.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",r[r.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",r[r.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",r[r.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",r[r.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",r[r.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",r[r.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",r[r.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",r[r.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",r[r.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",r[r.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",r[r.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",r[r.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",r[r.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",r[r.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",r[r.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",r[r.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",r[r.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",r[r.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"})(Po||(Po={})),function(r){r[r.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",r[r.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",r[r.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(o0||(o0={}));var Md,Ol,fm,qS=((dm={})[827611204]=qt.COMPRESSED_RGBA_S3TC_DXT1_EXT,dm[861165636]=qt.COMPRESSED_RGBA_S3TC_DXT3_EXT,dm[894720068]=qt.COMPRESSED_RGBA_S3TC_DXT5_EXT,dm),ZS=((hs={})[Po.DXGI_FORMAT_BC1_TYPELESS]=qt.COMPRESSED_RGBA_S3TC_DXT1_EXT,hs[Po.DXGI_FORMAT_BC1_UNORM]=qt.COMPRESSED_RGBA_S3TC_DXT1_EXT,hs[Po.DXGI_FORMAT_BC2_TYPELESS]=qt.COMPRESSED_RGBA_S3TC_DXT3_EXT,hs[Po.DXGI_FORMAT_BC2_UNORM]=qt.COMPRESSED_RGBA_S3TC_DXT3_EXT,hs[Po.DXGI_FORMAT_BC3_TYPELESS]=qt.COMPRESSED_RGBA_S3TC_DXT5_EXT,hs[Po.DXGI_FORMAT_BC3_UNORM]=qt.COMPRESSED_RGBA_S3TC_DXT5_EXT,hs[Po.DXGI_FORMAT_BC1_UNORM_SRGB]=qt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,hs[Po.DXGI_FORMAT_BC2_UNORM_SRGB]=qt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,hs[Po.DXGI_FORMAT_BC3_UNORM_SRGB]=qt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,hs),Jx=function(){function r(){}return r.use=function(e,t){if(e.extension==="dds"&&e.data)try{Object.assign(e,$x(e.name||e.url,r.parse(e.data),e.metadata))}catch(n){return void t(n)}t()},r.parse=function(e){var t=new Uint32Array(e);if(t[0]!==542327876)throw new Error("Invalid DDS file magic word");var n=new Uint32Array(e,0,124/Uint32Array.BYTES_PER_ELEMENT),i=n[kS],o=n[GS],s=n[HS],a=new Uint32Array(e,zS*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),h=a[1];if(4&h){var u=a[VS];if(u!==808540228){var c=qS[u],d=new Uint8Array(e,128);return[new pm(d,{format:c,width:o,height:i,levels:s})]}var f=new Uint32Array(t.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),m=f[jS],g=f[WS],v=f[XS],x=f[YS],T=ZS[m];if(T===void 0)throw new Error("DDSLoader cannot parse texture data with DXGI format "+m);if(v===4)throw new Error("DDSLoader does not support cubemap textures");if(g===o0.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var M=new Array;if(x===1)M.push(new Uint8Array(e,148));else{for(var C=Ed[T],D=0,R=o,F=i,O=0;O<s;O++)D+=Math.max(1,R+3&-4)*Math.max(1,F+3&-4)*C,R>>>=1,F>>>=1;var U=148;for(O=0;O<x;O++)M.push(new Uint8Array(e,U,D)),U+=D}return M.map(function(he){return new pm(he,{format:T,width:o,height:i,levels:s})})}throw 64&h?new Error("DDSLoader does not support uncompressed texture data."):512&h?new Error("DDSLoader does not supported YUV uncompressed texture data."):131072&h?new Error("DDSLoader does not support single-channel (lumninance) texture data!"):2&h?new Error("DDSLoader does not support single-channel (alpha) texture data!"):new Error("DDSLoader failed to load a texture file due to an unknown reason!")},r}();no.setExtensionXhrType("ktx",no.XHR_RESPONSE_TYPE.BUFFER);var Kx=[171,75,84,88,32,49,49,187,13,10,26,10],$S=12,JS=16,KS=24,QS=28,eE=36,tE=40,nE=44,iE=48,rE=52,oE=56,sE=60,s0=((Md={})[yn.UNSIGNED_BYTE]=1,Md[yn.UNSIGNED_SHORT]=2,Md[yn.FLOAT]=4,Md[yn.HALF_FLOAT]=8,Md),Qx=((Ol={})[Mo.RGBA]=4,Ol[Mo.RGB]=3,Ol[Mo.LUMINANCE]=1,Ol[Mo.LUMINANCE_ALPHA]=2,Ol[Mo.ALPHA]=1,Ol),e1=((fm={})[yn.UNSIGNED_SHORT_4_4_4_4]=2,fm[yn.UNSIGNED_SHORT_5_5_5_1]=2,fm[yn.UNSIGNED_SHORT_5_6_5]=2,fm),t1=function(){function r(){}return r.use=function(e,t){if(e.extension==="ktx"&&e.data)try{var n=e.name||e.url;Object.assign(e,$x(n,r.parse(n,e.data),e.metadata))}catch(i){return void t(i)}t()},r.parse=function(e,t){var n=new DataView(t);if(!r.validate(e,n))return null;var i=n.getUint32($S,!0)===67305985,o=n.getUint32(JS,i),s=n.getUint32(KS,i),a=n.getUint32(QS,i),h=n.getUint32(eE,i),u=n.getUint32(tE,i)||1,c=n.getUint32(nE,i)||1,d=n.getUint32(iE,i)||1,f=n.getUint32(rE,i),m=n.getUint32(oE,i),g=n.getUint32(sE,i);if(u===0||c!==1)throw new Error("Only 2D textures are supported");if(f!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(d!==1)throw new Error("WebGL does not support array textures");var v,x=h+3&-4,T=u+3&-4,M=new Array(d),C=h*u;if(o===0&&(C=x*T),(v=o!==0?s0[o]?s0[o]*Qx[s]:e1[o]:Ed[a])===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var D=C*v,R=h,F=u,O=x,U=T,he=64+g,Q=0;Q<m;Q++){for(var X=n.getUint32(he,i),Z=he+4,q=0;q<d;q++){var oe=M[q];oe||(oe=M[q]=new Array(m)),oe[Q]={levelID:Q,levelWidth:m>1?R:O,levelHeight:m>1?F:U,levelBuffer:new Uint8Array(t,Z,D)},Z+=D}he=(he+=X+4)%4!=0?he+4-he%4:he,D=(O=(R=R>>1||1)+4-1&-4)*(U=(F=F>>1||1)+4-1&-4)*v}if(o!==0)throw new Error("TODO: Uncompressed");return M.map(function(fe){return new pm(null,{format:a,width:h,height:u,levels:m,levelBuffers:fe})})},r.validate=function(e,t){for(var n=0;n<Kx.length;n++)if(t.getUint8(n)!==Kx[n])return console.error(e+" is not a valid *.ktx file!"),!1;return!0},r}(),n1=function(r,e){return(n1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)};function i1(r,e){function t(){this.constructor=r}n1(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ea,ta,aE=function(r){function e(t,n,i,o){t===void 0&&(t=1500),i===void 0&&(i=16384),o===void 0&&(o=!1);var s=r.call(this)||this;return i>16384&&(i=16384),s._properties=[!1,!0,!1,!1,!1],s._maxSize=t,s._batchSize=i,s._buffers=null,s._bufferUpdateIDs=[],s._updateID=0,s.interactiveChildren=!1,s.blendMode=Dt.NORMAL,s.autoResize=o,s.roundPixels=!0,s.baseTexture=null,s.setProperties(n),s._tint=0,s.tintRgb=new Float32Array(4),s.tint=16777215,s}return i1(e,r),e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,Wh(t,this.tintRgb)},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var n=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return n.onChildrenChange(0)})),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var n=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<n;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[n]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(t){r.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},e}(Ti),r1=function(){function r(e,t,n){this.geometry=new nu,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<e.length;++i){var o=e[i];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||yn.FLOAT,offset:o.offset},t[i]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return r.prototype.initBuffers=function(){var e=this.geometry,t=0;this.indexBuffer=new Ii(Oy(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n)(a=this.dynamicProperties[n]).offset=t,t+=a.size,this.dynamicStride+=a.size;var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new Ii(this.dynamicData,!1,!1);var o=0;for(this.staticStride=0,n=0;n<this.staticProperties.length;++n)(a=this.staticProperties[n]).offset=o,o+=a.size,this.staticStride+=a.size;var s=new ArrayBuffer(this.size*this.staticStride*4*4);for(this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new Ii(this.staticData,!0,!1),n=0;n<this.dynamicProperties.length;++n){var a=this.dynamicProperties[n];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===yn.UNSIGNED_BYTE,a.type,4*this.dynamicStride,4*a.offset)}for(n=0;n<this.staticProperties.length;++n)a=this.staticProperties[n],e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===yn.UNSIGNED_BYTE,a.type,4*this.staticStride,4*a.offset)},r.prototype.uploadDynamic=function(e,t,n){for(var i=0;i<this.dynamicProperties.length;i++){var o=this.dynamicProperties[i];o.uploadFunction(e,t,n,o.type===yn.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++},r.prototype.uploadStatic=function(e,t,n){for(var i=0;i<this.staticProperties.length;i++){var o=this.staticProperties[i];o.uploadFunction(e,t,n,o.type===yn.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++},r.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},r}(),o1=function(r){function e(t){var n=r.call(this,t)||this;return n.shader=null,n.properties=null,n.tempMatrix=new li,n.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:n.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:n.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:n.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:n.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:yn.UNSIGNED_BYTE,uploadFunction:n.uploadTint,offset:0}],n.shader=$s.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,{}),n.state=Ga.for2d(),n}return i1(e,r),e.prototype.render=function(t){var n=t.children,i=t._maxSize,o=t._batchSize,s=this.renderer,a=n.length;if(a!==0){a>i&&!t.autoResize&&(a=i);var h=t._buffers;h||(h=t._buffers=this.generateBuffers(t));var u=n[0]._texture.baseTexture;this.state.blendMode=mv(t.blendMode,u.alphaMode),s.state.set(this.state);var c=s.gl,d=t.worldTransform.copyTo(this.tempMatrix);d.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=Ly(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,u.alphaMode),this.shader.uniforms.uSampler=u,this.renderer.shader.bind(this.shader);for(var f=!1,m=0,g=0;m<a;m+=o,g+=1){var v=a-m;v>o&&(v=o),g>=h.length&&h.push(this._generateOneMoreBuffer(t));var x=h[g];x.uploadDynamic(n,m,v);var T=t._bufferUpdateIDs[g]||0;(f=f||x._updateID<T)&&(x._updateID=t._updateID,x.uploadStatic(n,m,v)),s.geometry.bind(x.geometry),c.drawElements(c.TRIANGLES,6*v,c.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var n=[],i=t._maxSize,o=t._batchSize,s=t._properties,a=0;a<i;a+=o)n.push(new r1(this.properties,s,o));return n},e.prototype._generateOneMoreBuffer=function(t){var n=t._batchSize,i=t._properties;return new r1(this.properties,i,n)},e.prototype.uploadVertices=function(t,n,i,o,s,a){for(var h=0,u=0,c=0,d=0,f=0;f<i;++f){var m=t[n+f],g=m._texture,v=m.scale.x,x=m.scale.y,T=g.trim,M=g.orig;T?(h=(u=T.x-m.anchor.x*M.width)+T.width,c=(d=T.y-m.anchor.y*M.height)+T.height):(h=M.width*(1-m.anchor.x),u=M.width*-m.anchor.x,c=M.height*(1-m.anchor.y),d=M.height*-m.anchor.y),o[a]=u*v,o[a+1]=d*x,o[a+s]=h*v,o[a+s+1]=d*x,o[a+2*s]=h*v,o[a+2*s+1]=c*x,o[a+3*s]=u*v,o[a+3*s+1]=c*x,a+=4*s}},e.prototype.uploadPosition=function(t,n,i,o,s,a){for(var h=0;h<i;h++){var u=t[n+h].position;o[a]=u.x,o[a+1]=u.y,o[a+s]=u.x,o[a+s+1]=u.y,o[a+2*s]=u.x,o[a+2*s+1]=u.y,o[a+3*s]=u.x,o[a+3*s+1]=u.y,a+=4*s}},e.prototype.uploadRotation=function(t,n,i,o,s,a){for(var h=0;h<i;h++){var u=t[n+h].rotation;o[a]=u,o[a+s]=u,o[a+2*s]=u,o[a+3*s]=u,a+=4*s}},e.prototype.uploadUvs=function(t,n,i,o,s,a){for(var h=0;h<i;++h){var u=t[n+h]._texture._uvs;u?(o[a]=u.x0,o[a+1]=u.y0,o[a+s]=u.x1,o[a+s+1]=u.y1,o[a+2*s]=u.x2,o[a+2*s+1]=u.y2,o[a+3*s]=u.x3,o[a+3*s+1]=u.y3,a+=4*s):(o[a]=0,o[a+1]=0,o[a+s]=0,o[a+s+1]=0,o[a+2*s]=0,o[a+2*s+1]=0,o[a+3*s]=0,o[a+3*s+1]=0,a+=4*s)}},e.prototype.uploadTint=function(t,n,i,o,s,a){for(var h=0;h<i;++h){var u=t[n+h],c=u._texture.baseTexture.alphaMode>0,d=u.alpha,f=d<1&&c?Vf(u._tintRGB,d):u._tintRGB+(255*d<<24);o[a]=f,o[a+s]=f,o[a+2*s]=f,o[a+3*s]=f,a+=4*s}},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e}(yd);(function(r){r.MITER="miter",r.BEVEL="bevel",r.ROUND="round"})(ea||(ea={})),function(r){r.BUTT="butt",r.ROUND="round",r.SQUARE="square"}(ta||(ta={}));var Dl={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(r,e){if(e===void 0&&(e=20),!this.adaptive||!r||isNaN(r))return e;var t=Math.ceil(r/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}},a0=function(){function r(){this.color=16777215,this.alpha=1,this.texture=Ot.WHITE,this.matrix=null,this.visible=!1,this.reset()}return r.prototype.clone=function(){var e=new r;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},r.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Ot.WHITE,this.matrix=null,this.visible=!1},r.prototype.destroy=function(){this.texture=null,this.matrix=null},r}(),s1=function(r,e){return(s1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)};function h0(r,e){function t(){this.constructor=r}s1(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var u0={build:function(r){r.points=r.shape.points.slice()},triangulate:function(r,e){var t=r.points,n=r.holes,i=e.points,o=e.indices;if(t.length>=6){for(var s=[],a=0;a<n.length;a++){var h=n[a];s.push(t.length/2),t=t.concat(h.points)}var u=hv()(t,s,2);if(!u)return;var c=i.length/2;for(a=0;a<u.length;a+=3)o.push(u[a]+c),o.push(u[a+1]+c),o.push(u[a+2]+c);for(a=0;a<t.length;a++)i.push(t[a])}}},l0={build:function(r){var e,t,n=r.shape,i=r.points,o=n.x,s=n.y;if(i.length=0,r.type===ti.CIRC)e=n.radius,t=n.radius;else{var a=r.shape;e=a.width,t=a.height}if(e!==0&&t!==0){var h=Math.floor(30*Math.sqrt(n.radius))||Math.floor(15*Math.sqrt(e+t));h/=2.3;for(var u=2*Math.PI/h,c=0;c<h-.5;c++)i.push(o+Math.sin(-u*c)*e,s+Math.cos(-u*c)*t);i.push(i[0],i[1])}},triangulate:function(r,e){var t=r.points,n=e.points,i=e.indices,o=n.length/2,s=o,a=r.shape,h=r.matrix,u=a.x,c=a.y;n.push(r.matrix?h.a*u+h.c*c+h.tx:u,r.matrix?h.b*u+h.d*c+h.ty:c);for(var d=0;d<t.length;d+=2)n.push(t[d],t[d+1]),i.push(o++,s,o)}},a1={build:function(r){var e=r.shape,t=e.x,n=e.y,i=e.width,o=e.height,s=r.points;s.length=0,s.push(t,n,t+i,n,t+i,n+o,t,n+o)},triangulate:function(r,e){var t=r.points,n=e.points,i=n.length/2;n.push(t[0],t[1],t[2],t[3],t[6],t[7],t[4],t[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}};function Nl(r,e,t){return r+(e-r)*t}function mm(r,e,t,n,i,o,s){s===void 0&&(s=[]);for(var a=s,h=0,u=0,c=0,d=0,f=0,m=0,g=0,v=0;g<=20;++g)h=Nl(r,t,v=g/20),u=Nl(e,n,v),c=Nl(t,i,v),d=Nl(n,o,v),f=Nl(h,c,v),m=Nl(u,d,v),a.push(f,m);return a}var h1={build:function(r){var e=r.shape,t=r.points,n=e.x,i=e.y,o=e.width,s=e.height,a=Math.max(0,Math.min(e.radius,Math.min(o,s)/2));t.length=0,a?(mm(n,i+a,n,i,n+a,i,t),mm(n+o-a,i,n+o,i,n+o,i+a,t),mm(n+o,i+s-a,n+o,i+s,n+o-a,i+s,t),mm(n+a,i+s,n,i+s,n,i+s-a,t)):t.push(n,i,n+o,i,n+o,i+s,n,i+s)},triangulate:function(r,e){for(var t=r.points,n=e.points,i=e.indices,o=n.length/2,s=hv()(t,null,2),a=0,h=s.length;a<h;a+=3)i.push(s[a]+o),i.push(s[a+1]+o),i.push(s[a+2]+o);for(a=0,h=t.length;a<h;a++)n.push(t[a],t[++a])}};function u1(r,e,t,n,i,o,s,a){var h,u;s?(h=n,u=-t):(h=-n,u=t);var c=r-t*i+h,d=e-n*i+u,f=r+t*o+h,m=e+n*o+u;return a.push(c,d),a.push(f,m),2}function Fl(r,e,t,n,i,o,s,a){var h=t-r,u=n-e,c=Math.atan2(h,u),d=Math.atan2(i-r,o-e);a&&c<d?c+=2*Math.PI:!a&&c>d&&(d+=2*Math.PI);var f=c,m=d-c,g=Math.abs(m),v=Math.sqrt(h*h+u*u),x=1+(15*g*Math.sqrt(v)/Math.PI>>0),T=m/x;if(f+=T,a){s.push(r,e),s.push(t,n);for(var M=1,C=f;M<x;M++,C+=T)s.push(r,e),s.push(r+Math.sin(C)*v,e+Math.cos(C)*v);s.push(r,e),s.push(i,o)}else{for(s.push(t,n),s.push(r,e),M=1,C=f;M<x;M++,C+=T)s.push(r+Math.sin(C)*v,e+Math.cos(C)*v),s.push(r,e);s.push(i,o),s.push(r,e)}return 2*x}function c0(r,e){r.lineStyle.native?function(t,n){var i=0,o=t.shape,s=t.points||o.points,a=o.type!==ti.POLY||o.closeStroke;if(s.length!==0){var h=n.points,u=n.indices,c=s.length/2,d=h.length/2,f=d;for(h.push(s[0],s[1]),i=1;i<c;i++)h.push(s[2*i],s[2*i+1]),u.push(f,f+1),f++;a&&u.push(f,d)}}(r,e):function(t,n){var i=t.shape,o=t.points||i.points.slice(),s=n.closePointEps;if(o.length!==0){var a=t.lineStyle,h=new ni(o[0],o[1]),u=new ni(o[o.length-2],o[o.length-1]),c=i.type!==ti.POLY||i.closeStroke,d=Math.abs(h.x-u.x)<s&&Math.abs(h.y-u.y)<s;if(c){o=o.slice(),d&&(o.pop(),o.pop(),u.set(o[o.length-2],o[o.length-1]));var f=.5*(h.x+u.x),m=.5*(u.y+h.y);o.unshift(f,m),o.push(f,m)}var g=n.points,v=o.length/2,x=o.length,T=g.length/2,M=a.width/2,C=M*M,D=a.miterLimit*a.miterLimit,R=o[0],F=o[1],O=o[2],U=o[3],he=0,Q=0,X=-(F-U),Z=R-O,q=0,oe=0,fe=Math.sqrt(X*X+Z*Z);X/=fe,Z/=fe,X*=M,Z*=M;var me=a.alignment,le=2*(1-me),pe=2*me;c||(a.cap===ta.ROUND?x+=Fl(R-X*(le-pe)*.5,F-Z*(le-pe)*.5,R-X*le,F-Z*le,R+X*pe,F+Z*pe,g,!0)+2:a.cap===ta.SQUARE&&(x+=u1(R,F,X,Z,le,pe,!0,g))),g.push(R-X*le,F-Z*le),g.push(R+X*pe,F+Z*pe);for(var Pe=1;Pe<v-1;++Pe){R=o[2*(Pe-1)],F=o[2*(Pe-1)+1],O=o[2*Pe],U=o[2*Pe+1],he=o[2*(Pe+1)],Q=o[2*(Pe+1)+1],X=-(F-U),Z=R-O,X/=fe=Math.sqrt(X*X+Z*Z),Z/=fe,X*=M,Z*=M,q=-(U-Q),oe=O-he,q/=fe=Math.sqrt(q*q+oe*oe),oe/=fe,q*=M,oe*=M;var Ue=O-R,Fe=F-U,Y=O-he,$=Q-U,Me=Fe*Y-$*Ue,De=Me<0;if(Math.abs(Me)<.1)g.push(O-X*le,U-Z*le),g.push(O+X*pe,U+Z*pe);else{var we=(-X+R)*(-Z+U)-(-X+O)*(-Z+F),ke=(-q+he)*(-oe+U)-(-q+O)*(-oe+Q),We=(Ue*ke-Y*we)/Me,ge=($*we-Fe*ke)/Me,W=(We-O)*(We-O)+(ge-U)*(ge-U),de=O+(We-O)*le,_e=U+(ge-U)*le,ye=O-(We-O)*pe,Oe=U-(ge-U)*pe,ht=De?le:pe;W<=Math.min(Ue*Ue+Fe*Fe,Y*Y+$*$)+ht*ht*C?a.join===ea.BEVEL||W/C>D?(De?(g.push(de,_e),g.push(O+X*pe,U+Z*pe),g.push(de,_e),g.push(O+q*pe,U+oe*pe)):(g.push(O-X*le,U-Z*le),g.push(ye,Oe),g.push(O-q*le,U-oe*le),g.push(ye,Oe)),x+=2):a.join===ea.ROUND?De?(g.push(de,_e),g.push(O+X*pe,U+Z*pe),x+=Fl(O,U,O+X*pe,U+Z*pe,O+q*pe,U+oe*pe,g,!0)+4,g.push(de,_e),g.push(O+q*pe,U+oe*pe)):(g.push(O-X*le,U-Z*le),g.push(ye,Oe),x+=Fl(O,U,O-X*le,U-Z*le,O-q*le,U-oe*le,g,!1)+4,g.push(O-q*le,U-oe*le),g.push(ye,Oe)):(g.push(de,_e),g.push(ye,Oe)):(g.push(O-X*le,U-Z*le),g.push(O+X*pe,U+Z*pe),a.join===ea.BEVEL||W/C>D||(a.join===ea.ROUND?x+=De?Fl(O,U,O+X*pe,U+Z*pe,O+q*pe,U+oe*pe,g,!0)+2:Fl(O,U,O-X*le,U-Z*le,O-q*le,U-oe*le,g,!1)+2:(De?(g.push(ye,Oe),g.push(ye,Oe)):(g.push(de,_e),g.push(de,_e)),x+=2)),g.push(O-q*le,U-oe*le),g.push(O+q*pe,U+oe*pe),x+=2)}}R=o[2*(v-2)],F=o[2*(v-2)+1],O=o[2*(v-1)],X=-(F-(U=o[2*(v-1)+1])),Z=R-O,X/=fe=Math.sqrt(X*X+Z*Z),Z/=fe,X*=M,Z*=M,g.push(O-X*le,U-Z*le),g.push(O+X*pe,U+Z*pe),c||(a.cap===ta.ROUND?x+=Fl(O-X*(le-pe)*.5,U-Z*(le-pe)*.5,O-X*le,U-Z*le,O+X*pe,U+Z*pe,g,!1)+2:a.cap===ta.SQUARE&&(x+=u1(O,U,X,Z,le,pe,!1,g)));var _t=n.indices,gt=Dl.epsilon*Dl.epsilon;for(Pe=T;Pe<x+T-2;++Pe)R=g[2*Pe],F=g[2*Pe+1],O=g[2*(Pe+1)],U=g[2*(Pe+1)+1],he=g[2*(Pe+2)],Q=g[2*(Pe+2)+1],Math.abs(R*(U-Q)+O*(Q-F)+he*(F-U))<gt||_t.push(Pe,Pe+1,Pe+2)}}(r,e)}var Bl,d0=function(){function r(){}return r.curveTo=function(e,t,n,i,o,s){var a=s[s.length-2],h=s[s.length-1]-t,u=a-e,c=i-t,d=n-e,f=Math.abs(h*d-u*c);if(f<1e-8||o===0)return s[s.length-2]===e&&s[s.length-1]===t||s.push(e,t),null;var m=h*h+u*u,g=c*c+d*d,v=h*c+u*d,x=o*Math.sqrt(m)/f,T=o*Math.sqrt(g)/f,M=x*v/m,C=T*v/g,D=x*d+T*u,R=x*c+T*h,F=u*(T+M),O=h*(T+M),U=d*(x+C),he=c*(x+C);return{cx:D+e,cy:R+t,radius:o,startAngle:Math.atan2(O-R,F-D),endAngle:Math.atan2(he-R,U-D),anticlockwise:u*c>d*h}},r.arc=function(e,t,n,i,o,s,a,h,u){for(var c=a-s,d=Dl._segmentsCount(Math.abs(c)*o,40*Math.ceil(Math.abs(c)/md)),f=c/(2*d),m=2*f,g=Math.cos(f),v=Math.sin(f),x=d-1,T=x%1/x,M=0;M<=x;++M){var C=f+s+m*(M+T*M),D=Math.cos(C),R=-Math.sin(C);u.push((g*D+v*R)*o+n,(g*-R+v*D)*o+i)}},r}(),l1=function(){function r(){}return r.curveLength=function(e,t,n,i,o,s,a,h){for(var u=0,c=0,d=0,f=0,m=0,g=0,v=0,x=0,T=0,M=0,C=0,D=e,R=t,F=1;F<=10;++F)M=D-(x=(v=(g=(m=1-(c=F/10))*m)*m)*e+3*g*c*n+3*m*(d=c*c)*o+(f=d*c)*a),C=R-(T=v*t+3*g*c*i+3*m*d*s+f*h),D=x,R=T,u+=Math.sqrt(M*M+C*C);return u},r.curveTo=function(e,t,n,i,o,s,a){var h=a[a.length-2],u=a[a.length-1];a.length-=2;var c=Dl._segmentsCount(r.curveLength(h,u,e,t,n,i,o,s)),d=0,f=0,m=0,g=0,v=0;a.push(h,u);for(var x=1,T=0;x<=c;++x)m=(f=(d=1-(T=x/c))*d)*d,v=(g=T*T)*T,a.push(m*h+3*f*T*e+3*d*g*n+v*o,m*u+3*f*T*t+3*d*g*i+v*s)},r}(),c1=function(){function r(){}return r.curveLength=function(e,t,n,i,o,s){var a=e-2*n+o,h=t-2*i+s,u=2*n-2*e,c=2*i-2*t,d=4*(a*a+h*h),f=4*(a*u+h*c),m=u*u+c*c,g=2*Math.sqrt(d+f+m),v=Math.sqrt(d),x=2*d*v,T=2*Math.sqrt(m),M=f/v;return(x*g+v*f*(g-T)+(4*m*d-f*f)*Math.log((2*v+M+g)/(M+T)))/(4*x)},r.curveTo=function(e,t,n,i,o){for(var s=o[o.length-2],a=o[o.length-1],h=Dl._segmentsCount(r.curveLength(s,a,e,t,n,i)),u=0,c=0,d=1;d<=h;++d){var f=d/h;u=s+(e-s)*f,c=a+(t-a)*f,o.push(u+(e+(n-e)*f-u)*f,c+(t+(i-t)*f-c)*f)}},r}(),d1=function(){function r(){this.reset()}return r.prototype.begin=function(e,t,n){this.reset(),this.style=e,this.start=t,this.attribStart=n},r.prototype.end=function(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start},r.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},r}(),gm=((Bl={})[ti.POLY]=u0,Bl[ti.CIRC]=l0,Bl[ti.ELIP]=l0,Bl[ti.RECT]=a1,Bl[ti.RREC]=h1,Bl),p0=[],Ad=[],f0=function(){function r(e,t,n,i){t===void 0&&(t=null),n===void 0&&(n=null),i===void 0&&(i=null),this.shape=e,this.lineStyle=n,this.fillStyle=t,this.matrix=i,this.type=e.type,this.points=[],this.holes=[]}return r.prototype.clone=function(){return new r(this.shape,this.fillStyle,this.lineStyle,this.matrix)},r.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},r}(),Ul=new ni,hE=new vd,p1=function(r){function e(){var t=r.call(this)||this;return t.uvsFloat32=null,t.indicesUint16=null,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.dirty=0,t.batchDirty=-1,t.cacheDirty=-1,t.clearDirty=0,t.drawCalls=[],t.batches=[],t.shapeIndex=0,t._bounds=new vd,t.boundsDirty=-1,t.boundsPadding=0,t.batchable=!1,t.indicesUint16=null,t.uvsFloat32=null,t.closePointEps=1e-4,t}return h0(e,r),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Ad.push(this.drawCalls[t]);for(this.drawCalls.length=0,t=0;t<this.batches.length;t++){var n=this.batches[t];n.reset(),p0.push(n)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,n,i,o){n===void 0&&(n=null),i===void 0&&(i=null),o===void 0&&(o=null);var s=new f0(t,n,i,o);return this.graphicsData.push(s),this.dirty++,this},e.prototype.drawHole=function(t,n){if(n===void 0&&(n=null),!this.graphicsData.length)return null;var i=new f0(t,null,null,n),o=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=o.lineStyle,o.holes.push(i),this.dirty++,this},e.prototype.destroy=function(){r.prototype.destroy.call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var n=this.graphicsData,i=0;i<n.length;++i){var o=n[i];if(o.fillStyle.visible&&o.shape&&(o.matrix?o.matrix.applyInverse(t,Ul):Ul.copyFrom(t),o.shape.contains(Ul.x,Ul.y))){var s=!1;if(o.holes){for(var a=0;a<o.holes.length;a++)if(o.holes[a].shape.contains(Ul.x,Ul.y)){s=!0;break}}if(!s)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var n=this.uvs,i=this.graphicsData,o=null,s=null;this.batches.length>0&&(s=(o=this.batches[this.batches.length-1]).style);for(var a=this.shapeIndex;a<i.length;a++){this.shapeIndex++;var h=i[a],u=h.fillStyle,c=h.lineStyle;gm[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix);for(var d=0;d<2;d++){var f=d===0?u:c;if(f.visible){var m=f.texture.baseTexture,g=this.indices.length,v=this.points.length/2;m.wrapMode=rs.REPEAT,d===0?this.processFill(h):this.processLine(h);var x=this.points.length/2-v;x!==0&&(o&&!this._compareStyles(s,f)&&(o.end(g,v),o=null),o||((o=p0.pop()||new d1).begin(f,g,v),this.batches.push(o),s=f),this.addUvs(this.points,n,f.texture,v,x,f.matrix))}}}var T=this.indices.length,M=this.points.length/2;if(o&&o.end(T,M),this.batches.length!==0){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var C=M>65535&&t;this.indicesUint16=C?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,n){return!(!t||!n)&&t.texture.baseTexture===n.texture.baseTexture&&t.color+t.alpha===n.color+n.alpha&&!!t.native==!!n.native},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,n=this.graphicsData.length;t<n;t++){var i=this.graphicsData[t],o=i.fillStyle,s=i.lineStyle;if(o&&!o.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,n=0,i=t.length;n<i;n++)for(var o=t[n],s=0;s<o.size;s++){var a=o.start+s;this.indicesUint16[a]=this.indicesUint16[a]-o.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,n=0;n<t.length;n++)if(t[n].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++mn._globalBatch,n=0;n<this.drawCalls.length;n++)this.drawCalls[n].texArray.clear(),Ad.push(this.drawCalls[n]);this.drawCalls.length=0;var i=this.colors,o=this.textureIds,s=Ad.pop();s||((s=new hm).texArray=new um),s.texArray.count=0,s.start=0,s.size=0,s.type=Qr.TRIANGLES;var a=0,h=null,u=0,c=!1,d=Qr.TRIANGLES,f=0;for(this.drawCalls.push(s),n=0;n<this.batches.length;n++){var m=this.batches[n],g=m.style,v=g.texture.baseTexture;c!==!!g.native&&(d=(c=!!g.native)?Qr.LINES:Qr.TRIANGLES,h=null,a=8,t++),h!==v&&(h=v,v._batchEnabled!==t&&(a===8&&(t++,a=0,s.size>0&&((s=Ad.pop())||((s=new hm).texArray=new um),this.drawCalls.push(s)),s.start=f,s.size=0,s.texArray.count=0,s.type=d),v.touched=1,v._batchEnabled=t,v._batchLocation=a,v.wrapMode=rs.REPEAT,s.texArray.elements[s.texArray.count++]=v,a++)),s.size+=m.size,f+=m.size,u=v._batchLocation,this.addColors(i,g.color,g.alpha,m.attribSize),this.addTextureIds(o,u,m.attribSize)}mn._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,n=this.uvs,i=this.colors,o=this.textureIds,s=new ArrayBuffer(3*t.length*4),a=new Float32Array(s),h=new Uint32Array(s),u=0,c=0;c<t.length/2;c++)a[u++]=t[2*c],a[u++]=t[2*c+1],a[u++]=n[2*c],a[u++]=n[2*c+1],h[u++]=i[c],a[u++]=o[c];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),u0.triangulate(t,this)):gm[t.type].triangulate(t,this)},e.prototype.processLine=function(t){c0(t,this);for(var n=0;n<t.holes.length;n++)c0(t.holes[n],this)},e.prototype.processHoles=function(t){for(var n=0;n<t.length;n++){var i=t[n];gm[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,n=hE,i=li.IDENTITY;this._bounds.clear(),n.clear();for(var o=0;o<this.graphicsData.length;o++){var s=this.graphicsData[o],a=s.shape,h=s.type,u=s.lineStyle,c=s.matrix||li.IDENTITY,d=0;if(u&&u.visible){var f=u.alignment;d=u.width,h===ti.POLY?d*=.5+Math.abs(.5-f):d*=Math.max(0,f)}if(i!==c&&(n.isEmpty()||(t.addBoundsMatrix(n,i),n.clear()),i=c),h===ti.RECT||h===ti.RREC){var m=a;n.addFramePad(m.x,m.y,m.x+m.width,m.y+m.height,d,d)}else if(h===ti.CIRC){var g=a;n.addFramePad(g.x,g.y,g.x,g.y,g.radius+d,g.radius+d)}else if(h===ti.ELIP){var v=a;n.addFramePad(v.x,v.y,v.x,v.y,v.width+d,v.height+d)}else{var x=a;t.addVerticesMatrix(i,x.points,0,x.points.length,d,d)}}n.isEmpty()||t.addBoundsMatrix(n,i),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,n){for(var i=0;i<t.length/2;i++){var o=t[2*i],s=t[2*i+1];t[2*i]=n.a*o+n.c*s+n.tx,t[2*i+1]=n.b*o+n.d*s+n.ty}},e.prototype.addColors=function(t,n,i,o){for(var s=Vf((n>>16)+(65280&n)+((255&n)<<16),i);o-- >0;)t.push(s)},e.prototype.addTextureIds=function(t,n,i){for(;i-- >0;)t.push(n)},e.prototype.addUvs=function(t,n,i,o,s,a){a===void 0&&(a=null);for(var h=0,u=n.length,c=i.frame;h<s;){var d=t[2*(o+h)],f=t[2*(o+h)+1];if(a){var m=a.a*d+a.c*f+a.tx;f=a.b*d+a.d*f+a.ty,d=m}h++,n.push(d/c.width,f/c.height)}var g=i.baseTexture;(c.width<g.width||c.height<g.height)&&this.adjustUvs(n,i,u,s)},e.prototype.adjustUvs=function(t,n,i,o){for(var s=n.baseTexture,a=1e-6,h=i+2*o,u=n.frame,c=u.width/s.width,d=u.height/s.height,f=u.x/u.width,m=u.y/u.height,g=Math.floor(t[i]+a),v=Math.floor(t[i+1]+a),x=i+2;x<h;x+=2)g=Math.min(g,Math.floor(t[x]+a)),v=Math.min(v,Math.floor(t[x+1]+a));for(f-=g,m-=v,x=i;x<h;x+=2)t[x]=(t[x]+f)*c,t[x+1]=(t[x+1]+m)*d},e.BATCHABLE_SIZE=100,e}(t0),f1=function(r){function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.width=0,t.alignment=.5,t.native=!1,t.cap=ta.BUTT,t.join=ea.MITER,t.miterLimit=10,t}return h0(e,r),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){r.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(a0),uE=new Float32Array(3),m0={},na=function(r){function e(t){t===void 0&&(t=null);var n=r.call(this)||this;return n._geometry=t||new p1,n._geometry.refCount++,n.shader=null,n.state=Ga.for2d(),n._fillStyle=new a0,n._lineStyle=new f1,n._matrix=null,n._holeMode=!1,n.currentPath=null,n.batches=[],n.batchTint=-1,n.batchDirty=-1,n.vertexData=null,n.pluginName="batch",n._transformID=-1,n.tint=16777215,n.blendMode=Dt.NORMAL,n}return h0(e,r),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,n,i,o,s){return t===void 0&&(t=null),n===void 0&&(n=0),i===void 0&&(i=1),o===void 0&&(o=.5),s===void 0&&(s=!1),typeof t=="number"&&(t={width:t,color:n,alpha:i,alignment:o,native:s}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:Ot.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:ta.BUTT,join:ea.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var n=t.width>0&&t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:n},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,n=this.currentPath.points.length;n>2&&(this.drawShape(this.currentPath),this.currentPath=new gd,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[n-2],t[n-1]))}else this.currentPath=new gd,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,n){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=n,this},e.prototype.lineTo=function(t,n){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,o=i[i.length-2],s=i[i.length-1];return o===t&&s===n||i.push(t,n),this},e.prototype._initCurve=function(t,n){t===void 0&&(t=0),n===void 0&&(n=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,n]):this.moveTo(t,n)},e.prototype.quadraticCurveTo=function(t,n,i,o){this._initCurve();var s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),c1.curveTo(t,n,i,o,s),this},e.prototype.bezierCurveTo=function(t,n,i,o,s,a){return this._initCurve(),l1.curveTo(t,n,i,o,s,a,this.currentPath.points),this},e.prototype.arcTo=function(t,n,i,o,s){this._initCurve(t,n);var a=this.currentPath.points,h=d0.curveTo(t,n,i,o,s,a);if(h){var u=h.cx,c=h.cy,d=h.radius,f=h.startAngle,m=h.endAngle,g=h.anticlockwise;this.arc(u,c,d,f,m,g)}return this},e.prototype.arc=function(t,n,i,o,s,a){if(a===void 0&&(a=!1),o===s)return this;if(!a&&s<=o?s+=md:a&&o<=s&&(o+=md),s-o==0)return this;var h=t+Math.cos(o)*i,u=n+Math.sin(o)*i,c=this._geometry.closePointEps,d=this.currentPath?this.currentPath.points:null;if(d){var f=Math.abs(d[d.length-2]-h),m=Math.abs(d[d.length-1]-u);f<c&&m<c||d.push(h,u)}else this.moveTo(h,u),d=this.currentPath.points;return d0.arc(h,u,t,n,i,o,s,a,d),this},e.prototype.beginFill=function(t,n){return t===void 0&&(t=0),n===void 0&&(n=1),this.beginTextureFill({texture:Ot.WHITE,color:t,alpha:n})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:Ot.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var n=t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:n},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,n,i,o){return this.drawShape(new en(t,n,i,o))},e.prototype.drawRoundedRect=function(t,n,i,o,s){return this.drawShape(new bv(t,n,i,o,s))},e.prototype.drawCircle=function(t,n,i){return this.drawShape(new Hy(t,n,i))},e.prototype.drawEllipse=function(t,n,i,o){return this.drawShape(new zy(t,n,i,o))},e.prototype.drawPolygon=function(){for(var t,n=arguments,i=[],o=0;o<arguments.length;o++)i[o]=n[o];var s=!0,a=i[0];a.points?(s=a.closeStroke,t=a.points):t=Array.isArray(i[0])?i[0]:i;var h=new gd(t);return h.closeStroke=s,this.drawShape(h),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return!(t.length!==1||t[0].shape.type!==ti.RECT||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var n=this._geometry,i=t.context.supports.uint32Indices;n.updateBatches(i),n.batchable?(this.batchDirty!==n.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,n=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(var o=0;o<i;o++){var s=t.batches[o],a=s.style.color,h=new Float32Array(this.vertexData.buffer,4*s.attribStart*2,2*s.attribSize),u=new Float32Array(t.uvsFloat32.buffer,4*s.attribStart*2,2*s.attribSize),c={vertexData:h,blendMode:n,indices:new Uint16Array(t.indicesUint16.buffer,2*s.start,s.size),uvs:u,_batchRGB:Wh(a),_tintRGB:a,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[o]=c}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var n=0,i=this.batches.length;n<i;n++){var o=this.batches[n];o.worldAlpha=this.worldAlpha*o.alpha,t.plugins[this.pluginName].render(o)}}},e.prototype._renderDirect=function(t){var n=this._resolveDirectShader(t),i=this._geometry,o=this.tint,s=this.worldAlpha,a=n.uniforms,h=i.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(o>>16&255)/255*s,a.tint[1]=(o>>8&255)/255*s,a.tint[2]=(255&o)/255*s,a.tint[3]=s,t.shader.bind(n),t.geometry.bind(i,n),t.state.set(this.state);for(var u=0,c=h.length;u<c;u++)this._renderDrawCallDirect(t,i.drawCalls[u])},e.prototype._renderDrawCallDirect=function(t,n){for(var i=n.texArray,o=n.type,s=n.size,a=n.start,h=i.count,u=0;u<h;u++)t.texture.bind(i.elements[u],u);t.geometry.draw(o,s,a)},e.prototype._resolveDirectShader=function(t){var n=this.shader,i=this.pluginName;if(!n){if(!m0[i]){for(var o=t.plugins.batch.MAX_TEXTURES,s=new Int32Array(o),a=0;a<o;a++)s[a]=a;var h={tint:new Float32Array([1,1,1,1]),translationMatrix:new li,default:ka.from({uSamplers:s},!0)},u=t.plugins[i]._shader.program;m0[i]=new $s(u,h)}n=m0[i]}return n},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var n=t.bounds,i=n.minX,o=n.minY,s=n.maxX,a=n.maxY;this._bounds.addFrame(this.transform,i,o,s,a)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=Wh(this.tint,uE),n=0;n<this.batches.length;n++){var i=this.batches[n],o=i._batchRGB,s=(t[0]*o[0]*255<<16)+(t[1]*o[1]*255<<8)+(0|t[2]*o[2]*255);i._tintRGB=(s>>16)+(65280&s)+((255&s)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var n=this.transform.worldTransform,i=n.a,o=n.b,s=n.c,a=n.d,h=n.tx,u=n.ty,c=this._geometry.points,d=this.vertexData,f=0,m=0;m<c.length;m+=2){var g=c[m],v=c[m+1];d[f++]=i*g+s*v+h,d[f++]=a*v+o*g+u}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,r.prototype.destroy.call(this,t)},e._TEMP_POINT=new ni,e}(Ti),lE={buildPoly:u0,buildCircle:l0,buildRectangle:a1,buildRoundedRectangle:h1,buildLine:c0,ArcUtils:d0,BezierUtils:l1,QuadraticUtils:c1,BatchPart:d1,FILL_COMMANDS:gm,BATCH_POOL:p0,DRAW_CALL_POOL:Ad},m1=function(r,e){return(m1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},kl,Pd=new ni,cE=new Uint16Array([0,1,2,0,2,3]),Un=function(r){function e(t){var n=r.call(this)||this;return n._anchor=new $h(n._onAnchorUpdate,n,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=Dt.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=t||Ot.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=cE,n.pluginName="batch",n.isSprite=!0,n._roundPixels=Et.ROUND_PIXELS,n}return function(t,n){function i(){this.constructor=t}m1(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Yh(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Yh(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var n=this.transform.worldTransform,i=n.a,o=n.b,s=n.c,a=n.d,h=n.tx,u=n.ty,c=this.vertexData,d=t.trim,f=t.orig,m=this._anchor,g=0,v=0,x=0,T=0;if(d?(g=(v=d.x-m._x*f.width)+d.width,x=(T=d.y-m._y*f.height)+d.height):(g=(v=-m._x*f.width)+f.width,x=(T=-m._y*f.height)+f.height),c[0]=i*v+s*T+h,c[1]=a*T+o*v+u,c[2]=i*g+s*T+h,c[3]=a*T+o*g+u,c[4]=i*g+s*x+h,c[5]=a*x+o*g+u,c[6]=i*v+s*x+h,c[7]=a*x+o*v+u,this._roundPixels)for(var M=Et.RESOLUTION,C=0;C<c.length;++C)c[C]=Math.round((c[C]*M|0)/M)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,n=this.vertexTrimmedData,i=t.orig,o=this._anchor,s=this.transform.worldTransform,a=s.a,h=s.b,u=s.c,c=s.d,d=s.tx,f=s.ty,m=-o._x*i.width,g=m+i.width,v=-o._y*i.height,x=v+i.height;n[0]=a*m+u*v+d,n[1]=c*v+h*m+f,n[2]=a*g+u*v+d,n[3]=c*v+h*g+f,n[4]=a*g+u*x+d,n[5]=c*x+h*g+f,n[6]=a*m+u*x+d,n[7]=c*x+h*m+f},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,n=this._texture.orig;!t||t.width===n.width&&t.height===n.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(t){return this.children.length===0?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new en),t=this._localBoundsRect),this._bounds.getRectangle(t)):r.prototype.getLocalBounds.call(this,t)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Pd);var n=this._texture.orig.width,i=this._texture.orig.height,o=-n*this.anchor.x,s=0;return Pd.x>=o&&Pd.x<o+n&&(s=-i*this.anchor.y,Pd.y>=s&&Pd.y<s+i)},e.prototype.destroy=function(t){if(r.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t&&t.texture){var n=typeof t=="boolean"?t:t&&t.baseTexture;this._texture.destroy(!!n)}this._texture=null},e.from=function(t,n){return new e(t instanceof Ot?t:Ot.from(t,n))},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var n=Yh(this.scale.x)||1;this.scale.x=n*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var n=Yh(this.scale.y)||1;this.scale.y=n*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Ot.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(Ti),g1=function(r,e){return(g1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)};(function(r){r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(kl||(kl={}));var g0={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:kl.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},dE=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ou=function(){function r(e){this.styleID=0,this.reset(),_0(this,e,e)}return r.prototype.clone=function(){var e={};return _0(e,this,g0),new r(e)},r.prototype.reset=function(){_0(this,g0,g0)},Object.defineProperty(r.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"breakWords",{get:function(){return this._breakWords},set:function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(e){var t=v0(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fill",{get:function(){return this._fill},set:function(e){var t=v0(e);this._fill!==t&&(this._fill=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(e){(function(t,n){if(!Array.isArray(t)||!Array.isArray(n)||t.length!==n.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==n[i])return!1;return!0})(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"leading",{get:function(){return this._leading},set:function(e){this._leading!==e&&(this._leading=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"padding",{get:function(){return this._padding},set:function(e){this._padding!==e&&(this._padding=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"stroke",{get:function(){return this._stroke},set:function(e){var t=v0(e);this._stroke!==t&&(this._stroke=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"trim",{get:function(){return this._trim},set:function(e){this._trim!==e&&(this._trim=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)},enumerable:!1,configurable:!0}),r.prototype.toFontString=function(){var e=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(var n=t.length-1;n>=0;n--){var i=t[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&dE.indexOf(i)<0&&(i='"'+i+'"'),t[n]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+e+" "+t.join(",")},r}();function v1(r){return typeof r=="number"?dv(r):(typeof r=="string"&&r.indexOf("0x")===0&&(r=r.replace("0x","#")),r)}function v0(r){if(Array.isArray(r)){for(var e=0;e<r.length;++e)r[e]=v1(r[e]);return r}return v1(r)}function _0(r,e,t){for(var n in t)Array.isArray(e[n])?r[n]=e[n].slice():r[n]=e[n]}var Fr=function(){function r(e,t,n,i,o,s,a,h,u){this.text=e,this.style=t,this.width=n,this.height=i,this.lines=o,this.lineWidths=s,this.lineHeight=a,this.maxLineWidth=h,this.fontProperties=u}return r.measureText=function(e,t,n,i){i===void 0&&(i=r._canvas),n=n==null?t.wordWrap:n;var o=t.toFontString(),s=r.measureFont(o);s.fontSize===0&&(s.fontSize=t.fontSize,s.ascent=t.fontSize);var a=i.getContext("2d");a.font=o;for(var h=(n?r.wordWrap(e,t,i):e).split(/(?:\r\n|\r|\n)/),u=new Array(h.length),c=0,d=0;d<h.length;d++){var f=a.measureText(h[d]).width+(h[d].length-1)*t.letterSpacing;u[d]=f,c=Math.max(c,f)}var m=c+t.strokeThickness;t.dropShadow&&(m+=t.dropShadowDistance);var g=t.lineHeight||s.fontSize+t.strokeThickness,v=Math.max(g,s.fontSize+t.strokeThickness)+(h.length-1)*(g+t.leading);return t.dropShadow&&(v+=t.dropShadowDistance),new r(e,t,m,v,h,u,g+t.leading,c,s)},r.wordWrap=function(e,t,n){n===void 0&&(n=r._canvas);for(var i=n.getContext("2d"),o=0,s="",a="",h=Object.create(null),u=t.letterSpacing,c=t.whiteSpace,d=r.collapseSpaces(c),f=r.collapseNewlines(c),m=!d,g=t.wordWrapWidth+u,v=r.tokenize(e),x=0;x<v.length;x++){var T=v[x];if(r.isNewline(T)){if(!f){a+=r.addLine(s),m=!d,s="",o=0;continue}T=" "}if(d){var M=r.isBreakingSpace(T),C=r.isBreakingSpace(s[s.length-1]);if(M&&C)continue}var D=r.getFromCache(T,u,h,i);if(D>g)if(s!==""&&(a+=r.addLine(s),s="",o=0),r.canBreakWords(T,t.breakWords))for(var R=r.wordWrapSplit(T),F=0;F<R.length;F++){for(var O=R[F],U=1;R[F+U];){var he=R[F+U],Q=O[O.length-1];if(r.canBreakChars(Q,he,T,F,t.breakWords))break;O+=he,U++}F+=O.length-1;var X=r.getFromCache(O,u,h,i);X+o>g&&(a+=r.addLine(s),m=!1,s="",o=0),s+=O,o+=X}else{s.length>0&&(a+=r.addLine(s),s="",o=0);var Z=x===v.length-1;a+=r.addLine(T,!Z),m=!1,s="",o=0}else D+o>g&&(m=!1,a+=r.addLine(s),s="",o=0),(s.length>0||!r.isBreakingSpace(T)||m)&&(s+=T,o+=D)}return a+=r.addLine(s,!1)},r.addLine=function(e,t){return t===void 0&&(t=!0),e=r.trimRight(e),e=t?e+`
`:e},r.getFromCache=function(e,t,n,i){var o=n[e];if(typeof o!="number"){var s=e.length*t;o=i.measureText(e).width+s,n[e]=o}return o},r.collapseSpaces=function(e){return e==="normal"||e==="pre-line"},r.collapseNewlines=function(e){return e==="normal"},r.trimRight=function(e){if(typeof e!="string")return"";for(var t=e.length-1;t>=0;t--){var n=e[t];if(!r.isBreakingSpace(n))break;e=e.slice(0,-1)}return e},r.isNewline=function(e){return typeof e=="string"&&r._newlines.indexOf(e.charCodeAt(0))>=0},r.isBreakingSpace=function(e,t){return typeof e=="string"&&r._breakingSpaces.indexOf(e.charCodeAt(0))>=0},r.tokenize=function(e){var t=[],n="";if(typeof e!="string")return t;for(var i=0;i<e.length;i++){var o=e[i],s=e[i+1];r.isBreakingSpace(o,s)||r.isNewline(o)?(n!==""&&(t.push(n),n=""),t.push(o)):n+=o}return n!==""&&t.push(n),t},r.canBreakWords=function(e,t){return t},r.canBreakChars=function(e,t,n,i,o){return!0},r.wordWrapSplit=function(e){return e.split("")},r.measureFont=function(e){if(r._fonts[e])return r._fonts[e];var t={ascent:0,descent:0,fontSize:0},n=r._canvas,i=r._context;i.font=e;var o=r.METRICS_STRING+r.BASELINE_SYMBOL,s=Math.ceil(i.measureText(o).width),a=Math.ceil(i.measureText(r.BASELINE_SYMBOL).width),h=Math.ceil(r.HEIGHT_MULTIPLIER*a);a=a*r.BASELINE_MULTIPLIER|0,n.width=s,n.height=h,i.fillStyle="#f00",i.fillRect(0,0,s,h),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,a);var u=i.getImageData(0,0,s,h).data,c=u.length,d=4*s,f=0,m=0,g=!1;for(f=0;f<a;++f){for(var v=0;v<d;v+=4)if(u[m+v]!==255){g=!0;break}if(g)break;m+=d}for(t.ascent=a-f,m=c-d,g=!1,f=h;f>a;--f){for(v=0;v<d;v+=4)if(u[m+v]!==255){g=!0;break}if(g)break;m-=d}return t.descent=f-a,t.fontSize=t.ascent+t.descent,r._fonts[e]=t,t},r.clearMetrics=function(e){e===void 0&&(e=""),e?delete r._fonts[e]:r._fonts={}},r}(),vm=function(){try{var r=new OffscreenCanvas(0,0),e=r.getContext("2d");return e&&e.measureText?r:document.createElement("canvas")}catch{return document.createElement("canvas")}}();vm.width=vm.height=10,Fr._canvas=vm,Fr._context=vm.getContext("2d"),Fr._fonts={},Fr.METRICS_STRING="|\xC9q\xC5",Fr.BASELINE_SYMBOL="M",Fr.BASELINE_MULTIPLIER=1.4,Fr.HEIGHT_MULTIPLIER=2,Fr._newlines=[10,13],Fr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var pE={texture:!0,children:!1,baseTexture:!0},_m=function(r){function e(t,n,i){var o=this,s=!1;i||(i=document.createElement("canvas"),s=!0),i.width=3,i.height=3;var a=Ot.from(i);return a.orig=new en,a.trim=new en,(o=r.call(this,a)||this)._ownCanvas=s,o.canvas=i,o.context=o.canvas.getContext("2d"),o._resolution=Et.RESOLUTION,o._autoResolution=!0,o._text=null,o._style=null,o._styleListener=null,o._font="",o.text=t,o.style=n,o.localStyleID=-1,o}return function(t,n){function i(){this.constructor=t}g1(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),e.prototype.updateText=function(t){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!t){this._font=this._style.toFontString();var i,o,s=this.context,a=Fr.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),h=a.width,u=a.height,c=a.lines,d=a.lineHeight,f=a.lineWidths,m=a.maxLineWidth,g=a.fontProperties;this.canvas.width=Math.ceil((Math.max(1,h)+2*n.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,u)+2*n.padding)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=n.strokeThickness,s.textBaseline=n.textBaseline,s.lineJoin=n.lineJoin,s.miterLimit=n.miterLimit;for(var v=n.dropShadow?2:1,x=0;x<v;++x){var T=n.dropShadow&&x===0,M=T?Math.ceil(Math.max(1,u)+2*n.padding):0,C=M*this._resolution;if(T){s.fillStyle="black",s.strokeStyle="black";var D=n.dropShadowColor,R=Wh(typeof D=="number"?D:pv(D));s.shadowColor="rgba("+255*R[0]+","+255*R[1]+","+255*R[2]+","+n.dropShadowAlpha+")",s.shadowBlur=n.dropShadowBlur,s.shadowOffsetX=Math.cos(n.dropShadowAngle)*n.dropShadowDistance,s.shadowOffsetY=Math.sin(n.dropShadowAngle)*n.dropShadowDistance+C}else s.fillStyle=this._generateFillStyle(n,c,a),s.strokeStyle=n.stroke,s.shadowColor="black",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;var F=(d-g.fontSize)/2;(!e.nextLineHeightBehavior||d-g.fontSize<0)&&(F=0);for(var O=0;O<c.length;O++)i=n.strokeThickness/2,o=n.strokeThickness/2+O*d+g.ascent+F,n.align==="right"?i+=m-f[O]:n.align==="center"&&(i+=(m-f[O])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(c[O],i+n.padding,o+n.padding-M,!0),n.fill&&this.drawLetterSpacing(c[O],i+n.padding,o+n.padding-M)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,n,i,o){o===void 0&&(o=!1);var s=this._style.letterSpacing;if(s!==0)for(var a=n,h=Array.from?Array.from(t):t.split(""),u=this.context.measureText(t).width,c=0,d=0;d<h.length;++d){var f=h[d];o?this.context.strokeText(f,a,i):this.context.fillText(f,a,i),a+=u-(c=this.context.measureText(t.substring(d+1)).width)+s,u=c}else o?this.context.strokeText(t,n,i):this.context.fillText(t,n,i)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var n=Fy(t);n.data&&(t.width=n.width,t.height=n.height,this.context.putImageData(n.data,0,0))}var i=this._texture,o=this._style,s=o.trim?0:o.padding,a=i.baseTexture;i.trim.width=i._frame.width=Math.ceil(t.width/this._resolution),i.trim.height=i._frame.height=Math.ceil(t.height/this._resolution),i.trim.x=-s,i.trim.y=-s,i.orig.width=i._frame.width-2*s,i.orig.height=i._frame.height-2*s,this._onTextureUpdate(),a.setRealSize(t.width,t.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},e.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),r.prototype._render.call(this,t)},e.prototype.getLocalBounds=function(t){return this.updateText(!0),r.prototype.getLocalBounds.call(this,t)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,n,i){var o,s=t.fill;if(!Array.isArray(s))return s;if(s.length===1)return s[0];var a=t.dropShadow?t.dropShadowDistance:0,h=t.padding||0,u=Math.ceil(this.canvas.width/this._resolution)-a-2*h,c=Math.ceil(this.canvas.height/this._resolution)-a-2*h,d=s.slice(),f=t.fillGradientStops.slice();if(!f.length)for(var m=d.length+1,g=1;g<m;++g)f.push(g/m);if(d.unshift(s[0]),f.unshift(0),d.push(s[s.length-1]),f.push(1),t.fillGradientType===kl.LINEAR_VERTICAL){o=this.context.createLinearGradient(u/2,h,u/2,c+h);var v=(i.fontProperties.fontSize+t.strokeThickness)/c;for(g=0;g<n.length;g++)for(var x=i.lineHeight*g,T=0;T<d.length;T++){var M=0;M=typeof f[T]=="number"?f[T]:T/d.length;var C=Math.min(1,Math.max(0,x/c+M*v));C=Number(C.toFixed(5)),o.addColorStop(C,d[T])}}else{o=this.context.createLinearGradient(h,c/2,u+h,c/2);var D=d.length+1,R=1;for(g=0;g<d.length;g++){var F=void 0;F=typeof f[g]=="number"?f[g]:R/D,o.addColorStop(F,d[g]),R++}}return o},e.prototype.destroy=function(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},pE,t),r.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var n=Yh(this.scale.x)||1;this.scale.x=n*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var n=Yh(this.scale.y)||1;this.scale.y=n*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof ou?t:new ou(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t==null?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e}(Un);/*!
 * @pixi/prepare - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Et.UPLOADS_PER_FRAME=4;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var _1=function(r,e){return(_1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},y1=function(){function r(e){this.maxItemsPerFrame=e,this.itemsLeft=0}return r.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},r.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},r}();function fE(r,e){var t=!1;if(r&&r._textures&&r._textures.length){for(var n=0;n<r._textures.length;n++)if(r._textures[n]instanceof Ot){var i=r._textures[n].baseTexture;e.indexOf(i)===-1&&(e.push(i),t=!0)}}return t}function mE(r,e){if(r.baseTexture instanceof mn){var t=r.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function gE(r,e){if(r._texture&&r._texture instanceof Ot){var t=r._texture.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function vE(r,e){return e instanceof _m&&(e.updateText(!0),!0)}function _E(r,e){if(e instanceof ou){var t=e.toFontString();return Fr.measureFont(t),!0}return!1}function yE(r,e){if(r instanceof _m){e.indexOf(r.style)===-1&&e.push(r.style),e.indexOf(r)===-1&&e.push(r);var t=r._texture.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function xE(r,e){return r instanceof ou&&(e.indexOf(r)===-1&&e.push(r),!0)}var x1=function(){function r(e){var t=this;this.limiter=new y1(Et.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){t.queue&&t.prepareItems()},this.registerFindHook(yE),this.registerFindHook(xE),this.registerFindHook(fE),this.registerFindHook(mE),this.registerFindHook(gE),this.registerUploadHook(vE),this.registerUploadHook(_E)}return r.prototype.upload=function(e,t){typeof e=="function"&&(t=e,e=null),e&&this.add(e),this.queue.length?(t&&this.completes.push(t),this.ticking||(this.ticking=!0,Ci.system.addOnce(this.tick,this,wr.UTILITY))):t&&t()},r.prototype.tick=function(){setTimeout(this.delayedTick,0)},r.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed){for(var n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Ci.system.addOnce(this.tick,this,wr.UTILITY);else{this.ticking=!1;var o=this.completes.slice(0);for(this.completes.length=0,n=0,i=o.length;n<i;n++)o[n]()}},r.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},r.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},r.prototype.add=function(e){for(var t=0,n=this.addHooks.length;t<n&&!this.addHooks[t](e,this.queue);t++);if(e instanceof Ti)for(t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this},r.prototype.destroy=function(){this.ticking&&Ci.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},r}();function b1(r,e){return e instanceof mn&&(e._glTextures[r.CONTEXT_UID]||r.texture.bind(e),!0)}function bE(r,e){if(!(e instanceof na))return!1;var t=e.geometry;e.finishPoly(),t.updateBatches();for(var n=t.batches,i=0;i<n.length;i++){var o=n[i].style.texture;o&&b1(r,o.baseTexture)}return t.batchable||r.geometry.bind(t,e._resolveDirectShader(r)),!0}function wE(r,e){return r instanceof na&&(e.push(r),!0)}var w1=function(r){function e(t){var n=r.call(this,t)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook(wE),n.registerUploadHook(b1),n.registerUploadHook(bE),n}return function(t,n){function i(){this.constructor=t}_1(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),e}(x1),TE=function(){function r(e){this.maxMilliseconds=e,this.frameStart=0}return r.prototype.beginFrame=function(){this.frameStart=Date.now()},r.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},r}(),T1=function(){function r(e,t,n){n===void 0&&(n=null),this._texture=e instanceof Ot?e:null,this.baseTexture=e instanceof mn?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;var i=this.baseTexture.resource;this.resolution=this._updateResolution(n||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return r.prototype._updateResolution=function(e){e===void 0&&(e=null);var t=this.data.meta.scale,n=fd(e,null);return n===null&&(n=t!==void 0?parseFloat(t):1),n!==1&&this.baseTexture.setResolution(n),n},r.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=r.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},r.prototype._processFrames=function(e){for(var t=e,n=r.BATCH_SIZE;t-e<n&&t<this._frameKeys.length;){var i=this._frameKeys[t],o=this._frames[i],s=o.frame;if(s){var a=null,h=null,u=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,c=new en(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);a=o.rotated?new en(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new en(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(h=new en(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[i]=new Ot(this.baseTexture,a,c,h,o.rotated?2:0,o.anchor),Ot.addToCache(this.textures[i],i)}t++}},r.prototype._processAnimations=function(){var e=this.data.animations||{};for(var t in e){this.animations[t]=[];for(var n=0;n<e[t].length;n++){var i=e[t][n];this.animations[t].push(this.textures[i])}}},r.prototype._parseComplete=function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)},r.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*r.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*r.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())},0)},r.prototype.destroy=function(e){var t;for(var n in e===void 0&&(e=!1),this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)===null||t===void 0||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},r.BATCH_SIZE=1e3,r}(),S1=function(){function r(){}return r.use=function(e,t){var n,i,o=this,s=e.name+"_image";if(e.data&&e.type===no.TYPE.JSON&&e.data.frames&&!o.resources[s]){var a=(i=(n=e.data)===null||n===void 0?void 0:n.meta)===null||i===void 0?void 0:i.related_multi_packs;if(Array.isArray(a))for(var h=function(m){if(typeof m!="string")return"continue";var g=m.replace(".json",""),v=jh.resolve(e.url.replace(o.baseUrl,""),m);if(o.resources[g]||Object.values(o.resources).some(function(T){return jh.format(jh.parse(T.url))===v}))return"continue";var x={crossOrigin:e.crossOrigin,loadType:no.LOAD_TYPE.XHR,xhrType:no.XHR_RESPONSE_TYPE.JSON,parentResource:e};o.add(g,v,x)},u=0,c=a;u<c.length;u++)h(c[u]);var d={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},f=r.getResourcePath(e,o.baseUrl);o.add(s,f,d,function(m){if(m.error)t(m.error);else{var g=new T1(m.texture,e.data,e.url);g.parse(function(){e.spritesheet=g,e.textures=g.textures,t()})}})}else t()},r.getResourcePath=function(e,t){return e.isDataUrl?e.data.meta.image:jh.resolve(e.url.replace(t,""),e.data.meta.image)},r}(),E1=function(r,e){return(E1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)};function M1(r,e){function t(){this.constructor=r}E1(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Rd=new ni,SE=function(r){function e(t,n,i){n===void 0&&(n=100),i===void 0&&(i=100);var o=r.call(this,t)||this;return o.tileTransform=new Tv,o._width=n,o._height=i,o.uvMatrix=o.texture.uvMatrix||new sm(t),o.pluginName="tilingSprite",o.uvRespectAnchor=!1,o}return M1(e,r),Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var n=this._texture;n&&n.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,n=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),o=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,n,i,o)},e.prototype.getLocalBounds=function(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new en),t=this._localBoundsRect),this._bounds.getRectangle(t)):r.prototype.getLocalBounds.call(this,t)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Rd);var n=this._width,i=this._height,o=-n*this.anchor._x;if(Rd.x>=o&&Rd.x<o+n){var s=-i*this.anchor._y;if(Rd.y>=s&&Rd.y<s+i)return!0}return!1},e.prototype.destroy=function(t){r.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,n){return new e(t instanceof Ot?t:Ot.from(t,n),n.width,n.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),e}(Un),A1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,ym=new li,P1=function(r){function e(t){var n=r.call(this,t)||this,i={globals:n.renderer.globalUniforms};return n.shader=$s.from(A1,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture2D(uSampler, coord);
    gl_FragColor = texSample * uColor;
}
`,i),n.simpleShader=$s.from(A1,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 sample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = sample * uColor;
}
`,i),n.quad=new Nv,n.state=Ga.for2d(),n}return M1(e,r),e.prototype.render=function(t){var n=this.renderer,i=this.quad,o=i.vertices;o[0]=o[6]=t._width*-t.anchor.x,o[1]=o[3]=t._height*-t.anchor.y,o[2]=o[4]=t._width*(1-t.anchor.x),o[5]=o[7]=t._height*(1-t.anchor.y);var s=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;(o=i.uvs)[0]=o[6]=-s,o[1]=o[3]=-a,o[2]=o[4]=1-s,o[5]=o[7]=1-a,i.invalidate();var h=t._texture,u=h.baseTexture,c=t.tileTransform.localTransform,d=t.uvMatrix,f=u.isPowerOfTwo&&h.frame.width===u.width&&h.frame.height===u.height;f&&(u._glTextures[n.CONTEXT_UID]?f=u.wrapMode!==rs.CLAMP:u.wrapMode===rs.CLAMP&&(u.wrapMode=rs.REPEAT));var m=f?this.simpleShader:this.shader,g=h.width,v=h.height,x=t._width,T=t._height;ym.set(c.a*g/x,c.b*g/T,c.c*v/x,c.d*v/T,c.tx/x,c.ty/T),ym.invert(),f?ym.prepend(d.mapCoord):(m.uniforms.uMapCoord=d.mapCoord.toArray(!0),m.uniforms.uClampFrame=d.uClampFrame,m.uniforms.uClampOffset=d.uClampOffset),m.uniforms.uTransform=ym.toArray(!0),m.uniforms.uColor=gv(t.tint,t.worldAlpha,m.uniforms.uColor,u.alphaMode),m.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),m.uniforms.uSampler=h,n.shader.bind(m),n.geometry.bind(i),this.state.blendMode=mv(t.blendMode,u.alphaMode),n.state.set(this.state),n.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e}(yd),R1=function(r,e){return(R1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)};function y0(r,e){function t(){this.constructor=r}R1(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var C1=function(){function r(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return r.prototype.update=function(e){if(e||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var t=this.uvBuffer.data;this.data&&this.data.length===t.length||(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}},r}(),x0=new ni,I1=new gd,su=function(r){function e(t,n,i,o){o===void 0&&(o=Qr.TRIANGLES);var s=r.call(this)||this;return s.geometry=t,t.refCount++,s.shader=n,s.state=i||Ga.for2d(),s.drawMode=o,s.start=0,s.size=0,s.uvs=null,s.indices=null,s.vertexData=new Float32Array(1),s.vertexDirty=-1,s._transformID=-1,s._roundPixels=Et.ROUND_PIXELS,s.batchUvs=null,s}return y0(e,r),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Qr.TRIANGLES&&n.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var n=this.shader;n.alpha=this.worldAlpha,n.update&&n.update(),t.batch.flush(),n.program.uniformData.translationMatrix&&(n.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(n),t.state.set(this.state),t.geometry.bind(this.geometry,n),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var n=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=n.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;var o=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[o]),t.plugins[o].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry.buffers[0],n=t.data,i=t._updateID;if(i!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==n.length&&(this.vertexData=new Float32Array(n.length));for(var o=this.transform.worldTransform,s=o.a,a=o.b,h=o.c,u=o.d,c=o.tx,d=o.ty,f=this.vertexData,m=0;m<f.length/2;m++){var g=n[2*m],v=n[2*m+1];f[2*m]=s*g+h*v+c,f[2*m+1]=a*g+u*v+d}if(this._roundPixels){var x=Et.RESOLUTION;for(m=0;m<f.length;++m)f[m]=Math.round((f[m]*x|0)/x)}this.vertexDirty=i}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],n=this.shader;n.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new C1(t,n.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,x0);for(var n=this.geometry.getBuffer("aVertexPosition").data,i=I1.points,o=this.geometry.getIndex().data,s=o.length,a=this.drawMode===4?3:1,h=0;h+2<s;h+=a){var u=2*o[h],c=2*o[h+1],d=2*o[h+2];if(i[0]=n[u],i[1]=n[u+1],i[2]=n[c],i[3]=n[c+1],i[4]=n[d],i[5]=n[d+1],I1.contains(x0.x,x0.y))return!0}return!1},e.prototype.destroy=function(t){r.prototype.destroy.call(this,t),this.geometry.refCount--,this.geometry.refCount===0&&this.geometry.dispose(),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(Ti),Cd=function(r){function e(t,n){var i=this,o={uSampler:t,alpha:1,uTextureMatrix:li.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(o,n.uniforms),(i=r.call(this,n.program||wd.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`),o)||this)._colorDirty=!1,i.uvMatrix=new sm(t),i.batchable=n.program===void 0,i.pluginName=n.pluginName,i.tint=n.tint,i.alpha=n.alpha,i}return y0(e,r),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;gv(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}($s),Id=function(r){function e(t,n,i){var o=r.call(this)||this,s=new Ii(t),a=new Ii(n,!0),h=new Ii(i,!0,!0);return o.addAttribute("aVertexPosition",s,2,!1,yn.FLOAT).addAttribute("aTextureCoord",a,2,!1,yn.FLOAT).addIndex(h),o._updateId=-1,o}return y0(e,r),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(nu),L1=function(r,e){return(L1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},Ld=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},EE=function(){function r(){}return r.test=function(e){return typeof e=="string"&&e.indexOf("info face=")===0},r.parse=function(e){var t=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var i in t){var o=t[i].match(/^[a-z]+/gm)[0],s=t[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var h in s){var u=s[h].split("="),c=u[0],d=u[1].replace(/"/gm,""),f=parseFloat(d),m=isNaN(f)?d:f;a[c]=m}n[o].push(a)}var g=new Ld;return n.info.forEach(function(v){return g.info.push({face:v.face,size:parseInt(v.size,10)})}),n.common.forEach(function(v){return g.common.push({lineHeight:parseInt(v.lineHeight,10)})}),n.page.forEach(function(v){return g.page.push({id:parseInt(v.id,10),file:v.file})}),n.char.forEach(function(v){return g.char.push({id:parseInt(v.id,10),page:parseInt(v.page,10),x:parseInt(v.x,10),y:parseInt(v.y,10),width:parseInt(v.width,10),height:parseInt(v.height,10),xoffset:parseInt(v.xoffset,10),yoffset:parseInt(v.yoffset,10),xadvance:parseInt(v.xadvance,10)})}),n.kerning.forEach(function(v){return g.kerning.push({first:parseInt(v.first,10),second:parseInt(v.second,10),amount:parseInt(v.amount,10)})}),g},r}(),b0=function(){function r(){}return r.test=function(e){return e instanceof XMLDocument&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},r.parse=function(e){for(var t=new Ld,n=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),o=e.getElementsByTagName("page"),s=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),h=0;h<n.length;h++)t.info.push({face:n[h].getAttribute("face"),size:parseInt(n[h].getAttribute("size"),10)});for(h=0;h<i.length;h++)t.common.push({lineHeight:parseInt(i[h].getAttribute("lineHeight"),10)});for(h=0;h<o.length;h++)t.page.push({id:parseInt(o[h].getAttribute("id"),10)||0,file:o[h].getAttribute("file")});for(h=0;h<s.length;h++){var u=s[h];t.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(h=0;h<a.length;h++)t.kerning.push({first:parseInt(a[h].getAttribute("first"),10),second:parseInt(a[h].getAttribute("second"),10),amount:parseInt(a[h].getAttribute("amount"),10)});return t},r}(),ME=function(){function r(){}return r.test=function(e){if(typeof e=="string"&&e.indexOf("<font>")>-1){var t=new self.DOMParser().parseFromString(e,"text/xml");return b0.test(t)}return!1},r.parse=function(e){var t=new self.DOMParser().parseFromString(e,"text/xml");return b0.parse(t)},r}(),w0=[EE,b0,ME];function O1(r){for(var e=0;e<w0.length;e++)if(w0[e].test(r))return w0[e];return null}function D1(r,e,t,n,i,o){var s,a=t.fill;if(!Array.isArray(a))return a;if(a.length===1)return a[0];var h=t.dropShadow?t.dropShadowDistance:0,u=t.padding||0,c=Math.ceil(r.width/n)-h-2*u,d=Math.ceil(r.height/n)-h-2*u,f=a.slice(),m=t.fillGradientStops.slice();if(!m.length)for(var g=f.length+1,v=1;v<g;++v)m.push(v/g);if(f.unshift(a[0]),m.unshift(0),f.push(a[a.length-1]),m.push(1),t.fillGradientType===kl.LINEAR_VERTICAL){s=e.createLinearGradient(c/2,u,c/2,d+u);var x=0,T=(o.fontProperties.fontSize+t.strokeThickness)/d;for(v=0;v<i.length;v++)for(var M=o.lineHeight*v,C=0;C<f.length;C++){var D=M/d+(typeof m[C]=="number"?m[C]:C/f.length)*T,R=Math.max(x,D);R=Math.min(R,1),s.addColorStop(R,f[C]),x=R}}else{s=e.createLinearGradient(u,d/2,c+u,d/2);var F=f.length+1,O=1;for(v=0;v<f.length;v++){var U=void 0;U=typeof m[v]=="number"?m[v]:O/F,s.addColorStop(U,f[v]),O++}}return s}function AE(r,e,t,n,i,o,s){var a=t.text,h=t.fontProperties;e.translate(n,i),e.scale(o,o);var u=s.strokeThickness/2,c=-s.strokeThickness/2;e.font=s.toFontString(),e.lineWidth=s.strokeThickness,e.textBaseline=s.textBaseline,e.lineJoin=s.lineJoin,e.miterLimit=s.miterLimit,e.fillStyle=D1(r,e,s,o,[a],t),e.strokeStyle=s.stroke,e.font=s.toFontString(),e.lineWidth=s.strokeThickness,e.textBaseline=s.textBaseline,e.lineJoin=s.lineJoin,e.miterLimit=s.miterLimit,e.fillStyle=D1(r,e,s,o,[a],t),e.strokeStyle=s.stroke;var d=s.dropShadowColor,f=Wh(typeof d=="number"?d:pv(d));s.dropShadow?(e.shadowColor="rgba("+255*f[0]+","+255*f[1]+","+255*f[2]+","+s.dropShadowAlpha+")",e.shadowBlur=s.dropShadowBlur,e.shadowOffsetX=Math.cos(s.dropShadowAngle)*s.dropShadowDistance,e.shadowOffsetY=Math.sin(s.dropShadowAngle)*s.dropShadowDistance):(e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),s.stroke&&s.strokeThickness&&e.strokeText(a,u,c+t.lineHeight-h.descent),s.fill&&e.fillText(a,u,c+t.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}var Gl=function(){function r(e,t,n){var i=e.info[0],o=e.common[0],s=fd(e.page[0].file),a={};this._ownsTextures=n,this.font=i.face,this.size=i.size,this.lineHeight=o.lineHeight/s,this.chars={},this.pageTextures=a;for(var h=0;h<e.page.length;h++){var u=e.page[h],c=u.id,d=u.file;a[c]=t instanceof Array?t[h]:t[d]}for(h=0;h<e.char.length;h++){var f=e.char[h],m=(c=f.id,f.page),g=e.char[h],v=g.x,x=g.y,T=g.width,M=g.height,C=g.xoffset,D=g.yoffset,R=g.xadvance;x/=s,T/=s,M/=s,C/=s,D/=s,R/=s;var F=new en((v/=s)+a[m].frame.x/s,x+a[m].frame.y/s,T,M);this.chars[c]={xOffset:C,yOffset:D,xAdvance:R,kerning:{},texture:new Ot(a[m].baseTexture,F),page:m}}for(h=0;h<e.kerning.length;h++){var O=e.kerning[h],U=O.first,he=O.second,Q=O.amount;U/=s,he/=s,Q/=s,this.chars[he]&&(this.chars[he].kerning[U]=Q)}}return r.prototype.destroy=function(){for(var e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(var e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null},r.install=function(e,t,n){var i;if(e instanceof Ld)i=e;else{var o=O1(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}t instanceof Ot&&(t=[t]);var s=new r(i,t,n);return r.available[s.font]=s,s},r.uninstall=function(e){var t=r.available[e];if(!t)throw new Error("No font found named '"+e+"'");t.destroy(),delete r.available[e]},r.from=function(e,t,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var i=Object.assign({},r.defaultOptions,n),o=i.chars,s=i.padding,a=i.resolution,h=i.textureWidth,u=i.textureHeight,c=function(Pe){typeof Pe=="string"&&(Pe=[Pe]);for(var Ue=[],Fe=0,Y=Pe.length;Fe<Y;Fe++){var $=Pe[Fe];if(Array.isArray($)){if($.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+$.length+".");var Me=$[0].charCodeAt(0),De=$[1].charCodeAt(0);if(De<Me)throw new Error("[BitmapFont]: Invalid character range.");for(var we=Me,ke=De;we<=ke;we++)Ue.push(String.fromCharCode(we))}else Ue.push.apply(Ue,$.split(""))}if(Ue.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return Ue}(o),d=t instanceof ou?t:new ou(t),f=h,m=new Ld;m.info[0]={face:d.fontFamily,size:d.fontSize},m.common[0]={lineHeight:d.fontSize};for(var g,v,x,T=0,M=0,C=0,D=[],R=0;R<c.length;R++){g||((g=document.createElement("canvas")).width=h,g.height=u,v=g.getContext("2d"),x=new mn(g,{resolution:a}),D.push(new Ot(x)),m.page.push({id:D.length-1,file:""}));var F=Fr.measureText(c[R],d,!1,g),O=F.width,U=Math.ceil(F.height),he=Math.ceil((d.fontStyle==="italic"?2:1)*O);if(M>=u-U*a){if(M===0)throw new Error("[BitmapFont] textureHeight "+u+"px is too small for "+d.fontSize+"px fonts");--R,g=null,v=null,x=null,M=0,T=0,C=0}else if(C=Math.max(U+F.fontProperties.descent,C),he*a+T>=f)--R,M+=C*a,M=Math.ceil(M),T=0,C=0;else{AE(g,v,F,T,M,a,d);var Q=F.text.charCodeAt(0);m.char.push({id:Q,page:D.length-1,x:T/a,y:M/a,width:he,height:U,xoffset:0,yoffset:0,xadvance:Math.ceil(O-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0))}),T+=(he+2*s)*a,T=Math.ceil(T)}}R=0;for(var X=c.length;R<X;R++)for(var Z=c[R],q=0;q<X;q++){var oe=c[q],fe=v.measureText(Z).width,me=v.measureText(oe).width,le=v.measureText(Z+oe).width-(fe+me);le&&m.kerning.push({first:Z.charCodeAt(0),second:oe.charCodeAt(0),amount:le})}var pe=new r(m,D,!0);return r.available[e]!==void 0&&r.uninstall(e),r.available[e]=pe,pe},r.ALPHA=[["a","z"],["A","Z"]," "],r.NUMERIC=[["0","9"]],r.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],r.ASCII=[[" ","~"]],r.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:r.ALPHANUMERIC},r.available={},r}(),N1=[],F1=[],PE=function(r){function e(t,n){n===void 0&&(n={});var i=r.call(this)||this;i._tint=16777215;var o=Object.assign({},e.styleDefaults,n),s=o.align,a=o.tint,h=o.maxWidth,u=o.letterSpacing,c=o.fontName,d=o.fontSize;if(!Gl.available[c])throw new Error('Missing BitmapFont "'+c+'"');return i._activePagesMeshData=[],i._textWidth=0,i._textHeight=0,i._align=s,i._tint=a,i._fontName=c,i._fontSize=d||Gl.available[c].size,i._text=t,i._maxWidth=h,i._maxLineHeight=0,i._letterSpacing=u,i._anchor=new $h(function(){i.dirty=!0},i,0,0),i._roundPixels=Et.ROUND_PIXELS,i.dirty=!0,i._textureCache={},i}return function(t,n){function i(){this.constructor=t}L1(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),e.prototype.updateText=function(){for(var t,n=Gl.available[this._fontName],i=this._fontSize/n.size,o=new ni,s=[],a=[],h=[],u=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=u.length,d=this._maxWidth*n.size/this._fontSize,f=null,m=0,g=0,v=0,x=-1,T=0,M=0,C=0,D=0,R=0;R<c;R++){var F=u.charCodeAt(R),O=u.charAt(R);if(/(?:\s)/.test(O)&&(x=R,T=m,D++),O!=="\r"&&O!==`
`){var U=n.chars[F];if(U){f&&U.kerning[f]&&(o.x+=U.kerning[f]);var he=F1.pop()||{texture:Ot.EMPTY,line:0,charCode:0,prevSpaces:0,position:new ni};he.texture=U.texture,he.line=v,he.charCode=F,he.position.x=o.x+U.xOffset+this._letterSpacing/2,he.position.y=o.y+U.yOffset,he.prevSpaces=D,s.push(he),o.x+=U.xAdvance+this._letterSpacing,m=o.x,C=Math.max(C,U.yOffset+U.texture.height),f=F,x!==-1&&d>0&&o.x>d&&(Xh(s,1+x-++M,1+R-x),R=x,x=-1,a.push(T),h.push(s.length>0?s[s.length-1].prevSpaces:0),g=Math.max(g,T),v++,o.x=0,o.y+=n.lineHeight,f=null,D=0)}}else a.push(m),h.push(-1),g=Math.max(g,m),++v,++M,o.x=0,o.y+=n.lineHeight,f=null,D=0}var Q=u.charAt(u.length-1);Q!=="\r"&&Q!==`
`&&(/(?:\s)/.test(Q)&&(m=T),a.push(m),g=Math.max(g,m),h.push(-1));var X=[];for(R=0;R<=v;R++){var Z=0;this._align==="right"?Z=g-a[R]:this._align==="center"?Z=(g-a[R])/2:this._align==="justify"&&(Z=h[R]<0?0:(g-a[R])/h[R]),X.push(Z)}var q=s.length,oe={},fe=[],me=this._activePagesMeshData;for(R=0;R<me.length;R++)N1.push(me[R]);for(R=0;R<q;R++){var le=(we=s[R].texture).baseTexture.uid;if(!oe[le]){if(!(ye=N1.pop())){var pe=new Id,Pe=new Cd(Ot.EMPTY);ye={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new su(pe,Pe),vertices:null,uvs:null,indices:null}}ye.index=0,ye.indexCount=0,ye.vertexCount=0,ye.uvsCount=0,ye.total=0;var Ue=this._textureCache;Ue[le]=Ue[le]||new Ot(we.baseTexture),ye.mesh.texture=Ue[le],ye.mesh.tint=this._tint,fe.push(ye),oe[le]=ye}oe[le].total++}for(R=0;R<me.length;R++)fe.indexOf(me[R])===-1&&this.removeChild(me[R].mesh);for(R=0;R<fe.length;R++)fe[R].mesh.parent!==this&&this.addChild(fe[R].mesh);for(var R in this._activePagesMeshData=fe,oe){var Fe=(ye=oe[R]).total;if(!(((t=ye.indices)===null||t===void 0?void 0:t.length)>6*Fe)||ye.vertices.length<2*su.BATCHABLE_SIZE)ye.vertices=new Float32Array(8*Fe),ye.uvs=new Float32Array(8*Fe),ye.indices=new Uint16Array(6*Fe);else for(var Y=ye.total,$=ye.vertices,Me=4*Y*2;Me<$.length;Me++)$[Me]=0;ye.mesh.size=6*Fe}for(R=0;R<q;R++){var De=(O=s[R]).position.x+X[O.line]*(this._align==="justify"?O.prevSpaces:1);this._roundPixels&&(De=Math.round(De));var we,ke=De*i,We=O.position.y*i,ge=oe[(we=O.texture).baseTexture.uid],W=we.frame,de=we._uvs,_e=ge.index++;ge.indices[6*_e+0]=0+4*_e,ge.indices[6*_e+1]=1+4*_e,ge.indices[6*_e+2]=2+4*_e,ge.indices[6*_e+3]=0+4*_e,ge.indices[6*_e+4]=2+4*_e,ge.indices[6*_e+5]=3+4*_e,ge.vertices[8*_e+0]=ke,ge.vertices[8*_e+1]=We,ge.vertices[8*_e+2]=ke+W.width*i,ge.vertices[8*_e+3]=We,ge.vertices[8*_e+4]=ke+W.width*i,ge.vertices[8*_e+5]=We+W.height*i,ge.vertices[8*_e+6]=ke,ge.vertices[8*_e+7]=We+W.height*i,ge.uvs[8*_e+0]=de.x0,ge.uvs[8*_e+1]=de.y0,ge.uvs[8*_e+2]=de.x1,ge.uvs[8*_e+3]=de.y1,ge.uvs[8*_e+4]=de.x2,ge.uvs[8*_e+5]=de.y2,ge.uvs[8*_e+6]=de.x3,ge.uvs[8*_e+7]=de.y3}for(var R in this._textWidth=g*i,this._textHeight=(o.y+n.lineHeight)*i,oe){var ye=oe[R];if(this.anchor.x!==0||this.anchor.y!==0)for(var Oe=0,ht=this._textWidth*this.anchor.x,_t=this._textHeight*this.anchor.y,gt=0;gt<ye.total;gt++)ye.vertices[Oe++]-=ht,ye.vertices[Oe++]-=_t,ye.vertices[Oe++]-=ht,ye.vertices[Oe++]-=_t,ye.vertices[Oe++]-=ht,ye.vertices[Oe++]-=_t,ye.vertices[Oe++]-=ht,ye.vertices[Oe++]-=_t;this._maxLineHeight=C*i;var Ut=ye.mesh.geometry.getBuffer("aVertexPosition"),Vt=ye.mesh.geometry.getBuffer("aTextureCoord"),ii=ye.mesh.geometry.getIndex();Ut.data=ye.vertices,Vt.data=ye.uvs,ii.data=ye.indices,Ut.update(),Vt.update(),ii.update()}for(R=0;R<s.length;R++)F1.push(s[R])},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),r.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var n=0;n<this._activePagesMeshData.length;n++)this._activePagesMeshData[n].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!Gl.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t==null?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t){var n=this._textureCache;for(var i in n)n[i].destroy(),delete n[i];this._textureCache=null,r.prototype.destroy.call(this,t)},e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},e}(Ti),B1=function(){function r(){}return r.add=function(){no.setExtensionXhrType("fnt",no.XHR_RESPONSE_TYPE.TEXT)},r.use=function(e,t){var n=O1(e.data);if(n)for(var i=r.getBaseUrl(this,e),o=n.parse(e.data),s={},a=function(v){s[v.metadata.pageFile]=v.texture,Object.keys(s).length===o.page.length&&(e.bitmapFont=Gl.install(o,s,!0),t())},h=0;h<o.page.length;++h){var u=o.page[h].file,c=i+u,d=!1;for(var f in this.resources){var m=this.resources[f];if(m.url===c){m.metadata.pageFile=u,m.texture?a(m):m.onAfterMiddleware.add(a),d=!0;break}}if(!d){var g={crossOrigin:e.crossOrigin,loadType:no.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(c,g,a)}}else t()},r.getBaseUrl=function(e,t){var n=t.isDataUrl?"":r.dirname(t.url);return t.isDataUrl&&(n==="."&&(n=""),e.baseUrl&&n&&e.baseUrl.charAt(e.baseUrl.length-1)==="/"&&(n+="/")),(n=n.replace(e.baseUrl,""))&&n.charAt(n.length-1)!=="/"&&(n+="/"),n},r.dirname=function(e){var t=e.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return t===e?".":t===""?"/":t},r}(),U1=function(r,e){return(U1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},RE=function(r){function e(t){t===void 0&&(t=1);var n=r.call(this,Mx,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,{uAlpha:1})||this;return n.alpha=t,n}return function(t,n){function i(){this.constructor=t}U1(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(Sr),k1=function(r,e){return(k1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)};function G1(r,e){function t(){this.constructor=r}k1(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var H1,z1,V1,j1,W1,X1,Y1,q1,Z1,$1,J1,K1,Q1,Od,eb,tb,nb,ib,CE={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},IE=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);(function(r){r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2"})(H1||(H1={})),function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS"}(z1||(z1={})),function(r){r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL"}(V1||(V1={})),function(r){r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR"}(j1||(j1={})),function(r){r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(W1||(W1={})),function(r){r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(X1||(X1={})),function(r){r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Y1||(Y1={})),function(r){r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.FLOAT=5126]="FLOAT",r[r.HALF_FLOAT=36193]="HALF_FLOAT"}(q1||(q1={})),function(r){r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT"}(Z1||(Z1={})),function(r){r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR"}($1||($1={})),function(r){r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(J1||(J1={})),function(r){r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL"}(K1||(K1={})),function(r){r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Q1||(Q1={})),function(r){r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT"}(Od||(Od={})),function(r){r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL"}(eb||(eb={})),function(r){r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp"}(tb||(tb={})),function(r){r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE"}(nb||(nb={})),function(r){r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH"}(ib||(ib={}));var T0=function(r){function e(t,n,i,o,s){n===void 0&&(n=8),i===void 0&&(i=4),o===void 0&&(o=Et.FILTER_RESOLUTION),s===void 0&&(s=5);var a=this,h=function(c,d){var f,m=Math.ceil(c/2),g=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`,v="";f=d?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var x=0;x<c;x++){var T=f.replace("%index%",x.toString());v+=T=T.replace("%sampleIndex%",x-(m-1)+".0"),v+=`
`}return g=(g=g.replace("%blur%",v)).replace("%size%",c.toString())}(s,t),u=function(c){for(var d,f=CE[c],m=f.length,g=IE,v="",x=0;x<c;x++){var T="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",x.toString());d=x,x>=m&&(d=c-x-1),v+=T=T.replace("%value%",f[d].toString()),v+=`
`}return g=(g=g.replace("%blur%",v)).replace("%size%",c.toString())}(s);return(a=r.call(this,h,u)||this).horizontal=t,a.resolution=o,a._quality=0,a.quality=i,a.blur=n,a}return G1(e,r),e.prototype.apply=function(t,n,i,o){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/n.width):this.uniforms.strength=1/i.height*(i.height/n.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/n.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/n.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,n,i,o);else{var s=t.getFilterTexture(),a=t.renderer,h=n,u=s;this.state.blend=!1,t.applyFilter(this,h,u,Od.CLEAR);for(var c=1;c<this.passes-1;c++){t.bindAndClear(h,Od.BLIT),this.uniforms.uSampler=u;var d=u;u=h,h=d,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,u,i,o),t.returnFilterTexture(s)}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e}(Sr),LE=function(r){function e(t,n,i,o){t===void 0&&(t=8),n===void 0&&(n=4),i===void 0&&(i=Et.FILTER_RESOLUTION),o===void 0&&(o=5);var s=r.call(this)||this;return s.blurXFilter=new T0(!0,t,n,i,o),s.blurYFilter=new T0(!1,t,n,i,o),s.resolution=i,s.quality=n,s.blur=t,s.repeatEdgePixels=!1,s}return G1(e,r),e.prototype.apply=function(t,n,i,o){var s=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(s&&a){var h=t.getFilterTexture();this.blurXFilter.apply(t,n,h,Od.CLEAR),this.blurYFilter.apply(t,h,i,o),t.returnFilterTexture(h)}else a?this.blurYFilter.apply(t,n,i,o):this.blurXFilter.apply(t,n,i,o)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0}),e}(Sr),rb=function(r,e){return(rb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},S0=function(r){function e(){var t=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(t=r.call(this,e0,`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,n)||this).alpha=1,t}return function(t,n){function i(){this.constructor=t}rb(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),e.prototype._loadMatrix=function(t,n){n===void 0&&(n=!1);var i=t;n&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i},e.prototype._multiply=function(t,n,i){return t[0]=n[0]*i[0]+n[1]*i[5]+n[2]*i[10]+n[3]*i[15],t[1]=n[0]*i[1]+n[1]*i[6]+n[2]*i[11]+n[3]*i[16],t[2]=n[0]*i[2]+n[1]*i[7]+n[2]*i[12]+n[3]*i[17],t[3]=n[0]*i[3]+n[1]*i[8]+n[2]*i[13]+n[3]*i[18],t[4]=n[0]*i[4]+n[1]*i[9]+n[2]*i[14]+n[3]*i[19]+n[4],t[5]=n[5]*i[0]+n[6]*i[5]+n[7]*i[10]+n[8]*i[15],t[6]=n[5]*i[1]+n[6]*i[6]+n[7]*i[11]+n[8]*i[16],t[7]=n[5]*i[2]+n[6]*i[7]+n[7]*i[12]+n[8]*i[17],t[8]=n[5]*i[3]+n[6]*i[8]+n[7]*i[13]+n[8]*i[18],t[9]=n[5]*i[4]+n[6]*i[9]+n[7]*i[14]+n[8]*i[19]+n[9],t[10]=n[10]*i[0]+n[11]*i[5]+n[12]*i[10]+n[13]*i[15],t[11]=n[10]*i[1]+n[11]*i[6]+n[12]*i[11]+n[13]*i[16],t[12]=n[10]*i[2]+n[11]*i[7]+n[12]*i[12]+n[13]*i[17],t[13]=n[10]*i[3]+n[11]*i[8]+n[12]*i[13]+n[13]*i[18],t[14]=n[10]*i[4]+n[11]*i[9]+n[12]*i[14]+n[13]*i[19]+n[14],t[15]=n[15]*i[0]+n[16]*i[5]+n[17]*i[10]+n[18]*i[15],t[16]=n[15]*i[1]+n[16]*i[6]+n[17]*i[11]+n[18]*i[16],t[17]=n[15]*i[2]+n[16]*i[7]+n[17]*i[12]+n[18]*i[17],t[18]=n[15]*i[3]+n[16]*i[8]+n[17]*i[13]+n[18]*i[18],t[19]=n[15]*i[4]+n[16]*i[9]+n[17]*i[14]+n[18]*i[19]+n[19],t},e.prototype._colorMatrix=function(t){var n=new Float32Array(t);return n[4]/=255,n[9]/=255,n[14]/=255,n[19]/=255,n},e.prototype.brightness=function(t,n){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,n)},e.prototype.greyscale=function(t,n){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,n)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,n){t=(t||0)/180*Math.PI;var i=Math.cos(t),o=Math.sin(t),s=1/3,a=(0,Math.sqrt)(s),h=[i+(1-i)*s,s*(1-i)-a*o,s*(1-i)+a*o,0,0,s*(1-i)+a*o,i+s*(1-i),s*(1-i)-a*o,0,0,s*(1-i)-a*o,s*(1-i)+a*o,i+s*(1-i),0,0,0,0,0,1,0];this._loadMatrix(h,n)},e.prototype.contrast=function(t,n){var i=(t||0)+1,o=-.5*(i-1),s=[i,0,0,0,o,0,i,0,0,o,0,0,i,0,o,0,0,0,1,0];this._loadMatrix(s,n)},e.prototype.saturate=function(t,n){t===void 0&&(t=0);var i=2*t/3+1,o=-.5*(i-1),s=[i,o,o,0,0,o,i,o,0,0,o,o,i,0,0,0,0,0,1,0];this._loadMatrix(s,n)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,n,i,o,s){var a=((i=i||16770432)>>16&255)/255,h=(i>>8&255)/255,u=(255&i)/255,c=((o=o||3375104)>>16&255)/255,d=(o>>8&255)/255,f=(255&o)/255,m=[.3,.59,.11,0,0,a,h,u,t=t||.2,0,c,d,f,n=n||.15,0,a-c,h-d,u-f,0,0];this._loadMatrix(m,s)},e.prototype.night=function(t,n){var i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,n)},e.prototype.predator=function(t,n){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,n)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(Sr);S0.prototype.grayscale=S0.prototype.greyscale;/*!
 * @pixi/filter-displacement - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var ob=function(r,e){return(ob=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},OE=function(r){function e(t,n){var i=this,o=new li;return t.renderable=!1,(i=r.call(this,`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`,`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,{mapSampler:t._texture,filterMatrix:o,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=t,i.maskMatrix=o,n==null&&(n=20),i.scale=new ni(n,n),i}return function(t,n){function i(){this.constructor=t}ob(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),e.prototype.apply=function(t,n,i,o){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var s=this.maskSprite.worldTransform,a=Math.sqrt(s.a*s.a+s.b*s.b),h=Math.sqrt(s.c*s.c+s.d*s.d);a!==0&&h!==0&&(this.uniforms.rotation[0]=s.a/a,this.uniforms.rotation[1]=s.b/a,this.uniforms.rotation[2]=s.c/h,this.uniforms.rotation[3]=s.d/h),t.applyFilter(this,n,i,o)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0}),e}(Sr),sb=function(r,e){return(sb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},DE=function(r){function e(){return r.call(this,`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`)||this}return function(t,n){function i(){this.constructor=t}sb(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),e}(Sr),ab=function(r,e){return(ab=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},NE=function(r){function e(t,n){t===void 0&&(t=.5),n===void 0&&(n=Math.random());var i=r.call(this,e0,`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`,{uNoise:0,uSeed:0})||this;return i.noise=t,i.seed=n,i}return function(t,n){function i(){this.constructor=t}ab(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0}),e}(Sr),hb=new li;ci.prototype._cacheAsBitmap=!1,ci.prototype._cacheData=null,ci.prototype._cacheAsBitmapResolution=null;var FE=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(ci.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(r){r!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(r){var e;this._cacheAsBitmap!==r&&(this._cacheAsBitmap=r,r?(this._cacheData||(this._cacheData=new FE),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),ci.prototype._renderCached=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(r),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(r))},ci.prototype._initCachedDisplayObject=function(r){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,r.batch.flush();var t=this.getLocalBounds(null,!0).clone();if(this.filters){var n=this.filters[0].padding;t.pad(n)}t.ceil(Et.RESOLUTION);var i=r.renderTexture.current,o=r.renderTexture.sourceFrame.clone(),s=r.renderTexture.destinationFrame.clone(),a=r.projection.transform,h=to.create({width:t.width,height:t.height,resolution:this.cacheAsBitmapResolution||r.resolution}),u="cacheAsBitmap_"+qh();this._cacheData.textureCacheId=u,mn.addToCache(h.baseTexture,u),Ot.addToCache(h,u);var c=this.transform.localTransform.copyTo(hb).invert().translate(-t.x,-t.y);this.render=this._cacheData.originalRender,r.render(this,{renderTexture:h,clear:!0,transform:c,skipUpdateTransform:!1}),r.projection.transform=a,r.renderTexture.bind(i,o,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;var d=new Un(h);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-t.x/t.width,d.anchor.y=-t.y/t.height,d.alpha=e,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)}},ci.prototype._renderCachedCanvas=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(r),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(r))},ci.prototype._initCachedDisplayObjectCanvas=function(r){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(null,!0),t=this.alpha;this.alpha=1;var n=r.context,i=r._projTransform;e.ceil(Et.RESOLUTION);var o=to.create({width:e.width,height:e.height}),s="cacheAsBitmap_"+qh();this._cacheData.textureCacheId=s,mn.addToCache(o.baseTexture,s),Ot.addToCache(o,s);var a=hb;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=e.x,a.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,r.render(this,{renderTexture:o,clear:!0,transform:a,skipUpdateTransform:!1}),r.context=n,r._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;var h=new Un(o);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=t,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=r._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},ci.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},ci.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},ci.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,mn.removeFromCache(this._cacheData.textureCacheId),Ot.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},ci.prototype._cacheAsBitmapDestroy=function(r){this.cacheAsBitmap=!1,this.destroy(r)},ci.prototype.name=null,Ti.prototype.getChildByName=function(r,e){for(var t=0,n=this.children.length;t<n;t++)if(this.children[t].name===r)return this.children[t];if(e){for(t=0,n=this.children.length;t<n;t++)if(this.children[t].getChildByName){var i=this.children[t].getChildByName(r,!0);if(i)return i}}return null},ci.prototype.getGlobalPosition=function(r,e){return r===void 0&&(r=new ni),e===void 0&&(e=!1),this.parent?this.parent.toGlobal(this.position,r,e):(r.x=this.position.x,r.y=this.position.y),r};/*!
 * @pixi/mesh-extras - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/mesh-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var ub=function(r,e){return(ub=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)};function Hl(r,e){function t(){this.constructor=r}ub(r,e),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var lb=function(r){function e(t,n,i,o){t===void 0&&(t=100),n===void 0&&(n=100),i===void 0&&(i=10),o===void 0&&(o=10);var s=r.call(this)||this;return s.segWidth=i,s.segHeight=o,s.width=t,s.height=n,s.build(),s}return Hl(e,r),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,n=[],i=[],o=[],s=this.segWidth-1,a=this.segHeight-1,h=this.width/s,u=this.height/a,c=0;c<t;c++){var d=c%this.segWidth,f=c/this.segWidth|0;n.push(d*h,f*u),i.push(d/s,f/a)}var m=s*a;for(c=0;c<m;c++){var g=c%s,v=c/s|0,x=v*this.segWidth+g,T=v*this.segWidth+g+1,M=(v+1)*this.segWidth+g,C=(v+1)*this.segWidth+g+1;o.push(x,T,M,T,C,M)}this.buffers[0].data=new Float32Array(n),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(o),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(Id),cb=function(r){function e(t,n,i){t===void 0&&(t=200),i===void 0&&(i=0);var o=r.call(this,new Float32Array(4*n.length),new Float32Array(4*n.length),new Uint16Array(6*(n.length-1)))||this;return o.points=n,o._width=t,o.textureScale=i,o.build(),o}return Hl(e,r),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var n=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),o=this.getIndex();if(!(t.length<1)){n.data.length/4!==t.length&&(n.data=new Float32Array(4*t.length),i.data=new Float32Array(4*t.length),o.data=new Uint16Array(6*(t.length-1)));var s=i.data,a=o.data;s[0]=0,s[1]=0,s[2]=0,s[3]=1;for(var h=0,u=t[0],c=this._width*this.textureScale,d=t.length,f=0;f<d;f++){var m=4*f;if(this.textureScale>0){var g=u.x-t[f].x,v=u.y-t[f].y,x=Math.sqrt(g*g+v*v);u=t[f],h+=x/c}else h=f/(d-1);s[m]=h,s[m+1]=0,s[m+2]=h,s[m+3]=1}var T=0;for(f=0;f<d-1;f++)m=2*f,a[T++]=m,a[T++]=m+1,a[T++]=m+2,a[T++]=m+2,a[T++]=m+1,a[T++]=m+3;i.update(),o.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var n,i=t[0],o=0,s=0,a=this.buffers[0].data,h=t.length,u=0;u<h;u++){var c=t[u],d=4*u;s=-((n=u<t.length-1?t[u+1]:c).x-i.x),o=n.y-i.y;var f=Math.sqrt(o*o+s*s),m=this.textureScale>0?this.textureScale*this._width/2:this._width/2;o/=f,s/=f,o*=m,s*=m,a[d]=c.x+o,a[d+1]=c.y+s,a[d+2]=c.x-o,a[d+3]=c.y-s,i=c}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(Id),BE=function(r){function e(t,n,i){i===void 0&&(i=0);var o=this,s=new cb(t.height,n,i),a=new Cd(t);return i>0&&(t.baseTexture.wrapMode=rs.REPEAT),(o=r.call(this,s,a)||this).autoUpdate=!0,o}return Hl(e,r),e.prototype._render=function(t){var n=this.geometry;(this.autoUpdate||n._width!==this.shader.texture.height)&&(n._width=this.shader.texture.height,n.update()),r.prototype._render.call(this,t)},e}(su),db=function(r){function e(t,n,i){var o=this,s=new lb(t.width,t.height,n,i),a=new Cd(Ot.WHITE);return(o=r.call(this,s,a)||this).texture=t,o}return Hl(e,r),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry;t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build()},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),r.prototype._render.call(this,t)},e.prototype.destroy=function(t){this.shader.texture.off("update",this.textureUpdated,this),r.prototype.destroy.call(this,t)},e}(su),UE=function(r){function e(t,n,i,o,s){t===void 0&&(t=Ot.EMPTY);var a=this,h=new Id(n,i,o);h.getBuffer("aVertexPosition").static=!1;var u=new Cd(t);return(a=r.call(this,h,u,null,s)||this).autoUpdate=!0,a}return Hl(e,r),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),r.prototype._render.call(this,t)},e}(su),kE=function(r){function e(t,n,i,o,s){n===void 0&&(n=10),i===void 0&&(i=10),o===void 0&&(o=10),s===void 0&&(s=10);var a=r.call(this,Ot.WHITE,4,4)||this;return a._origWidth=t.orig.width,a._origHeight=t.orig.height,a._width=a._origWidth,a._height=a._origHeight,a._leftWidth=n,a._rightWidth=o,a._topHeight=i,a._bottomHeight=s,a.texture=t,a}return Hl(e,r),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,n=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*n,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*n,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,n=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*n,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*n,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,n=this._width>t?1:this._width/t,i=this._topHeight+this._bottomHeight,o=this._height>i?1:this._height/i;return Math.min(n,o)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,n=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var i=1/this._origWidth,o=1/this._origHeight;n[0]=n[8]=n[16]=n[24]=0,n[1]=n[3]=n[5]=n[7]=0,n[6]=n[14]=n[22]=n[30]=1,n[25]=n[27]=n[29]=n[31]=1,n[2]=n[10]=n[18]=n[26]=i*this._leftWidth,n[4]=n[12]=n[20]=n[28]=1-i*this._rightWidth,n[9]=n[11]=n[13]=n[15]=o*this._topHeight,n[17]=n[19]=n[21]=n[23]=1-o*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(db),pb=function(r,e){return(pb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(r,e)},E0=function(r){function e(t,n){n===void 0&&(n=!0);var i=r.call(this,t[0]instanceof Ot?t[0]:t[0].texture)||this;return i._textures=null,i._durations=null,i._autoUpdate=n,i._isConnectedToTicker=!1,i.animationSpeed=1,i.loop=!0,i.updateAnchor=!1,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i._playing=!1,i._previousFrame=null,i.textures=t,i}return function(t,n){function i(){this.constructor=t}pb(t,n),t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}(e,r),e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Ci.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Ci.shared.add(this.update,this,wr.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var n=this.currentFrame;this._currentTime=t,n!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var n=this.currentFrame;this._currentTime=t,n!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){if(this._playing){var n=this.animationSpeed*t,i=this.currentFrame;if(this._durations!==null){var o=this._currentTime%1*this._durations[this.currentFrame];for(o+=n/60*1e3;o<0;)this._currentTime--,o+=this._durations[this.currentFrame];var s=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);o>=this._durations[this.currentFrame];)o-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=o/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())}},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(t){this.stop(),r.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var n=[],i=0;i<t.length;++i)n.push(Ot.from(t[i]));return new e(n)},e.fromImages=function(t){for(var n=[],i=0;i<t.length;++i)n.push(Ot.from(t[i]));return new e(n)},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof Ot)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var n=0;n<t.length;n++)this._textures.push(t[n].texture),this._durations.push(t[n].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Ci.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Ci.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),e}(Un);/*!
 * pixi.js - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Js.registerPlugin("accessibility",Xy),Js.registerPlugin("extract",Fx),Js.registerPlugin("interaction",Jy),Js.registerPlugin("particle",o1),Js.registerPlugin("prepare",w1),Js.registerPlugin("batch",Lx),Js.registerPlugin("tilingSprite",P1),as.registerPlugin(B1),as.registerPlugin(Zx),as.registerPlugin(Jx),as.registerPlugin(t1),as.registerPlugin(S1),Sd.registerPlugin(Yy),Sd.registerPlugin(Wx);var GE="6.0.4",Dd={AlphaFilter:RE,BlurFilter:LE,BlurFilterPass:T0,ColorMatrixFilter:S0,DisplacementFilter:OE,FXAAFilter:DE,NoiseFilter:NE};class HE{constructor(e){this.target=e}get color(){return this.target.strokeColorFilter.currentColor}set color(e){this.target.strokeColorFilter.color=e}get on(){return this.target.strokeActive?"true":"false"}set on(e){this.target.strokeActive=e==="true"}}class zE{constructor(e){this.target=e}applyCommand(e,t){this.target.applyCommand(e,t)}}class VE{constructor(e){this.target=e}get color(){return this.target.fillColorFilter.currentColor}set color(e){this.target.fillColorFilter.color=e}get on(){return this.target.fillActive?"true":"false"}set on(e){this.target.fillActive=e==="true"}}class jE{constructor(e,t){this.hardHidden=!1,this.target=e,t===!0&&(this.hardHidden=!0)}get opacity(){return this.target.alpha}set opacity(e){this.target.alpha=e}get rotation(){return this.target.rotation/Math.PI*180}set rotation(e){this.target.rotation=e/180*Math.PI}get visibility(){return this.target.visible?"visible":"hidden"}set visibility(e){this.visibility===e||this.hardHidden||(this.target.visible=e==="visible")}}class WE{constructor(e,t){this.actions=[],this.ctx=t,this.object=e,this.object.interactive=!0}reset(e){this.object.interactive=!1,this.object.removeAllListeners(),this.object=e,this.object.interactive=!0}addAction(e,t){this.actions.push([e,t]),t==="click"?(this.object.addListener("click",()=>this.handleAction(e)),this.object.cursor="pointer"):t==="hover"&&this.object.addListener("mouseover",()=>this.handleAction(e))}addProxy(e){this.proxy=e,this.hitArea=this.getOriginHitArea(),this.proxy.interactive=!0,this.actions.forEach(([t,n])=>{var i,o;n==="click"?(i=this.proxy)===null||i===void 0||i.addListener("click",s=>this.handleProxyAction(s,t)):n==="hover"&&((o=this.proxy)===null||o===void 0||o.addListener("mouseover",s=>this.handleProxyAction(s,t)))})}handleProxyAction(e,t){var n;const i=e.data.global,o=this.object.getGlobalPosition(),s=i.x-o.x+this.object.pivot.x,a=i.y-o.y+this.object.pivot.y;((n=this.hitArea)===null||n===void 0?void 0:n.contains(s,a))&&this.handleAction(t,!0)}getOriginHitArea(){return this.object.hitArea?this.object.hitArea:new bv(0,0,this.object.width,this.object.height)}handleAction(e,t=!1){this.proxy&&!t||(this.ctx.eventHub.emit(pn.hyperlinkTrigger,e),this.execAction(e))}execAction(e){var t;if(e.action==="ppaction://hlinksldjump"){const n=((t=e==null?void 0:e.target)!==null&&t!==void 0?t:"").match(/slide(\d+)\.xml/);n&&n[1]&&this.ctx.eventHub.emit(cs.goto,Number(n[1]))}else e.action==="ppaction://hlinkshowjump?jump=nextslide"?this.ctx.eventHub.emit(cs.next):e.action==="ppaction://hlinkshowjump?jump=previousslide"&&this.ctx.eventHub.emit(cs.prev)}}class M0{constructor(e,t,n){var i,o,s,a,h,u;this.scaleExt={x:1,y:1},this.scaleOrigin={x:1,y:1},this.designScale={x:1,y:1},this.bound=new en(0,0,1,1),this.pptX=0,this.pptY=0,this.presetSubType=0,this.designWidth=0,this.designHeight=0,this.designX=0,this.designY=0,this.hasPreset=!1,this.container=new Ti,this.ctx=t,this.style=new jE(this.container,e.hardHidden),this.designGlobalPosition={x:n.x+((o=(i=e.position)===null||i===void 0?void 0:i.x)!==null&&o!==void 0?o:0),y:n.y+((a=(s=e.position)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0)},(e.hlinkClick||e.hlinkHover)&&(this.hyperlink=new WE(this.container,this.ctx),e.hlinkHover&&((h=this.hyperlink)===null||h===void 0||h.addAction(e.hlinkHover,"hover")),e.hlinkClick&&((u=this.hyperlink)===null||u===void 0||u.addAction(e.hlinkClick,"click")))}updateScale(){this.container.scale.x=this.designScale.x*this.scaleExt.x*this.scaleOrigin.x,this.container.scale.y=this.designScale.y*this.scaleExt.y*this.scaleOrigin.y}updateTransform(e){var t,n,i,o,s,a,h,u;this.designWidth=e.width,this.designHeight=e.height,this.designX=(n=(t=e.position)===null||t===void 0?void 0:t.x)!==null&&n!==void 0?n:0,this.designY=(o=(i=e.position)===null||i===void 0?void 0:i.y)!==null&&o!==void 0?o:0;const c=this.designWidth/2,d=this.designHeight/2;this.container.width=this.designWidth,this.container.height=this.designHeight,this.container.pivot.x=c,this.container.pivot.y=d;const f=(a=(s=e.position)===null||s===void 0?void 0:s.x)!==null&&a!==void 0?a:0,m=(u=(h=e.position)===null||h===void 0?void 0:h.y)!==null&&u!==void 0?u:0;this.container.x=f+c,this.container.y=m+d,e.scale&&(this.designScale={x:e.scale.x,y:e.scale.y},this.container.scale.x=e.scale.x,this.container.scale.y=e.scale.y),e.rotation&&(this.container.rotation=e.rotation);const g=new na;g.drawRect(0,0,this.designWidth,this.designHeight),this.container.addChild(g),this.json.hardHidden&&(this.container.visible=!1),this.bound.x=f,this.bound.y=m}get scale(){return this.container.scale}set scale(e){this.scaleOrigin.x=e.x,this.scaleOrigin.y=e.y,this.updateScale()}get design_ppt_w(){return this.designWidth/this.ctx.stageWidth}get design_ppt_h(){return this.designHeight/this.ctx.stageHeight}get design_ppt_x(){return this.designX/this.ctx.stageWidth}get design_ppt_y(){return this.designY/this.ctx.stageHeight}get ppt_w(){return this.scaleExt.x*this.scaleOrigin.x*this.designWidth/this.ctx.stageWidth}set ppt_w(e){this.scaleExt.x=e*this.ctx.stageWidth/this.designWidth,this.updateScale()}get ppt_h(){return this.scaleExt.y*this.scaleOrigin.y*this.designHeight/this.ctx.stageHeight}set ppt_h(e){this.scaleExt.y=e*this.ctx.stageHeight/this.designHeight,this.updateScale()}get ppt_x(){return(this.container.position.x-this.container.pivot.x)/this.ctx.stageWidth}set ppt_x(e){this.pptX=e;const t=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=e*this.ctx.stageWidth+this.container.pivot.x*t}get ppt_y(){return(this.container.position.y-this.container.pivot.y)/this.ctx.stageHeight}set ppt_y(e){this.pptY=e;const t=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=e*this.ctx.stageHeight+this.container.pivot.y*t}get r(){return this.container.rotation}set r(e){this.container.rotation=e}}class xm{constructor(e){if(this._isInit=!1,this.h=0,this.s=0,this.l=0,this.a=1,e){this._isInit=!0;const t=e.match(/-?[0-9]+/g);t&&(this.h=parseInt(t[0],10),this.s=parseInt(t[1],10)/100,this.l=parseInt(t[2],10)/100)}}isInit(){return this._isInit}by(e,t){t.h=Math.max(Math.min(this.h+e.h,359),0),t.s=Math.max(Math.min(this.s+e.s,1),0),t.l=Math.max(Math.min(this.l+e.l,1),0),t.a=Math.max(Math.min(this.a+e.a,1),0)}fromHexString(e){const[t,n,i,o]=Ha(e);let s=0,a=0,h=0;const u=Math.max(t,n,i),c=Math.min(t,n,i),d=u-c;h=(u+c)/2,d===0?s=0:u===t?s=(n-i)/d%6*60:u===n?s=60*((i-t)/d+2):u===i&&(s=60*((t-n)/d+4)),a=d===0?0:d/(1-Math.abs(2*h-1)),this.h=s,this.s=a,this.l=h,this.a=o}interpolationFrom(e,t,n){const i=e.h+(this.h-e.h)*t,o=e.s+(this.s-e.s)*t,s=e.l+(this.l-e.l)*t,a=e.a+(this.a-e.a)*t;n.h=Math.max(Math.min(i,359),0),n.s=Math.max(Math.min(o,1),0),n.l=Math.max(Math.min(s,1),0),n.a=Math.max(Math.min(a,1),0)}toHexString(){let e=[0,0,0,0];const{h:t,s:n,l:i}=this;if(t<360&&t>=0&&n<=1&&n>=0&&i<=1&&i>=0){let o,s,a;const h=(1-Math.abs(2*i-1))*n,u=h*(1-Math.abs(t/60%2-1)),c=i-h/2;[o,s,a]=t>=0&&t<60?[h,u,0]:t>=60&&t<120?[u,h,0]:t>=120&&t<180?[0,h,u]:t>=180&&t<240?[0,u,h]:t>=240&&t<300?[u,0,h]:[h,0,u],e=[o+c,s+c,a+c,this.a]}return fb(e)}}class bm{constructor(e){this._isInit=!1,this.r=0,this.g=0,this.b=0,this.a=0,e&&(this._isInit=!0,this.fromHexString(e))}fromHexString(e){const[t,n,i,o]=Ha(e);this.r=t,this.g=n,this.b=i,this.a=o}isInit(){return this._isInit}interpolationFrom(e,t,n){n.r=e.r+(this.r-e.r)*t,n.g=e.g+(this.g-e.g)*t,n.b=e.b+(this.b-e.b)*t,n.a=e.a+(this.a-e.a)*t}by(e,t){t.r=Math.min(Math.max(this.r+e.r,0),255),t.g=Math.min(Math.max(this.g+e.g,0),255),t.b=Math.min(Math.max(this.b+e.b,0),255),t.a=Math.min(Math.max(this.a+e.a,0),1)}toHexString(){return fb([this.r,this.g,this.b,this.a])}}function Ha(r){return(r=r.replace(/^#/,"")).substring(6,8).length===0&&(r+="FF"),[parseInt(r.substring(0,2).padStart(8,"0"),16)/255,parseInt(r.substring(2,4).padStart(8,"0"),16)/255,parseInt(r.substring(4,6).padStart(8,"0"),16)/255,parseInt(r.substring(6,8).padStart(8,"0"),16)/255]}function fb(r){return"#"+Math.round(255*r[0]).toString(16).padStart(2,"0")+Math.round(255*r[1]).toString(16).padStart(2,"0")+Math.round(255*r[2]).toString(16).padStart(2,"0")+Math.round(255*r[3]).toString(16).padStart(2,"0")}function wm(r,e,t){const n=Ha(r),i=Ha(e),o=Math.round(255*(n[0]+(i[0]-n[0])*t)),s=Math.round(255*(n[1]+(i[1]-n[1])*t)),a=Math.round(255*(n[2]+(i[2]-n[2])*t)),h=Math.round(255*(n[3]+(i[3]-n[3])*t));return"#"+o.toString(16).padStart(2,"0")+s.toString(16).padStart(2,"0")+a.toString(16).padStart(2,"0")+h.toString(16).padStart(2,"0")}class mb extends Sr{constructor(){super(void 0,`
varying vec2 vTextureCoord;

uniform vec4 color;
uniform sampler2D uSampler;

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);

    if (texColor.a > 0.0) {
        vec4 resultColor = color;
        resultColor = resultColor * texColor.a;
        gl_FragColor = resultColor;
    } else {
        gl_FragColor = texColor;
    }
}
`,{color:new Float32Array([0,0,0,0]),active:0}),this.currentColor="#FFFFFFFF"}set color(e){this.currentColor=e;const t=Ha(e);this.uniforms.color=Float32Array.from(t)}get color(){return this.currentColor}}const gb=new Dd.ColorMatrixFilter;gb.matrix=[1,0,0,0,-.2,0,1,0,0,-.2,0,0,1,0,-.2,0,0,0,1,0];const vb=new Dd.ColorMatrixFilter;vb.matrix=[1,0,0,0,-.1,0,1,0,0,-.1,0,0,1,0,-.1,0,0,0,1,0];const _b=new Dd.ColorMatrixFilter;_b.matrix=[1,0,0,0,.2,0,1,0,0,.2,0,0,1,0,.2,0,0,0,1,0];const yb=new Dd.ColorMatrixFilter;yb.matrix=[1,0,0,0,.1,0,1,0,0,.1,0,0,1,0,.1,0,0,0,1,0];const XE={darken:gb,darkenLess:vb,lightenLess:yb,lighten:_b};var YE=_(3),A0=_.n(YE);class qE{constructor(e){this.scaleX=1,this.scaleY=1,this.pivot={x:0,y:0},this.paths=[],this.hash="",this.width=0,this.height=0,this.graphicsId="",this.textureId="",this.id=e.id,this.type=e.type,this.heightSize=e.heightSize,this.widthSize=e.widthSize,this.fillStyle=e.fillStyle||{fillType:"solidFill",color:"#ffffffff"},this.lineWidth=e.lineWidth||1,this.position=e.position||{x:0,y:0},this.rotate=e.rotation||1,this.path=this.getUnitPath(),this.setScaleFromLineWidth(),this.setScaleFromSize(),this.generatePaths(),this.setPivot()}setPivot(){switch(this.type){case"oval":case"diamond":this.pivot={x:this.width/2,y:this.height/2};break;case"arrow":case"stealth":case"triangle":default:this.pivot={x:this.width,y:this.height/2}}}generatePaths(){this.hash="arrow-"+A0()(this.path),this.paths=[{id:this.id,path:this.path,fill:"norm",hasStroke:!1,hash:this.hash,scale:{x:this.scaleX,y:this.scaleY}}]}getUnitPath(){switch(this.type){case"stealth":return"M 0,0 L 95250,47625 L 0,95250 L 28575,47625 C C";case"oval":return"M 0,47625 A 47625,47625,-3.14159265,6.2831853 C C";case"diamond":return"M 47625,0 L 95250,47625 L 47625,95250 L 0,47625 C C";case"arrow":return"M 9525,0 L 95250,47625 L 9525,95250 L 0,85725 L 68389.5,47625 L 0,9525 C C";case"triangle":return"M 0,0 L 95250,47625 L 0,95250 C C";default:return""}}setScaleFromLineWidth(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=.29*this.lineWidth+.7,this.scaleY*=.29*this.lineWidth+.7;break;default:throw new Error("can't match any arrow type!")}}setScaleFromSize(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=1,this.scaleY*=1;break;default:throw new Error("can't match any arrow type!")}switch(this.widthSize){case"sm":this.scaleX*=3/4;break;case"lg":this.scaleX*=1.25;break;case"med":this.scaleX*=1}switch(this.heightSize){case"sm":this.scaleY*=3/4;break;case"lg":this.scaleY*=1.25;break;case"med":this.scaleY*=1}this.width=10*this.scaleX,this.height=10*this.scaleY}}class P0 extends M0{constructor(e,t,n){super({position:{x:e.x,y:e.y},width:e.width,height:e.height},t,n),this.json=e,this.ctx=t,this.parentGlobalPos=n,this.global={x:n.x+e.x,y:n.y+e.y},this.updateTransform({position:{x:e.x,y:e.y},width:e.width,height:e.height})}get renderContainer(){return this.container}get interactiveContainer(){return this.container}getTextElement(){return null}getBgElement(){return null}get ppt_x(){return this.global.x/this.ctx.stageWidth}set ppt_x(e){const t=e*this.ctx.stageWidth-this.global.x,n=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=this.designX+t+this.container.pivot.x*n}get ppt_y(){return this.global.y/this.ctx.stageHeight}set ppt_y(e){const t=e*this.ctx.stageHeight-this.global.y,n=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=this.designY+t+this.container.pivot.y*n}get design_ppt_x(){return this.global.x/this.ctx.stageWidth}get design_ppt_y(){return this.global.y/this.ctx.stageHeight}}var ZE=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class $E extends P0{constructor(e,t,n,i,o){super(e,t,n),this.lineWidth=i,this.lineHeight=o}getIterateEntry(){return null}getBgElement(){return null}preRender(){const{fill:e}=this.json;this.fillBgId=this.ctx.fillTexture.addFill(e.fill,this.lineWidth,this.lineHeight),this.fillTextureId=this.ctx.fillTexture.addFill({fillType:"blipFill",src:e.key,filters:[]},e.width,e.height)}render(){return ZE(this,void 0,void 0,function*(){if(this.fillBgId&&this.fillTextureId){const e=new Ti,t=this.ctx.fillTexture.getTexture(this.fillBgId),n=this.ctx.fillTexture.getTexture(this.fillTextureId);if(t&&n){const i=new Un;i.texture=n,i.width=this.json.fill.width,i.height=this.json.fill.height;const o=new Un;o.texture=t,o.mask=i,e.addChild(o),e.addChild(i);const s=to.create({width:this.json.width,height:this.json.height,resolution:2});this.ctx.renderer.render(e,{renderTexture:s});const a=new Un;a.texture=s,this.container.addChild(a),this.container.name=this.json.content,e.destroy({children:!0})}}})}destroy(){this.container.destroy({children:!0,texture:!0})}}var JE=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class KE extends P0{constructor(){super(...arguments),this.units=[]}getIterateElements(){return this.units}getIterateEntry(e,t,n){return this.units[t]?this.units[t]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}preRender(){for(let e=0,t=this.json.textUnits.length;e<t;e++){const n=this.json.textUnits[e];if(n.fill.fill){const i=new $E(n,this.ctx,this.global,this.json.width,this.json.height);i.preRender(),this.units.push(i)}}}render(){return JE(this,void 0,void 0,function*(){for(const e of this.units)yield e.render(),this.container.addChild(e.container)})}destroy(){this.units.forEach(e=>{e.destroy()}),this.container.destroy({children:!1})}}var QE=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class eM extends P0{constructor(){super(...arguments),this.iterateElements=[],this.lines=[]}getIterateElements(){if(this.iterateElements.length>0)return this.iterateElements;const e=this.lines.reduce((t,n)=>t=t.concat(n.getIterateElements()),[]);return this.iterateElements=e,e}getIterateEntry(e,t,n){const i=this.getIterateElements();return i[t]?i[t]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}preRender(){for(let e=0,t=this.json.lines.length;e<t;e++){const n=this.json.lines[e],i=new KE(n,this.ctx,this.global);i.container.name="line-"+e,i.preRender(),this.lines.push(i)}}render(){return QE(this,void 0,void 0,function*(){for(const e of this.lines)yield e.render(),this.container.addChild(e.container)})}destroy(){this.lines.forEach(e=>{e.destroy()}),this.container.destroy({children:!1})}}var tM=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class nM{constructor(e,t,n,i){this.iterateElements=[],this.paragraphs=[],this.container=new Ti,this.json=e,this.ctx=t,this.parentGlobalPos=i,this.iterateType=n,this.container.name="textBody",this.global={x:this.parentGlobalPos.x+e.position.x,y:this.parentGlobalPos.y+e.position.y}}getTextElement(e,t){return e==="paragraph"?this.paragraphs[t[0]]:null}getIterateEntry(e,t){return this.iterateElements[e]?this.iterateElements[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",t),null)}destroy(){this.paragraphs.forEach(e=>{e.destroy()})}preRender(){for(let e=0,t=this.json.paragraphs.length;e<t;e++){const n=this.json.paragraphs[e],i=new eM(n,this.ctx,this.global);i.preRender(),this.iterateElements=this.iterateElements.concat(i.getIterateElements()),i.container.name="\u6BB5\u843D-"+e,this.paragraphs.push(i)}}render(){return tM(this,void 0,void 0,function*(){for(const e of this.paragraphs)yield e.render(),this.container.addChild(e.container)})}}var iM=_(15),rM=_.n(iM),oM=_(16),sM=_.n(oM);const aM={Reflection:class extends Sr{constructor(r){super(rM.a,sM.a,{uShapeFilterArea:new Float32Array([0,0,0,0]),uStartAlpha:r.startAlpha,uEndAlpha:r.endAlpha,uBlur:0}),this.json=r}}};var Nd=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};const Fd={pivot:{x:0,y:0},width:0,height:0};class xb extends M0{constructor(e,t,n){var i,o,s;super(e,t,n),this.renderContainer=new Ti,this.bgTextureId="",this.bgSprite=new Un,this.backgroundMaskTextureId="",this.filterAreaJustifies=[],this.backgroundMask=new Un,this.pathStrokeTextureId="",this.pathSprite=new Un,this.pathMask=new Un,this.pathMaskTextureId="",this.fillColorFilter=new mb,this.strokeColorFilter=new mb,this.id="",this.arrowList=[],this.fill=new VE(this),this.stroke=new HE(this),this.updateFilterArea=()=>{const a=this.renderContainer.getBounds(!1),h=this.filterAreaJustifies.map(f=>f(a)),u=h.map(f=>f.width),c=h.map(f=>f.height),d=new en(a.x,a.y,Math.max(...u),Math.max(...c));this.renderContainer.filterArea=d,this.renderContainer.filters.forEach(f=>{f.uniforms.uShapeFilterArea=new Float32Array(4),f.uniforms.uShapeFilterArea[0]=d.x,f.uniforms.uShapeFilterArea[1]=d.y,f.uniforms.uShapeFilterArea[2]=d.width,f.uniforms.uShapeFilterArea[3]=d.height})},this.json=e,this.id=e.id,this.container.name=e.id,this.fillStyle=e.fillStyle,this.lineStyle=e.lineStyle,this.geometry=e.geometry,this.ctx.timingTargets.addTarget(this.id,this),((i=this.fillStyle)===null||i===void 0?void 0:i.fillType)==="solidFill"&&(this.fillColorFilter.currentColor=this.fillStyle.color),((s=(o=this.lineStyle)===null||o===void 0?void 0:o.fill)===null||s===void 0?void 0:s.fillType)==="solidFill"&&(this.strokeColorFilter.currentColor=this.lineStyle.fill.color),this.pathSprite.name="path-fill",this.pathMask.name="path-mask",this.bgSprite.name="bg-fill",this.backgroundMask.name="bg-mask",this.updateTransform(this.json),e.textBody&&(this.text=new nM(e.textBody,this.ctx,e.textBody.iterateType,{x:this.designGlobalPosition.x,y:this.designGlobalPosition.y}))}get interactiveContainer(){return this.renderContainer}get strokeActive(){var e,t;return((t=(e=this.pathSprite.filters)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:-1)>0}set strokeActive(e){var t,n;e?((n=(t=this.pathSprite.filters)===null||t===void 0?void 0:t.indexOf(this.strokeColorFilter))!==null&&n!==void 0?n:-1)<0&&(this.pathSprite.filters=[this.strokeColorFilter]):this.pathSprite.filters=[]}get fillActive(){var e,t;return((t=(e=this.bgSprite.filters)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:-1)>0}set fillActive(e){var t,n;e?((n=(t=this.bgSprite.filters)===null||t===void 0?void 0:t.indexOf(this.fillColorFilter))!==null&&n!==void 0?n:-1)<0&&(this.bgSprite.filters=[this.fillColorFilter]):this.bgSprite.filters=[]}getTextElement(e,t){var n,i;return(i=(n=this.text)===null||n===void 0?void 0:n.getTextElement(e,t))!==null&&i!==void 0?i:null}getBgElement(){return this}getIterateEntry(e,t,n){return e==="el"||t===0?this:this.text?this.text.getIterateEntry(t-1,n)||null:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}createBackgroundMask(){return Nd(this,void 0,void 0,function*(){const e=this.ctx.graphicsTexture.getGraphicsData(this.backgroundMaskTextureId);e&&(this.backgroundMask.texture=e.texture,this.backgroundMask.pivot.x=e.pivot.x,this.backgroundMask.pivot.y=e.pivot.y)})}createBackground(){var e,t,n,i,o,s,a;const{pivot:h,width:u,height:c}=((e=this.geometry)===null||e===void 0?void 0:e.fillTransform)||Fd;if(((t=this.fillStyle)===null||t===void 0?void 0:t.fillType)==="gifFill"){const d=this.ctx.fillTexture.getGifFrames(this.fillStyle.src);this.bgSprite=new E0(d,!0),this.bgSprite.play();const f=this.fillStyle.fps/this.ctx.ticker.maxFPS;this.bgSprite.animationSpeed=f,this.bgSprite.height=c||this.designHeight,this.bgSprite.width=u||this.designWidth,this.bgSprite.mask=this.backgroundMask,this.bgSprite.x=h.x,this.bgSprite.y=h.y,this.container.addChild(this.backgroundMask),this.container.addChild(this.bgSprite)}else if(((n=this.fillStyle)===null||n===void 0?void 0:n.fillType)==="groupFill"){if(this.groupFillTextureId){const d=this.ctx.fillTexture.getTexture(this.groupFillTextureId);d&&(this.bgSprite.texture=d,this.bgSprite.mask=this.backgroundMask,this.bgSprite.x=-1*((o=(i=this.json.position)===null||i===void 0?void 0:i.x)!==null&&o!==void 0?o:0),this.bgSprite.y=-1*((a=(s=this.json.position)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0),this.container.addChild(this.bgSprite),this.container.addChild(this.backgroundMask))}}else{const d=this.ctx.fillTexture.getTexture(this.bgTextureId);d&&(this.bgSprite.texture=d,this.bgSprite.mask=this.backgroundMask,this.container.addChild(this.backgroundMask),this.container.addChild(this.bgSprite),this.bgSprite.height=c||this.designHeight,this.bgSprite.width=u||this.designWidth,this.bgSprite.x=h.x,this.bgSprite.y=h.y)}}createPathFill(){const e=this.ctx.fillTexture.getTexture(this.pathStrokeTextureId);e&&(this.pathSprite.texture=e,this.pathSprite.pivot.x=this.pathMask.pivot.x,this.pathSprite.pivot.y=this.pathMask.pivot.y,this.pathMask.pivot.x=0,this.pathMask.pivot.y=0,this.pathSprite.mask=this.pathMask,this.pathSprite.addChild(this.pathMask),this.container.addChild(this.pathSprite))}createPathMask(){return Nd(this,void 0,void 0,function*(){const e=this.ctx.graphicsTexture.getGraphicsData(this.pathMaskTextureId);if(e){const{texture:t,pivot:n}=e;this.pathMask.texture=t,this.pathMask.pivot.x=n.x,this.pathMask.pivot.y=n.y,this.pathMask.texture=t}})}createFilledPathMask(){var e,t;return Nd(this,void 0,void 0,function*(){const n=((t=(e=this.geometry)===null||e===void 0?void 0:e.paths)===null||t===void 0?void 0:t.filter(i=>i.fill!=="none"&&i.fill!=="norm"))||[];for(const i of n){const o=this.ctx.graphicsTexture.getGraphicsData(i.id);if(o){const s=new Un(o.texture);s.pivot.x=o.pivot.x,s.pivot.y=o.pivot.y;const a=new Un(this.bgSprite.texture);a.pivot.x=this.bgSprite.pivot.x,a.pivot.y=this.bgSprite.pivot.y,a.mask=s,a.filters=[XE[i.fill]],this.container.addChild(a),this.container.addChild(s)}}})}createBackgroundTexture(){var e,t,n,i,o;if(this.fillStyle&&this.fillStyle.fillType!=="gifFill"&&this.fillStyle.fillType!=="groupFill"){const s=((e=this.geometry)===null||e===void 0?void 0:e.fillTransform)||Fd,a=(s==null?void 0:s.width)||this.designWidth,h=(s==null?void 0:s.height)||this.designHeight;this.bgTextureId=this.ctx.fillTexture.addFill(this.fillStyle,a+((n=(t=this.lineStyle)===null||t===void 0?void 0:t.width)!==null&&n!==void 0?n:0),h+((o=(i=this.lineStyle)===null||i===void 0?void 0:i.width)!==null&&o!==void 0?o:0))}}createPathFillTexture(){var e,t,n,i,o,s;if(((e=this.lineStyle)===null||e===void 0?void 0:e.fill)&&this.lineStyle.fill.fillType!=="gifFill"&&this.lineStyle.fill.fillType!=="groupFill"){const{width:a,height:h}=((t=this.geometry)===null||t===void 0?void 0:t.lineTransform)||Fd;this.pathStrokeTextureId=this.ctx.fillTexture.addFill(this.lineStyle.fill,(a||this.designWidth)+((i=(n=this.lineStyle)===null||n===void 0?void 0:n.width)!==null&&i!==void 0?i:0),(h||this.designHeight)+((s=(o=this.lineStyle)===null||o===void 0?void 0:o.width)!==null&&s!==void 0?s:0))}}createArrowFillTexture(){var e;(e=this.json.lineArrowList)===null||e===void 0||e.forEach(t=>{var n,i,o;const s=new qE(Object.assign(Object.assign({},t),{fillStyle:(n=this.lineStyle)===null||n===void 0?void 0:n.fill,lineWidth:(i=this.lineStyle)===null||i===void 0?void 0:i.width}));s.graphicsId=this.ctx.graphicsTexture.addGraphics((o=s.paths)!==null&&o!==void 0?o:[],s.hash,s.pivot||{x:0,y:0},s.width,s.height,void 0,!0),s.textureId=this.ctx.fillTexture.addFill(s.fillStyle,s.width,s.height),this.arrowList.push(s)})}createArrow(){this.arrowList.forEach(e=>{const t=this.ctx.graphicsTexture.getGraphicsData(e.graphicsId),n=this.ctx.fillTexture.getTexture(e.textureId);if(t&&n){const{texture:i,pivot:o}=t,s=new Un(i);s.pivot.x=o.x,s.pivot.y=o.y;const a=new Un(n);a.addChild(s),a.mask=s,a.position.x=e.position.x,a.position.y=e.position.y,a.pivot.x=e.pivot.x,a.pivot.y=e.pivot.y,a.width=e.width,a.height=e.height,a.rotation=e.rotate/180*Math.PI,e.sprite=a,this.container.addChild(a)}})}preRender(){var e,t,n,i,o,s,a,h,u,c;this.createBackgroundTexture(),this.createPathFillTexture(),this.createArrowFillTexture();const{width:d,height:f,pivot:m}=((e=this.geometry)===null||e===void 0?void 0:e.lineTransform)||Fd,g=d||this.designWidth,v=f||this.designHeight;((t=this.geometry)===null||t===void 0?void 0:t.paths)&&this.geometry.paths.length>0&&(this.pathMaskTextureId=this.ctx.graphicsTexture.addGraphics((i=(n=this.geometry)===null||n===void 0?void 0:n.paths)!==null&&i!==void 0?i:[],this.geometry.hash,m||{x:0,y:0},g,v,this.lineStyle,!1),this.backgroundMaskTextureId=this.ctx.graphicsTexture.addGraphics((s=(o=this.geometry)===null||o===void 0?void 0:o.paths)!==null&&s!==void 0?s:[],this.geometry.hash,m||{x:0,y:0},g,v,this.lineStyle,!0));const x=((h=(a=this.geometry)===null||a===void 0?void 0:a.paths)===null||h===void 0?void 0:h.filter(T=>T.fill!=="none"&&T.fill!=="norm"))||[];for(const T of x)this.ctx.graphicsTexture.addGraphics([T],T.hash,(((u=this.geometry)===null||u===void 0?void 0:u.lineTransform)||Fd).pivot,g,v,this.lineStyle,!0,T.id);(c=this.text)===null||c===void 0||c.preRender()}subClassRender(){return Nd(this,void 0,void 0,function*(){})}setupEffect(){const{effectList:e}=this.json;if(e&&e.length>0){const t=[];return e.forEach(n=>{n.type==="reflection"&&(this.filterAreaJustifies.push(i=>(i.height*=2,i)),t.push(new aM.Reflection(n)))}),this.ctx.ticker.add(this.updateFilterArea,void 0,-20),this.renderContainer.filters=t,!0}return!1}render(){var e,t,n,i,o,s,a;return Nd(this,void 0,void 0,function*(){yield this.createBackgroundMask(),yield this.createBackground(),yield this.subClassRender(),yield this.createFilledPathMask(),yield this.createPathMask(),yield this.createPathFill(),yield this.createArrow(),this.text&&(yield this.text.render()),((e=this.json.textBody)===null||e===void 0?void 0:e.iterateType)==="wd"||((t=this.json.textBody)===null||t===void 0?void 0:t.iterateType)==="lt"?(this.renderContainer.addChild(this.container),this.text&&(this.text.container.position.x=(i=(n=this.json.position)===null||n===void 0?void 0:n.x)!==null&&i!==void 0?i:0,this.text.container.position.y=(s=(o=this.json.position)===null||o===void 0?void 0:o.y)!==null&&s!==void 0?s:0,this.renderContainer.addChild(this.text.container))):(this.text&&this.container.addChild((a=this.text)===null||a===void 0?void 0:a.container),this.renderContainer.addChild(this.container));const h=this.setupEffect();this.json.cacheAsBitMap&&!h&&(this.renderContainer.cacheAsBitmap=!0)})}destroy(){this.bgSprite.destroy(),this.backgroundMask.destroy(),this.pathSprite.destroy(),this.pathMask.destroy(),this.fillColorFilter.destroy(),this.strokeColorFilter.destroy(),this.arrowList.forEach(e=>{var t;(t=e.sprite)===null||t===void 0||t.destroy()})}}var R0=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};function ia(r,e){for(const t in e)r.style[t]=e[t]}class Bd{constructor(e){var t,n;this.isPlaying=!1,this.progress=document.createElement("div"),this.totalTime=document.createElement("span"),this.playButton=document.createElement("div"),this.pauseButton=document.createElement("div"),this.currentTime=document.createElement("span"),this.mediaController=document.createElement("div"),this.currentProgress=document.createElement("div"),this.playCallBackList=[],this.duration=0,this.start=0,this.end=0,this.changeMediaProgress=i=>{i.stopPropagation();const o=i.offsetX/this.progress.clientWidth*this.duration;this.jumpToTime(o)},this.jumpToTime=(i=0)=>{this.mediaEl.currentTime=Math.floor(i)+this.start,(this.mediaEl.paused||this.mediaEl.ended)&&this.mediaEl.play().then(()=>this.mediaEl.pause())},this.showController=i=>{i.stopPropagation(),this.show()},this.getMediaDuration=()=>{this.duration&&!Number.isNaN(this.duration)||(this.duration=this.mediaEl.duration,this.end?this.start?this.duration=this.duration-this.end-this.start:this.duration-=this.end:this.start&&(this.duration-=this.start)),this.totalTime.innerText=Bd.formatTime(this.duration)},this.playMedia=()=>R0(this,void 0,void 0,function*(){this.isPlaying=!0,this.playButton.style.display="none",this.pauseButton.style.display="block",yield this.mediaEl.play(),this.playCallBackList.forEach(i=>{i()})}),this.pauseMedia=()=>R0(this,void 0,void 0,function*(){this.isPlaying=!1,this.playButton.style.display="block",this.pauseButton.style.display="none",yield this.mediaEl.pause()}),this.onMouseOut=i=>{i.stopPropagation(),this.mediaController.style.display="none"},this.mediaTimeUpdate=()=>R0(this,void 0,void 0,function*(){const i=this.mediaEl.currentTime-this.start;(i>this.duration||this.mediaEl.ended)&&(yield this.pauseMedia(),this.jumpToTime()),this.currentTime.innerText=Bd.formatTime(i),this.currentProgress.style.flex=(i/this.duration).toString()}),this.onPauseMedia=()=>{this.isPlaying=!1,this.playButton.style.display="block",this.pauseButton.style.display="none"},this.onPlayMedia=()=>{this.isPlaying=!0,this.playButton.style.display="none",this.pauseButton.style.display="block",this.playCallBackList.forEach(i=>{i()})},this.height=e.height,this.width=e.width,this.position=e.position,this.mediaEl=e.mediaEl,this.info=e.info,window.media=this.mediaEl,this.getMedianContainer(),this.createMediaController(),this.info.cut&&(this.start=(t=this.info.cut.start)!==null&&t!==void 0?t:0,this.end=(n=this.info.cut.end)!==null&&n!==void 0?n:0)}getMedianContainer(){let e=document.getElementById("median-container");e||(e=document.createElement("div"),e.id="median-container",document.body.appendChild(e)),this.container=e}static formatTime(e){let t="00:00";if(e){const n=Math.floor(e/60),i=String(n<0?0:n).padStart(2,"0"),o=Math.floor(e%60);t=`${i}:${String(o<0?0:o).padStart(2,"0")}`}return t}createButton(){const e={marginLeft:"15px",marginRight:"10px",fontSize:"0",height:"20px"};ia(this.playButton,Object.assign(Object.assign({},e),{display:"block"}));const t=document.createElement("img");ia(t,{height:"20px"}),t.src="https://convertcdn.netless.link/publicFiles/icon/play.png",this.playButton.appendChild(t),ia(this.pauseButton,Object.assign(Object.assign({},e),{display:"none"}));const n=document.createElement("img");ia(n,{height:"20px"}),n.src="https://convertcdn.netless.link/publicFiles/icon/pause.png",this.pauseButton.appendChild(n)}createTimer(){const e=document.createElement("div");ia(e,{width:"100px"}),this.currentTime.innerText="00:00";const t=document.createElement("span");return t.innerText="/",e.append(this.currentTime,t,this.totalTime),e}createProgress(){ia(this.progress,{flex:"1",position:"relative",marginRight:"10px"});const e=document.createElement("div");ia(e,{background:"#D9D9D9",position:"relative",height:"10px",display:"flex"}),this.progress.appendChild(e),ia(this.currentProgress,{background:"#4F4F4F",top:"0px",left:"0",height:"10px",flex:"0"}),e.appendChild(this.currentProgress)}bindEvent(){this.mediaController.addEventListener("mouseover",this.showController,!1),this.mediaController.addEventListener("mouseout",this.onMouseOut,!1),this.progress.addEventListener("mousedown",this.changeMediaProgress,!1),this.playButton.addEventListener("click",this.playMedia,!1),this.pauseButton.addEventListener("click",this.pauseMedia,!1),this.mediaEl.addEventListener("durationchange",this.getMediaDuration,!1),this.mediaEl.addEventListener("timeupdate",this.mediaTimeUpdate,!1),this.mediaEl.addEventListener("pause",this.onPauseMedia,!1),this.mediaEl.addEventListener("play",this.onPlayMedia,!1)}createMediaController(){const{height:e,position:t}=this;ia(this.mediaController,{height:"50px",borderRadius:"50px",width:"300px",flexDirection:"row",alignItems:"center",position:"absolute",left:t.x+"px",top:t.y+e+"px",display:"none",background:"#fff"}),this.createButton();const n=this.createTimer();this.createProgress(),this.mediaController.append(this.playButton,this.pauseButton,n,this.progress),this.container.appendChild(this.mediaController),this.bindEvent()}addPlayCallBack(e){this.playCallBackList.push(e)}unbindEvent(){this.mediaController.removeEventListener("mouseover",this.showController,!1),this.progress.removeEventListener("mousedown",this.changeMediaProgress,!1),this.playButton.removeEventListener("click",this.playMedia,!1),this.pauseButton.removeEventListener("click",this.pauseMedia,!1),this.mediaEl.removeEventListener("canplay",this.getMediaDuration,!1),this.mediaEl.removeEventListener("timeupdate",this.mediaTimeUpdate,!1),this.mediaEl.removeEventListener("pause",this.pauseMedia,!1),this.mediaEl.removeEventListener("play",this.playMedia,!1)}show(){this.mediaController.style.display="flex"}hide(){this.mediaController.style.display="none"}destroy(){var e;this.unbindEvent(),this.playCallBackList=[],(e=this.container)===null||e===void 0||e.removeChild(this.mediaController)}}var hM=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class uM{constructor(e){var t,n;this.type="video",this.sprite=new Un,this.video=e.video,this.start=(t=e.video.cut)===null||t===void 0?void 0:t.start,this.end=(n=e.video.cut)===null||n===void 0?void 0:n.end,this.container=e.container,this.videoResource=new Kf(this.video.src,{autoLoad:!0,autoPlay:!1,updateFPS:30,crossorigin:!0});const{video:i,width:o,height:s,position:a}=e;this.controller=new Bd({width:o,height:s,position:a,mediaEl:this.videoResource.source,info:i}),this.controller.addPlayCallBack(()=>{this.sprite.width=o,this.sprite.height=s,setTimeout(()=>{this.sprite.visible=!0},50)});const h=new mn(null,{height:s,width:o});h.resource=this.videoResource,this.videoResource.bind(h),this.sprite=new Un,this.sprite.visible=!1,this.sprite.texture=new Ot(h),this.sprite.interactive=!0,this.container.addChild(this.sprite),this.sprite.on("mouseover",u=>{u.stopPropagation(),this.controller.show()}),this.sprite.on("mouseout",u=>{u.stopPropagation(),this.controller.hide()})}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){var e;return hM(this,void 0,void 0,function*(){yield((e=this.videoResource)===null||e===void 0?void 0:e.source).play()})}pause(){var e;((e=this.videoResource)===null||e===void 0?void 0:e.source).pause()}togglePause(){this.controller.isPlaying?this.pause():this.play()}seek(e){this.controller.jumpToTime(e)}destroy(){var e;this.sprite.interactive=!1,this.sprite.destroy({texture:!0,baseTexture:!0}),(e=this.videoResource)===null||e===void 0||e.destroy(),this.controller.destroy()}}var lM=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class cM{constructor(e){this.type="audio",this.audio=e.audio,this.container=e.container,this.container=e.container,this.audioEl=document.createElement("audio"),this.audioEl.src=this.audio.src,e.audio.cut&&(this.start=e.audio.cut.start,this.end=e.audio.cut.end);const{width:t,height:n,position:i}=e;this.controller=new Bd({height:n,width:t,position:i,mediaEl:this.audioEl,info:this.audio})}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){return lM(this,void 0,void 0,function*(){yield this.audioEl.play()})}pause(){this.audioEl.pause()}togglePause(){this.controller.isPlaying?this.pause():this.play()}seek(e){this.controller.jumpToTime(e)}destroy(){this.audioEl.pause(),this.controller.destroy()}}var bb=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class dM extends xb{constructor(e,t,n){super(Object.assign(Object.assign({},e),{type:"Shape"}),t,n),this.picTextureId="",this.picSprite=new Un,this.picMask=new Un,this.cmd=new zE(this),this.picFill=e.picFill,this.media=e==null?void 0:e.media}applyCommand(e,t){var n,i,o,s,a,h;if(t==="call")if(/playFrom\(([0-9.]+)\)/.test(e)){const u=e.match(/playFrom\(([0-9.]+)\)/),c=Number(u[1]||"0");(n=this.mediaPlayer)===null||n===void 0||n.play(),(i=this.mediaPlayer)===null||i===void 0||i.seek(c)}else e==="custom-pause"?(o=this.mediaPlayer)===null||o===void 0||o.pause():e==="togglePause"?(s=this.mediaPlayer)===null||s===void 0||s.togglePause():e==="stop"&&((a=this.mediaPlayer)===null||a===void 0||a.pause(),(h=this.mediaPlayer)===null||h===void 0||h.seek(0))}renderPic(){var e,t,n;return bb(this,void 0,void 0,function*(){const i=this.ctx.fillTexture.getTexture(this.picTextureId);i&&(this.picSprite.texture=i),this.picMask.texture=this.backgroundMask.texture,this.picSprite.mask=this.picMask,this.picSprite.width=this.designWidth,this.picSprite.height=this.designHeight,this.container.addChild(this.picSprite),this.container.addChild(this.picMask),((e=this.media)===null||e===void 0?void 0:e.type)==="video"?(this.mediaPlayer=new uM({video:this.media,height:this.designHeight,width:this.designWidth,position:this.picSprite.getGlobalPosition(),container:this.container}),((t=this.mediaPlayer)===null||t===void 0?void 0:t.sprite)&&(this.mediaPlayer.sprite.mask=this.picMask)):((n=this.media)===null||n===void 0?void 0:n.type)==="audio"&&(this.mediaPlayer=new cM({audio:this.media,height:this.designHeight,width:this.designWidth,position:this.picSprite.getGlobalPosition(),container:this.container})),this.mediaPlayer&&(this.picSprite.interactive=!0,this.picSprite.on("mouseover",()=>{this.mediaPlayer.showController()}),this.picSprite.on("mouseout",()=>{this.mediaPlayer.hideController()},!1))})}preRender(){if(super.preRender(),this.picFill.fillType!=="gifFill")this.picTextureId=this.ctx.fillTexture.addFill(this.picFill,this.designWidth,this.designHeight);else{const e=this.ctx.fillTexture.getGifFrames(this.picFill.src);this.picSprite=new E0(e,!0),this.picSprite.play();const t=this.picFill.fps/this.ctx.ticker.maxFPS;this.picSprite.animationSpeed=t}}subClassRender(){return bb(this,void 0,void 0,function*(){yield this.renderPic()})}destroy(){this.mediaPlayer&&(this.picSprite.interactive=!1,this.mediaPlayer.destroy(),this.mediaPlayer=void 0),this.picSprite.destroy(),this.picMask.destroy()}}var pM=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class C0 extends M0{constructor(e,t,n){var i,o,s,a;super(e,t,n),this.children=[],this.cacheSprite=new Un,this.json=e,this.container.name=e.id,this.ctx.timingTargets.addTarget(e.id,this);const h={x:(o=(i=e.position)===null||i===void 0?void 0:i.x)!==null&&o!==void 0?o:0,y:(a=(s=e.position)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0};e.children.forEach(u=>{let c=null;(u==null?void 0:u.type)==="Shape"?c=new xb(u,this.ctx,h):(u==null?void 0:u.type)==="Picture"?c=new dM(u,this.ctx,h):(u==null?void 0:u.type)==="Container"&&(c=new C0(u,this.ctx,h)),c&&this.children.push(c)}),this.updateTransform(this.json)}get interactiveContainer(){return this.container}get renderContainer(){return this.container}preRender(){if(this.json.fillStyle)if(this.json.fillStyle.fillType==="groupFill")this.fillTextureId=this.groupFillTextureId;else{const{fillStyle:e,width:t,height:n}=this.json;this.fillTextureId=this.ctx.fillTexture.addFill(e,t,n)}for(const e of this.children)e.groupFillTextureId=this.fillTextureId,e.preRender()}getBgElement(){return null}getIterateEntry(){return null}getTextElement(){return null}render(){var e;return pM(this,void 0,void 0,function*(){const t=new Ti;for(const n of this.children)yield n.render(),n.renderContainer&&t.addChild(n.renderContainer),(n.json.hlinkHover||n.json.hlinkClick)&&((e=n.hyperlink)===null||e===void 0||e.addProxy(this.container));if(this.container.addChild(t),this.json.cacheAsTexture){const n=t.getBounds(),i=Math.min(n.x,this.designX,n.x+n.width,this.designX+this.designWidth),o=Math.max(n.x,this.designX,n.x+n.width,this.designX+this.designWidth),s=Math.min(n.y,this.designY,n.y+n.height,this.designY+this.designHeight),a=o-i,h=Math.max(n.y,this.designY,n.y+n.height,this.designY+this.designHeight)-s,u=this.designX-n.x,c=this.designY-n.y,d=to.create({width:a,height:h});t.position.x=u,t.position.y=c,this.ctx.renderer.render(t,{renderTexture:d}),this.cacheSprite.texture=d,this.cacheSprite.position.x=-u,this.cacheSprite.position.y=-c,this.container.addChild(this.cacheSprite),t.position.x=0,t.position.y=0,t.visible=!1}})}destroy(){this.cacheSprite&&this.cacheSprite.destroy({texture:!0}),this.children.forEach(e=>e.destroy()),this.container.destroy()}}class Ud extends B.a{constructor(e,t,n,i){super(),this.cond={},this.timeoutIds=[],this.condHandle=o=>{if(o)if(o.delay&&o.delay>0){const s=this.setTimeout(()=>{o.event&&(this.cond[o.event]=!0,this.detectTrigger())},o.delay);this.timeoutIds.push(s)}else this.cond[o.event]=!0,this.detectTrigger();else this.detectTrigger()},this.id=e,this.ctx=i,this.eventHubs=n,t.forEach(o=>{this.addCond(o)})}setTriggerParams(e){this.triggerParams=e}addCond(e){const t=()=>this.condHandle(e);e.event&&(/^shape/.test(e.event)||/^time/.test(e.event)?(this.cond[e.event]=!1,this.eventHubs.global.addListener(e.event,t)):/^runtime/.test(e.event)?(this.cond[e.event]=!1,this.eventHubs.runtime.addListener(e.event,t)):/^self/.test(e.event)?e.delay&&e.delay>0&&(this.cond[e.event]=!1,this.eventHubs.runtime.addListener(e.event,t)):this.cond[e.event]=!1)}setTimeout(e,t){let n=0;const i=o=>{n+=o/(Et.TARGET_FPMS||.06),n>=t&&(e(),this.ctx.ticker.remove(i))};return this.ctx.ticker.add(i,void 0,-9),()=>{this.ctx.ticker.remove(i)}}isTrigger(){return Object.keys(this.cond).every(e=>!!this.cond[e])}isTriggerWithoutParent(){return Object.keys(this.cond).filter(e=>e!=="self").every(e=>!!this.cond[e])}detectTrigger(){if(Object.keys(this.cond).every(e=>!!this.cond[e])){Object.keys(this.cond).forEach(t=>{this.cond[t]=!1});const e=this.triggerParams;this.triggerParams=void 0,this.emit("active",e)}}reset(){Object.keys(this.cond).forEach(e=>{this.cond[e]=!1}),this.timeoutIds.forEach(e=>e())}}class fM extends B.a{constructor(e){super(),this.runtimeNodeEventHub=new B.a,this._currentSeqIndex=0,this._currentSeqState="idle",this.isForward=!0,this.autoPlay=!1,this.handlePrev=()=>{var d,f,m,g,v,x;this.hasPrev()||!this.isMainSeq?this.currentSeqState==="idle"?(this.decrSeqIndex(),(d=this.commonTimeNode.children[this.currentSeqIndex])===null||d===void 0||d.commonTimeNode.seekToStart(),(f=this.commonTimeNode.children[this.currentSeqIndex])===null||f===void 0||f.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="running"?((m=this.commonTimeNode.children[this.currentSeqIndex])===null||m===void 0||m.commonTimeNode.seekToStart(),(g=this.commonTimeNode.children[this.currentSeqIndex])===null||g===void 0||g.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="end"&&(this.currentSeqIndex>=this.commonTimeNode.children.length&&(this.currentSeqIndex=this.commonTimeNode.children.length-1),(v=this.commonTimeNode.children[this.currentSeqIndex])===null||v===void 0||v.commonTimeNode.seekToStart(),(x=this.commonTimeNode.children[this.currentSeqIndex])===null||x===void 0||x.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.globalEventHub.emit("c:prev slide")},this.handleNext=()=>{var d,f,m,g;this.hasNext()||!this.isMainSeq?this.currentSeqState==="idle"?(d=this.commonTimeNode.children[this.currentSeqIndex])===null||d===void 0||d.commonTimeNode.startTimeNodeForce():this.currentSeqState==="running"?((f=this.commonTimeNode.children[this.currentSeqIndex])===null||f===void 0||f.commonTimeNode.seekToEnd(!1,!0),this.currentSeqState="end",this.incrSeqIndex(),(m=this.commonTimeNode.children[this.currentSeqIndex])===null||m===void 0||m.commonTimeNode.startTimeNodeForce()):this.currentSeqState==="end"&&(this.incrSeqIndex(),(g=this.commonTimeNode.children[this.currentSeqIndex])===null||g===void 0||g.commonTimeNode.startTimeNodeForce()):this.globalEventHub.emit("c:next slide")};const{json:t,iterateType:n,isIterate:i,isSub:o,parent:s,ctx:a,eventHub:h,iterateIndex:u,iterateId:c}=e;this.isMainSeq=t.ctn.nodeType==="mainSeq",this.id=t.ctn.id,this.isIterate=i,this.json=t,this.ctx=a,this.globalEventHub=h,this.commonTimeNode=new zl({json:t.ctn,isSub:o,eventHubs:{global:h,runtime:this.runtimeNodeEventHub},ctx:a,parent:s,isIterate:!1,iterateType:n,iterateIndex:u,iterateId:c}),this.bindShapeEvent(),this.nextConds=new Ud("mainSeq",t.nextCondLst,{global:h,runtime:this.runtimeNodeEventHub},this.ctx),this.prevConds=new Ud("mainSeq",t.preCondLst,{global:h,runtime:this.runtimeNodeEventHub},this.ctx),this.commonTimeNode.on("timeNodeRestart",()=>{this.currentSeqIndex=0,this.currentSeqState="idle"}),this.commonTimeNode.on("childTimeNodeStart",d=>{const f=this.commonTimeNode.children.findIndex(m=>m.commonTimeNode.uuid===d.id);f>=0&&(this.currentSeqIndex=f),this.currentSeqState="running",this.isMainSeq&&this.ctx.eventHub.emit(pn.mainSeqStepStart,f)}),this.commonTimeNode.on("childTimeNodeEnd",d=>{const f=this.commonTimeNode.children.findIndex(m=>m.commonTimeNode.uuid===d.id);f>=0&&(this.currentSeqIndex=f),this.currentSeqState="end",this.autoPlay&&this.handleNext(),this.isMainSeq&&this.ctx.eventHub.emit(pn.mainSeqStepEnd,f)}),this.commonTimeNode.on("timeNodeEndSync",()=>{this.commonTimeNode.resetForRepeat(),setTimeout(()=>{this.currentSeqState="idle",this.currentSeqIndex=0})}),this.nextConds.on("active",this.handleNext),this.prevConds.on("active",this.handlePrev)}get currentSeqIndex(){return this._currentSeqIndex}set currentSeqIndex(e){this._currentSeqIndex=e,this.isMainSeq&&this.ctx.eventHub.emit(pn.mainSeqStepChange,e)}get currentSeqState(){return this._currentSeqState}set currentSeqState(e){this._currentSeqState=e,this.isMainSeq&&this.ctx.eventHub.emit(pn.mainSeqStateChange,e)}get stepLength(){return this.commonTimeNode.children.length}get currentStep(){return this.currentSeqIndex}get currentState(){return this.currentSeqState}startAutoPlay(){this.autoPlay=!0,this.commonTimeNode.children[0].commonTimeNode.startTimeNodeForce()}incrSeqIndex(){this.currentSeqIndex+1<=this.commonTimeNode.children.length&&(this.currentSeqIndex+=1)}decrSeqIndex(){this.currentSeqIndex-1>=-1&&(this.currentSeqIndex-=1)}hasPrev(){return!(this.currentSeqIndex<=0&&this.currentSeqState==="idle")}hasNext(){return!(this.currentSeqIndex>=this.commonTimeNode.children.length||this.currentSeqIndex===this.commonTimeNode.children.length-1&&this.currentSeqState==="end")}bindShapeEvent(){this.json.ctn.nodeType==="interactiveSeq"&&this.json.nextCondLst.forEach(e=>{if(/^shape/.test(e.event)){const t=e.event.split(" ")[1];if(t){const n=this.ctx.timingTargets.getTargetById(t);n&&(n.interactiveContainer.interactive=!0,n.interactiveContainer.cursor="pointer",n.interactiveContainer.on("pointerdown",()=>{const i=`shape ${t} onClick`;this.ctx.eventHub.emit(pn.interactiveAnimTrigger,{action:i,seqId:this.json.ctn.id}),this.globalEventHub.emit(i)}))}}})}setCurrentStep(e,t){let n=e;this.commonTimeNode.seekToStart();const{length:i}=this.commonTimeNode.children;if(n===-1&&(n=i-1),n>=0&&n<i)for(let o=0;o<=n;o++){const s=this.commonTimeNode.children[o];o!==n?s.commonTimeNode.seekToEnd(!1,!0):t==="start"?s.commonTimeNode.seekToStart():t==="end"&&s.commonTimeNode.seekToEnd(!1,!0)}this.currentSeqIndex=n,this.currentSeqState=t==="start"?"idle":"end"}}function us(r,e,t){const n=e.split(".");n.reduce((i,o,s)=>{if(i)return s!==n.length-1?i[o]:void(i[o]=t);console.warn(`${r} not support ${e}`)},r)}function Tm(r,e){return e.split(".").reduce((t,n)=>{if(t)return t[n];console.warn(`${r} not support ${e}`)},r)}const mM=new class{constructor(){this.runningTimeNodes={}}addRunningTimeNode(r,e,t){const n=`${e}_${r}`;this.runningTimeNodes[n]&&this.runningTimeNodes[n].dispose(!0),this.runningTimeNodes[n]=t}};class za{constructor(e){this.timingTarget=null,this.runtimeNodeEventHub=new B.a,this.onTimeLineStart=()=>{if(this.isConflict){const{target:d}=this.json.cBhvr;if(this.activeWhenConflict==="next"){let f=d.id;d.type==="shape"&&d.txEl&&(f=`${f}-txEl-${d.txEl.range[0]}`),this.commonTimeNode.isIterate&&(f=`${f}-iterate-${this.commonTimeNode.iterateIndex}`),mM.addRunningTimeNode(f,this.modifyAttrKey,this.commonTimeNode)}else this.activeWhenConflict==="prev"&&this.commonTimeNode.dispose()}};const{isIterate:t,isSub:n,json:i,ctx:o,parent:s,eventHub:a,iterateType:h,iterateIndex:u,iterateId:c}=e;this.json=i,this.id=i.cBhvr.ctn.id,this.ctx=o,this.globalEventHub=a,this.commonTimeNode=new zl({json:i.cBhvr.ctn,isSub:n,eventHubs:{global:a,runtime:this.runtimeNodeEventHub},ctx:o,parent:s,isIterate:t,iterateType:h,iterateIndex:u,iterateId:c}),this.timingTarget=this.ctx.timingTargets.getTarget(i.cBhvr.target,t,{type:h,index:u,id:c}),this.commonTimeNode.on("seekToStart",()=>this.onSeekToStart()),this.commonTimeNode.on("seekToEnd",()=>this.onSeekToEnd()),this.commonTimeNode.on("timelineStart",this.onTimeLineStart)}}class gM extends za{constructor(e){super(e),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.updateStartValue=()=>{this.timingTarget&&(this.startVal=Tm(this.timingTarget,this.json.cBhvr.attrList[0]))},this.onSeekToStart=()=>{const t=this.json.cBhvr.attrList[0];this.startVal!==null&&this.timingTarget&&us(this.timingTarget,t,this.startVal)},this.onSeekToEnd=()=>{const t=this.json.cBhvr.attrList[0],n=this.json.cBhvr.to||this.json.to;n&&this.timingTarget&&us(this.timingTarget,t,n)},this.commonTimeNode.on("timeNodeStart",this.updateStartValue),this.commonTimeNode.on("timeNodeCreate",this.updateStartValue),this.commonTimeNode.on("timelineStart",()=>{const t=this.json.cBhvr.attrList[0];this.json.cBhvr.attrList.length>1&&console.warn("this.json.cBhvr.attrList.length > 0");const n=this.json.cBhvr.to||this.json.to;n&&this.timingTarget&&us(this.timingTarget,t,n)})}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}}class I0{constructor(e,t){this.math={pi:Math.PI,e:Math.E,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,cosh:Math.cosh,deg:n=>n/Math.PI*180,exp:Math.exp,floor:Math.floor,ln:Math.log,max:Math.max,min:Math.min,rad:n=>n/180*Math.PI,rand:Math.random,sin:Math.sin,sinh:Math.sinh,sqrt:Math.sqrt,tan:Math.tan,tanh:Math.tanh},this.timingTarget=t,this.val=e.val.value,this.time=e.time,e.fmla&&(this.fmla=this.parseFmla(e.fmla))}parseFmla(e){let t=e.replaceAll("#ppt_h",`(${this.timingTarget.design_ppt_h})`);return t=t.replaceAll("#ppt_w",`(${this.timingTarget.design_ppt_w})`),t=t.replaceAll("#ppt_x",`(${this.timingTarget.design_ppt_x})`),t=t.replaceAll("#ppt_y",`(${this.timingTarget.design_ppt_y})`),t=t.replaceAll("ppt_w","vars.ppt_w"),t=t.replaceAll("ppt_h","vars.ppt_h"),t=t.replaceAll("ppt_x","vars.ppt_x"),t=t.replaceAll("ppt_y","vars.ppt_y"),t=t.replaceAll("#","vars."),["abs","acos","asin","atan","ceil","cos","cosh","deg","exp","floor","ln","max","min","rad","rand","sin","sinh","sqrt","tan","tanh","pi","e"].forEach(n=>{t=t.replaceAll(n,"math."+n)}),new Function("vars","math","$","return "+t)}}class vM extends I0{constructor(e,t,n){super(e,t),this.value=e.val.value,n&&(this.fmla=this.parseFmla(n))}resolveValue(){return this.value}interpolationFrom(e,t,n){const i=e.resolveValue(n),o=i+(this.resolveValue()-i)*t;return e.fmla?e.fmla(n,this.math,o):o}}class _M extends I0{constructor(e,t){var n;super(e,t),this.value=(n=e.val)===null||n===void 0?void 0:n.value}interpolationFrom(e,t,n){let i=e.resolveValue(n);return t>this.time&&(i=this.resolveValue()),i}resolveValue(){return this.value||""}}class kd extends I0{constructor(e,t){super(e,t),this.fn=this.parseFmla(this.val)}resolveValue(e){return this.fn(e,this.math,1)}interpolationFrom(e,t,n){const i=e.resolveValue(n),o=i+(this.resolveValue(n)-i)*t;return e.fmla?e.fmla(n,this.math,o):o}}class yM extends za{constructor(e){super(e),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.vars={ppt_x:0,ppt_y:0,ppt_w:0,ppt_h:0},this.keyFrames=[],this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal=Tm(this.timingTarget,this.json.cBhvr.attrList[0]))},this.updateVars=()=>{var t,n,i,o;((t=this.timingTarget)===null||t===void 0?void 0:t.ppt_h)&&(this.vars.ppt_h=this.timingTarget.ppt_h),((n=this.timingTarget)===null||n===void 0?void 0:n.ppt_w)&&(this.vars.ppt_w=this.timingTarget.ppt_w),((i=this.timingTarget)===null||i===void 0?void 0:i.ppt_x)&&(this.vars.ppt_x=this.timingTarget.ppt_x),((o=this.timingTarget)===null||o===void 0?void 0:o.ppt_y)&&(this.vars.ppt_y=this.timingTarget.ppt_y)},this.onTimeUpdate=({duration:t,delta:n})=>{const i=n/t,o=this.keyFrames.findIndex(d=>i<=d[0]);if(o<0){const d=this.keyFrames[this.keyFrames.length-1];return void(this.timingTarget&&us(this.timingTarget,this.json.cBhvr.attrList[0],d[1].resolveValue(this.vars)))}const s=o-1,a=this.keyFrames[o],h=this.keyFrames[s]||a,u=a[0]-h[0]==0?1:(i-h[0])/(a[0]-h[0]),c=a[1].interpolationFrom(h[1],u,this.vars);this.timingTarget&&us(this.timingTarget,this.json.cBhvr.attrList[0],c)},this.onSeekToStart=()=>{this.startVal!==null&&this.timingTarget&&us(this.timingTarget,this.json.cBhvr.attrList[0],this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.initKeyFrames(),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timelineStart",this.updateVars),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart)}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}initKeyFrames(){var e;const{valueType:t}=this.json;if(this.json.tavLst.length<=0){if(this.json.to){if(this.json.from||this.startVal){const i={time:0,val:{type:"string",value:this.json.from||this.startVal.toString()},fmla:""};if(t==="num"&&this.timingTarget){const o=new kd(i,this.timingTarget);this.keyFrames.push([i.time,o])}}const n={time:1,val:{type:"string",value:this.json.to},fmla:""};if(t==="num"&&this.timingTarget){const i=new kd(n,this.timingTarget);this.keyFrames.push([n.time,i])}}else if(this.json.by){const n={time:0,val:{type:"string",value:this.json.cBhvr.attrList[0]},fmla:""};if(t==="num"&&this.timingTarget){const o=new kd(n,this.timingTarget);this.keyFrames.push([n.time,o])}const i={time:1,val:{type:"string",value:(((e=n.val)===null||e===void 0?void 0:e.value)||"")+"+"+this.json.by},fmla:""};if(t==="num"&&this.timingTarget){const o=new kd(i,this.timingTarget);this.keyFrames.push([i.time,o])}}}if(this.json.tavLst.length>0){for(const n of this.json.tavLst)if(n.val&&this.timingTarget){let i=null;n.val.type==="string"?t==="num"?i=new kd(n,this.timingTarget):t==="str"&&(i=new _M(n,this.timingTarget)):n.val.type==="number"?i=new vM(n,this.timingTarget):(n.val.type==="color"||n.val.type==="boolean")&&console.warn("not implements"),i&&this.keyFrames.push([n.time,i])}}}}class xM extends Sr{constructor(e){super(`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;

uniform vec4 inputSize;
uniform vec4 outputFrame;
uniform float percent;
uniform float direction;
uniform float transition;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord(vec2 aVertexPosition)
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    vTransition = transition;
    vDirection = direction;
    vPercent = percent;
    vVertexPosition = aVertexPosition;
    vec2 localVertexPosition = aVertexPosition;
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord(localVertexPosition);
}
`,`
// \u7EB9\u7406\u5750\u6807
varying vec2 vTextureCoord;
// \u9876\u70B9\u5750\u6807
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;

uniform sampler2D uSampler;

void main(void){
    vec4 outputColor;

    float percent = vPercent;
    float direction = vDirection;
    
    if (vTransition < 0.0) {
        percent = 1.0 - percent;
        if (vDirection > 1.5 && vDirection < 2.5) {
            direction = 1.0;
        } else if (vDirection > 0.5 && vDirection < 1.5) {
            direction = 2.0;
        } else if (vDirection > 2.5 && vDirection < 3.5) {
            direction = 4.0;
        } else {
            direction = 3.0;
        }
    }

    if (direction > 1.5 && direction < 2.5) { // \u4ECE\u4E0B\u81F3\u4E0A\u663E\u793A
        if (vVertexPosition.y >= 1.0 - percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.y >= 1.0 - percent && vVertexPosition.y <= 1.0 - percent + 0.2 ) {
            outputColor = outputColor * ((vVertexPosition.y - (1.0 - percent)) / 0.2);
        }
    } else if (direction > 0.5 && direction < 1.5) { // \u4ECE\u4E0A\u81F3\u4E0B\u663E\u793A
        if (vVertexPosition.y <= percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.y <= percent && vVertexPosition.y >= percent - 0.2) {
            outputColor = outputColor * (1.0 - (vVertexPosition.y - (percent - 0.2)) / 0.2);
        }
    } else if (direction > 2.5 && direction < 3.5) { // \u4ECE\u5DE6\u5230\u53F3
        if (vVertexPosition.x <= percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.x <= percent && vVertexPosition.x >= percent - 0.2) {
            outputColor = outputColor * (1.0 - (vVertexPosition.x - (percent - 0.2)) / 0.2);
        }
    } else {
        if (vVertexPosition.x >= 1.0 - percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.x >= 1.0 - percent && vVertexPosition.x <= 1.0 - percent + 0.2) {
            outputColor = outputColor * ((vVertexPosition.x - (1.0 - percent)) / 0.2);
        }
    }

    gl_FragColor = outputColor;
}
`,{percent:0,direction:1,transition:e})}set percent(e){this.uniforms.percent=e}set direction(e){this.uniforms.direction=e}}class bM extends Sr{constructor(){super(void 0,`
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;

void main(void){
    vec4 color1 = texture2D(uSampler, vTextureCoord);
    if (color1.a != 0.0 && percent < 1.0) {
        float alpha = percent;
        gl_FragColor = color1 * alpha;
        return;
    }
    gl_FragColor = color1;
}
`,{percent:0})}set percent(e){this.uniforms.percent=e}}class wM extends za{constructor(e){var t;super(e),this.filterType="",this.isConflict=!0,this.activeWhenConflict="prev",this.onTimeUpdate=({duration:o,delta:s})=>{const a=s/o;this.filter&&(this.filter.percent=a),a>=1&&this.timingTarget&&(this.timingTarget.container.filters=[])},this.onSeekToStart=()=>{this.timingTarget&&(this.timingTarget.container.filters=[])},this.onSeekToEnd=()=>{this.timingTarget&&(this.timingTarget.container.filters=[])},this.commonTimeNode.on("timelineStart",()=>{this.filter&&this.timingTarget&&(this.timingTarget.container.filters=[this.filter])}),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate);let n=0;e.json.transition==="out"?n=-1:e.json.transition==="in"&&(n=1);const i=(t=e.json.filter)===null||t===void 0?void 0:t.match(/^([a-zA-Z]+)(\((.+)\))?/);if(i){const o=i[1],s=i[3];if(o==="wipe"){const a=new xM(n);s==="up"?a.direction=1:s==="down"?a.direction=2:s==="left"?a.direction=3:s==="right"&&(a.direction=4),this.filter=a,this.filterType=`${o}-${s}`}else if(o==="fade"){const a=new bM;this.filter=a,this.filterType=""+o}}}get modifyAttrKey(){return this.filterType}}class TM extends za{constructor(e){super(e),this.isConflict=!0,this.activeWhenConflict="next",this.onTimeUpdate=({duration:t,delta:n})=>{var i;const o=n/t,s=(i=this.path)===null||i===void 0?void 0:i.getPoint(o);this.timingTarget&&s&&(this.timingTarget.ppt_x=s.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=s.y+ +this.timingTarget.design_ppt_y)},this.onSeekToStart=()=>{var t;const n=(t=this.path)===null||t===void 0?void 0:t.getPoint(0);this.timingTarget&&n&&(this.timingTarget.ppt_x=n.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=n.y+this.timingTarget.design_ppt_y)},this.onSeekToEnd=()=>{var t;const n=(t=this.path)===null||t===void 0?void 0:t.getPoint(1);this.timingTarget&&n&&(this.timingTarget.ppt_x=n.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=n.y+this.timingTarget.design_ppt_y)},this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.createPath()}get modifyAttrKey(){return"motion"}createPath(){var e;const t=new Fh,n=(e=this.json.path)===null||e===void 0?void 0:e.match(/[MLCmlc][^MLCmlc]+/g);if(n)for(const i of n){const[o,...s]=i.trim().replace(/\s+/g," ").split(" ");if(o==="M"){const[a,h]=s.map(u=>Number(u));t.moveTo(a,h)}else if(o==="L"){const[a,h]=s.map(u=>Number(u));t.lineTo(a,h)}else if(o==="C"){const[a,h,u,c,d,f]=s.map(m=>Number(m));t.bezierCurveTo(a,h,u,c,d,f)}else if(o==="Z")t.closePath();else if(o==="E")console.warn("not implements");else if(o==="c"){const[a,h,u,c,d,f]=s.map(g=>Number(g)),m=t.currentPoint;t.bezierCurveTo(a+m.x,h+m.y,u+m.x,c+m.y,d+m.x,f+m.y)}else if(o==="l"){const a=t.currentPoint,[h,u]=s.map(c=>Number(c));t.lineTo(h+a.x,u+a.y)}else if(o==="m"){const a=t.currentPoint,[h,u]=s.map(c=>Number(c));t.moveTo(h+a.x,u+a.y)}}this.path=t}}class SM extends za{constructor(e){super(e),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.onTimelineStart=t=>{t.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:t,delta:n})=>{const i=n/t,o={x:1,y:1};if(this.from&&this.to)o.x=this.from.x+(this.to.x-this.from.x)*i,o.y=this.from.y+(this.to.y-this.from.y)*i;else if(this.by){const s={x:this.by.x,y:this.by.y};o.x=1+(s.x-1)*i,o.y=1+(s.y-1)*i}this.timingTarget&&(this.timingTarget.scale=o)},this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})},this.onSeekToStart=()=>{this.timingTarget&&this.startVal&&(this.timingTarget.scale=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.from=e.json.from,this.to=e.json.to,this.by=e.json.by,this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart)}get modifyAttrKey(){return"scale"}updateCurrentValue(){this.timingTarget&&(this.current={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})}}class EM extends za{constructor(e){super(e),this.isConflict=!1,this.activeWhenConflict="next",this.startColorString=null,this.currentColorString="#FFFFFFFF",this.onTimelineStart=t=>{this.from.isInit()||this.from.fromHexString(this.currentColorString),this.to.isInit()||this.from.by(this.by,this.to),t.isReverse||this.updateCurrentValue();const[n]=this.json.cBhvr.attrList[0].split(".");us(this.timingTarget,n+".on","true")},this.onTimeNodeEnd=()=>{if(this.json.cBhvr.ctn.fill==="remove"){const[t]=this.json.cBhvr.attrList[0].split(".");us(this.timingTarget,t+".on","false")}},this.onSeekToStart=()=>{if(this.timingTarget){const[t]=this.json.cBhvr.attrList[0].split(".");us(this.timingTarget,t+".on","false")}},this.onTimeNodeStart=()=>{if(this.timingTarget){const t=Tm(this.timingTarget,this.json.cBhvr.attrList[0]);t&&(this.startColorString=t)}},this.onTimeUpdate=({delta:t,duration:n})=>{const i=t/n;this.to.interpolationFrom(this.from,i,this.target),this.timingTarget&&us(this.timingTarget,this.json.cBhvr.attrList[0],this.target.toHexString())},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1})},this.json.clrSpc==="rgb"?(this.from=new bm(this.json.from),this.to=new bm(this.json.to),this.by=new bm(this.json.by),this.target=new bm):(this.from=new xm(this.json.from),this.to=new xm(this.json.to),this.by=new xm(this.json.by),this.target=new xm),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeEnd",this.onTimeNodeEnd),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate)}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}updateCurrentValue(){if(this.timingTarget){const e=Tm(this.timingTarget,this.json.cBhvr.attrList[0]);e&&(this.currentColorString=e)}}}class MM extends za{constructor(e){super(e),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.lastVal=null,this.onTimelineStart=t=>{this.lastVal=null,t.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:t,delta:n})=>{const i=n/t;let o=0,s=0;if(this.from!==void 0&&this.to!==void 0){o=this.from,s=this.to;const a=o+(s-o)*i;this.timingTarget&&(this.timingTarget.r=a)}else if(this.by!==void 0){this.lastVal||(this.lastVal=0);const a=this.by*i-this.lastVal;this.lastVal=this.by*i,this.timingTarget&&(this.timingTarget.r+=a)}},this.onTimeNodeStart=()=>{var t;Object(ie.isNumber)((t=this.timingTarget)===null||t===void 0?void 0:t.r)&&(this.startVal=this.timingTarget.r)},this.onSeekToStart=()=>{this.timingTarget&&this.startVal!==null&&(this.timingTarget.r=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.from=this.json.from,this.to=this.json.to,this.by=this.json.by,this.by?this.isConflict=!1:this.isConflict=!0,this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate)}get modifyAttrKey(){return"rotate"}updateCurrentValue(){var e;this.currentVal=(e=this.timingTarget)===null||e===void 0?void 0:e.r}}class AM extends za{constructor(e){super(e),this.isConflict=!1,this.activeWhenConflict="next",this.isApplied=!1,this.onTimeUpdate=()=>{var t,n;const{cmd:i,cmdType:o}=this.json;!this.isApplied&&i&&o&&(this.isApplied=!0,(n=(t=this.timingTarget)===null||t===void 0?void 0:t.cmd)===null||n===void 0||n.applyCommand(i,o))},this.onSeekToStart=()=>{var t,n;(n=(t=this.timingTarget)===null||t===void 0?void 0:t.cmd)===null||n===void 0||n.applyCommand("custom-pause","call")},this.onSeekToEnd=()=>{var t,n;(n=(t=this.timingTarget)===null||t===void 0?void 0:t.cmd)===null||n===void 0||n.applyCommand("custom-pause","call")},this.commonTimeNode.on("timeNodeStart",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeNodeEnd",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate)}get modifyAttrKey(){var e,t,n,i;return((t=(e=this.json)===null||e===void 0?void 0:e.cmd)!==null&&t!==void 0?t:"")+((i=(n=this.json)===null||n===void 0?void 0:n.cmdType)!==null&&i!==void 0?i:"")}}var PM=_(17);class Sm{constructor(e){Sm.useRtc||(this.howl=new PM.Howl({src:[e]}))}play(){var e;(e=this.howl)===null||e===void 0||e.play()}pause(){var e;(e=this.howl)===null||e===void 0||e.pause()}stop(){var e;(e=this.howl)===null||e===void 0||e.stop()}}Sm.useRtc=!1;class RM{constructor(e){this.runtimeNodeEventHub=new B.a,this.stopAudio=()=>{this.audio.stop()};const{json:t,isIterate:n,isSub:i,eventHub:o,ctx:s,parent:a,iterateType:h,iterateIndex:u,iterateId:c}=e;this.json=t,this.id=t.cMediaNode.ctn.id,this.commonTimeNode=new zl({json:t.cMediaNode.ctn,isSub:i,eventHubs:{global:o,runtime:this.runtimeNodeEventHub},ctx:s,parent:a,isIterate:n,iterateType:h,iterateIndex:u,iterateId:c}),this.audio=new Sm(t.cMediaNode.tgtEl),this.commonTimeNode.on("timelineStart",()=>{this.audio.play()}),this.commonTimeNode.on("seekToStart",this.stopAudio),this.commonTimeNode.on("seekToEnd",this.stopAudio),this.commonTimeNode.on("timeNodeDestroy",this.stopAudio)}}var CM=_(7),wb=_.n(CM);function Tb(){return Date.now().toString(32)+Math.random().toString(32).substring(2)}function L0(r){const e=[],t=r.filter(h=>{const u=h.width<2048&&h.height<2048;return u||e.push(h),u}).map(h=>(h.width+=2,h.height+=2,h)).sort((h,u)=>h.width*h.height-u.width*u.height);let n=t.length+1,i=2050,o=2050;const s=[];let a=null;for(;(i>2048||o>2048)&&t.length>0;)n-=1,a=wb()(t.slice(0,n)),i=a.width,o=a.height;return a&&s.push(a),e.forEach(h=>{const u=wb()([h]);s.push(u)}),n<t.length?s.concat(L0(t.slice(n))):s}var IM=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class zl extends B.a{constructor(e){super(),this.uuid=Date.now().toString(32)+Math.random().toString(32).substring(2),this.isSub=!1,this.isShadow=!1,this.startCount=0,this.applyCount=0,this.isReverse=!1,this.isConflictDispose=!1,this.isIterateEnd=!1,this.parentTimeNode=null,this.isActive=!1,this.isDestroy=!1,this.shouldSeekOnStart=!1,this.repeatTimeoutId=null,this.iterateShadows=[],this.isIterate=!1,this.iterateType="el",this.iterateIndex=0,this.children=[],this.subList=[],this.duration=0,this.timeDelta=0,this.isNegativeSpeed=!1,this.handleEndCond=()=>{this.isActive&&(this.isActive=!1,this.dispose())},this.handleActive=(m=!0)=>{if(this.isActive=!0,this.applyCount+=1,this.json.iterate||this.emit("timeNodeStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startCount>0&&this.json.restart){if(this.json.restart==="never")return;this.json.restart!=="whenNotActive"&&this.json.restart!=="always"||(this.seekToStart(),this.emit("timeNodeRestart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startTimeLine(m))}else this.startTimeLine(m)},this.updateTimeLine=m=>{const g=m/(Et.TARGET_FPMS||.06);this.timeDelta+=g,this.duration-this.timeDelta<=g&&(this.timeDelta=this.duration),this.timeDelta<this.duration?this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?this.duration-this.timeDelta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}):(this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?0:this.duration,duration:this.duration,isReverse:this.isReverse}),this.onTimeLineEnd())},this.handleEnd=(m=!1)=>{(this.isTimeNodeEnd()||m)&&(this.isActive=!1,this.isSub&&this.destroy(),this.emitEndEvents())};const{isSub:t,isIterate:n,ctx:i,eventHubs:o,parent:s,json:a,iterateType:h,iterateId:u,iterateIndex:c}=e;this.isSub=t,this.isIterate=n,this.parentTimeNode=s,this.json=a,this.ctx=i,this.iterateIndex=c,this.eventHubs=o,this.iterateType=h,this.iterateId=u;const d=Number(this.json.dur),f=this.json.spd||1;this.isNegativeSpeed=f<0,Number.isNaN(d)||(this.duration=d/Math.abs(f)),this.setPreStyle(),a.childTnLst&&this.createChildren(a.childTnLst),this.startConds=new Ud(this.json.id||"",a.stCondLst,o,this.ctx),this.endConds=new Ud(this.json.id||"",a.endCondLst,o,this.ctx),a.endSync&&(this.endSync=new Ud(this.json.id||"",[a.endSync],o,this.ctx),this.endSync.on("active",()=>{var m;this.json.nodeType==="interactiveSeq"&&(this.isActive=!1,this.shouldSeekOnStart=!0,this.emit("timeNodeEndSync"),(m=this.endSync)===null||m===void 0||m.reset())})),this.startConds.on("active",m=>{this.isActive||(this.shouldSeekOnStart&&(this.shouldSeekOnStart=!1,this.seekToStart()),this.handleActive(m))}),this.endConds.on("active",()=>{this.handleEndCond(),this.children.forEach(m=>m.commonTimeNode.handleEndCond())}),this.parentTimeNode&&this.parentTimeNode.on("timeNodeStart",()=>{this.applyCount=0}),this.isSub&&this.json.masterRel==="nextClick"&&this.startConds.addCond({event:"shape slide onNext"}),this.json.iterate&&this.isIterate===!1&&this.createIterateShadow()}createIterateShadow(){const e=Tb();let t=!0,n=0;const i=o=>{o===e&&(t=!1,this.ctx.eventHub.removeListener("IterateTimeNodeEnd",i))};for(this.ctx.eventHub.on("IterateTimeNodeEnd",i);t;){const o=JSON.parse(JSON.stringify(this.json)),s=new zl({json:o,isSub:!1,eventHubs:this.eventHubs,ctx:this.ctx,parent:null,isIterate:!0,iterateType:o.iterate.type,iterateIndex:n,iterateId:e});this.iterateShadows[n]=s,n+=1}}isInfiniteRepeat(){return this.json.repeatCount>999999998}getReverse(){return this.isReverse}setReverse(e){this.isReverse=e}createTimeNode(e,t){let n=null;const i={json:e,isSub:t,isIterate:this.isIterate,eventHub:this.eventHubs.global,ctx:this.ctx,parent:this,iterateType:this.iterateType,iterateIndex:this.iterateIndex,iterateId:this.iterateId};return e.type==="seq"?n=new fM(i):e.type==="par"?n=new Sb(i):e.type==="set"?n=new gM(i):e.type==="anim"?n=new yM(i):e.type==="animEffect"?n=new wM(i):e.type==="animMotion"?n=new TM(i):e.type==="animScale"?n=new SM(i):e.type==="animClr"?n=new EM(i):e.type==="animRot"?n=new MM(i):e.type==="cmd"?n=new AM(i):e.type==="audio"&&(n=new RM(i)),n}createSubList(e){this.subList=[],e.forEach(t=>{const n=this.createTimeNode(t,!0);n&&this.subList.push(n)})}createChildren(e){e.forEach(t=>{const n=this.createTimeNode(t,!1);n&&(n.commonTimeNode.on("timeNodeStart",i=>{this.emit("childTimeNodeStart",i)}),n.commonTimeNode.on("timeNodeEnd",i=>{this.emit("childTimeNodeEnd",i),this.children.every(o=>o.commonTimeNode.isTimeNodeEnd())&&(this.json.iterate||this.allChildrenEndHandle())}),this.children.push(n))})}playReverse(){this.isReverse=!0,this.startReverseTimeLine(),this.children.forEach(e=>e.commonTimeNode.playReverse())}allChildrenEndHandle(){if(!this.isDestroy){if(this.json.autoRev&&!this.isReverse)return this.isReverse=!0,void this.playReverse();this.isReverse&&(this.isReverse=!1),this.json.repeatCount&&this.json.repeatCount>this.applyCount?this.repeatTimeoutId=setTimeout(()=>{this.seekToStart(!1),this.resetForRepeat(),this.startTimeNodeRepeat()}):(this.json.iterate&&!this.isIterate&&(this.isIterateEnd=!0),this.eventHubs.runtime.emit("runtime all end"),this.startSubList(),this.handleEnd())}}resetForRepeat(){this.timeDelta=0,this.children.forEach(e=>e.commonTimeNode.resetForRepeat())}startSubList(){this.subList.forEach(e=>e.commonTimeNode.startTimeNode())}startReverseTimeLine(){this.timeDelta=0;const e=1e3/this.ctx.ticker.maxFPS;this.duration<=e&&this.duration>0?(this.emit("timeUpdate",{delta:this.duration,duration:this.duration,isReverse:this.isReverse}),this.ctx.eventHub.emit(pn.animateEnd),this.ctx.ticker.remove(this.updateTimeLine)):this.duration>e&&(this.ctx.eventHub.emit(pn.animateStart),this.ctx.ticker.add(this.updateTimeLine))}startTimeLine(e=!0){if(e&&(this.eventHubs.global.emit(`time ${this.json.id} begin`),this.eventHubs.global.emit(`time ${this.json.id} onBegin`),this.eventHubs.runtime.emit(`runtime ${this.json.id} begin`)),this.json.iterate)return void this.startIterate();this.timeDelta=0,this.emit("timelineStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse});const t=1e3/this.ctx.ticker.maxFPS;this.duration<=t&&this.duration>0?(this.timeDelta=this.isReverse?0:this.duration,this.emit("timeUpdate",{delta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}),this.emit("timelineEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.onTimeLineEnd()):this.duration>t&&(this.ctx.eventHub.emit(pn.animateStart),this.ctx.ticker.add(this.updateTimeLine))}setTimeout(e,t){let n=0;const i=o=>{n+=o/(Et.TARGET_FPMS||.06),n>=t&&(e(),this.ctx.ticker.remove(i))};return this.ctx.ticker.add(i),()=>{this.ctx.ticker.remove(i)}}tickerDelay(e){return new Promise(t=>{this.setTimeout(()=>{t()},e)})}startIterate(){return IM(this,void 0,void 0,function*(){if(this.json.iterate){this.isIterateEnd=!1;for(const e of this.iterateShadows){if(this.isIterateEnd)return;e.children.forEach(t=>{t.commonTimeNode.startTimeNode()}),e.applyCount+=1,yield this.tickerDelay(this.json.iterate.interval)}this.onTimeLineEnd()}})}isNatureTimeEnd(){return this.duration>=0&&this.timeDelta>=this.duration}setPreStyle(){if(!this.json.presetClass)return;const e=[],t=n=>{n.forEach(i=>{var o,s,a;i.cBhvr&&i.cBhvr.target&&e.findIndex(h=>h.id===i.cBhvr.target.id)<0&&e.push(i.cBhvr.target),((s=(o=i==null?void 0:i.cBhvr)===null||o===void 0?void 0:o.ctn)===null||s===void 0?void 0:s.childTnLst)&&i.cBhvr.ctn.childTnLst.length>0&&t(i.cBhvr.ctn.childTnLst),((a=i==null?void 0:i.ctn)===null||a===void 0?void 0:a.childTnLst)&&i.ctn.childTnLst.length>0&&t(i.ctn.childTnLst)})};t(this.json.childTnLst||[]),e.forEach(n=>{if(this.json.iterate){let i=0,o=!0;for(;o;){const s=this.ctx.timingTargets.getTarget(n,!0,{type:this.json.iterate.type,index:i,id:""});s&&(this.setPreStyleForTarget(s),i+=1),o=!!s}}else{const i=this.ctx.timingTargets.getTarget(n,!1);i&&this.setPreStyleForTarget(i)}})}setPreStyleForTarget(e){e&&this.json.presetSubtype&&(e.presetSubType=this.json.presetSubtype),e&&!e.hasPreset&&(this.json.presetClass==="entr"?(e.hasPreset=!0,e.style.visibility="hidden"):this.json.presetClass==="exit"&&(e.hasPreset=!0,e.style.visibility="visible"))}startTimeNodeRepeat(){this.timeDelta=0,this.isActive=!0,this.applyCount+=1,this.startTimeLine(!1),this.json.iterate||this.emit("timeNodeRepeat",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse})}startTimeNodeForce(){this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.timeDelta=0,this.isActive=!0,this.handleActive(!1)}startTimeNode(e=!0){if(this.isDestroy)return;this.collectStartValue(),this.timeDelta=0,this.isReverse=!1,this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.startConds.setTriggerParams(e);const t=this.json.stCondLst.filter(i=>/^self/.test(i.event||""))[0];t&&this.startConds.condHandle(t);const n=this.json.endCondLst.filter(i=>/^self/.test(i.event||""))[0];n&&this.endConds.condHandle(n),this.startConds.condHandle()}onTimeLineEnd(){this.dispose(),(this.children.length===0||this.json.iterate)&&this.allChildrenEndHandle()}clearSubList(){this.subList.forEach(e=>e.commonTimeNode.destroy())}seekToStart(e=!0){if(this.isActive=!1,this.dispose(),this.isNegativeSpeed?this.emit("seekToEnd"):this.emit("seekToStart"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(t=>t.seekToStart(e));if(e)for(let t=this.subList.length-1;t>=0;t--){const n=this.subList[t];n==null||n.commonTimeNode.seekToStart()}for(let t=this.children.length-1;t>=0;t--){const n=this.children[t];n==null||n.commonTimeNode.seekToStart()}for(let t=this.children.length-1;t>=0;t--){const n=this.children[t];n==null||n.commonTimeNode.seekToStart()}}dispose(e=!1){this.isConflictDispose=e,window.clearTimeout(this.repeatTimeoutId),this.ctx.eventHub.emit(pn.animateEnd),this.ctx.ticker.remove(this.updateTimeLine),this.startConds.reset(),this.endConds.reset()}seekToEnd(e,t=!1){if(this.isInfiniteRepeat())return;!this.isActive&&this.applyCount<=0&&this.collectStartValue(),this.applyCount=this.json.repeatCount,this.json.autoRev&&(this.isReverse=!0),this.timeDelta=this.duration,this.isActive=!1,this.dispose();const n=this.json.autoRev||e;if(n?this.emit("seekToStart"):this.emit("seekToEnd"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(i=>i.seekToEnd(n,t));this.children.length===0&&(this.eventHubs.runtime.emit("runtime all end"),this.handleEnd()),this.children.forEach(i=>i.commonTimeNode.seekToEnd(n,t)),t&&this.json.subTnLst&&(this.subList.length<=0&&this.createSubList(this.json.subTnLst),this.subList.forEach(i=>i.commonTimeNode.seekToEnd(!1)))}isTimeNodeEnd(){let e=!0;return this.children.length>0&&(e=e&&this.children.every(t=>t.commonTimeNode.isTimeNodeEnd())),this.json.repeatCount&&(e=e&&this.applyCount>=this.json.repeatCount),this.json.autoRev&&(e=e&&!this.isReverse),e=e&&this.isNatureTimeEnd(),!!this.isConflictDispose||!(!this.isIterateEnd||!this.json.iterate)||e}emitEndEvents(){this.eventHubs.global.emit(`time ${this.json.id} end`),this.eventHubs.global.emit(`time ${this.json.id} onEnd`),this.eventHubs.runtime.emit(`runtime ${this.json.id} end`),this.emit("timeNodeEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse})}collectStartValue(){this.emit("timeNodeCreate"),this.children.forEach(e=>e.commonTimeNode.collectStartValue())}destroy(){this.emit("timeNodeDestroy"),this.isDestroy=!0,this.dispose(),this.startConds.removeAllListeners(),this.endConds.removeAllListeners(),this.children.forEach(e=>e.commonTimeNode.destroy())}}class Sb extends B.a{constructor(e){super(),this.isRunning=!1,this.runtimeNodeEventHub=new B.a;const{json:t,iterateType:n,isIterate:i,isSub:o,parent:s,ctx:a,eventHub:h,iterateIndex:u,iterateId:c}=e;this.id=t.ctn.id,this.json=t,this.ctx=a,this.isIterate=i,this.globalEventHub=h,this.commonTimeNode=new zl({json:t.ctn,isSub:o,eventHubs:{global:h,runtime:this.runtimeNodeEventHub},ctx:a,parent:s,isIterate:!1,iterateType:n,iterateIndex:u,iterateId:c}),this.commonTimeNode.on("timeNodeStart",()=>{this.commonTimeNode.children.forEach(d=>{d.commonTimeNode.setReverse(this.commonTimeNode.getReverse()),d.commonTimeNode.startTimeNode()}),this.isRunning||(this.isRunning=!0,this.globalEventHub.emit(`runtime ${this.id} begin`),this.emit("begin"))}),this.commonTimeNode.on("timeNodeRepeat",()=>{this.commonTimeNode.children.forEach(d=>{d.commonTimeNode.startTimeNode(!1)})}),this.commonTimeNode.on("timeNodeEnd",()=>{this.commonTimeNode.isTimeNodeEnd()&&this.isRunning&&(this.isRunning=!1,this.globalEventHub.emit(`runtime ${this.id} end`),this.emit("end"))})}}class LM{constructor(e,t,n){this.json=e,this.ctx=n;const i=e.timeNodeList.find(o=>o.type==="par"&&o.ctn.nodeType==="tmRoot");i&&(this.tmRoot=new Sb({json:i,isSub:!1,isIterate:!1,eventHub:t,ctx:n,parent:null,iterateType:"el",iterateIndex:0,iterateId:""}),this.mainSeq=this.tmRoot.commonTimeNode.children.find(o=>{var s,a,h;return((s=o.json)===null||s===void 0?void 0:s.type)==="seq"&&((h=(a=o.json)===null||a===void 0?void 0:a.ctn)===null||h===void 0?void 0:h.nodeType)==="mainSeq"}))}findSeq(e){var t;return(t=this.tmRoot)===null||t===void 0?void 0:t.commonTimeNode.children.find(n=>{var i,o,s;return((i=n.json)===null||i===void 0?void 0:i.type)==="seq"&&((s=(o=n.json)===null||o===void 0?void 0:o.ctn)===null||s===void 0?void 0:s.id)===e})}start(){var e;this.json.autoPlayMainSeq?setTimeout(()=>{var t;(t=this.mainSeq)===null||t===void 0||t.commonTimeNode.startTimeNode()}):(e=this.mainSeq)===null||e===void 0||e.commonTimeNode.startTimeNode()}setMainSeqApplied(){this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1)}collectMainSeqStartValue(){var e;(e=this.mainSeq)===null||e===void 0||e.commonTimeNode.collectStartValue()}setMainSeqStep(e,t){var n;e===-1&&this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1),(n=this.mainSeq)===null||n===void 0||n.setCurrentStep(e,t)}destroy(){var e;(e=this.tmRoot)===null||e===void 0||e.commonTimeNode.destroy()}hasMainSeq(){return!!this.mainSeq&&this.mainSeq.commonTimeNode.children.length>0}currentMainSeqState(){return this.mainSeq?this.mainSeq.currentState:null}currentMainSeqStep(){return this.mainSeq?this.mainSeq.currentStep:0}currentMainSeqLength(){return this.mainSeq?this.mainSeq.stepLength:0}mainSeqHasNextStep(){return!!this.mainSeq&&this.mainSeq.hasNext()}mainSeqHasPrevStep(){return!!this.mainSeq&&this.mainSeq.hasPrev()}seekInteractiveSeqToEnd(e){const t=this.findSeq(e);t&&t.commonTimeNode.seekToEnd(!1,!0)}}var OM=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class DM extends C0{constructor(e,t,n){super({id:"stage",width:e.width,height:e.height,type:"Container",children:e.children},t,n),this.globalEventHub=new B.a,this.json=e,this.container.visible=!1,this.ctx=t,this.globalEventHub.on("c:prev slide",()=>{this.ctx.eventHub.emit(cs.prev)}),this.globalEventHub.on("c:next slide",()=>{this.ctx.eventHub.emit(cs.next)});const i=new na;i.drawRect(0,0,e.width,e.height),this.container.addChild(i)}get interactiveContainer(){return this.container}render(){const e=Object.create(null,{render:{get:()=>super.render}});return OM(this,void 0,void 0,function*(){yield e.render.call(this),this.ctx.eventHub.emit("StageRenderEnd")})}createTiming(){this.json.timing&&(this.timing=new LM(this.json.timing,this.globalEventHub,this.ctx))}startTiming(){var e;(e=this.timing)===null||e===void 0||e.start()}setMainSeqApplied(){var e;(e=this.timing)===null||e===void 0||e.setMainSeqApplied()}setMainSeqStep(e,t){var n;(n=this.timing)===null||n===void 0||n.setMainSeqStep(e,t)}collectMainSeqStartValue(){var e;(e=this.timing)===null||e===void 0||e.collectMainSeqStartValue()}hasTiming(){return!!this.timing}destroy(){var e;super.destroy(),this.ctx.eventHub.removeAllListeners(),this.ctx.graphicsTexture.destroy(),this.ctx.fillTexture.destroy(),this.globalEventHub.removeAllListeners(),(e=this.timing)===null||e===void 0||e.destroy()}mainSeqStep(){var e,t;return(t=(e=this.timing)===null||e===void 0?void 0:e.currentMainSeqStep())!==null&&t!==void 0?t:0}mainSeqLength(){var e,t;return(t=(e=this.timing)===null||e===void 0?void 0:e.currentMainSeqLength())!==null&&t!==void 0?t:0}mainSeqHasNextStep(){var e,t;return(t=(e=this.timing)===null||e===void 0?void 0:e.mainSeqHasNextStep())!==null&&t!==void 0&&t}mainSeqHasPrevStep(){var e,t;return(t=(e=this.timing)===null||e===void 0?void 0:e.mainSeqHasPrevStep())!==null&&t!==void 0&&t}mainSeqState(){return this.timing?this.timing.currentMainSeqState():null}nextStep(){var e;this.hasTiming()&&((e=this.timing)===null||e===void 0?void 0:e.hasMainSeq())?this.globalEventHub.emit("shape slide onNext"):this.ctx.eventHub.emit(cs.next)}prevStep(){var e;this.hasTiming()&&((e=this.timing)===null||e===void 0?void 0:e.hasMainSeq())?this.globalEventHub.emit("shape slide onPrev"):this.ctx.eventHub.emit(cs.prev)}applyInteractiveAction(e){this.globalEventHub.emit(e)}seekInteractiveSeqToEnd(e){var t;(t=this.timing)===null||t===void 0||t.seekInteractiveSeqToEnd(e)}}const qi=134217729;function O0(r,e,t,n,i){let o,s,a,h,u=e[0],c=n[0],d=0,f=0;c>u==c>-u?(o=u,u=e[++d]):(o=c,c=n[++f]);let m=0;if(d<r&&f<t)for(c>u==c>-u?(s=u+o,a=o-(s-u),u=e[++d]):(s=c+o,a=o-(s-c),c=n[++f]),o=s,a!==0&&(i[m++]=a);d<r&&f<t;)c>u==c>-u?(s=o+u,h=s-o,a=o-(s-h)+(u-h),u=e[++d]):(s=o+c,h=s-o,a=o-(s-h)+(c-h),c=n[++f]),o=s,a!==0&&(i[m++]=a);for(;d<r;)s=o+u,h=s-o,a=o-(s-h)+(u-h),u=e[++d],o=s,a!==0&&(i[m++]=a);for(;f<t;)s=o+c,h=s-o,a=o-(s-h)+(c-h),c=n[++f],o=s,a!==0&&(i[m++]=a);return o===0&&m!==0||(i[m++]=o),m}function NM(r,e){let t=e[0];for(let n=1;n<r;n++)t+=e[n];return t}function Gd(r){return new Float64Array(r)}const Vl=Gd(4),Eb=Gd(8),Mb=Gd(12),Ab=Gd(16),sr=Gd(4);function Em(r,e,t,n,i,o){const s=(e-o)*(t-i),a=(r-i)*(n-o),h=s-a;if(s===0||a===0||s>0!=a>0)return h;const u=Math.abs(s+a);return Math.abs(h)>=33306690738754716e-32*u?h:-function(c,d,f,m,g,v,x){let T,M,C,D,R,F,O,U,he,Q,X,Z,q,oe,fe,me,le,pe;const Pe=c-g,Ue=f-g,Fe=d-v,Y=m-v;oe=Pe*Y,F=qi*Pe,O=F-(F-Pe),U=Pe-O,F=qi*Y,he=F-(F-Y),Q=Y-he,fe=U*Q-(oe-O*he-U*he-O*Q),me=Fe*Ue,F=qi*Fe,O=F-(F-Fe),U=Fe-O,F=qi*Ue,he=F-(F-Ue),Q=Ue-he,le=U*Q-(me-O*he-U*he-O*Q),X=fe-le,R=fe-X,Vl[0]=fe-(X+R)+(R-le),Z=oe+X,R=Z-oe,q=oe-(Z-R)+(X-R),X=q-me,R=q-X,Vl[1]=q-(X+R)+(R-me),pe=Z+X,R=pe-Z,Vl[2]=Z-(pe-R)+(X-R),Vl[3]=pe;let $=NM(4,Vl),Me=22204460492503146e-32*x;if($>=Me||-$>=Me||(R=c-Pe,T=c-(Pe+R)+(R-g),R=f-Ue,C=f-(Ue+R)+(R-g),R=d-Fe,M=d-(Fe+R)+(R-v),R=m-Y,D=m-(Y+R)+(R-v),T===0&&M===0&&C===0&&D===0)||(Me=11093356479670487e-47*x+33306690738754706e-32*Math.abs($),$+=Pe*D+Y*T-(Fe*C+Ue*M),$>=Me||-$>=Me))return $;oe=T*Y,F=qi*T,O=F-(F-T),U=T-O,F=qi*Y,he=F-(F-Y),Q=Y-he,fe=U*Q-(oe-O*he-U*he-O*Q),me=M*Ue,F=qi*M,O=F-(F-M),U=M-O,F=qi*Ue,he=F-(F-Ue),Q=Ue-he,le=U*Q-(me-O*he-U*he-O*Q),X=fe-le,R=fe-X,sr[0]=fe-(X+R)+(R-le),Z=oe+X,R=Z-oe,q=oe-(Z-R)+(X-R),X=q-me,R=q-X,sr[1]=q-(X+R)+(R-me),pe=Z+X,R=pe-Z,sr[2]=Z-(pe-R)+(X-R),sr[3]=pe;const De=O0(4,Vl,4,sr,Eb);oe=Pe*D,F=qi*Pe,O=F-(F-Pe),U=Pe-O,F=qi*D,he=F-(F-D),Q=D-he,fe=U*Q-(oe-O*he-U*he-O*Q),me=Fe*C,F=qi*Fe,O=F-(F-Fe),U=Fe-O,F=qi*C,he=F-(F-C),Q=C-he,le=U*Q-(me-O*he-U*he-O*Q),X=fe-le,R=fe-X,sr[0]=fe-(X+R)+(R-le),Z=oe+X,R=Z-oe,q=oe-(Z-R)+(X-R),X=q-me,R=q-X,sr[1]=q-(X+R)+(R-me),pe=Z+X,R=pe-Z,sr[2]=Z-(pe-R)+(X-R),sr[3]=pe;const we=O0(De,Eb,4,sr,Mb);oe=T*D,F=qi*T,O=F-(F-T),U=T-O,F=qi*D,he=F-(F-D),Q=D-he,fe=U*Q-(oe-O*he-U*he-O*Q),me=M*C,F=qi*M,O=F-(F-M),U=M-O,F=qi*C,he=F-(F-C),Q=C-he,le=U*Q-(me-O*he-U*he-O*Q),X=fe-le,R=fe-X,sr[0]=fe-(X+R)+(R-le),Z=oe+X,R=Z-oe,q=oe-(Z-R)+(X-R),X=q-me,R=q-X,sr[1]=q-(X+R)+(R-me),pe=Z+X,R=pe-Z,sr[2]=Z-(pe-R)+(X-R),sr[3]=pe;const ke=O0(we,Mb,4,sr,Ab);return Ab[ke-1]}(r,e,t,n,i,o,u)}const Pb=Math.pow(2,-52),Mm=new Uint32Array(512);class D0{static from(e,t=UM,n=kM){const i=e.length,o=new Float64Array(2*i);for(let s=0;s<i;s++){const a=e[s];o[2*s]=t(a),o[2*s+1]=n(a)}return new D0(o)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:i,_hullHash:o}=this,s=e.length>>1;let a=1/0,h=1/0,u=-1/0,c=-1/0;for(let Q=0;Q<s;Q++){const X=e[2*Q],Z=e[2*Q+1];X<a&&(a=X),Z<h&&(h=Z),X>u&&(u=X),Z>c&&(c=Z),this._ids[Q]=Q}const d=(a+u)/2,f=(h+c)/2;let m,g,v,x=1/0;for(let Q=0;Q<s;Q++){const X=N0(d,f,e[2*Q],e[2*Q+1]);X<x&&(m=Q,x=X)}const T=e[2*m],M=e[2*m+1];x=1/0;for(let Q=0;Q<s;Q++){if(Q===m)continue;const X=N0(T,M,e[2*Q],e[2*Q+1]);X<x&&X>0&&(g=Q,x=X)}let C=e[2*g],D=e[2*g+1],R=1/0;for(let Q=0;Q<s;Q++){if(Q===m||Q===g)continue;const X=BM(T,M,C,D,e[2*Q],e[2*Q+1]);X<R&&(v=Q,R=X)}let F=e[2*v],O=e[2*v+1];if(R===1/0){for(let Z=0;Z<s;Z++)this._dists[Z]=e[2*Z]-e[0]||e[2*Z+1]-e[1];jl(this._ids,this._dists,0,s-1);const Q=new Uint32Array(s);let X=0;for(let Z=0,q=-1/0;Z<s;Z++){const oe=this._ids[Z];this._dists[oe]>q&&(Q[X++]=oe,q=this._dists[oe])}return this.hull=Q.subarray(0,X),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Em(T,M,C,D,F,O)<0){const Q=g,X=C,Z=D;g=v,C=F,D=O,v=Q,F=X,O=Z}const U=function(Q,X,Z,q,oe,fe){const me=Z-Q,le=q-X,pe=oe-Q,Pe=fe-X,Ue=me*me+le*le,Fe=pe*pe+Pe*Pe,Y=.5/(me*Pe-le*pe);return{x:Q+(Pe*Ue-le*Fe)*Y,y:X+(me*Fe-pe*Ue)*Y}}(T,M,C,D,F,O);this._cx=U.x,this._cy=U.y;for(let Q=0;Q<s;Q++)this._dists[Q]=N0(e[2*Q],e[2*Q+1],U.x,U.y);jl(this._ids,this._dists,0,s-1),this._hullStart=m;let he=3;n[m]=t[v]=g,n[g]=t[m]=v,n[v]=t[g]=m,i[m]=0,i[g]=1,i[v]=2,o.fill(-1),o[this._hashKey(T,M)]=m,o[this._hashKey(C,D)]=g,o[this._hashKey(F,O)]=v,this.trianglesLen=0,this._addTriangle(m,g,v,-1,-1,-1);for(let Q,X,Z=0;Z<this._ids.length;Z++){const q=this._ids[Z],oe=e[2*q],fe=e[2*q+1];if(Z>0&&Math.abs(oe-Q)<=Pb&&Math.abs(fe-X)<=Pb||(Q=oe,X=fe,q===m||q===g||q===v))continue;let me=0;for(let Fe=0,Y=this._hashKey(oe,fe);Fe<this._hashSize&&(me=o[(Y+Fe)%this._hashSize],me===-1||me===n[me]);Fe++);me=t[me];let le,pe=me;for(;le=n[pe],Em(oe,fe,e[2*pe],e[2*pe+1],e[2*le],e[2*le+1])>=0;)if(pe=le,pe===me){pe=-1;break}if(pe===-1)continue;let Pe=this._addTriangle(pe,q,n[pe],-1,-1,i[pe]);i[q]=this._legalize(Pe+2),i[pe]=Pe,he++;let Ue=n[pe];for(;le=n[Ue],Em(oe,fe,e[2*Ue],e[2*Ue+1],e[2*le],e[2*le+1])<0;)Pe=this._addTriangle(Ue,q,le,i[q],-1,i[Ue]),i[q]=this._legalize(Pe+2),n[Ue]=Ue,he--,Ue=le;if(pe===me)for(;le=t[pe],Em(oe,fe,e[2*le],e[2*le+1],e[2*pe],e[2*pe+1])<0;)Pe=this._addTriangle(le,q,pe,-1,i[pe],i[le]),this._legalize(Pe+2),i[le]=Pe,n[pe]=pe,he--,pe=le;this._hullStart=t[q]=pe,n[pe]=t[Ue]=q,n[q]=Ue,o[this._hashKey(oe,fe)]=q,o[this._hashKey(e[2*pe],e[2*pe+1])]=pe}this.hull=new Uint32Array(he);for(let Q=0,X=this._hullStart;Q<he;Q++)this.hull[Q]=X,X=n[X];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(n,i){const o=n/(Math.abs(n)+Math.abs(i));return(i>0?3-o:1+o)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:i}=this;let o=0,s=0;for(;;){const a=n[e],h=e-e%3;if(s=h+(e+2)%3,a===-1){if(o===0)break;e=Mm[--o];continue}const u=a-a%3,c=h+(e+1)%3,d=u+(a+2)%3,f=t[s],m=t[e],g=t[c],v=t[d];if(FM(i[2*f],i[2*f+1],i[2*m],i[2*m+1],i[2*g],i[2*g+1],i[2*v],i[2*v+1])){t[e]=v,t[a]=f;const x=n[d];if(x===-1){let M=this._hullStart;do{if(this._hullTri[M]===d){this._hullTri[M]=e;break}M=this._hullPrev[M]}while(M!==this._hullStart)}this._link(e,x),this._link(a,n[s]),this._link(s,d);const T=u+(a+1)%3;o<Mm.length&&(Mm[o++]=T)}else{if(o===0)break;e=Mm[--o]}}return s}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,n,i,o,s){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=n,this._link(a,i),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function N0(r,e,t,n){const i=r-t,o=e-n;return i*i+o*o}function FM(r,e,t,n,i,o,s,a){const h=r-s,u=e-a,c=t-s,d=n-a,f=i-s,m=o-a,g=c*c+d*d,v=f*f+m*m;return h*(d*v-g*m)-u*(c*v-g*f)+(h*h+u*u)*(c*m-d*f)<0}function BM(r,e,t,n,i,o){const s=t-r,a=n-e,h=i-r,u=o-e,c=s*s+a*a,d=h*h+u*u,f=.5/(s*u-a*h),m=(u*c-a*d)*f,g=(s*d-h*c)*f;return m*m+g*g}function jl(r,e,t,n){if(n-t<=20)for(let i=t+1;i<=n;i++){const o=r[i],s=e[o];let a=i-1;for(;a>=t&&e[r[a]]>s;)r[a+1]=r[a--];r[a+1]=o}else{let i=t+1,o=n;Hd(r,t+n>>1,i),e[r[t]]>e[r[n]]&&Hd(r,t,n),e[r[i]]>e[r[n]]&&Hd(r,i,n),e[r[t]]>e[r[i]]&&Hd(r,t,i);const s=r[i],a=e[s];for(;;){do i++;while(e[r[i]]<a);do o--;while(e[r[o]]>a);if(o<i)break;Hd(r,i,o)}r[t+1]=r[o],r[o]=s,n-i+1>=o-t?(jl(r,e,i,n),jl(r,e,t,o-1)):(jl(r,e,t,o-1),jl(r,e,i,n))}}function Hd(r,e,t){const n=r[e];r[e]=r[t],r[t]=n}function UM(r){return r[0]}function kM(r){return r[1]}function ls(r,e,t=5){return Math.abs(r-e)<=Math.pow(10,-t)}class Va{constructor(){this.point={x:0,y:0},this.slope=Math.PI/4}static fromPointSlope(e,t){const n=new Va;return n.point=e,n.slope=t,n}resolveY(e){return Math.tan(this.slope)*(e-this.point.x)+this.point.y}distanceToLinearEquation(e){return ls(this.slope,e.slope)?this.distanceToPoint(e.point):-1}distanceToPoint(e){let t=0;if(Math.tan(this.slope)*(e.x-this.point.x)+this.point.y===e.y)return 0;t=this.slope>=Math.PI/2?this.slope-Math.PI/2:Math.PI/2+this.slope;const n=Va.fromPointSlope(e,t),i=this.crossPoint(n);return i?Math.ceil(Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2))):0}crossPoint(e){if(ls(e.slope,this.slope))return null;let t=0,n=0;const i=Math.tan(e.slope),o=Math.tan(this.slope),{x:s,y:a}=this.point,{x:h,y:u}=e.point;return ls(this.slope,Math.PI/2)?(t=this.point.x,n=i*(t-h)+u):ls(e.slope,Math.PI/2)?(t=e.point.x,n=o*(t-s)+a):ls(this.slope,Math.PI)||ls(this.slope,0)?(n=this.point.y,t=(n-u)/i+h):ls(e.slope,Math.PI)||ls(e.slope,0)?(n=e.point.y,t=(n-a)/o+s):(t=(i*h-u+a-o*s)/(i-o),n=o*(t-s)+a),{x:t,y:n}}}function GM(r,e,t){return r.fillType==="solidFill"?function(n,i,o){const s=new na,[a,h]=function(u){const c=u.substring(1);return[parseInt(c.substring(0,6),16),parseInt(c.substring(6,8),16)/255]}(n.color);return s.beginFill(a,h),s.drawRect(0,0,i,o),s.endFill(),s}(r,e,t):r.fillType==="gradientFill"?function(n,i,o){let s=null;const a=new Ti;if(n.stopList.sort((u,c)=>u.pos-c.pos),!n.stopList.find(u=>u.pos===0)){const u=n.stopList[0];n.stopList.unshift({pos:0,color:u.color})}if(!n.stopList.find(u=>u.pos===1)){const u=n.stopList[n.stopList.length-1];n.stopList.push({pos:1,color:u.color})}const h=u=>{const c=[];for(let d=0,f=u.length;d<f-1;d++){const m=u[d],g=u[d+1],v=m.pos+.5*(g.pos-m.pos),x=wm(m.color,g.color,.5),T=2*d;c[T]=m,c[T+1]={color:x,pos:v},c[T+2]=g}return c};if(n.stopList=h(n.stopList),n.stopList=h(n.stopList),n.line?s=function(u,c,d){const f=c/2,m=d/2,g={x:-f,y:m},v={x:-f,y:-m},x={x:f,y:m},T={x:f,y:-m},M=Va.fromPointSlope({x:-f,y:0},Math.PI/2),C=Va.fromPointSlope({x:0,y:m},0),D=Va.fromPointSlope({x:f,y:0},Math.PI/2),R=Va.fromPointSlope({x:0,y:-m},0),F=[g,v,x,T],O=[M,C,D,R],U=[],he=u.stopList.slice(1,u.stopList.length-1).map(fe=>{var me,le;const pe=2*Math.PI;let Pe=(le=(me=u.line)===null||me===void 0?void 0:me.ang)!==null&&le!==void 0?le:0;for(;Pe>pe;)Pe-=pe;for(;Pe<0;)Pe+=pe;const Ue={x:0,y:0};ls(Pe,Math.PI/2)?(Ue.x=0,Ue.y=d/2-fe.pos*d):ls(Pe,0)?(Ue.x=fe.pos*c-c/2,Ue.y=0):(Ue.x=fe.pos*c-c/2,Ue.y=d/2-fe.pos*d),Pe>Math.PI/2&&Pe<=Math.PI&&(Ue.x*=-1),Pe>Math.PI&&Pe<=2*Math.PI&&(Ue.y*=-1);const Fe=Va.fromPointSlope(Ue,Math.PI/2-u.line.ang),Y=O.map(Me=>Fe.crossPoint(Me)).filter(Me=>Me&&Me.x<=f&&Me.x>=-f&&Me.y<=m&&Me.y>=-m).map(Me=>({point:Me,color:fe.color})).sort((Me,De)=>De.point.y-Me.point.y);U.push(...Y);let $=Math.abs(Y[1].point.x-Y[0].point.x)/10;for(let Me=20;Me--;){const De=Me%2==0?1:-1,we=Ue.x+De*$,ke=Fe.resolveY(we);we<=f&&we>=-f&&ke<=m&&ke>=-m&&U.push({point:{x:we,y:ke},color:fe.color}),$+=$}return Fe});let Q=[],X=[];e:for(let fe=0;fe<F.length;fe++){const me=F[fe];for(let Fe=0;Fe<he.length-1;Fe++){const Y=he[Fe],$=he[Fe+1],Me=Y.distanceToLinearEquation($),De=Y.distanceToPoint(me),we=$.distanceToPoint(me);if(De<Me&&we<Me){const ke=u.stopList.slice(1,u.stopList.length-1)[Fe],We=u.stopList.slice(1,u.stopList.length-1)[Fe+1],ge=wm(ke.color,We.color,De/Me);U.splice(Fe+1,0,{point:me,color:ge});continue e}}const le=he[0],pe=he[he.length-1],Pe=le.distanceToPoint(me),Ue=pe.distanceToPoint(me);Pe<=Ue?Q.push({point:me,dis:Pe}):X.push({point:me,dis:Ue})}Q=Q.sort((fe,me)=>me.dis-fe.dis);const Z=Q.map((fe,me)=>{if(me===0)return{point:fe.point,color:u.stopList[0].color};{const le=u.stopList[0].color,pe=u.stopList[1].color;return{point:fe.point,color:wm(le,pe,1-(Q[0].dis===0?1:fe.dis/Q[0].dis))}}}).sort((fe,me)=>me.point.y-fe.point.y);X=X.sort((fe,me)=>me.dis-fe.dis);const q=X.map((fe,me)=>{if(me===0)return{point:fe.point,color:u.stopList[u.stopList.length-1].color};{const le=u.stopList[u.stopList.length-2].color,pe=u.stopList[u.stopList.length-1].color;return{point:fe.point,color:wm(le,pe,X[0].dis===0?0:fe.dis/X[0].dis)}}}).sort((fe,me)=>me.point.y-fe.point.y),oe=Z.concat(...U).concat(q);for(let fe=0;fe<oe.length;fe++)oe[fe].point.x+=f,oe[fe].point.y=-oe[fe].point.y+m;return{points:oe,position:{x:0,y:0}}}(n,i,o):n.path&&(s=function(u,c,d){var f;const m=[],g={x:0,y:0};if(((f=u.path)===null||f===void 0?void 0:f.path)==="circle"){const v=c/2,x=d/2,T=Math.sqrt(v*v+x*x);u.stopList.forEach(M=>{if(M.pos===0)m.push({point:{x:0,y:0},color:M.color});else{const C=T*M.pos,D=new Fh;D.absellipse(0,0,C,C,0,2*Math.PI,!1,0),D.getPoints(50).forEach(R=>{m.push({point:{x:R.x,y:R.y},color:M.color})})}g.x=v,g.y=x})}return{points:m,position:g}}(n,i,o)),s){const u=[],c=[],{position:d,points:f}=s,m=D0.from(f,M=>M.point.x,M=>M.point.y);for(let M=0;M<m.triangles.length;M+=3)u.push(f[m.triangles[M]].point.x,f[m.triangles[M]].point.y),u.push(f[m.triangles[M+1]].point.x,f[m.triangles[M+1]].point.y),u.push(f[m.triangles[M+2]].point.x,f[m.triangles[M+2]].point.y),c.push(...Ha(f[m.triangles[M]].color)),c.push(...Ha(f[m.triangles[M+1]].color)),c.push(...Ha(f[m.triangles[M+2]].color));const g=new nu;g.addAttribute("aVertexPosition",u,2),g.addAttribute("aColor",c,4);const v=$s.from(`
        precision mediump float;
        attribute vec2 aVertexPosition;
        attribute vec4 aColor;
        uniform mat3 translationMatrix;
        uniform mat3 projectionMatrix;
        varying vec4 vColor;
        void main() {
            vColor = aColor;
            gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
        }`,`precision mediump float;    
        varying vec4 vColor;
        void main() {
            gl_FragColor = vColor;
        }
    `),x=new na;x.drawRect(0,0,i+1,o+1),a.mask=x,a.addChild(x);const T=new su(g,v);T.position.x=d.x,T.position.y=d.y,a.addChild(T)}return a}(r,e,t):null}const HM=[`
vec3 rgb2hsl(vec3 rgb) {
    float cMax = max(max(rgb.r, rgb.g), rgb.b);
    float cMin = min(min(rgb.r, rgb.g), rgb.b);
    float delta = cMax - cMin;
    
    float h = 0.0;
    if (delta == 0.0) {
        h = 0.0;
    } else if (cMax == rgb.r) {
        h = 60.0 * mod(((rgb.g - rgb.b) / delta), 6.0);
    } else if (cMax == rgb.g ) {
        h = 60.0 * ((rgb.b - rgb.r) / delta + 2.0);
    } else if (cMax == rgb.b) {
        h = 60.0 * ((rgb.r - rgb.g) / delta + 4.0);
    }
    
    float l = (cMax + cMin) / 2.0;
    
    float s = 0.0;
    if (delta == 0.0) {
        s = 0.0;
    } else {
        s = delta / (1.0 - abs(2.0 * l - 1.0));
    }
    
    return vec3(h, s, l);
}
`],zM={biLevel:`
vec4 transform(vec4 texColor, float arg) {
    vec3 hsl = rgb2hsl(texColor.rgb);
    mat3 rgb2yuv = mat3(
        0.2126, 0.7152, 0.0722,
        -0.09991, -0.33609, 0.43600,
        0.615, -0.5586, -0.05639
    );
    vec3 yuv = texColor.rgb * rgb2yuv;
    if (yuv.x >= 0.49 || texColor.a < 0.9) {
        return vec4(1.0, 1.0, 1.0, 1.0);
    } else {
        return vec4(0.0, 0.0, 0.0, 1.0);
    }
}
`};class VM extends Sr{constructor(e,t){var n;super(void 0,(n=zM[e],`
varying vec2 vTextureCoord;

uniform float arg;
uniform sampler2D uSampler;

${HM.map(i=>i+`
`).join(`
`)}

${n}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg);
}
`),{arg:t})}}var jM=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};class WM{constructor(e,t){this.renderTextures=[],this.textures=Object.create(null),this.fillStyles=[],this.renderer=e,this.spriteTextures=t}addTexture(e,t){this.textures[e]=t}render(e){return jM(this,void 0,void 0,function*(){const{items:t,width:n,height:i}=e,o=new Ti;t.forEach(u=>{if(u.item.blipFillObject)u.item.blipFillObject.position.x+=u.x+1,u.item.blipFillObject.position.y+=u.y+1,o.addChild(u.item.blipFillObject);else{const c=GM(u.item.fill,u.width-2,u.height-2);if(c)c.position.x+=u.x+1,c.position.y+=u.y+1,o.addChild(c);else{const d=new na;d.drawRect(0,0,u.width-2,u.height-2),o.addChild(d)}}if(u.item.name){const c=new _m(u.item.name,{fontFamily:"Arial",fontSize:12,fill:16715792,align:"center"});c.position.x=u.x+1,c.position.y=u.y+1,o.addChild(c)}});const s=new na;s.drawRect(0,0,Math.ceil(n),Math.ceil(i)),o.addChild(s);const a=this.renderer.plugins.extract.image(o),h=Ot.from(a);return o.destroy(!0),t.forEach(u=>{this.textures[u.item.id]=new Ot(h.baseTexture,new en(u.x+1,u.y+1,u.width-2,u.height-2))}),new Promise(u=>{a.addEventListener("load",()=>{u()})})})}getTexture(e){return this.textures[e]||this.spriteTextures.getTexture(e)||null}getGifFrames(e){return this.spriteTextures.getGifFrames(e)}addFill(e,t,n,i){const o=JSON.stringify(e)+t+n,s=A0()(o);if(this.textures[s]||this.fillStyles.findIndex(a=>a.id===s)>=0)return s;if(e.fillType!=="blipFill")this.fillStyles.push({fill:e,width:t,height:n,id:s,name:i});else{const a=this.spriteTextures.getTexture(e.src);if(a){const h=new Un;h.texture=a,e.filters.length>0&&(h.filters=function(u){const c=[];return u.forEach(d=>{["biLevel"].indexOf(d.type)>=0&&c.push(new VM(d.type,d.args[0]))}),c}(e.filters)),this.fillStyles.push({fill:e,width:a.width,height:a.height,id:s,blipFillObject:h})}}return s}pack(){const e=L0(this.fillStyles.filter(n=>!(!n.fill.fillType||n.fill.fillType==="noFill"||n.width===0||n.height===0)||(this.textures[n.id]=null,!1))),t=[];for(let n=0,i=e.length;n<i;n++){const o=e[n];t.push(this.render(o))}return Promise.all(t)}destroy(){this.textures=Object.create(null),this.fillStyles=[],this.renderTextures.forEach(e=>e.destroy(!0)),this.spriteTextures.destroy()}}function Rb(r,e,t){let n,i,o=e,s=t;o===0&&(o=s/1e4),s===0&&(s=o/1e4);const a=r%360;if(a%180==0)n=Math.cos(a*(Math.PI/180))*o,i=0;else if(a%90==0)n=0,i=-Math.sin(a*(Math.PI/180))*s;else{const h=Math.tan(a*Math.PI/180);n=o*s/Math.sqrt(Math.pow(s,2)+Math.pow(o*h,2)),(a>90&&a<270||a<-90&&a>-270)&&(n=-n),i=-h*n}return{x:n,y:i}}function XM(r,e,t,n,i,o,s){const a={x:0,y:0},h=-o,u=Rb((i=-i)/Math.PI*180,t,n),c=r.x-u.x,d=r.y-u.y;for(let f=0;f<51;f++){const m=Rb((i+f/50*h)/Math.PI*180,t,n);m.x+=c,m.y+=d,f/50==1&&(a.x=m.x,a.y=m.y),m.x=m.x/9525*e.x,m.y=m.y/9525*e.y,s.lineTo(m.x,m.y)}return a}class YM{constructor(e){this.renderTextures=[],this.idTidMap=Object.create(null),this.textures=Object.create(null),this.graphics=[],this.renderer=e}render(e){const{items:t,width:n,height:i}=e,o=to.create({width:n,height:i});this.renderTextures.push(o);const s=new Ti;t.forEach(a=>{const h=new Un;h.texture=a.item.texture,h.x=a.x,h.y=a.y,s.addChild(h)}),this.renderer.render(s,{renderTexture:o}),s.destroy({texture:!0,baseTexture:!0,children:!0}),t.forEach(a=>{this.textures[a.item.id]={texture:new Ot(o.baseTexture,new en(a.x,a.y,a.width,a.height)),pivot:a.item.pivot}})}getGraphicsData(e){const t=this.idTidMap[e]||"";return this.textures[t]||null}addGraphics(e,t,n,i,o,s,a,h){const u=h||Tb(),c=A0()(t+((s==null?void 0:s.width)||0).toString()+a);if(this.idTidMap[u]=c,this.graphics.findIndex(d=>d.id===c)<0){const{texture:d,pivot:f}=function(m,g,v,x,T,M=!0){var C,D,R,F,O,U;const he={x:Math.abs(T.x),y:Math.abs(T.y)},Q=window.devicePixelRatio,X=document.createElement("canvas"),Z=X.getContext("2d");if(!Z)throw new Error("ctx");Z.lineCap=(x==null?void 0:x.cap)||"butt",Z.lineJoin=(x==null?void 0:x.join)||"miter";let q=0,oe=0,fe=0,me=0,le=0,pe="none",Pe="none";return M?(q=g,oe=v,le=0,Pe="#ffffff"):(pe="#ffffff",le=(x==null?void 0:x.width)||0,fe=.5*((C=x==null?void 0:x.width)!==null&&C!==void 0?C:0),me=.5*((D=x==null?void 0:x.width)!==null&&D!==void 0?D:0),q=g+((R=x==null?void 0:x.width)!==null&&R!==void 0?R:0),oe=v+((F=x==null?void 0:x.width)!==null&&F!==void 0?F:0),he.x+=.5*((O=x==null?void 0:x.width)!==null&&O!==void 0?O:0),he.y+=.5*((U=x==null?void 0:x.width)!==null&&U!==void 0?U:0)),q+=Math.abs(T.x),oe+=Math.abs(T.y),fe+=Math.abs(T.x),me+=Math.abs(T.y),fe*=Q,me*=Q,q=Math.ceil(q*Q),oe=Math.ceil(oe*Q),X.width=q,X.height=oe,Z.transform(Q,0,0,Q,fe,me),m.forEach(Ue=>{Z.lineWidth=le,Z.strokeStyle=pe,Ue.fill!=="none"&&(Z.fillStyle=Pe),Z.beginPath();const{scale:Fe}=Ue,Y=Ue.path.trim().split(" ");let $={x:0,y:0};for(let Me=0;Me<Y.length;Me+=2){const De=Y[Me],we=Y[Me+1];if(De==="M"){let[ke,We]=we.split(",").map(ge=>Number(ge));$={x:ke,y:We},ke=ke/9525*Fe.x,We=We/9525*Fe.y,Z.moveTo(ke,We)}else if(De==="A"){const[ke,We,ge,W]=we.split(",").map(de=>Number(de));$=XM($,Fe,ke,We,ge,W,Z)}else if(De==="L"){let[ke,We]=we.split(",").map(ge=>Number(ge));$={x:ke,y:We},ke=ke/9525*Fe.x,We=We/9525*Fe.y,Z.lineTo(ke,We)}else if(De==="QB"){let[ke,We,ge,W]=we.split(",").map(de=>Number(de));$={x:ge,y:W},ke=ke/9525*Fe.x,We=We/9525*Fe.y,ge=ge/9525*Fe.x,W=W/9525*Fe.y,Z.quadraticCurveTo(ke,We,ge,W)}else if(De==="CB"){let[ke,We,ge,W,de,_e]=we.split(",").map(ye=>Number(ye));$={x:de,y:_e},ke=ke/9525*Fe.x,We=We/9525*Fe.y,ge=ge/9525*Fe.x,W=W/9525*Fe.y,de=de/9525*Fe.x,_e=_e/9525*Fe.y,Z.bezierCurveTo(ke,We,ge,W,de,_e)}else De==="C"&&Z.closePath()}Ue.hasStroke&&le>0&&Z.stroke(),Ue.fill!=="none"&&M&&Z.fill("nonzero")}),{texture:new Ot(new mn(X,{width:g,height:v,resolution:Q})),pivot:he}}(e,i,o,s,n,a);this.graphics.push({id:c,texture:d,pivot:f,width:d.width,height:d.height})}return u}pack(){L0(this.graphics).forEach(e=>{this.render(e)}),this.graphics.forEach(e=>{e.texture.destroy(!0)}),this.graphics=[]}destroy(){Object.keys(this.textures).forEach(e=>{var t;(t=this.textures[e])===null||t===void 0||t.texture.destroy()}),this.textures=Object.create(null),this.graphics=[],this.renderTextures.forEach(e=>e.destroy(!0))}}class qM{constructor(e){this.gifs=Object.create(null),this.textures=Object.create(null),this.spriteSheets=[],this.loader=e}getTexture(e){return this.textures[e]||null}getGifFrames(e){return this.gifs[e]?this.gifs[e].filter(t=>!!t):[]}loadSpriteSheets(e,t,n){return new Promise(i=>{this.loader.reset();for(const o of e)this.loader.add(o,`${t}/${n}/jsonOutput/${o}.json`);this.loader.load(o=>{for(const s of e){const a=o.resources[s].spritesheet;this.spriteSheets.push(a),Object.keys(a.textures).forEach(h=>{const u=h.match(/^(.+)_gif_(\d+)$/);if(u&&u[1]&&u[2]){const c=u[1];this.gifs[c]||(this.gifs[c]=[]);const d=parseInt(u[2],10);this.gifs[c][d]=a.textures[h]}else this.textures[h]=a.textures[h]})}i()})})}destroy(){this.spriteSheets.forEach(e=>e.destroy(!0)),this.loader.destroy()}}class ZM{constructor(){this.prevTime=-1,this.times=10,this.dur=0,this.valeList=[],this.value=0,this.calcFps()}calcFps(){requestAnimationFrame(e=>{const t=e-this.prevTime;this.dur+=t,this.times-=1,this.times===0&&(this.valeList.push(1e4/this.dur),this.times=10,this.dur=0,this.valeList.length>10&&(this.value=Math.round(this.valeList.reduce((n,i)=>n+i)/this.valeList.length),this.valeList=[])),this.prevTime=e,this.calcFps()})}}var zd=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})};window.PIXI=N,ee.skipHello();const Cb={randomBar:"RandomLines",circle:"Shape",ripple:"Ripples",wipe:"Erase",dissolve:"Dissolve",morph:"Smooth",fade:"FadeInOut",push:"Push",split:"Separation",reveal:"Display",pull:"Uncover",cover:"Cover",flash:"Flash",checker:"Checkerboard",blinds:"WindowShades",curtains:"Curtain",fallOver:"Fall",drape:"Suspension",wheel:"Clock",comb:"Combing",warp:"Scale",peelOff:"PeelOff",flip:"Flip"};class $M{constructor(e){this.eventHub=e,this.targets=Object.create(null)}addTarget(e,t){this.targets[e]=t}getTargetById(e){return this.targets[e]}getTarget(e,t,n={type:"el",index:0,id:""}){var i,o;let s=this.targets[e.id];return e.type!=="shape"?s:(e.type==="shape"&&e.txEl&&(s=(i=s==null?void 0:s.getTextElement(e.txEl.type,e.txEl.range))!==null&&i!==void 0?i:null),e.type==="shape"&&e.bg&&n.index===0&&(t=!1,s=(o=s==null?void 0:s.getBgElement())!==null&&o!==void 0?o:null,this.eventHub.emit("IterateTimeNodeEnd",n.id)),t&&s?s.getIterateEntry(n.type,n.index,n.id):s)}clearTargets(){this.targets=Object.create(null)}}const cs={prev:"gotoPrev",next:"gotoNext",goto:"gotoSlide"},pn={mainSeqStepChange:"mainSeqStepChange",mainSeqStateChange:"mainSeqStateChange",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",slideChange:"slideChange",renderStart:"renderStart",renderEnd:"renderEnd",hyperlinkTrigger:"hyperlinkTrigger",interactiveAnimTrigger:"interactiveAnimTrigger",animateStart:"animateStart",animateEnd:"animateEnd"};class JM extends B.a{constructor(e={}){super(),this.transactionPlayer=new WT,this.transactionSprite=new Un,this.isForward=!0,this.dynamicResolution=1,this.drawCall=0,this.fps=new ZM,this.width=0,this.height=0,this.currentIndex=0,this.slideCount=0,this.frameList=[],this.runtime={drawCall:0,fps:0},this.handlePrevSlide=()=>zd(this,void 0,void 0,function*(){const i=this.currentIndex-1;i>=1&&(this.isForward=!1,yield this.renderSlide(i))}),this.handleNextSlide=()=>zd(this,void 0,void 0,function*(){const i=this.currentIndex+1;i<=this.slideCount&&(this.isForward=!0,yield this.renderSlide(i))}),this.handleGotoSlide=i=>{i<=this.slideCount&&i>=1&&this.renderSlide(i)},this.config={minFPS:Object(ie.isUndefined)(e.minFPS)?40:e.minFPS,maxFPS:Object(ie.isUndefined)(e.maxFPS)?50:e.maxFPS,resolution:Object(ie.isUndefined)(e.resolution)?window.devicePixelRatio:e.resolution,autoResolution:!Object(ie.isUndefined)(e.autoResolution)&&e.autoResolution,minResolution:Object(ie.isUndefined)(e.minResolution)?1:e.minResolution,autoFPS:!Object(ie.isUndefined)(e.autoFPS)&&e.autoFPS},this.app=new Sd({antialias:!0,autoDensity:!0,backgroundColor:16777215}),this.updateConfig(this.config),this.app.view.style.zIndex="1",this.app.stage.sortableChildren=!0;const t=this.app.renderer,{drawElements:n}=t.gl;t.gl.drawElements=(...i)=>{n.call(t.gl,...i),this.drawCall+=1},this.app.ticker.add(i=>{this.runtime.drawCall=this.drawCall,this.drawCall=0;const o=1e3/(i/(Et.TARGET_FPMS||.06));if(this.frameList.push(o),this.frameList.length>50){const s=this.frameList.reduce((a,h)=>a+h)/this.frameList.length;if(this.runtime.fps=Math.floor(s),this.fps.value<this.config.minFPS)this.dynamicResolution=this.app.renderer.resolution-.1,this.dynamicResolution=Math.max(this.config.minResolution,this.dynamicResolution),this.dynamicResolution<=this.config.minResolution&&this.config.autoFPS&&(this.app.ticker.minFPS-=2,this.app.ticker.maxFPS-=2);else if(this.fps.value>1.08*this.config.minFPS&&this.fps.value<=this.config.maxFPS){const a=Math.min(this.app.ticker.minFPS+2,this.config.minFPS),h=Math.min(this.app.ticker.maxFPS+2,this.config.maxFPS);a<=this.config.minFPS&&(this.app.ticker.minFPS=a),h<=this.config.maxFPS&&(this.app.ticker.maxFPS=h),a>=this.config.minFPS&&h>=this.config.maxFPS&&(this.dynamicResolution+=.1,this.dynamicResolution=Math.max(this.config.minResolution,this.dynamicResolution))}this.config.autoResolution&&this.dynamicResolution!==this.app.renderer.resolution&&this.app.ticker.addOnce(()=>{const a=Math.min(this.dynamicResolution,this.config.resolution);this.app.renderer.resolution=a,this.app.renderer.plugins.interaction.resolution=this.app.renderer.resolution,this.app.renderer.resize(this.width,this.height)},wr.HIGH),this.frameList=[]}},null,wr.LOW)}get view(){return this.app.view}updateConfig(e){Object(ie.isUndefined)(e.minFPS)||(this.config.minFPS=e.minFPS,this.app.ticker.minFPS=e.minFPS),Object(ie.isUndefined)(e.maxFPS)||(this.config.maxFPS=e.maxFPS,this.app.ticker.maxFPS=e.maxFPS),Object(ie.isUndefined)(e.resolution)||(this.config.resolution=e.resolution,this.app.ticker.addOnce(()=>{this.app.renderer.resolution=e.resolution||window.devicePixelRatio,this.app.renderer.plugins.interaction.resolution=this.app.renderer.resolution,this.app.renderer.resize(this.width,this.height)},wr.HIGH)),Object(ie.isUndefined)(e.autoResolution)||(this.config.autoResolution=e.autoResolution),Object(ie.isUndefined)(e.autoFPS)||(this.config.autoFPS=e.autoFPS),Object(ie.isUndefined)(e.minResolution)||(this.config.minResolution=e.minResolution)}setResourceData(e,t){this.taskId=e,this.url=t}setInteractive(e){this.app.stage.interactive=e,this.app.stage.interactiveChildren=e}loadSlide(e){return zd(this,void 0,void 0,function*(){const t=new qM(this.app.loader),n=new B.a,i={renderer:this.app.renderer,graphicsTexture:new YM(this.app.renderer),fillTexture:new WM(this.app.renderer,t),stageWidth:0,stageHeight:0,ticker:this.app.ticker,timingTargets:new $M(n),eventHub:n},o=yield(yield fetch(`${this.url}/${this.taskId}/jsonOutput/slide-${e}.json`)).json(),{width:s,height:a,sheets:h}=o;yield t.loadSpriteSheets(h,this.url,this.taskId),i.stageWidth=s,i.stageHeight=a;const u=new DM(o,i,{x:0,y:0});return i.eventHub.on(cs.prev,this.handlePrevSlide),i.eventHub.on(cs.next,this.handleNextSlide),i.eventHub.on(cs.goto,this.handleGotoSlide),this.translateEvent(i.eventHub,[pn.mainSeqStepChange,pn.mainSeqStateChange,pn.hyperlinkTrigger,pn.interactiveAnimTrigger,pn.mainSeqStepStart,pn.mainSeqStepEnd,pn.animateStart,pn.animateEnd]),u.preRender(),yield i.fillTexture.pack(),i.graphicsTexture.pack(),{stage:u,json:o}})}translateEvent(e,t){t.forEach(n=>{e.on(n,(...i)=>{this.emit(n,...i)})})}renderSlide(e){return zd(this,void 0,void 0,function*(){this.emit(pn.renderStart,e),this.currentIndex=Number(e);const t=yield this.loadSlide(e),{width:n,height:i,slideCount:o}=t.json;let s;this.slideCount=o,this.app.view.style.width=n+"px",this.app.view.style.height=i+"px",this.app.renderer.resize(n,i),this.width=n,this.height=i,this.currentStage&&(t.json.transition&&t.json.transition.type&&(s=this.getBase64(this.currentStage)),this.prevStage=this.currentStage),this.currentStage=t,yield t.stage.render(),t.stage.createTiming(),t.stage.container.visible=!0,t.stage.collectMainSeqStartValue(),this.isForward?t.stage.setMainSeqStep(0,"start"):t.stage.setMainSeqStep(-1,"end");const a=this.getBase64(this.currentStage);t.stage.container.visible=!1,this.app.stage.addChild(t.stage.container),s&&a&&t.json.transition&&t.json.transition.type&&(yield this.playTransaction(s,a,t.json.transition)),this.prevStage&&(this.app.stage.removeChild(this.prevStage.stage.container),this.prevStage.stage.destroy(),this.prevStage=void 0),this.isForward?t.stage.startTiming():t.stage.setMainSeqApplied(),t.stage.container.visible=!0,this.emit(pn.renderEnd,e),this.emit(pn.slideChange,e)})}getBase64(e){const{width:t,height:n}=e.json,i=to.create({width:t,height:n});return this.app.renderer.render(e.stage.container,{renderTexture:i}),this.app.renderer.plugins.extract.base64(i,"image/jpeg")}playTransaction(e,t,n){return zd(this,void 0,void 0,function*(){const i=this.app.view.parentElement;if(e&&t&&i&&Cb[n.type]){this.transactionSprite.zIndex=999,this.app.stage.addChild(this.transactionSprite);const o=this.transactionPlayer.renderer.domElement,s=Ot.from(o),a=()=>s.update();this.app.ticker.add(a),this.transactionSprite.texture=s;const{width:h,height:u}=this.currentStage.json;return new Promise(c=>{var d,f;this.transactionPlayer.play({reverse:!this.isForward,prevTextureUrl:e,nextTextureUrl:t,textureWidth:h,textureHeight:u,presetType:Cb[n.type],stageWidth:h,stageHeight:u,duration:(f=(d=this.currentStage)===null||d===void 0?void 0:d.json.transition)===null||f===void 0?void 0:f.dur,delay:0,onTransactionEnd:()=>{c(),this.app.stage.removeChild(this.transactionSprite),this.app.ticker.remove(a)}})})}return Promise.resolve()})}nextStep(){var e;(e=this.currentStage)===null||e===void 0||e.stage.nextStep()}prevStep(){var e;(e=this.currentStage)===null||e===void 0||e.stage.prevStep()}mainSeqLength(){var e,t;return(t=(e=this.currentStage)===null||e===void 0?void 0:e.stage.mainSeqLength())!==null&&t!==void 0?t:0}mainSeqStep(){var e,t;return(t=(e=this.currentStage)===null||e===void 0?void 0:e.stage.mainSeqStep())!==null&&t!==void 0?t:0}setMainSeqStep(e,t){var n;(n=this.currentStage)===null||n===void 0||n.stage.setMainSeqStep(e,t)}mainSeqState(){var e,t;return(t=(e=this.currentStage)===null||e===void 0?void 0:e.stage.mainSeqState())!==null&&t!==void 0?t:null}mainSeqHasNextStep(){var e,t;return(t=(e=this.currentStage)===null||e===void 0?void 0:e.stage.mainSeqHasNextStep())!==null&&t!==void 0&&t}mainSeqHasPrevStep(){var e,t;return(t=(e=this.currentStage)===null||e===void 0?void 0:e.stage.mainSeqHasPrevStep())!==null&&t!==void 0&&t}nextTick(e){this.app.ticker.addOnce(()=>{e()},wr.LOW)}applyInteractiveAction(e){var t;(t=this.currentStage)===null||t===void 0||t.stage.applyInteractiveAction(e)}seekInteractiveSeqToEnd(e){var t;(t=this.currentStage)===null||t===void 0||t.stage.seekInteractiveSeqToEnd(e)}pause(){this.app.ticker.stop()}resume(){this.app.ticker.start()}destroy(){this.prevStage&&this.prevStage.stage.destroy(),this.currentStage&&this.currentStage.stage.destroy()}}var Vd,au=[],Ib="ResizeObserver loop completed with undelivered notifications.";(function(r){r.BORDER_BOX="border-box",r.CONTENT_BOX="content-box",r.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(Vd||(Vd={}));var F0,hu=function(r){return Object.freeze(r)},KM=function(r,e){this.inlineSize=r,this.blockSize=e,hu(this)},Lb=function(){function r(e,t,n,i){return this.x=e,this.y=t,this.width=n,this.height=i,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,hu(this)}return r.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},r.fromRect=function(e){return new r(e.x,e.y,e.width,e.height)},r}(),B0=function(r){return r instanceof SVGElement&&"getBBox"in r},Ob=function(r){if(B0(r)){var e=r.getBBox(),t=e.width,n=e.height;return!t&&!n}var i=r,o=i.offsetWidth,s=i.offsetHeight;return!(o||s||r.getClientRects().length)},Db=function(r){var e,t;if(r instanceof Element)return!0;var n=(t=(e=r)===null||e===void 0?void 0:e.ownerDocument)===null||t===void 0?void 0:t.defaultView;return!!(n&&r instanceof n.Element)},jd=typeof window!="undefined"?window:{},Am=new WeakMap,Nb=/auto|scroll/,QM=/^tb|vertical/,eA=/msie|trident/i.test(jd.navigator&&jd.navigator.userAgent),ds=function(r){return parseFloat(r||"0")},Wl=function(r,e,t){return r===void 0&&(r=0),e===void 0&&(e=0),t===void 0&&(t=!1),new KM((t?e:r)||0,(t?r:e)||0)},Fb=hu({devicePixelContentBoxSize:Wl(),borderBoxSize:Wl(),contentBoxSize:Wl(),contentRect:new Lb(0,0,0,0)}),Bb=function(r,e){if(e===void 0&&(e=!1),Am.has(r)&&!e)return Am.get(r);if(Ob(r))return Am.set(r,Fb),Fb;var t=getComputedStyle(r),n=B0(r)&&r.ownerSVGElement&&r.getBBox(),i=!eA&&t.boxSizing==="border-box",o=QM.test(t.writingMode||""),s=!n&&Nb.test(t.overflowY||""),a=!n&&Nb.test(t.overflowX||""),h=n?0:ds(t.paddingTop),u=n?0:ds(t.paddingRight),c=n?0:ds(t.paddingBottom),d=n?0:ds(t.paddingLeft),f=n?0:ds(t.borderTopWidth),m=n?0:ds(t.borderRightWidth),g=n?0:ds(t.borderBottomWidth),v=d+u,x=h+c,T=(n?0:ds(t.borderLeftWidth))+m,M=f+g,C=a?r.offsetHeight-M-r.clientHeight:0,D=s?r.offsetWidth-T-r.clientWidth:0,R=i?v+T:0,F=i?x+M:0,O=n?n.width:ds(t.width)-R-D,U=n?n.height:ds(t.height)-F-C,he=O+v+D+T,Q=U+x+C+M,X=hu({devicePixelContentBoxSize:Wl(Math.round(O*devicePixelRatio),Math.round(U*devicePixelRatio),o),borderBoxSize:Wl(he,Q,o),contentBoxSize:Wl(O,U,o),contentRect:new Lb(d,h,O,U)});return Am.set(r,X),X},Ub=function(r,e,t){var n=Bb(r,t),i=n.borderBoxSize,o=n.contentBoxSize,s=n.devicePixelContentBoxSize;switch(e){case Vd.DEVICE_PIXEL_CONTENT_BOX:return s;case Vd.BORDER_BOX:return i;default:return o}},tA=function(r){var e=Bb(r);this.target=r,this.contentRect=e.contentRect,this.borderBoxSize=hu([e.borderBoxSize]),this.contentBoxSize=hu([e.contentBoxSize]),this.devicePixelContentBoxSize=hu([e.devicePixelContentBoxSize])},kb=function(r){if(Ob(r))return 1/0;for(var e=0,t=r.parentNode;t;)e+=1,t=t.parentNode;return e},nA=function(){var r=1/0,e=[];au.forEach(function(i){if(i.activeTargets.length!==0){var o=[];i.activeTargets.forEach(function(s){var a=new tA(s.target),h=kb(s.target);o.push(a),s.lastReportedSize=Ub(s.target,s.observedBox),h<r&&(r=h)}),e.push(function(){i.callback.call(i.observer,o,i.observer)}),i.activeTargets.splice(0,i.activeTargets.length)}});for(var t=0,n=e;t<n.length;t++)(0,n[t])();return r},Gb=function(r){au.forEach(function(e){e.activeTargets.splice(0,e.activeTargets.length),e.skippedTargets.splice(0,e.skippedTargets.length),e.observationTargets.forEach(function(t){t.isActive()&&(kb(t.target)>r?e.activeTargets.push(t):e.skippedTargets.push(t))})})},iA=function(){var r,e=0;for(Gb(e);au.some(function(t){return t.activeTargets.length>0});)e=nA(),Gb(e);return au.some(function(t){return t.skippedTargets.length>0})&&(typeof ErrorEvent=="function"?r=new ErrorEvent("error",{message:Ib}):((r=document.createEvent("Event")).initEvent("error",!1,!1),r.message=Ib),window.dispatchEvent(r)),e>0},Hb=[],rA=function(r){if(!F0){var e=0,t=document.createTextNode("");new MutationObserver(function(){return Hb.splice(0).forEach(function(n){return n()})}).observe(t,{characterData:!0}),F0=function(){t.textContent=""+(e?e--:e++)}}Hb.push(r),F0()},U0=0,oA={attributes:!0,characterData:!0,childList:!0,subtree:!0},zb=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],Vb=function(r){return r===void 0&&(r=0),Date.now()+r},k0=!1,G0=new(function(){function r(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return r.prototype.run=function(e){var t=this;if(e===void 0&&(e=250),!k0){k0=!0;var n,i=Vb(e);n=function(){var o=!1;try{o=iA()}finally{if(k0=!1,e=i-Vb(),!U0)return;o?t.run(1e3):e>0?t.run(e):t.start()}},rA(function(){requestAnimationFrame(n)})}},r.prototype.schedule=function(){this.stop(),this.run()},r.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,oA)};document.body?t():jd.addEventListener("DOMContentLoaded",t)},r.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),zb.forEach(function(t){return jd.addEventListener(t,e.listener,!0)}))},r.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),zb.forEach(function(t){return jd.removeEventListener(t,e.listener,!0)}),this.stopped=!0)},r}()),jb=function(r){!U0&&r>0&&G0.start(),!(U0+=r)&&G0.stop()},sA=function(){function r(e,t){this.target=e,this.observedBox=t||Vd.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return r.prototype.isActive=function(){var e,t=Ub(this.target,this.observedBox,!0);return e=this.target,B0(e)||function(n){switch(n.tagName){case"INPUT":if(n.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||getComputedStyle(e).display!=="inline"||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},r}(),aA=function(r,e){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=r,this.callback=e},Pm=new WeakMap,Wb=function(r,e){for(var t=0;t<r.length;t+=1)if(r[t].target===e)return t;return-1},Rm=function(){function r(){}return r.connect=function(e,t){var n=new aA(e,t);Pm.set(e,n)},r.observe=function(e,t,n){var i=Pm.get(e),o=i.observationTargets.length===0;Wb(i.observationTargets,t)<0&&(o&&au.push(i),i.observationTargets.push(new sA(t,n&&n.box)),jb(1),G0.schedule())},r.unobserve=function(e,t){var n=Pm.get(e),i=Wb(n.observationTargets,t),o=n.observationTargets.length===1;i>=0&&(o&&au.splice(au.indexOf(n),1),n.observationTargets.splice(i,1),jb(-1))},r.disconnect=function(e){var t=this,n=Pm.get(e);n.observationTargets.slice().forEach(function(i){return t.unobserve(e,i.target)}),n.activeTargets.splice(0,n.activeTargets.length)},r}(),hA=function(){function r(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Rm.connect(this,e)}return r.prototype.observe=function(e,t){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Db(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Rm.observe(this,e,t)},r.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Db(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Rm.unobserve(this,e)},r.prototype.disconnect=function(){Rm.disconnect(this)},r.toString=function(){return"function ResizeObserver () { [polyfill code] }"},r}(),uA=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})},lA=function(r,e){var t,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(u){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||c[0]!==6&&c[0]!==2)){s=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){s.label=c[1];break}if(c[0]===6&&s.label<i[1]){s.label=i[1],i=c;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(c);break}i[2]&&s.ops.pop(),s.trys.pop();continue}c=e.call(r,s)}catch(d){c=[6,d],n=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([h,u])}}},cA=function(){function r(e,t,n,i){this.state="idle",this.index=-1,this.slideIndex=-1,this.fn=n,this.index=e,this.slideIndex=t,this.eventHub=i}return r.prototype.apply=function(){return uA(this,void 0,void 0,function(){var e;return lA(this,function(t){switch(t.label){case 0:this.eventHub.emit("task-start",this),t.label=1;case 1:return t.trys.push([1,3,,4]),this.state="start",[4,this.fn()];case 2:return t.sent(),this.state="end",this.eventHub.emit("task-end",this),[3,4];case 3:return e=t.sent(),this.eventHub.emit("task-error",{task:this,error:e}),[3,4];case 4:return[2]}})})},r}(),dA=function(){function r(){var e=this;this.eventHub=new B.a,this.tasks=[],this.index=0,this.eventHub.on("task-end",function(t){var n,i=e.tasks.findIndex(function(s){return s.index===t.index}),o=i+1;o>=0&&((n=e.tasks[o])===null||n===void 0||n.apply()),i>=0&&(e.tasks.splice(i,1),e.replaceIdleTask())}),this.eventHub.on("task-error",function(t){var n=t.task,i=e.tasks.findIndex(function(o){return o.index===n.index});i>=0&&(e.tasks.splice(i,1),e.replaceIdleTask())})}return r.prototype.replaceIdleTask=function(){for(var e,t=this,n=new Set,i=0,o=this.tasks.length;i<o;i++)this.tasks[i].state==="idle"&&((e=this.tasks[i+1])===null||e===void 0?void 0:e.state)==="idle"&&n.add(i);Array.from(n).forEach(function(s){t.tasks.splice(s,1)})},r.prototype.addTask=function(e,t){var n=new cA(this.index++,t,e,this.eventHub);this.tasks.push(n),this.tasks.sort(function(i,o){return i.index-o.index}),this.replaceIdleTask(),this.tasks.length===1&&n.apply()},r.prototype.hasStartTask=function(){return this.tasks.some(function(e){return e.state==="start"})},r}(),pA=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})},fA=function(r,e){var t,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(u){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||c[0]!==6&&c[0]!==2)){s=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){s.label=c[1];break}if(c[0]===6&&s.label<i[1]){s.label=i[1],i=c;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(c);break}i[2]&&s.ops.pop(),s.trys.pop();continue}c=e.call(r,s)}catch(d){c=[6,d],n=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([h,u])}}};function mA(r,e){return pA(this,void 0,void 0,function(){var t;return fA(this,function(n){switch(n.label){case 0:t=Date.now(),n.label=1;case 1:return!r()&&Date.now()-t<e?[4,(i=50,new Promise(function(o){return setTimeout(o,i)}))]:[3,3];case 2:return n.sent(),[3,1];case 3:return[2]}var i})})}var gA=function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])})(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Xb=function(r,e,t,n){return new(t||(t=Promise))(function(i,o){function s(u){try{h(n.next(u))}catch(c){o(c)}}function a(u){try{h(n.throw(u))}catch(c){o(c)}}function h(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,a)}h((n=n.apply(r,e||[])).next())})},Yb=function(r,e){var t,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(u){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||c[0]!==6&&c[0]!==2)){s=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){s.label=c[1];break}if(c[0]===6&&s.label<i[1]){s.label=i[1],i=c;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(c);break}i[2]&&s.ops.pop(),s.trys.pop();continue}c=e.call(r,s)}catch(d){c=[6,d],n=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([h,u])}}},vA=window.ResizeObserver||hA,ar={syncDispatch:"syncDispatch",syncReceive:"syncReceive",renderStart:"renderStart",renderEnd:"renderEnd",renderError:"renderError",slideChange:"slideChange",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",animateStart:"animateStart",animateEnd:"animateEnd"},_A=function(r){function e(t){var n=r.call(this)||this;return n.__slideState={taskId:"",url:"",currentSlideIndex:-1,mainSeqStep:-1,mainSeqState:null,appliedInteractiveSeqIds:[]},n.isAnimating=!1,n.renderingTaskManager=new dA,n.isLoading=!1,n.interactive=!0,n.player=new JM,n.frameWidth=1,n.frameHeight=1,n.frame=document.createElement("div"),n.frameResizeObserver=new vA(function(i){return n.frameResizeHandler(i)}),n.anchor=t.anchor,n.interactive=t.interactive,n.player.setInteractive(n.interactive),n.player.updateConfig(t.renderOptions||{}),n.frame.style.cssText="width:100%;height:100%;display:flex;justify-content:center;align-items:center",n.frame.appendChild(n.player.view),n.anchor.appendChild(n.frame),n.frameResizeObserver.observe(n.frame),n.player.on(pn.renderStart,function(i){n.isLoading=!0,n.emit(ar.renderStart,i)}),n.player.on(pn.renderEnd,function(i){n.isLoading=!1,n.emit(ar.renderEnd,i)}),n.player.on(pn.slideChange,function(i){n.__slideState.currentSlideIndex=i,n.emit(ar.slideChange,i)}),n.player.on(pn.mainSeqStateChange,function(i){n.__slideState.mainSeqState=i}),n.player.on(pn.mainSeqStepChange,function(i){n.__slideState.mainSeqStep=i}),n.player.on(pn.animateStart,function(){n.isAnimating!==!0&&(n.isAnimating=!0,n.emit(ar.animateStart))}),n.player.on(pn.animateEnd,function(){n.isAnimating!==!1&&(n.isAnimating=!1,n.emit(ar.animateEnd))}),n.player.on(pn.interactiveAnimTrigger,function(i){var o=i.action,s=i.seqId;n.__slideState.appliedInteractiveSeqIds.push(s),n.emit(ar.syncDispatch,{type:"interactiveAnim",action:o})}),n.player.on(pn.mainSeqStepStart,Object(ie.throttle)(function(i){n.emit(ar.mainSeqStepStart)},100)),n.player.on(pn.mainSeqStepEnd,Object(ie.throttle)(function(i){n.emit(ar.mainSeqStepEnd)},100)),n.on(ar.syncReceive,n.receiveSyncHandler),n.renderingTaskManager.eventHub.on("task-error",function(i){var o=i.error,s=i.task;n.emit(ar.renderError,{error:o,index:s.slideIndex})}),n}return gA(e,r),e.prototype.frameResizeHandler=function(t){var n=t[0].contentRect,i=n.width,o=n.height;this.frameWidth=i,this.frameHeight=o,this.resizeView()},e.prototype.resizeView=function(){var t=this.width,n=this.height;if(t>0&&n>0){var i=this.frameWidth/t,o=i*n;o>this.frameHeight&&(i*=this.frameHeight/o),this.view.style.transform="scale("+i+")"}},e.prototype.receiveSyncHandler=function(t){var n=this;t.type==="nextStep"?this.mainSeqStep===t.next-1||this.mainSeqStep+1===this.mainSeqLength?this.nextStep(!0):(this.setMainSeqStep(t.next,"start"),this.player.nextTick(function(){n.nextStep(!0)})):t.type==="prevStep"?this.mainSeqStep===0&&this.mainSeqState==="idle"||this.mainSeqStep===t.next+1||this.mainSeqStep+1===this.mainSeqLength?this.prevStep(!0):(this.setMainSeqStep(t.next+1,"start"),this.player.nextTick(function(){n.prevStep(!0)})):t.type==="interactiveAnim"?this.player.applyInteractiveAction(t.action):t.type==="renderSlide"&&this.renderSlide(t.index,!0)},e.prototype.setSlideState=function(t){return Xb(this,void 0,void 0,function(){var n,i=this;return Yb(this,function(o){switch(o.label){case 0:return t.taskId&&t.taskId!==this.__slideState.taskId&&(this.__slideState.taskId=t.taskId,this.player.setResourceData(t.taskId,this.__slideState.url)),t.url&&t.url!==this.__slideState.url&&(this.__slideState.url=t.url,this.player.setResourceData(this.__slideState.taskId,t.url)),Number.isInteger(t.currentSlideIndex)&&t.currentSlideIndex!==this.__slideState.currentSlideIndex?(this.__slideState.currentSlideIndex=t.currentSlideIndex,[4,this.renderSlide(t.currentSlideIndex)]):[3,2];case 1:o.sent(),o.label=2;case 2:return[4,mA(function(){return i.player.currentIndex===t.currentSlideIndex&&i.player.currentStage},3e3)];case 3:return o.sent(),n=!1,Number.isInteger(t.mainSeqStep)&&t.mainSeqStep!==this.__slideState.mainSeqStep&&(n=!0,this.__slideState.mainSeqStep=t.mainSeqStep),t.mainSeqState&&t.mainSeqState!==this.__slideState.mainSeqState&&(n=!0,this.__slideState.mainSeqState=t.mainSeqState),n&&this.setMainSeqStep(this.__slideState.mainSeqStep,this.__slideState.mainSeqState==="idle"?"start":"end"),t.appliedInteractiveSeqIds&&t.appliedInteractiveSeqIds.length>0&&(this.__slideState.appliedInteractiveSeqIds=t.appliedInteractiveSeqIds,t.appliedInteractiveSeqIds.forEach(function(s){i.player.seekInteractiveSeqToEnd(s)})),[2]}})})},Object.defineProperty(e.prototype,"slideCount",{get:function(){return this.player.slideCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"slideState",{get:function(){return this.__slideState.mainSeqState=this.mainSeqState,this.__slideState.mainSeqStep=this.mainSeqStep,JSON.parse(JSON.stringify(this.__slideState))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mainSeqLength",{get:function(){return this.player.mainSeqLength()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mainSeqStep",{get:function(){return this.player.mainSeqStep()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mainSeqState",{get:function(){return this.player.mainSeqState()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderOptions",{get:function(){return this.player.config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawCall",{get:function(){return this.player.runtime.drawCall},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderFps",{get:function(){return this.player.runtime.fps},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"runtimeFps",{get:function(){return this.player.fps.value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this.player.view},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.player.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.player.height},enumerable:!1,configurable:!0}),e.prototype.updateRenderOption=function(t){this.player.updateConfig(t)},e.prototype.setResource=function(t,n){this.player.setResourceData(t,n),this.__slideState.taskId=t,this.__slideState.url=n,this.emit(ar.syncDispatch,{type:"setResource",taskId:t,url:n})},e.prototype._renderSlide=function(t,n){return n===void 0&&(n=!1),Xb(this,void 0,void 0,function(){return Yb(this,function(i){switch(i.label){case 0:return this.isLoading=!0,[4,this.player.renderSlide(t)];case 1:return i.sent(),this.__slideState.currentSlideIndex=t,this.isLoading=!1,this.resizeView(),n||this.emit(ar.syncDispatch,{type:"renderSlide",index:t}),[2]}})})},e.prototype.renderSlide=function(t,n){var i=this;n===void 0&&(n=!1);var o=Number(t);(o!==this.player.currentIndex||this.renderingTaskManager.hasStartTask())&&(o>this.slideCount&&this.slideCount>0||this.renderingTaskManager.addTask(function(){return i._renderSlide(o,n)},o))},e.prototype.nextStep=function(t){if(t===void 0&&(t=!1),!this.isLoading){this.player.nextStep();var n=this.player.mainSeqStep();this.__slideState.mainSeqStep=n,t||this.emit(ar.syncDispatch,{type:"nextStep",next:n})}},e.prototype.prevStep=function(t){if(t===void 0&&(t=!1),!this.isLoading){this.player.prevStep();var n=this.player.mainSeqStep();this.__slideState.mainSeqStep=n,t||this.emit(ar.syncDispatch,{type:"prevStep",next:n})}},e.prototype.setMainSeqStep=function(t,n){this.player.setMainSeqStep(t,n)},e.prototype.setInteractive=function(t){this.interactive=t,this.player.setInteractive(t)},e.prototype.pause=function(){this.player.pause()},e.prototype.resume=function(){this.player.resume()},e.prototype.destroy=function(){this.frameResizeObserver.disconnect(),this.player.removeAllListeners(),this.player.destroy(),this.player.removeAllListeners();try{this.anchor.removeChild(this.player.view)}catch{}},e}(B.a)}]);function SA(tt){const ce="http://www.w3.org/2000/svg",_=document.createElementNS(ce,"svg");_.setAttribute("class",`${tt}-footer-icon-sidebar`),_.setAttribute("viewBox","0 0 64 64");const b=document.createElementNS(ce,"path");return b.setAttribute("fill","currentColor"),b.setAttribute("d","M50 8H14c-3.309 0-6 2.691-6 6v36c0 3.309 2.691 6 6 6h36c3.309 0 6-2.691 6-6V14c0-3.309-2.691-6-6-6zM12 50V14c0-1.103.897-2 2-2h8v40h-8c-1.103 0-2-.897-2-2zm40 0c0 1.103-.897 2-2 2H26V12h24c1.103 0 2 .897 2 2z"),_.appendChild(b),_}function EA(tt){const ce="http://www.w3.org/2000/svg",_=document.createElementNS(ce,"svg");_.setAttribute("class",`${tt}-footer-icon-arrow-left`),_.setAttribute("viewBox","0 0 500 500");const b=document.createElementNS(ce,"path");return b.setAttribute("fill","currentColor"),b.setAttribute("d","M177.81 249.959L337.473 90.295c2.722-2.865 2.651-7.378-.143-10.1-2.793-2.65-7.163-2.65-9.956 0l-164.75 164.75c-2.793 2.793-2.793 7.306 0 10.1l164.75 164.75c2.865 2.722 7.378 2.65 10.099-.143 2.651-2.794 2.651-7.163 0-9.957L177.809 249.959z"),_.appendChild(b),_}function MA(tt){const ce="http://www.w3.org/2000/svg",_=document.createElementNS(ce,"svg");_.setAttribute("class",`${tt}-footer-icon-arrow-right`),_.setAttribute("viewBox","0 0 500 500");const b=document.createElementNS(ce,"path");return b.setAttribute("fill","currentColor"),b.setAttribute("d","M322.19 250.041L162.527 409.705c-2.722 2.865-2.651 7.378.143 10.1 2.793 2.65 7.163 2.65 9.956 0l164.75-164.75c2.793-2.793 2.793-7.306 0-10.1l-164.75-164.75c-2.865-2.722-7.378-2.65-10.099.143-2.651 2.794-2.651 7.163 0 9.957l159.664 159.736z"),_.appendChild(b),_}function AA(tt){const ce="http://www.w3.org/2000/svg",_=document.createElementNS(ce,"svg");_.setAttribute("class",`${tt}-footer-icon-play`),_.setAttribute("viewBox","0 0 500 500");const b=document.createElementNS(ce,"path");return b.setAttribute("fill","currentColor"),b.setAttribute("d","M418.158 257.419L174.663 413.33c-6.017 3.919-15.708 3.772-21.291-.29-2.791-2.018-4.295-4.483-4.295-7.084V94.109c0-5.65 6.883-10.289 15.271-10.289 4.298 0 8.391 1.307 11.181 3.332l242.629 155.484c6.016 3.917 6.451 10.292.649 14.491-.216.154-.432.154-.649.292zM170.621 391.288l223.116-141.301L170.71 107.753l-.089 283.535z"),_.appendChild(b),_}function PA(tt){const ce="http://www.w3.org/2000/svg",_=document.createElementNS(ce,"svg");_.setAttribute("class",`${tt}-footer-icon-pause`),_.setAttribute("viewBox","0 0 500 500");const b=document.createElementNS(ce,"path");return b.setAttribute("fill","currentColor"),b.setAttribute("d","M312.491 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261zM165.257 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261z"),_.appendChild(b),_}class RA{constructor({readonly:ce,box:_,onNewPageIndex:b,onPlay:ee}){this._pages=[],this.pageIndex=0,this.setPaused=()=>{this.$btnPlay.classList.toggle(this.wrapClassName("footer-btn-playing"),!1)},this.setPlaying=()=>{this.$btnPlay.classList.toggle(this.wrapClassName("footer-btn-playing"),!0)},this.namespace="netless-app-slide",this.isShowPreview=!1,this.isSmallBox=!1,this.sideEffect=new V0,this.readonly=ce,this.box=_,this.onNewPageIndex=b,this.onPlay=ee,this.render()}set pages(ce){this._pages=ce,this.refreshPreview(),this.refreshTotalPage(),this.refreshBtnSidebar()}get pages(){return this._pages}mount(){this.box.mountContent(this.$content),this.box.mountFooter(this.$footer),this.sideEffect.add(()=>{const ce=new wA({container:this.$preview,elements_selector:`.${this.wrapClassName("preview-page>img")}`});return()=>ce.destroy()},"preview-lazyload")}unmount(){this.$content.remove(),this.$footer.remove()}setReadonly(ce){this.readonly!==ce&&(this.readonly=ce,this.$content.classList.toggle(this.wrapClassName("readonly"),ce),this.$footer.classList.toggle(this.wrapClassName("readonly"),ce),this.$pageNumberInput.disabled=ce)}destroy(){this.sideEffect.flushAll(),this.unmount()}setPageIndex(ce){Number.isNaN(ce)||(this.pageIndex=ce,this.$pageNumberInput.value=String(ce+1))}refreshTotalPage(){this.$totalPage.textContent=" / "+this.pages.length}setSmallBox(ce){this.isSmallBox!==ce&&(this.isSmallBox=ce,this.$footer.classList.toggle(this.wrapClassName("float-footer"),ce))}render(){return this.renderContent(),this.renderFooter(),this.$content}renderContent(){if(!this.$content){const ce=document.createElement("div");ce.className=this.wrapClassName("content"),this.$content=ce,this.readonly&&ce.classList.add(this.wrapClassName("readonly")),ce.appendChild(this.renderPreviewMask()),ce.appendChild(this.renderPreview())}return this.$content}renderPreview(){if(!this.$preview){const ce=document.createElement("div");ce.className=this.wrapClassName("preview")+" tele-fancy-scrollbar",this.$preview=ce,this.refreshPreview(),this.sideEffect.addEventListener(ce,"click",_=>{var ee;if(this.readonly)return;const b=(ee=_.target.dataset)==null?void 0:ee.pageIndex;b&&(_.preventDefault(),_.stopPropagation(),_.stopImmediatePropagation(),this.onNewPageIndex(Number(b)),this.togglePreview(!1))})}return this.$preview}refreshPreview(){const{$preview:ce}=this,_=this.wrapClassName("preview-page"),b=this.wrapClassName("preview-page-name");for(;ce.firstChild;)ce.firstChild.remove();this.pages.forEach((ee,N)=>{var re;const ne=(re=ee.thumbnail)!=null?re:ee.src.startsWith("ppt")?void 0:ee.src;if(!ne)return;const B=String(N),ie=document.createElement("a");ie.className=_+" "+this.wrapClassName(`preview-page-${N}`),ie.setAttribute("href","#"),ie.dataset.pageIndex=B;const V=document.createElement("span");V.className=b,V.textContent=String(N+1),V.dataset.pageIndex=B;const K=document.createElement("img");K.width=ee.width,K.height=ee.height,K.dataset.src=ne,K.dataset.pageIndex=B,ie.appendChild(K),ie.appendChild(V),ce.appendChild(ie)})}renderPreviewMask(){return this.$previewMask||(this.$previewMask=document.createElement("div"),this.$previewMask.className=this.wrapClassName("preview-mask"),this.sideEffect.addEventListener(this.$previewMask,"click",ce=>{this.readonly||ce.target===this.$previewMask&&this.togglePreview(!1)})),this.$previewMask}refreshBtnSidebar(){this.$btnSidebar.style.display=this.pages.length>0?"inline-block":"none"}renderFooter(){if(!this.$footer){const ce=document.createElement("div");ce.className=this.wrapClassName("footer"),this.$footer=ce,this.readonly&&ce.classList.add(this.wrapClassName("readonly")),this.isSmallBox&&ce.classList.add(this.wrapClassName("float-footer"));const _=this.renderFooterBtn("btn-sidebar",SA(this.namespace));this.sideEffect.addEventListener(_,"click",()=>{this.readonly||this.togglePreview()}),this.$btnSidebar=_,this.$btnSidebar.style.display="none",this.$footer.appendChild(_);const b=document.createElement("div");b.className=this.wrapClassName("page-jumps");const ee=this.renderFooterBtn("btn-page-back",EA(this.namespace));if(this.sideEffect.addEventListener(ee,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex-1)}),b.appendChild(ee),this.onPlay){const V=this.renderFooterBtn("btn-page-play",AA(this.namespace),PA(this.namespace));this.$btnPlay=V,this.sideEffect.addEventListener(V,"click",()=>{this.readonly||(this.setPlaying(),this.onPlay&&this.onPlay())}),b.appendChild(V)}const N=this.renderFooterBtn("btn-page-next",MA(this.namespace));this.sideEffect.addEventListener(N,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex+1)}),b.appendChild(N);const ne=document.createElement("div");ne.className=this.wrapClassName("page-number");const B=document.createElement("input");B.className=this.wrapClassName("page-number-input"),B.value=String(this.pageIndex+1),this.readonly&&(B.disabled=!0),this.$pageNumberInput=B,this.sideEffect.addEventListener(B,"change",()=>{this.readonly||B.value&&this.onNewPageIndex(Number(B.value)-1)});const ie=document.createElement("span");ie.textContent=" / \u2026",this.$totalPage=ie,ne.appendChild(B),ne.appendChild(ie),this.$footer.appendChild(b),this.$footer.appendChild(ne)}return this.$footer}renderFooterBtn(ce,_,b){const ee=document.createElement("button");return ee.className=this.wrapClassName("footer-btn")+" "+this.wrapClassName(ce),ee.appendChild(_),b&&ee.appendChild(b),ee}togglePreview(ce){if(this.isShowPreview=ce!=null?ce:!this.isShowPreview,this.$content.classList.toggle(this.wrapClassName("preview-active"),this.isShowPreview),this.isShowPreview){const _=this.$preview.querySelector("."+this.wrapClassName(`preview-page-${this.pageIndex}`));_&&this.$preview.scrollTo({top:_.offsetTop-16})}}wrapClassName(ce){return`${this.namespace}-${ce}`}}function CA(tt,ce,_){return Math.min(Math.max(tt,ce),_)}const IA=new Set(["clicker","selector"]);class LA{constructor({displayer:ce,whiteboardView:_,readonly:b,box:ee,createSlide:N,setSceneIndex:ne,mountWhiteboard:B,refreshScenes:ie}){this.sideEffect=new V0,this.setPlaying=()=>{this.viewer.setPlaying()},this.setPaused=()=>{this.viewer.setPaused()},this.onSlideChange=V=>{this.slide.slideCount!==this.pages.length&&(this.pages=this.makePages()),this.refreshScenes(),this.updateSlideScale(),this.getPageIndex()!==V-1&&this.setSceneIndex(V-1),this.viewer.setPageIndex(V-1)},this.onPlayPPT=()=>this.slide.nextStep(),this.updateSlideScale=()=>{const{width:V,height:K}=this.$slide.getBoundingClientRect(),{scrollWidth:re,scrollHeight:Te}=this.slide.view,Ne=Math.min(V/re,K/Te);this.$slide.style.setProperty("--netless-app-slide-scale",String(Ne))},this._scaleDocsToFitImpl=()=>{const V=this.slide;V&&this.whiteboardView.moveCameraToContain({originX:-V.width/2,originY:-V.height/2,width:V.width,height:V.height,animationMode:"immediately"})},this._scaleDocsToFitDebounced=()=>{this.sideEffect.setTimeout(this._scaleDocsToFitImpl,1e3,"_scaleDocsToFitDebounced")},this.scaleDocsToFit=()=>{this._scaleDocsToFitImpl(),this._scaleDocsToFitDebounced()},this.onNewPageIndex=V=>{this.jumpToPage(V)},this.whiteboardView=_,this.readonly=b,this.box=ee,this.displayer=ce,this.createSlide=N,this.setSceneIndex=ne,this.mountWhiteboard=B,this.refreshScenes=ie,this.viewer=new RA({readonly:b,box:ee,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlayPPT}),this.render()}set pages(ce){this.viewer.pages=ce}get pages(){return this.viewer.pages}mount(){return this.viewer.mount(),this.slide=this.createSlide(this.$slide,this.getPageIndex()+1),this.jumpToPage(this.getPageIndex()),this.scaleDocsToFit(),this.sideEffect.add(()=>(this.whiteboardView.callbacks.on("onSizeUpdated",this.scaleDocsToFit),()=>{this.whiteboardView.callbacks.off("onSizeUpdated",this.scaleDocsToFit)})),this.slide.on(Io.SLIDE_EVENTS.slideChange,this.onSlideChange),this.slide.on(Io.SLIDE_EVENTS.mainSeqStepStart,this.setPlaying),this.slide.on(Io.SLIDE_EVENTS.mainSeqStepEnd,this.setPaused),this.slide.on(Io.SLIDE_EVENTS.renderStart,this.setPlaying),this.slide.on(Io.SLIDE_EVENTS.renderEnd,this.setPaused),this.slide.on(Io.SLIDE_EVENTS.renderError,ce=>{console.warn("[Slide] render error",ce)}),this}makePages(){const{width:ce,height:_,slideCount:b,slideState:ee}=this.slide,{taskId:N,url:ne}=ee,B=[];for(let ie=1;ie<=b;++ie)B.push({width:ce,height:_,thumbnail:`${ne}/${N}/preview/${ie}.png`,src:"ppt"});return B}unmount(){return this.slide.destroy(),this.viewer.unmount(),this}setReadonly(ce){this.readonly!==ce&&(this.readonly=ce,this.viewer.setReadonly(ce))}destroy(){this.sideEffect.flushAll(),this.unmount(),this.viewer.destroy()}getPageIndex(){return this.displayer.state.sceneState.index}jumpToPage(ce){this.pages.length<=0||(ce=CA(ce,0,this.pages.length-1),ce!==this.getPageIndex()&&(this.slide.renderSlide(ce+1),this.setSceneIndex(ce),this.scaleDocsToFit()),ce!==this.viewer.pageIndex&&this.viewer.setPageIndex(ce))}render(){this.viewer.$content.appendChild(this.renderSlideContainer()),this.viewer.$content.appendChild(this.renderMask()),this.viewer.$content.appendChild(this.renderWhiteboardView()),this.sideEffect.addEventListener(window,"keydown",ce=>{if(this.box.focus)switch(ce.key){case"ArrowUp":case"ArrowLeft":{this.slide.prevStep();break}case"ArrowRight":case"ArrowDown":{this.slide.nextStep();break}}}),this.sideEffect.add(()=>{const ce=new ResizeObserver(this.updateSlideScale);return ce.observe(this.$slide),()=>ce.disconnect()})}toggleClickThrough(ce){this.$whiteboardView.style.pointerEvents=!ce||IA.has(ce)?"none":"auto"}renderSlideContainer(){if(!this.$slide){const ce=document.createElement("div");ce.className=this.wrapClassName("slide"),ce.dataset.appKind="Slide",this.$slide=ce}return this.$slide}renderMask(){if(!this.$mask){const ce=document.createElement("div");ce.className=this.wrapClassName("mask"),this.$mask=ce;const _=document.createElement("button");_.className=this.wrapClassName("back");const b=document.createElement("button");b.className=this.wrapClassName("next")}return this.$mask}renderWhiteboardView(){return this.$whiteboardView||(this.$whiteboardView=document.createElement("div"),this.$whiteboardView.className=this.wrapClassName("wb-view"),this.mountWhiteboard(this.$whiteboardView)),this.$whiteboardView}wrapClassName(ce){return"netless-app-slide-"+ce}}var OA=`.netless-app-slide-content{position:relative;height:100%;overflow:hidden}.netless-app-slide-preview-mask{display:none;position:absolute;z-index:200;top:0;left:0;width:100%;height:100%}.netless-app-slide-preview{display:flex;flex-direction:column;align-items:center;position:absolute;z-index:300;top:0;left:0;width:33%;max-width:200px;height:100%;padding-top:10px;transform:translate(-100%);background:rgba(237,237,240,.9);box-shadow:inset -1px 0 #0000001c;transition:transform .4s}.netless-app-slide-preview-active .netless-app-slide-preview-mask{display:block}.netless-app-slide-preview-active .netless-app-slide-preview{transform:translate(0)}.netless-app-slide-preview-page{position:relative;display:block;width:55%;margin-bottom:10px;font-size:0;color:transparent;outline:none;border:7px solid transparent;border-radius:4px;transition:border-color .3s;user-select:none}.netless-app-slide-preview-page:hover,.netless-app-slide-preview-page.netless-app-slide-preview-page-active{border-color:#444e601a}.netless-app-slide-preview-page>img{width:100%;height:auto;box-sizing:border-box;border:1px solid rgba(0,0,0,.5);border-radius:1px;background-color:#fff;box-shadow:0 2px 8px #0000004d}.netless-app-slide-preview-page-name{position:absolute;top:1px;left:-10px;transform:translate(-100%);text-align:right;font-size:12px;color:#5f5f5f;user-select:none}.netless-app-slide-footer{box-sizing:border-box;height:26px;display:flex;align-items:center;padding:0 16px;border-top:1px solid #eeeef7;color:#191919}.netless-app-slide-float-footer{width:100%;min-height:26px;position:absolute;left:0;bottom:0;z-index:2000;background:rgba(249,249,252,.9);transition:opacity .4s}.netless-app-slide-footer-btn{box-sizing:border-box;width:26px;height:26px;font-size:0;margin:0;padding:3px;border:none;border-radius:1px;outline:none;color:currentColor;background:transparent;transition:background .4s;cursor:pointer;user-select:none}.netless-app-slide-footer-btn:hover{background:rgba(237,237,240,.9)}.netless-app-slide-footer-btn>svg{width:100%;height:100%}.netless-app-slide-footer-btn>svg:nth-of-type(2){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(1){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(2){display:initial}.netless-app-slide-footer-btn~.netless-app-slide-footer-btn{margin-left:15px}.netless-app-slide-page-jumps{flex:1;display:flex;justify-content:center;align-items:center}.netless-app-slide-page-number{margin-left:auto;font-size:13px;user-select:none;white-space:nowrap;word-break:keep-all}.netless-app-slide-page-number-input{border:none;outline:none;width:1.5em;text-align:right;border-radius:2px;color:currentColor;background:transparent;transition:background .4s;user-select:text}.netless-app-slide-page-number-input:hover,.netless-app-slide-page-number-input:focus,.netless-app-slide-page-number-input:active{background:#fff;box-shadow:#63636333 0 2px 8px}.netless-app-slide-readonly .netless-app-slide-footer-btn{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-footer-btn:hover{background:transparent}.netless-app-slide-readonly .netless-app-slide-page-number-input{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-page-number-input:hover,.netless-app-slide-readonly .netless-app-slide-page-number-input:focus,.netless-app-slide-readonly .netless-app-slide-page-number-input:active{background:transparent;box-shadow:none}.netless-app-slide-readonly .netless-app-slide-page-number-input:disabled{color:inherit}.netless-app-slide-readonly.netless-app-slide-float-footer{display:none}.netless-app-slide-wb-view{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;overflow:hidden}.netless-app-slide-slide{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.netless-app-slide-slide canvas{transform:scale(var(--netless-app-slide-scale, 1))}
`;const UA={kind:"Slide",setup(tt){const ce=tt.getDisplayer(),_=tt.getBox(),b=tt.getView(),ee=TA(tt,{state:null,taskId:"",url:""});if(!b)throw new Error("[Slide]: no whiteboard view.");_.mountStyles(OA);const N=new V0;let ne;const B=(Ne,Le)=>{const S=new Io.Slide({anchor:Ne,interactive:!0});S.setResource(ee.taskId,ee.url),ee.state?S.setSlideState(JSON.parse(JSON.stringify(ee.state))):S.renderSlide(Le);const A=`channel-${tt.appId}`;return S.on(Io.SLIDE_EVENTS.syncDispatch,I=>{tt.updateAttributes(["state"],S.slideState);const z=tt.getRoom();z&&z.dispatchMagixEvent(A,{type:Io.SLIDE_EVENTS.syncDispatch,payload:I})}),N.add(()=>{const I=z=>{if(z.event===A&&z.authorId!==ce.observerId){const{type:L,payload:G}=z.payload;L===Io.SLIDE_EVENTS.syncDispatch&&S.emit(Io.SLIDE_EVENTS.syncReceive,G)}};return ce.addMagixEventListener(A,I),()=>ce.removeMagixEventListener(A)}),ne=S,S},ie=tt.getInitScenePath(),V=()=>{const Ne=tt.getRoom();if((ne==null?void 0:ne.slideCount)&&ie&&Ne&&tt.getIsWritable()){const Le=ne.slideCount,S=`${ie}/${Le}`;if(Ne.scenePathType(S)==="none"){Ne.removeScenes(ie);const A=[];for(let I=1;I<=Le;++I)A.push({name:`${I}`});Ne.putScenes(ie,A),tt.setScenePath(`${ie}/${ne.slideState.currentSlideIndex||1}`)}}},K=Ne=>{var Le;(Le=tt.getRoom())==null||Le.setSceneIndex(Ne)},re=new LA({displayer:ce,whiteboardView:b,createSlide:B,box:_,mountWhiteboard:tt.mountView.bind(tt),readonly:_.readonly,setSceneIndex:K,refreshScenes:V}).mount(),Te=tt.getRoom();Te&&(re.toggleClickThrough(Te.state.memberState.currentApplianceName),N.add(()=>{const Ne=Le=>{Le.memberState&&re.toggleClickThrough(Le.memberState.currentApplianceName)};return Te.callbacks.on("onRoomStateChanged",Ne),()=>Te.callbacks.off("onRoomStateChanged",Ne)})),tt.emitter.on("sceneStateChange",Ne=>{re.jumpToPage(Ne.index)}),_.events.on("readonly",Ne=>{re.setReadonly(Ne)}),tt.emitter.on("destroy",()=>{console.log("[Slide]: destroy"),N.flushAll()})}};export{UA as default};
