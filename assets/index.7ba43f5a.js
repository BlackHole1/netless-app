var Rg=Object.defineProperty;var Ym=Object.getOwnPropertySymbols;var Ig=Object.prototype.hasOwnProperty,Lg=Object.prototype.propertyIsEnumerable;var qm=(Ie,C,T)=>C in Ie?Rg(Ie,C,{enumerable:!0,configurable:!0,writable:!0,value:T}):Ie[C]=T,Zm=(Ie,C)=>{for(var T in C||(C={}))Ig.call(C,T)&&qm(Ie,T,C[T]);if(Ym)for(var T of Ym(C))Lg.call(C,T)&&qm(Ie,T,C[T]);return Ie};import{s as Fm}from"./side-effect-manager.es.5f289aa4.js";import{L as Og}from"./lazyload.esm.0a4b6d46.js";import{e as Dg}from"./ensure-attributes.2c659353.js";var Ea=function(Ie){var C={};function T(J){if(C[J])return C[J].exports;var G=C[J]={i:J,l:!1,exports:{}};return Ie[J].call(G.exports,G,G.exports,T),G.l=!0,G.exports}return T.m=Ie,T.c=C,T.d=function(J,G,lt){T.o(J,G)||Object.defineProperty(J,G,{enumerable:!0,get:lt})},T.r=function(J){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(J,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(J,"__esModule",{value:!0})},T.t=function(J,G){if(1&G&&(J=T(J)),8&G||4&G&&typeof J=="object"&&J&&J.__esModule)return J;var lt=Object.create(null);if(T.r(lt),Object.defineProperty(lt,"default",{enumerable:!0,value:J}),2&G&&typeof J!="string")for(var Z in J)T.d(lt,Z,function(W){return J[W]}.bind(null,Z));return lt},T.n=function(J){var G=J&&J.__esModule?function(){return J.default}:function(){return J};return T.d(G,"a",G),G},T.o=function(J,G){return Object.prototype.hasOwnProperty.call(J,G)},T.p="",T(T.s=30)}([function(Ie,C,T){var J=Object.prototype.hasOwnProperty,G="~";function lt(){}function Z(nt,ct,Nt){this.fn=nt,this.context=ct,this.once=Nt||!1}function W(nt,ct,Nt,Xt,Gt){if(typeof Nt!="function")throw new TypeError("The listener must be a function");var L=new Z(Nt,Xt||nt,Gt),F=G?G+ct:ct;return nt._events[F]?nt._events[F].fn?nt._events[F]=[nt._events[F],L]:nt._events[F].push(L):(nt._events[F]=L,nt._eventsCount++),nt}function mt(nt,ct){--nt._eventsCount==0?nt._events=new lt:delete nt._events[ct]}function et(){this._events=new lt,this._eventsCount=0}Object.create&&(lt.prototype=Object.create(null),new lt().__proto__||(G=!1)),et.prototype.eventNames=function(){var nt,ct,Nt=[];if(this._eventsCount===0)return Nt;for(ct in nt=this._events)J.call(nt,ct)&&Nt.push(G?ct.slice(1):ct);return Object.getOwnPropertySymbols?Nt.concat(Object.getOwnPropertySymbols(nt)):Nt},et.prototype.listeners=function(nt){var ct=G?G+nt:nt,Nt=this._events[ct];if(!Nt)return[];if(Nt.fn)return[Nt.fn];for(var Xt=0,Gt=Nt.length,L=new Array(Gt);Xt<Gt;Xt++)L[Xt]=Nt[Xt].fn;return L},et.prototype.listenerCount=function(nt){var ct=G?G+nt:nt,Nt=this._events[ct];return Nt?Nt.fn?1:Nt.length:0},et.prototype.emit=function(nt,ct,Nt,Xt,Gt,L){var F=G?G+nt:nt;if(!this._events[F])return!1;var z,rt,k=this._events[F],X=arguments.length;if(k.fn){switch(k.once&&this.removeListener(nt,k.fn,void 0,!0),X){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,ct),!0;case 3:return k.fn.call(k.context,ct,Nt),!0;case 4:return k.fn.call(k.context,ct,Nt,Xt),!0;case 5:return k.fn.call(k.context,ct,Nt,Xt,Gt),!0;case 6:return k.fn.call(k.context,ct,Nt,Xt,Gt,L),!0}for(rt=1,z=new Array(X-1);rt<X;rt++)z[rt-1]=arguments[rt];k.fn.apply(k.context,z)}else{var tt,ht=k.length;for(rt=0;rt<ht;rt++)switch(k[rt].once&&this.removeListener(nt,k[rt].fn,void 0,!0),X){case 1:k[rt].fn.call(k[rt].context);break;case 2:k[rt].fn.call(k[rt].context,ct);break;case 3:k[rt].fn.call(k[rt].context,ct,Nt);break;case 4:k[rt].fn.call(k[rt].context,ct,Nt,Xt);break;default:if(!z)for(tt=1,z=new Array(X-1);tt<X;tt++)z[tt-1]=arguments[tt];k[rt].fn.apply(k[rt].context,z)}}return!0},et.prototype.on=function(nt,ct,Nt){return W(this,nt,ct,Nt,!1)},et.prototype.once=function(nt,ct,Nt){return W(this,nt,ct,Nt,!0)},et.prototype.removeListener=function(nt,ct,Nt,Xt){var Gt=G?G+nt:nt;if(!this._events[Gt])return this;if(!ct)return mt(this,Gt),this;var L=this._events[Gt];if(L.fn)L.fn!==ct||Xt&&!L.once||Nt&&L.context!==Nt||mt(this,Gt);else{for(var F=0,z=[],rt=L.length;F<rt;F++)(L[F].fn!==ct||Xt&&!L[F].once||Nt&&L[F].context!==Nt)&&z.push(L[F]);z.length?this._events[Gt]=z.length===1?z[0]:z:mt(this,Gt)}return this},et.prototype.removeAllListeners=function(nt){var ct;return nt?(ct=G?G+nt:nt,this._events[ct]&&mt(this,ct)):(this._events=new lt,this._eventsCount=0),this},et.prototype.off=et.prototype.removeListener,et.prototype.addListener=et.prototype.on,et.prefixed=G,et.EventEmitter=et,Ie.exports=et},function(Ie,C,T){(function(J,G){var lt;/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var Z="Expected a function",W="__lodash_placeholder__",mt=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],et="[object Arguments]",nt="[object Array]",ct="[object Boolean]",Nt="[object Date]",Xt="[object Error]",Gt="[object Function]",L="[object GeneratorFunction]",F="[object Map]",z="[object Number]",rt="[object Object]",k="[object RegExp]",X="[object Set]",tt="[object String]",ht="[object Symbol]",ue="[object WeakMap]",je="[object ArrayBuffer]",te="[object DataView]",xt="[object Float32Array]",zt="[object Float64Array]",Vt="[object Int8Array]",$="[object Int16Array]",Dt="[object Int32Array]",Ht="[object Uint8Array]",Yt="[object Uint16Array]",kt="[object Uint32Array]",Qt=/\b__p \+= '';/g,de=/\b(__p \+=) '' \+/g,Ke=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ke=/&(?:amp|lt|gt|quot|#39);/g,$n=/[&<>"']/g,Qe=RegExp(ke.source),Kn=RegExp($n.source),kn=/<%-([\s\S]+?)%>/g,qn=/<%([\s\S]+?)%>/g,bn=/<%=([\s\S]+?)%>/g,Nr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kr=/^\w*$/,Ir=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Jr=/[\\^$.*+?()[\]{}|]/g,Pr=RegExp(Jr.source),Ur=/^\s+/,Xi=/\s/,Sr=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Lr=/\{\n\/\* \[wrapped with (.+)\] \*/,mi=/,? & /,ws=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ln=/[()=,{}\[\]\/\s]/,so=/\\(\\)?/g,$i=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yo=/\w*$/,Q=/^[-+]0x[0-9a-f]+$/i,ft=/^0b[01]+$/i,dt=/^\[object .+?Constructor\]$/,Lt=/^0o[0-7]+$/i,Ct=/^(?:0|[1-9]\d*)$/,It=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Zt=/($^)/,re=/['\n\r\u2028\u2029\\]/g,pe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Kt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",qe="[\\ud800-\\udfff]",ie="["+Kt+"]",Pn="["+pe+"]",ar="\\d+",Un="[\\u2700-\\u27bf]",jr="[a-z\\xdf-\\xf6\\xf8-\\xff]",Xo="[^\\ud800-\\udfff"+Kt+ar+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",gi="\\ud83c[\\udffb-\\udfff]",Qa="[^\\ud800-\\udfff]",Oo="(?:\\ud83c[\\udde6-\\uddff]){2}",Ma="[\\ud800-\\udbff][\\udc00-\\udfff]",ea="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Aa="(?:"+jr+"|"+Xo+")",vh="(?:"+ea+"|"+Xo+")",Yo="(?:"+Pn+"|"+gi+")?",jt="[\\ufe0e\\ufe0f]?"+Yo+("(?:\\u200d(?:"+[Qa,Oo,Ma].join("|")+")[\\ufe0e\\ufe0f]?"+Yo+")*"),Pt="(?:"+[Un,Oo,Ma].join("|")+")"+jt,xe="(?:"+[Qa+Pn+"?",Pn,Oo,Ma,qe].join("|")+")",Fe=RegExp("['\u2019]","g"),$e=RegExp(Pn,"g"),un=RegExp(gi+"(?="+gi+")|"+xe+jt,"g"),Rn=RegExp([ea+"?"+jr+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[ie,ea,"$"].join("|")+")",vh+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[ie,ea+Aa,"$"].join("|")+")",ea+"?"+Aa+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ea+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ar,Pt].join("|"),"g"),_n=RegExp("[\\u200d\\ud800-\\udfff"+pe+"\\ufe0e\\ufe0f]"),Sn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,vr=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],_r=-1,on={};on[xt]=on[zt]=on[Vt]=on[$]=on[Dt]=on[Ht]=on["[object Uint8ClampedArray]"]=on[Yt]=on[kt]=!0,on[et]=on[nt]=on[je]=on[ct]=on[te]=on[Nt]=on[Xt]=on[Gt]=on[F]=on[z]=on[rt]=on[k]=on[X]=on[tt]=on[ue]=!1;var ln={};ln[et]=ln[nt]=ln[je]=ln[te]=ln[ct]=ln[Nt]=ln[xt]=ln[zt]=ln[Vt]=ln[$]=ln[Dt]=ln[F]=ln[z]=ln[rt]=ln[k]=ln[X]=ln[tt]=ln[ht]=ln[Ht]=ln["[object Uint8ClampedArray]"]=ln[Yt]=ln[kt]=!0,ln[Xt]=ln[Gt]=ln[ue]=!1;var or={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},vi=parseFloat,Zn=parseInt,Fr=typeof J=="object"&&J&&J.Object===Object&&J,hi=typeof self=="object"&&self&&self.Object===Object&&self,Er=Fr||hi||Function("return this")(),$r=C&&!C.nodeType&&C,is=$r&&typeof G=="object"&&G&&!G.nodeType&&G,wl=is&&is.exports===$r,Ki=wl&&Fr.process,si=function(){try{var Bt=is&&is.require&&is.require("util").types;return Bt||Ki&&Ki.binding&&Ki.binding("util")}catch{}}(),pc=si&&si.isArrayBuffer,fc=si&&si.isDate,Tl=si&&si.isMap,_h=si&&si.isRegExp,Sl=si&&si.isSet,yh=si&&si.isTypedArray;function Do(Bt,he,we){switch(we.length){case 0:return Bt.call(he);case 1:return Bt.call(he,we[0]);case 2:return Bt.call(he,we[0],we[1]);case 3:return Bt.call(he,we[0],we[1],we[2])}return Bt.apply(he,we)}function md(Bt,he,we,fe){for(var Gn=-1,pr=Bt==null?0:Bt.length;++Gn<pr;){var Gi=Bt[Gn];he(fe,Gi,we(Gi),Bt)}return fe}function ao(Bt,he){for(var we=-1,fe=Bt==null?0:Bt.length;++we<fe&&he(Bt[we],we,Bt)!==!1;);return Bt}function _i(Bt,he){for(var we=Bt==null?0:Bt.length;we--&&he(Bt[we],we,Bt)!==!1;);return Bt}function Uu(Bt,he){for(var we=-1,fe=Bt==null?0:Bt.length;++we<fe;)if(!he(Bt[we],we,Bt))return!1;return!0}function na(Bt,he){for(var we=-1,fe=Bt==null?0:Bt.length,Gn=0,pr=[];++we<fe;){var Gi=Bt[we];he(Gi,we,Bt)&&(pr[Gn++]=Gi)}return pr}function El(Bt,he){return!!(Bt==null?0:Bt.length)&&os(Bt,he,0)>-1}function dr(Bt,he,we){for(var fe=-1,Gn=Bt==null?0:Bt.length;++fe<Gn;)if(we(he,Bt[fe]))return!0;return!1}function ei(Bt,he){for(var we=-1,fe=Bt==null?0:Bt.length,Gn=Array(fe);++we<fe;)Gn[we]=he(Bt[we],we,Bt);return Gn}function ra(Bt,he){for(var we=-1,fe=he.length,Gn=Bt.length;++we<fe;)Bt[Gn+we]=he[we];return Bt}function tu(Bt,he,we,fe){var Gn=-1,pr=Bt==null?0:Bt.length;for(fe&&pr&&(we=Bt[++Gn]);++Gn<pr;)we=he(we,Bt[Gn],Gn,Bt);return we}function mc(Bt,he,we,fe){var Gn=Bt==null?0:Bt.length;for(fe&&Gn&&(we=Bt[--Gn]);Gn--;)we=he(we,Bt[Gn],Gn,Bt);return we}function ai(Bt,he){for(var we=-1,fe=Bt==null?0:Bt.length;++we<fe;)if(he(Bt[we],we,Bt))return!0;return!1}var eu=bh("length");function yi(Bt,he,we){var fe;return we(Bt,function(Gn,pr,Gi){if(he(Gn,pr,Gi))return fe=pr,!1}),fe}function ks(Bt,he,we,fe){for(var Gn=Bt.length,pr=we+(fe?1:-1);fe?pr--:++pr<Gn;)if(he(Bt[pr],pr,Bt))return pr;return-1}function os(Bt,he,we){return he==he?function(fe,Gn,pr){for(var Gi=pr-1,fr=fe.length;++Gi<fr;)if(fe[Gi]===Gn)return Gi;return-1}(Bt,he,we):ks(Bt,Pa,we)}function nu(Bt,he,we,fe){for(var Gn=we-1,pr=Bt.length;++Gn<pr;)if(fe(Bt[Gn],he))return Gn;return-1}function Pa(Bt){return Bt!=Bt}function xh(Bt,he){var we=Bt==null?0:Bt.length;return we?Ml(Bt,he)/we:NaN}function bh(Bt){return function(he){return he==null?void 0:he[Bt]}}function ku(Bt){return function(he){return Bt==null?void 0:Bt[he]}}function ni(Bt,he,we,fe,Gn){return Gn(Bt,function(pr,Gi,fr){we=fe?(fe=!1,pr):he(we,pr,Gi,fr)}),we}function Ml(Bt,he){for(var we,fe=-1,Gn=Bt.length;++fe<Gn;){var pr=he(Bt[fe]);pr!==void 0&&(we=we===void 0?pr:we+pr)}return we}function ru(Bt,he){for(var we=-1,fe=Array(Bt);++we<Bt;)fe[we]=he(we);return fe}function gc(Bt){return Bt&&Bt.slice(0,wh(Bt)+1).replace(Ur,"")}function xo(Bt){return function(he){return Bt(he)}}function ci(Bt,he){return ei(he,function(we){return Bt[we]})}function iu(Bt,he){return Bt.has(he)}function gd(Bt,he){for(var we=-1,fe=Bt.length;++we<fe&&os(he,Bt[we],0)>-1;);return we}function Ci(Bt,he){for(var we=Bt.length;we--&&os(he,Bt[we],0)>-1;);return we}function vd(Bt,he){for(var we=Bt.length,fe=0;we--;)Bt[we]===he&&++fe;return fe}var No=ku({\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"}),Al=ku({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Gu(Bt){return"\\"+or[Bt]}function ri(Bt){return _n.test(Bt)}function ia(Bt){var he=-1,we=Array(Bt.size);return Bt.forEach(function(fe,Gn){we[++he]=[Gn,fe]}),we}function oa(Bt,he){return function(we){return Bt(he(we))}}function ss(Bt,he){for(var we=-1,fe=Bt.length,Gn=0,pr=[];++we<fe;){var Gi=Bt[we];Gi!==he&&Gi!==W||(Bt[we]=W,pr[Gn++]=we)}return pr}function ou(Bt){var he=-1,we=Array(Bt.size);return Bt.forEach(function(fe){we[++he]=fe}),we}function Pl(Bt){var he=-1,we=Array(Bt.size);return Bt.forEach(function(fe){we[++he]=[fe,fe]}),we}function Hu(Bt){return ri(Bt)?function(he){for(var we=un.lastIndex=0;un.test(he);)++we;return we}(Bt):eu(Bt)}function Ts(Bt){return ri(Bt)?function(he){return he.match(un)||[]}(Bt):function(he){return he.split("")}(Bt)}function wh(Bt){for(var he=Bt.length;he--&&Xi.test(Bt.charAt(he)););return he}var bo=ku({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),di=function Bt(he){var we,fe=(he=he==null?Er:di.defaults(Er.Object(),he,di.pick(Er,vr))).Array,Gn=he.Date,pr=he.Error,Gi=he.Function,fr=he.Math,Cr=he.Object,Cl=he.RegExp,sa=he.String,Qi=he.TypeError,Rl=fe.prototype,vc=Gi.prototype,su=Cr.prototype,zu=he["__core-js_shared__"],Il=vc.toString,Gr=su.hasOwnProperty,qo=0,bp=(we=/[^.]+$/.exec(zu&&zu.keys&&zu.keys.IE_PROTO||""))?"Symbol(src)_1."+we:"",ju=su.toString,_d=Il.call(Cr),yd=Er._,wp=Cl("^"+Il.call(Gr).replace(Jr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Dn=wl?he.Buffer:void 0,Ss=he.Symbol,Ri=he.Uint8Array,au=Dn?Dn.allocUnsafe:void 0,Ll=oa(Cr.getPrototypeOf,Cr),Tp=Cr.create,Yi=su.propertyIsEnumerable,Th=Rl.splice,Sp=Ss?Ss.isConcatSpreadable:void 0,Ol=Ss?Ss.iterator:void 0,Vu=Ss?Ss.toStringTag:void 0,_c=function(){try{var c=wu(Cr,"defineProperty");return c({},"",{}),c}catch{}}(),Ca=he.clearTimeout!==Er.clearTimeout&&he.clearTimeout,Ra=Gn&&Gn.now!==Er.Date.now&&Gn.now,qi=he.setTimeout!==Er.setTimeout&&he.setTimeout,Wu=fr.ceil,uo=fr.floor,uu=Cr.getOwnPropertySymbols,wo=Dn?Dn.isBuffer:void 0,Hi=he.isFinite,Sh=Rl.join,Ia=oa(Cr.keys,Cr),xi=fr.max,to=fr.min,yc=Gn.now,xd=he.parseInt,Ge=fr.random,Ii=Rl.reverse,lu=wu(he,"DataView"),as=wu(he,"Map"),Eh=wu(he,"Promise"),ui=wu(he,"Set"),hu=wu(he,"WeakMap"),Rr=wu(Cr,"create"),To=hu&&new hu,cu={},Dl=fa(lu),eo=fa(as),ot=fa(Eh),xc=fa(ui),bd=fa(hu),So=Ss?Ss.prototype:void 0,us=So?So.valueOf:void 0,La=So?So.toString:void 0;function q(c){if(wi(c)&&!rr(c)&&!(c instanceof ur)){if(c instanceof lo)return c;if(Gr.call(c,"__wrapped__"))return Su(c)}return new lo(c)}var Es=function(){function c(){}return function(g){if(!pi(g))return{};if(Tp)return Tp(g);c.prototype=g;var S=new c;return c.prototype=void 0,S}}();function Ms(){}function lo(c,g){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!g,this.__index__=0,this.__values__=void 0}function ur(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function no(c){var g=-1,S=c==null?0:c.length;for(this.clear();++g<S;){var D=c[g];this.set(D[0],D[1])}}function Fo(c){var g=-1,S=c==null?0:c.length;for(this.clear();++g<S;){var D=c[g];this.set(D[0],D[1])}}function ls(c){var g=-1,S=c==null?0:c.length;for(this.clear();++g<S;){var D=c[g];this.set(D[0],D[1])}}function Gs(c){var g=-1,S=c==null?0:c.length;for(this.__data__=new ls;++g<S;)this.add(c[g])}function Zo(c){var g=this.__data__=new Fo(c);this.size=g.size}function Hs(c,g){var S=rr(c),D=!S&&Eu(c),H=!S&&!D&&ja(c),it=!S&&!D&&!H&&il(c),vt=S||D||H||it,St=vt?ru(c.length,sa):[],Ft=St.length;for(var ae in c)!g&&!Gr.call(c,ae)||vt&&(ae=="length"||H&&(ae=="offset"||ae=="parent")||it&&(ae=="buffer"||ae=="byteLength"||ae=="byteOffset")||Ys(ae,Ft))||St.push(ae);return St}function du(c){var g=c.length;return g?c[Ec(0,g-1)]:void 0}function Oa(c,g){return Tu(ji(c),zs(g,0,c.length))}function Da(c){return Tu(ji(c))}function ro(c,g,S){(S!==void 0&&!zo(c[g],S)||S===void 0&&!(g in c))&&hs(c,g,S)}function pu(c,g,S){var D=c[g];Gr.call(c,g)&&zo(D,S)&&(S!==void 0||g in c)||hs(c,g,S)}function Jo(c,g){for(var S=c.length;S--;)if(zo(c[S][0],g))return S;return-1}function aa(c,g,S,D){return ds(c,function(H,it,vt){g(D,H,S(H),vt)}),D}function Nl(c,g){return c&&ms(g,oi(g),c)}function hs(c,g,S){g=="__proto__"&&_c?_c(c,g,{configurable:!0,enumerable:!0,value:S,writable:!0}):c[g]=S}function As(c,g){for(var S=-1,D=g.length,H=fe(D),it=c==null;++S<D;)H[S]=it?void 0:sl(c,g[S]);return H}function zs(c,g,S){return c==c&&(S!==void 0&&(c=c<=S?c:S),g!==void 0&&(c=c>=g?c:g)),c}function ho(c,g,S,D,H,it){var vt,St=1&g,Ft=2&g,ae=4&g;if(S&&(vt=H?S(c,D,H,it):S(c)),vt!==void 0)return vt;if(!pi(c))return c;var le=rr(c);if(le){if(vt=function(Se){var Xe=Se.length,Xn=new Se.constructor(Xe);return Xe&&typeof Se[0]=="string"&&Gr.call(Se,"index")&&(Xn.index=Se.index,Xn.input=Se.input),Xn}(c),!St)return ji(c,vt)}else{var Oe=Ze(c),mn=Oe==Gt||Oe==L;if(ja(c))return yu(c,St);if(Oe==rt||Oe==et||mn&&!H){if(vt=Ft||mn?{}:Ad(c),!St)return Ft?function(Se,Xe){return ms(Se,er(Se),Xe)}(c,function(Se,Xe){return Se&&ms(Xe,vo(Xe),Se)}(vt,c)):function(Se,Xe){return ms(Se,mo(Se),Xe)}(c,Nl(vt,c))}else{if(!ln[Oe])return H?c:{};vt=function(Se,Xe,Xn){var dn=Se.constructor;switch(Xe){case je:return Uo(Se);case ct:case Nt:return new dn(+Se);case te:return function(An,jn){var Mn=jn?Uo(An.buffer):An.buffer;return new An.constructor(Mn,An.byteOffset,An.byteLength)}(Se,Xn);case xt:case zt:case Vt:case $:case Dt:case Ht:case"[object Uint8ClampedArray]":case Yt:case kt:return Fa(Se,Xn);case F:return new dn;case z:case tt:return new dn(Se);case k:return function(An){var jn=new An.constructor(An.source,yo.exec(An));return jn.lastIndex=An.lastIndex,jn}(Se);case X:return new dn;case ht:return Fn=Se,us?Cr(us.call(Fn)):{}}var Fn}(c,Oe,St)}}it||(it=new Zo);var gn=it.get(c);if(gn)return gn;it.set(c,vt),zd(c)?c.forEach(function(Se){vt.add(ho(Se,g,S,Se,c,it))}):Fp(c)&&c.forEach(function(Se,Xe){vt.set(Xe,ho(Se,g,S,Xe,c,it))});var Cn=le?void 0:(ae?Ft?Ed:Dh:Ft?vo:oi)(c);return ao(Cn||c,function(Se,Xe){Cn&&(Se=c[Xe=Se]),pu(vt,Xe,ho(Se,g,S,Xe,c,it))}),vt}function ua(c,g,S){var D=S.length;if(c==null)return!D;for(c=Cr(c);D--;){var H=S[D],it=g[H],vt=c[H];if(vt===void 0&&!(H in c)||!it(vt))return!1}return!0}function cs(c,g,S){if(typeof c!="function")throw new Qi(Z);return Ha(function(){c.apply(void 0,S)},g)}function wn(c,g,S,D){var H=-1,it=El,vt=!0,St=c.length,Ft=[],ae=g.length;if(!St)return Ft;S&&(g=ei(g,xo(S))),D?(it=dr,vt=!1):g.length>=200&&(it=iu,vt=!1,g=new Gs(g));t:for(;++H<St;){var le=c[H],Oe=S==null?le:S(le);if(le=D||le!==0?le:0,vt&&Oe==Oe){for(var mn=ae;mn--;)if(g[mn]===Oe)continue t;Ft.push(le)}else it(g,Oe,D)||Ft.push(le)}return Ft}q.templateSettings={escape:kn,evaluate:qn,interpolate:bn,variable:"",imports:{_:q}},q.prototype=Ms.prototype,q.prototype.constructor=q,lo.prototype=Es(Ms.prototype),lo.prototype.constructor=lo,ur.prototype=Es(Ms.prototype),ur.prototype.constructor=ur,no.prototype.clear=function(){this.__data__=Rr?Rr(null):{},this.size=0},no.prototype.delete=function(c){var g=this.has(c)&&delete this.__data__[c];return this.size-=g?1:0,g},no.prototype.get=function(c){var g=this.__data__;if(Rr){var S=g[c];return S==="__lodash_hash_undefined__"?void 0:S}return Gr.call(g,c)?g[c]:void 0},no.prototype.has=function(c){var g=this.__data__;return Rr?g[c]!==void 0:Gr.call(g,c)},no.prototype.set=function(c,g){var S=this.__data__;return this.size+=this.has(c)?0:1,S[c]=Rr&&g===void 0?"__lodash_hash_undefined__":g,this},Fo.prototype.clear=function(){this.__data__=[],this.size=0},Fo.prototype.delete=function(c){var g=this.__data__,S=Jo(g,c);return!(S<0)&&(S==g.length-1?g.pop():Th.call(g,S,1),--this.size,!0)},Fo.prototype.get=function(c){var g=this.__data__,S=Jo(g,c);return S<0?void 0:g[S][1]},Fo.prototype.has=function(c){return Jo(this.__data__,c)>-1},Fo.prototype.set=function(c,g){var S=this.__data__,D=Jo(S,c);return D<0?(++this.size,S.push([c,g])):S[D][1]=g,this},ls.prototype.clear=function(){this.size=0,this.__data__={hash:new no,map:new(as||Fo),string:new no}},ls.prototype.delete=function(c){var g=ka(this,c).delete(c);return this.size-=g?1:0,g},ls.prototype.get=function(c){return ka(this,c).get(c)},ls.prototype.has=function(c){return ka(this,c).has(c)},ls.prototype.set=function(c,g){var S=ka(this,c),D=S.size;return S.set(c,g),this.size+=S.size==D?0:1,this},Gs.prototype.add=Gs.prototype.push=function(c){return this.__data__.set(c,"__lodash_hash_undefined__"),this},Gs.prototype.has=function(c){return this.__data__.has(c)},Zo.prototype.clear=function(){this.__data__=new Fo,this.size=0},Zo.prototype.delete=function(c){var g=this.__data__,S=g.delete(c);return this.size=g.size,S},Zo.prototype.get=function(c){return this.__data__.get(c)},Zo.prototype.has=function(c){return this.__data__.has(c)},Zo.prototype.set=function(c,g){var S=this.__data__;if(S instanceof Fo){var D=S.__data__;if(!as||D.length<199)return D.push([c,g]),this.size=++S.size,this;S=this.__data__=new ls(D)}return S.set(c,g),this.size=S.size,this};var ds=Ba(fs),ps=Ba(la,!0);function lf(c,g){var S=!0;return ds(c,function(D,H,it){return S=!!g(D,H,it)}),S}function Mh(c,g,S){for(var D=-1,H=c.length;++D<H;){var it=c[D],vt=g(it);if(vt!=null&&(St===void 0?vt==vt&&!Qo(vt):S(vt,St)))var St=vt,Ft=it}return Ft}function js(c,g){var S=[];return ds(c,function(D,H,it){g(D,H,it)&&S.push(D)}),S}function Ei(c,g,S,D,H){var it=-1,vt=c.length;for(S||(S=Vl),H||(H=[]);++it<vt;){var St=c[it];g>0&&S(St)?g>1?Ei(St,g-1,S,D,H):ra(H,St):D||(H[H.length]=St)}return H}var co=Cc(),Fl=Cc(!0);function fs(c,g){return c&&co(c,g,oi)}function la(c,g){return c&&Fl(c,g,oi)}function fu(c,g){return na(g,function(S){return qs(c[S])})}function mu(c,g){for(var S=0,D=(g=$o(g,c)).length;c!=null&&S<D;)c=c[Ho(g[S++])];return S&&S==D?c:void 0}function Vs(c,g,S){var D=g(c);return rr(c)?D:ra(D,S(c))}function Li(c){return c==null?c===void 0?"[object Undefined]":"[object Null]":Vu&&Vu in Cr(c)?function(g){var S=Gr.call(g,Vu),D=g[Vu];try{g[Vu]=void 0;var H=!0}catch{}var it=ju.call(g);return H&&(S?g[Vu]=D:delete g[Vu]),it}(c):function(g){return ju.call(g)}(c)}function Ps(c,g){return c>g}function Bl(c,g){return c!=null&&Gr.call(c,g)}function gu(c,g){return c!=null&&g in Cr(c)}function Ul(c,g,S){for(var D=S?dr:El,H=c[0].length,it=c.length,vt=it,St=fe(it),Ft=1/0,ae=[];vt--;){var le=c[vt];vt&&g&&(le=ei(le,xo(g))),Ft=to(le.length,Ft),St[vt]=!S&&(g||H>=120&&le.length>=120)?new Gs(vt&&le):void 0}le=c[0];var Oe=-1,mn=St[0];t:for(;++Oe<H&&ae.length<Ft;){var gn=le[Oe],Cn=g?g(gn):gn;if(gn=S||gn!==0?gn:0,!(mn?iu(mn,Cn):D(ae,Cn,S))){for(vt=it;--vt;){var Se=St[vt];if(!(Se?iu(Se,Cn):D(c[vt],Cn,S)))continue t}mn&&mn.push(Cn),ae.push(gn)}}return ae}function vu(c,g,S){var D=(c=Rd(c,g=$o(g,c)))==null?c:c[Ho(Fs(g))];return D==null?void 0:Do(D,c,S)}function bc(c){return wi(c)&&Li(c)==et}function Xu(c,g,S,D,H){return c===g||(c==null||g==null||!wi(c)&&!wi(g)?c!=c&&g!=g:function(it,vt,St,Ft,ae,le){var Oe=rr(it),mn=rr(vt),gn=Oe?nt:Ze(it),Cn=mn?nt:Ze(vt),Se=(gn=gn==et?rt:gn)==rt,Xe=(Cn=Cn==et?rt:Cn)==rt,Xn=gn==Cn;if(Xn&&ja(it)){if(!ja(vt))return!1;Oe=!0,Se=!1}if(Xn&&!Se)return le||(le=new Zo),Oe||il(it)?$u(it,vt,St,Ft,ae,le):function(Mn,Vn,Vr,_o,es,Bi,Js){switch(Vr){case te:if(Mn.byteLength!=Vn.byteLength||Mn.byteOffset!=Vn.byteOffset)return!1;Mn=Mn.buffer,Vn=Vn.buffer;case je:return!(Mn.byteLength!=Vn.byteLength||!Bi(new Ri(Mn),new Ri(Vn)));case ct:case Nt:case z:return zo(+Mn,+Vn);case Xt:return Mn.name==Vn.name&&Mn.message==Vn.message;case k:case tt:return Mn==Vn+"";case F:var xs=ia;case X:var Wa=1&_o;if(xs||(xs=ou),Mn.size!=Vn.size&&!Wa)return!1;var Lu=Js.get(Mn);if(Lu)return Lu==Vn;_o|=2,Js.set(Mn,Vn);var Xa=$u(xs(Mn),xs(Vn),_o,es,Bi,Js);return Js.delete(Mn),Xa;case ht:if(us)return us.call(Mn)==us.call(Vn)}return!1}(it,vt,gn,St,Ft,ae,le);if(!(1&St)){var dn=Se&&Gr.call(it,"__wrapped__"),Fn=Xe&&Gr.call(vt,"__wrapped__");if(dn||Fn){var An=dn?it.value():it,jn=Fn?vt.value():vt;return le||(le=new Zo),ae(An,jn,St,Ft,le)}}return Xn?(le||(le=new Zo),function(Mn,Vn,Vr,_o,es,Bi){var Js=1&Vr,xs=Dh(Mn),Wa=xs.length,Lu=Dh(Vn).length;if(Wa!=Lu&&!Js)return!1;for(var Xa=Wa;Xa--;){var ga=xs[Xa];if(!(Js?ga in Vn:Gr.call(Vn,ga)))return!1}var dl=Bi.get(Mn),ep=Bi.get(Vn);if(dl&&ep)return dl==Vn&&ep==Mn;var pl=!0;Bi.set(Mn,Vn),Bi.set(Vn,Mn);for(var rc=Js;++Xa<Wa;){ga=xs[Xa];var fl=Mn[ga],oh=Vn[ga];if(_o)var zp=Js?_o(oh,fl,ga,Vn,Mn,Bi):_o(fl,oh,ga,Mn,Vn,Bi);if(!(zp===void 0?fl===oh||es(fl,oh,Vr,_o,Bi):zp)){pl=!1;break}rc||(rc=ga=="constructor")}if(pl&&!rc){var Ou=Mn.constructor,$s=Vn.constructor;Ou==$s||!("constructor"in Mn)||!("constructor"in Vn)||typeof Ou=="function"&&Ou instanceof Ou&&typeof $s=="function"&&$s instanceof $s||(pl=!1)}return Bi.delete(Mn),Bi.delete(Vn),pl}(it,vt,St,Ft,ae,le)):!1}(c,g,S,D,Xu,H))}function kl(c,g,S,D){var H=S.length,it=H,vt=!D;if(c==null)return!it;for(c=Cr(c);H--;){var St=S[H];if(vt&&St[2]?St[1]!==c[St[0]]:!(St[0]in c))return!1}for(;++H<it;){var Ft=(St=S[H])[0],ae=c[Ft],le=St[1];if(vt&&St[2]){if(ae===void 0&&!(Ft in c))return!1}else{var Oe=new Zo;if(D)var mn=D(ae,le,Ft,c,g,Oe);if(!(mn===void 0?Xu(le,ae,3,D,Oe):mn))return!1}}return!0}function wd(c){return!(!pi(c)||(g=c,bp&&bp in g))&&(qs(c)?wp:dt).test(fa(c));var g}function wc(c){return typeof c=="function"?c:c==null?io:typeof c=="object"?rr(c)?_u(c[0],c[1]):Is(c):qc(c)}function mr(c){if(!Wl(c))return Ia(c);var g=[];for(var S in Cr(c))Gr.call(c,S)&&S!="constructor"&&g.push(S);return g}function Cs(c){if(!pi(c))return function(H){var it=[];if(H!=null)for(var vt in Cr(H))it.push(vt);return it}(c);var g=Wl(c),S=[];for(var D in c)(D!="constructor"||!g&&Gr.call(c,D))&&S.push(D);return S}function Rs(c,g){return c<g}function Tc(c,g){var S=-1,D=Co(c)?fe(c.length):[];return ds(c,function(H,it,vt){D[++S]=g(H,it,vt)}),D}function Is(c){var g=Nh(c);return g.length==1&&g[0][2]?Uh(g[0][0],g[0][1]):function(S){return S===c||kl(S,c,g)}}function _u(c,g){return Fh(c)&&Ku(g)?Uh(Ho(c),g):function(S){var D=sl(S,c);return D===void 0&&D===g?Pu(S,c):Xu(g,D,3)}}function Na(c,g,S,D,H){c!==g&&co(g,function(it,vt){if(H||(H=new Zo),pi(it))(function(Ft,ae,le,Oe,mn,gn,Cn){var Se=kh(Ft,le),Xe=kh(ae,le),Xn=Cn.get(Xe);if(Xn)return void ro(Ft,le,Xn);var dn=gn?gn(Se,Xe,le+"",Ft,ae,Cn):void 0,Fn=dn===void 0;if(Fn){var An=rr(Xe),jn=!An&&ja(Xe),Mn=!An&&!jn&&il(Xe);dn=Xe,An||jn||Mn?rr(Se)?dn=Se:Ai(Se)?dn=ji(Se):jn?(Fn=!1,dn=yu(Xe,!0)):Mn?(Fn=!1,dn=Fa(Xe,!0)):dn=[]:rl(Xe)||Eu(Xe)?(dn=Se,Eu(Se)?dn=zc(Se):pi(Se)&&!qs(Se)||(dn=Ad(Xe))):Fn=!1}Fn&&(Cn.set(Xe,dn),mn(dn,Xe,Oe,gn,Cn),Cn.delete(Xe)),ro(Ft,le,dn)})(c,g,vt,S,Na,D,H);else{var St=D?D(kh(c,vt),it,vt+"",c,g,H):void 0;St===void 0&&(St=it),ro(c,vt,St)}},vo)}function Yu(c,g){var S=c.length;if(S)return Ys(g+=g<0?S:0,S)?c[g]:void 0}function Sc(c,g,S){g=g.length?ei(g,function(H){return rr(H)?function(it){return mu(it,H.length===1?H[0]:H)}:H}):[io];var D=-1;return g=ei(g,xo(Nn())),function(H,it){var vt=H.length;for(H.sort(it);vt--;)H[vt]=H[vt].value;return H}(Tc(c,function(H,it,vt){return{criteria:ei(g,function(St){return St(H)}),index:++D,value:H}}),function(H,it){return function(vt,St,Ft){for(var ae=-1,le=vt.criteria,Oe=St.criteria,mn=le.length,gn=Ft.length;++ae<mn;){var Cn=Xr(le[ae],Oe[ae]);if(Cn){if(ae>=gn)return Cn;var Se=Ft[ae];return Cn*(Se=="desc"?-1:1)}}return vt.index-St.index}(H,it,S)})}function Ah(c,g,S){for(var D=-1,H=g.length,it={};++D<H;){var vt=g[D],St=mu(c,vt);S(St,vt)&&qu(it,$o(vt,c),St)}return it}function Gl(c,g,S,D){var H=D?nu:os,it=-1,vt=g.length,St=c;for(c===g&&(g=ji(g)),S&&(St=ei(c,xo(S)));++it<vt;)for(var Ft=0,ae=g[it],le=S?S(ae):ae;(Ft=H(St,le,Ft,D))>-1;)St!==c&&Th.call(St,Ft,1),Th.call(c,Ft,1);return c}function Mi(c,g){for(var S=c?g.length:0,D=S-1;S--;){var H=g[S];if(S==D||H!==it){var it=H;Ys(H)?Th.call(c,H,1):Hl(c,H)}}return c}function Ec(c,g){return c+uo(Ge()*(g-c+1))}function zi(c,g){var S="";if(!c||g<1||g>9007199254740991)return S;do g%2&&(S+=c),(g=uo(g/2))&&(c+=c);while(g);return S}function Qn(c,g){return Gh(Cd(c,g,io),c+"")}function po(c){return du(ma(c))}function Ph(c,g){var S=ma(c);return Tu(S,zs(g,0,S.length))}function qu(c,g,S,D){if(!pi(c))return c;for(var H=-1,it=(g=$o(g,c)).length,vt=it-1,St=c;St!=null&&++H<it;){var Ft=Ho(g[H]),ae=S;if(Ft==="__proto__"||Ft==="constructor"||Ft==="prototype")return c;if(H!=vt){var le=St[Ft];(ae=D?D(le,Ft,St):void 0)===void 0&&(ae=pi(le)?le:Ys(g[H+1])?[]:{})}pu(St,Ft,ae),St=St[Ft]}return c}var Mc=To?function(c,g){return To.set(c,g),c}:io,Ch=_c?function(c,g){return _c(c,"toString",{configurable:!0,enumerable:!1,value:Kh(g),writable:!0})}:io;function pn(c){return Tu(ma(c))}function Oi(c,g,S){var D=-1,H=c.length;g<0&&(g=-g>H?0:H+g),(S=S>H?H:S)<0&&(S+=H),H=g>S?0:S-g>>>0,g>>>=0;for(var it=fe(H);++D<H;)it[D]=c[D+g];return it}function ii(c,g){var S;return ds(c,function(D,H,it){return!(S=g(D,H,it))}),!!S}function ha(c,g,S){var D=0,H=c==null?D:c.length;if(typeof g=="number"&&g==g&&H<=2147483647){for(;D<H;){var it=D+H>>>1,vt=c[it];vt!==null&&!Qo(vt)&&(S?vt<=g:vt<g)?D=it+1:H=it}return H}return yr(c,g,io,S)}function yr(c,g,S,D){var H=0,it=c==null?0:c.length;if(it===0)return 0;for(var vt=(g=S(g))!=g,St=g===null,Ft=Qo(g),ae=g===void 0;H<it;){var le=uo((H+it)/2),Oe=S(c[le]),mn=Oe!==void 0,gn=Oe===null,Cn=Oe==Oe,Se=Qo(Oe);if(vt)var Xe=D||Cn;else Xe=ae?Cn&&(D||mn):St?Cn&&mn&&(D||!gn):Ft?Cn&&mn&&!gn&&(D||!Se):!gn&&!Se&&(D?Oe<=g:Oe<g);Xe?H=le+1:it=le}return to(it,4294967294)}function On(c,g){for(var S=-1,D=c.length,H=0,it=[];++S<D;){var vt=c[S],St=g?g(vt):vt;if(!S||!zo(St,Ft)){var Ft=St;it[H++]=vt===0?0:vt}}return it}function Ac(c){return typeof c=="number"?c:Qo(c)?NaN:+c}function Eo(c){if(typeof c=="string")return c;if(rr(c))return ei(c,Eo)+"";if(Qo(c))return La?La.call(c):"";var g=c+"";return g=="0"&&1/c==-1/0?"-0":g}function ca(c,g,S){var D=-1,H=El,it=c.length,vt=!0,St=[],Ft=St;if(S)vt=!1,H=dr;else if(it>=200){var ae=g?null:Mo(c);if(ae)return ou(ae);vt=!1,H=iu,Ft=new Gs}else Ft=g?[]:St;t:for(;++D<it;){var le=c[D],Oe=g?g(le):le;if(le=S||le!==0?le:0,vt&&Oe==Oe){for(var mn=Ft.length;mn--;)if(Ft[mn]===Oe)continue t;g&&Ft.push(Oe),St.push(le)}else H(Ft,Oe,S)||(Ft!==St&&Ft.push(Oe),St.push(le))}return St}function Hl(c,g){return(c=Rd(c,g=$o(g,c)))==null||delete c[Ho(Fs(g))]}function Td(c,g,S,D){return qu(c,g,S(mu(c,g)),D)}function Bo(c,g,S,D){for(var H=c.length,it=D?H:-1;(D?it--:++it<H)&&g(c[it],it,c););return S?Oi(c,D?0:it,D?it+1:H):Oi(c,D?it+1:0,D?H:it)}function Pc(c,g){var S=c;return S instanceof ur&&(S=S.value()),tu(g,function(D,H){return H.func.apply(H.thisArg,ra([D],H.args))},S)}function yn(c,g,S){var D=c.length;if(D<2)return D?ca(c[0]):[];for(var H=-1,it=fe(D);++H<D;)for(var vt=c[H],St=-1;++St<D;)St!=H&&(it[H]=wn(it[H]||vt,c[St],g,S));return ca(Ei(it,1),g,S)}function Ls(c,g,S){for(var D=-1,H=c.length,it=g.length,vt={};++D<H;){var St=D<it?g[D]:void 0;S(vt,c[D],St)}return vt}function Hr(c){return Ai(c)?c:[]}function lr(c){return typeof c=="function"?c:io}function $o(c,g){return rr(c)?c:Fh(c,g)?[c]:Hh(Mr(c))}var Os=Qn;function bi(c,g,S){var D=c.length;return S=S===void 0?D:S,!g&&S>=D?c:Oi(c,g,S)}var Rh=Ca||function(c){return Er.clearTimeout(c)};function yu(c,g){if(g)return c.slice();var S=c.length,D=au?au(S):new c.constructor(S);return c.copy(D),D}function Uo(c){var g=new c.constructor(c.byteLength);return new Ri(g).set(new Ri(c)),g}function Fa(c,g){var S=g?Uo(c.buffer):c.buffer;return new c.constructor(S,c.byteOffset,c.length)}function Xr(c,g){if(c!==g){var S=c!==void 0,D=c===null,H=c==c,it=Qo(c),vt=g!==void 0,St=g===null,Ft=g==g,ae=Qo(g);if(!St&&!ae&&!it&&c>g||it&&vt&&Ft&&!St&&!ae||D&&vt&&Ft||!S&&Ft||!H)return 1;if(!D&&!it&&!ae&&c<g||ae&&S&&H&&!D&&!it||St&&S&&H||!vt&&H||!Ft)return-1}return 0}function Hn(c,g,S,D){for(var H=-1,it=c.length,vt=S.length,St=-1,Ft=g.length,ae=xi(it-vt,0),le=fe(Ft+ae),Oe=!D;++St<Ft;)le[St]=g[St];for(;++H<vt;)(Oe||H<it)&&(le[S[H]]=c[H]);for(;ae--;)le[St++]=c[H++];return le}function zl(c,g,S,D){for(var H=-1,it=c.length,vt=-1,St=S.length,Ft=-1,ae=g.length,le=xi(it-St,0),Oe=fe(le+ae),mn=!D;++H<le;)Oe[H]=c[H];for(var gn=H;++Ft<ae;)Oe[gn+Ft]=g[Ft];for(;++vt<St;)(mn||H<it)&&(Oe[gn+S[vt]]=c[H++]);return Oe}function ji(c,g){var S=-1,D=c.length;for(g||(g=fe(D));++S<D;)g[S]=c[S];return g}function ms(c,g,S,D){var H=!S;S||(S={});for(var it=-1,vt=g.length;++it<vt;){var St=g[it],Ft=D?D(S[St],c[St],St,S,c):void 0;Ft===void 0&&(Ft=c[St]),H?hs(S,St,Ft):pu(S,St,Ft)}return S}function Di(c,g){return function(S,D){var H=rr(S)?md:aa,it=g?g():{};return H(S,c,Nn(D,2),it)}}function ko(c){return Qn(function(g,S){var D=-1,H=S.length,it=H>1?S[H-1]:void 0,vt=H>2?S[2]:void 0;for(it=c.length>3&&typeof it=="function"?(H--,it):void 0,vt&&Ao(S[0],S[1],vt)&&(it=H<3?void 0:it,H=1),g=Cr(g);++D<H;){var St=S[D];St&&c(g,St,D,it)}return g})}function Ba(c,g){return function(S,D){if(S==null)return S;if(!Co(S))return c(S,D);for(var H=S.length,it=g?H:-1,vt=Cr(S);(g?it--:++it<H)&&D(vt[it],it,vt)!==!1;);return S}}function Cc(c){return function(g,S,D){for(var H=-1,it=Cr(g),vt=D(g),St=vt.length;St--;){var Ft=vt[c?St:++H];if(S(it[Ft],Ft,it)===!1)break}return g}}function Rc(c){return function(g){var S=ri(g=Mr(g))?Ts(g):void 0,D=S?S[0]:g.charAt(0),H=S?bi(S,1).join(""):g.slice(1);return D[c]()+H}}function xu(c){return function(g){return tu(Zd(Xd(g).replace(Fe,"")),c,"")}}function bu(c){return function(){var g=arguments;switch(g.length){case 0:return new c;case 1:return new c(g[0]);case 2:return new c(g[0],g[1]);case 3:return new c(g[0],g[1],g[2]);case 4:return new c(g[0],g[1],g[2],g[3]);case 5:return new c(g[0],g[1],g[2],g[3],g[4]);case 6:return new c(g[0],g[1],g[2],g[3],g[4],g[5]);case 7:return new c(g[0],g[1],g[2],g[3],g[4],g[5],g[6])}var S=Es(c.prototype),D=c.apply(S,g);return pi(D)?D:S}}function Ih(c){return function(g,S,D){var H=Cr(g);if(!Co(g)){var it=Nn(S,3);g=oi(g),S=function(St){return it(H[St],St,H)}}var vt=c(g,S,D);return vt>-1?H[it?g[vt]:vt]:void 0}}function Lh(c){return Ds(function(g){var S=g.length,D=S,H=lo.prototype.thru;for(c&&g.reverse();D--;){var it=g[D];if(typeof it!="function")throw new Qi(Z);if(H&&!vt&&Go(it)=="wrapper")var vt=new lo([],!0)}for(D=vt?D:S;++D<S;){var St=Go(it=g[D]),Ft=St=="wrapper"?Md(it):void 0;vt=Ft&&Bh(Ft[0])&&Ft[1]==424&&!Ft[4].length&&Ft[9]==1?vt[Go(Ft[0])].apply(vt,Ft[3]):it.length==1&&Bh(it)?vt[St]():vt.thru(it)}return function(){var ae=arguments,le=ae[0];if(vt&&ae.length==1&&rr(le))return vt.plant(le).value();for(var Oe=0,mn=S?g[Oe].apply(this,ae):le;++Oe<S;)mn=g[Oe].call(this,mn);return mn}})}function Zu(c,g,S,D,H,it,vt,St,Ft,ae){var le=128&g,Oe=1&g,mn=2&g,gn=24&g,Cn=512&g,Se=mn?void 0:bu(c);return function Xe(){for(var Xn=arguments.length,dn=fe(Xn),Fn=Xn;Fn--;)dn[Fn]=arguments[Fn];if(gn)var An=Ns(Xe),jn=vd(dn,An);if(D&&(dn=Hn(dn,D,H,gn)),it&&(dn=zl(dn,it,vt,gn)),Xn-=jn,gn&&Xn<ae){var Mn=ss(dn,An);return Xs(c,g,Zu,Xe.placeholder,S,dn,Mn,St,Ft,ae-Xn)}var Vn=Oe?S:this,Vr=mn?Vn[c]:c;return Xn=dn.length,St?dn=Xl(dn,St):Cn&&Xn>1&&dn.reverse(),le&&Ft<Xn&&(dn.length=Ft),this&&this!==Er&&this instanceof Xe&&(Vr=Se||bu(Vr)),Vr.apply(Vn,dn)}}function Oh(c,g){return function(S,D){return function(H,it,vt,St){return fs(H,function(Ft,ae,le){it(St,vt(Ft),ae,le)}),St}(S,c,g(D),{})}}function Ws(c,g){return function(S,D){var H;if(S===void 0&&D===void 0)return g;if(S!==void 0&&(H=S),D!==void 0){if(H===void 0)return D;typeof S=="string"||typeof D=="string"?(S=Eo(S),D=Eo(D)):(S=Ac(S),D=Ac(D)),H=c(S,D)}return H}}function da(c){return Ds(function(g){return g=ei(g,xo(Nn())),Qn(function(S){var D=this;return c(g,function(H){return Do(H,D,S)})})})}function pa(c,g){var S=(g=g===void 0?" ":Eo(g)).length;if(S<2)return S?zi(g,c):g;var D=zi(g,Wu(c/Hu(g)));return ri(g)?bi(Ts(D),0,c).join(""):D.slice(0,c)}function Ni(c){return function(g,S,D){return D&&typeof D!="number"&&Ao(g,S,D)&&(S=D=void 0),g=_s(g),S===void 0?(S=g,g=0):S=_s(S),function(H,it,vt,St){for(var Ft=-1,ae=xi(Wu((it-H)/(vt||1)),0),le=fe(ae);ae--;)le[St?ae:++Ft]=H,H+=vt;return le}(g,S,D=D===void 0?g<S?1:-1:_s(D),c)}}function Ju(c){return function(g,S){return typeof g=="string"&&typeof S=="string"||(g=ys(g),S=ys(S)),c(g,S)}}function Xs(c,g,S,D,H,it,vt,St,Ft,ae){var le=8&g;g|=le?32:64,4&(g&=~(le?64:32))||(g&=-4);var Oe=[c,g,H,le?it:void 0,le?vt:void 0,le?void 0:it,le?void 0:vt,St,Ft,ae],mn=S.apply(void 0,Oe);return Bh(c)&&Ga(mn,Oe),mn.placeholder=D,Id(mn,c,g)}function Ua(c){var g=fr[c];return function(S,D){if(S=ys(S),(D=D==null?0:to(hr(D),292))&&Hi(S)){var H=(Mr(S)+"e").split("e");return+((H=(Mr(g(H[0]+"e"+(+H[1]+D)))+"e").split("e"))[0]+"e"+(+H[1]-D))}return g(S)}}var Mo=ui&&1/ou(new ui([,-0]))[1]==1/0?function(c){return new ui(c)}:tc;function Sd(c){return function(g){var S=Ze(g);return S==F?ia(g):S==X?Pl(g):function(D,H){return ei(H,function(it){return[it,D[it]]})}(g,c(g))}}function fo(c,g,S,D,H,it,vt,St){var Ft=2&g;if(!Ft&&typeof c!="function")throw new Qi(Z);var ae=D?D.length:0;if(ae||(g&=-97,D=H=void 0),vt=vt===void 0?vt:xi(hr(vt),0),St=St===void 0?St:hr(St),ae-=H?H.length:0,64&g){var le=D,Oe=H;D=H=void 0}var mn=Ft?void 0:Md(c),gn=[c,g,S,D,H,le,Oe,it,vt,St];if(mn&&function(Se,Xe){var Xn=Se[1],dn=Xe[1],Fn=Xn|dn,An=Fn<131,jn=dn==128&&Xn==8||dn==128&&Xn==256&&Se[7].length<=Xe[8]||dn==384&&Xe[7].length<=Xe[8]&&Xn==8;if(!An&&!jn)return Se;1&dn&&(Se[2]=Xe[2],Fn|=1&Xn?0:4);var Mn=Xe[3];if(Mn){var Vn=Se[3];Se[3]=Vn?Hn(Vn,Mn,Xe[4]):Mn,Se[4]=Vn?ss(Se[3],W):Xe[4]}(Mn=Xe[5])&&(Vn=Se[5],Se[5]=Vn?zl(Vn,Mn,Xe[6]):Mn,Se[6]=Vn?ss(Se[5],W):Xe[6]),(Mn=Xe[7])&&(Se[7]=Mn),128&dn&&(Se[8]=Se[8]==null?Xe[8]:to(Se[8],Xe[8])),Se[9]==null&&(Se[9]=Xe[9]),Se[0]=Xe[0],Se[1]=Fn}(gn,mn),c=gn[0],g=gn[1],S=gn[2],D=gn[3],H=gn[4],!(St=gn[9]=gn[9]===void 0?Ft?0:c.length:xi(gn[9]-ae,0))&&24&g&&(g&=-25),g&&g!=1)Cn=g==8||g==16?function(Se,Xe,Xn){var dn=bu(Se);return function Fn(){for(var An=arguments.length,jn=fe(An),Mn=An,Vn=Ns(Fn);Mn--;)jn[Mn]=arguments[Mn];var Vr=An<3&&jn[0]!==Vn&&jn[An-1]!==Vn?[]:ss(jn,Vn);if((An-=Vr.length)<Xn)return Xs(Se,Xe,Zu,Fn.placeholder,void 0,jn,Vr,void 0,void 0,Xn-An);var _o=this&&this!==Er&&this instanceof Fn?dn:Se;return Do(_o,this,jn)}}(c,g,St):g!=32&&g!=33||H.length?Zu.apply(void 0,gn):function(Se,Xe,Xn,dn){var Fn=1&Xe,An=bu(Se);return function jn(){for(var Mn=-1,Vn=arguments.length,Vr=-1,_o=dn.length,es=fe(_o+Vn),Bi=this&&this!==Er&&this instanceof jn?An:Se;++Vr<_o;)es[Vr]=dn[Vr];for(;Vn--;)es[Vr++]=arguments[++Mn];return Do(Bi,Fn?Xn:this,es)}}(c,g,S,D);else var Cn=function(Se,Xe,Xn){var dn=1&Xe,Fn=bu(Se);return function An(){var jn=this&&this!==Er&&this instanceof An?Fn:Se;return jn.apply(dn?Xn:this,arguments)}}(c,g,S);return Id((mn?Mc:Ga)(Cn,gn),c,g)}function jl(c,g,S,D){return c===void 0||zo(c,su[S])&&!Gr.call(D,S)?g:c}function Zi(c,g,S,D,H,it){return pi(c)&&pi(g)&&(it.set(g,c),Na(c,g,void 0,Zi,it),it.delete(g)),c}function Ic(c){return rl(c)?void 0:c}function $u(c,g,S,D,H,it){var vt=1&S,St=c.length,Ft=g.length;if(St!=Ft&&!(vt&&Ft>St))return!1;var ae=it.get(c),le=it.get(g);if(ae&&le)return ae==g&&le==c;var Oe=-1,mn=!0,gn=2&S?new Gs:void 0;for(it.set(c,g),it.set(g,c);++Oe<St;){var Cn=c[Oe],Se=g[Oe];if(D)var Xe=vt?D(Se,Cn,Oe,g,c,it):D(Cn,Se,Oe,c,g,it);if(Xe!==void 0){if(Xe)continue;mn=!1;break}if(gn){if(!ai(g,function(Xn,dn){if(!iu(gn,dn)&&(Cn===Xn||H(Cn,Xn,S,D,it)))return gn.push(dn)})){mn=!1;break}}else if(Cn!==Se&&!H(Cn,Se,S,D,it)){mn=!1;break}}return it.delete(c),it.delete(g),mn}function Ds(c){return Gh(Cd(c,void 0,vs),c+"")}function Dh(c){return Vs(c,oi,mo)}function Ed(c){return Vs(c,vo,er)}var Md=To?function(c){return To.get(c)}:tc;function Go(c){for(var g=c.name+"",S=cu[g],D=Gr.call(cu,g)?S.length:0;D--;){var H=S[D],it=H.func;if(it==null||it==c)return H.name}return g}function Ns(c){return(Gr.call(q,"placeholder")?q:c).placeholder}function Nn(){var c=q.iteratee||Ro;return c=c===Ro?wc:c,arguments.length?c(arguments[0],arguments[1]):c}function ka(c,g){var S,D,H=c.__data__;return((D=typeof(S=g))=="string"||D=="number"||D=="symbol"||D=="boolean"?S!=="__proto__":S===null)?H[typeof g=="string"?"string":"hash"]:H.map}function Nh(c){for(var g=oi(c),S=g.length;S--;){var D=g[S],H=c[D];g[S]=[D,H,Ku(H)]}return g}function wu(c,g){var S=function(D,H){return D==null?void 0:D[H]}(c,g);return wd(S)?S:void 0}var mo=uu?function(c){return c==null?[]:(c=Cr(c),na(uu(c),function(g){return Yi.call(c,g)}))}:Zc,er=uu?function(c){for(var g=[];c;)ra(g,mo(c)),c=Ll(c);return g}:Zc,Ze=Li;function gs(c,g,S){for(var D=-1,H=(g=$o(g,c)).length,it=!1;++D<H;){var vt=Ho(g[D]);if(!(it=c!=null&&S(c,vt)))break;c=c[vt]}return it||++D!=H?it:!!(H=c==null?0:c.length)&&kc(H)&&Ys(vt,H)&&(rr(c)||Eu(c))}function Ad(c){return typeof c.constructor!="function"||Wl(c)?{}:Es(Ll(c))}function Vl(c){return rr(c)||Eu(c)||!!(Sp&&c&&c[Sp])}function Ys(c,g){var S=typeof c;return!!(g=g==null?9007199254740991:g)&&(S=="number"||S!="symbol"&&Ct.test(c))&&c>-1&&c%1==0&&c<g}function Ao(c,g,S){if(!pi(S))return!1;var D=typeof g;return!!(D=="number"?Co(S)&&Ys(g,S.length):D=="string"&&g in S)&&zo(S[g],c)}function Fh(c,g){if(rr(c))return!1;var S=typeof c;return!(S!="number"&&S!="symbol"&&S!="boolean"&&c!=null&&!Qo(c))||kr.test(c)||!Nr.test(c)||g!=null&&c in Cr(g)}function Bh(c){var g=Go(c),S=q[g];if(typeof S!="function"||!(g in ur.prototype))return!1;if(c===S)return!0;var D=Md(S);return!!D&&c===D[0]}(lu&&Ze(new lu(new ArrayBuffer(1)))!=te||as&&Ze(new as)!=F||Eh&&Ze(Eh.resolve())!="[object Promise]"||ui&&Ze(new ui)!=X||hu&&Ze(new hu)!=ue)&&(Ze=function(c){var g=Li(c),S=g==rt?c.constructor:void 0,D=S?fa(S):"";if(D)switch(D){case Dl:return te;case eo:return F;case ot:return"[object Promise]";case xc:return X;case bd:return ue}return g});var Pd=zu?qs:ih;function Wl(c){var g=c&&c.constructor;return c===(typeof g=="function"&&g.prototype||su)}function Ku(c){return c==c&&!pi(c)}function Uh(c,g){return function(S){return S!=null&&S[c]===g&&(g!==void 0||c in Cr(S))}}function Cd(c,g,S){return g=xi(g===void 0?c.length-1:g,0),function(){for(var D=arguments,H=-1,it=xi(D.length-g,0),vt=fe(it);++H<it;)vt[H]=D[g+H];H=-1;for(var St=fe(g+1);++H<g;)St[H]=D[H];return St[g]=S(vt),Do(c,this,St)}}function Rd(c,g){return g.length<2?c:mu(c,Oi(g,0,-1))}function Xl(c,g){for(var S=c.length,D=to(g.length,S),H=ji(c);D--;){var it=g[D];c[D]=Ys(it,S)?H[it]:void 0}return c}function kh(c,g){if((g!=="constructor"||typeof c[g]!="function")&&g!="__proto__")return c[g]}var Ga=Ld(Mc),Ha=qi||function(c,g){return Er.setTimeout(c,g)},Gh=Ld(Ch);function Id(c,g,S){var D=g+"";return Gh(c,function(H,it){var vt=it.length;if(!vt)return H;var St=vt-1;return it[St]=(vt>1?"& ":"")+it[St],it=it.join(vt>2?", ":" "),H.replace(Sr,`{
/* [wrapped with `+it+`] */
`)}(D,function(H,it){return ao(mt,function(vt){var St="_."+vt[0];it&vt[1]&&!El(H,St)&&H.push(St)}),H.sort()}(function(H){var it=H.match(Lr);return it?it[1].split(mi):[]}(D),S)))}function Ld(c){var g=0,S=0;return function(){var D=yc(),H=16-(D-S);if(S=D,H>0){if(++g>=800)return arguments[0]}else g=0;return c.apply(void 0,arguments)}}function Tu(c,g){var S=-1,D=c.length,H=D-1;for(g=g===void 0?D:g;++S<g;){var it=Ec(S,H),vt=c[it];c[it]=c[S],c[S]=vt}return c.length=g,c}var Hh=function(c){var g=nl(c,function(D){return S.size===500&&S.clear(),D}),S=g.cache;return g}(function(c){var g=[];return c.charCodeAt(0)===46&&g.push(""),c.replace(Ir,function(S,D,H,it){g.push(H?it.replace(so,"$1"):D||S)}),g});function Ho(c){if(typeof c=="string"||Qo(c))return c;var g=c+"";return g=="0"&&1/c==-1/0?"-0":g}function fa(c){if(c!=null){try{return Il.call(c)}catch{}try{return c+""}catch{}}return""}function Su(c){if(c instanceof ur)return c.clone();var g=new lo(c.__wrapped__,c.__chain__);return g.__actions__=ji(c.__actions__),g.__index__=c.__index__,g.__values__=c.__values__,g}var Ep=Qn(function(c,g){return Ai(c)?wn(c,Ei(g,1,Ai,!0)):[]}),Qu=Qn(function(c,g){var S=Fs(g);return Ai(S)&&(S=void 0),Ai(c)?wn(c,Ei(g,1,Ai,!0),Nn(S,2)):[]}),Po=Qn(function(c,g){var S=Fs(g);return Ai(S)&&(S=void 0),Ai(c)?wn(c,Ei(g,1,Ai,!0),void 0,S):[]});function go(c,g,S){var D=c==null?0:c.length;if(!D)return-1;var H=S==null?0:hr(S);return H<0&&(H=xi(D+H,0)),ks(c,Nn(g,3),H)}function zh(c,g,S){var D=c==null?0:c.length;if(!D)return-1;var H=D-1;return S!==void 0&&(H=hr(S),H=S<0?xi(D+H,0):to(H,D-1)),ks(c,Nn(g,3),H,!0)}function vs(c){return(c==null?0:c.length)?Ei(c,1):[]}function Mp(c){return c&&c.length?c[0]:void 0}var Ap=Qn(function(c){var g=ei(c,Hr);return g.length&&g[0]===c[0]?Ul(g):[]}),Yl=Qn(function(c){var g=Fs(c),S=ei(c,Hr);return g===Fs(S)?g=void 0:S.pop(),S.length&&S[0]===c[0]?Ul(S,Nn(g,2)):[]}),jh=Qn(function(c){var g=Fs(c),S=ei(c,Hr);return(g=typeof g=="function"?g:void 0)&&S.pop(),S.length&&S[0]===c[0]?Ul(S,void 0,g):[]});function Fs(c){var g=c==null?0:c.length;return g?c[g-1]:void 0}var li=Qn(Od);function Od(c,g){return c&&c.length&&g&&g.length?Gl(c,g):c}var Dd=Ds(function(c,g){var S=c==null?0:c.length,D=As(c,g);return Mi(c,ei(g,function(H){return Ys(H,S)?+H:H}).sort(Xr)),D});function Nd(c){return c==null?c:Ii.call(c)}var tl=Qn(function(c){return ca(Ei(c,1,Ai,!0))}),Pp=Qn(function(c){var g=Fs(c);return Ai(g)&&(g=void 0),ca(Ei(c,1,Ai,!0),Nn(g,2))}),Fd=Qn(function(c){var g=Fs(c);return g=typeof g=="function"?g:void 0,ca(Ei(c,1,Ai,!0),void 0,g)});function Vh(c){if(!c||!c.length)return[];var g=0;return c=na(c,function(S){if(Ai(S))return g=xi(S.length,g),!0}),ru(g,function(S){return ei(c,bh(S))})}function Ko(c,g){if(!c||!c.length)return[];var S=Vh(c);return g==null?S:ei(S,function(D){return Do(g,void 0,D)})}var Lc=Qn(function(c,g){return Ai(c)?wn(c,g):[]}),hf=Qn(function(c){return yn(na(c,Ai))}),Oc=Qn(function(c){var g=Fs(c);return Ai(g)&&(g=void 0),yn(na(c,Ai),Nn(g,2))}),Cp=Qn(function(c){var g=Fs(c);return g=typeof g=="function"?g:void 0,yn(na(c,Ai),void 0,g)}),Rp=Qn(Vh),cf=Qn(function(c){var g=c.length,S=g>1?c[g-1]:void 0;return S=typeof S=="function"?(c.pop(),S):void 0,Ko(c,S)});function Ip(c){var g=q(c);return g.__chain__=!0,g}function Dc(c,g){return g(c)}var df=Ds(function(c){var g=c.length,S=g?c[0]:0,D=this.__wrapped__,H=function(it){return As(it,c)};return!(g>1||this.__actions__.length)&&D instanceof ur&&Ys(S)?((D=D.slice(S,+S+(g?1:0))).__actions__.push({func:Dc,args:[H],thisArg:void 0}),new lo(D,this.__chain__).thru(function(it){return g&&!it.length&&it.push(void 0),it})):this.thru(H)}),pf=Di(function(c,g,S){Gr.call(c,S)?++c[S]:hs(c,S,1)}),ff=Ih(go),mf=Ih(zh);function Bd(c,g){return(rr(c)?ao:ds)(c,Nn(g,3))}function Ud(c,g){return(rr(c)?_i:ps)(c,Nn(g,3))}var gf=Di(function(c,g,S){Gr.call(c,S)?c[S].push(g):hs(c,S,[g])}),vf=Qn(function(c,g,S){var D=-1,H=typeof g=="function",it=Co(c)?fe(c.length):[];return ds(c,function(vt){it[++D]=H?Do(g,vt,S):vu(vt,g,S)}),it}),Lp=Di(function(c,g,S){hs(c,S,g)});function Nc(c,g){return(rr(c)?ei:Tc)(c,Nn(g,3))}var kd=Di(function(c,g,S){c[S?0:1].push(g)},function(){return[[],[]]}),Op=Qn(function(c,g){if(c==null)return[];var S=g.length;return S>1&&Ao(c,g[0],g[1])?g=[]:S>2&&Ao(g[0],g[1],g[2])&&(g=[g[0]]),Sc(c,Ei(g,1),[])}),Wh=Ra||function(){return Er.Date.now()};function Gd(c,g,S){return g=S?void 0:g,fo(c,128,void 0,void 0,void 0,void 0,g=c&&g==null?c.length:g)}function el(c,g){var S;if(typeof g!="function")throw new Qi(Z);return c=hr(c),function(){return--c>0&&(S=g.apply(this,arguments)),c<=1&&(g=void 0),S}}var Fc=Qn(function(c,g,S){var D=1;if(S.length){var H=ss(S,Ns(Fc));D|=32}return fo(c,D,g,S,H)}),Xh=Qn(function(c,g,S){var D=3;if(S.length){var H=ss(S,Ns(Xh));D|=32}return fo(g,D,c,S,H)});function ql(c,g,S){var D,H,it,vt,St,Ft,ae=0,le=!1,Oe=!1,mn=!0;if(typeof c!="function")throw new Qi(Z);function gn(Fn){var An=D,jn=H;return D=H=void 0,ae=Fn,vt=c.apply(jn,An)}function Cn(Fn){return ae=Fn,St=Ha(Xe,g),le?gn(Fn):vt}function Se(Fn){var An=Fn-Ft;return Ft===void 0||An>=g||An<0||Oe&&Fn-ae>=it}function Xe(){var Fn=Wh();if(Se(Fn))return Xn(Fn);St=Ha(Xe,function(An){var jn=g-(An-Ft);return Oe?to(jn,it-(An-ae)):jn}(Fn))}function Xn(Fn){return St=void 0,mn&&D?gn(Fn):(D=H=void 0,vt)}function dn(){var Fn=Wh(),An=Se(Fn);if(D=arguments,H=this,Ft=Fn,An){if(St===void 0)return Cn(Ft);if(Oe)return Rh(St),St=Ha(Xe,g),gn(Ft)}return St===void 0&&(St=Ha(Xe,g)),vt}return g=ys(g)||0,pi(S)&&(le=!!S.leading,it=(Oe="maxWait"in S)?xi(ys(S.maxWait)||0,g):it,mn="trailing"in S?!!S.trailing:mn),dn.cancel=function(){St!==void 0&&Rh(St),ae=0,D=Ft=H=St=void 0},dn.flush=function(){return St===void 0?vt:Xn(Wh())},dn}var Dp=Qn(function(c,g){return cs(c,1,g)}),za=Qn(function(c,g,S){return cs(c,ys(g)||0,S)});function nl(c,g){if(typeof c!="function"||g!=null&&typeof g!="function")throw new Qi(Z);var S=function(){var D=arguments,H=g?g.apply(this,D):D[0],it=S.cache;if(it.has(H))return it.get(H);var vt=c.apply(this,D);return S.cache=it.set(H,vt)||it,vt};return S.cache=new(nl.Cache||ls),S}function Yh(c){if(typeof c!="function")throw new Qi(Z);return function(){var g=arguments;switch(g.length){case 0:return!c.call(this);case 1:return!c.call(this,g[0]);case 2:return!c.call(this,g[0],g[1]);case 3:return!c.call(this,g[0],g[1],g[2])}return!c.apply(this,g)}}nl.Cache=ls;var Bc=Os(function(c,g){var S=(g=g.length==1&&rr(g[0])?ei(g[0],xo(Nn())):ei(Ei(g,1),xo(Nn()))).length;return Qn(function(D){for(var H=-1,it=to(D.length,S);++H<it;)D[H]=g[H].call(this,D[H]);return Do(c,this,D)})}),qh=Qn(function(c,g){return fo(c,32,void 0,g,ss(g,Ns(qh)))}),Bs=Qn(function(c,g){return fo(c,64,void 0,g,ss(g,Ns(Bs)))}),Zh=Ds(function(c,g){return fo(c,256,void 0,void 0,void 0,g)});function zo(c,g){return c===g||c!=c&&g!=g}var Zl=Ju(Ps),Jl=Ju(function(c,g){return c>=g}),Eu=bc(function(){return arguments}())?bc:function(c){return wi(c)&&Gr.call(c,"callee")&&!Yi.call(c,"callee")},rr=fe.isArray,Hd=pc?xo(pc):function(c){return wi(c)&&Li(c)==je};function Co(c){return c!=null&&kc(c.length)&&!qs(c)}function Ai(c){return wi(c)&&Co(c)}var ja=wo||ih,Np=fc?xo(fc):function(c){return wi(c)&&Li(c)==Nt};function Mu(c){if(!wi(c))return!1;var g=Li(c);return g==Xt||g=="[object DOMException]"||typeof c.message=="string"&&typeof c.name=="string"&&!rl(c)}function qs(c){if(!pi(c))return!1;var g=Li(c);return g==Gt||g==L||g=="[object AsyncFunction]"||g=="[object Proxy]"}function Uc(c){return typeof c=="number"&&c==hr(c)}function kc(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=9007199254740991}function pi(c){var g=typeof c;return c!=null&&(g=="object"||g=="function")}function wi(c){return c!=null&&typeof c=="object"}var Fp=Tl?xo(Tl):function(c){return wi(c)&&Ze(c)==F};function Gc(c){return typeof c=="number"||wi(c)&&Li(c)==z}function rl(c){if(!wi(c)||Li(c)!=rt)return!1;var g=Ll(c);if(g===null)return!0;var S=Gr.call(g,"constructor")&&g.constructor;return typeof S=="function"&&S instanceof S&&Il.call(S)==_d}var Hc=_h?xo(_h):function(c){return wi(c)&&Li(c)==k},zd=Sl?xo(Sl):function(c){return wi(c)&&Ze(c)==X};function Jh(c){return typeof c=="string"||!rr(c)&&wi(c)&&Li(c)==tt}function Qo(c){return typeof c=="symbol"||wi(c)&&Li(c)==ht}var il=yh?xo(yh):function(c){return wi(c)&&kc(c.length)&&!!on[Li(c)]},jd=Ju(Rs),Bp=Ju(function(c,g){return c<=g});function $l(c){if(!c)return[];if(Co(c))return Jh(c)?Ts(c):ji(c);if(Ol&&c[Ol])return function(S){for(var D,H=[];!(D=S.next()).done;)H.push(D.value);return H}(c[Ol]());var g=Ze(c);return(g==F?ia:g==X?ou:ma)(c)}function _s(c){return c?(c=ys(c))===1/0||c===-1/0?17976931348623157e292*(c<0?-1:1):c==c?c:0:c===0?c:0}function hr(c){var g=_s(c),S=g%1;return g==g?S?g-S:g:0}function Vd(c){return c?zs(hr(c),0,4294967295):0}function ys(c){if(typeof c=="number")return c;if(Qo(c))return NaN;if(pi(c)){var g=typeof c.valueOf=="function"?c.valueOf():c;c=pi(g)?g+"":g}if(typeof c!="string")return c===0?c:+c;c=gc(c);var S=ft.test(c);return S||Lt.test(c)?Zn(c.slice(2),S?2:8):Q.test(c)?NaN:+c}function zc(c){return ms(c,vo(c))}function Mr(c){return c==null?"":Eo(c)}var Au=ko(function(c,g){if(Wl(g)||Co(g))ms(g,oi(g),c);else for(var S in g)Gr.call(g,S)&&pu(c,S,g[S])}),Wd=ko(function(c,g){ms(g,vo(g),c)}),ol=ko(function(c,g,S,D){ms(g,vo(g),c,D)}),Up=ko(function(c,g,S,D){ms(g,oi(g),c,D)}),_f=Ds(As),Yr=Qn(function(c,g){c=Cr(c);var S=-1,D=g.length,H=D>2?g[2]:void 0;for(H&&Ao(g[0],g[1],H)&&(D=1);++S<D;)for(var it=g[S],vt=vo(it),St=-1,Ft=vt.length;++St<Ft;){var ae=vt[St],le=c[ae];(le===void 0||zo(le,su[ae])&&!Gr.call(c,ae))&&(c[ae]=it[ae])}return c}),jc=Qn(function(c){return c.push(void 0,Zi),Do(Ql,void 0,c)});function sl(c,g,S){var D=c==null?void 0:mu(c,g);return D===void 0?S:D}function Pu(c,g){return c!=null&&gs(c,g,gu)}var Kl=Oh(function(c,g,S){g!=null&&typeof g.toString!="function"&&(g=ju.call(g)),c[g]=S},Kh(io)),Cu=Oh(function(c,g,S){g!=null&&typeof g.toString!="function"&&(g=ju.call(g)),Gr.call(c,g)?c[g].push(S):c[g]=[S]},Nn),Fi=Qn(vu);function oi(c){return Co(c)?Hs(c):mr(c)}function vo(c){return Co(c)?Hs(c,!0):Cs(c)}var al=ko(function(c,g,S){Na(c,g,S)}),Ql=ko(function(c,g,S,D){Na(c,g,S,D)}),ul=Ds(function(c,g){var S={};if(c==null)return S;var D=!1;g=ei(g,function(it){return it=$o(it,c),D||(D=it.length>1),it}),ms(c,Ed(c),S),D&&(S=ho(S,7,Ic));for(var H=g.length;H--;)Hl(S,g[H]);return S}),th=Ds(function(c,g){return c==null?{}:function(S,D){return Ah(S,D,function(H,it){return Pu(S,it)})}(c,g)});function Ru(c,g){if(c==null)return{};var S=ei(Ed(c),function(D){return[D]});return g=Nn(g),Ah(c,S,function(D,H){return g(D,H[0])})}var Zs=Sd(oi),Vc=Sd(vo);function ma(c){return c==null?[]:ci(c,oi(c))}var $h=xu(function(c,g,S){return g=g.toLowerCase(),c+(S?eh(g):g)});function eh(c){return Xc(Mr(c).toLowerCase())}function Xd(c){return(c=Mr(c))&&c.replace(It,No).replace($e,"")}var Yd=xu(function(c,g,S){return c+(S?"-":"")+g.toLowerCase()}),qd=xu(function(c,g,S){return c+(S?" ":"")+g.toLowerCase()}),nh=Rc("toLowerCase"),Wc=xu(function(c,g,S){return c+(S?"_":"")+g.toLowerCase()}),Iu=xu(function(c,g,S){return c+(S?" ":"")+Xc(g)}),kp=xu(function(c,g,S){return c+(S?" ":"")+g.toUpperCase()}),Xc=Rc("toUpperCase");function Zd(c,g,S){return c=Mr(c),(g=S?void 0:g)===void 0?function(D){return Sn.test(D)}(c)?function(D){return D.match(Rn)||[]}(c):function(D){return D.match(ws)||[]}(c):c.match(g)||[]}var Jd=Qn(function(c,g){try{return Do(c,void 0,g)}catch(S){return Mu(S)?S:new pr(S)}}),Gp=Ds(function(c,g){return ao(g,function(S){S=Ho(S),hs(c,S,Fc(c[S],c))}),c});function Kh(c){return function(){return c}}var Qh=Lh(),ll=Lh(!0);function io(c){return c}function Ro(c){return wc(typeof c=="function"?c:ho(c,1))}var $d=Qn(function(c,g){return function(S){return vu(S,c,g)}}),Yc=Qn(function(c,g){return function(S){return vu(c,S,g)}});function hl(c,g,S){var D=oi(g),H=fu(g,D);S!=null||pi(g)&&(H.length||!D.length)||(S=g,g=c,c=this,H=fu(g,oi(g)));var it=!(pi(S)&&"chain"in S&&!S.chain),vt=qs(c);return ao(H,function(St){var Ft=g[St];c[St]=Ft,vt&&(c.prototype[St]=function(){var ae=this.__chain__;if(it||ae){var le=c(this.__wrapped__),Oe=le.__actions__=ji(this.__actions__);return Oe.push({func:Ft,args:arguments,thisArg:c}),le.__chain__=ae,le}return Ft.apply(c,ra([this.value()],arguments))})}),c}function tc(){}var Kd=da(ei),ec=da(Uu),rh=da(ai);function qc(c){return Fh(c)?bh(Ho(c)):function(g){return function(S){return mu(S,g)}}(c)}var oo=Ni(),nc=Ni(!0);function Zc(){return[]}function ih(){return!1}var Qd=Ws(function(c,g){return c+g},0),Jc=Ua("ceil"),Va=Ws(function(c,g){return c/g},1),Hp=Ua("floor"),$c,ts=Ws(function(c,g){return c*g},1),tp=Ua("round"),cl=Ws(function(c,g){return c-g},0);return q.after=function(c,g){if(typeof g!="function")throw new Qi(Z);return c=hr(c),function(){if(--c<1)return g.apply(this,arguments)}},q.ary=Gd,q.assign=Au,q.assignIn=Wd,q.assignInWith=ol,q.assignWith=Up,q.at=_f,q.before=el,q.bind=Fc,q.bindAll=Gp,q.bindKey=Xh,q.castArray=function(){if(!arguments.length)return[];var c=arguments[0];return rr(c)?c:[c]},q.chain=Ip,q.chunk=function(c,g,S){g=(S?Ao(c,g,S):g===void 0)?1:xi(hr(g),0);var D=c==null?0:c.length;if(!D||g<1)return[];for(var H=0,it=0,vt=fe(Wu(D/g));H<D;)vt[it++]=Oi(c,H,H+=g);return vt},q.compact=function(c){for(var g=-1,S=c==null?0:c.length,D=0,H=[];++g<S;){var it=c[g];it&&(H[D++]=it)}return H},q.concat=function(){var c=arguments.length;if(!c)return[];for(var g=fe(c-1),S=arguments[0],D=c;D--;)g[D-1]=arguments[D];return ra(rr(S)?ji(S):[S],Ei(g,1))},q.cond=function(c){var g=c==null?0:c.length,S=Nn();return c=g?ei(c,function(D){if(typeof D[1]!="function")throw new Qi(Z);return[S(D[0]),D[1]]}):[],Qn(function(D){for(var H=-1;++H<g;){var it=c[H];if(Do(it[0],this,D))return Do(it[1],this,D)}})},q.conforms=function(c){return function(g){var S=oi(g);return function(D){return ua(D,g,S)}}(ho(c,1))},q.constant=Kh,q.countBy=pf,q.create=function(c,g){var S=Es(c);return g==null?S:Nl(S,g)},q.curry=function c(g,S,D){var H=fo(g,8,void 0,void 0,void 0,void 0,void 0,S=D?void 0:S);return H.placeholder=c.placeholder,H},q.curryRight=function c(g,S,D){var H=fo(g,16,void 0,void 0,void 0,void 0,void 0,S=D?void 0:S);return H.placeholder=c.placeholder,H},q.debounce=ql,q.defaults=Yr,q.defaultsDeep=jc,q.defer=Dp,q.delay=za,q.difference=Ep,q.differenceBy=Qu,q.differenceWith=Po,q.drop=function(c,g,S){var D=c==null?0:c.length;return D?Oi(c,(g=S||g===void 0?1:hr(g))<0?0:g,D):[]},q.dropRight=function(c,g,S){var D=c==null?0:c.length;return D?Oi(c,0,(g=D-(g=S||g===void 0?1:hr(g)))<0?0:g):[]},q.dropRightWhile=function(c,g){return c&&c.length?Bo(c,Nn(g,3),!0,!0):[]},q.dropWhile=function(c,g){return c&&c.length?Bo(c,Nn(g,3),!0):[]},q.fill=function(c,g,S,D){var H=c==null?0:c.length;return H?(S&&typeof S!="number"&&Ao(c,g,S)&&(S=0,D=H),function(it,vt,St,Ft){var ae=it.length;for((St=hr(St))<0&&(St=-St>ae?0:ae+St),(Ft=Ft===void 0||Ft>ae?ae:hr(Ft))<0&&(Ft+=ae),Ft=St>Ft?0:Vd(Ft);St<Ft;)it[St++]=vt;return it}(c,g,S,D)):[]},q.filter=function(c,g){return(rr(c)?na:js)(c,Nn(g,3))},q.flatMap=function(c,g){return Ei(Nc(c,g),1)},q.flatMapDeep=function(c,g){return Ei(Nc(c,g),1/0)},q.flatMapDepth=function(c,g,S){return S=S===void 0?1:hr(S),Ei(Nc(c,g),S)},q.flatten=vs,q.flattenDeep=function(c){return(c==null?0:c.length)?Ei(c,1/0):[]},q.flattenDepth=function(c,g){return(c==null?0:c.length)?Ei(c,g=g===void 0?1:hr(g)):[]},q.flip=function(c){return fo(c,512)},q.flow=Qh,q.flowRight=ll,q.fromPairs=function(c){for(var g=-1,S=c==null?0:c.length,D={};++g<S;){var H=c[g];D[H[0]]=H[1]}return D},q.functions=function(c){return c==null?[]:fu(c,oi(c))},q.functionsIn=function(c){return c==null?[]:fu(c,vo(c))},q.groupBy=gf,q.initial=function(c){return(c==null?0:c.length)?Oi(c,0,-1):[]},q.intersection=Ap,q.intersectionBy=Yl,q.intersectionWith=jh,q.invert=Kl,q.invertBy=Cu,q.invokeMap=vf,q.iteratee=Ro,q.keyBy=Lp,q.keys=oi,q.keysIn=vo,q.map=Nc,q.mapKeys=function(c,g){var S={};return g=Nn(g,3),fs(c,function(D,H,it){hs(S,g(D,H,it),D)}),S},q.mapValues=function(c,g){var S={};return g=Nn(g,3),fs(c,function(D,H,it){hs(S,H,g(D,H,it))}),S},q.matches=function(c){return Is(ho(c,1))},q.matchesProperty=function(c,g){return _u(c,ho(g,1))},q.memoize=nl,q.merge=al,q.mergeWith=Ql,q.method=$d,q.methodOf=Yc,q.mixin=hl,q.negate=Yh,q.nthArg=function(c){return c=hr(c),Qn(function(g){return Yu(g,c)})},q.omit=ul,q.omitBy=function(c,g){return Ru(c,Yh(Nn(g)))},q.once=function(c){return el(2,c)},q.orderBy=function(c,g,S,D){return c==null?[]:(rr(g)||(g=g==null?[]:[g]),rr(S=D?void 0:S)||(S=S==null?[]:[S]),Sc(c,g,S))},q.over=Kd,q.overArgs=Bc,q.overEvery=ec,q.overSome=rh,q.partial=qh,q.partialRight=Bs,q.partition=kd,q.pick=th,q.pickBy=Ru,q.property=qc,q.propertyOf=function(c){return function(g){return c==null?void 0:mu(c,g)}},q.pull=li,q.pullAll=Od,q.pullAllBy=function(c,g,S){return c&&c.length&&g&&g.length?Gl(c,g,Nn(S,2)):c},q.pullAllWith=function(c,g,S){return c&&c.length&&g&&g.length?Gl(c,g,void 0,S):c},q.pullAt=Dd,q.range=oo,q.rangeRight=nc,q.rearg=Zh,q.reject=function(c,g){return(rr(c)?na:js)(c,Yh(Nn(g,3)))},q.remove=function(c,g){var S=[];if(!c||!c.length)return S;var D=-1,H=[],it=c.length;for(g=Nn(g,3);++D<it;){var vt=c[D];g(vt,D,c)&&(S.push(vt),H.push(D))}return Mi(c,H),S},q.rest=function(c,g){if(typeof c!="function")throw new Qi(Z);return Qn(c,g=g===void 0?g:hr(g))},q.reverse=Nd,q.sampleSize=function(c,g,S){return g=(S?Ao(c,g,S):g===void 0)?1:hr(g),(rr(c)?Oa:Ph)(c,g)},q.set=function(c,g,S){return c==null?c:qu(c,g,S)},q.setWith=function(c,g,S,D){return D=typeof D=="function"?D:void 0,c==null?c:qu(c,g,S,D)},q.shuffle=function(c){return(rr(c)?Da:pn)(c)},q.slice=function(c,g,S){var D=c==null?0:c.length;return D?(S&&typeof S!="number"&&Ao(c,g,S)?(g=0,S=D):(g=g==null?0:hr(g),S=S===void 0?D:hr(S)),Oi(c,g,S)):[]},q.sortBy=Op,q.sortedUniq=function(c){return c&&c.length?On(c):[]},q.sortedUniqBy=function(c,g){return c&&c.length?On(c,Nn(g,2)):[]},q.split=function(c,g,S){return S&&typeof S!="number"&&Ao(c,g,S)&&(g=S=void 0),(S=S===void 0?4294967295:S>>>0)?(c=Mr(c))&&(typeof g=="string"||g!=null&&!Hc(g))&&!(g=Eo(g))&&ri(c)?bi(Ts(c),0,S):c.split(g,S):[]},q.spread=function(c,g){if(typeof c!="function")throw new Qi(Z);return g=g==null?0:xi(hr(g),0),Qn(function(S){var D=S[g],H=bi(S,0,g);return D&&ra(H,D),Do(c,this,H)})},q.tail=function(c){var g=c==null?0:c.length;return g?Oi(c,1,g):[]},q.take=function(c,g,S){return c&&c.length?Oi(c,0,(g=S||g===void 0?1:hr(g))<0?0:g):[]},q.takeRight=function(c,g,S){var D=c==null?0:c.length;return D?Oi(c,(g=D-(g=S||g===void 0?1:hr(g)))<0?0:g,D):[]},q.takeRightWhile=function(c,g){return c&&c.length?Bo(c,Nn(g,3),!1,!0):[]},q.takeWhile=function(c,g){return c&&c.length?Bo(c,Nn(g,3)):[]},q.tap=function(c,g){return g(c),c},q.throttle=function(c,g,S){var D=!0,H=!0;if(typeof c!="function")throw new Qi(Z);return pi(S)&&(D="leading"in S?!!S.leading:D,H="trailing"in S?!!S.trailing:H),ql(c,g,{leading:D,maxWait:g,trailing:H})},q.thru=Dc,q.toArray=$l,q.toPairs=Zs,q.toPairsIn=Vc,q.toPath=function(c){return rr(c)?ei(c,Ho):Qo(c)?[c]:ji(Hh(Mr(c)))},q.toPlainObject=zc,q.transform=function(c,g,S){var D=rr(c),H=D||ja(c)||il(c);if(g=Nn(g,4),S==null){var it=c&&c.constructor;S=H?D?new it:[]:pi(c)&&qs(it)?Es(Ll(c)):{}}return(H?ao:fs)(c,function(vt,St,Ft){return g(S,vt,St,Ft)}),S},q.unary=function(c){return Gd(c,1)},q.union=tl,q.unionBy=Pp,q.unionWith=Fd,q.uniq=function(c){return c&&c.length?ca(c):[]},q.uniqBy=function(c,g){return c&&c.length?ca(c,Nn(g,2)):[]},q.uniqWith=function(c,g){return g=typeof g=="function"?g:void 0,c&&c.length?ca(c,void 0,g):[]},q.unset=function(c,g){return c==null||Hl(c,g)},q.unzip=Vh,q.unzipWith=Ko,q.update=function(c,g,S){return c==null?c:Td(c,g,lr(S))},q.updateWith=function(c,g,S,D){return D=typeof D=="function"?D:void 0,c==null?c:Td(c,g,lr(S),D)},q.values=ma,q.valuesIn=function(c){return c==null?[]:ci(c,vo(c))},q.without=Lc,q.words=Zd,q.wrap=function(c,g){return qh(lr(g),c)},q.xor=hf,q.xorBy=Oc,q.xorWith=Cp,q.zip=Rp,q.zipObject=function(c,g){return Ls(c||[],g||[],pu)},q.zipObjectDeep=function(c,g){return Ls(c||[],g||[],qu)},q.zipWith=cf,q.entries=Zs,q.entriesIn=Vc,q.extend=Wd,q.extendWith=ol,hl(q,q),q.add=Qd,q.attempt=Jd,q.camelCase=$h,q.capitalize=eh,q.ceil=Jc,q.clamp=function(c,g,S){return S===void 0&&(S=g,g=void 0),S!==void 0&&(S=(S=ys(S))==S?S:0),g!==void 0&&(g=(g=ys(g))==g?g:0),zs(ys(c),g,S)},q.clone=function(c){return ho(c,4)},q.cloneDeep=function(c){return ho(c,5)},q.cloneDeepWith=function(c,g){return ho(c,5,g=typeof g=="function"?g:void 0)},q.cloneWith=function(c,g){return ho(c,4,g=typeof g=="function"?g:void 0)},q.conformsTo=function(c,g){return g==null||ua(c,g,oi(g))},q.deburr=Xd,q.defaultTo=function(c,g){return c==null||c!=c?g:c},q.divide=Va,q.endsWith=function(c,g,S){c=Mr(c),g=Eo(g);var D=c.length,H=S=S===void 0?D:zs(hr(S),0,D);return(S-=g.length)>=0&&c.slice(S,H)==g},q.eq=zo,q.escape=function(c){return(c=Mr(c))&&Kn.test(c)?c.replace($n,Al):c},q.escapeRegExp=function(c){return(c=Mr(c))&&Pr.test(c)?c.replace(Jr,"\\$&"):c},q.every=function(c,g,S){var D=rr(c)?Uu:lf;return S&&Ao(c,g,S)&&(g=void 0),D(c,Nn(g,3))},q.find=ff,q.findIndex=go,q.findKey=function(c,g){return yi(c,Nn(g,3),fs)},q.findLast=mf,q.findLastIndex=zh,q.findLastKey=function(c,g){return yi(c,Nn(g,3),la)},q.floor=Hp,q.forEach=Bd,q.forEachRight=Ud,q.forIn=function(c,g){return c==null?c:co(c,Nn(g,3),vo)},q.forInRight=function(c,g){return c==null?c:Fl(c,Nn(g,3),vo)},q.forOwn=function(c,g){return c&&fs(c,Nn(g,3))},q.forOwnRight=function(c,g){return c&&la(c,Nn(g,3))},q.get=sl,q.gt=Zl,q.gte=Jl,q.has=function(c,g){return c!=null&&gs(c,g,Bl)},q.hasIn=Pu,q.head=Mp,q.identity=io,q.includes=function(c,g,S,D){c=Co(c)?c:ma(c),S=S&&!D?hr(S):0;var H=c.length;return S<0&&(S=xi(H+S,0)),Jh(c)?S<=H&&c.indexOf(g,S)>-1:!!H&&os(c,g,S)>-1},q.indexOf=function(c,g,S){var D=c==null?0:c.length;if(!D)return-1;var H=S==null?0:hr(S);return H<0&&(H=xi(D+H,0)),os(c,g,H)},q.inRange=function(c,g,S){return g=_s(g),S===void 0?(S=g,g=0):S=_s(S),function(D,H,it){return D>=to(H,it)&&D<xi(H,it)}(c=ys(c),g,S)},q.invoke=Fi,q.isArguments=Eu,q.isArray=rr,q.isArrayBuffer=Hd,q.isArrayLike=Co,q.isArrayLikeObject=Ai,q.isBoolean=function(c){return c===!0||c===!1||wi(c)&&Li(c)==ct},q.isBuffer=ja,q.isDate=Np,q.isElement=function(c){return wi(c)&&c.nodeType===1&&!rl(c)},q.isEmpty=function(c){if(c==null)return!0;if(Co(c)&&(rr(c)||typeof c=="string"||typeof c.splice=="function"||ja(c)||il(c)||Eu(c)))return!c.length;var g=Ze(c);if(g==F||g==X)return!c.size;if(Wl(c))return!mr(c).length;for(var S in c)if(Gr.call(c,S))return!1;return!0},q.isEqual=function(c,g){return Xu(c,g)},q.isEqualWith=function(c,g,S){var D=(S=typeof S=="function"?S:void 0)?S(c,g):void 0;return D===void 0?Xu(c,g,void 0,S):!!D},q.isError=Mu,q.isFinite=function(c){return typeof c=="number"&&Hi(c)},q.isFunction=qs,q.isInteger=Uc,q.isLength=kc,q.isMap=Fp,q.isMatch=function(c,g){return c===g||kl(c,g,Nh(g))},q.isMatchWith=function(c,g,S){return S=typeof S=="function"?S:void 0,kl(c,g,Nh(g),S)},q.isNaN=function(c){return Gc(c)&&c!=+c},q.isNative=function(c){if(Pd(c))throw new pr("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return wd(c)},q.isNil=function(c){return c==null},q.isNull=function(c){return c===null},q.isNumber=Gc,q.isObject=pi,q.isObjectLike=wi,q.isPlainObject=rl,q.isRegExp=Hc,q.isSafeInteger=function(c){return Uc(c)&&c>=-9007199254740991&&c<=9007199254740991},q.isSet=zd,q.isString=Jh,q.isSymbol=Qo,q.isTypedArray=il,q.isUndefined=function(c){return c===void 0},q.isWeakMap=function(c){return wi(c)&&Ze(c)==ue},q.isWeakSet=function(c){return wi(c)&&Li(c)=="[object WeakSet]"},q.join=function(c,g){return c==null?"":Sh.call(c,g)},q.kebabCase=Yd,q.last=Fs,q.lastIndexOf=function(c,g,S){var D=c==null?0:c.length;if(!D)return-1;var H=D;return S!==void 0&&(H=(H=hr(S))<0?xi(D+H,0):to(H,D-1)),g==g?function(it,vt,St){for(var Ft=St+1;Ft--;)if(it[Ft]===vt)return Ft;return Ft}(c,g,H):ks(c,Pa,H,!0)},q.lowerCase=qd,q.lowerFirst=nh,q.lt=jd,q.lte=Bp,q.max=function(c){return c&&c.length?Mh(c,io,Ps):void 0},q.maxBy=function(c,g){return c&&c.length?Mh(c,Nn(g,2),Ps):void 0},q.mean=function(c){return xh(c,io)},q.meanBy=function(c,g){return xh(c,Nn(g,2))},q.min=function(c){return c&&c.length?Mh(c,io,Rs):void 0},q.minBy=function(c,g){return c&&c.length?Mh(c,Nn(g,2),Rs):void 0},q.stubArray=Zc,q.stubFalse=ih,q.stubObject=function(){return{}},q.stubString=function(){return""},q.stubTrue=function(){return!0},q.multiply=ts,q.nth=function(c,g){return c&&c.length?Yu(c,hr(g)):void 0},q.noConflict=function(){return Er._===this&&(Er._=yd),this},q.noop=tc,q.now=Wh,q.pad=function(c,g,S){c=Mr(c);var D=(g=hr(g))?Hu(c):0;if(!g||D>=g)return c;var H=(g-D)/2;return pa(uo(H),S)+c+pa(Wu(H),S)},q.padEnd=function(c,g,S){c=Mr(c);var D=(g=hr(g))?Hu(c):0;return g&&D<g?c+pa(g-D,S):c},q.padStart=function(c,g,S){c=Mr(c);var D=(g=hr(g))?Hu(c):0;return g&&D<g?pa(g-D,S)+c:c},q.parseInt=function(c,g,S){return S||g==null?g=0:g&&(g=+g),xd(Mr(c).replace(Ur,""),g||0)},q.random=function(c,g,S){if(S&&typeof S!="boolean"&&Ao(c,g,S)&&(g=S=void 0),S===void 0&&(typeof g=="boolean"?(S=g,g=void 0):typeof c=="boolean"&&(S=c,c=void 0)),c===void 0&&g===void 0?(c=0,g=1):(c=_s(c),g===void 0?(g=c,c=0):g=_s(g)),c>g){var D=c;c=g,g=D}if(S||c%1||g%1){var H=Ge();return to(c+H*(g-c+vi("1e-"+((H+"").length-1))),g)}return Ec(c,g)},q.reduce=function(c,g,S){var D=rr(c)?tu:ni,H=arguments.length<3;return D(c,Nn(g,4),S,H,ds)},q.reduceRight=function(c,g,S){var D=rr(c)?mc:ni,H=arguments.length<3;return D(c,Nn(g,4),S,H,ps)},q.repeat=function(c,g,S){return g=(S?Ao(c,g,S):g===void 0)?1:hr(g),zi(Mr(c),g)},q.replace=function(){var c=arguments,g=Mr(c[0]);return c.length<3?g:g.replace(c[1],c[2])},q.result=function(c,g,S){var D=-1,H=(g=$o(g,c)).length;for(H||(H=1,c=void 0);++D<H;){var it=c==null?void 0:c[Ho(g[D])];it===void 0&&(D=H,it=S),c=qs(it)?it.call(c):it}return c},q.round=tp,q.runInContext=Bt,q.sample=function(c){return(rr(c)?du:po)(c)},q.size=function(c){if(c==null)return 0;if(Co(c))return Jh(c)?Hu(c):c.length;var g=Ze(c);return g==F||g==X?c.size:mr(c).length},q.snakeCase=Wc,q.some=function(c,g,S){var D=rr(c)?ai:ii;return S&&Ao(c,g,S)&&(g=void 0),D(c,Nn(g,3))},q.sortedIndex=function(c,g){return ha(c,g)},q.sortedIndexBy=function(c,g,S){return yr(c,g,Nn(S,2))},q.sortedIndexOf=function(c,g){var S=c==null?0:c.length;if(S){var D=ha(c,g);if(D<S&&zo(c[D],g))return D}return-1},q.sortedLastIndex=function(c,g){return ha(c,g,!0)},q.sortedLastIndexBy=function(c,g,S){return yr(c,g,Nn(S,2),!0)},q.sortedLastIndexOf=function(c,g){if(c==null?0:c.length){var S=ha(c,g,!0)-1;if(zo(c[S],g))return S}return-1},q.startCase=Iu,q.startsWith=function(c,g,S){return c=Mr(c),S=S==null?0:zs(hr(S),0,c.length),g=Eo(g),c.slice(S,S+g.length)==g},q.subtract=cl,q.sum=function(c){return c&&c.length?Ml(c,io):0},q.sumBy=function(c,g){return c&&c.length?Ml(c,Nn(g,2)):0},q.template=function(c,g,S){var D=q.templateSettings;S&&Ao(c,g,S)&&(g=void 0),c=Mr(c),g=ol({},g,D,jl);var H,it,vt=ol({},g.imports,D.imports,jl),St=oi(vt),Ft=ci(vt,St),ae=0,le=g.interpolate||Zt,Oe="__p += '",mn=Cl((g.escape||Zt).source+"|"+le.source+"|"+(le===bn?$i:Zt).source+"|"+(g.evaluate||Zt).source+"|$","g"),gn="//# sourceURL="+(Gr.call(g,"sourceURL")?(g.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++_r+"]")+`
`;c.replace(mn,function(Xe,Xn,dn,Fn,An,jn){return dn||(dn=Fn),Oe+=c.slice(ae,jn).replace(re,Gu),Xn&&(H=!0,Oe+=`' +
__e(`+Xn+`) +
'`),An&&(it=!0,Oe+=`';
`+An+`;
__p += '`),dn&&(Oe+=`' +
((__t = (`+dn+`)) == null ? '' : __t) +
'`),ae=jn+Xe.length,Xe}),Oe+=`';
`;var Cn=Gr.call(g,"variable")&&g.variable;if(Cn){if(Ln.test(Cn))throw new pr("Invalid `variable` option passed into `_.template`")}else Oe=`with (obj) {
`+Oe+`
}
`;Oe=(it?Oe.replace(Qt,""):Oe).replace(de,"$1").replace(Ke,"$1;"),Oe="function("+(Cn||"obj")+`) {
`+(Cn?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(H?", __e = _.escape":"")+(it?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Oe+`return __p
}`;var Se=Jd(function(){return Gi(St,gn+"return "+Oe).apply(void 0,Ft)});if(Se.source=Oe,Mu(Se))throw Se;return Se},q.times=function(c,g){if((c=hr(c))<1||c>9007199254740991)return[];var S=4294967295,D=to(c,4294967295);c-=4294967295;for(var H=ru(D,g=Nn(g));++S<c;)g(S);return H},q.toFinite=_s,q.toInteger=hr,q.toLength=Vd,q.toLower=function(c){return Mr(c).toLowerCase()},q.toNumber=ys,q.toSafeInteger=function(c){return c?zs(hr(c),-9007199254740991,9007199254740991):c===0?c:0},q.toString=Mr,q.toUpper=function(c){return Mr(c).toUpperCase()},q.trim=function(c,g,S){if((c=Mr(c))&&(S||g===void 0))return gc(c);if(!c||!(g=Eo(g)))return c;var D=Ts(c),H=Ts(g);return bi(D,gd(D,H),Ci(D,H)+1).join("")},q.trimEnd=function(c,g,S){if((c=Mr(c))&&(S||g===void 0))return c.slice(0,wh(c)+1);if(!c||!(g=Eo(g)))return c;var D=Ts(c);return bi(D,0,Ci(D,Ts(g))+1).join("")},q.trimStart=function(c,g,S){if((c=Mr(c))&&(S||g===void 0))return c.replace(Ur,"");if(!c||!(g=Eo(g)))return c;var D=Ts(c);return bi(D,gd(D,Ts(g))).join("")},q.truncate=function(c,g){var S=30,D="...";if(pi(g)){var H="separator"in g?g.separator:H;S="length"in g?hr(g.length):S,D="omission"in g?Eo(g.omission):D}var it=(c=Mr(c)).length;if(ri(c)){var vt=Ts(c);it=vt.length}if(S>=it)return c;var St=S-Hu(D);if(St<1)return D;var Ft=vt?bi(vt,0,St).join(""):c.slice(0,St);if(H===void 0)return Ft+D;if(vt&&(St+=Ft.length-St),Hc(H)){if(c.slice(St).search(H)){var ae,le=Ft;for(H.global||(H=Cl(H.source,Mr(yo.exec(H))+"g")),H.lastIndex=0;ae=H.exec(le);)var Oe=ae.index;Ft=Ft.slice(0,Oe===void 0?St:Oe)}}else if(c.indexOf(Eo(H),St)!=St){var mn=Ft.lastIndexOf(H);mn>-1&&(Ft=Ft.slice(0,mn))}return Ft+D},q.unescape=function(c){return(c=Mr(c))&&Qe.test(c)?c.replace(ke,bo):c},q.uniqueId=function(c){var g=++qo;return Mr(c)+g},q.upperCase=kp,q.upperFirst=Xc,q.each=Bd,q.eachRight=Ud,q.first=Mp,hl(q,($c={},fs(q,function(c,g){Gr.call(q.prototype,g)||($c[g]=c)}),$c),{chain:!1}),q.VERSION="4.17.21",ao(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){q[c].placeholder=q}),ao(["drop","take"],function(c,g){ur.prototype[c]=function(S){S=S===void 0?1:xi(hr(S),0);var D=this.__filtered__&&!g?new ur(this):this.clone();return D.__filtered__?D.__takeCount__=to(S,D.__takeCount__):D.__views__.push({size:to(S,4294967295),type:c+(D.__dir__<0?"Right":"")}),D},ur.prototype[c+"Right"]=function(S){return this.reverse()[c](S).reverse()}}),ao(["filter","map","takeWhile"],function(c,g){var S=g+1,D=S==1||S==3;ur.prototype[c]=function(H){var it=this.clone();return it.__iteratees__.push({iteratee:Nn(H,3),type:S}),it.__filtered__=it.__filtered__||D,it}}),ao(["head","last"],function(c,g){var S="take"+(g?"Right":"");ur.prototype[c]=function(){return this[S](1).value()[0]}}),ao(["initial","tail"],function(c,g){var S="drop"+(g?"":"Right");ur.prototype[c]=function(){return this.__filtered__?new ur(this):this[S](1)}}),ur.prototype.compact=function(){return this.filter(io)},ur.prototype.find=function(c){return this.filter(c).head()},ur.prototype.findLast=function(c){return this.reverse().find(c)},ur.prototype.invokeMap=Qn(function(c,g){return typeof c=="function"?new ur(this):this.map(function(S){return vu(S,c,g)})}),ur.prototype.reject=function(c){return this.filter(Yh(Nn(c)))},ur.prototype.slice=function(c,g){c=hr(c);var S=this;return S.__filtered__&&(c>0||g<0)?new ur(S):(c<0?S=S.takeRight(-c):c&&(S=S.drop(c)),g!==void 0&&(S=(g=hr(g))<0?S.dropRight(-g):S.take(g-c)),S)},ur.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},ur.prototype.toArray=function(){return this.take(4294967295)},fs(ur.prototype,function(c,g){var S=/^(?:filter|find|map|reject)|While$/.test(g),D=/^(?:head|last)$/.test(g),H=q[D?"take"+(g=="last"?"Right":""):g],it=D||/^find/.test(g);H&&(q.prototype[g]=function(){var vt=this.__wrapped__,St=D?[1]:arguments,Ft=vt instanceof ur,ae=St[0],le=Ft||rr(vt),Oe=function(Xn){var dn=H.apply(q,ra([Xn],St));return D&&mn?dn[0]:dn};le&&S&&typeof ae=="function"&&ae.length!=1&&(Ft=le=!1);var mn=this.__chain__,gn=!!this.__actions__.length,Cn=it&&!mn,Se=Ft&&!gn;if(!it&&le){vt=Se?vt:new ur(this);var Xe=c.apply(vt,St);return Xe.__actions__.push({func:Dc,args:[Oe],thisArg:void 0}),new lo(Xe,mn)}return Cn&&Se?c.apply(this,St):(Xe=this.thru(Oe),Cn?D?Xe.value()[0]:Xe.value():Xe)})}),ao(["pop","push","shift","sort","splice","unshift"],function(c){var g=Rl[c],S=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",D=/^(?:pop|shift)$/.test(c);q.prototype[c]=function(){var H=arguments;if(D&&!this.__chain__){var it=this.value();return g.apply(rr(it)?it:[],H)}return this[S](function(vt){return g.apply(rr(vt)?vt:[],H)})}}),fs(ur.prototype,function(c,g){var S=q[g];if(S){var D=S.name+"";Gr.call(cu,D)||(cu[D]=[]),cu[D].push({name:g,func:S})}}),cu[Zu(void 0,2).name]=[{name:"wrapper",func:void 0}],ur.prototype.clone=function(){var c=new ur(this.__wrapped__);return c.__actions__=ji(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=ji(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=ji(this.__views__),c},ur.prototype.reverse=function(){if(this.__filtered__){var c=new ur(this);c.__dir__=-1,c.__filtered__=!0}else(c=this.clone()).__dir__*=-1;return c},ur.prototype.value=function(){var c=this.__wrapped__.value(),g=this.__dir__,S=rr(c),D=g<0,H=S?c.length:0,it=function(jn,Mn,Vn){for(var Vr=-1,_o=Vn.length;++Vr<_o;){var es=Vn[Vr],Bi=es.size;switch(es.type){case"drop":jn+=Bi;break;case"dropRight":Mn-=Bi;break;case"take":Mn=to(Mn,jn+Bi);break;case"takeRight":jn=xi(jn,Mn-Bi)}}return{start:jn,end:Mn}}(0,H,this.__views__),vt=it.start,St=it.end,Ft=St-vt,ae=D?St:vt-1,le=this.__iteratees__,Oe=le.length,mn=0,gn=to(Ft,this.__takeCount__);if(!S||!D&&H==Ft&&gn==Ft)return Pc(c,this.__actions__);var Cn=[];t:for(;Ft--&&mn<gn;){for(var Se=-1,Xe=c[ae+=g];++Se<Oe;){var Xn=le[Se],dn=Xn.iteratee,Fn=Xn.type,An=dn(Xe);if(Fn==2)Xe=An;else if(!An){if(Fn==1)continue t;break t}}Cn[mn++]=Xe}return Cn},q.prototype.at=df,q.prototype.chain=function(){return Ip(this)},q.prototype.commit=function(){return new lo(this.value(),this.__chain__)},q.prototype.next=function(){this.__values__===void 0&&(this.__values__=$l(this.value()));var c=this.__index__>=this.__values__.length;return{done:c,value:c?void 0:this.__values__[this.__index__++]}},q.prototype.plant=function(c){for(var g,S=this;S instanceof Ms;){var D=Su(S);D.__index__=0,D.__values__=void 0,g?H.__wrapped__=D:g=D;var H=D;S=S.__wrapped__}return H.__wrapped__=c,g},q.prototype.reverse=function(){var c=this.__wrapped__;if(c instanceof ur){var g=c;return this.__actions__.length&&(g=new ur(this)),(g=g.reverse()).__actions__.push({func:Dc,args:[Nd],thisArg:void 0}),new lo(g,this.__chain__)}return this.thru(Nd)},q.prototype.toJSON=q.prototype.valueOf=q.prototype.value=function(){return Pc(this.__wrapped__,this.__actions__)},q.prototype.first=q.prototype.head,Ol&&(q.prototype[Ol]=function(){return this}),q}();Er._=di,(lt=function(){return di}.call(C,T,C,G))===void 0||(G.exports=lt)}).call(this)}).call(this,T(4),T(10)(Ie))},function(Ie,C,T){Object.defineProperty(C,"__esModule",{value:!0});var J=function(){function mt(et,nt){for(var ct=0;ct<nt.length;ct++){var Nt=nt[ct];Nt.enumerable=Nt.enumerable||!1,Nt.configurable=!0,"value"in Nt&&(Nt.writable=!0),Object.defineProperty(et,Nt.key,Nt)}}return function(et,nt,ct){return nt&&mt(et.prototype,nt),ct&&mt(et,ct),et}}();function G(mt,et){if(!(mt instanceof et))throw new TypeError("Cannot call a class as a function")}var lt=function(){function mt(et,nt,ct){nt===void 0&&(nt=!1),G(this,mt),this._fn=et,this._once=nt,this._thisArg=ct,this._next=this._prev=this._owner=null}return J(mt,[{key:"detach",value:function(){return this._owner!==null&&(this._owner.detach(this),!0)}}]),mt}();function Z(mt,et){return mt._head?(mt._tail._next=et,et._prev=mt._tail,mt._tail=et):(mt._head=et,mt._tail=et),et._owner=mt,et}var W=function(){function mt(){G(this,mt),this._head=this._tail=void 0}return J(mt,[{key:"handlers",value:function(){var et=!(arguments.length<=0||arguments[0]===void 0)&&arguments[0],nt=this._head;if(et)return!!nt;for(var ct=[];nt;)ct.push(nt),nt=nt._next;return ct}},{key:"has",value:function(et){if(!(et instanceof lt))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return et._owner===this}},{key:"dispatch",value:function(){var et=this._head;if(!et)return!1;for(;et;)et._once&&this.detach(et),et._fn.apply(et._thisArg,arguments),et=et._next;return!0}},{key:"add",value:function(et){var nt=arguments.length<=1||arguments[1]===void 0?null:arguments[1];if(typeof et!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return Z(this,new lt(et,!1,nt))}},{key:"once",value:function(et){var nt=arguments.length<=1||arguments[1]===void 0?null:arguments[1];if(typeof et!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return Z(this,new lt(et,!0,nt))}},{key:"detach",value:function(et){if(!(et instanceof lt))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return et._owner!==this||(et._prev&&(et._prev._next=et._next),et._next&&(et._next._prev=et._prev),et===this._head?(this._head=et._next,et._next===null&&(this._tail=null)):et===this._tail&&(this._tail=et._prev,this._tail._next=null),et._owner=null),this}},{key:"detachAll",value:function(){var et=this._head;if(!et)return this;for(this._head=this._tail=null;et;)et._owner=null,et=et._next;return this}}]),mt}();W.MiniSignalBinding=lt,C.default=W,Ie.exports=C.default},function(Ie,C,T){var J;(function(G){function lt(k,X){var tt=(65535&k)+(65535&X);return(k>>16)+(X>>16)+(tt>>16)<<16|65535&tt}function Z(k,X,tt,ht,ue,je){return lt((te=lt(lt(X,k),lt(ht,je)))<<(xt=ue)|te>>>32-xt,tt);var te,xt}function W(k,X,tt,ht,ue,je,te){return Z(X&tt|~X&ht,k,X,ue,je,te)}function mt(k,X,tt,ht,ue,je,te){return Z(X&ht|tt&~ht,k,X,ue,je,te)}function et(k,X,tt,ht,ue,je,te){return Z(X^tt^ht,k,X,ue,je,te)}function nt(k,X,tt,ht,ue,je,te){return Z(tt^(X|~ht),k,X,ue,je,te)}function ct(k,X){var tt,ht,ue,je,te;k[X>>5]|=128<<X%32,k[14+(X+64>>>9<<4)]=X;var xt=1732584193,zt=-271733879,Vt=-1732584194,$=271733878;for(tt=0;tt<k.length;tt+=16)ht=xt,ue=zt,je=Vt,te=$,xt=W(xt,zt,Vt,$,k[tt],7,-680876936),$=W($,xt,zt,Vt,k[tt+1],12,-389564586),Vt=W(Vt,$,xt,zt,k[tt+2],17,606105819),zt=W(zt,Vt,$,xt,k[tt+3],22,-1044525330),xt=W(xt,zt,Vt,$,k[tt+4],7,-176418897),$=W($,xt,zt,Vt,k[tt+5],12,1200080426),Vt=W(Vt,$,xt,zt,k[tt+6],17,-1473231341),zt=W(zt,Vt,$,xt,k[tt+7],22,-45705983),xt=W(xt,zt,Vt,$,k[tt+8],7,1770035416),$=W($,xt,zt,Vt,k[tt+9],12,-1958414417),Vt=W(Vt,$,xt,zt,k[tt+10],17,-42063),zt=W(zt,Vt,$,xt,k[tt+11],22,-1990404162),xt=W(xt,zt,Vt,$,k[tt+12],7,1804603682),$=W($,xt,zt,Vt,k[tt+13],12,-40341101),Vt=W(Vt,$,xt,zt,k[tt+14],17,-1502002290),xt=mt(xt,zt=W(zt,Vt,$,xt,k[tt+15],22,1236535329),Vt,$,k[tt+1],5,-165796510),$=mt($,xt,zt,Vt,k[tt+6],9,-1069501632),Vt=mt(Vt,$,xt,zt,k[tt+11],14,643717713),zt=mt(zt,Vt,$,xt,k[tt],20,-373897302),xt=mt(xt,zt,Vt,$,k[tt+5],5,-701558691),$=mt($,xt,zt,Vt,k[tt+10],9,38016083),Vt=mt(Vt,$,xt,zt,k[tt+15],14,-660478335),zt=mt(zt,Vt,$,xt,k[tt+4],20,-405537848),xt=mt(xt,zt,Vt,$,k[tt+9],5,568446438),$=mt($,xt,zt,Vt,k[tt+14],9,-1019803690),Vt=mt(Vt,$,xt,zt,k[tt+3],14,-187363961),zt=mt(zt,Vt,$,xt,k[tt+8],20,1163531501),xt=mt(xt,zt,Vt,$,k[tt+13],5,-1444681467),$=mt($,xt,zt,Vt,k[tt+2],9,-51403784),Vt=mt(Vt,$,xt,zt,k[tt+7],14,1735328473),xt=et(xt,zt=mt(zt,Vt,$,xt,k[tt+12],20,-1926607734),Vt,$,k[tt+5],4,-378558),$=et($,xt,zt,Vt,k[tt+8],11,-2022574463),Vt=et(Vt,$,xt,zt,k[tt+11],16,1839030562),zt=et(zt,Vt,$,xt,k[tt+14],23,-35309556),xt=et(xt,zt,Vt,$,k[tt+1],4,-1530992060),$=et($,xt,zt,Vt,k[tt+4],11,1272893353),Vt=et(Vt,$,xt,zt,k[tt+7],16,-155497632),zt=et(zt,Vt,$,xt,k[tt+10],23,-1094730640),xt=et(xt,zt,Vt,$,k[tt+13],4,681279174),$=et($,xt,zt,Vt,k[tt],11,-358537222),Vt=et(Vt,$,xt,zt,k[tt+3],16,-722521979),zt=et(zt,Vt,$,xt,k[tt+6],23,76029189),xt=et(xt,zt,Vt,$,k[tt+9],4,-640364487),$=et($,xt,zt,Vt,k[tt+12],11,-421815835),Vt=et(Vt,$,xt,zt,k[tt+15],16,530742520),xt=nt(xt,zt=et(zt,Vt,$,xt,k[tt+2],23,-995338651),Vt,$,k[tt],6,-198630844),$=nt($,xt,zt,Vt,k[tt+7],10,1126891415),Vt=nt(Vt,$,xt,zt,k[tt+14],15,-1416354905),zt=nt(zt,Vt,$,xt,k[tt+5],21,-57434055),xt=nt(xt,zt,Vt,$,k[tt+12],6,1700485571),$=nt($,xt,zt,Vt,k[tt+3],10,-1894986606),Vt=nt(Vt,$,xt,zt,k[tt+10],15,-1051523),zt=nt(zt,Vt,$,xt,k[tt+1],21,-2054922799),xt=nt(xt,zt,Vt,$,k[tt+8],6,1873313359),$=nt($,xt,zt,Vt,k[tt+15],10,-30611744),Vt=nt(Vt,$,xt,zt,k[tt+6],15,-1560198380),zt=nt(zt,Vt,$,xt,k[tt+13],21,1309151649),xt=nt(xt,zt,Vt,$,k[tt+4],6,-145523070),$=nt($,xt,zt,Vt,k[tt+11],10,-1120210379),Vt=nt(Vt,$,xt,zt,k[tt+2],15,718787259),zt=nt(zt,Vt,$,xt,k[tt+9],21,-343485551),xt=lt(xt,ht),zt=lt(zt,ue),Vt=lt(Vt,je),$=lt($,te);return[xt,zt,Vt,$]}function Nt(k){var X,tt="",ht=32*k.length;for(X=0;X<ht;X+=8)tt+=String.fromCharCode(k[X>>5]>>>X%32&255);return tt}function Xt(k){var X,tt=[];for(tt[(k.length>>2)-1]=void 0,X=0;X<tt.length;X+=1)tt[X]=0;var ht=8*k.length;for(X=0;X<ht;X+=8)tt[X>>5]|=(255&k.charCodeAt(X/8))<<X%32;return tt}function Gt(k){var X,tt,ht="";for(tt=0;tt<k.length;tt+=1)X=k.charCodeAt(tt),ht+="0123456789abcdef".charAt(X>>>4&15)+"0123456789abcdef".charAt(15&X);return ht}function L(k){return unescape(encodeURIComponent(k))}function F(k){return function(X){return Nt(ct(Xt(X),8*X.length))}(L(k))}function z(k,X){return function(tt,ht){var ue,je,te=Xt(tt),xt=[],zt=[];for(xt[15]=zt[15]=void 0,te.length>16&&(te=ct(te,8*tt.length)),ue=0;ue<16;ue+=1)xt[ue]=909522486^te[ue],zt[ue]=1549556828^te[ue];return je=ct(xt.concat(Xt(ht)),512+8*ht.length),Nt(ct(zt.concat(je),640))}(L(k),L(X))}function rt(k,X,tt){return X?tt?z(X,k):Gt(z(X,k)):tt?F(k):Gt(F(k))}(J=function(){return rt}.call(C,T,C,Ie))===void 0||(Ie.exports=J)})()},function(Ie,C){var T;T=function(){return this}();try{T=T||new Function("return this")()}catch{typeof window=="object"&&(T=window)}Ie.exports=T},function(Ie,C,T){T.r(C),T.d(C,"ACESFilmicToneMapping",function(){return so}),T.d(C,"AddEquation",function(){return te}),T.d(C,"AddOperation",function(){return Sr}),T.d(C,"AdditiveAnimationBlendMode",function(){return Pl}),T.d(C,"AdditiveBlending",function(){return tt}),T.d(C,"AlphaFormat",function(){return Rn}),T.d(C,"AlwaysDepth",function(){return qn}),T.d(C,"AlwaysStencilFunc",function(){return Ss}),T.d(C,"AmbientLight",function(){return Df}),T.d(C,"AmbientLightProbe",function(){return um}),T.d(C,"AnimationClip",function(){return lp}),T.d(C,"AnimationLoader",function(){return tm}),T.d(C,"AnimationMixer",function(){return Hf}),T.d(C,"AnimationObjectGroup",function(){return kf}),T.d(C,"AnimationUtils",function(){return Kr}),T.d(C,"ArcCurve",function(){return Mn}),T.d(C,"ArrayCamera",function(){return Mr}),T.d(C,"ArrowHelper",function(){return Pe}),T.d(C,"Audio",function(){return nf}),T.d(C,"AudioAnalyser",function(){return fm}),T.d(C,"AudioContext",function(){return gp}),T.d(C,"AudioListener",function(){return Bf}),T.d(C,"AudioLoader",function(){return dh}),T.d(C,"AxesHelper",function(){return $t}),T.d(C,"AxisHelper",function(){return yg}),T.d(C,"BackSide",function(){return L}),T.d(C,"BasicDepthPacking",function(){return Gi}),T.d(C,"BasicShadowMap",function(){return nt}),T.d(C,"BinaryTextureLoader",function(){return Sg}),T.d(C,"Bone",function(){return io}),T.d(C,"BooleanKeyframeTrack",function(){return uh}),T.d(C,"BoundingBoxHelper",function(){return xg}),T.d(C,"Box2",function(){return fd}),T.d(C,"Box3",function(){return So}),T.d(C,"Box3Helper",function(){return At}),T.d(C,"BoxBufferGeometry",function(){return Xs}),T.d(C,"BoxGeometry",function(){return Xs}),T.d(C,"BoxHelper",function(){return en}),T.d(C,"BufferAttribute",function(){return yr}),T.d(C,"BufferGeometry",function(){return Hn}),T.d(C,"BufferGeometryLoader",function(){return Qp}),T.d(C,"ByteType",function(){return Ma}),T.d(C,"Cache",function(){return rs}),T.d(C,"Camera",function(){return jl}),T.d(C,"CameraHelper",function(){return gt}),T.d(C,"CanvasRenderer",function(){return Mg}),T.d(C,"CanvasTexture",function(){return Ft}),T.d(C,"CatmullRomCurve3",function(){return Js}),T.d(C,"CineonToneMapping",function(){return Ln}),T.d(C,"CircleBufferGeometry",function(){return le}),T.d(C,"CircleGeometry",function(){return le}),T.d(C,"ClampToEdgeWrapping",function(){return re}),T.d(C,"Clock",function(){return hm}),T.d(C,"Color",function(){return pn}),T.d(C,"ColorKeyframeTrack",function(){return up}),T.d(C,"CompressedTexture",function(){return St}),T.d(C,"CompressedTextureLoader",function(){return Rm}),T.d(C,"ConeBufferGeometry",function(){return mn}),T.d(C,"ConeGeometry",function(){return mn}),T.d(C,"CubeCamera",function(){return Ic}),T.d(C,"CubeReflectionMapping",function(){return Q}),T.d(C,"CubeRefractionMapping",function(){return ft}),T.d(C,"CubeTexture",function(){return $u}),T.d(C,"CubeTextureLoader",function(){return em}),T.d(C,"CubeUVReflectionMapping",function(){return Ct}),T.d(C,"CubeUVRefractionMapping",function(){return It}),T.d(C,"CubicBezierCurve",function(){return Xa}),T.d(C,"CubicBezierCurve3",function(){return ga}),T.d(C,"CubicInterpolant",function(){return Ef}),T.d(C,"CullFaceBack",function(){return W}),T.d(C,"CullFaceFront",function(){return mt}),T.d(C,"CullFaceFrontBack",function(){return et}),T.d(C,"CullFaceNone",function(){return Z}),T.d(C,"Curve",function(){return An}),T.d(C,"CurvePath",function(){return qp}),T.d(C,"CustomBlending",function(){return je}),T.d(C,"CustomToneMapping",function(){return $i}),T.d(C,"CylinderBufferGeometry",function(){return Oe}),T.d(C,"CylinderGeometry",function(){return Oe}),T.d(C,"Cylindrical",function(){return sf}),T.d(C,"DataTexture",function(){return Ro}),T.d(C,"DataTexture2DArray",function(){return Ga}),T.d(C,"DataTexture3D",function(){return Ha}),T.d(C,"DataTextureLoader",function(){return Pf}),T.d(C,"DataUtils",function(){return Ve}),T.d(C,"DecrementStencilOp",function(){return su}),T.d(C,"DecrementWrapStencilOp",function(){return Il}),T.d(C,"DefaultLoadingManager",function(){return Af}),T.d(C,"DepthFormat",function(){return ln}),T.d(C,"DepthStencilFormat",function(){return or}),T.d(C,"DepthTexture",function(){return ae}),T.d(C,"DirectionalLight",function(){return Of}),T.d(C,"DirectionalLightHelper",function(){return j}),T.d(C,"DiscreteInterpolant",function(){return ah}),T.d(C,"DodecahedronBufferGeometry",function(){return Cn}),T.d(C,"DodecahedronGeometry",function(){return Cn}),T.d(C,"DoubleSide",function(){return F}),T.d(C,"DstAlphaFactor",function(){return Ke}),T.d(C,"DstColorFactor",function(){return $n}),T.d(C,"DynamicBufferAttribute",function(){return lg}),T.d(C,"DynamicCopyUsage",function(){return Ol}),T.d(C,"DynamicDrawUsage",function(){return au}),T.d(C,"DynamicReadUsage",function(){return Yi}),T.d(C,"EdgesGeometry",function(){return Fn}),T.d(C,"EdgesHelper",function(){return bg}),T.d(C,"EllipseCurve",function(){return jn}),T.d(C,"EqualDepth",function(){return kr}),T.d(C,"EqualStencilFunc",function(){return ju}),T.d(C,"EquirectangularReflectionMapping",function(){return dt}),T.d(C,"EquirectangularRefractionMapping",function(){return Lt}),T.d(C,"Euler",function(){return la}),T.d(C,"EventDispatcher",function(){return Ra}),T.d(C,"ExtrudeBufferGeometry",function(){return Ya}),T.d(C,"ExtrudeGeometry",function(){return Ya}),T.d(C,"FaceColors",function(){return Km}),T.d(C,"FileLoader",function(){return Za}),T.d(C,"FlatShading",function(){return z}),T.d(C,"Float16BufferAttribute",function(){return Pc}),T.d(C,"Float32Attribute",function(){return vg}),T.d(C,"Float32BufferAttribute",function(){return yn}),T.d(C,"Float64Attribute",function(){return _g}),T.d(C,"Float64BufferAttribute",function(){return Ls}),T.d(C,"FloatType",function(){return jt}),T.d(C,"Fog",function(){return Pu}),T.d(C,"FogExp2",function(){return sl}),T.d(C,"Font",function(){return Bu}),T.d(C,"FontLoader",function(){return Io}),T.d(C,"FrontSide",function(){return Gt}),T.d(C,"Frustum",function(){return ka}),T.d(C,"GLBufferAttribute",function(){return of}),T.d(C,"GLSL1",function(){return _c}),T.d(C,"GLSL3",function(){return Ca}),T.d(C,"GammaEncoding",function(){return Bt}),T.d(C,"GreaterDepth",function(){return Jr}),T.d(C,"GreaterEqualDepth",function(){return Ir}),T.d(C,"GreaterEqualStencilFunc",function(){return Dn}),T.d(C,"GreaterStencilFunc",function(){return yd}),T.d(C,"GridHelper",function(){return b}),T.d(C,"Group",function(){return Au}),T.d(C,"HalfFloatType",function(){return Pt}),T.d(C,"HemisphereLight",function(){return cp}),T.d(C,"HemisphereLightHelper",function(){return x}),T.d(C,"HemisphereLightProbe",function(){return Nf}),T.d(C,"IcosahedronBufferGeometry",function(){return Du}),T.d(C,"IcosahedronGeometry",function(){return Du}),T.d(C,"ImageBitmapLoader",function(){return wa}),T.d(C,"ImageLoader",function(){return hd}),T.d(C,"ImageUtils",function(){return as}),T.d(C,"ImmediateRenderObject",function(){return wm}),T.d(C,"IncrementStencilOp",function(){return vc}),T.d(C,"IncrementWrapStencilOp",function(){return zu}),T.d(C,"InstancedBufferAttribute",function(){return cd}),T.d(C,"InstancedBufferGeometry",function(){return lc}),T.d(C,"InstancedInterleavedBuffer",function(){return cc}),T.d(C,"InstancedMesh",function(){return qc}),T.d(C,"Int16Attribute",function(){return pg}),T.d(C,"Int16BufferAttribute",function(){return ca}),T.d(C,"Int32Attribute",function(){return mg}),T.d(C,"Int32BufferAttribute",function(){return Td}),T.d(C,"Int8Attribute",function(){return hg}),T.d(C,"Int8BufferAttribute",function(){return On}),T.d(C,"IntType",function(){return vh}),T.d(C,"InterleavedBuffer",function(){return Cu}),T.d(C,"InterleavedBufferAttribute",function(){return oi}),T.d(C,"Interpolant",function(){return bs}),T.d(C,"InterpolateDiscrete",function(){return Al}),T.d(C,"InterpolateLinear",function(){return Gu}),T.d(C,"InterpolateSmooth",function(){return ri}),T.d(C,"InvertStencilOp",function(){return Gr}),T.d(C,"JSONLoader",function(){return Ag}),T.d(C,"KeepStencilOp",function(){return Qi}),T.d(C,"KeyframeTrack",function(){return qa}),T.d(C,"LOD",function(){return Xc}),T.d(C,"LatheBufferGeometry",function(){return rd}),T.d(C,"LatheGeometry",function(){return rd}),T.d(C,"Layers",function(){return fu}),T.d(C,"LensFlare",function(){return Cg}),T.d(C,"LessDepth",function(){return bn}),T.d(C,"LessEqualDepth",function(){return Nr}),T.d(C,"LessEqualStencilFunc",function(){return _d}),T.d(C,"LessStencilFunc",function(){return bp}),T.d(C,"Light",function(){return xa}),T.d(C,"LightProbe",function(){return vl}),T.d(C,"Line",function(){return Va}),T.d(C,"Line3",function(){return Vf}),T.d(C,"LineBasicMaterial",function(){return oo}),T.d(C,"LineCurve",function(){return dl}),T.d(C,"LineCurve3",function(){return ep}),T.d(C,"LineDashedMaterial",function(){return xr}),T.d(C,"LineLoop",function(){return tp}),T.d(C,"LinePieces",function(){return Jm}),T.d(C,"LineSegments",function(){return ts}),T.d(C,"LineStrip",function(){return Tm}),T.d(C,"LinearEncoding",function(){return bo}),T.d(C,"LinearFilter",function(){return Un}),T.d(C,"LinearInterpolant",function(){return ap}),T.d(C,"LinearMipMapLinearFilter",function(){return Qa}),T.d(C,"LinearMipMapNearestFilter",function(){return Xo}),T.d(C,"LinearMipmapLinearFilter",function(){return gi}),T.d(C,"LinearMipmapNearestFilter",function(){return jr}),T.d(C,"LinearToneMapping",function(){return mi}),T.d(C,"Loader",function(){return jo}),T.d(C,"LoaderUtils",function(){return Kp}),T.d(C,"LoadingManager",function(){return lh}),T.d(C,"LogLuvEncoding",function(){return we}),T.d(C,"LoopOnce",function(){return Ci}),T.d(C,"LoopPingPong",function(){return No}),T.d(C,"LoopRepeat",function(){return vd}),T.d(C,"LuminanceAlphaFormat",function(){return _r}),T.d(C,"LuminanceFormat",function(){return vr}),T.d(C,"MOUSE",function(){return G}),T.d(C,"Material",function(){return zi}),T.d(C,"MaterialLoader",function(){return Re}),T.d(C,"Math",function(){return xd}),T.d(C,"MathUtils",function(){return xd}),T.d(C,"Matrix3",function(){return Ii}),T.d(C,"Matrix4",function(){return wn}),T.d(C,"MaxEquation",function(){return $}),T.d(C,"Mesh",function(){return Ni}),T.d(C,"MeshBasicMaterial",function(){return Oi}),T.d(C,"MeshDepthMaterial",function(){return $l}),T.d(C,"MeshDistanceMaterial",function(){return _s}),T.d(C,"MeshFaceMaterial",function(){return tg}),T.d(C,"MeshLambertMaterial",function(){return Sf}),T.d(C,"MeshMatcapMaterial",function(){return _a}),T.d(C,"MeshNormalMaterial",function(){return Yp}),T.d(C,"MeshPhongMaterial",function(){return Tf}),T.d(C,"MeshPhysicalMaterial",function(){return Xp}),T.d(C,"MeshStandardMaterial",function(){return sp}),T.d(C,"MeshToonMaterial",function(){return ml}),T.d(C,"MinEquation",function(){return Vt}),T.d(C,"MirroredRepeatWrapping",function(){return pe}),T.d(C,"MixOperation",function(){return Xi}),T.d(C,"MultiMaterial",function(){return eg}),T.d(C,"MultiplyBlending",function(){return ue}),T.d(C,"MultiplyOperation",function(){return Ur}),T.d(C,"NearestFilter",function(){return Kt}),T.d(C,"NearestMipMapLinearFilter",function(){return ar}),T.d(C,"NearestMipMapNearestFilter",function(){return ie}),T.d(C,"NearestMipmapLinearFilter",function(){return Pn}),T.d(C,"NearestMipmapNearestFilter",function(){return qe}),T.d(C,"NeverDepth",function(){return kn}),T.d(C,"NeverStencilFunc",function(){return qo}),T.d(C,"NoBlending",function(){return k}),T.d(C,"NoColors",function(){return $m}),T.d(C,"NoToneMapping",function(){return Lr}),T.d(C,"NormalAnimationBlendMode",function(){return ou}),T.d(C,"NormalBlending",function(){return X}),T.d(C,"NotEqualDepth",function(){return Pr}),T.d(C,"NotEqualStencilFunc",function(){return wp}),T.d(C,"NumberKeyframeTrack",function(){return ud}),T.d(C,"Object3D",function(){return mr}),T.d(C,"ObjectLoader",function(){return sm}),T.d(C,"ObjectSpaceNormalMap",function(){return Cl}),T.d(C,"OctahedronBufferGeometry",function(){return oc}),T.d(C,"OctahedronGeometry",function(){return oc}),T.d(C,"OneFactor",function(){return Ht}),T.d(C,"OneMinusDstAlphaFactor",function(){return ke}),T.d(C,"OneMinusDstColorFactor",function(){return Qe}),T.d(C,"OneMinusSrcAlphaFactor",function(){return de}),T.d(C,"OneMinusSrcColorFactor",function(){return kt}),T.d(C,"OrthographicCamera",function(){return mp}),T.d(C,"PCFShadowMap",function(){return ct}),T.d(C,"PCFSoftShadowMap",function(){return Nt}),T.d(C,"PMREMGenerator",function(){return Wr}),T.d(C,"ParametricBufferGeometry",function(){return Ks}),T.d(C,"ParametricGeometry",function(){return Ks}),T.d(C,"Particle",function(){return rg}),T.d(C,"ParticleBasicMaterial",function(){return sg}),T.d(C,"ParticleSystem",function(){return ig}),T.d(C,"ParticleSystemMaterial",function(){return ag}),T.d(C,"Path",function(){return hp}),T.d(C,"PerspectiveCamera",function(){return Zi}),T.d(C,"Plane",function(){return Go}),T.d(C,"PlaneBufferGeometry",function(){return mo}),T.d(C,"PlaneGeometry",function(){return mo}),T.d(C,"PlaneHelper",function(){return oe}),T.d(C,"PointCloud",function(){return ng}),T.d(C,"PointCloudMaterial",function(){return og}),T.d(C,"PointLight",function(){return Lf}),T.d(C,"PointLightHelper",function(){return s}),T.d(C,"Points",function(){return H}),T.d(C,"PointsMaterial",function(){return cl}),T.d(C,"PolarGridHelper",function(){return w}),T.d(C,"PolyhedronBufferGeometry",function(){return gn}),T.d(C,"PolyhedronGeometry",function(){return gn}),T.d(C,"PositionalAudio",function(){return Im}),T.d(C,"PropertyBinding",function(){return Or}),T.d(C,"PropertyMixer",function(){return mm}),T.d(C,"QuadraticBezierCurve",function(){return pl}),T.d(C,"QuadraticBezierCurve3",function(){return rc}),T.d(C,"Quaternion",function(){return eo}),T.d(C,"QuaternionKeyframeTrack",function(){return Nu}),T.d(C,"QuaternionLinearInterpolant",function(){return Mf}),T.d(C,"REVISION",function(){return J}),T.d(C,"RGBADepthPacking",function(){return fr}),T.d(C,"RGBAFormat",function(){return Sn}),T.d(C,"RGBAIntegerFormat",function(){return $r}),T.d(C,"RGBA_ASTC_10x10_Format",function(){return ai}),T.d(C,"RGBA_ASTC_10x5_Format",function(){return ra}),T.d(C,"RGBA_ASTC_10x6_Format",function(){return tu}),T.d(C,"RGBA_ASTC_10x8_Format",function(){return mc}),T.d(C,"RGBA_ASTC_12x10_Format",function(){return eu}),T.d(C,"RGBA_ASTC_12x12_Format",function(){return yi}),T.d(C,"RGBA_ASTC_4x4_Format",function(){return md}),T.d(C,"RGBA_ASTC_5x4_Format",function(){return ao}),T.d(C,"RGBA_ASTC_5x5_Format",function(){return _i}),T.d(C,"RGBA_ASTC_6x5_Format",function(){return Uu}),T.d(C,"RGBA_ASTC_6x6_Format",function(){return na}),T.d(C,"RGBA_ASTC_8x5_Format",function(){return El}),T.d(C,"RGBA_ASTC_8x6_Format",function(){return dr}),T.d(C,"RGBA_ASTC_8x8_Format",function(){return ei}),T.d(C,"RGBA_BPTC_Format",function(){return ks}),T.d(C,"RGBA_ETC2_EAC_Format",function(){return Do}),T.d(C,"RGBA_PVRTC_2BPPV1_Format",function(){return _h}),T.d(C,"RGBA_PVRTC_4BPPV1_Format",function(){return Tl}),T.d(C,"RGBA_S3TC_DXT1_Format",function(){return wl}),T.d(C,"RGBA_S3TC_DXT3_Format",function(){return Ki}),T.d(C,"RGBA_S3TC_DXT5_Format",function(){return si}),T.d(C,"RGBDEncoding",function(){return pr}),T.d(C,"RGBEEncoding",function(){return he}),T.d(C,"RGBEFormat",function(){return on}),T.d(C,"RGBFormat",function(){return _n}),T.d(C,"RGBIntegerFormat",function(){return Er}),T.d(C,"RGBM16Encoding",function(){return Gn}),T.d(C,"RGBM7Encoding",function(){return fe}),T.d(C,"RGB_ETC1_Format",function(){return Sl}),T.d(C,"RGB_ETC2_Format",function(){return yh}),T.d(C,"RGB_PVRTC_2BPPV1_Format",function(){return fc}),T.d(C,"RGB_PVRTC_4BPPV1_Format",function(){return pc}),T.d(C,"RGB_S3TC_DXT1_Format",function(){return is}),T.d(C,"RGFormat",function(){return Fr}),T.d(C,"RGIntegerFormat",function(){return hi}),T.d(C,"RawShaderMaterial",function(){return ad}),T.d(C,"Ray",function(){return cs}),T.d(C,"Raycaster",function(){return _m}),T.d(C,"RectAreaLight",function(){return hh}),T.d(C,"RedFormat",function(){return vi}),T.d(C,"RedIntegerFormat",function(){return Zn}),T.d(C,"ReinhardToneMapping",function(){return ws}),T.d(C,"RepeatWrapping",function(){return Zt}),T.d(C,"ReplaceStencilOp",function(){return Rl}),T.d(C,"ReverseSubtractEquation",function(){return zt}),T.d(C,"RingBufferGeometry",function(){return Qs}),T.d(C,"RingGeometry",function(){return Qs}),T.d(C,"SRGB8_ALPHA8_ASTC_10x10_Format",function(){return ci}),T.d(C,"SRGB8_ALPHA8_ASTC_10x5_Format",function(){return ru}),T.d(C,"SRGB8_ALPHA8_ASTC_10x6_Format",function(){return gc}),T.d(C,"SRGB8_ALPHA8_ASTC_10x8_Format",function(){return xo}),T.d(C,"SRGB8_ALPHA8_ASTC_12x10_Format",function(){return iu}),T.d(C,"SRGB8_ALPHA8_ASTC_12x12_Format",function(){return gd}),T.d(C,"SRGB8_ALPHA8_ASTC_4x4_Format",function(){return os}),T.d(C,"SRGB8_ALPHA8_ASTC_5x4_Format",function(){return nu}),T.d(C,"SRGB8_ALPHA8_ASTC_5x5_Format",function(){return Pa}),T.d(C,"SRGB8_ALPHA8_ASTC_6x5_Format",function(){return xh}),T.d(C,"SRGB8_ALPHA8_ASTC_6x6_Format",function(){return bh}),T.d(C,"SRGB8_ALPHA8_ASTC_8x5_Format",function(){return ku}),T.d(C,"SRGB8_ALPHA8_ASTC_8x6_Format",function(){return ni}),T.d(C,"SRGB8_ALPHA8_ASTC_8x8_Format",function(){return Ml}),T.d(C,"Scene",function(){return Kl}),T.d(C,"SceneUtils",function(){return Pg}),T.d(C,"ShaderChunk",function(){return er}),T.d(C,"ShaderLib",function(){return gs}),T.d(C,"ShaderMaterial",function(){return fo}),T.d(C,"ShadowMaterial",function(){return wf}),T.d(C,"Shape",function(){return gl}),T.d(C,"ShapeBufferGeometry",function(){return sc}),T.d(C,"ShapeGeometry",function(){return sc}),T.d(C,"ShapePath",function(){return _l}),T.d(C,"ShapeUtils",function(){return va}),T.d(C,"ShortType",function(){return ea}),T.d(C,"Skeleton",function(){return hl}),T.d(C,"SkeletonHelper",function(){return r}),T.d(C,"SkinnedMesh",function(){return ll}),T.d(C,"SmoothShading",function(){return rt}),T.d(C,"Sphere",function(){return Jo}),T.d(C,"SphereBufferGeometry",function(){return ac}),T.d(C,"SphereGeometry",function(){return ac}),T.d(C,"Spherical",function(){return jf}),T.d(C,"SphericalHarmonics3",function(){return $p}),T.d(C,"SplineCurve",function(){return fl}),T.d(C,"SpotLight",function(){return Jp}),T.d(C,"SpotLightHelper",function(){return Om}),T.d(C,"Sprite",function(){return nh}),T.d(C,"SpriteMaterial",function(){return vo}),T.d(C,"SrcAlphaFactor",function(){return Qt}),T.d(C,"SrcAlphaSaturateFactor",function(){return Kn}),T.d(C,"SrcColorFactor",function(){return Yt}),T.d(C,"StaticCopyUsage",function(){return Sp}),T.d(C,"StaticDrawUsage",function(){return Ri}),T.d(C,"StaticReadUsage",function(){return Tp}),T.d(C,"StereoCamera",function(){return lm}),T.d(C,"StreamCopyUsage",function(){return Vu}),T.d(C,"StreamDrawUsage",function(){return Ll}),T.d(C,"StreamReadUsage",function(){return Th}),T.d(C,"StringKeyframeTrack",function(){return Fu}),T.d(C,"SubtractEquation",function(){return xt}),T.d(C,"SubtractiveBlending",function(){return ht}),T.d(C,"TOUCH",function(){return lt}),T.d(C,"TangentSpaceNormalMap",function(){return Cr}),T.d(C,"TetrahedronBufferGeometry",function(){return id}),T.d(C,"TetrahedronGeometry",function(){return id}),T.d(C,"TextBufferGeometry",function(){return Wp}),T.d(C,"TextGeometry",function(){return Wp}),T.d(C,"Texture",function(){return ui}),T.d(C,"TextureLoader",function(){return nm}),T.d(C,"TorusBufferGeometry",function(){return od}),T.d(C,"TorusGeometry",function(){return od}),T.d(C,"TorusKnotBufferGeometry",function(){return uc}),T.d(C,"TorusKnotGeometry",function(){return uc}),T.d(C,"Triangle",function(){return Mi}),T.d(C,"TriangleFanDrawMode",function(){return wh}),T.d(C,"TriangleStripDrawMode",function(){return Ts}),T.d(C,"TrianglesDrawMode",function(){return Hu}),T.d(C,"TubeBufferGeometry",function(){return sd}),T.d(C,"TubeGeometry",function(){return sd}),T.d(C,"UVMapping",function(){return yo}),T.d(C,"Uint16Attribute",function(){return fg}),T.d(C,"Uint16BufferAttribute",function(){return Hl}),T.d(C,"Uint32Attribute",function(){return gg}),T.d(C,"Uint32BufferAttribute",function(){return Bo}),T.d(C,"Uint8Attribute",function(){return cg}),T.d(C,"Uint8BufferAttribute",function(){return Ac}),T.d(C,"Uint8ClampedAttribute",function(){return dg}),T.d(C,"Uint8ClampedBufferAttribute",function(){return Eo}),T.d(C,"Uniform",function(){return mh}),T.d(C,"UniformsLib",function(){return Ze}),T.d(C,"UniformsUtils",function(){return Sd}),T.d(C,"UnsignedByteType",function(){return Oo}),T.d(C,"UnsignedInt248Type",function(){return un}),T.d(C,"UnsignedIntType",function(){return Yo}),T.d(C,"UnsignedShort4444Type",function(){return xe}),T.d(C,"UnsignedShort5551Type",function(){return Fe}),T.d(C,"UnsignedShort565Type",function(){return $e}),T.d(C,"UnsignedShortType",function(){return Aa}),T.d(C,"VSMShadowMap",function(){return Xt}),T.d(C,"Vector2",function(){return Ge}),T.d(C,"Vector3",function(){return ot}),T.d(C,"Vector4",function(){return Rr}),T.d(C,"VectorKeyframeTrack",function(){return ld}),T.d(C,"Vertex",function(){return ug}),T.d(C,"VertexColors",function(){return Qm}),T.d(C,"VideoTexture",function(){return vt}),T.d(C,"WebGL1Renderer",function(){return jc}),T.d(C,"WebGLCubeRenderTarget",function(){return Ds}),T.d(C,"WebGLMultipleRenderTargets",function(){return cu}),T.d(C,"WebGLMultisampleRenderTarget",function(){return Dl}),T.d(C,"WebGLRenderTarget",function(){return To}),T.d(C,"WebGLRenderTargetCube",function(){return Eg}),T.d(C,"WebGLRenderer",function(){return Yr}),T.d(C,"WebGLUtils",function(){return zc}),T.d(C,"WireframeGeometry",function(){return bf}),T.d(C,"WireframeHelper",function(){return wg}),T.d(C,"WrapAroundEnding",function(){return ss}),T.d(C,"XHRLoader",function(){return Tg}),T.d(C,"ZeroCurvatureEnding",function(){return ia}),T.d(C,"ZeroFactor",function(){return Dt}),T.d(C,"ZeroSlopeEnding",function(){return oa}),T.d(C,"ZeroStencilOp",function(){return sa}),T.d(C,"sRGBEncoding",function(){return di});/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const J="130",G={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},lt={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Z=0,W=1,mt=2,et=3,nt=0,ct=1,Nt=2,Xt=3,Gt=0,L=1,F=2,z=1,rt=2,k=0,X=1,tt=2,ht=3,ue=4,je=5,te=100,xt=101,zt=102,Vt=103,$=104,Dt=200,Ht=201,Yt=202,kt=203,Qt=204,de=205,Ke=206,ke=207,$n=208,Qe=209,Kn=210,kn=0,qn=1,bn=2,Nr=3,kr=4,Ir=5,Jr=6,Pr=7,Ur=0,Xi=1,Sr=2,Lr=0,mi=1,ws=2,Ln=3,so=4,$i=5,yo=300,Q=301,ft=302,dt=303,Lt=304,Ct=306,It=307,Zt=1e3,re=1001,pe=1002,Kt=1003,qe=1004,ie=1004,Pn=1005,ar=1005,Un=1006,jr=1007,Xo=1007,gi=1008,Qa=1008,Oo=1009,Ma=1010,ea=1011,Aa=1012,vh=1013,Yo=1014,jt=1015,Pt=1016,xe=1017,Fe=1018,$e=1019,un=1020,Rn=1021,_n=1022,Sn=1023,vr=1024,_r=1025,on=Sn,ln=1026,or=1027,vi=1028,Zn=1029,Fr=1030,hi=1031,Er=1032,$r=1033,is=33776,wl=33777,Ki=33778,si=33779,pc=35840,fc=35841,Tl=35842,_h=35843,Sl=36196,yh=37492,Do=37496,md=37808,ao=37809,_i=37810,Uu=37811,na=37812,El=37813,dr=37814,ei=37815,ra=37816,tu=37817,mc=37818,ai=37819,eu=37820,yi=37821,ks=36492,os=37840,nu=37841,Pa=37842,xh=37843,bh=37844,ku=37845,ni=37846,Ml=37847,ru=37848,gc=37849,xo=37850,ci=37851,iu=37852,gd=37853,Ci=2200,vd=2201,No=2202,Al=2300,Gu=2301,ri=2302,ia=2400,oa=2401,ss=2402,ou=2500,Pl=2501,Hu=0,Ts=1,wh=2,bo=3e3,di=3001,Bt=3007,he=3002,we=3003,fe=3004,Gn=3005,pr=3006,Gi=3200,fr=3201,Cr=0,Cl=1,sa=0,Qi=7680,Rl=7681,vc=7682,su=7683,zu=34055,Il=34056,Gr=5386,qo=512,bp=513,ju=514,_d=515,yd=516,wp=517,Dn=518,Ss=519,Ri=35044,au=35048,Ll=35040,Tp=35045,Yi=35049,Th=35041,Sp=35046,Ol=35050,Vu=35042,_c="100",Ca="300 es";class Ra{addEventListener(t,i){this._listeners===void 0&&(this._listeners={});const a=this._listeners;a[t]===void 0&&(a[t]=[]),a[t].indexOf(i)===-1&&a[t].push(i)}hasEventListener(t,i){if(this._listeners===void 0)return!1;const a=this._listeners;return a[t]!==void 0&&a[t].indexOf(i)!==-1}removeEventListener(t,i){if(this._listeners===void 0)return;const a=this._listeners[t];if(a!==void 0){const u=a.indexOf(i);u!==-1&&a.splice(u,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const i=this._listeners[t.type];if(i!==void 0){t.target=this;const a=i.slice(0);for(let u=0,d=a.length;u<d;u++)a[u].call(this,t);t.target=null}}}const qi=[];for(let f=0;f<256;f++)qi[f]=(f<16?"0":"")+f.toString(16);let Wu=1234567;const uo=Math.PI/180,uu=180/Math.PI;function wo(){const f=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,a=4294967295*Math.random()|0;return(qi[255&f]+qi[f>>8&255]+qi[f>>16&255]+qi[f>>24&255]+"-"+qi[255&t]+qi[t>>8&255]+"-"+qi[t>>16&15|64]+qi[t>>24&255]+"-"+qi[63&i|128]+qi[i>>8&255]+"-"+qi[i>>16&255]+qi[i>>24&255]+qi[255&a]+qi[a>>8&255]+qi[a>>16&255]+qi[a>>24&255]).toUpperCase()}function Hi(f,t,i){return Math.max(t,Math.min(i,f))}function Sh(f,t){return(f%t+t)%t}function Ia(f,t,i){return(1-i)*f+i*t}function xi(f){return(f&f-1)==0&&f!==0}function to(f){return Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))}function yc(f){return Math.pow(2,Math.floor(Math.log(f)/Math.LN2))}var xd=Object.freeze({__proto__:null,DEG2RAD:uo,RAD2DEG:uu,generateUUID:wo,clamp:Hi,euclideanModulo:Sh,mapLinear:function(f,t,i,a,u){return a+(f-t)*(u-a)/(i-t)},inverseLerp:function(f,t,i){return f!==t?(i-f)/(t-f):0},lerp:Ia,damp:function(f,t,i,a){return Ia(f,t,1-Math.exp(-i*a))},pingpong:function(f,t=1){return t-Math.abs(Sh(f,2*t)-t)},smoothstep:function(f,t,i){return f<=t?0:f>=i?1:(f=(f-t)/(i-t))*f*(3-2*f)},smootherstep:function(f,t,i){return f<=t?0:f>=i?1:(f=(f-t)/(i-t))*f*f*(f*(6*f-15)+10)},randInt:function(f,t){return f+Math.floor(Math.random()*(t-f+1))},randFloat:function(f,t){return f+Math.random()*(t-f)},randFloatSpread:function(f){return f*(.5-Math.random())},seededRandom:function(f){return f!==void 0&&(Wu=f%2147483647),Wu=16807*Wu%2147483647,(Wu-1)/2147483646},degToRad:function(f){return f*uo},radToDeg:function(f){return f*uu},isPowerOfTwo:xi,ceilPowerOfTwo:to,floorPowerOfTwo:yc,setQuaternionFromProperEuler:function(f,t,i,a,u){const d=Math.cos,p=Math.sin,v=d(i/2),_=p(i/2),y=d((t+a)/2),E=p((t+a)/2),A=d((t-a)/2),M=p((t-a)/2),P=d((a-t)/2),I=p((a-t)/2);switch(u){case"XYX":f.set(v*E,_*A,_*M,v*y);break;case"YZY":f.set(_*M,v*E,_*A,v*y);break;case"ZXZ":f.set(_*A,_*M,v*E,v*y);break;case"XZX":f.set(v*E,_*I,_*P,v*y);break;case"YXY":f.set(_*P,v*E,_*I,v*y);break;case"ZYZ":f.set(_*I,_*P,v*E,v*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+u)}}});class Ge{constructor(t=0,i=0){this.x=t,this.y=i}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,i){return this.x=t,this.y=i,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,i){return i!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this}sub(t,i){return i!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const i=this.x,a=this.y,u=t.elements;return this.x=u[0]*i+u[3]*a+u[6],this.y=u[1]*i+u[4]*a+u[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this}clampLength(t,i){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(t,Math.min(i,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const i=this.x-t.x,a=this.y-t.y;return i*i+a*a}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this}lerpVectors(t,i,a){return this.x=t.x+(i.x-t.x)*a,this.y=t.y+(i.y-t.y)*a,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t}fromBufferAttribute(t,i,a){return a!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this}rotateAround(t,i){const a=Math.cos(i),u=Math.sin(i),d=this.x-t.x,p=this.y-t.y;return this.x=d*a-p*u+t.x,this.y=d*u+p*a+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}Ge.prototype.isVector2=!0;class Ii{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,i,a,u,d,p,v,_,y){const E=this.elements;return E[0]=t,E[1]=u,E[2]=v,E[3]=i,E[4]=d,E[5]=_,E[6]=a,E[7]=p,E[8]=y,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const i=this.elements,a=t.elements;return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],this}extractBasis(t,i,a){return t.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),a.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const i=t.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,i){const a=t.elements,u=i.elements,d=this.elements,p=a[0],v=a[3],_=a[6],y=a[1],E=a[4],A=a[7],M=a[2],P=a[5],I=a[8],N=u[0],O=u[3],V=u[6],Y=u[1],at=u[4],st=u[7],yt=u[2],bt=u[5],_t=u[8];return d[0]=p*N+v*Y+_*yt,d[3]=p*O+v*at+_*bt,d[6]=p*V+v*st+_*_t,d[1]=y*N+E*Y+A*yt,d[4]=y*O+E*at+A*bt,d[7]=y*V+E*st+A*_t,d[2]=M*N+P*Y+I*yt,d[5]=M*O+P*at+I*bt,d[8]=M*V+P*st+I*_t,this}multiplyScalar(t){const i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this}determinant(){const t=this.elements,i=t[0],a=t[1],u=t[2],d=t[3],p=t[4],v=t[5],_=t[6],y=t[7],E=t[8];return i*p*E-i*v*y-a*d*E+a*v*_+u*d*y-u*p*_}invert(){const t=this.elements,i=t[0],a=t[1],u=t[2],d=t[3],p=t[4],v=t[5],_=t[6],y=t[7],E=t[8],A=E*p-v*y,M=v*_-E*d,P=y*d-p*_,I=i*A+a*M+u*P;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const N=1/I;return t[0]=A*N,t[1]=(u*y-E*a)*N,t[2]=(v*a-u*p)*N,t[3]=M*N,t[4]=(E*i-u*_)*N,t[5]=(u*d-v*i)*N,t[6]=P*N,t[7]=(a*_-y*i)*N,t[8]=(p*i-a*d)*N,this}transpose(){let t;const i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this}setUvTransform(t,i,a,u,d,p,v){const _=Math.cos(d),y=Math.sin(d);return this.set(a*_,a*y,-a*(_*p+y*v)+p+t,-u*y,u*_,-u*(-y*p+_*v)+v+i,0,0,1),this}scale(t,i){const a=this.elements;return a[0]*=t,a[3]*=t,a[6]*=t,a[1]*=i,a[4]*=i,a[7]*=i,this}rotate(t){const i=Math.cos(t),a=Math.sin(t),u=this.elements,d=u[0],p=u[3],v=u[6],_=u[1],y=u[4],E=u[7];return u[0]=i*d+a*_,u[3]=i*p+a*y,u[6]=i*v+a*E,u[1]=-a*d+i*_,u[4]=-a*p+i*y,u[7]=-a*v+i*E,this}translate(t,i){const a=this.elements;return a[0]+=t*a[2],a[3]+=t*a[5],a[6]+=t*a[8],a[1]+=i*a[2],a[4]+=i*a[5],a[7]+=i*a[8],this}equals(t){const i=this.elements,a=t.elements;for(let u=0;u<9;u++)if(i[u]!==a[u])return!1;return!0}fromArray(t,i=0){for(let a=0;a<9;a++)this.elements[a]=t[a+i];return this}toArray(t=[],i=0){const a=this.elements;return t[i]=a[0],t[i+1]=a[1],t[i+2]=a[2],t[i+3]=a[3],t[i+4]=a[4],t[i+5]=a[5],t[i+6]=a[6],t[i+7]=a[7],t[i+8]=a[8],t}clone(){return new this.constructor().fromArray(this.elements)}}let lu;Ii.prototype.isMatrix3=!0;class as{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let i;if(t instanceof HTMLCanvasElement)i=t;else{lu===void 0&&(lu=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),lu.width=t.width,lu.height=t.height;const a=lu.getContext("2d");t instanceof ImageData?a.putImageData(t,0,0):a.drawImage(t,0,0,t.width,t.height),i=lu}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}}let Eh=0;class ui extends Ra{constructor(t=ui.DEFAULT_IMAGE,i=ui.DEFAULT_MAPPING,a=re,u=re,d=Un,p=gi,v=Sn,_=Oo,y=1,E=bo){super(),Object.defineProperty(this,"id",{value:Eh++}),this.uuid=wo(),this.name="",this.image=t,this.mipmaps=[],this.mapping=i,this.wrapS=a,this.wrapT=u,this.magFilter=d,this.minFilter=p,this.anisotropy=y,this.format=v,this.internalFormat=null,this.type=_,this.offset=new Ge(0,0),this.repeat=new Ge(1,1),this.center=new Ge(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ii,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=E,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this}toJSON(t){const i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const a={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const u=this.image;if(u.uuid===void 0&&(u.uuid=wo()),!i&&t.images[u.uuid]===void 0){let d;if(Array.isArray(u)){d=[];for(let p=0,v=u.length;p<v;p++)u[p].isDataTexture?d.push(hu(u[p].image)):d.push(hu(u[p]))}else d=hu(u);t.images[u.uuid]={uuid:u.uuid,url:d}}a.image=u.uuid}return i||(t.textures[this.uuid]=a),a}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==yo)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Zt:t.x=t.x-Math.floor(t.x);break;case re:t.x=t.x<0?0:1;break;case pe:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Zt:t.y=t.y-Math.floor(t.y);break;case re:t.y=t.y<0?0:1;break;case pe:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&this.version++}}function hu(f){return typeof HTMLImageElement!="undefined"&&f instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&f instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&f instanceof ImageBitmap?as.getDataURL(f):f.data?{data:Array.prototype.slice.call(f.data),width:f.width,height:f.height,type:f.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}ui.DEFAULT_IMAGE=void 0,ui.DEFAULT_MAPPING=yo,ui.prototype.isTexture=!0;class Rr{constructor(t=0,i=0,a=0,u=1){this.x=t,this.y=i,this.z=a,this.w=u}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,i,a,u){return this.x=t,this.y=i,this.z=a,this.w=u,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t,i){return i!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this.w+=t.w*i,this}sub(t,i){return i!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const i=this.x,a=this.y,u=this.z,d=this.w,p=t.elements;return this.x=p[0]*i+p[4]*a+p[8]*u+p[12]*d,this.y=p[1]*i+p[5]*a+p[9]*u+p[13]*d,this.z=p[2]*i+p[6]*a+p[10]*u+p[14]*d,this.w=p[3]*i+p[7]*a+p[11]*u+p[15]*d,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this}setAxisAngleFromRotationMatrix(t){let i,a,u,d;const p=t.elements,v=p[0],_=p[4],y=p[8],E=p[1],A=p[5],M=p[9],P=p[2],I=p[6],N=p[10];if(Math.abs(_-E)<.01&&Math.abs(y-P)<.01&&Math.abs(M-I)<.01){if(Math.abs(_+E)<.1&&Math.abs(y+P)<.1&&Math.abs(M+I)<.1&&Math.abs(v+A+N-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const V=(v+1)/2,Y=(A+1)/2,at=(N+1)/2,st=(_+E)/4,yt=(y+P)/4,bt=(M+I)/4;return V>Y&&V>at?V<.01?(a=0,u=.707106781,d=.707106781):(a=Math.sqrt(V),u=st/a,d=yt/a):Y>at?Y<.01?(a=.707106781,u=0,d=.707106781):(u=Math.sqrt(Y),a=st/u,d=bt/u):at<.01?(a=.707106781,u=.707106781,d=0):(d=Math.sqrt(at),a=yt/d,u=bt/d),this.set(a,u,d,i),this}let O=Math.sqrt((I-M)*(I-M)+(y-P)*(y-P)+(E-_)*(E-_));return Math.abs(O)<.001&&(O=1),this.x=(I-M)/O,this.y=(y-P)/O,this.z=(E-_)/O,this.w=Math.acos((v+A+N-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this.w=Math.max(t.w,Math.min(i.w,this.w)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this.w=Math.max(t,Math.min(i,this.w)),this}clampLength(t,i){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(t,Math.min(i,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this}lerpVectors(t,i,a){return this.x=t.x+(i.x-t.x)*a,this.y=t.y+(i.y-t.y)*a,this.z=t.z+(i.z-t.z)*a,this.w=t.w+(i.w-t.w)*a,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t}fromBufferAttribute(t,i,a){return a!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this.w=t.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Rr.prototype.isVector4=!0;class To extends Ra{constructor(t,i,a={}){super(),this.width=t,this.height=i,this.depth=1,this.scissor=new Rr(0,0,t,i),this.scissorTest=!1,this.viewport=new Rr(0,0,t,i),this.texture=new ui(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),this.texture.image={width:t,height:i,depth:1},this.texture.generateMipmaps=a.generateMipmaps!==void 0&&a.generateMipmaps,this.texture.minFilter=a.minFilter!==void 0?a.minFilter:Un,this.depthBuffer=a.depthBuffer===void 0||a.depthBuffer,this.stencilBuffer=a.stencilBuffer!==void 0&&a.stencilBuffer,this.depthTexture=a.depthTexture!==void 0?a.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,i,a=1){this.width===t&&this.height===i&&this.depth===a||(this.width=t,this.height=i,this.depth=a,this.texture.image.width=t,this.texture.image.height=i,this.texture.image.depth=a,this.dispose()),this.viewport.set(0,0,t,i),this.scissor.set(0,0,t,i)}clone(){return new this.constructor().copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image=Zm({},this.texture.image),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}To.prototype.isWebGLRenderTarget=!0;class cu extends To{constructor(t,i,a){super(t,i);const u=this.texture;this.texture=[];for(let d=0;d<a;d++)this.texture[d]=u.clone()}setSize(t,i,a=1){if(this.width!==t||this.height!==i||this.depth!==a){this.width=t,this.height=i,this.depth=a;for(let u=0,d=this.texture.length;u<d;u++)this.texture[u].image.width=t,this.texture[u].image.height=i,this.texture[u].image.depth=a;this.dispose()}return this.viewport.set(0,0,t,i),this.scissor.set(0,0,t,i),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let i=0,a=t.texture.length;i<a;i++)this.texture[i]=t.texture[i].clone();return this}}cu.prototype.isWebGLMultipleRenderTargets=!0;class Dl extends To{constructor(t,i,a){super(t,i,a),this.samples=4}copy(t){return super.copy.call(this,t),this.samples=t.samples,this}}Dl.prototype.isWebGLMultisampleRenderTarget=!0;class eo{constructor(t=0,i=0,a=0,u=1){this._x=t,this._y=i,this._z=a,this._w=u}static slerp(t,i,a,u){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),a.slerpQuaternions(t,i,u)}static slerpFlat(t,i,a,u,d,p,v){let _=a[u+0],y=a[u+1],E=a[u+2],A=a[u+3];const M=d[p+0],P=d[p+1],I=d[p+2],N=d[p+3];if(v===0)return t[i+0]=_,t[i+1]=y,t[i+2]=E,void(t[i+3]=A);if(v===1)return t[i+0]=M,t[i+1]=P,t[i+2]=I,void(t[i+3]=N);if(A!==N||_!==M||y!==P||E!==I){let O=1-v;const V=_*M+y*P+E*I+A*N,Y=V>=0?1:-1,at=1-V*V;if(at>Number.EPSILON){const yt=Math.sqrt(at),bt=Math.atan2(yt,V*Y);O=Math.sin(O*bt)/yt,v=Math.sin(v*bt)/yt}const st=v*Y;if(_=_*O+M*st,y=y*O+P*st,E=E*O+I*st,A=A*O+N*st,O===1-v){const yt=1/Math.sqrt(_*_+y*y+E*E+A*A);_*=yt,y*=yt,E*=yt,A*=yt}}t[i]=_,t[i+1]=y,t[i+2]=E,t[i+3]=A}static multiplyQuaternionsFlat(t,i,a,u,d,p){const v=a[u],_=a[u+1],y=a[u+2],E=a[u+3],A=d[p],M=d[p+1],P=d[p+2],I=d[p+3];return t[i]=v*I+E*A+_*P-y*M,t[i+1]=_*I+E*M+y*A-v*P,t[i+2]=y*I+E*P+v*M-_*A,t[i+3]=E*I-v*A-_*M-y*P,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,i,a,u){return this._x=t,this._y=i,this._z=a,this._w=u,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,i){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const a=t._x,u=t._y,d=t._z,p=t._order,v=Math.cos,_=Math.sin,y=v(a/2),E=v(u/2),A=v(d/2),M=_(a/2),P=_(u/2),I=_(d/2);switch(p){case"XYZ":this._x=M*E*A+y*P*I,this._y=y*P*A-M*E*I,this._z=y*E*I+M*P*A,this._w=y*E*A-M*P*I;break;case"YXZ":this._x=M*E*A+y*P*I,this._y=y*P*A-M*E*I,this._z=y*E*I-M*P*A,this._w=y*E*A+M*P*I;break;case"ZXY":this._x=M*E*A-y*P*I,this._y=y*P*A+M*E*I,this._z=y*E*I+M*P*A,this._w=y*E*A-M*P*I;break;case"ZYX":this._x=M*E*A-y*P*I,this._y=y*P*A+M*E*I,this._z=y*E*I-M*P*A,this._w=y*E*A+M*P*I;break;case"YZX":this._x=M*E*A+y*P*I,this._y=y*P*A+M*E*I,this._z=y*E*I-M*P*A,this._w=y*E*A-M*P*I;break;case"XZY":this._x=M*E*A-y*P*I,this._y=y*P*A-M*E*I,this._z=y*E*I+M*P*A,this._w=y*E*A+M*P*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+p)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,i){const a=i/2,u=Math.sin(a);return this._x=t.x*u,this._y=t.y*u,this._z=t.z*u,this._w=Math.cos(a),this._onChangeCallback(),this}setFromRotationMatrix(t){const i=t.elements,a=i[0],u=i[4],d=i[8],p=i[1],v=i[5],_=i[9],y=i[2],E=i[6],A=i[10],M=a+v+A;if(M>0){const P=.5/Math.sqrt(M+1);this._w=.25/P,this._x=(E-_)*P,this._y=(d-y)*P,this._z=(p-u)*P}else if(a>v&&a>A){const P=2*Math.sqrt(1+a-v-A);this._w=(E-_)/P,this._x=.25*P,this._y=(u+p)/P,this._z=(d+y)/P}else if(v>A){const P=2*Math.sqrt(1+v-a-A);this._w=(d-y)/P,this._x=(u+p)/P,this._y=.25*P,this._z=(_+E)/P}else{const P=2*Math.sqrt(1+A-a-v);this._w=(p-u)/P,this._x=(d+y)/P,this._y=(_+E)/P,this._z=.25*P}return this._onChangeCallback(),this}setFromUnitVectors(t,i){let a=t.dot(i)+1;return a<Number.EPSILON?(a=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=a):(this._x=0,this._y=-t.z,this._z=t.y,this._w=a)):(this._x=t.y*i.z-t.z*i.y,this._y=t.z*i.x-t.x*i.z,this._z=t.x*i.y-t.y*i.x,this._w=a),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Hi(this.dot(t),-1,1)))}rotateTowards(t,i){const a=this.angleTo(t);if(a===0)return this;const u=Math.min(1,i/a);return this.slerp(t,u),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,i){return i!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,i){const a=t._x,u=t._y,d=t._z,p=t._w,v=i._x,_=i._y,y=i._z,E=i._w;return this._x=a*E+p*v+u*y-d*_,this._y=u*E+p*_+d*v-a*y,this._z=d*E+p*y+a*_-u*v,this._w=p*E-a*v-u*_-d*y,this._onChangeCallback(),this}slerp(t,i){if(i===0)return this;if(i===1)return this.copy(t);const a=this._x,u=this._y,d=this._z,p=this._w;let v=p*t._w+a*t._x+u*t._y+d*t._z;if(v<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,v=-v):this.copy(t),v>=1)return this._w=p,this._x=a,this._y=u,this._z=d,this;const _=1-v*v;if(_<=Number.EPSILON){const P=1-i;return this._w=P*p+i*this._w,this._x=P*a+i*this._x,this._y=P*u+i*this._y,this._z=P*d+i*this._z,this.normalize(),this._onChangeCallback(),this}const y=Math.sqrt(_),E=Math.atan2(y,v),A=Math.sin((1-i)*E)/y,M=Math.sin(i*E)/y;return this._w=p*A+this._w*M,this._x=a*A+this._x*M,this._y=u*A+this._y*M,this._z=d*A+this._z*M,this._onChangeCallback(),this}slerpQuaternions(t,i,a){this.copy(t).slerp(i,a)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,i=0){return this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t}fromBufferAttribute(t,i){return this._x=t.getX(i),this._y=t.getY(i),this._z=t.getZ(i),this._w=t.getW(i),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}eo.prototype.isQuaternion=!0;class ot{constructor(t=0,i=0,a=0){this.x=t,this.y=i,this.z=a}set(t,i,a){return a===void 0&&(a=this.z),this.x=t,this.y=i,this.z=a,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,i){return i!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this}sub(t,i){return i!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}multiply(t,i){return i!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(bd.setFromEuler(t))}applyAxisAngle(t,i){return this.applyQuaternion(bd.setFromAxisAngle(t,i))}applyMatrix3(t){const i=this.x,a=this.y,u=this.z,d=t.elements;return this.x=d[0]*i+d[3]*a+d[6]*u,this.y=d[1]*i+d[4]*a+d[7]*u,this.z=d[2]*i+d[5]*a+d[8]*u,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const i=this.x,a=this.y,u=this.z,d=t.elements,p=1/(d[3]*i+d[7]*a+d[11]*u+d[15]);return this.x=(d[0]*i+d[4]*a+d[8]*u+d[12])*p,this.y=(d[1]*i+d[5]*a+d[9]*u+d[13])*p,this.z=(d[2]*i+d[6]*a+d[10]*u+d[14])*p,this}applyQuaternion(t){const i=this.x,a=this.y,u=this.z,d=t.x,p=t.y,v=t.z,_=t.w,y=_*i+p*u-v*a,E=_*a+v*i-d*u,A=_*u+d*a-p*i,M=-d*i-p*a-v*u;return this.x=y*_+M*-d+E*-v-A*-p,this.y=E*_+M*-p+A*-d-y*-v,this.z=A*_+M*-v+y*-p-E*-d,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const i=this.x,a=this.y,u=this.z,d=t.elements;return this.x=d[0]*i+d[4]*a+d[8]*u,this.y=d[1]*i+d[5]*a+d[9]*u,this.z=d[2]*i+d[6]*a+d[10]*u,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this}clampLength(t,i){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(t,Math.min(i,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this}lerpVectors(t,i,a){return this.x=t.x+(i.x-t.x)*a,this.y=t.y+(i.y-t.y)*a,this.z=t.z+(i.z-t.z)*a,this}cross(t,i){return i!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i)):this.crossVectors(this,t)}crossVectors(t,i){const a=t.x,u=t.y,d=t.z,p=i.x,v=i.y,_=i.z;return this.x=u*_-d*v,this.y=d*p-a*_,this.z=a*v-u*p,this}projectOnVector(t){const i=t.lengthSq();if(i===0)return this.set(0,0,0);const a=t.dot(this)/i;return this.copy(t).multiplyScalar(a)}projectOnPlane(t){return xc.copy(this).projectOnVector(t),this.sub(xc)}reflect(t){return this.sub(xc.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const i=Math.sqrt(this.lengthSq()*t.lengthSq());if(i===0)return Math.PI/2;const a=this.dot(t)/i;return Math.acos(Hi(a,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const i=this.x-t.x,a=this.y-t.y,u=this.z-t.z;return i*i+a*a+u*u}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,i,a){const u=Math.sin(i)*t;return this.x=u*Math.sin(a),this.y=Math.cos(i)*t,this.z=u*Math.cos(a),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,i,a){return this.x=t*Math.sin(i),this.y=a,this.z=t*Math.cos(i),this}setFromMatrixPosition(t){const i=t.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(t){const i=this.setFromMatrixColumn(t,0).length(),a=this.setFromMatrixColumn(t,1).length(),u=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=a,this.z=u,this}setFromMatrixColumn(t,i){return this.fromArray(t.elements,4*i)}setFromMatrix3Column(t,i){return this.fromArray(t.elements,3*i)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}fromBufferAttribute(t,i,a){return a!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}ot.prototype.isVector3=!0;const xc=new ot,bd=new eo;class So{constructor(t=new ot(1/0,1/0,1/0),i=new ot(-1/0,-1/0,-1/0)){this.min=t,this.max=i}set(t,i){return this.min.copy(t),this.max.copy(i),this}setFromArray(t){let i=1/0,a=1/0,u=1/0,d=-1/0,p=-1/0,v=-1/0;for(let _=0,y=t.length;_<y;_+=3){const E=t[_],A=t[_+1],M=t[_+2];E<i&&(i=E),A<a&&(a=A),M<u&&(u=M),E>d&&(d=E),A>p&&(p=A),M>v&&(v=M)}return this.min.set(i,a,u),this.max.set(d,p,v),this}setFromBufferAttribute(t){let i=1/0,a=1/0,u=1/0,d=-1/0,p=-1/0,v=-1/0;for(let _=0,y=t.count;_<y;_++){const E=t.getX(_),A=t.getY(_),M=t.getZ(_);E<i&&(i=E),A<a&&(a=A),M<u&&(u=M),E>d&&(d=E),A>p&&(p=A),M>v&&(v=M)}return this.min.set(i,a,u),this.max.set(d,p,v),this}setFromPoints(t){this.makeEmpty();for(let i=0,a=t.length;i<a;i++)this.expandByPoint(t[i]);return this}setFromCenterAndSize(t,i){const a=La.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(a),this.max.copy(t).add(a),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const i=t.geometry;i!==void 0&&(i.boundingBox===null&&i.computeBoundingBox(),q.copy(i.boundingBox),q.applyMatrix4(t.matrixWorld),this.union(q));const a=t.children;for(let u=0,d=a.length;u<d;u++)this.expandByObject(a[u]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,i){return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,La),La.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let i,a;return t.normal.x>0?(i=t.normal.x*this.min.x,a=t.normal.x*this.max.x):(i=t.normal.x*this.max.x,a=t.normal.x*this.min.x),t.normal.y>0?(i+=t.normal.y*this.min.y,a+=t.normal.y*this.max.y):(i+=t.normal.y*this.max.y,a+=t.normal.y*this.min.y),t.normal.z>0?(i+=t.normal.z*this.min.z,a+=t.normal.z*this.max.z):(i+=t.normal.z*this.max.z,a+=t.normal.z*this.min.z),i<=-t.constant&&a>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(ls),Gs.subVectors(this.max,ls),Es.subVectors(t.a,ls),Ms.subVectors(t.b,ls),lo.subVectors(t.c,ls),ur.subVectors(Ms,Es),no.subVectors(lo,Ms),Fo.subVectors(Es,lo);let i=[0,-ur.z,ur.y,0,-no.z,no.y,0,-Fo.z,Fo.y,ur.z,0,-ur.x,no.z,0,-no.x,Fo.z,0,-Fo.x,-ur.y,ur.x,0,-no.y,no.x,0,-Fo.y,Fo.x,0];return!!du(i,Es,Ms,lo,Gs)&&(i=[1,0,0,0,1,0,0,0,1],!!du(i,Es,Ms,lo,Gs)&&(Zo.crossVectors(ur,no),i=[Zo.x,Zo.y,Zo.z],du(i,Es,Ms,lo,Gs)))}clampPoint(t,i){return i.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return La.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(La).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(us[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),us[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),us[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),us[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),us[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),us[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),us[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),us[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(us)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}So.prototype.isBox3=!0;const us=[new ot,new ot,new ot,new ot,new ot,new ot,new ot,new ot],La=new ot,q=new So,Es=new ot,Ms=new ot,lo=new ot,ur=new ot,no=new ot,Fo=new ot,ls=new ot,Gs=new ot,Zo=new ot,Hs=new ot;function du(f,t,i,a,u){for(let d=0,p=f.length-3;d<=p;d+=3){Hs.fromArray(f,d);const v=u.x*Math.abs(Hs.x)+u.y*Math.abs(Hs.y)+u.z*Math.abs(Hs.z),_=t.dot(Hs),y=i.dot(Hs),E=a.dot(Hs);if(Math.max(-Math.max(_,y,E),Math.min(_,y,E))>v)return!1}return!0}const Oa=new So,Da=new ot,ro=new ot,pu=new ot;class Jo{constructor(t=new ot,i=-1){this.center=t,this.radius=i}set(t,i){return this.center.copy(t),this.radius=i,this}setFromPoints(t,i){const a=this.center;i!==void 0?a.copy(i):Oa.setFromPoints(t).getCenter(a);let u=0;for(let d=0,p=t.length;d<p;d++)u=Math.max(u,a.distanceToSquared(t[d]));return this.radius=Math.sqrt(u),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const i=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=i*i}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,i){const a=this.center.distanceToSquared(t);return i.copy(t),a>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){pu.subVectors(t,this.center);const i=pu.lengthSq();if(i>this.radius*this.radius){const a=Math.sqrt(i),u=.5*(a-this.radius);this.center.add(pu.multiplyScalar(u/a)),this.radius+=u}return this}union(t){return ro.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(Da.copy(t.center).add(ro)),this.expandByPoint(Da.copy(t.center).sub(ro)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const aa=new ot,Nl=new ot,hs=new ot,As=new ot,zs=new ot,ho=new ot,ua=new ot;class cs{constructor(t=new ot,i=new ot(0,0,-1)){this.origin=t,this.direction=i}set(t,i){return this.origin.copy(t),this.direction.copy(i),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,i){return i.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,aa)),this}closestPointToPoint(t,i){i.subVectors(t,this.origin);const a=i.dot(this.direction);return a<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(a).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const i=aa.subVectors(t,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(t):(aa.copy(this.direction).multiplyScalar(i).add(this.origin),aa.distanceToSquared(t))}distanceSqToSegment(t,i,a,u){Nl.copy(t).add(i).multiplyScalar(.5),hs.copy(i).sub(t).normalize(),As.copy(this.origin).sub(Nl);const d=.5*t.distanceTo(i),p=-this.direction.dot(hs),v=As.dot(this.direction),_=-As.dot(hs),y=As.lengthSq(),E=Math.abs(1-p*p);let A,M,P,I;if(E>0)if(A=p*_-v,M=p*v-_,I=d*E,A>=0)if(M>=-I)if(M<=I){const N=1/E;A*=N,M*=N,P=A*(A+p*M+2*v)+M*(p*A+M+2*_)+y}else M=d,A=Math.max(0,-(p*M+v)),P=-A*A+M*(M+2*_)+y;else M=-d,A=Math.max(0,-(p*M+v)),P=-A*A+M*(M+2*_)+y;else M<=-I?(A=Math.max(0,-(-p*d+v)),M=A>0?-d:Math.min(Math.max(-d,-_),d),P=-A*A+M*(M+2*_)+y):M<=I?(A=0,M=Math.min(Math.max(-d,-_),d),P=M*(M+2*_)+y):(A=Math.max(0,-(p*d+v)),M=A>0?d:Math.min(Math.max(-d,-_),d),P=-A*A+M*(M+2*_)+y);else M=p>0?-d:d,A=Math.max(0,-(p*M+v)),P=-A*A+M*(M+2*_)+y;return a&&a.copy(this.direction).multiplyScalar(A).add(this.origin),u&&u.copy(hs).multiplyScalar(M).add(Nl),P}intersectSphere(t,i){aa.subVectors(t.center,this.origin);const a=aa.dot(this.direction),u=aa.dot(aa)-a*a,d=t.radius*t.radius;if(u>d)return null;const p=Math.sqrt(d-u),v=a-p,_=a+p;return v<0&&_<0?null:v<0?this.at(_,i):this.at(v,i)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const i=t.normal.dot(this.direction);if(i===0)return t.distanceToPoint(this.origin)===0?0:null;const a=-(this.origin.dot(t.normal)+t.constant)/i;return a>=0?a:null}intersectPlane(t,i){const a=this.distanceToPlane(t);return a===null?null:this.at(a,i)}intersectsPlane(t){const i=t.distanceToPoint(this.origin);return i===0?!0:t.normal.dot(this.direction)*i<0}intersectBox(t,i){let a,u,d,p,v,_;const y=1/this.direction.x,E=1/this.direction.y,A=1/this.direction.z,M=this.origin;return y>=0?(a=(t.min.x-M.x)*y,u=(t.max.x-M.x)*y):(a=(t.max.x-M.x)*y,u=(t.min.x-M.x)*y),E>=0?(d=(t.min.y-M.y)*E,p=(t.max.y-M.y)*E):(d=(t.max.y-M.y)*E,p=(t.min.y-M.y)*E),a>p||d>u?null:((d>a||a!=a)&&(a=d),(p<u||u!=u)&&(u=p),A>=0?(v=(t.min.z-M.z)*A,_=(t.max.z-M.z)*A):(v=(t.max.z-M.z)*A,_=(t.min.z-M.z)*A),a>_||v>u?null:((v>a||a!=a)&&(a=v),(_<u||u!=u)&&(u=_),u<0?null:this.at(a>=0?a:u,i)))}intersectsBox(t){return this.intersectBox(t,aa)!==null}intersectTriangle(t,i,a,u,d){zs.subVectors(i,t),ho.subVectors(a,t),ua.crossVectors(zs,ho);let p,v=this.direction.dot(ua);if(v>0){if(u)return null;p=1}else{if(!(v<0))return null;p=-1,v=-v}As.subVectors(this.origin,t);const _=p*this.direction.dot(ho.crossVectors(As,ho));if(_<0)return null;const y=p*this.direction.dot(zs.cross(As));if(y<0||_+y>v)return null;const E=-p*As.dot(ua);return E<0?null:this.at(E/v,d)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class wn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,i,a,u,d,p,v,_,y,E,A,M,P,I,N,O){const V=this.elements;return V[0]=t,V[4]=i,V[8]=a,V[12]=u,V[1]=d,V[5]=p,V[9]=v,V[13]=_,V[2]=y,V[6]=E,V[10]=A,V[14]=M,V[3]=P,V[7]=I,V[11]=N,V[15]=O,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new wn().fromArray(this.elements)}copy(t){const i=this.elements,a=t.elements;return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],i[9]=a[9],i[10]=a[10],i[11]=a[11],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15],this}copyPosition(t){const i=this.elements,a=t.elements;return i[12]=a[12],i[13]=a[13],i[14]=a[14],this}setFromMatrix3(t){const i=t.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(t,i,a){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),a.setFromMatrixColumn(this,2),this}makeBasis(t,i,a){return this.set(t.x,i.x,a.x,0,t.y,i.y,a.y,0,t.z,i.z,a.z,0,0,0,0,1),this}extractRotation(t){const i=this.elements,a=t.elements,u=1/ds.setFromMatrixColumn(t,0).length(),d=1/ds.setFromMatrixColumn(t,1).length(),p=1/ds.setFromMatrixColumn(t,2).length();return i[0]=a[0]*u,i[1]=a[1]*u,i[2]=a[2]*u,i[3]=0,i[4]=a[4]*d,i[5]=a[5]*d,i[6]=a[6]*d,i[7]=0,i[8]=a[8]*p,i[9]=a[9]*p,i[10]=a[10]*p,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const i=this.elements,a=t.x,u=t.y,d=t.z,p=Math.cos(a),v=Math.sin(a),_=Math.cos(u),y=Math.sin(u),E=Math.cos(d),A=Math.sin(d);if(t.order==="XYZ"){const M=p*E,P=p*A,I=v*E,N=v*A;i[0]=_*E,i[4]=-_*A,i[8]=y,i[1]=P+I*y,i[5]=M-N*y,i[9]=-v*_,i[2]=N-M*y,i[6]=I+P*y,i[10]=p*_}else if(t.order==="YXZ"){const M=_*E,P=_*A,I=y*E,N=y*A;i[0]=M+N*v,i[4]=I*v-P,i[8]=p*y,i[1]=p*A,i[5]=p*E,i[9]=-v,i[2]=P*v-I,i[6]=N+M*v,i[10]=p*_}else if(t.order==="ZXY"){const M=_*E,P=_*A,I=y*E,N=y*A;i[0]=M-N*v,i[4]=-p*A,i[8]=I+P*v,i[1]=P+I*v,i[5]=p*E,i[9]=N-M*v,i[2]=-p*y,i[6]=v,i[10]=p*_}else if(t.order==="ZYX"){const M=p*E,P=p*A,I=v*E,N=v*A;i[0]=_*E,i[4]=I*y-P,i[8]=M*y+N,i[1]=_*A,i[5]=N*y+M,i[9]=P*y-I,i[2]=-y,i[6]=v*_,i[10]=p*_}else if(t.order==="YZX"){const M=p*_,P=p*y,I=v*_,N=v*y;i[0]=_*E,i[4]=N-M*A,i[8]=I*A+P,i[1]=A,i[5]=p*E,i[9]=-v*E,i[2]=-y*E,i[6]=P*A+I,i[10]=M-N*A}else if(t.order==="XZY"){const M=p*_,P=p*y,I=v*_,N=v*y;i[0]=_*E,i[4]=-A,i[8]=y*E,i[1]=M*A+N,i[5]=p*E,i[9]=P*A-I,i[2]=I*A-P,i[6]=v*E,i[10]=N*A+M}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(t){return this.compose(lf,t,Mh)}lookAt(t,i,a){const u=this.elements;return co.subVectors(t,i),co.lengthSq()===0&&(co.z=1),co.normalize(),js.crossVectors(a,co),js.lengthSq()===0&&(Math.abs(a.z)===1?co.x+=1e-4:co.z+=1e-4,co.normalize(),js.crossVectors(a,co)),js.normalize(),Ei.crossVectors(co,js),u[0]=js.x,u[4]=Ei.x,u[8]=co.x,u[1]=js.y,u[5]=Ei.y,u[9]=co.y,u[2]=js.z,u[6]=Ei.z,u[10]=co.z,this}multiply(t,i){return i!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,i)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,i){const a=t.elements,u=i.elements,d=this.elements,p=a[0],v=a[4],_=a[8],y=a[12],E=a[1],A=a[5],M=a[9],P=a[13],I=a[2],N=a[6],O=a[10],V=a[14],Y=a[3],at=a[7],st=a[11],yt=a[15],bt=u[0],_t=u[4],Et=u[8],Ce=u[12],ge=u[1],ve=u[5],ce=u[9],Ot=u[13],ee=u[2],We=u[6],ze=u[10],Ue=u[14],fn=u[3],vn=u[7],En=u[11],Tn=u[15];return d[0]=p*bt+v*ge+_*ee+y*fn,d[4]=p*_t+v*ve+_*We+y*vn,d[8]=p*Et+v*ce+_*ze+y*En,d[12]=p*Ce+v*Ot+_*Ue+y*Tn,d[1]=E*bt+A*ge+M*ee+P*fn,d[5]=E*_t+A*ve+M*We+P*vn,d[9]=E*Et+A*ce+M*ze+P*En,d[13]=E*Ce+A*Ot+M*Ue+P*Tn,d[2]=I*bt+N*ge+O*ee+V*fn,d[6]=I*_t+N*ve+O*We+V*vn,d[10]=I*Et+N*ce+O*ze+V*En,d[14]=I*Ce+N*Ot+O*Ue+V*Tn,d[3]=Y*bt+at*ge+st*ee+yt*fn,d[7]=Y*_t+at*ve+st*We+yt*vn,d[11]=Y*Et+at*ce+st*ze+yt*En,d[15]=Y*Ce+at*Ot+st*Ue+yt*Tn,this}multiplyScalar(t){const i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this}determinant(){const t=this.elements,i=t[0],a=t[4],u=t[8],d=t[12],p=t[1],v=t[5],_=t[9],y=t[13],E=t[2],A=t[6],M=t[10],P=t[14];return t[3]*(+d*_*A-u*y*A-d*v*M+a*y*M+u*v*P-a*_*P)+t[7]*(+i*_*P-i*y*M+d*p*M-u*p*P+u*y*E-d*_*E)+t[11]*(+i*y*A-i*v*P-d*p*A+a*p*P+d*v*E-a*y*E)+t[15]*(-u*v*E-i*_*A+i*v*M+u*p*A-a*p*M+a*_*E)}transpose(){const t=this.elements;let i;return i=t[1],t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i,this}setPosition(t,i,a){const u=this.elements;return t.isVector3?(u[12]=t.x,u[13]=t.y,u[14]=t.z):(u[12]=t,u[13]=i,u[14]=a),this}invert(){const t=this.elements,i=t[0],a=t[1],u=t[2],d=t[3],p=t[4],v=t[5],_=t[6],y=t[7],E=t[8],A=t[9],M=t[10],P=t[11],I=t[12],N=t[13],O=t[14],V=t[15],Y=A*O*y-N*M*y+N*_*P-v*O*P-A*_*V+v*M*V,at=I*M*y-E*O*y-I*_*P+p*O*P+E*_*V-p*M*V,st=E*N*y-I*A*y+I*v*P-p*N*P-E*v*V+p*A*V,yt=I*A*_-E*N*_-I*v*M+p*N*M+E*v*O-p*A*O,bt=i*Y+a*at+u*st+d*yt;if(bt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const _t=1/bt;return t[0]=Y*_t,t[1]=(N*M*d-A*O*d-N*u*P+a*O*P+A*u*V-a*M*V)*_t,t[2]=(v*O*d-N*_*d+N*u*y-a*O*y-v*u*V+a*_*V)*_t,t[3]=(A*_*d-v*M*d-A*u*y+a*M*y+v*u*P-a*_*P)*_t,t[4]=at*_t,t[5]=(E*O*d-I*M*d+I*u*P-i*O*P-E*u*V+i*M*V)*_t,t[6]=(I*_*d-p*O*d-I*u*y+i*O*y+p*u*V-i*_*V)*_t,t[7]=(p*M*d-E*_*d+E*u*y-i*M*y-p*u*P+i*_*P)*_t,t[8]=st*_t,t[9]=(I*A*d-E*N*d-I*a*P+i*N*P+E*a*V-i*A*V)*_t,t[10]=(p*N*d-I*v*d+I*a*y-i*N*y-p*a*V+i*v*V)*_t,t[11]=(E*v*d-p*A*d-E*a*y+i*A*y+p*a*P-i*v*P)*_t,t[12]=yt*_t,t[13]=(E*N*u-I*A*u+I*a*M-i*N*M-E*a*O+i*A*O)*_t,t[14]=(I*v*u-p*N*u-I*a*_+i*N*_+p*a*O-i*v*O)*_t,t[15]=(p*A*u-E*v*u+E*a*_-i*A*_-p*a*M+i*v*M)*_t,this}scale(t){const i=this.elements,a=t.x,u=t.y,d=t.z;return i[0]*=a,i[4]*=u,i[8]*=d,i[1]*=a,i[5]*=u,i[9]*=d,i[2]*=a,i[6]*=u,i[10]*=d,i[3]*=a,i[7]*=u,i[11]*=d,this}getMaxScaleOnAxis(){const t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],a=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],u=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,a,u))}makeTranslation(t,i,a){return this.set(1,0,0,t,0,1,0,i,0,0,1,a,0,0,0,1),this}makeRotationX(t){const i=Math.cos(t),a=Math.sin(t);return this.set(1,0,0,0,0,i,-a,0,0,a,i,0,0,0,0,1),this}makeRotationY(t){const i=Math.cos(t),a=Math.sin(t);return this.set(i,0,a,0,0,1,0,0,-a,0,i,0,0,0,0,1),this}makeRotationZ(t){const i=Math.cos(t),a=Math.sin(t);return this.set(i,-a,0,0,a,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,i){const a=Math.cos(i),u=Math.sin(i),d=1-a,p=t.x,v=t.y,_=t.z,y=d*p,E=d*v;return this.set(y*p+a,y*v-u*_,y*_+u*v,0,y*v+u*_,E*v+a,E*_-u*p,0,y*_-u*v,E*_+u*p,d*_*_+a,0,0,0,0,1),this}makeScale(t,i,a){return this.set(t,0,0,0,0,i,0,0,0,0,a,0,0,0,0,1),this}makeShear(t,i,a,u,d,p){return this.set(1,a,d,0,t,1,p,0,i,u,1,0,0,0,0,1),this}compose(t,i,a){const u=this.elements,d=i._x,p=i._y,v=i._z,_=i._w,y=d+d,E=p+p,A=v+v,M=d*y,P=d*E,I=d*A,N=p*E,O=p*A,V=v*A,Y=_*y,at=_*E,st=_*A,yt=a.x,bt=a.y,_t=a.z;return u[0]=(1-(N+V))*yt,u[1]=(P+st)*yt,u[2]=(I-at)*yt,u[3]=0,u[4]=(P-st)*bt,u[5]=(1-(M+V))*bt,u[6]=(O+Y)*bt,u[7]=0,u[8]=(I+at)*_t,u[9]=(O-Y)*_t,u[10]=(1-(M+N))*_t,u[11]=0,u[12]=t.x,u[13]=t.y,u[14]=t.z,u[15]=1,this}decompose(t,i,a){const u=this.elements;let d=ds.set(u[0],u[1],u[2]).length();const p=ds.set(u[4],u[5],u[6]).length(),v=ds.set(u[8],u[9],u[10]).length();this.determinant()<0&&(d=-d),t.x=u[12],t.y=u[13],t.z=u[14],ps.copy(this);const _=1/d,y=1/p,E=1/v;return ps.elements[0]*=_,ps.elements[1]*=_,ps.elements[2]*=_,ps.elements[4]*=y,ps.elements[5]*=y,ps.elements[6]*=y,ps.elements[8]*=E,ps.elements[9]*=E,ps.elements[10]*=E,i.setFromRotationMatrix(ps),a.x=d,a.y=p,a.z=v,this}makePerspective(t,i,a,u,d,p){p===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const v=this.elements,_=2*d/(i-t),y=2*d/(a-u),E=(i+t)/(i-t),A=(a+u)/(a-u),M=-(p+d)/(p-d),P=-2*p*d/(p-d);return v[0]=_,v[4]=0,v[8]=E,v[12]=0,v[1]=0,v[5]=y,v[9]=A,v[13]=0,v[2]=0,v[6]=0,v[10]=M,v[14]=P,v[3]=0,v[7]=0,v[11]=-1,v[15]=0,this}makeOrthographic(t,i,a,u,d,p){const v=this.elements,_=1/(i-t),y=1/(a-u),E=1/(p-d),A=(i+t)*_,M=(a+u)*y,P=(p+d)*E;return v[0]=2*_,v[4]=0,v[8]=0,v[12]=-A,v[1]=0,v[5]=2*y,v[9]=0,v[13]=-M,v[2]=0,v[6]=0,v[10]=-2*E,v[14]=-P,v[3]=0,v[7]=0,v[11]=0,v[15]=1,this}equals(t){const i=this.elements,a=t.elements;for(let u=0;u<16;u++)if(i[u]!==a[u])return!1;return!0}fromArray(t,i=0){for(let a=0;a<16;a++)this.elements[a]=t[a+i];return this}toArray(t=[],i=0){const a=this.elements;return t[i]=a[0],t[i+1]=a[1],t[i+2]=a[2],t[i+3]=a[3],t[i+4]=a[4],t[i+5]=a[5],t[i+6]=a[6],t[i+7]=a[7],t[i+8]=a[8],t[i+9]=a[9],t[i+10]=a[10],t[i+11]=a[11],t[i+12]=a[12],t[i+13]=a[13],t[i+14]=a[14],t[i+15]=a[15],t}}wn.prototype.isMatrix4=!0;const ds=new ot,ps=new wn,lf=new ot(0,0,0),Mh=new ot(1,1,1),js=new ot,Ei=new ot,co=new ot,Fl=new wn,fs=new eo;class la{constructor(t=0,i=0,a=0,u=la.DefaultOrder){this._x=t,this._y=i,this._z=a,this._order=u}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,a,u=this._order){return this._x=t,this._y=i,this._z=a,this._order=u,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,a=!0){const u=t.elements,d=u[0],p=u[4],v=u[8],_=u[1],y=u[5],E=u[9],A=u[2],M=u[6],P=u[10];switch(i){case"XYZ":this._y=Math.asin(Hi(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(-E,P),this._z=Math.atan2(-p,d)):(this._x=Math.atan2(M,y),this._z=0);break;case"YXZ":this._x=Math.asin(-Hi(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(v,P),this._z=Math.atan2(_,y)):(this._y=Math.atan2(-A,d),this._z=0);break;case"ZXY":this._x=Math.asin(Hi(M,-1,1)),Math.abs(M)<.9999999?(this._y=Math.atan2(-A,P),this._z=Math.atan2(-p,y)):(this._y=0,this._z=Math.atan2(_,d));break;case"ZYX":this._y=Math.asin(-Hi(A,-1,1)),Math.abs(A)<.9999999?(this._x=Math.atan2(M,P),this._z=Math.atan2(_,d)):(this._x=0,this._z=Math.atan2(-p,y));break;case"YZX":this._z=Math.asin(Hi(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(-E,y),this._y=Math.atan2(-A,d)):(this._x=0,this._y=Math.atan2(v,P));break;case"XZY":this._z=Math.asin(-Hi(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(M,y),this._y=Math.atan2(v,d)):(this._x=Math.atan2(-E,P),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,a===!0&&this._onChangeCallback(),this}setFromQuaternion(t,i,a){return Fl.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Fl,i,a)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return fs.setFromEuler(this),this.setFromQuaternion(fs,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new ot(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}la.prototype.isEuler=!0,la.DefaultOrder="XYZ",la.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class fu{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!=0}}let mu=0;const Vs=new ot,Li=new eo,Ps=new wn,Bl=new ot,gu=new ot,Ul=new ot,vu=new eo,bc=new ot(1,0,0),Xu=new ot(0,1,0),kl=new ot(0,0,1),wd={type:"added"},wc={type:"removed"};class mr extends Ra{constructor(){super(),Object.defineProperty(this,"id",{value:mu++}),this.uuid=wo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=mr.DefaultUp.clone();const t=new ot,i=new la,a=new eo,u=new ot(1,1,1);i._onChange(function(){a.setFromEuler(i,!1)}),a._onChange(function(){i.setFromQuaternion(a,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:u},modelViewMatrix:{value:new wn},normalMatrix:{value:new Ii}}),this.matrix=new wn,this.matrixWorld=new wn,this.matrixAutoUpdate=mr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new fu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Li.setFromAxisAngle(t,i),this.quaternion.multiply(Li),this}rotateOnWorldAxis(t,i){return Li.setFromAxisAngle(t,i),this.quaternion.premultiply(Li),this}rotateX(t){return this.rotateOnAxis(bc,t)}rotateY(t){return this.rotateOnAxis(Xu,t)}rotateZ(t){return this.rotateOnAxis(kl,t)}translateOnAxis(t,i){return Vs.copy(t).applyQuaternion(this.quaternion),this.position.add(Vs.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(bc,t)}translateY(t){return this.translateOnAxis(Xu,t)}translateZ(t){return this.translateOnAxis(kl,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Ps.copy(this.matrixWorld).invert())}lookAt(t,i,a){t.isVector3?Bl.copy(t):Bl.set(t,i,a);const u=this.parent;this.updateWorldMatrix(!0,!1),gu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ps.lookAt(gu,Bl,this.up):Ps.lookAt(Bl,gu,this.up),this.quaternion.setFromRotationMatrix(Ps),u&&(Ps.extractRotation(u.matrixWorld),Li.setFromRotationMatrix(Ps),this.quaternion.premultiply(Li.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(wd)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}const i=this.children.indexOf(t);return i!==-1&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(wc)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(wc)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Ps.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Ps.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ps),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let a=0,u=this.children.length;a<u;a++){const d=this.children[a].getObjectByProperty(t,i);if(d!==void 0)return d}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gu,t,Ul),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gu,vu,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let a=0,u=i.length;a<u;a++)i[a].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const i=this.children;for(let a=0,u=i.length;a<u;a++)i[a].traverseVisible(t)}traverseAncestors(t){const i=this.parent;i!==null&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let a=0,u=i.length;a<u;a++)i[a].updateMatrixWorld(t)}updateWorldMatrix(t,i){const a=this.parent;if(t===!0&&a!==null&&a.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const u=this.children;for(let d=0,p=u.length;d<p;d++)u[d].updateWorldMatrix(!1,!0)}}toJSON(t){const i=t===void 0||typeof t=="string",a={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},a.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const u={};function d(v,_){return v[_.uuid]===void 0&&(v[_.uuid]=_.toJSON(t)),_.uuid}if(u.uuid=this.uuid,u.type=this.type,this.name!==""&&(u.name=this.name),this.castShadow===!0&&(u.castShadow=!0),this.receiveShadow===!0&&(u.receiveShadow=!0),this.visible===!1&&(u.visible=!1),this.frustumCulled===!1&&(u.frustumCulled=!1),this.renderOrder!==0&&(u.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(u.userData=this.userData),u.layers=this.layers.mask,u.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(u.matrixAutoUpdate=!1),this.isInstancedMesh&&(u.type="InstancedMesh",u.count=this.count,u.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(u.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?u.background=this.background.toJSON():this.background.isTexture&&(u.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(u.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){u.geometry=d(t.geometries,this.geometry);const v=this.geometry.parameters;if(v!==void 0&&v.shapes!==void 0){const _=v.shapes;if(Array.isArray(_))for(let y=0,E=_.length;y<E;y++){const A=_[y];d(t.shapes,A)}else d(t.shapes,_)}}if(this.isSkinnedMesh&&(u.bindMode=this.bindMode,u.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(d(t.skeletons,this.skeleton),u.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const v=[];for(let _=0,y=this.material.length;_<y;_++)v.push(d(t.materials,this.material[_]));u.material=v}else u.material=d(t.materials,this.material);if(this.children.length>0){u.children=[];for(let v=0;v<this.children.length;v++)u.children.push(this.children[v].toJSON(t).object)}if(this.animations.length>0){u.animations=[];for(let v=0;v<this.animations.length;v++){const _=this.animations[v];u.animations.push(d(t.animations,_))}}if(i){const v=p(t.geometries),_=p(t.materials),y=p(t.textures),E=p(t.images),A=p(t.shapes),M=p(t.skeletons),P=p(t.animations);v.length>0&&(a.geometries=v),_.length>0&&(a.materials=_),y.length>0&&(a.textures=y),E.length>0&&(a.images=E),A.length>0&&(a.shapes=A),M.length>0&&(a.skeletons=M),P.length>0&&(a.animations=P)}return a.object=u,a;function p(v){const _=[];for(const y in v){const E=v[y];delete E.metadata,_.push(E)}return _}}clone(t){return new this.constructor().copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),i===!0)for(let a=0;a<t.children.length;a++){const u=t.children[a];this.add(u.clone())}return this}}mr.DefaultUp=new ot(0,1,0),mr.DefaultMatrixAutoUpdate=!0,mr.prototype.isObject3D=!0;const Cs=new ot,Rs=new ot,Tc=new ot,Is=new ot,_u=new ot,Na=new ot,Yu=new ot,Sc=new ot,Ah=new ot,Gl=new ot;class Mi{constructor(t=new ot,i=new ot,a=new ot){this.a=t,this.b=i,this.c=a}static getNormal(t,i,a,u){u.subVectors(a,i),Cs.subVectors(t,i),u.cross(Cs);const d=u.lengthSq();return d>0?u.multiplyScalar(1/Math.sqrt(d)):u.set(0,0,0)}static getBarycoord(t,i,a,u,d){Cs.subVectors(u,i),Rs.subVectors(a,i),Tc.subVectors(t,i);const p=Cs.dot(Cs),v=Cs.dot(Rs),_=Cs.dot(Tc),y=Rs.dot(Rs),E=Rs.dot(Tc),A=p*y-v*v;if(A===0)return d.set(-2,-1,-1);const M=1/A,P=(y*_-v*E)*M,I=(p*E-v*_)*M;return d.set(1-P-I,I,P)}static containsPoint(t,i,a,u){return this.getBarycoord(t,i,a,u,Is),Is.x>=0&&Is.y>=0&&Is.x+Is.y<=1}static getUV(t,i,a,u,d,p,v,_){return this.getBarycoord(t,i,a,u,Is),_.set(0,0),_.addScaledVector(d,Is.x),_.addScaledVector(p,Is.y),_.addScaledVector(v,Is.z),_}static isFrontFacing(t,i,a,u){return Cs.subVectors(a,i),Rs.subVectors(t,i),Cs.cross(Rs).dot(u)<0}set(t,i,a){return this.a.copy(t),this.b.copy(i),this.c.copy(a),this}setFromPointsAndIndices(t,i,a,u){return this.a.copy(t[i]),this.b.copy(t[a]),this.c.copy(t[u]),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Cs.subVectors(this.c,this.b),Rs.subVectors(this.a,this.b),.5*Cs.cross(Rs).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Mi.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,i){return Mi.getBarycoord(t,this.a,this.b,this.c,i)}getUV(t,i,a,u,d){return Mi.getUV(t,this.a,this.b,this.c,i,a,u,d)}containsPoint(t){return Mi.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Mi.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,i){const a=this.a,u=this.b,d=this.c;let p,v;_u.subVectors(u,a),Na.subVectors(d,a),Sc.subVectors(t,a);const _=_u.dot(Sc),y=Na.dot(Sc);if(_<=0&&y<=0)return i.copy(a);Ah.subVectors(t,u);const E=_u.dot(Ah),A=Na.dot(Ah);if(E>=0&&A<=E)return i.copy(u);const M=_*A-E*y;if(M<=0&&_>=0&&E<=0)return p=_/(_-E),i.copy(a).addScaledVector(_u,p);Gl.subVectors(t,d);const P=_u.dot(Gl),I=Na.dot(Gl);if(I>=0&&P<=I)return i.copy(d);const N=P*y-_*I;if(N<=0&&y>=0&&I<=0)return v=y/(y-I),i.copy(a).addScaledVector(Na,v);const O=E*I-P*A;if(O<=0&&A-E>=0&&P-I>=0)return Yu.subVectors(d,u),v=(A-E)/(A-E+(P-I)),i.copy(u).addScaledVector(Yu,v);const V=1/(O+N+M);return p=N*V,v=M*V,i.copy(a).addScaledVector(_u,p).addScaledVector(Na,v)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let Ec=0;class zi extends Ra{constructor(){super(),Object.defineProperty(this,"id",{value:Ec++}),this.uuid=wo(),this.name="",this.type="Material",this.fog=!0,this.blending=X,this.side=Gt,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Qt,this.blendDst=de,this.blendEquation=te,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Nr,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Ss,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Qi,this.stencilZFail=Qi,this.stencilZPass=Qi,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const i in t){const a=t[i];if(a===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if(i==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=a===z;continue}const u=this[i];u!==void 0?u&&u.isColor?u.set(a):u&&u.isVector3&&a&&a.isVector3?u.copy(a):this[i]=a:console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.")}}toJSON(t){const i=t===void 0||typeof t=="string";i&&(t={textures:{},images:{}});const a={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function u(d){const p=[];for(const v in d){const _=d[v];delete _.metadata,p.push(_)}return p}if(a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.color&&this.color.isColor&&(a.color=this.color.getHex()),this.roughness!==void 0&&(a.roughness=this.roughness),this.metalness!==void 0&&(a.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(a.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(a.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(a.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(a.specular=this.specular.getHex()),this.shininess!==void 0&&(a.shininess=this.shininess),this.clearcoat!==void 0&&(a.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(a.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(a.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(a.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(a.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,a.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(a.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(a.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(a.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(a.lightMap=this.lightMap.toJSON(t).uuid,a.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(a.aoMap=this.aoMap.toJSON(t).uuid,a.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(a.bumpMap=this.bumpMap.toJSON(t).uuid,a.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(a.normalMap=this.normalMap.toJSON(t).uuid,a.normalMapType=this.normalMapType,a.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(a.displacementMap=this.displacementMap.toJSON(t).uuid,a.displacementScale=this.displacementScale,a.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(a.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(a.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(a.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(a.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(a.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(a.combine=this.combine)),this.envMapIntensity!==void 0&&(a.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(a.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(a.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(a.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(a.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(a.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(a.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(a.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&(a.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(a.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(a.size=this.size),this.shadowSide!==null&&(a.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(a.sizeAttenuation=this.sizeAttenuation),this.blending!==X&&(a.blending=this.blending),this.side!==Gt&&(a.side=this.side),this.vertexColors&&(a.vertexColors=!0),this.opacity<1&&(a.opacity=this.opacity),this.transparent===!0&&(a.transparent=this.transparent),a.depthFunc=this.depthFunc,a.depthTest=this.depthTest,a.depthWrite=this.depthWrite,a.colorWrite=this.colorWrite,a.stencilWrite=this.stencilWrite,a.stencilWriteMask=this.stencilWriteMask,a.stencilFunc=this.stencilFunc,a.stencilRef=this.stencilRef,a.stencilFuncMask=this.stencilFuncMask,a.stencilFail=this.stencilFail,a.stencilZFail=this.stencilZFail,a.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(a.rotation=this.rotation),this.polygonOffset===!0&&(a.polygonOffset=!0),this.polygonOffsetFactor!==0&&(a.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(a.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(a.linewidth=this.linewidth),this.dashSize!==void 0&&(a.dashSize=this.dashSize),this.gapSize!==void 0&&(a.gapSize=this.gapSize),this.scale!==void 0&&(a.scale=this.scale),this.dithering===!0&&(a.dithering=!0),this.alphaTest>0&&(a.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(a.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(a.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(a.wireframe=this.wireframe),this.wireframeLinewidth>1&&(a.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(a.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(a.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(a.morphTargets=!0),this.morphNormals===!0&&(a.morphNormals=!0),this.flatShading===!0&&(a.flatShading=this.flatShading),this.visible===!1&&(a.visible=!1),this.toneMapped===!1&&(a.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(a.userData=this.userData),i){const d=u(t.textures),p=u(t.images);d.length>0&&(a.textures=d),p.length>0&&(a.images=p)}return a}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const i=t.clippingPlanes;let a=null;if(i!==null){const u=i.length;a=new Array(u);for(let d=0;d!==u;++d)a[d]=i[d].clone()}return this.clippingPlanes=a,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}zi.prototype.isMaterial=!0;const Qn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},po={h:0,s:0,l:0},Ph={h:0,s:0,l:0};function qu(f,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?f+6*(t-f)*i:i<.5?t:i<2/3?f+6*(t-f)*(2/3-i):f}function Mc(f){return f<.04045?.0773993808*f:Math.pow(.9478672986*f+.0521327014,2.4)}function Ch(f){return f<.0031308?12.92*f:1.055*Math.pow(f,.41666)-.055}class pn{constructor(t,i,a){return i===void 0&&a===void 0?this.set(t):this.setRGB(t,i,a)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,i,a){return this.r=t,this.g=i,this.b=a,this}setHSL(t,i,a){if(t=Sh(t,1),i=Hi(i,0,1),a=Hi(a,0,1),i===0)this.r=this.g=this.b=a;else{const u=a<=.5?a*(1+i):a+i-a*i,d=2*a-u;this.r=qu(d,u,t+1/3),this.g=qu(d,u,t),this.b=qu(d,u,t-1/3)}return this}setStyle(t){function i(u){u!==void 0&&parseFloat(u)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let a;if(a=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let u;const d=a[1],p=a[2];switch(d){case"rgb":case"rgba":if(u=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(p))return this.r=Math.min(255,parseInt(u[1],10))/255,this.g=Math.min(255,parseInt(u[2],10))/255,this.b=Math.min(255,parseInt(u[3],10))/255,i(u[4]),this;if(u=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(p))return this.r=Math.min(100,parseInt(u[1],10))/100,this.g=Math.min(100,parseInt(u[2],10))/100,this.b=Math.min(100,parseInt(u[3],10))/100,i(u[4]),this;break;case"hsl":case"hsla":if(u=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(p)){const v=parseFloat(u[1])/360,_=parseInt(u[2],10)/100,y=parseInt(u[3],10)/100;return i(u[4]),this.setHSL(v,_,y)}}}else if(a=/^\#([A-Fa-f\d]+)$/.exec(t)){const u=a[1],d=u.length;if(d===3)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(d===6)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const i=Qn[t.toLowerCase()];return i!==void 0?this.setHex(i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,i=2){return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this}copyLinearToGamma(t,i=2){const a=i>0?1/i:1;return this.r=Math.pow(t.r,a),this.g=Math.pow(t.g,a),this.b=Math.pow(t.b,a),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=Mc(t.r),this.g=Mc(t.g),this.b=Mc(t.b),this}copyLinearToSRGB(t){return this.r=Ch(t.r),this.g=Ch(t.g),this.b=Ch(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const i=this.r,a=this.g,u=this.b,d=Math.max(i,a,u),p=Math.min(i,a,u);let v,_;const y=(p+d)/2;if(p===d)v=0,_=0;else{const E=d-p;switch(_=y<=.5?E/(d+p):E/(2-d-p),d){case i:v=(a-u)/E+(a<u?6:0);break;case a:v=(u-i)/E+2;break;case u:v=(i-a)/E+4}v/=6}return t.h=v,t.s=_,t.l=y,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,i,a){return this.getHSL(po),po.h+=t,po.s+=i,po.l+=a,this.setHSL(po.h,po.s,po.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,a){return this.r=t.r+(i.r-t.r)*a,this.g=t.g+(i.g-t.g)*a,this.b=t.b+(i.b-t.b)*a,this}lerpHSL(t,i){this.getHSL(po),t.getHSL(Ph);const a=Ia(po.h,Ph.h,i),u=Ia(po.s,Ph.s,i),d=Ia(po.l,Ph.l,i);return this.setHSL(a,u,d),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}pn.NAMES=Qn,pn.prototype.isColor=!0,pn.prototype.r=1,pn.prototype.g=1,pn.prototype.b=1;class Oi extends zi{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ur,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this}}Oi.prototype.isMeshBasicMaterial=!0;const ii=new ot,ha=new Ge;class yr{constructor(t,i,a){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=i,this.count=t!==void 0?t.length/i:0,this.normalized=a===!0,this.usage=Ri,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,i,a){t*=this.itemSize,a*=i.itemSize;for(let u=0,d=this.itemSize;u<d;u++)this.array[t+u]=i.array[a+u];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const i=this.array;let a=0;for(let u=0,d=t.length;u<d;u++){let p=t[u];p===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",u),p=new pn),i[a++]=p.r,i[a++]=p.g,i[a++]=p.b}return this}copyVector2sArray(t){const i=this.array;let a=0;for(let u=0,d=t.length;u<d;u++){let p=t[u];p===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",u),p=new Ge),i[a++]=p.x,i[a++]=p.y}return this}copyVector3sArray(t){const i=this.array;let a=0;for(let u=0,d=t.length;u<d;u++){let p=t[u];p===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",u),p=new ot),i[a++]=p.x,i[a++]=p.y,i[a++]=p.z}return this}copyVector4sArray(t){const i=this.array;let a=0;for(let u=0,d=t.length;u<d;u++){let p=t[u];p===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",u),p=new Rr),i[a++]=p.x,i[a++]=p.y,i[a++]=p.z,i[a++]=p.w}return this}applyMatrix3(t){if(this.itemSize===2)for(let i=0,a=this.count;i<a;i++)ha.fromBufferAttribute(this,i),ha.applyMatrix3(t),this.setXY(i,ha.x,ha.y);else if(this.itemSize===3)for(let i=0,a=this.count;i<a;i++)ii.fromBufferAttribute(this,i),ii.applyMatrix3(t),this.setXYZ(i,ii.x,ii.y,ii.z);return this}applyMatrix4(t){for(let i=0,a=this.count;i<a;i++)ii.x=this.getX(i),ii.y=this.getY(i),ii.z=this.getZ(i),ii.applyMatrix4(t),this.setXYZ(i,ii.x,ii.y,ii.z);return this}applyNormalMatrix(t){for(let i=0,a=this.count;i<a;i++)ii.x=this.getX(i),ii.y=this.getY(i),ii.z=this.getZ(i),ii.applyNormalMatrix(t),this.setXYZ(i,ii.x,ii.y,ii.z);return this}transformDirection(t){for(let i=0,a=this.count;i<a;i++)ii.x=this.getX(i),ii.y=this.getY(i),ii.z=this.getZ(i),ii.transformDirection(t),this.setXYZ(i,ii.x,ii.y,ii.z);return this}set(t,i=0){return this.array.set(t,i),this}getX(t){return this.array[t*this.itemSize]}setX(t,i){return this.array[t*this.itemSize]=i,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,i){return this.array[t*this.itemSize+1]=i,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,i){return this.array[t*this.itemSize+2]=i,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,i){return this.array[t*this.itemSize+3]=i,this}setXY(t,i,a){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=a,this}setXYZ(t,i,a,u){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=a,this.array[t+2]=u,this}setXYZW(t,i,a,u,d){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=a,this.array[t+2]=u,this.array[t+3]=d,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==Ri&&(t.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(t.updateRange=this.updateRange),t}}yr.prototype.isBufferAttribute=!0;class On extends yr{constructor(t,i,a){super(new Int8Array(t),i,a)}}class Ac extends yr{constructor(t,i,a){super(new Uint8Array(t),i,a)}}class Eo extends yr{constructor(t,i,a){super(new Uint8ClampedArray(t),i,a)}}class ca extends yr{constructor(t,i,a){super(new Int16Array(t),i,a)}}class Hl extends yr{constructor(t,i,a){super(new Uint16Array(t),i,a)}}class Td extends yr{constructor(t,i,a){super(new Int32Array(t),i,a)}}class Bo extends yr{constructor(t,i,a){super(new Uint32Array(t),i,a)}}class Pc extends yr{constructor(t,i,a){super(new Uint16Array(t),i,a)}}Pc.prototype.isFloat16BufferAttribute=!0;class yn extends yr{constructor(t,i,a){super(new Float32Array(t),i,a)}}class Ls extends yr{constructor(t,i,a){super(new Float64Array(t),i,a)}}function Hr(f){if(f.length===0)return-1/0;let t=f[0];for(let i=1,a=f.length;i<a;++i)f[i]>t&&(t=f[i]);return t}const lr={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function $o(f,t){return new lr[f](t)}let Os=0;const bi=new wn,Rh=new mr,yu=new ot,Uo=new So,Fa=new So,Xr=new ot;class Hn extends Ra{constructor(){super(),Object.defineProperty(this,"id",{value:Os++}),this.uuid=wo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Hr(t)>65535?Bo:Hl)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,i){return this.attributes[t]=i,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,i,a=0){this.groups.push({start:t,count:i,materialIndex:a})}clearGroups(){this.groups=[]}setDrawRange(t,i){this.drawRange.start=t,this.drawRange.count=i}applyMatrix4(t){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(t),i.needsUpdate=!0);const a=this.attributes.normal;if(a!==void 0){const d=new Ii().getNormalMatrix(t);a.applyNormalMatrix(d),a.needsUpdate=!0}const u=this.attributes.tangent;return u!==void 0&&(u.transformDirection(t),u.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return bi.makeRotationFromQuaternion(t),this.applyMatrix4(bi),this}rotateX(t){return bi.makeRotationX(t),this.applyMatrix4(bi),this}rotateY(t){return bi.makeRotationY(t),this.applyMatrix4(bi),this}rotateZ(t){return bi.makeRotationZ(t),this.applyMatrix4(bi),this}translate(t,i,a){return bi.makeTranslation(t,i,a),this.applyMatrix4(bi),this}scale(t,i,a){return bi.makeScale(t,i,a),this.applyMatrix4(bi),this}lookAt(t){return Rh.lookAt(t),Rh.updateMatrix(),this.applyMatrix4(Rh.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(yu).negate(),this.translate(yu.x,yu.y,yu.z),this}setFromPoints(t){const i=[];for(let a=0,u=t.length;a<u;a++){const d=t[a];i.push(d.x,d.y,d.z||0)}return this.setAttribute("position",new yn(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new So);const t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ot(-1/0,-1/0,-1/0),new ot(1/0,1/0,1/0));if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),i)for(let a=0,u=i.length;a<u;a++){const d=i[a];Uo.setFromBufferAttribute(d),this.morphTargetsRelative?(Xr.addVectors(this.boundingBox.min,Uo.min),this.boundingBox.expandByPoint(Xr),Xr.addVectors(this.boundingBox.max,Uo.max),this.boundingBox.expandByPoint(Xr)):(this.boundingBox.expandByPoint(Uo.min),this.boundingBox.expandByPoint(Uo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Jo);const t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ot,1/0);if(t){const a=this.boundingSphere.center;if(Uo.setFromBufferAttribute(t),i)for(let d=0,p=i.length;d<p;d++){const v=i[d];Fa.setFromBufferAttribute(v),this.morphTargetsRelative?(Xr.addVectors(Uo.min,Fa.min),Uo.expandByPoint(Xr),Xr.addVectors(Uo.max,Fa.max),Uo.expandByPoint(Xr)):(Uo.expandByPoint(Fa.min),Uo.expandByPoint(Fa.max))}Uo.getCenter(a);let u=0;for(let d=0,p=t.count;d<p;d++)Xr.fromBufferAttribute(t,d),u=Math.max(u,a.distanceToSquared(Xr));if(i)for(let d=0,p=i.length;d<p;d++){const v=i[d],_=this.morphTargetsRelative;for(let y=0,E=v.count;y<E;y++)Xr.fromBufferAttribute(v,y),_&&(yu.fromBufferAttribute(t,y),Xr.add(yu)),u=Math.max(u,a.distanceToSquared(Xr))}this.boundingSphere.radius=Math.sqrt(u),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeFaceNormals(){}computeTangents(){const t=this.index,i=this.attributes;if(t===null||i.position===void 0||i.normal===void 0||i.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const a=t.array,u=i.position.array,d=i.normal.array,p=i.uv.array,v=u.length/3;i.tangent===void 0&&this.setAttribute("tangent",new yr(new Float32Array(4*v),4));const _=i.tangent.array,y=[],E=[];for(let ge=0;ge<v;ge++)y[ge]=new ot,E[ge]=new ot;const A=new ot,M=new ot,P=new ot,I=new Ge,N=new Ge,O=new Ge,V=new ot,Y=new ot;function at(ge,ve,ce){A.fromArray(u,3*ge),M.fromArray(u,3*ve),P.fromArray(u,3*ce),I.fromArray(p,2*ge),N.fromArray(p,2*ve),O.fromArray(p,2*ce),M.sub(A),P.sub(A),N.sub(I),O.sub(I);const Ot=1/(N.x*O.y-O.x*N.y);isFinite(Ot)&&(V.copy(M).multiplyScalar(O.y).addScaledVector(P,-N.y).multiplyScalar(Ot),Y.copy(P).multiplyScalar(N.x).addScaledVector(M,-O.x).multiplyScalar(Ot),y[ge].add(V),y[ve].add(V),y[ce].add(V),E[ge].add(Y),E[ve].add(Y),E[ce].add(Y))}let st=this.groups;st.length===0&&(st=[{start:0,count:a.length}]);for(let ge=0,ve=st.length;ge<ve;++ge){const ce=st[ge],Ot=ce.start;for(let ee=Ot,We=Ot+ce.count;ee<We;ee+=3)at(a[ee+0],a[ee+1],a[ee+2])}const yt=new ot,bt=new ot,_t=new ot,Et=new ot;function Ce(ge){_t.fromArray(d,3*ge),Et.copy(_t);const ve=y[ge];yt.copy(ve),yt.sub(_t.multiplyScalar(_t.dot(ve))).normalize(),bt.crossVectors(Et,ve);const ce=bt.dot(E[ge])<0?-1:1;_[4*ge]=yt.x,_[4*ge+1]=yt.y,_[4*ge+2]=yt.z,_[4*ge+3]=ce}for(let ge=0,ve=st.length;ge<ve;++ge){const ce=st[ge],Ot=ce.start;for(let ee=Ot,We=Ot+ce.count;ee<We;ee+=3)Ce(a[ee+0]),Ce(a[ee+1]),Ce(a[ee+2])}}computeVertexNormals(){const t=this.index,i=this.getAttribute("position");if(i!==void 0){let a=this.getAttribute("normal");if(a===void 0)a=new yr(new Float32Array(3*i.count),3),this.setAttribute("normal",a);else for(let M=0,P=a.count;M<P;M++)a.setXYZ(M,0,0,0);const u=new ot,d=new ot,p=new ot,v=new ot,_=new ot,y=new ot,E=new ot,A=new ot;if(t)for(let M=0,P=t.count;M<P;M+=3){const I=t.getX(M+0),N=t.getX(M+1),O=t.getX(M+2);u.fromBufferAttribute(i,I),d.fromBufferAttribute(i,N),p.fromBufferAttribute(i,O),E.subVectors(p,d),A.subVectors(u,d),E.cross(A),v.fromBufferAttribute(a,I),_.fromBufferAttribute(a,N),y.fromBufferAttribute(a,O),v.add(E),_.add(E),y.add(E),a.setXYZ(I,v.x,v.y,v.z),a.setXYZ(N,_.x,_.y,_.z),a.setXYZ(O,y.x,y.y,y.z)}else for(let M=0,P=i.count;M<P;M+=3)u.fromBufferAttribute(i,M+0),d.fromBufferAttribute(i,M+1),p.fromBufferAttribute(i,M+2),E.subVectors(p,d),A.subVectors(u,d),E.cross(A),a.setXYZ(M+0,E.x,E.y,E.z),a.setXYZ(M+1,E.x,E.y,E.z),a.setXYZ(M+2,E.x,E.y,E.z);this.normalizeNormals(),a.needsUpdate=!0}}merge(t,i){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);i===void 0&&(i=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const a=this.attributes;for(const u in a){if(t.attributes[u]===void 0)continue;const d=a[u].array,p=t.attributes[u],v=p.array,_=p.itemSize*i,y=Math.min(v.length,d.length-_);for(let E=0,A=_;E<y;E++,A++)d[A]=v[E]}return this}normalizeNormals(){const t=this.attributes.normal;for(let i=0,a=t.count;i<a;i++)Xr.fromBufferAttribute(t,i),Xr.normalize(),t.setXYZ(i,Xr.x,Xr.y,Xr.z)}toNonIndexed(){function t(v,_){const y=v.array,E=v.itemSize,A=v.normalized,M=new y.constructor(_.length*E);let P=0,I=0;for(let N=0,O=_.length;N<O;N++){P=v.isInterleavedBufferAttribute?_[N]*v.data.stride+v.offset:_[N]*E;for(let V=0;V<E;V++)M[I++]=y[P++]}return new yr(M,E,A)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new Hn,a=this.index.array,u=this.attributes;for(const v in u){const _=t(u[v],a);i.setAttribute(v,_)}const d=this.morphAttributes;for(const v in d){const _=[],y=d[v];for(let E=0,A=y.length;E<A;E++){const M=t(y[E],a);_.push(M)}i.morphAttributes[v]=_}i.morphTargetsRelative=this.morphTargetsRelative;const p=this.groups;for(let v=0,_=p.length;v<_;v++){const y=p[v];i.addGroup(y.start,y.count,y.materialIndex)}return i}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const _=this.parameters;for(const y in _)_[y]!==void 0&&(t[y]=_[y]);return t}t.data={attributes:{}};const i=this.index;i!==null&&(t.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const a=this.attributes;for(const _ in a){const y=a[_];t.data.attributes[_]=y.toJSON(t.data)}const u={};let d=!1;for(const _ in this.morphAttributes){const y=this.morphAttributes[_],E=[];for(let A=0,M=y.length;A<M;A++){const P=y[A];E.push(P.toJSON(t.data))}E.length>0&&(u[_]=E,d=!0)}d&&(t.data.morphAttributes=u,t.data.morphTargetsRelative=this.morphTargetsRelative);const p=this.groups;p.length>0&&(t.data.groups=JSON.parse(JSON.stringify(p)));const v=this.boundingSphere;return v!==null&&(t.data.boundingSphere={center:v.center.toArray(),radius:v.radius}),t}clone(){return new Hn().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=t.name;const a=t.index;a!==null&&this.setIndex(a.clone(i));const u=t.attributes;for(const y in u){const E=u[y];this.setAttribute(y,E.clone(i))}const d=t.morphAttributes;for(const y in d){const E=[],A=d[y];for(let M=0,P=A.length;M<P;M++)E.push(A[M].clone(i));this.morphAttributes[y]=E}this.morphTargetsRelative=t.morphTargetsRelative;const p=t.groups;for(let y=0,E=p.length;y<E;y++){const A=p[y];this.addGroup(A.start,A.count,A.materialIndex)}const v=t.boundingBox;v!==null&&(this.boundingBox=v.clone());const _=t.boundingSphere;return _!==null&&(this.boundingSphere=_.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}Hn.prototype.isBufferGeometry=!0;const zl=new wn,ji=new cs,ms=new Jo,Di=new ot,ko=new ot,Ba=new ot,Cc=new ot,Rc=new ot,xu=new ot,bu=new ot,Ih=new ot,Lh=new ot,Zu=new Ge,Oh=new Ge,Ws=new Ge,da=new ot,pa=new ot;class Ni extends mr{constructor(t=new Hn,i=new Oi){super(),this.type="Mesh",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t){return super.copy(t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const i=t.morphAttributes,a=Object.keys(i);if(a.length>0){const u=i[a[0]];if(u!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,p=u.length;d<p;d++){const v=u[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=d}}}}else{const i=t.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,i){const a=this.geometry,u=this.material,d=this.matrixWorld;if(u===void 0||(a.boundingSphere===null&&a.computeBoundingSphere(),ms.copy(a.boundingSphere),ms.applyMatrix4(d),t.ray.intersectsSphere(ms)===!1)||(zl.copy(d).invert(),ji.copy(t.ray).applyMatrix4(zl),a.boundingBox!==null&&ji.intersectsBox(a.boundingBox)===!1))return;let p;if(a.isBufferGeometry){const v=a.index,_=a.attributes.position,y=a.morphAttributes.position,E=a.morphTargetsRelative,A=a.attributes.uv,M=a.attributes.uv2,P=a.groups,I=a.drawRange;if(v!==null)if(Array.isArray(u))for(let N=0,O=P.length;N<O;N++){const V=P[N],Y=u[V.materialIndex];for(let at=Math.max(V.start,I.start),st=Math.min(V.start+V.count,I.start+I.count);at<st;at+=3){const yt=v.getX(at),bt=v.getX(at+1),_t=v.getX(at+2);p=Ju(this,Y,t,ji,_,y,E,A,M,yt,bt,_t),p&&(p.faceIndex=Math.floor(at/3),p.face.materialIndex=V.materialIndex,i.push(p))}}else for(let N=Math.max(0,I.start),O=Math.min(v.count,I.start+I.count);N<O;N+=3){const V=v.getX(N),Y=v.getX(N+1),at=v.getX(N+2);p=Ju(this,u,t,ji,_,y,E,A,M,V,Y,at),p&&(p.faceIndex=Math.floor(N/3),i.push(p))}else if(_!==void 0)if(Array.isArray(u))for(let N=0,O=P.length;N<O;N++){const V=P[N],Y=u[V.materialIndex];for(let at=Math.max(V.start,I.start),st=Math.min(V.start+V.count,I.start+I.count);at<st;at+=3)p=Ju(this,Y,t,ji,_,y,E,A,M,at,at+1,at+2),p&&(p.faceIndex=Math.floor(at/3),p.face.materialIndex=V.materialIndex,i.push(p))}else for(let N=Math.max(0,I.start),O=Math.min(_.count,I.start+I.count);N<O;N+=3)p=Ju(this,u,t,ji,_,y,E,A,M,N,N+1,N+2),p&&(p.faceIndex=Math.floor(N/3),i.push(p))}else a.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function Ju(f,t,i,a,u,d,p,v,_,y,E,A){Di.fromBufferAttribute(u,y),ko.fromBufferAttribute(u,E),Ba.fromBufferAttribute(u,A);const M=f.morphTargetInfluences;if(t.morphTargets&&d&&M){bu.set(0,0,0),Ih.set(0,0,0),Lh.set(0,0,0);for(let I=0,N=d.length;I<N;I++){const O=M[I],V=d[I];O!==0&&(Cc.fromBufferAttribute(V,y),Rc.fromBufferAttribute(V,E),xu.fromBufferAttribute(V,A),p?(bu.addScaledVector(Cc,O),Ih.addScaledVector(Rc,O),Lh.addScaledVector(xu,O)):(bu.addScaledVector(Cc.sub(Di),O),Ih.addScaledVector(Rc.sub(ko),O),Lh.addScaledVector(xu.sub(Ba),O)))}Di.add(bu),ko.add(Ih),Ba.add(Lh)}f.isSkinnedMesh&&(f.boneTransform(y,Di),f.boneTransform(E,ko),f.boneTransform(A,Ba));const P=function(I,N,O,V,Y,at,st,yt){let bt;if(bt=N.side===L?V.intersectTriangle(st,at,Y,!0,yt):V.intersectTriangle(Y,at,st,N.side!==F,yt),bt===null)return null;pa.copy(yt),pa.applyMatrix4(I.matrixWorld);const _t=O.ray.origin.distanceTo(pa);return _t<O.near||_t>O.far?null:{distance:_t,point:pa.clone(),object:I}}(f,t,i,a,Di,ko,Ba,da);if(P){v&&(Zu.fromBufferAttribute(v,y),Oh.fromBufferAttribute(v,E),Ws.fromBufferAttribute(v,A),P.uv=Mi.getUV(da,Di,ko,Ba,Zu,Oh,Ws,new Ge)),_&&(Zu.fromBufferAttribute(_,y),Oh.fromBufferAttribute(_,E),Ws.fromBufferAttribute(_,A),P.uv2=Mi.getUV(da,Di,ko,Ba,Zu,Oh,Ws,new Ge));const I={a:y,b:E,c:A,normal:new ot,materialIndex:0};Mi.getNormal(Di,ko,Ba,I.normal),P.face=I}return P}Ni.prototype.isMesh=!0;class Xs extends Hn{constructor(t=1,i=1,a=1,u=1,d=1,p=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:i,depth:a,widthSegments:u,heightSegments:d,depthSegments:p};const v=this;u=Math.floor(u),d=Math.floor(d),p=Math.floor(p);const _=[],y=[],E=[],A=[];let M=0,P=0;function I(N,O,V,Y,at,st,yt,bt,_t,Et,Ce){const ge=st/_t,ve=yt/Et,ce=st/2,Ot=yt/2,ee=bt/2,We=_t+1,ze=Et+1;let Ue=0,fn=0;const vn=new ot;for(let En=0;En<ze;En++){const Tn=En*ve-Ot;for(let wt=0;wt<We;wt++){const Mt=wt*ge-ce;vn[N]=Mt*Y,vn[O]=Tn*at,vn[V]=ee,y.push(vn.x,vn.y,vn.z),vn[N]=0,vn[O]=0,vn[V]=bt>0?1:-1,E.push(vn.x,vn.y,vn.z),A.push(wt/_t),A.push(1-En/Et),Ue+=1}}for(let En=0;En<Et;En++)for(let Tn=0;Tn<_t;Tn++){const wt=M+Tn+We*En,Mt=M+Tn+We*(En+1),De=M+(Tn+1)+We*(En+1),Ne=M+(Tn+1)+We*En;_.push(wt,Mt,Ne),_.push(Mt,De,Ne),fn+=6}v.addGroup(P,fn,Ce),P+=fn,M+=Ue}I("z","y","x",-1,-1,a,i,t,p,d,0),I("z","y","x",1,-1,a,i,-t,p,d,1),I("x","z","y",1,1,t,a,i,u,p,2),I("x","z","y",1,-1,t,a,-i,u,p,3),I("x","y","z",1,-1,t,i,a,u,d,4),I("x","y","z",-1,-1,t,i,-a,u,d,5),this.setIndex(_),this.setAttribute("position",new yn(y,3)),this.setAttribute("normal",new yn(E,3)),this.setAttribute("uv",new yn(A,2))}static fromJSON(t){return new Xs(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Ua(f){const t={};for(const i in f){t[i]={};for(const a in f[i]){const u=f[i][a];u&&(u.isColor||u.isMatrix3||u.isMatrix4||u.isVector2||u.isVector3||u.isVector4||u.isTexture||u.isQuaternion)?t[i][a]=u.clone():Array.isArray(u)?t[i][a]=u.slice():t[i][a]=u}}return t}function Mo(f){const t={};for(let i=0;i<f.length;i++){const a=Ua(f[i]);for(const u in a)t[u]=a[u]}return t}const Sd={clone:Ua,merge:Mo};class fo extends zi{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ua(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const i=super.toJSON(t);i.glslVersion=this.glslVersion,i.uniforms={};for(const u in this.uniforms){const d=this.uniforms[u].value;d&&d.isTexture?i.uniforms[u]={type:"t",value:d.toJSON(t).uuid}:d&&d.isColor?i.uniforms[u]={type:"c",value:d.getHex()}:d&&d.isVector2?i.uniforms[u]={type:"v2",value:d.toArray()}:d&&d.isVector3?i.uniforms[u]={type:"v3",value:d.toArray()}:d&&d.isVector4?i.uniforms[u]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?i.uniforms[u]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?i.uniforms[u]={type:"m4",value:d.toArray()}:i.uniforms[u]={value:d}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader;const a={};for(const u in this.extensions)this.extensions[u]===!0&&(a[u]=!0);return Object.keys(a).length>0&&(i.extensions=a),i}}fo.prototype.isShaderMaterial=!0;class jl extends mr{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new wn,this.projectionMatrix=new wn,this.projectionMatrixInverse=new wn}copy(t,i){return super.copy(t,i),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(-i[8],-i[9],-i[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,i){super.updateWorldMatrix(t,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}jl.prototype.isCamera=!0;class Zi extends jl{constructor(t=50,i=1,a=.1,u=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=a,this.far=u,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,i){return super.copy(t,i),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const i=.5*this.getFilmHeight()/t;this.fov=2*uu*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*uo*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*uu*Math.atan(Math.tan(.5*uo*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,i,a,u,d,p){this.aspect=t/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=a,this.view.offsetY=u,this.view.width=d,this.view.height=p,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let i=t*Math.tan(.5*uo*this.fov)/this.zoom,a=2*i,u=this.aspect*a,d=-.5*u;const p=this.view;if(this.view!==null&&this.view.enabled){const _=p.fullWidth,y=p.fullHeight;d+=p.offsetX*u/_,i-=p.offsetY*a/y,u*=p.width/_,a*=p.height/y}const v=this.filmOffset;v!==0&&(d+=t*v/this.getFilmWidth()),this.projectionMatrix.makePerspective(d,d+u,i,i-a,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const i=super.toJSON(t);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}Zi.prototype.isPerspectiveCamera=!0;class Ic extends mr{constructor(t,i,a){if(super(),this.type="CubeCamera",a.isWebGLCubeRenderTarget!==!0)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=a;const u=new Zi(90,1,t,i);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new ot(1,0,0)),this.add(u);const d=new Zi(90,1,t,i);d.layers=this.layers,d.up.set(0,-1,0),d.lookAt(new ot(-1,0,0)),this.add(d);const p=new Zi(90,1,t,i);p.layers=this.layers,p.up.set(0,0,1),p.lookAt(new ot(0,1,0)),this.add(p);const v=new Zi(90,1,t,i);v.layers=this.layers,v.up.set(0,0,-1),v.lookAt(new ot(0,-1,0)),this.add(v);const _=new Zi(90,1,t,i);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new ot(0,0,1)),this.add(_);const y=new Zi(90,1,t,i);y.layers=this.layers,y.up.set(0,-1,0),y.lookAt(new ot(0,0,-1)),this.add(y)}update(t,i){this.parent===null&&this.updateMatrixWorld();const a=this.renderTarget,[u,d,p,v,_,y]=this.children,E=t.xr.enabled,A=t.getRenderTarget();t.xr.enabled=!1;const M=a.texture.generateMipmaps;a.texture.generateMipmaps=!1,t.setRenderTarget(a,0),t.render(i,u),t.setRenderTarget(a,1),t.render(i,d),t.setRenderTarget(a,2),t.render(i,p),t.setRenderTarget(a,3),t.render(i,v),t.setRenderTarget(a,4),t.render(i,_),a.texture.generateMipmaps=M,t.setRenderTarget(a,5),t.render(i,y),t.setRenderTarget(A),t.xr.enabled=E}}class $u extends ui{constructor(t,i,a,u,d,p,v,_,y,E){super(t=t!==void 0?t:[],i=i!==void 0?i:Q,a,u,d,p,v=v!==void 0?v:_n,_,y,E),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}$u.prototype.isCubeTexture=!0;class Ds extends To{constructor(t,i,a){Number.isInteger(i)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),i=a),super(t,t,i),i=i||{},this.texture=new $u(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.generateMipmaps=i.generateMipmaps!==void 0&&i.generateMipmaps,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Un,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,i){this.texture.type=i.type,this.texture.format=Sn,this.texture.encoding=i.encoding,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const a={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},u=new Xs(5,5,5),d=new fo({name:"CubemapFromEquirect",uniforms:Ua(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,side:L,blending:k});d.uniforms.tEquirect.value=i;const p=new Ni(u,d),v=i.minFilter;return i.minFilter===gi&&(i.minFilter=Un),new Ic(1,10,this).update(t,p),i.minFilter=v,p.geometry.dispose(),p.material.dispose(),this}clear(t,i,a,u){const d=t.getRenderTarget();for(let p=0;p<6;p++)t.setRenderTarget(this,p),t.clear(i,a,u);t.setRenderTarget(d)}}Ds.prototype.isWebGLCubeRenderTarget=!0;const Dh=new ot,Ed=new ot,Md=new Ii;class Go{constructor(t=new ot(1,0,0),i=0){this.normal=t,this.constant=i}set(t,i){return this.normal.copy(t),this.constant=i,this}setComponents(t,i,a,u){return this.normal.set(t,i,a),this.constant=u,this}setFromNormalAndCoplanarPoint(t,i){return this.normal.copy(t),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(t,i,a){const u=Dh.subVectors(a,i).cross(Ed.subVectors(t,i)).normalize();return this.setFromNormalAndCoplanarPoint(u,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,i){return i.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,i){const a=t.delta(Dh),u=this.normal.dot(a);if(u===0)return this.distanceToPoint(t.start)===0?i.copy(t.start):null;const d=-(t.start.dot(this.normal)+this.constant)/u;return d<0||d>1?null:i.copy(a).multiplyScalar(d).add(t.start)}intersectsLine(t){const i=this.distanceToPoint(t.start),a=this.distanceToPoint(t.end);return i<0&&a>0||a<0&&i>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,i){const a=i||Md.getNormalMatrix(t),u=this.coplanarPoint(Dh).applyMatrix4(t),d=this.normal.applyMatrix3(a).normalize();return this.constant=-u.dot(d),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}Go.prototype.isPlane=!0;const Ns=new Jo,Nn=new ot;class ka{constructor(t=new Go,i=new Go,a=new Go,u=new Go,d=new Go,p=new Go){this.planes=[t,i,a,u,d,p]}set(t,i,a,u,d,p){const v=this.planes;return v[0].copy(t),v[1].copy(i),v[2].copy(a),v[3].copy(u),v[4].copy(d),v[5].copy(p),this}copy(t){const i=this.planes;for(let a=0;a<6;a++)i[a].copy(t.planes[a]);return this}setFromProjectionMatrix(t){const i=this.planes,a=t.elements,u=a[0],d=a[1],p=a[2],v=a[3],_=a[4],y=a[5],E=a[6],A=a[7],M=a[8],P=a[9],I=a[10],N=a[11],O=a[12],V=a[13],Y=a[14],at=a[15];return i[0].setComponents(v-u,A-_,N-M,at-O).normalize(),i[1].setComponents(v+u,A+_,N+M,at+O).normalize(),i[2].setComponents(v+d,A+y,N+P,at+V).normalize(),i[3].setComponents(v-d,A-y,N-P,at-V).normalize(),i[4].setComponents(v-p,A-E,N-I,at-Y).normalize(),i[5].setComponents(v+p,A+E,N+I,at+Y).normalize(),this}intersectsObject(t){const i=t.geometry;return i.boundingSphere===null&&i.computeBoundingSphere(),Ns.copy(i.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ns)}intersectsSprite(t){return Ns.center.set(0,0,0),Ns.radius=.7071067811865476,Ns.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ns)}intersectsSphere(t){const i=this.planes,a=t.center,u=-t.radius;for(let d=0;d<6;d++)if(i[d].distanceToPoint(a)<u)return!1;return!0}intersectsBox(t){const i=this.planes;for(let a=0;a<6;a++){const u=i[a];if(Nn.x=u.normal.x>0?t.max.x:t.min.x,Nn.y=u.normal.y>0?t.max.y:t.min.y,Nn.z=u.normal.z>0?t.max.z:t.min.z,u.distanceToPoint(Nn)<0)return!1}return!0}containsPoint(t){const i=this.planes;for(let a=0;a<6;a++)if(i[a].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Nh(){let f=null,t=!1,i=null,a=null;function u(d,p){i(d,p),a=f.requestAnimationFrame(u)}return{start:function(){t!==!0&&i!==null&&(a=f.requestAnimationFrame(u),t=!0)},stop:function(){f.cancelAnimationFrame(a),t=!1},setAnimationLoop:function(d){i=d},setContext:function(d){f=d}}}function wu(f,t){const i=t.isWebGL2,a=new WeakMap;return{get:function(u){return u.isInterleavedBufferAttribute&&(u=u.data),a.get(u)},remove:function(u){u.isInterleavedBufferAttribute&&(u=u.data);const d=a.get(u);d&&(f.deleteBuffer(d.buffer),a.delete(u))},update:function(u,d){if(u.isGLBufferAttribute){const v=a.get(u);return void((!v||v.version<u.version)&&a.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version}))}u.isInterleavedBufferAttribute&&(u=u.data);const p=a.get(u);p===void 0?a.set(u,function(v,_){const y=v.array,E=v.usage,A=f.createBuffer();f.bindBuffer(_,A),f.bufferData(_,y,E),v.onUploadCallback();let M=5126;return y instanceof Float32Array?M=5126:y instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):y instanceof Uint16Array?v.isFloat16BufferAttribute?i?M=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):M=5123:y instanceof Int16Array?M=5122:y instanceof Uint32Array?M=5125:y instanceof Int32Array?M=5124:y instanceof Int8Array?M=5120:(y instanceof Uint8Array||y instanceof Uint8ClampedArray)&&(M=5121),{buffer:A,type:M,bytesPerElement:y.BYTES_PER_ELEMENT,version:v.version}}(u,d)):p.version<u.version&&(function(v,_,y){const E=_.array,A=_.updateRange;f.bindBuffer(y,v),A.count===-1?f.bufferSubData(y,0,E):(i?f.bufferSubData(y,A.offset*E.BYTES_PER_ELEMENT,E,A.offset,A.count):f.bufferSubData(y,A.offset*E.BYTES_PER_ELEMENT,E.subarray(A.offset,A.offset+A.count)),A.count=-1)}(p.buffer,u,d),p.version=u.version)}}}class mo extends Hn{constructor(t=1,i=1,a=1,u=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:i,widthSegments:a,heightSegments:u};const d=t/2,p=i/2,v=Math.floor(a),_=Math.floor(u),y=v+1,E=_+1,A=t/v,M=i/_,P=[],I=[],N=[],O=[];for(let V=0;V<E;V++){const Y=V*M-p;for(let at=0;at<y;at++){const st=at*A-d;I.push(st,-Y,0),N.push(0,0,1),O.push(at/v),O.push(1-V/_)}}for(let V=0;V<_;V++)for(let Y=0;Y<v;Y++){const at=Y+y*V,st=Y+y*(V+1),yt=Y+1+y*(V+1),bt=Y+1+y*V;P.push(at,st,bt),P.push(st,yt,bt)}this.setIndex(P),this.setAttribute("position",new yn(I,3)),this.setAttribute("normal",new yn(N,3)),this.setAttribute("uv",new yn(O,2))}static fromJSON(t){return new mo(t.width,t.height,t.widthSegments,t.heightSegments)}}const er={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotVH ) {
	float fresnel = exp2( ( -5.55473 * dotVH - 6.98316 ) * dotVH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment:`#ifdef USE_TRANSMISSION
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSNMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition.xyz / vWorldPosition.w;
	vec3 v = normalize( cameraPosition - pos );
	float ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );
	vec3 transmission = transmissionFactor * getIBLVolumeRefraction(
		normal, v, roughnessFactor, material.diffuseColor, totalSpecular,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission, transmissionFactor );
#endif`,transmission_pars_fragment:`#ifdef USE_TRANSMISSION
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec4 vWorldPosition;
	vec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {
		vec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);
		vec3 modelScale;
		modelScale.x = length(vec3(modelMatrix[0].xyz));
		modelScale.y = length(vec3(modelMatrix[1].xyz));
		modelScale.z = length(vec3(modelMatrix[2].xyz));
		return normalize(refractionVector) * thickness * modelScale;
	}
	float applyIorToRoughness(float roughness, float ior) {
		return roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);
	}
	vec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {
		float framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);
		return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;
	}
	vec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {
		if (attenuationDistance == 0.0) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;
			vec3 transmittance = exp(-attenuationCoefficient * transmissionDistance);			return transmittance * radiance;
		}
	}
	vec3 getIBLVolumeRefraction(vec3 n, vec3 v, float perceptualRoughness, vec3 baseColor, vec3 specularColor,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance) {
		vec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);
		vec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);
		return (1.0 - specularColor) * attenuatedColor * baseColor;
	}
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform vec3 attenuationColor;
	uniform float attenuationDistance;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <transmission_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#ifdef USE_TRANSMISSION
	varying vec4 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition;
#endif
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},Ze={common:{diffuse:{value:new pn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ii},uv2Transform:{value:new Ii},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ge(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new pn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ii}},sprite:{diffuse:{value:new pn(16777215)},opacity:{value:1},center:{value:new Ge(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ii}}},gs={basic:{uniforms:Mo([Ze.common,Ze.specularmap,Ze.envmap,Ze.aomap,Ze.lightmap,Ze.fog]),vertexShader:er.meshbasic_vert,fragmentShader:er.meshbasic_frag},lambert:{uniforms:Mo([Ze.common,Ze.specularmap,Ze.envmap,Ze.aomap,Ze.lightmap,Ze.emissivemap,Ze.fog,Ze.lights,{emissive:{value:new pn(0)}}]),vertexShader:er.meshlambert_vert,fragmentShader:er.meshlambert_frag},phong:{uniforms:Mo([Ze.common,Ze.specularmap,Ze.envmap,Ze.aomap,Ze.lightmap,Ze.emissivemap,Ze.bumpmap,Ze.normalmap,Ze.displacementmap,Ze.fog,Ze.lights,{emissive:{value:new pn(0)},specular:{value:new pn(1118481)},shininess:{value:30}}]),vertexShader:er.meshphong_vert,fragmentShader:er.meshphong_frag},standard:{uniforms:Mo([Ze.common,Ze.envmap,Ze.aomap,Ze.lightmap,Ze.emissivemap,Ze.bumpmap,Ze.normalmap,Ze.displacementmap,Ze.roughnessmap,Ze.metalnessmap,Ze.fog,Ze.lights,{emissive:{value:new pn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:er.meshphysical_vert,fragmentShader:er.meshphysical_frag},toon:{uniforms:Mo([Ze.common,Ze.aomap,Ze.lightmap,Ze.emissivemap,Ze.bumpmap,Ze.normalmap,Ze.displacementmap,Ze.gradientmap,Ze.fog,Ze.lights,{emissive:{value:new pn(0)}}]),vertexShader:er.meshtoon_vert,fragmentShader:er.meshtoon_frag},matcap:{uniforms:Mo([Ze.common,Ze.bumpmap,Ze.normalmap,Ze.displacementmap,Ze.fog,{matcap:{value:null}}]),vertexShader:er.meshmatcap_vert,fragmentShader:er.meshmatcap_frag},points:{uniforms:Mo([Ze.points,Ze.fog]),vertexShader:er.points_vert,fragmentShader:er.points_frag},dashed:{uniforms:Mo([Ze.common,Ze.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:er.linedashed_vert,fragmentShader:er.linedashed_frag},depth:{uniforms:Mo([Ze.common,Ze.displacementmap]),vertexShader:er.depth_vert,fragmentShader:er.depth_frag},normal:{uniforms:Mo([Ze.common,Ze.bumpmap,Ze.normalmap,Ze.displacementmap,{opacity:{value:1}}]),vertexShader:er.normal_vert,fragmentShader:er.normal_frag},sprite:{uniforms:Mo([Ze.sprite,Ze.fog]),vertexShader:er.sprite_vert,fragmentShader:er.sprite_frag},background:{uniforms:{uvTransform:{value:new Ii},t2D:{value:null}},vertexShader:er.background_vert,fragmentShader:er.background_frag},cube:{uniforms:Mo([Ze.envmap,{opacity:{value:1}}]),vertexShader:er.cube_vert,fragmentShader:er.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:er.equirect_vert,fragmentShader:er.equirect_frag},distanceRGBA:{uniforms:Mo([Ze.common,Ze.displacementmap,{referencePosition:{value:new ot},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:er.distanceRGBA_vert,fragmentShader:er.distanceRGBA_frag},shadow:{uniforms:Mo([Ze.lights,Ze.fog,{color:{value:new pn(0)},opacity:{value:1}}]),vertexShader:er.shadow_vert,fragmentShader:er.shadow_frag}};function Ad(f,t,i,a,u){const d=new pn(0);let p,v,_=0,y=null,E=0,A=null;function M(P,I){i.buffers.color.setClear(P.r,P.g,P.b,I,u)}return{getClearColor:function(){return d},setClearColor:function(P,I=1){d.set(P),_=I,M(d,_)},getClearAlpha:function(){return _},setClearAlpha:function(P){_=P,M(d,_)},render:function(P,I){let N=!1,O=I.isScene===!0?I.background:null;O&&O.isTexture&&(O=t.get(O));const V=f.xr,Y=V.getSession&&V.getSession();Y&&Y.environmentBlendMode==="additive"&&(O=null),O===null?M(d,_):O&&O.isColor&&(M(O,1),N=!0),(f.autoClear||N)&&f.clear(f.autoClearColor,f.autoClearDepth,f.autoClearStencil),O&&(O.isCubeTexture||O.mapping===Ct)?(v===void 0&&(v=new Ni(new Xs(1,1,1),new fo({name:"BackgroundCubeMaterial",uniforms:Ua(gs.cube.uniforms),vertexShader:gs.cube.vertexShader,fragmentShader:gs.cube.fragmentShader,side:L,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(at,st,yt){this.matrixWorld.copyPosition(yt.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(v)),v.material.uniforms.envMap.value=O,v.material.uniforms.flipEnvMap.value=O.isCubeTexture&&O._needsFlipEnvMap?-1:1,y===O&&E===O.version&&A===f.toneMapping||(v.material.needsUpdate=!0,y=O,E=O.version,A=f.toneMapping),P.unshift(v,v.geometry,v.material,0,0,null)):O&&O.isTexture&&(p===void 0&&(p=new Ni(new mo(2,2),new fo({name:"BackgroundMaterial",uniforms:Ua(gs.background.uniforms),vertexShader:gs.background.vertexShader,fragmentShader:gs.background.fragmentShader,side:Gt,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(p)),p.material.uniforms.t2D.value=O,O.matrixAutoUpdate===!0&&O.updateMatrix(),p.material.uniforms.uvTransform.value.copy(O.matrix),y===O&&E===O.version&&A===f.toneMapping||(p.material.needsUpdate=!0,y=O,E=O.version,A=f.toneMapping),P.unshift(p,p.geometry,p.material,0,0,null))}}}function Vl(f,t,i,a){const u=f.getParameter(34921),d=a.isWebGL2?null:t.get("OES_vertex_array_object"),p=a.isWebGL2||d!==null,v={},_=M(null);let y=_;function E(st){return a.isWebGL2?f.bindVertexArray(st):d.bindVertexArrayOES(st)}function A(st){return a.isWebGL2?f.deleteVertexArray(st):d.deleteVertexArrayOES(st)}function M(st){const yt=[],bt=[],_t=[];for(let Et=0;Et<u;Et++)yt[Et]=0,bt[Et]=0,_t[Et]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:yt,enabledAttributes:bt,attributeDivisors:_t,object:st,attributes:{},index:null}}function P(){const st=y.newAttributes;for(let yt=0,bt=st.length;yt<bt;yt++)st[yt]=0}function I(st){N(st,0)}function N(st,yt){const bt=y.newAttributes,_t=y.enabledAttributes,Et=y.attributeDivisors;bt[st]=1,_t[st]===0&&(f.enableVertexAttribArray(st),_t[st]=1),Et[st]!==yt&&((a.isWebGL2?f:t.get("ANGLE_instanced_arrays"))[a.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](st,yt),Et[st]=yt)}function O(){const st=y.newAttributes,yt=y.enabledAttributes;for(let bt=0,_t=yt.length;bt<_t;bt++)yt[bt]!==st[bt]&&(f.disableVertexAttribArray(bt),yt[bt]=0)}function V(st,yt,bt,_t,Et,Ce){a.isWebGL2!==!0||bt!==5124&&bt!==5125?f.vertexAttribPointer(st,yt,bt,_t,Et,Ce):f.vertexAttribIPointer(st,yt,bt,Et,Ce)}function Y(){at(),y!==_&&(y=_,E(y.object))}function at(){_.geometry=null,_.program=null,_.wireframe=!1}return{setup:function(st,yt,bt,_t,Et){let Ce=!1;if(p){const ge=function(ve,ce,Ot){const ee=Ot.wireframe===!0;let We=v[ve.id];We===void 0&&(We={},v[ve.id]=We);let ze=We[ce.id];ze===void 0&&(ze={},We[ce.id]=ze);let Ue=ze[ee];return Ue===void 0&&(Ue=M(a.isWebGL2?f.createVertexArray():d.createVertexArrayOES()),ze[ee]=Ue),Ue}(_t,bt,yt);y!==ge&&(y=ge,E(y.object)),Ce=function(ve,ce){const Ot=y.attributes,ee=ve.attributes;let We=0;for(const ze in ee){const Ue=Ot[ze],fn=ee[ze];if(Ue===void 0||Ue.attribute!==fn||Ue.data!==fn.data)return!0;We++}return y.attributesNum!==We||y.index!==ce}(_t,Et),Ce&&function(ve,ce){const Ot={},ee=ve.attributes;let We=0;for(const ze in ee){const Ue=ee[ze],fn={};fn.attribute=Ue,Ue.data&&(fn.data=Ue.data),Ot[ze]=fn,We++}y.attributes=Ot,y.attributesNum=We,y.index=ce}(_t,Et)}else{const ge=yt.wireframe===!0;y.geometry===_t.id&&y.program===bt.id&&y.wireframe===ge||(y.geometry=_t.id,y.program=bt.id,y.wireframe=ge,Ce=!0)}st.isInstancedMesh===!0&&(Ce=!0),Et!==null&&i.update(Et,34963),Ce&&(function(ge,ve,ce,Ot){if(a.isWebGL2===!1&&(ge.isInstancedMesh||Ot.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;P();const ee=Ot.attributes,We=ce.getAttributes(),ze=ve.defaultAttributeValues;for(const Ue in We){const fn=We[Ue];if(fn>=0){const vn=ee[Ue];if(vn!==void 0){const En=vn.normalized,Tn=vn.itemSize,wt=i.get(vn);if(wt===void 0)continue;const Mt=wt.buffer,De=wt.type,Ne=wt.bytesPerElement;if(vn.isInterleavedBufferAttribute){const se=vn.data,nn=se.stride,rn=vn.offset;se&&se.isInstancedInterleavedBuffer?(N(fn,se.meshPerAttribute),Ot._maxInstanceCount===void 0&&(Ot._maxInstanceCount=se.meshPerAttribute*se.count)):I(fn),f.bindBuffer(34962,Mt),V(fn,Tn,De,En,nn*Ne,rn*Ne)}else vn.isInstancedBufferAttribute?(N(fn,vn.meshPerAttribute),Ot._maxInstanceCount===void 0&&(Ot._maxInstanceCount=vn.meshPerAttribute*vn.count)):I(fn),f.bindBuffer(34962,Mt),V(fn,Tn,De,En,0,0)}else if(Ue==="instanceMatrix"){const En=i.get(ge.instanceMatrix);if(En===void 0)continue;const Tn=En.buffer,wt=En.type;N(fn+0,1),N(fn+1,1),N(fn+2,1),N(fn+3,1),f.bindBuffer(34962,Tn),f.vertexAttribPointer(fn+0,4,wt,!1,64,0),f.vertexAttribPointer(fn+1,4,wt,!1,64,16),f.vertexAttribPointer(fn+2,4,wt,!1,64,32),f.vertexAttribPointer(fn+3,4,wt,!1,64,48)}else if(Ue==="instanceColor"){const En=i.get(ge.instanceColor);if(En===void 0)continue;const Tn=En.buffer,wt=En.type;N(fn,1),f.bindBuffer(34962,Tn),f.vertexAttribPointer(fn,3,wt,!1,12,0)}else if(ze!==void 0){const En=ze[Ue];if(En!==void 0)switch(En.length){case 2:f.vertexAttrib2fv(fn,En);break;case 3:f.vertexAttrib3fv(fn,En);break;case 4:f.vertexAttrib4fv(fn,En);break;default:f.vertexAttrib1fv(fn,En)}}}}O()}(st,yt,bt,_t),Et!==null&&f.bindBuffer(34963,i.get(Et).buffer))},reset:Y,resetDefaultState:at,dispose:function(){Y();for(const st in v){const yt=v[st];for(const bt in yt){const _t=yt[bt];for(const Et in _t)A(_t[Et].object),delete _t[Et];delete yt[bt]}delete v[st]}},releaseStatesOfGeometry:function(st){if(v[st.id]===void 0)return;const yt=v[st.id];for(const bt in yt){const _t=yt[bt];for(const Et in _t)A(_t[Et].object),delete _t[Et];delete yt[bt]}delete v[st.id]},releaseStatesOfProgram:function(st){for(const yt in v){const bt=v[yt];if(bt[st.id]===void 0)continue;const _t=bt[st.id];for(const Et in _t)A(_t[Et].object),delete _t[Et];delete bt[st.id]}},initAttributes:P,enableAttribute:I,disableUnusedAttributes:O}}function Ys(f,t,i,a){const u=a.isWebGL2;let d;this.setMode=function(p){d=p},this.render=function(p,v){f.drawArrays(d,p,v),i.update(v,d,1)},this.renderInstances=function(p,v,_){if(_===0)return;let y,E;if(u)y=f,E="drawArraysInstanced";else if(y=t.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",y===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");y[E](d,p,v,_),i.update(v,d,_)}}function Ao(f,t,i){let a;function u(st){if(st==="highp"){if(f.getShaderPrecisionFormat(35633,36338).precision>0&&f.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";st="mediump"}return st==="mediump"&&f.getShaderPrecisionFormat(35633,36337).precision>0&&f.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const d=typeof WebGL2RenderingContext!="undefined"&&f instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&f instanceof WebGL2ComputeRenderingContext;let p=i.precision!==void 0?i.precision:"highp";const v=u(p);v!==p&&(console.warn("THREE.WebGLRenderer:",p,"not supported, using",v,"instead."),p=v);const _=d||t.has("WEBGL_draw_buffers"),y=i.logarithmicDepthBuffer===!0,E=f.getParameter(34930),A=f.getParameter(35660),M=f.getParameter(3379),P=f.getParameter(34076),I=f.getParameter(34921),N=f.getParameter(36347),O=f.getParameter(36348),V=f.getParameter(36349),Y=A>0,at=d||t.has("OES_texture_float");return{isWebGL2:d,drawBuffers:_,getMaxAnisotropy:function(){if(a!==void 0)return a;if(t.has("EXT_texture_filter_anisotropic")===!0){const st=t.get("EXT_texture_filter_anisotropic");a=f.getParameter(st.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a},getMaxPrecision:u,precision:p,logarithmicDepthBuffer:y,maxTextures:E,maxVertexTextures:A,maxTextureSize:M,maxCubemapSize:P,maxAttributes:I,maxVertexUniforms:N,maxVaryings:O,maxFragmentUniforms:V,vertexTextures:Y,floatFragmentTextures:at,floatVertexTextures:Y&&at,maxSamples:d?f.getParameter(36183):0}}function Fh(f){const t=this;let i=null,a=0,u=!1,d=!1;const p=new Go,v=new Ii,_={value:null,needsUpdate:!1};function y(){_.value!==i&&(_.value=i,_.needsUpdate=a>0),t.numPlanes=a,t.numIntersection=0}function E(A,M,P,I){const N=A!==null?A.length:0;let O=null;if(N!==0){if(O=_.value,I!==!0||O===null){const V=P+4*N,Y=M.matrixWorldInverse;v.getNormalMatrix(Y),(O===null||O.length<V)&&(O=new Float32Array(V));for(let at=0,st=P;at!==N;++at,st+=4)p.copy(A[at]).applyMatrix4(Y,v),p.normal.toArray(O,st),O[st+3]=p.constant}_.value=O,_.needsUpdate=!0}return t.numPlanes=N,t.numIntersection=0,O}this.uniform=_,this.numPlanes=0,this.numIntersection=0,this.init=function(A,M,P){const I=A.length!==0||M||a!==0||u;return u=M,i=E(A,P,0),a=A.length,I},this.beginShadows=function(){d=!0,E(null)},this.endShadows=function(){d=!1,y()},this.setState=function(A,M,P){const I=A.clippingPlanes,N=A.clipIntersection,O=A.clipShadows,V=f.get(A);if(!u||I===null||I.length===0||d&&!O)d?E(null):y();else{const Y=d?0:a,at=4*Y;let st=V.clippingState||null;_.value=st,st=E(I,M,at,P);for(let yt=0;yt!==at;++yt)st[yt]=i[yt];V.clippingState=st,this.numIntersection=N?this.numPlanes:0,this.numPlanes+=Y}}}function Bh(f){let t=new WeakMap;function i(u,d){return d===dt?u.mapping=Q:d===Lt&&(u.mapping=ft),u}function a(u){const d=u.target;d.removeEventListener("dispose",a);const p=t.get(d);p!==void 0&&(t.delete(d),p.dispose())}return{get:function(u){if(u&&u.isTexture){const d=u.mapping;if(d===dt||d===Lt){if(t.has(u))return i(t.get(u).texture,u.mapping);{const p=u.image;if(p&&p.height>0){const v=f.getRenderTarget(),_=new Ds(p.height/2);return _.fromEquirectangularTexture(f,u),t.set(u,_),f.setRenderTarget(v),u.addEventListener("dispose",a),i(_.texture,u.mapping)}return null}}}return u},dispose:function(){t=new WeakMap}}}function Pd(f){const t={};function i(a){if(t[a]!==void 0)return t[a];let u;switch(a){case"WEBGL_depth_texture":u=f.getExtension("WEBGL_depth_texture")||f.getExtension("MOZ_WEBGL_depth_texture")||f.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":u=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":u=f.getExtension("WEBGL_compressed_texture_s3tc")||f.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||f.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":u=f.getExtension("WEBGL_compressed_texture_pvrtc")||f.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:u=f.getExtension(a)}return t[a]=u,u}return{has:function(a){return i(a)!==null},init:function(a){a.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float")},get:function(a){const u=i(a);return u===null&&console.warn("THREE.WebGLRenderer: "+a+" extension not supported."),u}}}function Wl(f,t,i,a){const u={},d=new WeakMap;function p(_){const y=_.target;y.index!==null&&t.remove(y.index);for(const A in y.attributes)t.remove(y.attributes[A]);y.removeEventListener("dispose",p),delete u[y.id];const E=d.get(y);E&&(t.remove(E),d.delete(y)),a.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,i.memory.geometries--}function v(_){const y=[],E=_.index,A=_.attributes.position;let M=0;if(E!==null){const N=E.array;M=E.version;for(let O=0,V=N.length;O<V;O+=3){const Y=N[O+0],at=N[O+1],st=N[O+2];y.push(Y,at,at,st,st,Y)}}else{const N=A.array;M=A.version;for(let O=0,V=N.length/3-1;O<V;O+=3){const Y=O+0,at=O+1,st=O+2;y.push(Y,at,at,st,st,Y)}}const P=new(Hr(y)>65535?Bo:Hl)(y,1);P.version=M;const I=d.get(_);I&&t.remove(I),d.set(_,P)}return{get:function(_,y){return u[y.id]===!0||(y.addEventListener("dispose",p),u[y.id]=!0,i.memory.geometries++),y},update:function(_){const y=_.attributes;for(const A in y)t.update(y[A],34962);const E=_.morphAttributes;for(const A in E){const M=E[A];for(let P=0,I=M.length;P<I;P++)t.update(M[P],34962)}},getWireframeAttribute:function(_){const y=d.get(_);if(y){const E=_.index;E!==null&&y.version<E.version&&v(_)}else v(_);return d.get(_)}}}function Ku(f,t,i,a){const u=a.isWebGL2;let d,p,v;this.setMode=function(_){d=_},this.setIndex=function(_){p=_.type,v=_.bytesPerElement},this.render=function(_,y){f.drawElements(d,y,p,_*v),i.update(y,d,1)},this.renderInstances=function(_,y,E){if(E===0)return;let A,M;if(u)A=f,M="drawElementsInstanced";else if(A=t.get("ANGLE_instanced_arrays"),M="drawElementsInstancedANGLE",A===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");A[M](d,y,p,_*v,E),i.update(y,d,E)}}function Uh(f){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(i,a,u){switch(t.calls++,a){case 4:t.triangles+=u*(i/3);break;case 1:t.lines+=u*(i/2);break;case 3:t.lines+=u*(i-1);break;case 2:t.lines+=u*i;break;case 0:t.points+=u*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}}function Cd(f,t){return f[0]-t[0]}function Rd(f,t){return Math.abs(t[1])-Math.abs(f[1])}function Xl(f){const t={},i=new Float32Array(8),a=[];for(let u=0;u<8;u++)a[u]=[u,0];return{update:function(u,d,p,v){const _=u.morphTargetInfluences,y=_===void 0?0:_.length;let E=t[d.id];if(E===void 0||E.length!==y){E=[];for(let N=0;N<y;N++)E[N]=[N,0];t[d.id]=E}for(let N=0;N<y;N++){const O=E[N];O[0]=N,O[1]=_[N]}E.sort(Rd);for(let N=0;N<8;N++)N<y&&E[N][1]?(a[N][0]=E[N][0],a[N][1]=E[N][1]):(a[N][0]=Number.MAX_SAFE_INTEGER,a[N][1]=0);a.sort(Cd);const A=p.morphTargets&&d.morphAttributes.position,M=p.morphNormals&&d.morphAttributes.normal;let P=0;for(let N=0;N<8;N++){const O=a[N],V=O[0],Y=O[1];V!==Number.MAX_SAFE_INTEGER&&Y?(A&&d.getAttribute("morphTarget"+N)!==A[V]&&d.setAttribute("morphTarget"+N,A[V]),M&&d.getAttribute("morphNormal"+N)!==M[V]&&d.setAttribute("morphNormal"+N,M[V]),i[N]=Y,P+=Y):(A&&d.hasAttribute("morphTarget"+N)===!0&&d.deleteAttribute("morphTarget"+N),M&&d.hasAttribute("morphNormal"+N)===!0&&d.deleteAttribute("morphNormal"+N),i[N]=0)}const I=d.morphTargetsRelative?1:1-P;v.getUniforms().setValue(f,"morphTargetBaseInfluence",I),v.getUniforms().setValue(f,"morphTargetInfluences",i)}}}function kh(f,t,i,a){let u=new WeakMap;function d(p){const v=p.target;v.removeEventListener("dispose",d),i.remove(v.instanceMatrix),v.instanceColor!==null&&i.remove(v.instanceColor)}return{update:function(p){const v=a.render.frame,_=p.geometry,y=t.get(p,_);return u.get(y)!==v&&(t.update(y),u.set(y,v)),p.isInstancedMesh&&(p.hasEventListener("dispose",d)===!1&&p.addEventListener("dispose",d),i.update(p.instanceMatrix,34962),p.instanceColor!==null&&i.update(p.instanceColor,34962)),y},dispose:function(){u=new WeakMap}}}gs.physical={uniforms:Mo([gs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ge(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new pn(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Ge},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new pn(0)}}]),vertexShader:er.meshphysical_vert,fragmentShader:er.meshphysical_frag};class Ga extends ui{constructor(t=null,i=1,a=1,u=1){super(null),this.image={data:t,width:i,height:a,depth:u},this.magFilter=Kt,this.minFilter=Kt,this.wrapR=re,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Ga.prototype.isDataTexture2DArray=!0;class Ha extends ui{constructor(t=null,i=1,a=1,u=1){super(null),this.image={data:t,width:i,height:a,depth:u},this.magFilter=Kt,this.minFilter=Kt,this.wrapR=re,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Ha.prototype.isDataTexture3D=!0;const Gh=new ui,Id=new Ga,Ld=new Ha,Tu=new $u,Hh=[],Ho=[],fa=new Float32Array(16),Su=new Float32Array(9),Ep=new Float32Array(4);function Qu(f,t,i){const a=f[0];if(a<=0||a>0)return f;const u=t*i;let d=Hh[u];if(d===void 0&&(d=new Float32Array(u),Hh[u]=d),t!==0){a.toArray(d,0);for(let p=1,v=0;p!==t;++p)v+=i,f[p].toArray(d,v)}return d}function Po(f,t){if(f.length!==t.length)return!1;for(let i=0,a=f.length;i<a;i++)if(f[i]!==t[i])return!1;return!0}function go(f,t){for(let i=0,a=t.length;i<a;i++)f[i]=t[i]}function zh(f,t){let i=Ho[t];i===void 0&&(i=new Int32Array(t),Ho[t]=i);for(let a=0;a!==t;++a)i[a]=f.allocateTextureUnit();return i}function vs(f,t){const i=this.cache;i[0]!==t&&(f.uniform1f(this.addr,t),i[0]=t)}function Mp(f,t){const i=this.cache;if(t.x!==void 0)i[0]===t.x&&i[1]===t.y||(f.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Po(i,t))return;f.uniform2fv(this.addr,t),go(i,t)}}function Ap(f,t){const i=this.cache;if(t.x!==void 0)i[0]===t.x&&i[1]===t.y&&i[2]===t.z||(f.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)i[0]===t.r&&i[1]===t.g&&i[2]===t.b||(f.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(Po(i,t))return;f.uniform3fv(this.addr,t),go(i,t)}}function Yl(f,t){const i=this.cache;if(t.x!==void 0)i[0]===t.x&&i[1]===t.y&&i[2]===t.z&&i[3]===t.w||(f.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Po(i,t))return;f.uniform4fv(this.addr,t),go(i,t)}}function jh(f,t){const i=this.cache,a=t.elements;if(a===void 0){if(Po(i,t))return;f.uniformMatrix2fv(this.addr,!1,t),go(i,t)}else{if(Po(i,a))return;Ep.set(a),f.uniformMatrix2fv(this.addr,!1,Ep),go(i,a)}}function Fs(f,t){const i=this.cache,a=t.elements;if(a===void 0){if(Po(i,t))return;f.uniformMatrix3fv(this.addr,!1,t),go(i,t)}else{if(Po(i,a))return;Su.set(a),f.uniformMatrix3fv(this.addr,!1,Su),go(i,a)}}function li(f,t){const i=this.cache,a=t.elements;if(a===void 0){if(Po(i,t))return;f.uniformMatrix4fv(this.addr,!1,t),go(i,t)}else{if(Po(i,a))return;fa.set(a),f.uniformMatrix4fv(this.addr,!1,fa),go(i,a)}}function Od(f,t){const i=this.cache;i[0]!==t&&(f.uniform1i(this.addr,t),i[0]=t)}function Dd(f,t){const i=this.cache;Po(i,t)||(f.uniform2iv(this.addr,t),go(i,t))}function Nd(f,t){const i=this.cache;Po(i,t)||(f.uniform3iv(this.addr,t),go(i,t))}function tl(f,t){const i=this.cache;Po(i,t)||(f.uniform4iv(this.addr,t),go(i,t))}function Pp(f,t){const i=this.cache;i[0]!==t&&(f.uniform1ui(this.addr,t),i[0]=t)}function Fd(f,t){const i=this.cache;Po(i,t)||(f.uniform2uiv(this.addr,t),go(i,t))}function Vh(f,t){const i=this.cache;Po(i,t)||(f.uniform3uiv(this.addr,t),go(i,t))}function Ko(f,t){const i=this.cache;Po(i,t)||(f.uniform4uiv(this.addr,t),go(i,t))}function Lc(f,t,i){const a=this.cache,u=i.allocateTextureUnit();a[0]!==u&&(f.uniform1i(this.addr,u),a[0]=u),i.safeSetTexture2D(t||Gh,u)}function hf(f,t,i){const a=this.cache,u=i.allocateTextureUnit();a[0]!==u&&(f.uniform1i(this.addr,u),a[0]=u),i.setTexture3D(t||Ld,u)}function Oc(f,t,i){const a=this.cache,u=i.allocateTextureUnit();a[0]!==u&&(f.uniform1i(this.addr,u),a[0]=u),i.safeSetTextureCube(t||Tu,u)}function Cp(f,t,i){const a=this.cache,u=i.allocateTextureUnit();a[0]!==u&&(f.uniform1i(this.addr,u),a[0]=u),i.setTexture2DArray(t||Id,u)}function Rp(f,t){f.uniform1fv(this.addr,t)}function cf(f,t){const i=Qu(t,this.size,2);f.uniform2fv(this.addr,i)}function Ip(f,t){const i=Qu(t,this.size,3);f.uniform3fv(this.addr,i)}function Dc(f,t){const i=Qu(t,this.size,4);f.uniform4fv(this.addr,i)}function df(f,t){const i=Qu(t,this.size,4);f.uniformMatrix2fv(this.addr,!1,i)}function pf(f,t){const i=Qu(t,this.size,9);f.uniformMatrix3fv(this.addr,!1,i)}function ff(f,t){const i=Qu(t,this.size,16);f.uniformMatrix4fv(this.addr,!1,i)}function mf(f,t){f.uniform1iv(this.addr,t)}function Bd(f,t){f.uniform2iv(this.addr,t)}function Ud(f,t){f.uniform3iv(this.addr,t)}function gf(f,t){f.uniform4iv(this.addr,t)}function vf(f,t){f.uniform1uiv(this.addr,t)}function Lp(f,t){f.uniform2uiv(this.addr,t)}function Nc(f,t){f.uniform3uiv(this.addr,t)}function kd(f,t){f.uniform4uiv(this.addr,t)}function Op(f,t,i){const a=t.length,u=zh(i,a);f.uniform1iv(this.addr,u);for(let d=0;d!==a;++d)i.safeSetTexture2D(t[d]||Gh,u[d])}function Wh(f,t,i){const a=t.length,u=zh(i,a);f.uniform1iv(this.addr,u);for(let d=0;d!==a;++d)i.safeSetTextureCube(t[d]||Tu,u[d])}function Gd(f,t,i){this.id=f,this.addr=i,this.cache=[],this.setValue=function(a){switch(a){case 5126:return vs;case 35664:return Mp;case 35665:return Ap;case 35666:return Yl;case 35674:return jh;case 35675:return Fs;case 35676:return li;case 5124:case 35670:return Od;case 35667:case 35671:return Dd;case 35668:case 35672:return Nd;case 35669:case 35673:return tl;case 5125:return Pp;case 36294:return Fd;case 36295:return Vh;case 36296:return Ko;case 35678:case 36198:case 36298:case 36306:case 35682:return Lc;case 35679:case 36299:case 36307:return hf;case 35680:case 36300:case 36308:case 36293:return Oc;case 36289:case 36303:case 36311:case 36292:return Cp}}(t.type)}function el(f,t,i){this.id=f,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function(a){switch(a){case 5126:return Rp;case 35664:return cf;case 35665:return Ip;case 35666:return Dc;case 35674:return df;case 35675:return pf;case 35676:return ff;case 5124:case 35670:return mf;case 35667:case 35671:return Bd;case 35668:case 35672:return Ud;case 35669:case 35673:return gf;case 5125:return vf;case 36294:return Lp;case 36295:return Nc;case 36296:return kd;case 35678:case 36198:case 36298:case 36306:case 35682:return Op;case 35680:case 36300:case 36308:case 36293:return Wh}}(t.type)}function Fc(f){this.id=f,this.seq=[],this.map={}}el.prototype.updateCache=function(f){const t=this.cache;f instanceof Float32Array&&t.length!==f.length&&(this.cache=new Float32Array(f.length)),go(t,f)},Fc.prototype.setValue=function(f,t,i){const a=this.seq;for(let u=0,d=a.length;u!==d;++u){const p=a[u];p.setValue(f,t[p.id],i)}};const Xh=/(\w+)(\])?(\[|\.)?/g;function ql(f,t){f.seq.push(t),f.map[t.id]=t}function Dp(f,t,i){const a=f.name,u=a.length;for(Xh.lastIndex=0;;){const d=Xh.exec(a),p=Xh.lastIndex;let v=d[1];const _=d[2]==="]",y=d[3];if(_&&(v|=0),y===void 0||y==="["&&p+2===u){ql(i,y===void 0?new Gd(v,f,t):new el(v,f,t));break}{let E=i.map[v];E===void 0&&(E=new Fc(v),ql(i,E)),i=E}}}function za(f,t){this.seq=[],this.map={};const i=f.getProgramParameter(t,35718);for(let a=0;a<i;++a){const u=f.getActiveUniform(t,a);Dp(u,f.getUniformLocation(t,u.name),this)}}function nl(f,t,i){const a=f.createShader(t);return f.shaderSource(a,i),f.compileShader(a),a}za.prototype.setValue=function(f,t,i,a){const u=this.map[t];u!==void 0&&u.setValue(f,i,a)},za.prototype.setOptional=function(f,t,i){const a=t[i];a!==void 0&&this.setValue(f,i,a)},za.upload=function(f,t,i,a){for(let u=0,d=t.length;u!==d;++u){const p=t[u],v=i[p.id];v.needsUpdate!==!1&&p.setValue(f,v.value,a)}},za.seqWithValue=function(f,t){const i=[];for(let a=0,u=f.length;a!==u;++a){const d=f[a];d.id in t&&i.push(d)}return i};let Yh=0;function Bc(f){switch(f){case bo:return["Linear","( value )"];case di:return["sRGB","( value )"];case he:return["RGBE","( value )"];case fe:return["RGBM","( value, 7.0 )"];case Gn:return["RGBM","( value, 16.0 )"];case pr:return["RGBD","( value, 256.0 )"];case Bt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case we:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",f),["Linear","( value )"]}}function qh(f,t,i){const a=f.getShaderParameter(t,35713),u=f.getShaderInfoLog(t).trim();return a&&u===""?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+i+`
`+u+function(d){const p=d.split(`
`);for(let v=0;v<p.length;v++)p[v]=v+1+": "+p[v];return p.join(`
`)}(f.getShaderSource(t))}function Bs(f,t){const i=Bc(t);return"vec4 "+f+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function Zh(f,t){const i=Bc(t);return"vec4 "+f+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function zo(f,t){let i;switch(t){case mi:i="Linear";break;case ws:i="Reinhard";break;case Ln:i="OptimizedCineon";break;case so:i="ACESFilmic";break;case $i:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+f+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Zl(f){return f!==""}function Jl(f,t){return f.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Eu(f,t){return f.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const rr=/^[ \t]*#include +<([\w\d./]+)>/gm;function Hd(f){return f.replace(rr,Co)}function Co(f,t){const i=er[t];if(i===void 0)throw new Error("Can not resolve #include <"+t+">");return Hd(i)}const Ai=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,ja=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Np(f){return f.replace(ja,qs).replace(Ai,Mu)}function Mu(f,t,i,a){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),qs(f,t,i,a)}function qs(f,t,i,a){let u="";for(let d=parseInt(t);d<parseInt(i);d++)u+=a.replace(/\[\s*i\s*\]/g,"[ "+d+" ]").replace(/UNROLLED_LOOP_INDEX/g,d);return u}function Uc(f){let t="precision "+f.precision+` float;
precision `+f.precision+" int;";return f.precision==="highp"?t+=`
#define HIGH_PRECISION`:f.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:f.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function kc(f,t,i,a){const u=f.getContext(),d=i.defines;let p=i.vertexShader,v=i.fragmentShader;const _=function(Et){let Ce="SHADOWMAP_TYPE_BASIC";return Et.shadowMapType===ct?Ce="SHADOWMAP_TYPE_PCF":Et.shadowMapType===Nt?Ce="SHADOWMAP_TYPE_PCF_SOFT":Et.shadowMapType===Xt&&(Ce="SHADOWMAP_TYPE_VSM"),Ce}(i),y=function(Et){let Ce="ENVMAP_TYPE_CUBE";if(Et.envMap)switch(Et.envMapMode){case Q:case ft:Ce="ENVMAP_TYPE_CUBE";break;case Ct:case It:Ce="ENVMAP_TYPE_CUBE_UV"}return Ce}(i),E=function(Et){let Ce="ENVMAP_MODE_REFLECTION";if(Et.envMap)switch(Et.envMapMode){case ft:case It:Ce="ENVMAP_MODE_REFRACTION"}return Ce}(i),A=function(Et){let Ce="ENVMAP_BLENDING_NONE";if(Et.envMap)switch(Et.combine){case Ur:Ce="ENVMAP_BLENDING_MULTIPLY";break;case Xi:Ce="ENVMAP_BLENDING_MIX";break;case Sr:Ce="ENVMAP_BLENDING_ADD"}return Ce}(i),M=f.gammaFactor>0?f.gammaFactor:1,P=i.isWebGL2?"":function(Et){return[Et.extensionDerivatives||Et.envMapCubeUV||Et.bumpMap||Et.tangentSpaceNormalMap||Et.clearcoatNormalMap||Et.flatShading||Et.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(Et.extensionFragDepth||Et.logarithmicDepthBuffer)&&Et.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",Et.extensionDrawBuffers&&Et.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(Et.extensionShaderTextureLOD||Et.envMap||Et.transmission>0)&&Et.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Zl).join(`
`)}(i),I=function(Et){const Ce=[];for(const ge in Et){const ve=Et[ge];ve!==!1&&Ce.push("#define "+ge+" "+ve)}return Ce.join(`
`)}(d),N=u.createProgram();let O,V,Y=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(O=[I].filter(Zl).join(`
`),O.length>0&&(O+=`
`),V=[P,I].filter(Zl).join(`
`),V.length>0&&(V+=`
`)):(O=[Uc(i),"#define SHADER_NAME "+i.shaderName,I,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+M,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+E:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+_:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Zl).join(`
`),V=[P,Uc(i),"#define SHADER_NAME "+i.shaderName,I,i.alphaTest?"#define ALPHATEST "+i.alphaTest+(i.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+M,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+y:"",i.envMap?"#define "+E:"",i.envMap?"#define "+A:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.sheen?"#define USE_SHEEN":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+_:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Lr?"#define TONE_MAPPING":"",i.toneMapping!==Lr?er.tonemapping_pars_fragment:"",i.toneMapping!==Lr?zo("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",er.encodings_pars_fragment,i.map?Bs("mapTexelToLinear",i.mapEncoding):"",i.matcap?Bs("matcapTexelToLinear",i.matcapEncoding):"",i.envMap?Bs("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMap?Bs("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.lightMap?Bs("lightMapTexelToLinear",i.lightMapEncoding):"",Zh("linearToOutputTexel",i.outputEncoding),i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Zl).join(`
`)),p=Hd(p),p=Jl(p,i),p=Eu(p,i),v=Hd(v),v=Jl(v,i),v=Eu(v,i),p=Np(p),v=Np(v),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(Y=`#version 300 es
`,O=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+O,V=["#define varying in",i.glslVersion===Ca?"":"out highp vec4 pc_fragColor;",i.glslVersion===Ca?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+V);const at=Y+V+v,st=nl(u,35633,Y+O+p),yt=nl(u,35632,at);if(u.attachShader(N,st),u.attachShader(N,yt),i.index0AttributeName!==void 0?u.bindAttribLocation(N,0,i.index0AttributeName):i.morphTargets===!0&&u.bindAttribLocation(N,0,"position"),u.linkProgram(N),f.debug.checkShaderErrors){const Et=u.getProgramInfoLog(N).trim(),Ce=u.getShaderInfoLog(st).trim(),ge=u.getShaderInfoLog(yt).trim();let ve=!0,ce=!0;if(u.getProgramParameter(N,35714)===!1){ve=!1;const Ot=qh(u,st,"vertex"),ee=qh(u,yt,"fragment");console.error("THREE.WebGLProgram: shader error: ",u.getError(),"35715",u.getProgramParameter(N,35715),"gl.getProgramInfoLog",Et,Ot,ee)}else Et!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",Et):Ce!==""&&ge!==""||(ce=!1);ce&&(this.diagnostics={runnable:ve,programLog:Et,vertexShader:{log:Ce,prefix:O},fragmentShader:{log:ge,prefix:V}})}let bt,_t;return u.deleteShader(st),u.deleteShader(yt),this.getUniforms=function(){return bt===void 0&&(bt=new za(u,N)),bt},this.getAttributes=function(){return _t===void 0&&(_t=function(Et,Ce){const ge={},ve=Et.getProgramParameter(Ce,35721);for(let ce=0;ce<ve;ce++){const Ot=Et.getActiveAttrib(Ce,ce).name;ge[Ot]=Et.getAttribLocation(Ce,Ot)}return ge}(u,N)),_t},this.destroy=function(){a.releaseStatesOfProgram(this),u.deleteProgram(N),this.program=void 0},this.name=i.shaderName,this.id=Yh++,this.cacheKey=t,this.usedTimes=1,this.program=N,this.vertexShader=st,this.fragmentShader=yt,this}function pi(f,t,i,a,u,d){const p=[],v=a.isWebGL2,_=a.logarithmicDepthBuffer,y=a.floatVertexTextures,E=a.maxVertexUniforms,A=a.vertexTextures;let M=a.precision;const P={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},I=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmission","transmissionMap","thicknessMap"];function N(O){let V;return O&&O.isTexture?V=O.encoding:O&&O.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),V=O.texture.encoding):V=bo,V}return{getParameters:function(O,V,Y,at,st){const yt=at.fog,bt=O.isMeshStandardMaterial?at.environment:null,_t=t.get(O.envMap||bt),Et=P[O.type],Ce=st.isSkinnedMesh?function(Ot){const ee=Ot.skeleton.bones;if(y)return 1024;{const We=E,ze=Math.floor((We-20)/4),Ue=Math.min(ze,ee.length);return Ue<ee.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+ee.length+" bones. This GPU supports "+Ue+"."),0):Ue}}(st):0;let ge,ve;if(O.precision!==null&&(M=a.getMaxPrecision(O.precision),M!==O.precision&&console.warn("THREE.WebGLProgram.getParameters:",O.precision,"not supported, using",M,"instead.")),Et){const Ot=gs[Et];ge=Ot.vertexShader,ve=Ot.fragmentShader}else ge=O.vertexShader,ve=O.fragmentShader;const ce=f.getRenderTarget();return{isWebGL2:v,shaderID:Et,shaderName:O.type,vertexShader:ge,fragmentShader:ve,defines:O.defines,isRawShaderMaterial:O.isRawShaderMaterial===!0,glslVersion:O.glslVersion,precision:M,instancing:st.isInstancedMesh===!0,instancingColor:st.isInstancedMesh===!0&&st.instanceColor!==null,supportsVertexTextures:A,outputEncoding:ce!==null?N(ce.texture):f.outputEncoding,map:!!O.map,mapEncoding:N(O.map),matcap:!!O.matcap,matcapEncoding:N(O.matcap),envMap:!!_t,envMapMode:_t&&_t.mapping,envMapEncoding:N(_t),envMapCubeUV:!!_t&&(_t.mapping===Ct||_t.mapping===It),lightMap:!!O.lightMap,lightMapEncoding:N(O.lightMap),aoMap:!!O.aoMap,emissiveMap:!!O.emissiveMap,emissiveMapEncoding:N(O.emissiveMap),bumpMap:!!O.bumpMap,normalMap:!!O.normalMap,objectSpaceNormalMap:O.normalMapType===Cl,tangentSpaceNormalMap:O.normalMapType===Cr,clearcoatMap:!!O.clearcoatMap,clearcoatRoughnessMap:!!O.clearcoatRoughnessMap,clearcoatNormalMap:!!O.clearcoatNormalMap,displacementMap:!!O.displacementMap,roughnessMap:!!O.roughnessMap,metalnessMap:!!O.metalnessMap,specularMap:!!O.specularMap,alphaMap:!!O.alphaMap,gradientMap:!!O.gradientMap,sheen:!!O.sheen,transmission:!!O.transmission,transmissionMap:!!O.transmissionMap,thicknessMap:!!O.thicknessMap,combine:O.combine,vertexTangents:O.normalMap&&O.vertexTangents,vertexColors:O.vertexColors,vertexAlphas:O.vertexColors===!0&&st.geometry&&st.geometry.attributes.color&&st.geometry.attributes.color.itemSize===4,vertexUvs:!!(O.map||O.bumpMap||O.normalMap||O.specularMap||O.alphaMap||O.emissiveMap||O.roughnessMap||O.metalnessMap||O.clearcoatMap||O.clearcoatRoughnessMap||O.clearcoatNormalMap||O.displacementMap||O.transmissionMap||O.thicknessMap),uvsVertexOnly:!(O.map||O.bumpMap||O.normalMap||O.specularMap||O.alphaMap||O.emissiveMap||O.roughnessMap||O.metalnessMap||O.clearcoatNormalMap||O.transmission||O.transmissionMap||O.thicknessMap||!O.displacementMap),fog:!!yt,useFog:O.fog,fogExp2:yt&&yt.isFogExp2,flatShading:!!O.flatShading,sizeAttenuation:O.sizeAttenuation,logarithmicDepthBuffer:_,skinning:st.isSkinnedMesh===!0&&Ce>0,maxBones:Ce,useVertexTexture:y,morphTargets:O.morphTargets,morphNormals:O.morphNormals,numDirLights:V.directional.length,numPointLights:V.point.length,numSpotLights:V.spot.length,numRectAreaLights:V.rectArea.length,numHemiLights:V.hemi.length,numDirLightShadows:V.directionalShadowMap.length,numPointLightShadows:V.pointShadowMap.length,numSpotLightShadows:V.spotShadowMap.length,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:O.dithering,shadowMapEnabled:f.shadowMap.enabled&&Y.length>0,shadowMapType:f.shadowMap.type,toneMapping:O.toneMapped?f.toneMapping:Lr,physicallyCorrectLights:f.physicallyCorrectLights,premultipliedAlpha:O.premultipliedAlpha,alphaTest:O.alphaTest,doubleSided:O.side===F,flipSided:O.side===L,depthPacking:O.depthPacking!==void 0&&O.depthPacking,index0AttributeName:O.index0AttributeName,extensionDerivatives:O.extensions&&O.extensions.derivatives,extensionFragDepth:O.extensions&&O.extensions.fragDepth,extensionDrawBuffers:O.extensions&&O.extensions.drawBuffers,extensionShaderTextureLOD:O.extensions&&O.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||i.has("EXT_shader_texture_lod"),customProgramCacheKey:O.customProgramCacheKey()}},getProgramCacheKey:function(O){const V=[];if(O.shaderID?V.push(O.shaderID):(V.push(O.fragmentShader),V.push(O.vertexShader)),O.defines!==void 0)for(const Y in O.defines)V.push(Y),V.push(O.defines[Y]);if(O.isRawShaderMaterial===!1){for(let Y=0;Y<I.length;Y++)V.push(O[I[Y]]);V.push(f.outputEncoding),V.push(f.gammaFactor)}return V.push(O.customProgramCacheKey),V.join()},getUniforms:function(O){const V=P[O.type];let Y;if(V){const at=gs[V];Y=Sd.clone(at.uniforms)}else Y=O.uniforms;return Y},acquireProgram:function(O,V){let Y;for(let at=0,st=p.length;at<st;at++){const yt=p[at];if(yt.cacheKey===V){Y=yt,++Y.usedTimes;break}}return Y===void 0&&(Y=new kc(f,V,O,u),p.push(Y)),Y},releaseProgram:function(O){if(--O.usedTimes==0){const V=p.indexOf(O);p[V]=p[p.length-1],p.pop(),O.destroy()}},programs:p}}function wi(){let f=new WeakMap;return{get:function(t){let i=f.get(t);return i===void 0&&(i={},f.set(t,i)),i},remove:function(t){f.delete(t)},update:function(t,i,a){f.get(t)[i]=a},dispose:function(){f=new WeakMap}}}function Fp(f,t){return f.groupOrder!==t.groupOrder?f.groupOrder-t.groupOrder:f.renderOrder!==t.renderOrder?f.renderOrder-t.renderOrder:f.program!==t.program?f.program.id-t.program.id:f.material.id!==t.material.id?f.material.id-t.material.id:f.z!==t.z?f.z-t.z:f.id-t.id}function Gc(f,t){return f.groupOrder!==t.groupOrder?f.groupOrder-t.groupOrder:f.renderOrder!==t.renderOrder?f.renderOrder-t.renderOrder:f.z!==t.z?t.z-f.z:f.id-t.id}function rl(f){const t=[];let i=0;const a=[],u=[],d=[],p={id:-1};function v(_,y,E,A,M,P){let I=t[i];const N=f.get(E);return I===void 0?(I={id:_.id,object:_,geometry:y,material:E,program:N.program||p,groupOrder:A,renderOrder:_.renderOrder,z:M,group:P},t[i]=I):(I.id=_.id,I.object=_,I.geometry=y,I.material=E,I.program=N.program||p,I.groupOrder=A,I.renderOrder=_.renderOrder,I.z=M,I.group=P),i++,I}return{opaque:a,transmissive:u,transparent:d,init:function(){i=0,a.length=0,u.length=0,d.length=0},push:function(_,y,E,A,M,P){const I=v(_,y,E,A,M,P);E.transmission>0?u.push(I):E.transparent===!0?d.push(I):a.push(I)},unshift:function(_,y,E,A,M,P){const I=v(_,y,E,A,M,P);E.transmission>0?u.unshift(I):E.transparent===!0?d.unshift(I):a.unshift(I)},finish:function(){for(let _=i,y=t.length;_<y;_++){const E=t[_];if(E.id===null)break;E.id=null,E.object=null,E.geometry=null,E.material=null,E.program=null,E.group=null}},sort:function(_,y){a.length>1&&a.sort(_||Fp),u.length>1&&u.sort(y||Gc),d.length>1&&d.sort(y||Gc)}}}function Hc(f){let t=new WeakMap;return{get:function(i,a){let u;return t.has(i)===!1?(u=new rl(f),t.set(i,[u])):a>=t.get(i).length?(u=new rl(f),t.get(i).push(u)):u=t.get(i)[a],u},dispose:function(){t=new WeakMap}}}function zd(){const f={};return{get:function(t){if(f[t.id]!==void 0)return f[t.id];let i;switch(t.type){case"DirectionalLight":i={direction:new ot,color:new pn};break;case"SpotLight":i={position:new ot,direction:new ot,color:new pn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new ot,color:new pn,distance:0,decay:0};break;case"HemisphereLight":i={direction:new ot,skyColor:new pn,groundColor:new pn};break;case"RectAreaLight":i={color:new pn,position:new ot,halfWidth:new ot,halfHeight:new ot}}return f[t.id]=i,i}}}let Jh=0;function Qo(f,t){return(t.castShadow?1:0)-(f.castShadow?1:0)}function il(f,t){const i=new zd,a=function(){const _={};return{get:function(y){if(_[y.id]!==void 0)return _[y.id];let E;switch(y.type){case"DirectionalLight":case"SpotLight":E={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ge};break;case"PointLight":E={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ge,shadowCameraNear:1,shadowCameraFar:1e3}}return _[y.id]=E,E}}}(),u={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let _=0;_<9;_++)u.probe.push(new ot);const d=new ot,p=new wn,v=new wn;return{setup:function(_){let y=0,E=0,A=0;for(let yt=0;yt<9;yt++)u.probe[yt].set(0,0,0);let M=0,P=0,I=0,N=0,O=0,V=0,Y=0,at=0;_.sort(Qo);for(let yt=0,bt=_.length;yt<bt;yt++){const _t=_[yt],Et=_t.color,Ce=_t.intensity,ge=_t.distance,ve=_t.shadow&&_t.shadow.map?_t.shadow.map.texture:null;if(_t.isAmbientLight)y+=Et.r*Ce,E+=Et.g*Ce,A+=Et.b*Ce;else if(_t.isLightProbe)for(let ce=0;ce<9;ce++)u.probe[ce].addScaledVector(_t.sh.coefficients[ce],Ce);else if(_t.isDirectionalLight){const ce=i.get(_t);if(ce.color.copy(_t.color).multiplyScalar(_t.intensity),_t.castShadow){const Ot=_t.shadow,ee=a.get(_t);ee.shadowBias=Ot.bias,ee.shadowNormalBias=Ot.normalBias,ee.shadowRadius=Ot.radius,ee.shadowMapSize=Ot.mapSize,u.directionalShadow[M]=ee,u.directionalShadowMap[M]=ve,u.directionalShadowMatrix[M]=_t.shadow.matrix,V++}u.directional[M]=ce,M++}else if(_t.isSpotLight){const ce=i.get(_t);if(ce.position.setFromMatrixPosition(_t.matrixWorld),ce.color.copy(Et).multiplyScalar(Ce),ce.distance=ge,ce.coneCos=Math.cos(_t.angle),ce.penumbraCos=Math.cos(_t.angle*(1-_t.penumbra)),ce.decay=_t.decay,_t.castShadow){const Ot=_t.shadow,ee=a.get(_t);ee.shadowBias=Ot.bias,ee.shadowNormalBias=Ot.normalBias,ee.shadowRadius=Ot.radius,ee.shadowMapSize=Ot.mapSize,u.spotShadow[I]=ee,u.spotShadowMap[I]=ve,u.spotShadowMatrix[I]=_t.shadow.matrix,at++}u.spot[I]=ce,I++}else if(_t.isRectAreaLight){const ce=i.get(_t);ce.color.copy(Et).multiplyScalar(Ce),ce.halfWidth.set(.5*_t.width,0,0),ce.halfHeight.set(0,.5*_t.height,0),u.rectArea[N]=ce,N++}else if(_t.isPointLight){const ce=i.get(_t);if(ce.color.copy(_t.color).multiplyScalar(_t.intensity),ce.distance=_t.distance,ce.decay=_t.decay,_t.castShadow){const Ot=_t.shadow,ee=a.get(_t);ee.shadowBias=Ot.bias,ee.shadowNormalBias=Ot.normalBias,ee.shadowRadius=Ot.radius,ee.shadowMapSize=Ot.mapSize,ee.shadowCameraNear=Ot.camera.near,ee.shadowCameraFar=Ot.camera.far,u.pointShadow[P]=ee,u.pointShadowMap[P]=ve,u.pointShadowMatrix[P]=_t.shadow.matrix,Y++}u.point[P]=ce,P++}else if(_t.isHemisphereLight){const ce=i.get(_t);ce.skyColor.copy(_t.color).multiplyScalar(Ce),ce.groundColor.copy(_t.groundColor).multiplyScalar(Ce),u.hemi[O]=ce,O++}}N>0&&(t.isWebGL2||f.has("OES_texture_float_linear")===!0?(u.rectAreaLTC1=Ze.LTC_FLOAT_1,u.rectAreaLTC2=Ze.LTC_FLOAT_2):f.has("OES_texture_half_float_linear")===!0?(u.rectAreaLTC1=Ze.LTC_HALF_1,u.rectAreaLTC2=Ze.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),u.ambient[0]=y,u.ambient[1]=E,u.ambient[2]=A;const st=u.hash;st.directionalLength===M&&st.pointLength===P&&st.spotLength===I&&st.rectAreaLength===N&&st.hemiLength===O&&st.numDirectionalShadows===V&&st.numPointShadows===Y&&st.numSpotShadows===at||(u.directional.length=M,u.spot.length=I,u.rectArea.length=N,u.point.length=P,u.hemi.length=O,u.directionalShadow.length=V,u.directionalShadowMap.length=V,u.pointShadow.length=Y,u.pointShadowMap.length=Y,u.spotShadow.length=at,u.spotShadowMap.length=at,u.directionalShadowMatrix.length=V,u.pointShadowMatrix.length=Y,u.spotShadowMatrix.length=at,st.directionalLength=M,st.pointLength=P,st.spotLength=I,st.rectAreaLength=N,st.hemiLength=O,st.numDirectionalShadows=V,st.numPointShadows=Y,st.numSpotShadows=at,u.version=Jh++)},setupView:function(_,y){let E=0,A=0,M=0,P=0,I=0;const N=y.matrixWorldInverse;for(let O=0,V=_.length;O<V;O++){const Y=_[O];if(Y.isDirectionalLight){const at=u.directional[E];at.direction.setFromMatrixPosition(Y.matrixWorld),d.setFromMatrixPosition(Y.target.matrixWorld),at.direction.sub(d),at.direction.transformDirection(N),E++}else if(Y.isSpotLight){const at=u.spot[M];at.position.setFromMatrixPosition(Y.matrixWorld),at.position.applyMatrix4(N),at.direction.setFromMatrixPosition(Y.matrixWorld),d.setFromMatrixPosition(Y.target.matrixWorld),at.direction.sub(d),at.direction.transformDirection(N),M++}else if(Y.isRectAreaLight){const at=u.rectArea[P];at.position.setFromMatrixPosition(Y.matrixWorld),at.position.applyMatrix4(N),v.identity(),p.copy(Y.matrixWorld),p.premultiply(N),v.extractRotation(p),at.halfWidth.set(.5*Y.width,0,0),at.halfHeight.set(0,.5*Y.height,0),at.halfWidth.applyMatrix4(v),at.halfHeight.applyMatrix4(v),P++}else if(Y.isPointLight){const at=u.point[A];at.position.setFromMatrixPosition(Y.matrixWorld),at.position.applyMatrix4(N),A++}else if(Y.isHemisphereLight){const at=u.hemi[I];at.direction.setFromMatrixPosition(Y.matrixWorld),at.direction.transformDirection(N),at.direction.normalize(),I++}}},state:u}}function jd(f,t){const i=new il(f,t),a=[],u=[];return{init:function(){a.length=0,u.length=0},state:{lightsArray:a,shadowsArray:u,lights:i},setupLights:function(){i.setup(a)},setupLightsView:function(d){i.setupView(a,d)},pushLight:function(d){a.push(d)},pushShadow:function(d){u.push(d)}}}function Bp(f,t){let i=new WeakMap;return{get:function(a,u=0){let d;return i.has(a)===!1?(d=new jd(f,t),i.set(a,[d])):u>=i.get(a).length?(d=new jd(f,t),i.get(a).push(d)):d=i.get(a)[u],d},dispose:function(){i=new WeakMap}}}class $l extends zi{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=Gi,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}$l.prototype.isMeshDepthMaterial=!0;class _s extends zi{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new ot,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}_s.prototype.isMeshDistanceMaterial=!0;function hr(f,t,i){let a=new ka;const u=new Ge,d=new Ge,p=new Rr,v=[],_=[],y={},E=i.maxTextureSize,A={0:L,1:Gt,2:F},M=new fo({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ge},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),P=M.clone();P.defines.HORIZONTAL_PASS=1;const I=new Hn;I.setAttribute("position",new yr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const N=new Ni(I,M),O=this;function V(bt,_t){const Et=t.update(N);M.uniforms.shadow_pass.value=bt.map.texture,M.uniforms.resolution.value=bt.mapSize,M.uniforms.radius.value=bt.radius,f.setRenderTarget(bt.mapPass),f.clear(),f.renderBufferDirect(_t,null,Et,M,N,null),P.uniforms.shadow_pass.value=bt.mapPass.texture,P.uniforms.resolution.value=bt.mapSize,P.uniforms.radius.value=bt.radius,f.setRenderTarget(bt.map),f.clear(),f.renderBufferDirect(_t,null,Et,P,N,null)}function Y(bt){const _t=bt<<0;let Et=v[_t];return Et===void 0&&(Et=new $l({depthPacking:fr,morphTargets:bt}),v[_t]=Et),Et}function at(bt){const _t=bt<<0;let Et=_[_t];return Et===void 0&&(Et=new _s({morphTargets:bt}),_[_t]=Et),Et}function st(bt,_t,Et,Ce,ge,ve,ce){let Ot=null,ee=Y,We=bt.customDepthMaterial;if(Ce.isPointLight===!0&&(ee=at,We=bt.customDistanceMaterial),We===void 0){let ze=!1;Et.morphTargets===!0&&(ze=_t.morphAttributes&&_t.morphAttributes.position&&_t.morphAttributes.position.length>0),Ot=ee(ze)}else Ot=We;if(f.localClippingEnabled&&Et.clipShadows===!0&&Et.clippingPlanes.length!==0){const ze=Ot.uuid,Ue=Et.uuid;let fn=y[ze];fn===void 0&&(fn={},y[ze]=fn);let vn=fn[Ue];vn===void 0&&(vn=Ot.clone(),fn[Ue]=vn),Ot=vn}return Ot.visible=Et.visible,Ot.wireframe=Et.wireframe,Ot.side=ce===Xt?Et.shadowSide!==null?Et.shadowSide:Et.side:Et.shadowSide!==null?Et.shadowSide:A[Et.side],Ot.clipShadows=Et.clipShadows,Ot.clippingPlanes=Et.clippingPlanes,Ot.clipIntersection=Et.clipIntersection,Ot.wireframeLinewidth=Et.wireframeLinewidth,Ot.linewidth=Et.linewidth,Ce.isPointLight===!0&&Ot.isMeshDistanceMaterial===!0&&(Ot.referencePosition.setFromMatrixPosition(Ce.matrixWorld),Ot.nearDistance=ge,Ot.farDistance=ve),Ot}function yt(bt,_t,Et,Ce,ge){if(bt.visible===!1)return;if(bt.layers.test(_t.layers)&&(bt.isMesh||bt.isLine||bt.isPoints)&&(bt.castShadow||bt.receiveShadow&&ge===Xt)&&(!bt.frustumCulled||a.intersectsObject(bt))){bt.modelViewMatrix.multiplyMatrices(Et.matrixWorldInverse,bt.matrixWorld);const ce=t.update(bt),Ot=bt.material;if(Array.isArray(Ot)){const ee=ce.groups;for(let We=0,ze=ee.length;We<ze;We++){const Ue=ee[We],fn=Ot[Ue.materialIndex];if(fn&&fn.visible){const vn=st(bt,ce,fn,Ce,Et.near,Et.far,ge);f.renderBufferDirect(Et,null,ce,vn,bt,Ue)}}}else if(Ot.visible){const ee=st(bt,ce,Ot,Ce,Et.near,Et.far,ge);f.renderBufferDirect(Et,null,ce,ee,bt,null)}}const ve=bt.children;for(let ce=0,Ot=ve.length;ce<Ot;ce++)yt(ve[ce],_t,Et,Ce,ge)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ct,this.render=function(bt,_t,Et){if(O.enabled===!1||O.autoUpdate===!1&&O.needsUpdate===!1||bt.length===0)return;const Ce=f.getRenderTarget(),ge=f.getActiveCubeFace(),ve=f.getActiveMipmapLevel(),ce=f.state;ce.setBlending(k),ce.buffers.color.setClear(1,1,1,1),ce.buffers.depth.setTest(!0),ce.setScissorTest(!1);for(let Ot=0,ee=bt.length;Ot<ee;Ot++){const We=bt[Ot],ze=We.shadow;if(ze===void 0){console.warn("THREE.WebGLShadowMap:",We,"has no shadow.");continue}if(ze.autoUpdate===!1&&ze.needsUpdate===!1)continue;u.copy(ze.mapSize);const Ue=ze.getFrameExtents();if(u.multiply(Ue),d.copy(ze.mapSize),(u.x>E||u.y>E)&&(u.x>E&&(d.x=Math.floor(E/Ue.x),u.x=d.x*Ue.x,ze.mapSize.x=d.x),u.y>E&&(d.y=Math.floor(E/Ue.y),u.y=d.y*Ue.y,ze.mapSize.y=d.y)),ze.map===null&&!ze.isPointLightShadow&&this.type===Xt){const vn={minFilter:Un,magFilter:Un,format:Sn};ze.map=new To(u.x,u.y,vn),ze.map.texture.name=We.name+".shadowMap",ze.mapPass=new To(u.x,u.y,vn),ze.camera.updateProjectionMatrix()}if(ze.map===null){const vn={minFilter:Kt,magFilter:Kt,format:Sn};ze.map=new To(u.x,u.y,vn),ze.map.texture.name=We.name+".shadowMap",ze.camera.updateProjectionMatrix()}f.setRenderTarget(ze.map),f.clear();const fn=ze.getViewportCount();for(let vn=0;vn<fn;vn++){const En=ze.getViewport(vn);p.set(d.x*En.x,d.y*En.y,d.x*En.z,d.y*En.w),ce.viewport(p),ze.updateMatrices(We,vn),a=ze.getFrustum(),yt(_t,Et,ze.camera,We,this.type)}ze.isPointLightShadow||this.type!==Xt||V(ze,Et),ze.needsUpdate=!1}O.needsUpdate=!1,f.setRenderTarget(Ce,ge,ve)}}function Vd(f,t,i){const a=i.isWebGL2,u=new function(){let pt=!1;const Ut=new Rr;let be=null;const Ae=new Rr(0,0,0,0);return{setMask:function(ye){be===ye||pt||(f.colorMask(ye,ye,ye,ye),be=ye)},setLocked:function(ye){pt=ye},setClear:function(ye,xn,zn,In,wr){wr===!0&&(ye*=In,xn*=In,zn*=In),Ut.set(ye,xn,zn,In),Ae.equals(Ut)===!1&&(f.clearColor(ye,xn,zn,In),Ae.copy(Ut))},reset:function(){pt=!1,be=null,Ae.set(-1,0,0,0)}}},d=new function(){let pt=!1,Ut=null,be=null,Ae=null;return{setTest:function(ye){ye?Tn(2929):wt(2929)},setMask:function(ye){Ut===ye||pt||(f.depthMask(ye),Ut=ye)},setFunc:function(ye){if(be!==ye){if(ye)switch(ye){case kn:f.depthFunc(512);break;case qn:f.depthFunc(519);break;case bn:f.depthFunc(513);break;case Nr:f.depthFunc(515);break;case kr:f.depthFunc(514);break;case Ir:f.depthFunc(518);break;case Jr:f.depthFunc(516);break;case Pr:f.depthFunc(517);break;default:f.depthFunc(515)}else f.depthFunc(515);be=ye}},setLocked:function(ye){pt=ye},setClear:function(ye){Ae!==ye&&(f.clearDepth(ye),Ae=ye)},reset:function(){pt=!1,Ut=null,be=null,Ae=null}}},p=new function(){let pt=!1,Ut=null,be=null,Ae=null,ye=null,xn=null,zn=null,In=null,wr=null;return{setTest:function(Tr){pt||(Tr?Tn(2960):wt(2960))},setMask:function(Tr){Ut===Tr||pt||(f.stencilMask(Tr),Ut=Tr)},setFunc:function(Tr,Vo,Ti){be===Tr&&Ae===Vo&&ye===Ti||(f.stencilFunc(Tr,Vo,Ti),be=Tr,Ae=Vo,ye=Ti)},setOp:function(Tr,Vo,Ti){xn===Tr&&zn===Vo&&In===Ti||(f.stencilOp(Tr,Vo,Ti),xn=Tr,zn=Vo,In=Ti)},setLocked:function(Tr){pt=Tr},setClear:function(Tr){wr!==Tr&&(f.clearStencil(Tr),wr=Tr)},reset:function(){pt=!1,Ut=null,be=null,Ae=null,ye=null,xn=null,zn=null,In=null,wr=null}}};let v={},_=null,y={},E=null,A=!1,M=null,P=null,I=null,N=null,O=null,V=null,Y=null,at=!1,st=null,yt=null,bt=null,_t=null,Et=null;const Ce=f.getParameter(35661);let ge=!1,ve=0;const ce=f.getParameter(7938);ce.indexOf("WebGL")!==-1?(ve=parseFloat(/^WebGL (\d)/.exec(ce)[1]),ge=ve>=1):ce.indexOf("OpenGL ES")!==-1&&(ve=parseFloat(/^OpenGL ES (\d)/.exec(ce)[1]),ge=ve>=2);let Ot=null,ee={};const We=f.getParameter(3088),ze=f.getParameter(2978),Ue=new Rr().fromArray(We),fn=new Rr().fromArray(ze);function vn(pt,Ut,be){const Ae=new Uint8Array(4),ye=f.createTexture();f.bindTexture(pt,ye),f.texParameteri(pt,10241,9728),f.texParameteri(pt,10240,9728);for(let xn=0;xn<be;xn++)f.texImage2D(Ut+xn,0,6408,1,1,0,6408,5121,Ae);return ye}const En={};function Tn(pt){v[pt]!==!0&&(f.enable(pt),v[pt]=!0)}function wt(pt){v[pt]!==!1&&(f.disable(pt),v[pt]=!1)}En[3553]=vn(3553,3553,1),En[34067]=vn(34067,34069,6),u.setClear(0,0,0,1),d.setClear(1),p.setClear(0),Tn(2929),d.setFunc(Nr),se(!1),nn(W),Tn(2884),Ne(k);const Mt={[te]:32774,[xt]:32778,[zt]:32779};if(a)Mt[Vt]=32775,Mt[$]=32776;else{const pt=t.get("EXT_blend_minmax");pt!==null&&(Mt[Vt]=pt.MIN_EXT,Mt[$]=pt.MAX_EXT)}const De={[Dt]:0,[Ht]:1,[Yt]:768,[Qt]:770,[Kn]:776,[$n]:774,[Ke]:772,[kt]:769,[de]:771,[Qe]:775,[ke]:773};function Ne(pt,Ut,be,Ae,ye,xn,zn,In){if(pt!==k){if(A===!1&&(Tn(3042),A=!0),pt===je)ye=ye||Ut,xn=xn||be,zn=zn||Ae,Ut===P&&ye===O||(f.blendEquationSeparate(Mt[Ut],Mt[ye]),P=Ut,O=ye),be===I&&Ae===N&&xn===V&&zn===Y||(f.blendFuncSeparate(De[be],De[Ae],De[xn],De[zn]),I=be,N=Ae,V=xn,Y=zn),M=pt,at=null;else if(pt!==M||In!==at){if(P===te&&O===te||(f.blendEquation(32774),P=te,O=te),In)switch(pt){case X:f.blendFuncSeparate(1,771,1,771);break;case tt:f.blendFunc(1,1);break;case ht:f.blendFuncSeparate(0,0,769,771);break;case ue:f.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",pt)}else switch(pt){case X:f.blendFuncSeparate(770,771,1,771);break;case tt:f.blendFunc(770,1);break;case ht:f.blendFunc(0,769);break;case ue:f.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",pt)}I=null,N=null,V=null,Y=null,M=pt,at=In}}else A===!0&&(wt(3042),A=!1)}function se(pt){st!==pt&&(pt?f.frontFace(2304):f.frontFace(2305),st=pt)}function nn(pt){pt!==Z?(Tn(2884),pt!==yt&&(pt===W?f.cullFace(1029):pt===mt?f.cullFace(1028):f.cullFace(1032))):wt(2884),yt=pt}function rn(pt,Ut,be){pt?(Tn(32823),_t===Ut&&Et===be||(f.polygonOffset(Ut,be),_t=Ut,Et=be)):wt(32823)}function _e(pt){pt===void 0&&(pt=33984+Ce-1),Ot!==pt&&(f.activeTexture(pt),Ot=pt)}return{buffers:{color:u,depth:d,stencil:p},enable:Tn,disable:wt,bindFramebuffer:function(pt,Ut){return Ut===null&&_!==null&&(Ut=_),y[pt]!==Ut&&(f.bindFramebuffer(pt,Ut),y[pt]=Ut,a&&(pt===36009&&(y[36160]=Ut),pt===36160&&(y[36009]=Ut)),!0)},bindXRFramebuffer:function(pt){pt!==_&&(f.bindFramebuffer(36160,pt),_=pt)},useProgram:function(pt){return E!==pt&&(f.useProgram(pt),E=pt,!0)},setBlending:Ne,setMaterial:function(pt,Ut){pt.side===F?wt(2884):Tn(2884);let be=pt.side===L;Ut&&(be=!be),se(be),pt.blending===X&&pt.transparent===!1?Ne(k):Ne(pt.blending,pt.blendEquation,pt.blendSrc,pt.blendDst,pt.blendEquationAlpha,pt.blendSrcAlpha,pt.blendDstAlpha,pt.premultipliedAlpha),d.setFunc(pt.depthFunc),d.setTest(pt.depthTest),d.setMask(pt.depthWrite),u.setMask(pt.colorWrite);const Ae=pt.stencilWrite;p.setTest(Ae),Ae&&(p.setMask(pt.stencilWriteMask),p.setFunc(pt.stencilFunc,pt.stencilRef,pt.stencilFuncMask),p.setOp(pt.stencilFail,pt.stencilZFail,pt.stencilZPass)),rn(pt.polygonOffset,pt.polygonOffsetFactor,pt.polygonOffsetUnits),pt.alphaToCoverage===!0?Tn(32926):wt(32926)},setFlipSided:se,setCullFace:nn,setLineWidth:function(pt){pt!==bt&&(ge&&f.lineWidth(pt),bt=pt)},setPolygonOffset:rn,setScissorTest:function(pt){pt?Tn(3089):wt(3089)},activeTexture:_e,bindTexture:function(pt,Ut){Ot===null&&_e();let be=ee[Ot];be===void 0&&(be={type:void 0,texture:void 0},ee[Ot]=be),be.type===pt&&be.texture===Ut||(f.bindTexture(pt,Ut||En[pt]),be.type=pt,be.texture=Ut)},unbindTexture:function(){const pt=ee[Ot];pt!==void 0&&pt.type!==void 0&&(f.bindTexture(pt.type,null),pt.type=void 0,pt.texture=void 0)},compressedTexImage2D:function(){try{f.compressedTexImage2D.apply(f,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}},texImage2D:function(){try{f.texImage2D.apply(f,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}},texImage3D:function(){try{f.texImage3D.apply(f,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}},scissor:function(pt){Ue.equals(pt)===!1&&(f.scissor(pt.x,pt.y,pt.z,pt.w),Ue.copy(pt))},viewport:function(pt){fn.equals(pt)===!1&&(f.viewport(pt.x,pt.y,pt.z,pt.w),fn.copy(pt))},reset:function(){f.disable(3042),f.disable(2884),f.disable(2929),f.disable(32823),f.disable(3089),f.disable(2960),f.disable(32926),f.blendEquation(32774),f.blendFunc(1,0),f.blendFuncSeparate(1,0,1,0),f.colorMask(!0,!0,!0,!0),f.clearColor(0,0,0,0),f.depthMask(!0),f.depthFunc(513),f.clearDepth(1),f.stencilMask(4294967295),f.stencilFunc(519,0,4294967295),f.stencilOp(7680,7680,7680),f.clearStencil(0),f.cullFace(1029),f.frontFace(2305),f.polygonOffset(0,0),f.activeTexture(33984),f.bindFramebuffer(36160,null),a===!0&&(f.bindFramebuffer(36009,null),f.bindFramebuffer(36008,null)),f.useProgram(null),f.lineWidth(1),f.scissor(0,0,f.canvas.width,f.canvas.height),f.viewport(0,0,f.canvas.width,f.canvas.height),v={},Ot=null,ee={},_=null,y={},E=null,A=!1,M=null,P=null,I=null,N=null,O=null,V=null,Y=null,at=!1,st=null,yt=null,bt=null,_t=null,Et=null,Ue.set(0,0,f.canvas.width,f.canvas.height),fn.set(0,0,f.canvas.width,f.canvas.height),u.reset(),d.reset(),p.reset()}}}function ys(f,t,i,a,u,d,p){const v=u.isWebGL2,_=u.maxTextures,y=u.maxCubemapSize,E=u.maxTextureSize,A=u.maxSamples,M=new WeakMap;let P,I=!1;try{I=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function N(wt,Mt){return I?new OffscreenCanvas(wt,Mt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function O(wt,Mt,De,Ne){let se=1;if((wt.width>Ne||wt.height>Ne)&&(se=Ne/Math.max(wt.width,wt.height)),se<1||Mt===!0){if(typeof HTMLImageElement!="undefined"&&wt instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&wt instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&wt instanceof ImageBitmap){const nn=Mt?yc:Math.floor,rn=nn(se*wt.width),_e=nn(se*wt.height);P===void 0&&(P=N(rn,_e));const pt=De?N(rn,_e):P;return pt.width=rn,pt.height=_e,pt.getContext("2d").drawImage(wt,0,0,rn,_e),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+wt.width+"x"+wt.height+") to ("+rn+"x"+_e+")."),pt}return"data"in wt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+wt.width+"x"+wt.height+")."),wt}return wt}function V(wt){return xi(wt.width)&&xi(wt.height)}function Y(wt,Mt){return wt.generateMipmaps&&Mt&&wt.minFilter!==Kt&&wt.minFilter!==Un}function at(wt,Mt,De,Ne,se=1){f.generateMipmap(wt),a.get(Mt).__maxMipLevel=Math.log2(Math.max(De,Ne,se))}function st(wt,Mt,De){if(v===!1)return Mt;if(wt!==null){if(f[wt]!==void 0)return f[wt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+wt+"'")}let Ne=Mt;return Mt===6403&&(De===5126&&(Ne=33326),De===5131&&(Ne=33325),De===5121&&(Ne=33321)),Mt===6407&&(De===5126&&(Ne=34837),De===5131&&(Ne=34843),De===5121&&(Ne=32849)),Mt===6408&&(De===5126&&(Ne=34836),De===5131&&(Ne=34842),De===5121&&(Ne=32856)),Ne!==33325&&Ne!==33326&&Ne!==34842&&Ne!==34836||t.get("EXT_color_buffer_float"),Ne}function yt(wt){return wt===Kt||wt===qe||wt===Pn?9728:9729}function bt(wt){const Mt=wt.target;Mt.removeEventListener("dispose",bt),function(De){const Ne=a.get(De);Ne.__webglInit!==void 0&&(f.deleteTexture(Ne.__webglTexture),a.remove(De))}(Mt),Mt.isVideoTexture&&M.delete(Mt),p.memory.textures--}function _t(wt){const Mt=wt.target;Mt.removeEventListener("dispose",_t),function(De){const Ne=De.texture,se=a.get(De),nn=a.get(Ne);if(!!De){if(nn.__webglTexture!==void 0&&(f.deleteTexture(nn.__webglTexture),p.memory.textures--),De.depthTexture&&De.depthTexture.dispose(),De.isWebGLCubeRenderTarget)for(let rn=0;rn<6;rn++)f.deleteFramebuffer(se.__webglFramebuffer[rn]),se.__webglDepthbuffer&&f.deleteRenderbuffer(se.__webglDepthbuffer[rn]);else f.deleteFramebuffer(se.__webglFramebuffer),se.__webglDepthbuffer&&f.deleteRenderbuffer(se.__webglDepthbuffer),se.__webglMultisampledFramebuffer&&f.deleteFramebuffer(se.__webglMultisampledFramebuffer),se.__webglColorRenderbuffer&&f.deleteRenderbuffer(se.__webglColorRenderbuffer),se.__webglDepthRenderbuffer&&f.deleteRenderbuffer(se.__webglDepthRenderbuffer);if(De.isWebGLMultipleRenderTargets)for(let rn=0,_e=Ne.length;rn<_e;rn++){const pt=a.get(Ne[rn]);pt.__webglTexture&&(f.deleteTexture(pt.__webglTexture),p.memory.textures--),a.remove(Ne[rn])}a.remove(Ne),a.remove(De)}}(Mt)}let Et=0;function Ce(wt,Mt){const De=a.get(wt);if(wt.isVideoTexture&&function(Ne){const se=p.render.frame;M.get(Ne)!==se&&(M.set(Ne,se),Ne.update())}(wt),wt.version>0&&De.__version!==wt.version){const Ne=wt.image;if(Ne===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(Ne.complete!==!1)return void We(De,wt,Mt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.activeTexture(33984+Mt),i.bindTexture(3553,De.__webglTexture)}function ge(wt,Mt){const De=a.get(wt);wt.version>0&&De.__version!==wt.version?function(Ne,se,nn){if(se.image.length!==6)return;ee(Ne,se),i.activeTexture(33984+nn),i.bindTexture(34067,Ne.__webglTexture),f.pixelStorei(37440,se.flipY),f.pixelStorei(37441,se.premultiplyAlpha),f.pixelStorei(3317,se.unpackAlignment),f.pixelStorei(37443,0);const rn=se&&(se.isCompressedTexture||se.image[0].isCompressedTexture),_e=se.image[0]&&se.image[0].isDataTexture,pt=[];for(let In=0;In<6;In++)pt[In]=rn||_e?_e?se.image[In].image:se.image[In]:O(se.image[In],!1,!0,y);const Ut=pt[0],be=V(Ut)||v,Ae=d.convert(se.format),ye=d.convert(se.type),xn=st(se.internalFormat,Ae,ye);let zn;if(Ot(34067,se,be),rn){for(let In=0;In<6;In++){zn=pt[In].mipmaps;for(let wr=0;wr<zn.length;wr++){const Tr=zn[wr];se.format!==Sn&&se.format!==_n?Ae!==null?i.compressedTexImage2D(34069+In,wr,xn,Tr.width,Tr.height,0,Tr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+In,wr,xn,Tr.width,Tr.height,0,Ae,ye,Tr.data)}}Ne.__maxMipLevel=zn.length-1}else{zn=se.mipmaps;for(let In=0;In<6;In++)if(_e){i.texImage2D(34069+In,0,xn,pt[In].width,pt[In].height,0,Ae,ye,pt[In].data);for(let wr=0;wr<zn.length;wr++){const Tr=zn[wr].image[In].image;i.texImage2D(34069+In,wr+1,xn,Tr.width,Tr.height,0,Ae,ye,Tr.data)}}else{i.texImage2D(34069+In,0,xn,Ae,ye,pt[In]);for(let wr=0;wr<zn.length;wr++){const Tr=zn[wr];i.texImage2D(34069+In,wr+1,xn,Ae,ye,Tr.image[In])}}Ne.__maxMipLevel=zn.length}Y(se,be)&&at(34067,se,Ut.width,Ut.height),Ne.__version=se.version,se.onUpdate&&se.onUpdate(se)}(De,wt,Mt):(i.activeTexture(33984+Mt),i.bindTexture(34067,De.__webglTexture))}const ve={[Zt]:10497,[re]:33071,[pe]:33648},ce={[Kt]:9728,[qe]:9984,[Pn]:9986,[Un]:9729,[jr]:9985,[gi]:9987};function Ot(wt,Mt,De){if(De?(f.texParameteri(wt,10242,ve[Mt.wrapS]),f.texParameteri(wt,10243,ve[Mt.wrapT]),wt!==32879&&wt!==35866||f.texParameteri(wt,32882,ve[Mt.wrapR]),f.texParameteri(wt,10240,ce[Mt.magFilter]),f.texParameteri(wt,10241,ce[Mt.minFilter])):(f.texParameteri(wt,10242,33071),f.texParameteri(wt,10243,33071),wt!==32879&&wt!==35866||f.texParameteri(wt,32882,33071),Mt.wrapS===re&&Mt.wrapT===re||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),f.texParameteri(wt,10240,yt(Mt.magFilter)),f.texParameteri(wt,10241,yt(Mt.minFilter)),Mt.minFilter!==Kt&&Mt.minFilter!==Un&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){const Ne=t.get("EXT_texture_filter_anisotropic");if(Mt.type===jt&&t.has("OES_texture_float_linear")===!1||v===!1&&Mt.type===Pt&&t.has("OES_texture_half_float_linear")===!1)return;(Mt.anisotropy>1||a.get(Mt).__currentAnisotropy)&&(f.texParameterf(wt,Ne.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Mt.anisotropy,u.getMaxAnisotropy())),a.get(Mt).__currentAnisotropy=Mt.anisotropy)}}function ee(wt,Mt){wt.__webglInit===void 0&&(wt.__webglInit=!0,Mt.addEventListener("dispose",bt),wt.__webglTexture=f.createTexture(),p.memory.textures++)}function We(wt,Mt,De){let Ne=3553;Mt.isDataTexture2DArray&&(Ne=35866),Mt.isDataTexture3D&&(Ne=32879),ee(wt,Mt),i.activeTexture(33984+De),i.bindTexture(Ne,wt.__webglTexture),f.pixelStorei(37440,Mt.flipY),f.pixelStorei(37441,Mt.premultiplyAlpha),f.pixelStorei(3317,Mt.unpackAlignment),f.pixelStorei(37443,0);const se=function(ye){return!v&&(ye.wrapS!==re||ye.wrapT!==re||ye.minFilter!==Kt&&ye.minFilter!==Un)}(Mt)&&V(Mt.image)===!1,nn=O(Mt.image,se,!1,E),rn=V(nn)||v,_e=d.convert(Mt.format);let pt,Ut=d.convert(Mt.type),be=st(Mt.internalFormat,_e,Ut);Ot(Ne,Mt,rn);const Ae=Mt.mipmaps;if(Mt.isDepthTexture)be=6402,v?be=Mt.type===jt?36012:Mt.type===Yo?33190:Mt.type===un?35056:33189:Mt.type===jt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Mt.format===ln&&be===6402&&Mt.type!==Aa&&Mt.type!==Yo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Mt.type=Aa,Ut=d.convert(Mt.type)),Mt.format===or&&be===6402&&(be=34041,Mt.type!==un&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Mt.type=un,Ut=d.convert(Mt.type))),i.texImage2D(3553,0,be,nn.width,nn.height,0,_e,Ut,null);else if(Mt.isDataTexture)if(Ae.length>0&&rn){for(let ye=0,xn=Ae.length;ye<xn;ye++)pt=Ae[ye],i.texImage2D(3553,ye,be,pt.width,pt.height,0,_e,Ut,pt.data);Mt.generateMipmaps=!1,wt.__maxMipLevel=Ae.length-1}else i.texImage2D(3553,0,be,nn.width,nn.height,0,_e,Ut,nn.data),wt.__maxMipLevel=0;else if(Mt.isCompressedTexture){for(let ye=0,xn=Ae.length;ye<xn;ye++)pt=Ae[ye],Mt.format!==Sn&&Mt.format!==_n?_e!==null?i.compressedTexImage2D(3553,ye,be,pt.width,pt.height,0,pt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,ye,be,pt.width,pt.height,0,_e,Ut,pt.data);wt.__maxMipLevel=Ae.length-1}else if(Mt.isDataTexture2DArray)i.texImage3D(35866,0,be,nn.width,nn.height,nn.depth,0,_e,Ut,nn.data),wt.__maxMipLevel=0;else if(Mt.isDataTexture3D)i.texImage3D(32879,0,be,nn.width,nn.height,nn.depth,0,_e,Ut,nn.data),wt.__maxMipLevel=0;else if(Ae.length>0&&rn){for(let ye=0,xn=Ae.length;ye<xn;ye++)pt=Ae[ye],i.texImage2D(3553,ye,be,_e,Ut,pt);Mt.generateMipmaps=!1,wt.__maxMipLevel=Ae.length-1}else i.texImage2D(3553,0,be,_e,Ut,nn),wt.__maxMipLevel=0;Y(Mt,rn)&&at(Ne,Mt,nn.width,nn.height),wt.__version=Mt.version,Mt.onUpdate&&Mt.onUpdate(Mt)}function ze(wt,Mt,De,Ne,se){const nn=d.convert(De.format),rn=d.convert(De.type),_e=st(De.internalFormat,nn,rn);se===32879||se===35866?i.texImage3D(se,0,_e,Mt.width,Mt.height,Mt.depth,0,nn,rn,null):i.texImage2D(se,0,_e,Mt.width,Mt.height,0,nn,rn,null),i.bindFramebuffer(36160,wt),f.framebufferTexture2D(36160,Ne,se,a.get(De).__webglTexture,0),i.bindFramebuffer(36160,null)}function Ue(wt,Mt,De){if(f.bindRenderbuffer(36161,wt),Mt.depthBuffer&&!Mt.stencilBuffer){let Ne=33189;if(De){const se=Mt.depthTexture;se&&se.isDepthTexture&&(se.type===jt?Ne=36012:se.type===Yo&&(Ne=33190));const nn=vn(Mt);f.renderbufferStorageMultisample(36161,nn,Ne,Mt.width,Mt.height)}else f.renderbufferStorage(36161,Ne,Mt.width,Mt.height);f.framebufferRenderbuffer(36160,36096,36161,wt)}else if(Mt.depthBuffer&&Mt.stencilBuffer){if(De){const Ne=vn(Mt);f.renderbufferStorageMultisample(36161,Ne,35056,Mt.width,Mt.height)}else f.renderbufferStorage(36161,34041,Mt.width,Mt.height);f.framebufferRenderbuffer(36160,33306,36161,wt)}else{const Ne=Mt.isWebGLMultipleRenderTargets===!0?Mt.texture[0]:Mt.texture,se=d.convert(Ne.format),nn=d.convert(Ne.type),rn=st(Ne.internalFormat,se,nn);if(De){const _e=vn(Mt);f.renderbufferStorageMultisample(36161,_e,rn,Mt.width,Mt.height)}else f.renderbufferStorage(36161,rn,Mt.width,Mt.height)}f.bindRenderbuffer(36161,null)}function fn(wt){const Mt=a.get(wt),De=wt.isWebGLCubeRenderTarget===!0;if(wt.depthTexture){if(De)throw new Error("target.depthTexture not supported in Cube render targets");(function(Ne,se){if(se&&se.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,Ne),!se.depthTexture||!se.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");a.get(se.depthTexture).__webglTexture&&se.depthTexture.image.width===se.width&&se.depthTexture.image.height===se.height||(se.depthTexture.image.width=se.width,se.depthTexture.image.height=se.height,se.depthTexture.needsUpdate=!0),Ce(se.depthTexture,0);const nn=a.get(se.depthTexture).__webglTexture;if(se.depthTexture.format===ln)f.framebufferTexture2D(36160,36096,3553,nn,0);else{if(se.depthTexture.format!==or)throw new Error("Unknown depthTexture format");f.framebufferTexture2D(36160,33306,3553,nn,0)}})(Mt.__webglFramebuffer,wt)}else if(De){Mt.__webglDepthbuffer=[];for(let Ne=0;Ne<6;Ne++)i.bindFramebuffer(36160,Mt.__webglFramebuffer[Ne]),Mt.__webglDepthbuffer[Ne]=f.createRenderbuffer(),Ue(Mt.__webglDepthbuffer[Ne],wt,!1)}else i.bindFramebuffer(36160,Mt.__webglFramebuffer),Mt.__webglDepthbuffer=f.createRenderbuffer(),Ue(Mt.__webglDepthbuffer,wt,!1);i.bindFramebuffer(36160,null)}function vn(wt){return v&&wt.isWebGLMultisampleRenderTarget?Math.min(A,wt.samples):0}let En=!1,Tn=!1;this.allocateTextureUnit=function(){const wt=Et;return wt>=_&&console.warn("THREE.WebGLTextures: Trying to use "+wt+" texture units while this GPU supports only "+_),Et+=1,wt},this.resetTextureUnits=function(){Et=0},this.setTexture2D=Ce,this.setTexture2DArray=function(wt,Mt){const De=a.get(wt);wt.version>0&&De.__version!==wt.version?We(De,wt,Mt):(i.activeTexture(33984+Mt),i.bindTexture(35866,De.__webglTexture))},this.setTexture3D=function(wt,Mt){const De=a.get(wt);wt.version>0&&De.__version!==wt.version?We(De,wt,Mt):(i.activeTexture(33984+Mt),i.bindTexture(32879,De.__webglTexture))},this.setTextureCube=ge,this.setupRenderTarget=function(wt){const Mt=wt.texture,De=a.get(wt),Ne=a.get(Mt);wt.addEventListener("dispose",_t),wt.isWebGLMultipleRenderTargets!==!0&&(Ne.__webglTexture=f.createTexture(),Ne.__version=Mt.version,p.memory.textures++);const se=wt.isWebGLCubeRenderTarget===!0,nn=wt.isWebGLMultipleRenderTargets===!0,rn=wt.isWebGLMultisampleRenderTarget===!0,_e=Mt.isDataTexture3D||Mt.isDataTexture2DArray,pt=V(wt)||v;if(!v||Mt.format!==_n||Mt.type!==jt&&Mt.type!==Pt||(Mt.format=Sn,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),se){De.__webglFramebuffer=[];for(let Ut=0;Ut<6;Ut++)De.__webglFramebuffer[Ut]=f.createFramebuffer()}else if(De.__webglFramebuffer=f.createFramebuffer(),nn)if(u.drawBuffers){const Ut=wt.texture;for(let be=0,Ae=Ut.length;be<Ae;be++){const ye=a.get(Ut[be]);ye.__webglTexture===void 0&&(ye.__webglTexture=f.createTexture(),p.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(rn)if(v){De.__webglMultisampledFramebuffer=f.createFramebuffer(),De.__webglColorRenderbuffer=f.createRenderbuffer(),f.bindRenderbuffer(36161,De.__webglColorRenderbuffer);const Ut=d.convert(Mt.format),be=d.convert(Mt.type),Ae=st(Mt.internalFormat,Ut,be),ye=vn(wt);f.renderbufferStorageMultisample(36161,ye,Ae,wt.width,wt.height),i.bindFramebuffer(36160,De.__webglMultisampledFramebuffer),f.framebufferRenderbuffer(36160,36064,36161,De.__webglColorRenderbuffer),f.bindRenderbuffer(36161,null),wt.depthBuffer&&(De.__webglDepthRenderbuffer=f.createRenderbuffer(),Ue(De.__webglDepthRenderbuffer,wt,!0)),i.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(se){i.bindTexture(34067,Ne.__webglTexture),Ot(34067,Mt,pt);for(let Ut=0;Ut<6;Ut++)ze(De.__webglFramebuffer[Ut],wt,Mt,36064,34069+Ut);Y(Mt,pt)&&at(34067,Mt,wt.width,wt.height),i.bindTexture(34067,null)}else if(nn){const Ut=wt.texture;for(let be=0,Ae=Ut.length;be<Ae;be++){const ye=Ut[be],xn=a.get(ye);i.bindTexture(3553,xn.__webglTexture),Ot(3553,ye,pt),ze(De.__webglFramebuffer,wt,ye,36064+be,3553),Y(ye,pt)&&at(3553,ye,wt.width,wt.height)}i.bindTexture(3553,null)}else{let Ut=3553;_e&&(v?Ut=Mt.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),i.bindTexture(Ut,Ne.__webglTexture),Ot(Ut,Mt,pt),ze(De.__webglFramebuffer,wt,Mt,36064,Ut),Y(Mt,pt)&&at(Ut,Mt,wt.width,wt.height,wt.depth),i.bindTexture(Ut,null)}wt.depthBuffer&&fn(wt)},this.updateRenderTargetMipmap=function(wt){const Mt=V(wt)||v,De=wt.isWebGLMultipleRenderTargets===!0?wt.texture:[wt.texture];for(let Ne=0,se=De.length;Ne<se;Ne++){const nn=De[Ne];if(Y(nn,Mt)){const rn=wt.isWebGLCubeRenderTarget?34067:3553,_e=a.get(nn).__webglTexture;i.bindTexture(rn,_e),at(rn,nn,wt.width,wt.height),i.bindTexture(rn,null)}}},this.updateMultisampleRenderTarget=function(wt){if(wt.isWebGLMultisampleRenderTarget)if(v){const Mt=wt.width,De=wt.height;let Ne=16384;wt.depthBuffer&&(Ne|=256),wt.stencilBuffer&&(Ne|=1024);const se=a.get(wt);i.bindFramebuffer(36008,se.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,se.__webglFramebuffer),f.blitFramebuffer(0,0,Mt,De,0,0,Mt,De,Ne,9728),i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,se.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(wt,Mt){wt&&wt.isWebGLRenderTarget&&(En===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),En=!0),wt=wt.texture),Ce(wt,Mt)},this.safeSetTextureCube=function(wt,Mt){wt&&wt.isWebGLCubeRenderTarget&&(Tn===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Tn=!0),wt=wt.texture),ge(wt,Mt)}}function zc(f,t,i){const a=i.isWebGL2;return{convert:function(u){let d;if(u===Oo)return 5121;if(u===xe)return 32819;if(u===Fe)return 32820;if(u===$e)return 33635;if(u===Ma)return 5120;if(u===ea)return 5122;if(u===Aa)return 5123;if(u===vh)return 5124;if(u===Yo)return 5125;if(u===jt)return 5126;if(u===Pt)return a?5131:(d=t.get("OES_texture_half_float"),d!==null?d.HALF_FLOAT_OES:null);if(u===Rn)return 6406;if(u===_n)return 6407;if(u===Sn)return 6408;if(u===vr)return 6409;if(u===_r)return 6410;if(u===ln)return 6402;if(u===or)return 34041;if(u===vi)return 6403;if(u===Zn)return 36244;if(u===Fr)return 33319;if(u===hi)return 33320;if(u===Er)return 36248;if(u===$r)return 36249;if(u===is||u===wl||u===Ki||u===si){if(d=t.get("WEBGL_compressed_texture_s3tc"),d===null)return null;if(u===is)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(u===wl)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(u===Ki)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(u===si)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(u===pc||u===fc||u===Tl||u===_h){if(d=t.get("WEBGL_compressed_texture_pvrtc"),d===null)return null;if(u===pc)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(u===fc)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(u===Tl)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(u===_h)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(u===Sl)return d=t.get("WEBGL_compressed_texture_etc1"),d!==null?d.COMPRESSED_RGB_ETC1_WEBGL:null;if((u===yh||u===Do)&&(d=t.get("WEBGL_compressed_texture_etc"),d!==null)){if(u===yh)return d.COMPRESSED_RGB8_ETC2;if(u===Do)return d.COMPRESSED_RGBA8_ETC2_EAC}return u===md||u===ao||u===_i||u===Uu||u===na||u===El||u===dr||u===ei||u===ra||u===tu||u===mc||u===ai||u===eu||u===yi||u===os||u===nu||u===Pa||u===xh||u===bh||u===ku||u===ni||u===Ml||u===ru||u===gc||u===xo||u===ci||u===iu||u===gd?(d=t.get("WEBGL_compressed_texture_astc"),d!==null?u:null):u===ks?(d=t.get("EXT_texture_compression_bptc"),d!==null?u:null):u===un?a?34042:(d=t.get("WEBGL_depth_texture"),d!==null?d.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class Mr extends Zi{constructor(t=[]){super(),this.cameras=t}}Mr.prototype.isArrayCamera=!0;class Au extends mr{constructor(){super(),this.type="Group"}}Au.prototype.isGroup=!0;const Wd={type:"move"};class ol{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Au,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Au,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ot,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ot),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Au,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ot,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ot),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,i,a){let u=null,d=null,p=null;const v=this._targetRay,_=this._grip,y=this._hand;if(t&&i.session.visibilityState!=="visible-blurred")if(v!==null&&(u=i.getPose(t.targetRaySpace,a),u!==null&&(v.matrix.fromArray(u.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),u.linearVelocity?(v.hasLinearVelocity=!0,v.linearVelocity.copy(u.linearVelocity)):v.hasLinearVelocity=!1,u.angularVelocity?(v.hasAngularVelocity=!0,v.angularVelocity.copy(u.angularVelocity)):v.hasAngularVelocity=!1,this.dispatchEvent(Wd))),y&&t.hand){p=!0;for(const N of t.hand.values()){const O=i.getJointPose(N,a);if(y.joints[N.jointName]===void 0){const Y=new Au;Y.matrixAutoUpdate=!1,Y.visible=!1,y.joints[N.jointName]=Y,y.add(Y)}const V=y.joints[N.jointName];O!==null&&(V.matrix.fromArray(O.transform.matrix),V.matrix.decompose(V.position,V.rotation,V.scale),V.jointRadius=O.radius),V.visible=O!==null}const E=y.joints["index-finger-tip"],A=y.joints["thumb-tip"],M=E.position.distanceTo(A.position),P=.02,I=.005;y.inputState.pinching&&M>P+I?(y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!y.inputState.pinching&&M<=P-I&&(y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else _!==null&&t.gripSpace&&(d=i.getPose(t.gripSpace,a),d!==null&&(_.matrix.fromArray(d.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),d.linearVelocity?(_.hasLinearVelocity=!0,_.linearVelocity.copy(d.linearVelocity)):_.hasLinearVelocity=!1,d.angularVelocity?(_.hasAngularVelocity=!0,_.angularVelocity.copy(d.angularVelocity)):_.hasAngularVelocity=!1));return v!==null&&(v.visible=u!==null),_!==null&&(_.visible=d!==null),y!==null&&(y.visible=p!==null),this}}class Up extends Ra{constructor(t,i){super();const a=this,u=t.state;let d=null,p=1,v=null,_="local-floor",y=null,E=null,A=null,M=null;const P=[],I=new Map,N=new Zi;N.layers.enable(1),N.viewport=new Rr;const O=new Zi;O.layers.enable(2),O.viewport=new Rr;const V=[N,O],Y=new Mr;Y.layers.enable(1),Y.layers.enable(2);let at=null,st=null;function yt(Ot){const ee=I.get(Ot.inputSource);ee&&ee.dispatchEvent({type:Ot.type,data:Ot.inputSource})}function bt(){I.forEach(function(Ot,ee){Ot.disconnect(ee)}),I.clear(),at=null,st=null,u.bindXRFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),ce.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function _t(Ot){const ee=d.inputSources;for(let We=0;We<P.length;We++)I.set(ee[We],P[We]);for(let We=0;We<Ot.removed.length;We++){const ze=Ot.removed[We],Ue=I.get(ze);Ue&&(Ue.dispatchEvent({type:"disconnected",data:ze}),I.delete(ze))}for(let We=0;We<Ot.added.length;We++){const ze=Ot.added[We],Ue=I.get(ze);Ue&&Ue.dispatchEvent({type:"connected",data:ze})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ot){let ee=P[Ot];return ee===void 0&&(ee=new ol,P[Ot]=ee),ee.getTargetRaySpace()},this.getControllerGrip=function(Ot){let ee=P[Ot];return ee===void 0&&(ee=new ol,P[Ot]=ee),ee.getGripSpace()},this.getHand=function(Ot){let ee=P[Ot];return ee===void 0&&(ee=new ol,P[Ot]=ee),ee.getHandSpace()},this.setFramebufferScaleFactor=function(Ot){p=Ot,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ot){_=Ot,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return v},this.getSession=function(){return d},this.setSession=async function(Ot){if(d=Ot,d!==null){d.addEventListener("select",yt),d.addEventListener("selectstart",yt),d.addEventListener("selectend",yt),d.addEventListener("squeeze",yt),d.addEventListener("squeezestart",yt),d.addEventListener("squeezeend",yt),d.addEventListener("end",bt),d.addEventListener("inputsourceschange",_t);const ee=i.getContextAttributes();if(ee.xrCompatible!==!0&&await i.makeXRCompatible(),d.renderState.layers===void 0){const We={antialias:ee.antialias,alpha:ee.alpha,depth:ee.depth,stencil:ee.stencil,framebufferScaleFactor:p},ze=new XRWebGLLayer(d,i,We);d.updateRenderState({baseLayer:ze})}else{let We=0;ee.depth&&(We=ee.stencil?34041:6402);const ze={colorFormat:ee.alpha?6408:6407,depthFormat:We,scaleFactor:p};E=new XRWebGLBinding(d,i),M=E.createProjectionLayer(ze),A=i.createFramebuffer(),d.updateRenderState({layers:[M]})}v=await d.requestReferenceSpace(_),ce.setContext(d),ce.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}};const Et=new ot,Ce=new ot;function ge(Ot,ee){ee===null?Ot.matrixWorld.copy(Ot.matrix):Ot.matrixWorld.multiplyMatrices(ee.matrixWorld,Ot.matrix),Ot.matrixWorldInverse.copy(Ot.matrixWorld).invert()}this.updateCamera=function(Ot){if(d===null)return;Y.near=O.near=N.near=Ot.near,Y.far=O.far=N.far=Ot.far,at===Y.near&&st===Y.far||(d.updateRenderState({depthNear:Y.near,depthFar:Y.far}),at=Y.near,st=Y.far);const ee=Ot.parent,We=Y.cameras;ge(Y,ee);for(let Ue=0;Ue<We.length;Ue++)ge(We[Ue],ee);Y.matrixWorld.decompose(Y.position,Y.quaternion,Y.scale),Ot.position.copy(Y.position),Ot.quaternion.copy(Y.quaternion),Ot.scale.copy(Y.scale),Ot.matrix.copy(Y.matrix),Ot.matrixWorld.copy(Y.matrixWorld);const ze=Ot.children;for(let Ue=0,fn=ze.length;Ue<fn;Ue++)ze[Ue].updateMatrixWorld(!0);We.length===2?function(Ue,fn,vn){Et.setFromMatrixPosition(fn.matrixWorld),Ce.setFromMatrixPosition(vn.matrixWorld);const En=Et.distanceTo(Ce),Tn=fn.projectionMatrix.elements,wt=vn.projectionMatrix.elements,Mt=Tn[14]/(Tn[10]-1),De=Tn[14]/(Tn[10]+1),Ne=(Tn[9]+1)/Tn[5],se=(Tn[9]-1)/Tn[5],nn=(Tn[8]-1)/Tn[0],rn=(wt[8]+1)/wt[0],_e=Mt*nn,pt=Mt*rn,Ut=En/(-nn+rn),be=Ut*-nn;fn.matrixWorld.decompose(Ue.position,Ue.quaternion,Ue.scale),Ue.translateX(be),Ue.translateZ(Ut),Ue.matrixWorld.compose(Ue.position,Ue.quaternion,Ue.scale),Ue.matrixWorldInverse.copy(Ue.matrixWorld).invert();const Ae=Mt+Ut,ye=De+Ut,xn=_e-be,zn=pt+(En-be),In=Ne*De/ye*Ae,wr=se*De/ye*Ae;Ue.projectionMatrix.makePerspective(xn,zn,In,wr,Ae,ye)}(Y,N,O):Y.projectionMatrix.copy(N.projectionMatrix)},this.getCamera=function(){return Y};let ve=null;const ce=new Nh;ce.setAnimationLoop(function(Ot,ee){if(y=ee.getViewerPose(v),y!==null){const ze=y.views,Ue=d.renderState.baseLayer;d.renderState.layers===void 0&&u.bindXRFramebuffer(Ue.framebuffer);let fn=!1;ze.length!==Y.cameras.length&&(Y.cameras.length=0,fn=!0);for(let vn=0;vn<ze.length;vn++){const En=ze[vn];let Tn=null;if(d.renderState.layers===void 0)Tn=Ue.getViewport(En);else{const Mt=E.getViewSubImage(M,En);u.bindXRFramebuffer(A),i.framebufferTexture2D(36160,36064,3553,Mt.colorTexture,0),Mt.depthStencilTexture!==void 0&&i.framebufferTexture2D(36160,36096,3553,Mt.depthStencilTexture,0),Tn=Mt.viewport}const wt=V[vn];wt.matrix.fromArray(En.transform.matrix),wt.projectionMatrix.fromArray(En.projectionMatrix),wt.viewport.set(Tn.x,Tn.y,Tn.width,Tn.height),vn===0&&Y.matrix.copy(wt.matrix),fn===!0&&Y.cameras.push(wt)}}const We=d.inputSources;for(let ze=0;ze<P.length;ze++){const Ue=P[ze],fn=We[ze];Ue.update(fn,ee,v)}ve&&ve(Ot,ee)}),this.setAnimationLoop=function(Ot){ve=Ot},this.dispose=function(){}}}function _f(f){function t(a,u){a.opacity.value=u.opacity,u.color&&a.diffuse.value.copy(u.color),u.emissive&&a.emissive.value.copy(u.emissive).multiplyScalar(u.emissiveIntensity),u.map&&(a.map.value=u.map),u.alphaMap&&(a.alphaMap.value=u.alphaMap),u.specularMap&&(a.specularMap.value=u.specularMap);const d=f.get(u).envMap;if(d){a.envMap.value=d,a.flipEnvMap.value=d.isCubeTexture&&d._needsFlipEnvMap?-1:1,a.reflectivity.value=u.reflectivity,a.refractionRatio.value=u.refractionRatio;const _=f.get(d).__maxMipLevel;_!==void 0&&(a.maxMipLevel.value=_)}let p,v;u.lightMap&&(a.lightMap.value=u.lightMap,a.lightMapIntensity.value=u.lightMapIntensity),u.aoMap&&(a.aoMap.value=u.aoMap,a.aoMapIntensity.value=u.aoMapIntensity),u.map?p=u.map:u.specularMap?p=u.specularMap:u.displacementMap?p=u.displacementMap:u.normalMap?p=u.normalMap:u.bumpMap?p=u.bumpMap:u.roughnessMap?p=u.roughnessMap:u.metalnessMap?p=u.metalnessMap:u.alphaMap?p=u.alphaMap:u.emissiveMap?p=u.emissiveMap:u.clearcoatMap?p=u.clearcoatMap:u.clearcoatNormalMap?p=u.clearcoatNormalMap:u.clearcoatRoughnessMap&&(p=u.clearcoatRoughnessMap),p!==void 0&&(p.isWebGLRenderTarget&&(p=p.texture),p.matrixAutoUpdate===!0&&p.updateMatrix(),a.uvTransform.value.copy(p.matrix)),u.aoMap?v=u.aoMap:u.lightMap&&(v=u.lightMap),v!==void 0&&(v.isWebGLRenderTarget&&(v=v.texture),v.matrixAutoUpdate===!0&&v.updateMatrix(),a.uv2Transform.value.copy(v.matrix))}function i(a,u){a.roughness.value=u.roughness,a.metalness.value=u.metalness,u.roughnessMap&&(a.roughnessMap.value=u.roughnessMap),u.metalnessMap&&(a.metalnessMap.value=u.metalnessMap),u.emissiveMap&&(a.emissiveMap.value=u.emissiveMap),u.bumpMap&&(a.bumpMap.value=u.bumpMap,a.bumpScale.value=u.bumpScale,u.side===L&&(a.bumpScale.value*=-1)),u.normalMap&&(a.normalMap.value=u.normalMap,a.normalScale.value.copy(u.normalScale),u.side===L&&a.normalScale.value.negate()),u.displacementMap&&(a.displacementMap.value=u.displacementMap,a.displacementScale.value=u.displacementScale,a.displacementBias.value=u.displacementBias),f.get(u).envMap&&(a.envMapIntensity.value=u.envMapIntensity)}return{refreshFogUniforms:function(a,u){a.fogColor.value.copy(u.color),u.isFog?(a.fogNear.value=u.near,a.fogFar.value=u.far):u.isFogExp2&&(a.fogDensity.value=u.density)},refreshMaterialUniforms:function(a,u,d,p,v){u.isMeshBasicMaterial?t(a,u):u.isMeshLambertMaterial?(t(a,u),function(_,y){y.emissiveMap&&(_.emissiveMap.value=y.emissiveMap)}(a,u)):u.isMeshToonMaterial?(t(a,u),function(_,y){y.gradientMap&&(_.gradientMap.value=y.gradientMap),y.emissiveMap&&(_.emissiveMap.value=y.emissiveMap),y.bumpMap&&(_.bumpMap.value=y.bumpMap,_.bumpScale.value=y.bumpScale,y.side===L&&(_.bumpScale.value*=-1)),y.normalMap&&(_.normalMap.value=y.normalMap,_.normalScale.value.copy(y.normalScale),y.side===L&&_.normalScale.value.negate()),y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias)}(a,u)):u.isMeshPhongMaterial?(t(a,u),function(_,y){_.specular.value.copy(y.specular),_.shininess.value=Math.max(y.shininess,1e-4),y.emissiveMap&&(_.emissiveMap.value=y.emissiveMap),y.bumpMap&&(_.bumpMap.value=y.bumpMap,_.bumpScale.value=y.bumpScale,y.side===L&&(_.bumpScale.value*=-1)),y.normalMap&&(_.normalMap.value=y.normalMap,_.normalScale.value.copy(y.normalScale),y.side===L&&_.normalScale.value.negate()),y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias)}(a,u)):u.isMeshStandardMaterial?(t(a,u),u.isMeshPhysicalMaterial?function(_,y,E){i(_,y),_.reflectivity.value=y.reflectivity,_.clearcoat.value=y.clearcoat,_.clearcoatRoughness.value=y.clearcoatRoughness,y.sheen&&_.sheen.value.copy(y.sheen),y.clearcoatMap&&(_.clearcoatMap.value=y.clearcoatMap),y.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap),y.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),_.clearcoatNormalMap.value=y.clearcoatNormalMap,y.side===L&&_.clearcoatNormalScale.value.negate()),_.transmission.value=y.transmission,y.transmissionMap&&(_.transmissionMap.value=y.transmissionMap),y.transmission>0&&(_.transmissionSamplerMap.value=E.texture,_.transmissionSamplerSize.value.set(E.width,E.height)),_.thickness.value=y.thickness,y.thicknessMap&&(_.thicknessMap.value=y.thicknessMap),_.attenuationDistance.value=y.attenuationDistance,_.attenuationColor.value.copy(y.attenuationColor)}(a,u,v):i(a,u)):u.isMeshMatcapMaterial?(t(a,u),function(_,y){y.matcap&&(_.matcap.value=y.matcap),y.bumpMap&&(_.bumpMap.value=y.bumpMap,_.bumpScale.value=y.bumpScale,y.side===L&&(_.bumpScale.value*=-1)),y.normalMap&&(_.normalMap.value=y.normalMap,_.normalScale.value.copy(y.normalScale),y.side===L&&_.normalScale.value.negate()),y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias)}(a,u)):u.isMeshDepthMaterial?(t(a,u),function(_,y){y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias)}(a,u)):u.isMeshDistanceMaterial?(t(a,u),function(_,y){y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias),_.referencePosition.value.copy(y.referencePosition),_.nearDistance.value=y.nearDistance,_.farDistance.value=y.farDistance}(a,u)):u.isMeshNormalMaterial?(t(a,u),function(_,y){y.bumpMap&&(_.bumpMap.value=y.bumpMap,_.bumpScale.value=y.bumpScale,y.side===L&&(_.bumpScale.value*=-1)),y.normalMap&&(_.normalMap.value=y.normalMap,_.normalScale.value.copy(y.normalScale),y.side===L&&_.normalScale.value.negate()),y.displacementMap&&(_.displacementMap.value=y.displacementMap,_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias)}(a,u)):u.isLineBasicMaterial?(function(_,y){_.diffuse.value.copy(y.color),_.opacity.value=y.opacity}(a,u),u.isLineDashedMaterial&&function(_,y){_.dashSize.value=y.dashSize,_.totalSize.value=y.dashSize+y.gapSize,_.scale.value=y.scale}(a,u)):u.isPointsMaterial?function(_,y,E,A){_.diffuse.value.copy(y.color),_.opacity.value=y.opacity,_.size.value=y.size*E,_.scale.value=.5*A,y.map&&(_.map.value=y.map),y.alphaMap&&(_.alphaMap.value=y.alphaMap);let M;y.map?M=y.map:y.alphaMap&&(M=y.alphaMap),M!==void 0&&(M.matrixAutoUpdate===!0&&M.updateMatrix(),_.uvTransform.value.copy(M.matrix))}(a,u,d,p):u.isSpriteMaterial?function(_,y){_.diffuse.value.copy(y.color),_.opacity.value=y.opacity,_.rotation.value=y.rotation,y.map&&(_.map.value=y.map),y.alphaMap&&(_.alphaMap.value=y.alphaMap);let E;y.map?E=y.map:y.alphaMap&&(E=y.alphaMap),E!==void 0&&(E.matrixAutoUpdate===!0&&E.updateMatrix(),_.uvTransform.value.copy(E.matrix))}(a,u):u.isShadowMaterial?(a.color.value.copy(u.color),a.opacity.value=u.opacity):u.isShaderMaterial&&(u.uniformsNeedUpdate=!1)}}}function Yr(f={}){const t=f.canvas!==void 0?f.canvas:function(){const Tt=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return Tt.style.display="block",Tt}(),i=f.context!==void 0?f.context:null,a=f.alpha!==void 0&&f.alpha,u=f.depth===void 0||f.depth,d=f.stencil===void 0||f.stencil,p=f.antialias!==void 0&&f.antialias,v=f.premultipliedAlpha===void 0||f.premultipliedAlpha,_=f.preserveDrawingBuffer!==void 0&&f.preserveDrawingBuffer,y=f.powerPreference!==void 0?f.powerPreference:"default",E=f.failIfMajorPerformanceCaveat!==void 0&&f.failIfMajorPerformanceCaveat;let A=null,M=null;const P=[],I=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=bo,this.physicallyCorrectLights=!1,this.toneMapping=Lr,this.toneMappingExposure=1;const N=this;let O=!1,V=0,Y=0,at=null,st=-1,yt=null;const bt=new Rr,_t=new Rr;let Et=null,Ce=t.width,ge=t.height,ve=1,ce=null,Ot=null;const ee=new Rr(0,0,Ce,ge),We=new Rr(0,0,Ce,ge);let ze=!1;const Ue=[],fn=new ka;let vn=!1,En=!1,Tn=null;const wt=new wn,Mt=new ot,De={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ne(){return at===null?ve:1}let se,nn,rn,_e,pt,Ut,be,Ae,ye,xn,zn,In,wr,Tr,Vo,Ti,xl,Wf,Xf,Yf,ta,Sa,Ye=i;function Bm(Tt,Te){for(let Jt=0;Jt<Tt.length;Jt++){const Me=Tt[Jt],tn=t.getContext(Me,Te);if(tn!==null)return tn}return null}try{const Tt={alpha:a,depth:u,stencil:d,antialias:p,premultipliedAlpha:v,preserveDrawingBuffer:_,powerPreference:y,failIfMajorPerformanceCaveat:E};if(t.addEventListener("webglcontextlost",km,!1),t.addEventListener("webglcontextrestored",Gm,!1),Ye===null){const Te=["webgl2","webgl","experimental-webgl"];if(N.isWebGL1Renderer===!0&&Te.shift(),Ye=Bm(Te,Tt),Ye===null)throw Bm(Te)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Ye.getShaderPrecisionFormat===void 0&&(Ye.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Tt){throw console.error("THREE.WebGLRenderer: "+Tt.message),Tt}function Um(){se=new Pd(Ye),nn=new Ao(Ye,se,f),se.init(nn),ta=new zc(Ye,se,nn),rn=new Vd(Ye,se,nn),Ue[0]=1029,_e=new Uh(Ye),pt=new wi,Ut=new ys(Ye,se,rn,pt,nn,ta,_e),be=new Bh(N),Ae=new wu(Ye,nn),Sa=new Vl(Ye,se,Ae,nn),ye=new Wl(Ye,Ae,_e,Sa),xn=new kh(Ye,ye,Ae,_e),Wf=new Xl(Ye),Vo=new Fh(pt),zn=new pi(N,be,se,nn,Sa,Vo),In=new _f(pt),wr=new Hc(pt),Tr=new Bp(se,nn),xl=new Ad(N,be,rn,xn,v),Ti=new hr(N,xn,nn),Xf=new Ys(Ye,se,_e,nn),Yf=new Ku(Ye,se,_e,nn),_e.programs=zn.programs,N.capabilities=nn,N.extensions=se,N.properties=pt,N.renderLists=wr,N.shadowMap=Ti,N.state=rn,N.info=_e}Um();const $a=new Up(N,Ye);function km(Tt){Tt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),O=!0}function Gm(){console.log("THREE.WebGLRenderer: Context Restored."),O=!1;const Tt=_e.autoReset,Te=Ti.enabled,Jt=Ti.autoUpdate,Me=Ti.needsUpdate,tn=Ti.type;Um(),_e.autoReset=Tt,Ti.enabled=Te,Ti.autoUpdate=Jt,Ti.needsUpdate=Me,Ti.type=tn}function Hm(Tt){const Te=Tt.target;Te.removeEventListener("dispose",Hm),function(Jt){(function(Me){const tn=pt.get(Me).programs;tn!==void 0&&tn.forEach(function(zr){zn.releaseProgram(zr)})})(Jt),pt.remove(Jt)}(Te)}this.xr=$a,this.getContext=function(){return Ye},this.getContextAttributes=function(){return Ye.getContextAttributes()},this.forceContextLoss=function(){const Tt=se.get("WEBGL_lose_context");Tt&&Tt.loseContext()},this.forceContextRestore=function(){const Tt=se.get("WEBGL_lose_context");Tt&&Tt.restoreContext()},this.getPixelRatio=function(){return ve},this.setPixelRatio=function(Tt){Tt!==void 0&&(ve=Tt,this.setSize(Ce,ge,!1))},this.getSize=function(Tt){return Tt.set(Ce,ge)},this.setSize=function(Tt,Te,Jt){$a.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Ce=Tt,ge=Te,t.width=Math.floor(Tt*ve),t.height=Math.floor(Te*ve),Jt!==!1&&(t.style.width=Tt+"px",t.style.height=Te+"px"),this.setViewport(0,0,Tt,Te))},this.getDrawingBufferSize=function(Tt){return Tt.set(Ce*ve,ge*ve).floor()},this.setDrawingBufferSize=function(Tt,Te,Jt){Ce=Tt,ge=Te,ve=Jt,t.width=Math.floor(Tt*Jt),t.height=Math.floor(Te*Jt),this.setViewport(0,0,Tt,Te)},this.getCurrentViewport=function(Tt){return Tt.copy(bt)},this.getViewport=function(Tt){return Tt.copy(ee)},this.setViewport=function(Tt,Te,Jt,Me){Tt.isVector4?ee.set(Tt.x,Tt.y,Tt.z,Tt.w):ee.set(Tt,Te,Jt,Me),rn.viewport(bt.copy(ee).multiplyScalar(ve).floor())},this.getScissor=function(Tt){return Tt.copy(We)},this.setScissor=function(Tt,Te,Jt,Me){Tt.isVector4?We.set(Tt.x,Tt.y,Tt.z,Tt.w):We.set(Tt,Te,Jt,Me),rn.scissor(_t.copy(We).multiplyScalar(ve).floor())},this.getScissorTest=function(){return ze},this.setScissorTest=function(Tt){rn.setScissorTest(ze=Tt)},this.setOpaqueSort=function(Tt){ce=Tt},this.setTransparentSort=function(Tt){Ot=Tt},this.getClearColor=function(Tt){return Tt.copy(xl.getClearColor())},this.setClearColor=function(){xl.setClearColor.apply(xl,arguments)},this.getClearAlpha=function(){return xl.getClearAlpha()},this.setClearAlpha=function(){xl.setClearAlpha.apply(xl,arguments)},this.clear=function(Tt,Te,Jt){let Me=0;(Tt===void 0||Tt)&&(Me|=16384),(Te===void 0||Te)&&(Me|=256),(Jt===void 0||Jt)&&(Me|=1024),Ye.clear(Me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",km,!1),t.removeEventListener("webglcontextrestored",Gm,!1),wr.dispose(),Tr.dispose(),pt.dispose(),be.dispose(),xn.dispose(),Sa.dispose(),$a.dispose(),$a.removeEventListener("sessionstart",zm),$a.removeEventListener("sessionend",jm),Tn&&(Tn.dispose(),Tn=null),xp.stop()},this.renderBufferImmediate=function(Tt,Te){Sa.initAttributes();const Jt=pt.get(Tt);Tt.hasPositions&&!Jt.position&&(Jt.position=Ye.createBuffer()),Tt.hasNormals&&!Jt.normal&&(Jt.normal=Ye.createBuffer()),Tt.hasUvs&&!Jt.uv&&(Jt.uv=Ye.createBuffer()),Tt.hasColors&&!Jt.color&&(Jt.color=Ye.createBuffer());const Me=Te.getAttributes();Tt.hasPositions&&(Ye.bindBuffer(34962,Jt.position),Ye.bufferData(34962,Tt.positionArray,35048),Sa.enableAttribute(Me.position),Ye.vertexAttribPointer(Me.position,3,5126,!1,0,0)),Tt.hasNormals&&(Ye.bindBuffer(34962,Jt.normal),Ye.bufferData(34962,Tt.normalArray,35048),Sa.enableAttribute(Me.normal),Ye.vertexAttribPointer(Me.normal,3,5126,!1,0,0)),Tt.hasUvs&&(Ye.bindBuffer(34962,Jt.uv),Ye.bufferData(34962,Tt.uvArray,35048),Sa.enableAttribute(Me.uv),Ye.vertexAttribPointer(Me.uv,2,5126,!1,0,0)),Tt.hasColors&&(Ye.bindBuffer(34962,Jt.color),Ye.bufferData(34962,Tt.colorArray,35048),Sa.enableAttribute(Me.color),Ye.vertexAttribPointer(Me.color,3,5126,!1,0,0)),Sa.disableUnusedAttributes(),Ye.drawArrays(4,0,Tt.count),Tt.count=0},this.renderBufferDirect=function(Tt,Te,Jt,Me,tn,zr){Te===null&&(Te=De);const cr=tn.isMesh&&tn.matrixWorld.determinant()<0,an=Xm(Tt,Te,Me,tn);rn.setMaterial(Me,cr);let Ar=Jt.index;const Wn=Jt.attributes.position;if(Ar===null){if(Wn===void 0||Wn.count===0)return}else if(Ar.count===0)return;let Br,sr=1;Me.wireframe===!0&&(Ar=ye.getWireframeAttribute(Jt),sr=2),(Me.morphTargets||Me.morphNormals)&&Wf.update(tn,Jt,Me,an),Sa.setup(tn,Me,an,Jt,Ar);let Dr=Xf;Ar!==null&&(Br=Ae.get(Ar),Dr=Yf,Dr.setIndex(Br));const Lo=Ar!==null?Ar.count:Wn.count,Pi=Jt.drawRange.start*sr,bl=Jt.drawRange.count*sr,Si=zr!==null?zr.start*sr:0,gh=zr!==null?zr.count*sr:1/0,Wo=Math.max(Pi,Si),Ka=Math.min(Lo,Pi+bl,Si+gh)-1,Us=Math.max(0,Ka-Wo+1);if(Us!==0){if(tn.isMesh)Me.wireframe===!0?(rn.setLineWidth(Me.wireframeLinewidth*Ne()),Dr.setMode(1)):Dr.setMode(4);else if(tn.isLine){let qf=Me.linewidth;qf===void 0&&(qf=1),rn.setLineWidth(qf*Ne()),tn.isLineSegments?Dr.setMode(1):tn.isLineLoop?Dr.setMode(2):Dr.setMode(3)}else tn.isPoints?Dr.setMode(0):tn.isSprite&&Dr.setMode(4);if(tn.isInstancedMesh)Dr.renderInstances(Wo,Us,tn.count);else if(Jt.isInstancedBufferGeometry){const qf=Math.min(Jt.instanceCount,Jt._maxInstanceCount);Dr.renderInstances(Wo,Us,qf)}else Dr.render(Wo,Us)}},this.compile=function(Tt,Te){M=Tr.get(Tt),M.init(),Tt.traverseVisible(function(Jt){Jt.isLight&&Jt.layers.test(Te.layers)&&(M.pushLight(Jt),Jt.castShadow&&M.pushShadow(Jt))}),M.setupLights(),Tt.traverse(function(Jt){const Me=Jt.material;if(Me)if(Array.isArray(Me))for(let tn=0;tn<Me.length;tn++)Nm(Me[tn],Tt,Jt);else Nm(Me,Tt,Jt)})};let Dm=null;function zm(){xp.stop()}function jm(){xp.start()}const xp=new Nh;function Sm(Tt,Te,Jt){const Me=Te.isScene===!0?Te.overrideMaterial:null;for(let tn=0,zr=Tt.length;tn<zr;tn++){const cr=Tt[tn],an=cr.object,Ar=cr.geometry,Wn=Me===null?cr.material:Me,Br=cr.group;if(Jt.isArrayCamera){const sr=Jt.cameras;for(let Dr=0,Lo=sr.length;Dr<Lo;Dr++){const Pi=sr[Dr];an.layers.test(Pi.layers)&&(rn.viewport(bt.copy(Pi.viewport)),M.setupLightsView(Pi),Vm(an,Te,Pi,Ar,Wn,Br))}}else Vm(an,Te,Jt,Ar,Wn,Br)}}function Vm(Tt,Te,Jt,Me,tn,zr){if(Tt.onBeforeRender(N,Te,Jt,Me,tn,zr),Tt.modelViewMatrix.multiplyMatrices(Jt.matrixWorldInverse,Tt.matrixWorld),Tt.normalMatrix.getNormalMatrix(Tt.modelViewMatrix),Tt.isImmediateRenderObject){const cr=Xm(Jt,Te,tn,Tt);rn.setMaterial(tn),Sa.reset(),function(an,Ar){an.render(function(Wn){N.renderBufferImmediate(Wn,Ar)})}(Tt,cr)}else tn.transparent===!0&&tn.side===F?(tn.side=L,tn.needsUpdate=!0,N.renderBufferDirect(Jt,Te,Me,tn,Tt,zr),tn.side=Gt,tn.needsUpdate=!0,N.renderBufferDirect(Jt,Te,Me,tn,Tt,zr),tn.side=F):N.renderBufferDirect(Jt,Te,Me,tn,Tt,zr);Tt.onAfterRender(N,Te,Jt,Me,tn,zr)}function Nm(Tt,Te,Jt){Te.isScene!==!0&&(Te=De);const Me=pt.get(Tt),tn=M.state.lights,zr=M.state.shadowsArray,cr=tn.state.version,an=zn.getParameters(Tt,tn.state,zr,Te,Jt),Ar=zn.getProgramCacheKey(an);let Wn=Me.programs;Me.environment=Tt.isMeshStandardMaterial?Te.environment:null,Me.fog=Te.fog,Me.envMap=be.get(Tt.envMap||Me.environment),Wn===void 0&&(Tt.addEventListener("dispose",Hm),Wn=new Map,Me.programs=Wn);let Br=Wn.get(Ar);if(Br!==void 0){if(Me.currentProgram===Br&&Me.lightsStateVersion===cr)return Wm(Tt,an),Br}else an.uniforms=zn.getUniforms(Tt),Tt.onBuild(an,N),Tt.onBeforeCompile(an,N),Br=zn.acquireProgram(an,Ar),Wn.set(Ar,Br),Me.uniforms=an.uniforms;const sr=Me.uniforms;(Tt.isShaderMaterial||Tt.isRawShaderMaterial)&&Tt.clipping!==!0||(sr.clippingPlanes=Vo.uniform),Wm(Tt,an),Me.needsLights=function(Pi){return Pi.isMeshLambertMaterial||Pi.isMeshToonMaterial||Pi.isMeshPhongMaterial||Pi.isMeshStandardMaterial||Pi.isShadowMaterial||Pi.isShaderMaterial&&Pi.lights===!0}(Tt),Me.lightsStateVersion=cr,Me.needsLights&&(sr.ambientLightColor.value=tn.state.ambient,sr.lightProbe.value=tn.state.probe,sr.directionalLights.value=tn.state.directional,sr.directionalLightShadows.value=tn.state.directionalShadow,sr.spotLights.value=tn.state.spot,sr.spotLightShadows.value=tn.state.spotShadow,sr.rectAreaLights.value=tn.state.rectArea,sr.ltc_1.value=tn.state.rectAreaLTC1,sr.ltc_2.value=tn.state.rectAreaLTC2,sr.pointLights.value=tn.state.point,sr.pointLightShadows.value=tn.state.pointShadow,sr.hemisphereLights.value=tn.state.hemi,sr.directionalShadowMap.value=tn.state.directionalShadowMap,sr.directionalShadowMatrix.value=tn.state.directionalShadowMatrix,sr.spotShadowMap.value=tn.state.spotShadowMap,sr.spotShadowMatrix.value=tn.state.spotShadowMatrix,sr.pointShadowMap.value=tn.state.pointShadowMap,sr.pointShadowMatrix.value=tn.state.pointShadowMatrix);const Dr=Br.getUniforms(),Lo=za.seqWithValue(Dr.seq,sr);return Me.currentProgram=Br,Me.uniformsList=Lo,Br}function Wm(Tt,Te){const Jt=pt.get(Tt);Jt.outputEncoding=Te.outputEncoding,Jt.instancing=Te.instancing,Jt.skinning=Te.skinning,Jt.numClippingPlanes=Te.numClippingPlanes,Jt.numIntersection=Te.numClipIntersection,Jt.vertexAlphas=Te.vertexAlphas}function Xm(Tt,Te,Jt,Me){Te.isScene!==!0&&(Te=De),Ut.resetTextureUnits();const tn=Te.fog,zr=Jt.isMeshStandardMaterial?Te.environment:null,cr=at===null?N.outputEncoding:at.texture.encoding,an=be.get(Jt.envMap||zr),Ar=Jt.vertexColors===!0&&Me.geometry&&Me.geometry.attributes.color&&Me.geometry.attributes.color.itemSize===4,Wn=pt.get(Jt),Br=M.state.lights;if(vn===!0&&(En===!0||Tt!==yt)){const Us=Tt===yt&&Jt.id===st;Vo.setState(Jt,Tt,Us)}let sr=!1;Jt.version===Wn.__version?Wn.needsLights&&Wn.lightsStateVersion!==Br.state.version||Wn.outputEncoding!==cr||Me.isInstancedMesh&&Wn.instancing===!1?sr=!0:Me.isInstancedMesh||Wn.instancing!==!0?Me.isSkinnedMesh&&Wn.skinning===!1?sr=!0:Me.isSkinnedMesh||Wn.skinning!==!0?Wn.envMap!==an||Jt.fog&&Wn.fog!==tn?sr=!0:Wn.numClippingPlanes===void 0||Wn.numClippingPlanes===Vo.numPlanes&&Wn.numIntersection===Vo.numIntersection?Wn.vertexAlphas!==Ar&&(sr=!0):sr=!0:sr=!0:sr=!0:(sr=!0,Wn.__version=Jt.version);let Dr=Wn.currentProgram;sr===!0&&(Dr=Nm(Jt,Te,Me));let Lo=!1,Pi=!1,bl=!1;const Si=Dr.getUniforms(),gh=Wn.uniforms;if(rn.useProgram(Dr.program)&&(Lo=!0,Pi=!0,bl=!0),Jt.id!==st&&(st=Jt.id,Pi=!0),Lo||yt!==Tt){if(Si.setValue(Ye,"projectionMatrix",Tt.projectionMatrix),nn.logarithmicDepthBuffer&&Si.setValue(Ye,"logDepthBufFC",2/(Math.log(Tt.far+1)/Math.LN2)),yt!==Tt&&(yt=Tt,Pi=!0,bl=!0),Jt.isShaderMaterial||Jt.isMeshPhongMaterial||Jt.isMeshToonMaterial||Jt.isMeshStandardMaterial||Jt.envMap){const Us=Si.map.cameraPosition;Us!==void 0&&Us.setValue(Ye,Mt.setFromMatrixPosition(Tt.matrixWorld))}(Jt.isMeshPhongMaterial||Jt.isMeshToonMaterial||Jt.isMeshLambertMaterial||Jt.isMeshBasicMaterial||Jt.isMeshStandardMaterial||Jt.isShaderMaterial)&&Si.setValue(Ye,"isOrthographic",Tt.isOrthographicCamera===!0),(Jt.isMeshPhongMaterial||Jt.isMeshToonMaterial||Jt.isMeshLambertMaterial||Jt.isMeshBasicMaterial||Jt.isMeshStandardMaterial||Jt.isShaderMaterial||Jt.isShadowMaterial||Me.isSkinnedMesh)&&Si.setValue(Ye,"viewMatrix",Tt.matrixWorldInverse)}if(Me.isSkinnedMesh){Si.setOptional(Ye,Me,"bindMatrix"),Si.setOptional(Ye,Me,"bindMatrixInverse");const Us=Me.skeleton;Us&&(nn.floatVertexTextures?(Us.boneTexture===null&&Us.computeBoneTexture(),Si.setValue(Ye,"boneTexture",Us.boneTexture,Ut),Si.setValue(Ye,"boneTextureSize",Us.boneTextureSize)):Si.setOptional(Ye,Us,"boneMatrices"))}var Wo,Ka;return(Pi||Wn.receiveShadow!==Me.receiveShadow)&&(Wn.receiveShadow=Me.receiveShadow,Si.setValue(Ye,"receiveShadow",Me.receiveShadow)),Pi&&(Si.setValue(Ye,"toneMappingExposure",N.toneMappingExposure),Wn.needsLights&&(Ka=bl,(Wo=gh).ambientLightColor.needsUpdate=Ka,Wo.lightProbe.needsUpdate=Ka,Wo.directionalLights.needsUpdate=Ka,Wo.directionalLightShadows.needsUpdate=Ka,Wo.pointLights.needsUpdate=Ka,Wo.pointLightShadows.needsUpdate=Ka,Wo.spotLights.needsUpdate=Ka,Wo.spotLightShadows.needsUpdate=Ka,Wo.rectAreaLights.needsUpdate=Ka,Wo.hemisphereLights.needsUpdate=Ka),tn&&Jt.fog&&In.refreshFogUniforms(gh,tn),In.refreshMaterialUniforms(gh,Jt,ve,ge,Tn),za.upload(Ye,Wn.uniformsList,gh,Ut)),Jt.isShaderMaterial&&Jt.uniformsNeedUpdate===!0&&(za.upload(Ye,Wn.uniformsList,gh,Ut),Jt.uniformsNeedUpdate=!1),Jt.isSpriteMaterial&&Si.setValue(Ye,"center",Me.center),Si.setValue(Ye,"modelViewMatrix",Me.modelViewMatrix),Si.setValue(Ye,"normalMatrix",Me.normalMatrix),Si.setValue(Ye,"modelMatrix",Me.matrixWorld),Dr}xp.setAnimationLoop(function(Tt){Dm&&Dm(Tt)}),typeof window!="undefined"&&xp.setContext(window),this.setAnimationLoop=function(Tt){Dm=Tt,$a.setAnimationLoop(Tt),Tt===null?xp.stop():xp.start()},$a.addEventListener("sessionstart",zm),$a.addEventListener("sessionend",jm),this.render=function(Tt,Te){if(Te!==void 0&&Te.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(O===!0)return;Tt.autoUpdate===!0&&Tt.updateMatrixWorld(),Te.parent===null&&Te.updateMatrixWorld(),$a.enabled===!0&&$a.isPresenting===!0&&($a.cameraAutoUpdate===!0&&$a.updateCamera(Te),Te=$a.getCamera()),Tt.isScene===!0&&Tt.onBeforeRender(N,Tt,Te,at),M=Tr.get(Tt,I.length),M.init(),I.push(M),wt.multiplyMatrices(Te.projectionMatrix,Te.matrixWorldInverse),fn.setFromProjectionMatrix(wt),En=this.localClippingEnabled,vn=Vo.init(this.clippingPlanes,En,Te),A=wr.get(Tt,P.length),A.init(),P.push(A),function cr(an,Ar,Wn,Br){if(an.visible===!1)return;if(an.layers.test(Ar.layers)){if(an.isGroup)Wn=an.renderOrder;else if(an.isLOD)an.autoUpdate===!0&&an.update(Ar);else if(an.isLight)M.pushLight(an),an.castShadow&&M.pushShadow(an);else if(an.isSprite){if(!an.frustumCulled||fn.intersectsSprite(an)){Br&&Mt.setFromMatrixPosition(an.matrixWorld).applyMatrix4(wt);const Dr=xn.update(an),Lo=an.material;Lo.visible&&A.push(an,Dr,Lo,Wn,Mt.z,null)}}else if(an.isImmediateRenderObject)Br&&Mt.setFromMatrixPosition(an.matrixWorld).applyMatrix4(wt),A.push(an,null,an.material,Wn,Mt.z,null);else if((an.isMesh||an.isLine||an.isPoints)&&(an.isSkinnedMesh&&an.skeleton.frame!==_e.render.frame&&(an.skeleton.update(),an.skeleton.frame=_e.render.frame),!an.frustumCulled||fn.intersectsObject(an))){Br&&Mt.setFromMatrixPosition(an.matrixWorld).applyMatrix4(wt);const Dr=xn.update(an),Lo=an.material;if(Array.isArray(Lo)){const Pi=Dr.groups;for(let bl=0,Si=Pi.length;bl<Si;bl++){const gh=Pi[bl],Wo=Lo[gh.materialIndex];Wo&&Wo.visible&&A.push(an,Dr,Wo,Wn,Mt.z,gh)}}else Lo.visible&&A.push(an,Dr,Lo,Wn,Mt.z,null)}}const sr=an.children;for(let Dr=0,Lo=sr.length;Dr<Lo;Dr++)cr(sr[Dr],Ar,Wn,Br)}(Tt,Te,0,N.sortObjects),A.finish(),N.sortObjects===!0&&A.sort(ce,Ot),vn===!0&&Vo.beginShadows();const Jt=M.state.shadowsArray;Ti.render(Jt,Tt,Te),M.setupLights(),M.setupLightsView(Te),vn===!0&&Vo.endShadows(),this.info.autoReset===!0&&this.info.reset(),xl.render(A,Tt);const Me=A.opaque,tn=A.transmissive,zr=A.transparent;Me.length>0&&Sm(Me,Tt,Te),tn.length>0&&function(cr,an,Ar,Wn){if(Tn===null){const Dr=p===!0&&nn.isWebGL2===!0;Tn=new(Dr?Dl:To)(1024,1024,{generateMipmaps:!0,type:ta.convert(Pt)!==null?Pt:Oo,minFilter:gi,magFilter:Kt,wrapS:re,wrapT:re})}const Br=N.getRenderTarget();N.setRenderTarget(Tn),N.clear();const sr=N.toneMapping;N.toneMapping=Lr,Sm(cr,Ar,Wn),N.toneMapping=sr,Ut.updateMultisampleRenderTarget(Tn),Ut.updateRenderTargetMipmap(Tn),N.setRenderTarget(Br),Sm(an,Ar,Wn)}(Me,tn,Tt,Te),zr.length>0&&Sm(zr,Tt,Te),at!==null&&(Ut.updateMultisampleRenderTarget(at),Ut.updateRenderTargetMipmap(at)),Tt.isScene===!0&&Tt.onAfterRender(N,Tt,Te),rn.buffers.depth.setTest(!0),rn.buffers.depth.setMask(!0),rn.buffers.color.setMask(!0),rn.setPolygonOffset(!1),Sa.resetDefaultState(),st=-1,yt=null,I.pop(),M=I.length>0?I[I.length-1]:null,P.pop(),A=P.length>0?P[P.length-1]:null},this.getActiveCubeFace=function(){return V},this.getActiveMipmapLevel=function(){return Y},this.getRenderTarget=function(){return at},this.setRenderTarget=function(Tt,Te=0,Jt=0){at=Tt,V=Te,Y=Jt,Tt&&pt.get(Tt).__webglFramebuffer===void 0&&Ut.setupRenderTarget(Tt);let Me=null,tn=!1,zr=!1;if(Tt){const cr=Tt.texture;(cr.isDataTexture3D||cr.isDataTexture2DArray)&&(zr=!0);const an=pt.get(Tt).__webglFramebuffer;Tt.isWebGLCubeRenderTarget?(Me=an[Te],tn=!0):Me=Tt.isWebGLMultisampleRenderTarget?pt.get(Tt).__webglMultisampledFramebuffer:an,bt.copy(Tt.viewport),_t.copy(Tt.scissor),Et=Tt.scissorTest}else bt.copy(ee).multiplyScalar(ve).floor(),_t.copy(We).multiplyScalar(ve).floor(),Et=ze;if(rn.bindFramebuffer(36160,Me)&&nn.drawBuffers){let cr=!1;if(Tt)if(Tt.isWebGLMultipleRenderTargets){const an=Tt.texture;if(Ue.length!==an.length||Ue[0]!==36064){for(let Ar=0,Wn=an.length;Ar<Wn;Ar++)Ue[Ar]=36064+Ar;Ue.length=an.length,cr=!0}}else Ue.length===1&&Ue[0]===36064||(Ue[0]=36064,Ue.length=1,cr=!0);else Ue.length===1&&Ue[0]===1029||(Ue[0]=1029,Ue.length=1,cr=!0);cr&&(nn.isWebGL2?Ye.drawBuffers(Ue):se.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ue))}if(rn.viewport(bt),rn.scissor(_t),rn.setScissorTest(Et),tn){const cr=pt.get(Tt.texture);Ye.framebufferTexture2D(36160,36064,34069+Te,cr.__webglTexture,Jt)}else if(zr){const cr=pt.get(Tt.texture),an=Te||0;Ye.framebufferTextureLayer(36160,36064,cr.__webglTexture,Jt||0,an)}},this.readRenderTargetPixels=function(Tt,Te,Jt,Me,tn,zr,cr){if(!Tt||!Tt.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let an=pt.get(Tt).__webglFramebuffer;if(Tt.isWebGLCubeRenderTarget&&cr!==void 0&&(an=an[cr]),an){rn.bindFramebuffer(36160,an);try{const Ar=Tt.texture,Wn=Ar.format,Br=Ar.type;if(Wn!==Sn&&ta.convert(Wn)!==Ye.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const sr=Br===Pt&&(se.has("EXT_color_buffer_half_float")||nn.isWebGL2&&se.has("EXT_color_buffer_float"));if(!(Br===Oo||ta.convert(Br)===Ye.getParameter(35738)||Br===jt&&(nn.isWebGL2||se.has("OES_texture_float")||se.has("WEBGL_color_buffer_float"))||sr))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Ye.checkFramebufferStatus(36160)===36053?Te>=0&&Te<=Tt.width-Me&&Jt>=0&&Jt<=Tt.height-tn&&Ye.readPixels(Te,Jt,Me,tn,ta.convert(Wn),ta.convert(Br),zr):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Ar=at!==null?pt.get(at).__webglFramebuffer:null;rn.bindFramebuffer(36160,Ar)}}},this.copyFramebufferToTexture=function(Tt,Te,Jt=0){const Me=Math.pow(2,-Jt),tn=Math.floor(Te.image.width*Me),zr=Math.floor(Te.image.height*Me);let cr=ta.convert(Te.format);nn.isWebGL2&&(cr===6407&&(cr=32849),cr===6408&&(cr=32856)),Ut.setTexture2D(Te,0),Ye.copyTexImage2D(3553,Jt,cr,Tt.x,Tt.y,tn,zr,0),rn.unbindTexture()},this.copyTextureToTexture=function(Tt,Te,Jt,Me=0){const tn=Te.image.width,zr=Te.image.height,cr=ta.convert(Jt.format),an=ta.convert(Jt.type);Ut.setTexture2D(Jt,0),Ye.pixelStorei(37440,Jt.flipY),Ye.pixelStorei(37441,Jt.premultiplyAlpha),Ye.pixelStorei(3317,Jt.unpackAlignment),Te.isDataTexture?Ye.texSubImage2D(3553,Me,Tt.x,Tt.y,tn,zr,cr,an,Te.image.data):Te.isCompressedTexture?Ye.compressedTexSubImage2D(3553,Me,Tt.x,Tt.y,Te.mipmaps[0].width,Te.mipmaps[0].height,cr,Te.mipmaps[0].data):Ye.texSubImage2D(3553,Me,Tt.x,Tt.y,cr,an,Te.image),Me===0&&Jt.generateMipmaps&&Ye.generateMipmap(3553),rn.unbindTexture()},this.copyTextureToTexture3D=function(Tt,Te,Jt,Me,tn=0){if(N.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const zr=Tt.max.x-Tt.min.x+1,cr=Tt.max.y-Tt.min.y+1,an=Tt.max.z-Tt.min.z+1,Ar=ta.convert(Me.format),Wn=ta.convert(Me.type);let Br;if(Me.isDataTexture3D)Ut.setTexture3D(Me,0),Br=32879;else{if(!Me.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Ut.setTexture2DArray(Me,0),Br=35866}Ye.pixelStorei(37440,Me.flipY),Ye.pixelStorei(37441,Me.premultiplyAlpha),Ye.pixelStorei(3317,Me.unpackAlignment);const sr=Ye.getParameter(3314),Dr=Ye.getParameter(32878),Lo=Ye.getParameter(3316),Pi=Ye.getParameter(3315),bl=Ye.getParameter(32877),Si=Jt.isCompressedTexture?Jt.mipmaps[0]:Jt.image;Ye.pixelStorei(3314,Si.width),Ye.pixelStorei(32878,Si.height),Ye.pixelStorei(3316,Tt.min.x),Ye.pixelStorei(3315,Tt.min.y),Ye.pixelStorei(32877,Tt.min.z),Jt.isDataTexture||Jt.isDataTexture3D?Ye.texSubImage3D(Br,tn,Te.x,Te.y,Te.z,zr,cr,an,Ar,Wn,Si.data):Jt.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ye.compressedTexSubImage3D(Br,tn,Te.x,Te.y,Te.z,zr,cr,an,Ar,Si.data)):Ye.texSubImage3D(Br,tn,Te.x,Te.y,Te.z,zr,cr,an,Ar,Wn,Si),Ye.pixelStorei(3314,sr),Ye.pixelStorei(32878,Dr),Ye.pixelStorei(3316,Lo),Ye.pixelStorei(3315,Pi),Ye.pixelStorei(32877,bl),tn===0&&Me.generateMipmaps&&Ye.generateMipmap(Br),rn.unbindTexture()},this.initTexture=function(Tt){Ut.setTexture2D(Tt,0),rn.unbindTexture()},this.resetState=function(){V=0,Y=0,at=null,rn.reset(),Sa.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class jc extends Yr{}jc.prototype.isWebGL1Renderer=!0;class sl{constructor(t,i=25e-5){this.name="",this.color=new pn(t),this.density=i}clone(){return new sl(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}sl.prototype.isFogExp2=!0;class Pu{constructor(t,i=1,a=1e3){this.name="",this.color=new pn(t),this.near=i,this.far=a}clone(){return new Pu(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Pu.prototype.isFog=!0;class Kl extends mr{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,i){return super.copy(t,i),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const i=super.toJSON(t);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),i}}Kl.prototype.isScene=!0;class Cu{constructor(t,i){this.array=t,this.stride=i,this.count=t!==void 0?t.length/i:0,this.usage=Ri,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=wo()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,i,a){t*=this.stride,a*=i.stride;for(let u=0,d=this.stride;u<d;u++)this.array[t+u]=i.array[a+u];return this}set(t,i=0){return this.array.set(t,i),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=wo()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),a=new this.constructor(i,this.stride);return a.setUsage(this.usage),a}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=wo()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Cu.prototype.isInterleavedBuffer=!0;const Fi=new ot;class oi{constructor(t,i,a,u=!1){this.name="",this.data=t,this.itemSize=i,this.offset=a,this.normalized=u===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let i=0,a=this.data.count;i<a;i++)Fi.x=this.getX(i),Fi.y=this.getY(i),Fi.z=this.getZ(i),Fi.applyMatrix4(t),this.setXYZ(i,Fi.x,Fi.y,Fi.z);return this}applyNormalMatrix(t){for(let i=0,a=this.count;i<a;i++)Fi.x=this.getX(i),Fi.y=this.getY(i),Fi.z=this.getZ(i),Fi.applyNormalMatrix(t),this.setXYZ(i,Fi.x,Fi.y,Fi.z);return this}transformDirection(t){for(let i=0,a=this.count;i<a;i++)Fi.x=this.getX(i),Fi.y=this.getY(i),Fi.z=this.getZ(i),Fi.transformDirection(t),this.setXYZ(i,Fi.x,Fi.y,Fi.z);return this}setX(t,i){return this.data.array[t*this.data.stride+this.offset]=i,this}setY(t,i){return this.data.array[t*this.data.stride+this.offset+1]=i,this}setZ(t,i){return this.data.array[t*this.data.stride+this.offset+2]=i,this}setW(t,i){return this.data.array[t*this.data.stride+this.offset+3]=i,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,i,a){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=a,this}setXYZ(t,i,a,u){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=a,this.data.array[t+2]=u,this}setXYZW(t,i,a,u,d){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=a,this.data.array[t+2]=u,this.data.array[t+3]=d,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let a=0;a<this.count;a++){const u=a*this.data.stride+this.offset;for(let d=0;d<this.itemSize;d++)i.push(this.data.array[u+d])}return new yr(new this.array.constructor(i),this.itemSize,this.normalized)}return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new oi(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let a=0;a<this.count;a++){const u=a*this.data.stride+this.offset;for(let d=0;d<this.itemSize;d++)i.push(this.data.array[u+d])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}oi.prototype.isInterleavedBufferAttribute=!0;class vo extends zi{constructor(t){super(),this.type="SpriteMaterial",this.color=new pn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let al;vo.prototype.isSpriteMaterial=!0;const Ql=new ot,ul=new ot,th=new ot,Ru=new Ge,Zs=new Ge,Vc=new wn,ma=new ot,$h=new ot,eh=new ot,Xd=new Ge,Yd=new Ge,qd=new Ge;class nh extends mr{constructor(t){if(super(),this.type="Sprite",al===void 0){al=new Hn;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),a=new Cu(i,5);al.setIndex([0,1,2,0,2,3]),al.setAttribute("position",new oi(a,3,0,!1)),al.setAttribute("uv",new oi(a,2,3,!1))}this.geometry=al,this.material=t!==void 0?t:new vo,this.center=new Ge(.5,.5)}raycast(t,i){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ul.setFromMatrixScale(this.matrixWorld),Vc.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),th.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&ul.multiplyScalar(-th.z);const a=this.material.rotation;let u,d;a!==0&&(d=Math.cos(a),u=Math.sin(a));const p=this.center;Wc(ma.set(-.5,-.5,0),th,p,ul,u,d),Wc($h.set(.5,-.5,0),th,p,ul,u,d),Wc(eh.set(.5,.5,0),th,p,ul,u,d),Xd.set(0,0),Yd.set(1,0),qd.set(1,1);let v=t.ray.intersectTriangle(ma,$h,eh,!1,Ql);if(v===null&&(Wc($h.set(-.5,.5,0),th,p,ul,u,d),Yd.set(0,1),v=t.ray.intersectTriangle(ma,eh,$h,!1,Ql),v===null))return;const _=t.ray.origin.distanceTo(Ql);_<t.near||_>t.far||i.push({distance:_,point:Ql.clone(),uv:Mi.getUV(Ql,ma,$h,eh,Xd,Yd,qd,new Ge),face:null,object:this})}copy(t){return super.copy(t),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}}function Wc(f,t,i,a,u,d){Ru.subVectors(f,i).addScalar(.5).multiply(a),u!==void 0?(Zs.x=d*Ru.x-u*Ru.y,Zs.y=u*Ru.x+d*Ru.y):Zs.copy(Ru),f.copy(t),f.x+=Zs.x,f.y+=Zs.y,f.applyMatrix4(Vc)}nh.prototype.isSprite=!0;const Iu=new ot,kp=new ot;class Xc extends mr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const i=t.levels;for(let a=0,u=i.length;a<u;a++){const d=i[a];this.addLevel(d.object.clone(),d.distance)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,i=0){i=Math.abs(i);const a=this.levels;let u;for(u=0;u<a.length&&!(i<a[u].distance);u++);return a.splice(u,0,{distance:i,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const i=this.levels;if(i.length>0){let a,u;for(a=1,u=i.length;a<u&&!(t<i[a].distance);a++);return i[a-1].object}return null}raycast(t,i){if(this.levels.length>0){Iu.setFromMatrixPosition(this.matrixWorld);const a=t.ray.origin.distanceTo(Iu);this.getObjectForDistance(a).raycast(t,i)}}update(t){const i=this.levels;if(i.length>1){Iu.setFromMatrixPosition(t.matrixWorld),kp.setFromMatrixPosition(this.matrixWorld);const a=Iu.distanceTo(kp)/t.zoom;let u,d;for(i[0].object.visible=!0,u=1,d=i.length;u<d&&a>=i[u].distance;u++)i[u-1].object.visible=!1,i[u].object.visible=!0;for(this._currentLevel=u-1;u<d;u++)i[u].object.visible=!1}}toJSON(t){const i=super.toJSON(t);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const a=this.levels;for(let u=0,d=a.length;u<d;u++){const p=a[u];i.object.levels.push({object:p.object.uuid,distance:p.distance})}return i}}const Zd=new ot,Jd=new Rr,Gp=new Rr,Kh=new ot,Qh=new wn;class ll extends Ni{constructor(t,i){super(t,i),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new wn,this.bindMatrixInverse=new wn}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,i){this.skeleton=t,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Rr,i=this.geometry.attributes.skinWeight;for(let a=0,u=i.count;a<u;a++){t.x=i.getX(a),t.y=i.getY(a),t.z=i.getZ(a),t.w=i.getW(a);const d=1/t.manhattanLength();d!==1/0?t.multiplyScalar(d):t.set(1,0,0,0),i.setXYZW(a,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,i){const a=this.skeleton,u=this.geometry;Jd.fromBufferAttribute(u.attributes.skinIndex,t),Gp.fromBufferAttribute(u.attributes.skinWeight,t),Zd.fromBufferAttribute(u.attributes.position,t).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let d=0;d<4;d++){const p=Gp.getComponent(d);if(p!==0){const v=Jd.getComponent(d);Qh.multiplyMatrices(a.bones[v].matrixWorld,a.boneInverses[v]),i.addScaledVector(Kh.copy(Zd).applyMatrix4(Qh),p)}}return i.applyMatrix4(this.bindMatrixInverse)}}ll.prototype.isSkinnedMesh=!0;class io extends mr{constructor(){super(),this.type="Bone"}}io.prototype.isBone=!0;class Ro extends ui{constructor(t=null,i=1,a=1,u,d,p,v,_,y=Kt,E=Kt,A,M){super(null,p,v,_,y,E,u,d,A,M),this.image={data:t,width:i,height:a},this.magFilter=y,this.minFilter=E,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Ro.prototype.isDataTexture=!0;const $d=new wn,Yc=new wn;class hl{constructor(t=[],i=[]){this.uuid=wo(),this.bones=t.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),i.length===0)this.calculateInverses();else if(t.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let a=0,u=this.bones.length;a<u;a++)this.boneInverses.push(new wn)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,i=this.bones.length;t<i;t++){const a=new wn;this.bones[t]&&a.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(a)}}pose(){for(let t=0,i=this.bones.length;t<i;t++){const a=this.bones[t];a&&a.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,i=this.bones.length;t<i;t++){const a=this.bones[t];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}update(){const t=this.bones,i=this.boneInverses,a=this.boneMatrices,u=this.boneTexture;for(let d=0,p=t.length;d<p;d++){const v=t[d]?t[d].matrixWorld:Yc;$d.multiplyMatrices(v,i[d]),$d.toArray(a,16*d)}u!==null&&(u.needsUpdate=!0)}clone(){return new hl(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=to(t),t=Math.max(t,4);const i=new Float32Array(t*t*4);i.set(this.boneMatrices);const a=new Ro(i,t,t,Sn,jt);return this.boneMatrices=i,this.boneTexture=a,this.boneTextureSize=t,this}getBoneByName(t){for(let i=0,a=this.bones.length;i<a;i++){const u=this.bones[i];if(u.name===t)return u}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,i){this.uuid=t.uuid;for(let a=0,u=t.bones.length;a<u;a++){const d=t.bones[a];let p=i[d];p===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",d),p=new io),this.bones.push(p),this.boneInverses.push(new wn().fromArray(t.boneInverses[a]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const i=this.bones,a=this.boneInverses;for(let u=0,d=i.length;u<d;u++){const p=i[u];t.bones.push(p.uuid);const v=a[u];t.boneInverses.push(v.toArray())}return t}}const tc=new wn,Kd=new wn,ec=[],rh=new Ni;class qc extends Ni{constructor(t,i,a){super(t,i),this.instanceMatrix=new yr(new Float32Array(16*a),16),this.instanceColor=null,this.count=a,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,i){i.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,i){i.fromArray(this.instanceMatrix.array,16*t)}raycast(t,i){const a=this.matrixWorld,u=this.count;if(rh.geometry=this.geometry,rh.material=this.material,rh.material!==void 0)for(let d=0;d<u;d++){this.getMatrixAt(d,tc),Kd.multiplyMatrices(a,tc),rh.matrixWorld=Kd,rh.raycast(t,ec);for(let p=0,v=ec.length;p<v;p++){const _=ec[p];_.instanceId=d,_.object=this,i.push(_)}ec.length=0}}setColorAt(t,i){this.instanceColor===null&&(this.instanceColor=new yr(new Float32Array(3*this.count),3)),i.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,i){i.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}qc.prototype.isInstancedMesh=!0;class oo extends zi{constructor(t){super(),this.type="LineBasicMaterial",this.color=new pn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this}}oo.prototype.isLineBasicMaterial=!0;const nc=new ot,Zc=new ot,ih=new wn,Qd=new cs,Jc=new Jo;class Va extends mr{constructor(t=new Hn,i=new oo){super(),this.type="Line",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const i=t.attributes.position,a=[0];for(let u=1,d=i.count;u<d;u++)nc.fromBufferAttribute(i,u-1),Zc.fromBufferAttribute(i,u),a[u]=a[u-1],a[u]+=nc.distanceTo(Zc);t.setAttribute("lineDistance",new yn(a,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,i){const a=this.geometry,u=this.matrixWorld,d=t.params.Line.threshold,p=a.drawRange;if(a.boundingSphere===null&&a.computeBoundingSphere(),Jc.copy(a.boundingSphere),Jc.applyMatrix4(u),Jc.radius+=d,t.ray.intersectsSphere(Jc)===!1)return;ih.copy(u).invert(),Qd.copy(t.ray).applyMatrix4(ih);const v=d/((this.scale.x+this.scale.y+this.scale.z)/3),_=v*v,y=new ot,E=new ot,A=new ot,M=new ot,P=this.isLineSegments?2:1;if(a.isBufferGeometry){const I=a.index,N=a.attributes.position;if(I!==null)for(let O=Math.max(0,p.start),V=Math.min(I.count,p.start+p.count)-1;O<V;O+=P){const Y=I.getX(O),at=I.getX(O+1);if(y.fromBufferAttribute(N,Y),E.fromBufferAttribute(N,at),Qd.distanceSqToSegment(y,E,M,A)>_)continue;M.applyMatrix4(this.matrixWorld);const st=t.ray.origin.distanceTo(M);st<t.near||st>t.far||i.push({distance:st,point:A.clone().applyMatrix4(this.matrixWorld),index:O,face:null,faceIndex:null,object:this})}else for(let O=Math.max(0,p.start),V=Math.min(N.count,p.start+p.count)-1;O<V;O+=P){if(y.fromBufferAttribute(N,O),E.fromBufferAttribute(N,O+1),Qd.distanceSqToSegment(y,E,M,A)>_)continue;M.applyMatrix4(this.matrixWorld);const Y=t.ray.origin.distanceTo(M);Y<t.near||Y>t.far||i.push({distance:Y,point:A.clone().applyMatrix4(this.matrixWorld),index:O,face:null,faceIndex:null,object:this})}}else a.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const i=t.morphAttributes,a=Object.keys(i);if(a.length>0){const u=i[a[0]];if(u!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,p=u.length;d<p;d++){const v=u[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=d}}}}else{const i=t.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Va.prototype.isLine=!0;const Hp=new ot,$c=new ot;class ts extends Va{constructor(t,i){super(t,i),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const i=t.attributes.position,a=[];for(let u=0,d=i.count;u<d;u+=2)Hp.fromBufferAttribute(i,u),$c.fromBufferAttribute(i,u+1),a[u]=u===0?0:a[u-1],a[u+1]=a[u]+Hp.distanceTo($c);t.setAttribute("lineDistance",new yn(a,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}ts.prototype.isLineSegments=!0;class tp extends Va{constructor(t,i){super(t,i),this.type="LineLoop"}}tp.prototype.isLineLoop=!0;class cl extends zi{constructor(t){super(),this.type="PointsMaterial",this.color=new pn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this}}cl.prototype.isPointsMaterial=!0;const c=new wn,g=new cs,S=new Jo,D=new ot;class H extends mr{constructor(t=new Hn,i=new cl){super(),this.type="Points",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,i){const a=this.geometry,u=this.matrixWorld,d=t.params.Points.threshold,p=a.drawRange;if(a.boundingSphere===null&&a.computeBoundingSphere(),S.copy(a.boundingSphere),S.applyMatrix4(u),S.radius+=d,t.ray.intersectsSphere(S)===!1)return;c.copy(u).invert(),g.copy(t.ray).applyMatrix4(c);const v=d/((this.scale.x+this.scale.y+this.scale.z)/3),_=v*v;if(a.isBufferGeometry){const y=a.index,E=a.attributes.position;if(y!==null)for(let A=Math.max(0,p.start),M=Math.min(y.count,p.start+p.count);A<M;A++){const P=y.getX(A);D.fromBufferAttribute(E,P),it(D,P,_,u,t,i,this)}else for(let A=Math.max(0,p.start),M=Math.min(E.count,p.start+p.count);A<M;A++)D.fromBufferAttribute(E,A),it(D,A,_,u,t,i,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const i=t.morphAttributes,a=Object.keys(i);if(a.length>0){const u=i[a[0]];if(u!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,p=u.length;d<p;d++){const v=u[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=d}}}}else{const i=t.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function it(f,t,i,a,u,d,p){const v=g.distanceSqToPoint(f);if(v<i){const _=new ot;g.closestPointToPoint(f,_),_.applyMatrix4(a);const y=u.ray.origin.distanceTo(_);if(y<u.near||y>u.far)return;d.push({distance:y,distanceToRay:Math.sqrt(v),point:_,index:t,face:null,object:p})}}H.prototype.isPoints=!0;class vt extends ui{constructor(t,i,a,u,d,p,v,_,y){super(t,i,a,u,d,p,v,_,y),this.format=v!==void 0?v:_n,this.minFilter=p!==void 0?p:Un,this.magFilter=d!==void 0?d:Un,this.generateMipmaps=!1;const E=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function A(){E.needsUpdate=!0,t.requestVideoFrameCallback(A)})}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}vt.prototype.isVideoTexture=!0;class St extends ui{constructor(t,i,a,u,d,p,v,_,y,E,A,M){super(null,p,v,_,y,E,u,d,A,M),this.image={width:i,height:a},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}St.prototype.isCompressedTexture=!0;class Ft extends ui{constructor(t,i,a,u,d,p,v,_,y){super(t,i,a,u,d,p,v,_,y),this.needsUpdate=!0}}Ft.prototype.isCanvasTexture=!0;class ae extends ui{constructor(t,i,a,u,d,p,v,_,y,E){if((E=E!==void 0?E:ln)!==ln&&E!==or)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");a===void 0&&E===ln&&(a=Aa),a===void 0&&E===or&&(a=un),super(null,u,d,p,v,_,E,a,y),this.image={width:t,height:i},this.magFilter=v!==void 0?v:Kt,this.minFilter=_!==void 0?_:Kt,this.flipY=!1,this.generateMipmaps=!1}}ae.prototype.isDepthTexture=!0;class le extends Hn{constructor(t=1,i=8,a=0,u=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:i,thetaStart:a,thetaLength:u},i=Math.max(3,i);const d=[],p=[],v=[],_=[],y=new ot,E=new Ge;p.push(0,0,0),v.push(0,0,1),_.push(.5,.5);for(let A=0,M=3;A<=i;A++,M+=3){const P=a+A/i*u;y.x=t*Math.cos(P),y.y=t*Math.sin(P),p.push(y.x,y.y,y.z),v.push(0,0,1),E.x=(p[M]/t+1)/2,E.y=(p[M+1]/t+1)/2,_.push(E.x,E.y)}for(let A=1;A<=i;A++)d.push(A,A+1,0);this.setIndex(d),this.setAttribute("position",new yn(p,3)),this.setAttribute("normal",new yn(v,3)),this.setAttribute("uv",new yn(_,2))}static fromJSON(t){return new le(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class Oe extends Hn{constructor(t=1,i=1,a=1,u=8,d=1,p=!1,v=0,_=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:i,height:a,radialSegments:u,heightSegments:d,openEnded:p,thetaStart:v,thetaLength:_};const y=this;u=Math.floor(u),d=Math.floor(d);const E=[],A=[],M=[],P=[];let I=0;const N=[],O=a/2;let V=0;function Y(at){const st=I,yt=new Ge,bt=new ot;let _t=0;const Et=at===!0?t:i,Ce=at===!0?1:-1;for(let ve=1;ve<=u;ve++)A.push(0,O*Ce,0),M.push(0,Ce,0),P.push(.5,.5),I++;const ge=I;for(let ve=0;ve<=u;ve++){const ce=ve/u*_+v,Ot=Math.cos(ce),ee=Math.sin(ce);bt.x=Et*ee,bt.y=O*Ce,bt.z=Et*Ot,A.push(bt.x,bt.y,bt.z),M.push(0,Ce,0),yt.x=.5*Ot+.5,yt.y=.5*ee*Ce+.5,P.push(yt.x,yt.y),I++}for(let ve=0;ve<u;ve++){const ce=st+ve,Ot=ge+ve;at===!0?E.push(Ot,Ot+1,ce):E.push(Ot+1,Ot,ce),_t+=3}y.addGroup(V,_t,at===!0?1:2),V+=_t}(function(){const at=new ot,st=new ot;let yt=0;const bt=(i-t)/a;for(let _t=0;_t<=d;_t++){const Et=[],Ce=_t/d,ge=Ce*(i-t)+t;for(let ve=0;ve<=u;ve++){const ce=ve/u,Ot=ce*_+v,ee=Math.sin(Ot),We=Math.cos(Ot);st.x=ge*ee,st.y=-Ce*a+O,st.z=ge*We,A.push(st.x,st.y,st.z),at.set(ee,bt,We).normalize(),M.push(at.x,at.y,at.z),P.push(ce,1-Ce),Et.push(I++)}N.push(Et)}for(let _t=0;_t<u;_t++)for(let Et=0;Et<d;Et++){const Ce=N[Et][_t],ge=N[Et+1][_t],ve=N[Et+1][_t+1],ce=N[Et][_t+1];E.push(Ce,ge,ce),E.push(ge,ve,ce),yt+=6}y.addGroup(V,yt,0),V+=yt})(),p===!1&&(t>0&&Y(!0),i>0&&Y(!1)),this.setIndex(E),this.setAttribute("position",new yn(A,3)),this.setAttribute("normal",new yn(M,3)),this.setAttribute("uv",new yn(P,2))}static fromJSON(t){return new Oe(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class mn extends Oe{constructor(t=1,i=1,a=8,u=1,d=!1,p=0,v=2*Math.PI){super(0,t,i,a,u,d,p,v),this.type="ConeGeometry",this.parameters={radius:t,height:i,radialSegments:a,heightSegments:u,openEnded:d,thetaStart:p,thetaLength:v}}static fromJSON(t){return new mn(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class gn extends Hn{constructor(t,i,a=1,u=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:i,radius:a,detail:u};const d=[],p=[];function v(M,P,I,N){const O=N+1,V=[];for(let Y=0;Y<=O;Y++){V[Y]=[];const at=M.clone().lerp(I,Y/O),st=P.clone().lerp(I,Y/O),yt=O-Y;for(let bt=0;bt<=yt;bt++)V[Y][bt]=bt===0&&Y===O?at:at.clone().lerp(st,bt/yt)}for(let Y=0;Y<O;Y++)for(let at=0;at<2*(O-Y)-1;at++){const st=Math.floor(at/2);at%2==0?(_(V[Y][st+1]),_(V[Y+1][st]),_(V[Y][st])):(_(V[Y][st+1]),_(V[Y+1][st+1]),_(V[Y+1][st]))}}function _(M){d.push(M.x,M.y,M.z)}function y(M,P){const I=3*M;P.x=t[I+0],P.y=t[I+1],P.z=t[I+2]}function E(M,P,I,N){N<0&&M.x===1&&(p[P]=M.x-1),I.x===0&&I.z===0&&(p[P]=N/2/Math.PI+.5)}function A(M){return Math.atan2(M.z,-M.x)}(function(M){const P=new ot,I=new ot,N=new ot;for(let O=0;O<i.length;O+=3)y(i[O+0],P),y(i[O+1],I),y(i[O+2],N),v(P,I,N,M)})(u),function(M){const P=new ot;for(let I=0;I<d.length;I+=3)P.x=d[I+0],P.y=d[I+1],P.z=d[I+2],P.normalize().multiplyScalar(M),d[I+0]=P.x,d[I+1]=P.y,d[I+2]=P.z}(a),function(){const M=new ot;for(let I=0;I<d.length;I+=3){M.x=d[I+0],M.y=d[I+1],M.z=d[I+2];const N=A(M)/2/Math.PI+.5,O=(P=M,Math.atan2(-P.y,Math.sqrt(P.x*P.x+P.z*P.z))/Math.PI+.5);p.push(N,1-O)}var P;(function(){const I=new ot,N=new ot,O=new ot,V=new ot,Y=new Ge,at=new Ge,st=new Ge;for(let yt=0,bt=0;yt<d.length;yt+=9,bt+=6){I.set(d[yt+0],d[yt+1],d[yt+2]),N.set(d[yt+3],d[yt+4],d[yt+5]),O.set(d[yt+6],d[yt+7],d[yt+8]),Y.set(p[bt+0],p[bt+1]),at.set(p[bt+2],p[bt+3]),st.set(p[bt+4],p[bt+5]),V.copy(I).add(N).add(O).divideScalar(3);const _t=A(V);E(Y,bt+0,I,_t),E(at,bt+2,N,_t),E(st,bt+4,O,_t)}})(),function(){for(let I=0;I<p.length;I+=6){const N=p[I+0],O=p[I+2],V=p[I+4],Y=Math.max(N,O,V),at=Math.min(N,O,V);Y>.9&&at<.1&&(N<.2&&(p[I+0]+=1),O<.2&&(p[I+2]+=1),V<.2&&(p[I+4]+=1))}}()}(),this.setAttribute("position",new yn(d,3)),this.setAttribute("normal",new yn(d.slice(),3)),this.setAttribute("uv",new yn(p,2)),u===0?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(t){return new gn(t.vertices,t.indices,t.radius,t.details)}}class Cn extends gn{constructor(t=1,i=0){const a=(1+Math.sqrt(5))/2,u=1/a;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-u,-a,0,-u,a,0,u,-a,0,u,a,-u,-a,0,-u,a,0,u,-a,0,u,a,0,-a,0,-u,a,0,-u,-a,0,u,a,0,u],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,i),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new Cn(t.radius,t.detail)}}const Se=new ot,Xe=new ot,Xn=new ot,dn=new Mi;class Fn extends Hn{constructor(t,i){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:i},i=i!==void 0?i:1,t.isGeometry===!0)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const a=Math.pow(10,4),u=Math.cos(uo*i),d=t.getIndex(),p=t.getAttribute("position"),v=d?d.count:p.count,_=[0,0,0],y=["a","b","c"],E=new Array(3),A={},M=[];for(let P=0;P<v;P+=3){d?(_[0]=d.getX(P),_[1]=d.getX(P+1),_[2]=d.getX(P+2)):(_[0]=P,_[1]=P+1,_[2]=P+2);const{a:I,b:N,c:O}=dn;if(I.fromBufferAttribute(p,_[0]),N.fromBufferAttribute(p,_[1]),O.fromBufferAttribute(p,_[2]),dn.getNormal(Xn),E[0]=`${Math.round(I.x*a)},${Math.round(I.y*a)},${Math.round(I.z*a)}`,E[1]=`${Math.round(N.x*a)},${Math.round(N.y*a)},${Math.round(N.z*a)}`,E[2]=`${Math.round(O.x*a)},${Math.round(O.y*a)},${Math.round(O.z*a)}`,E[0]!==E[1]&&E[1]!==E[2]&&E[2]!==E[0])for(let V=0;V<3;V++){const Y=(V+1)%3,at=E[V],st=E[Y],yt=dn[y[V]],bt=dn[y[Y]],_t=`${at}_${st}`,Et=`${st}_${at}`;Et in A&&A[Et]?(Xn.dot(A[Et].normal)<=u&&(M.push(yt.x,yt.y,yt.z),M.push(bt.x,bt.y,bt.z)),A[Et]=null):_t in A||(A[_t]={index0:_[V],index1:_[Y],normal:Xn.clone()})}}for(const P in A)if(A[P]){const{index0:I,index1:N}=A[P];Se.fromBufferAttribute(p,I),Xe.fromBufferAttribute(p,N),M.push(Se.x,Se.y,Se.z),M.push(Xe.x,Xe.y,Xe.z)}this.setAttribute("position",new yn(M,3))}}class An{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,i){const a=this.getUtoTmapping(t);return this.getPoint(a,i)}getPoints(t=5){const i=[];for(let a=0;a<=t;a++)i.push(this.getPoint(a/t));return i}getSpacedPoints(t=5){const i=[];for(let a=0;a<=t;a++)i.push(this.getPointAt(a/t));return i}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let a,u=this.getPoint(0),d=0;i.push(0);for(let p=1;p<=t;p++)a=this.getPoint(p/t),d+=a.distanceTo(u),i.push(d),u=a;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,i){const a=this.getLengths();let u=0;const d=a.length;let p;p=i||t*a[d-1];let v,_=0,y=d-1;for(;_<=y;)if(u=Math.floor(_+(y-_)/2),v=a[u]-p,v<0)_=u+1;else{if(!(v>0)){y=u;break}y=u-1}if(u=y,a[u]===p)return u/(d-1);const E=a[u];return(u+(p-E)/(a[u+1]-E))/(d-1)}getTangent(t,i){let a=t-1e-4,u=t+1e-4;a<0&&(a=0),u>1&&(u=1);const d=this.getPoint(a),p=this.getPoint(u),v=i||(d.isVector2?new Ge:new ot);return v.copy(p).sub(d).normalize(),v}getTangentAt(t,i){const a=this.getUtoTmapping(t);return this.getTangent(a,i)}computeFrenetFrames(t,i){const a=new ot,u=[],d=[],p=[],v=new ot,_=new wn;for(let P=0;P<=t;P++){const I=P/t;u[P]=this.getTangentAt(I,new ot),u[P].normalize()}d[0]=new ot,p[0]=new ot;let y=Number.MAX_VALUE;const E=Math.abs(u[0].x),A=Math.abs(u[0].y),M=Math.abs(u[0].z);E<=y&&(y=E,a.set(1,0,0)),A<=y&&(y=A,a.set(0,1,0)),M<=y&&a.set(0,0,1),v.crossVectors(u[0],a).normalize(),d[0].crossVectors(u[0],v),p[0].crossVectors(u[0],d[0]);for(let P=1;P<=t;P++){if(d[P]=d[P-1].clone(),p[P]=p[P-1].clone(),v.crossVectors(u[P-1],u[P]),v.length()>Number.EPSILON){v.normalize();const I=Math.acos(Hi(u[P-1].dot(u[P]),-1,1));d[P].applyMatrix4(_.makeRotationAxis(v,I))}p[P].crossVectors(u[P],d[P])}if(i===!0){let P=Math.acos(Hi(d[0].dot(d[t]),-1,1));P/=t,u[0].dot(v.crossVectors(d[0],d[t]))>0&&(P=-P);for(let I=1;I<=t;I++)d[I].applyMatrix4(_.makeRotationAxis(u[I],P*I)),p[I].crossVectors(u[I],d[I])}return{tangents:u,normals:d,binormals:p}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class jn extends An{constructor(t=0,i=0,a=1,u=1,d=0,p=2*Math.PI,v=!1,_=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=i,this.xRadius=a,this.yRadius=u,this.aStartAngle=d,this.aEndAngle=p,this.aClockwise=v,this.aRotation=_}getPoint(t,i){const a=i||new Ge,u=2*Math.PI;let d=this.aEndAngle-this.aStartAngle;const p=Math.abs(d)<Number.EPSILON;for(;d<0;)d+=u;for(;d>u;)d-=u;d<Number.EPSILON&&(d=p?0:u),this.aClockwise!==!0||p||(d===u?d=-u:d-=u);const v=this.aStartAngle+t*d;let _=this.aX+this.xRadius*Math.cos(v),y=this.aY+this.yRadius*Math.sin(v);if(this.aRotation!==0){const E=Math.cos(this.aRotation),A=Math.sin(this.aRotation),M=_-this.aX,P=y-this.aY;_=M*E-P*A+this.aX,y=M*A+P*E+this.aY}return a.set(_,y)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}jn.prototype.isEllipseCurve=!0;class Mn extends jn{constructor(t,i,a,u,d,p){super(t,i,a,a,u,d,p),this.type="ArcCurve"}}function Vn(){let f=0,t=0,i=0,a=0;function u(d,p,v,_){f=d,t=v,i=-3*d+3*p-2*v-_,a=2*d-2*p+v+_}return{initCatmullRom:function(d,p,v,_,y){u(p,v,y*(v-d),y*(_-p))},initNonuniformCatmullRom:function(d,p,v,_,y,E,A){let M=(p-d)/y-(v-d)/(y+E)+(v-p)/E,P=(v-p)/E-(_-p)/(E+A)+(_-v)/A;M*=E,P*=E,u(p,v,M,P)},calc:function(d){const p=d*d;return f+t*d+i*p+a*(p*d)}}}Mn.prototype.isArcCurve=!0;const Vr=new ot,_o=new Vn,es=new Vn,Bi=new Vn;class Js extends An{constructor(t=[],i=!1,a="centripetal",u=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=i,this.curveType=a,this.tension=u}getPoint(t,i=new ot){const a=i,u=this.points,d=u.length,p=(d-(this.closed?0:1))*t;let v,_,y=Math.floor(p),E=p-y;this.closed?y+=y>0?0:(Math.floor(Math.abs(y)/d)+1)*d:E===0&&y===d-1&&(y=d-2,E=1),this.closed||y>0?v=u[(y-1)%d]:(Vr.subVectors(u[0],u[1]).add(u[0]),v=Vr);const A=u[y%d],M=u[(y+1)%d];if(this.closed||y+2<d?_=u[(y+2)%d]:(Vr.subVectors(u[d-1],u[d-2]).add(u[d-1]),_=Vr),this.curveType==="centripetal"||this.curveType==="chordal"){const P=this.curveType==="chordal"?.5:.25;let I=Math.pow(v.distanceToSquared(A),P),N=Math.pow(A.distanceToSquared(M),P),O=Math.pow(M.distanceToSquared(_),P);N<1e-4&&(N=1),I<1e-4&&(I=N),O<1e-4&&(O=N),_o.initNonuniformCatmullRom(v.x,A.x,M.x,_.x,I,N,O),es.initNonuniformCatmullRom(v.y,A.y,M.y,_.y,I,N,O),Bi.initNonuniformCatmullRom(v.z,A.z,M.z,_.z,I,N,O)}else this.curveType==="catmullrom"&&(_o.initCatmullRom(v.x,A.x,M.x,_.x,this.tension),es.initCatmullRom(v.y,A.y,M.y,_.y,this.tension),Bi.initCatmullRom(v.z,A.z,M.z,_.z,this.tension));return a.set(_o.calc(E),es.calc(E),Bi.calc(E)),a}copy(t){super.copy(t),this.points=[];for(let i=0,a=t.points.length;i<a;i++){const u=t.points[i];this.points.push(u.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let i=0,a=this.points.length;i<a;i++){const u=this.points[i];t.points.push(u.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let i=0,a=t.points.length;i<a;i++){const u=t.points[i];this.points.push(new ot().fromArray(u))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function xs(f,t,i,a,u){const d=.5*(a-t),p=.5*(u-i),v=f*f;return(2*i-2*a+d+p)*(f*v)+(-3*i+3*a-2*d-p)*v+d*f+i}function Wa(f,t,i,a){return function(u,d){const p=1-u;return p*p*d}(f,t)+function(u,d){return 2*(1-u)*u*d}(f,i)+function(u,d){return u*u*d}(f,a)}function Lu(f,t,i,a,u){return function(d,p){const v=1-d;return v*v*v*p}(f,t)+function(d,p){const v=1-d;return 3*v*v*d*p}(f,i)+function(d,p){return 3*(1-d)*d*d*p}(f,a)+function(d,p){return d*d*d*p}(f,u)}Js.prototype.isCatmullRomCurve3=!0;class Xa extends An{constructor(t=new Ge,i=new Ge,a=new Ge,u=new Ge){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=i,this.v2=a,this.v3=u}getPoint(t,i=new Ge){const a=i,u=this.v0,d=this.v1,p=this.v2,v=this.v3;return a.set(Lu(t,u.x,d.x,p.x,v.x),Lu(t,u.y,d.y,p.y,v.y)),a}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Xa.prototype.isCubicBezierCurve=!0;class ga extends An{constructor(t=new ot,i=new ot,a=new ot,u=new ot){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=i,this.v2=a,this.v3=u}getPoint(t,i=new ot){const a=i,u=this.v0,d=this.v1,p=this.v2,v=this.v3;return a.set(Lu(t,u.x,d.x,p.x,v.x),Lu(t,u.y,d.y,p.y,v.y),Lu(t,u.z,d.z,p.z,v.z)),a}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}ga.prototype.isCubicBezierCurve3=!0;class dl extends An{constructor(t=new Ge,i=new Ge){super(),this.type="LineCurve",this.v1=t,this.v2=i}getPoint(t,i=new Ge){const a=i;return t===1?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(t).add(this.v1)),a}getPointAt(t,i){return this.getPoint(t,i)}getTangent(t,i){const a=i||new Ge;return a.copy(this.v2).sub(this.v1).normalize(),a}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}dl.prototype.isLineCurve=!0;class ep extends An{constructor(t=new ot,i=new ot){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=i}getPoint(t,i=new ot){const a=i;return t===1?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(t).add(this.v1)),a}getPointAt(t,i){return this.getPoint(t,i)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class pl extends An{constructor(t=new Ge,i=new Ge,a=new Ge){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=i,this.v2=a}getPoint(t,i=new Ge){const a=i,u=this.v0,d=this.v1,p=this.v2;return a.set(Wa(t,u.x,d.x,p.x),Wa(t,u.y,d.y,p.y)),a}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}pl.prototype.isQuadraticBezierCurve=!0;class rc extends An{constructor(t=new ot,i=new ot,a=new ot){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=i,this.v2=a}getPoint(t,i=new ot){const a=i,u=this.v0,d=this.v1,p=this.v2;return a.set(Wa(t,u.x,d.x,p.x),Wa(t,u.y,d.y,p.y),Wa(t,u.z,d.z,p.z)),a}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}rc.prototype.isQuadraticBezierCurve3=!0;class fl extends An{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,i=new Ge){const a=i,u=this.points,d=(u.length-1)*t,p=Math.floor(d),v=d-p,_=u[p===0?p:p-1],y=u[p],E=u[p>u.length-2?u.length-1:p+1],A=u[p>u.length-3?u.length-1:p+2];return a.set(xs(v,_.x,y.x,E.x,A.x),xs(v,_.y,y.y,E.y,A.y)),a}copy(t){super.copy(t),this.points=[];for(let i=0,a=t.points.length;i<a;i++){const u=t.points[i];this.points.push(u.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let i=0,a=this.points.length;i<a;i++){const u=this.points[i];t.points.push(u.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let i=0,a=t.points.length;i<a;i++){const u=t.points[i];this.points.push(new Ge().fromArray(u))}return this}}fl.prototype.isSplineCurve=!0;var oh=Object.freeze({__proto__:null,ArcCurve:Mn,CatmullRomCurve3:Js,CubicBezierCurve:Xa,CubicBezierCurve3:ga,EllipseCurve:jn,LineCurve:dl,LineCurve3:ep,QuadraticBezierCurve:pl,QuadraticBezierCurve3:rc,SplineCurve:fl});const zp=function(f,t,i=2){const a=t&&t.length,u=a?t[0]*i:f.length;let d=Ou(f,0,u,i,!0);const p=[];if(!d||d.next===d.prev)return p;let v,_,y,E,A,M,P;if(a&&(d=function(I,N,O,V){const Y=[];let at,st,yt,bt,_t;for(at=0,st=N.length;at<st;at++)yt=N[at]*V,bt=at<st-1?N[at+1]*V:I.length,_t=Ou(I,yt,bt,V,!1),_t===_t.next&&(_t.steiner=!0),Y.push(Am(_t));for(Y.sort(Kc),at=0;at<Y.length;at++)$f(Y[at],O),O=$s(O,O.next);return O}(f,t,d,i)),f.length>80*i){v=y=f[0],_=E=f[1];for(let I=i;I<u;I+=i)A=f[I],M=f[I+1],A<v&&(v=A),M<_&&(_=M),A>y&&(y=A),M>E&&(E=M);P=Math.max(y-v,E-_),P=P!==0?1/P:0}return np(d,p,i,v,_,P),p};function Ou(f,t,i,a,u){let d,p;if(u===function(v,_,y,E){let A=0;for(let M=_,P=y-E;M<y;M+=E)A+=(v[P]-v[M])*(v[M+1]+v[P+1]),P=M;return A}(f,t,i,a)>0)for(d=t;d<i;d+=a)p=op(d,f[d],f[d+1],p);else for(d=i-a;d>=t;d-=a)p=op(d,f[d],f[d+1],p);return p&&sh(p,p.next)&&(td(p),p=p.next),p}function $s(f,t){if(!f)return f;t||(t=f);let i,a=f;do if(i=!1,a.steiner||!sh(a,a.next)&&Ui(a.prev,a,a.next)!==0)a=a.next;else{if(td(a),a=t=a.prev,a===a.next)break;i=!0}while(i||a!==t);return t}function np(f,t,i,a,u,d,p){if(!f)return;!p&&d&&function(E,A,M,P){let I=E;do I.z===null&&(I.z=jp(I.x,I.y,A,M,P)),I.prevZ=I.prev,I.nextZ=I.next,I=I.next;while(I!==E);I.prevZ.nextZ=null,I.prevZ=null,function(N){let O,V,Y,at,st,yt,bt,_t,Et=1;do{for(V=N,N=null,st=null,yt=0;V;){for(yt++,Y=V,bt=0,O=0;O<Et&&(bt++,Y=Y.nextZ,Y);O++);for(_t=Et;bt>0||_t>0&&Y;)bt!==0&&(_t===0||!Y||V.z<=Y.z)?(at=V,V=V.nextZ,bt--):(at=Y,Y=Y.nextZ,_t--),st?st.nextZ=at:N=at,at.prevZ=st,st=at;V=Y}st.nextZ=null,Et*=2}while(yt>1)}(I)}(f,a,u,d);let v,_,y=f;for(;f.prev!==f.next;)if(v=f.prev,_=f.next,d?Jf(f,a,u,d):Zf(f))t.push(v.i/i),t.push(f.i/i),t.push(_.i/i),td(f),f=_.next,y=_.next;else if((f=_)===y){p?p===1?np(f=yf($s(f),t,i),t,i,a,u,d,2):p===2&&Em(f,t,i,a,u,d):np($s(f),t,i,a,u,d,1);break}}function Zf(f){const t=f.prev,i=f,a=f.next;if(Ui(t,i,a)>=0)return!1;let u=f.next.next;for(;u!==f.prev;){if(Ji(t.x,t.y,i.x,i.y,a.x,a.y,u.x,u.y)&&Ui(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function Jf(f,t,i,a){const u=f.prev,d=f,p=f.next;if(Ui(u,d,p)>=0)return!1;const v=u.x<d.x?u.x<p.x?u.x:p.x:d.x<p.x?d.x:p.x,_=u.y<d.y?u.y<p.y?u.y:p.y:d.y<p.y?d.y:p.y,y=u.x>d.x?u.x>p.x?u.x:p.x:d.x>p.x?d.x:p.x,E=u.y>d.y?u.y>p.y?u.y:p.y:d.y>p.y?d.y:p.y,A=jp(v,_,t,i,a),M=jp(y,E,t,i,a);let P=f.prevZ,I=f.nextZ;for(;P&&P.z>=A&&I&&I.z<=M;){if(P!==f.prev&&P!==f.next&&Ji(u.x,u.y,d.x,d.y,p.x,p.y,P.x,P.y)&&Ui(P.prev,P,P.next)>=0||(P=P.prevZ,I!==f.prev&&I!==f.next&&Ji(u.x,u.y,d.x,d.y,p.x,p.y,I.x,I.y)&&Ui(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;P&&P.z>=A;){if(P!==f.prev&&P!==f.next&&Ji(u.x,u.y,d.x,d.y,p.x,p.y,P.x,P.y)&&Ui(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;I&&I.z<=M;){if(I!==f.prev&&I!==f.next&&Ji(u.x,u.y,d.x,d.y,p.x,p.y,I.x,I.y)&&Ui(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function yf(f,t,i){let a=f;do{const u=a.prev,d=a.next.next;!sh(u,d)&&ic(u,a,a.next,d)&&Qc(u,d)&&Qc(d,u)&&(t.push(u.i/i),t.push(a.i/i),t.push(d.i/i),td(a),td(a.next),a=f=d),a=a.next}while(a!==f);return $s(a)}function Em(f,t,i,a,u,d){let p=f;do{let v=p.next.next;for(;v!==p.prev;){if(p.i!==v.i&&xf(p,v)){let _=ns(p,v);return p=$s(p,p.next),_=$s(_,_.next),np(p,t,i,a,u,d),void np(_,t,i,a,u,d)}v=v.next}p=p.next}while(p!==f)}function Kc(f,t){return f.x-t.x}function $f(f,t){if(t=function(i,a){let u=a;const d=i.x,p=i.y;let v,_=-1/0;do{if(p<=u.y&&p>=u.next.y&&u.next.y!==u.y){const I=u.x+(p-u.y)*(u.next.x-u.x)/(u.next.y-u.y);if(I<=d&&I>_){if(_=I,I===d){if(p===u.y)return u;if(p===u.next.y)return u.next}v=u.x<u.next.x?u:u.next}}u=u.next}while(u!==a);if(!v)return null;if(d===_)return v;const y=v,E=v.x,A=v.y;let M,P=1/0;u=v;do d>=u.x&&u.x>=E&&d!==u.x&&Ji(p<A?d:_,p,E,A,p<A?_:d,p,u.x,u.y)&&(M=Math.abs(p-u.y)/(d-u.x),Qc(u,i)&&(M<P||M===P&&(u.x>v.x||u.x===v.x&&Mm(v,u)))&&(v=u,P=M)),u=u.next;while(u!==y);return v}(f,t)){const i=ns(t,f);$s(t,t.next),$s(i,i.next)}}function Mm(f,t){return Ui(f.prev,f,t.prev)<0&&Ui(t.next,f,f.next)<0}function jp(f,t,i,a,u){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=32767*(f-i)*u)|f<<8))|f<<4))|f<<2))|f<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-a)*u)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Am(f){let t=f,i=f;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==f);return i}function Ji(f,t,i,a,u,d,p,v){return(u-p)*(t-v)-(f-p)*(d-v)>=0&&(f-p)*(a-v)-(i-p)*(t-v)>=0&&(i-p)*(d-v)-(u-p)*(a-v)>=0}function xf(f,t){return f.next.i!==t.i&&f.prev.i!==t.i&&!function(i,a){let u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==a.i&&u.next.i!==a.i&&ic(u,u.next,i,a))return!0;u=u.next}while(u!==i);return!1}(f,t)&&(Qc(f,t)&&Qc(t,f)&&function(i,a){let u=i,d=!1;const p=(i.x+a.x)/2,v=(i.y+a.y)/2;do u.y>v!=u.next.y>v&&u.next.y!==u.y&&p<(u.next.x-u.x)*(v-u.y)/(u.next.y-u.y)+u.x&&(d=!d),u=u.next;while(u!==i);return d}(f,t)&&(Ui(f.prev,f,t.prev)||Ui(f,t.prev,t))||sh(f,t)&&Ui(f.prev,f,f.next)>0&&Ui(t.prev,t,t.next)>0)}function Ui(f,t,i){return(t.y-f.y)*(i.x-t.x)-(t.x-f.x)*(i.y-t.y)}function sh(f,t){return f.x===t.x&&f.y===t.y}function ic(f,t,i,a){const u=ip(Ui(f,t,i)),d=ip(Ui(f,t,a)),p=ip(Ui(i,a,f)),v=ip(Ui(i,a,t));return u!==d&&p!==v||!(u!==0||!rp(f,i,t))||!(d!==0||!rp(f,a,t))||!(p!==0||!rp(i,f,a))||!(v!==0||!rp(i,t,a))}function rp(f,t,i){return t.x<=Math.max(f.x,i.x)&&t.x>=Math.min(f.x,i.x)&&t.y<=Math.max(f.y,i.y)&&t.y>=Math.min(f.y,i.y)}function ip(f){return f>0?1:f<0?-1:0}function Qc(f,t){return Ui(f.prev,f,f.next)<0?Ui(f,t,f.next)>=0&&Ui(f,f.prev,t)>=0:Ui(f,t,f.prev)<0||Ui(f,f.next,t)<0}function ns(f,t){const i=new ed(f.i,f.x,f.y),a=new ed(t.i,t.x,t.y),u=f.next,d=t.prev;return f.next=t,t.prev=f,i.next=u,u.prev=i,a.next=i,i.prev=a,d.next=a,a.prev=d,a}function op(f,t,i,a){const u=new ed(f,t,i);return a?(u.next=a.next,u.prev=a,a.next.prev=u,a.next=u):(u.prev=u,u.next=u),u}function td(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function ed(f,t,i){this.i=f,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class va{static area(t){const i=t.length;let a=0;for(let u=i-1,d=0;d<i;u=d++)a+=t[u].x*t[d].y-t[d].x*t[u].y;return .5*a}static isClockWise(t){return va.area(t)<0}static triangulateShape(t,i){const a=[],u=[],d=[];Vp(t),Kf(a,t);let p=t.length;i.forEach(Vp);for(let _=0;_<i.length;_++)u.push(p),p+=i[_].length,Kf(a,i[_]);const v=zp(a,u);for(let _=0;_<v.length;_+=3)d.push(v.slice(_,_+3));return d}}function Vp(f){const t=f.length;t>2&&f[t-1].equals(f[0])&&f.pop()}function Kf(f,t){for(let i=0;i<t.length;i++)f.push(t[i].x),f.push(t[i].y)}class Ya extends Hn{constructor(t,i){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:i},t=Array.isArray(t)?t:[t];const a=this,u=[],d=[];for(let v=0,_=t.length;v<_;v++)p(t[v]);function p(v){const _=[],y=i.curveSegments!==void 0?i.curveSegments:12,E=i.steps!==void 0?i.steps:1;let A=i.depth!==void 0?i.depth:100,M=i.bevelEnabled===void 0||i.bevelEnabled,P=i.bevelThickness!==void 0?i.bevelThickness:6,I=i.bevelSize!==void 0?i.bevelSize:P-2,N=i.bevelOffset!==void 0?i.bevelOffset:0,O=i.bevelSegments!==void 0?i.bevelSegments:3;const V=i.extrudePath,Y=i.UVGenerator!==void 0?i.UVGenerator:nd;i.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),A=i.amount);let at,st,yt,bt,_t,Et=!1;V&&(at=V.getSpacedPoints(E),Et=!0,M=!1,st=V.computeFrenetFrames(E,!1),yt=new ot,bt=new ot,_t=new ot),M||(O=0,P=0,I=0,N=0);const Ce=v.extractPoints(y);let ge=Ce.shape;const ve=Ce.holes;if(!va.isClockWise(ge)){ge=ge.reverse();for(let _e=0,pt=ve.length;_e<pt;_e++){const Ut=ve[_e];va.isClockWise(Ut)&&(ve[_e]=Ut.reverse())}}const ce=va.triangulateShape(ge,ve),Ot=ge;for(let _e=0,pt=ve.length;_e<pt;_e++){const Ut=ve[_e];ge=ge.concat(Ut)}function ee(_e,pt,Ut){return pt||console.error("THREE.ExtrudeGeometry: vec does not exist"),pt.clone().multiplyScalar(Ut).add(_e)}const We=ge.length,ze=ce.length;function Ue(_e,pt,Ut){let be,Ae,ye;const xn=_e.x-pt.x,zn=_e.y-pt.y,In=Ut.x-_e.x,wr=Ut.y-_e.y,Tr=xn*xn+zn*zn,Vo=xn*wr-zn*In;if(Math.abs(Vo)>Number.EPSILON){const Ti=Math.sqrt(Tr),xl=Math.sqrt(In*In+wr*wr),Wf=pt.x-zn/Ti,Xf=pt.y+xn/Ti,Yf=((Ut.x-wr/xl-Wf)*wr-(Ut.y+In/xl-Xf)*In)/(xn*wr-zn*In);be=Wf+xn*Yf-_e.x,Ae=Xf+zn*Yf-_e.y;const ta=be*be+Ae*Ae;if(ta<=2)return new Ge(be,Ae);ye=Math.sqrt(ta/2)}else{let Ti=!1;xn>Number.EPSILON?In>Number.EPSILON&&(Ti=!0):xn<-Number.EPSILON?In<-Number.EPSILON&&(Ti=!0):Math.sign(zn)===Math.sign(wr)&&(Ti=!0),Ti?(be=-zn,Ae=xn,ye=Math.sqrt(Tr)):(be=xn,Ae=zn,ye=Math.sqrt(Tr/2))}return new Ge(be/ye,Ae/ye)}const fn=[];for(let _e=0,pt=Ot.length,Ut=pt-1,be=_e+1;_e<pt;_e++,Ut++,be++)Ut===pt&&(Ut=0),be===pt&&(be=0),fn[_e]=Ue(Ot[_e],Ot[Ut],Ot[be]);const vn=[];let En,Tn=fn.concat();for(let _e=0,pt=ve.length;_e<pt;_e++){const Ut=ve[_e];En=[];for(let be=0,Ae=Ut.length,ye=Ae-1,xn=be+1;be<Ae;be++,ye++,xn++)ye===Ae&&(ye=0),xn===Ae&&(xn=0),En[be]=Ue(Ut[be],Ut[ye],Ut[xn]);vn.push(En),Tn=Tn.concat(En)}for(let _e=0;_e<O;_e++){const pt=_e/O,Ut=P*Math.cos(pt*Math.PI/2),be=I*Math.sin(pt*Math.PI/2)+N;for(let Ae=0,ye=Ot.length;Ae<ye;Ae++){const xn=ee(Ot[Ae],fn[Ae],be);De(xn.x,xn.y,-Ut)}for(let Ae=0,ye=ve.length;Ae<ye;Ae++){const xn=ve[Ae];En=vn[Ae];for(let zn=0,In=xn.length;zn<In;zn++){const wr=ee(xn[zn],En[zn],be);De(wr.x,wr.y,-Ut)}}}const wt=I+N;for(let _e=0;_e<We;_e++){const pt=M?ee(ge[_e],Tn[_e],wt):ge[_e];Et?(bt.copy(st.normals[0]).multiplyScalar(pt.x),yt.copy(st.binormals[0]).multiplyScalar(pt.y),_t.copy(at[0]).add(bt).add(yt),De(_t.x,_t.y,_t.z)):De(pt.x,pt.y,0)}for(let _e=1;_e<=E;_e++)for(let pt=0;pt<We;pt++){const Ut=M?ee(ge[pt],Tn[pt],wt):ge[pt];Et?(bt.copy(st.normals[_e]).multiplyScalar(Ut.x),yt.copy(st.binormals[_e]).multiplyScalar(Ut.y),_t.copy(at[_e]).add(bt).add(yt),De(_t.x,_t.y,_t.z)):De(Ut.x,Ut.y,A/E*_e)}for(let _e=O-1;_e>=0;_e--){const pt=_e/O,Ut=P*Math.cos(pt*Math.PI/2),be=I*Math.sin(pt*Math.PI/2)+N;for(let Ae=0,ye=Ot.length;Ae<ye;Ae++){const xn=ee(Ot[Ae],fn[Ae],be);De(xn.x,xn.y,A+Ut)}for(let Ae=0,ye=ve.length;Ae<ye;Ae++){const xn=ve[Ae];En=vn[Ae];for(let zn=0,In=xn.length;zn<In;zn++){const wr=ee(xn[zn],En[zn],be);Et?De(wr.x,wr.y+at[E-1].y,at[E-1].x+Ut):De(wr.x,wr.y,A+Ut)}}}function Mt(_e,pt){let Ut=_e.length;for(;--Ut>=0;){const be=Ut;let Ae=Ut-1;Ae<0&&(Ae=_e.length-1);for(let ye=0,xn=E+2*O;ye<xn;ye++){const zn=We*ye,In=We*(ye+1);se(pt+be+zn,pt+Ae+zn,pt+Ae+In,pt+be+In)}}}function De(_e,pt,Ut){_.push(_e),_.push(pt),_.push(Ut)}function Ne(_e,pt,Ut){nn(_e),nn(pt),nn(Ut);const be=u.length/3,Ae=Y.generateTopUV(a,u,be-3,be-2,be-1);rn(Ae[0]),rn(Ae[1]),rn(Ae[2])}function se(_e,pt,Ut,be){nn(_e),nn(pt),nn(be),nn(pt),nn(Ut),nn(be);const Ae=u.length/3,ye=Y.generateSideWallUV(a,u,Ae-6,Ae-3,Ae-2,Ae-1);rn(ye[0]),rn(ye[1]),rn(ye[3]),rn(ye[1]),rn(ye[2]),rn(ye[3])}function nn(_e){u.push(_[3*_e+0]),u.push(_[3*_e+1]),u.push(_[3*_e+2])}function rn(_e){d.push(_e.x),d.push(_e.y)}(function(){const _e=u.length/3;if(M){let pt=0,Ut=We*pt;for(let be=0;be<ze;be++){const Ae=ce[be];Ne(Ae[2]+Ut,Ae[1]+Ut,Ae[0]+Ut)}pt=E+2*O,Ut=We*pt;for(let be=0;be<ze;be++){const Ae=ce[be];Ne(Ae[0]+Ut,Ae[1]+Ut,Ae[2]+Ut)}}else{for(let pt=0;pt<ze;pt++){const Ut=ce[pt];Ne(Ut[2],Ut[1],Ut[0])}for(let pt=0;pt<ze;pt++){const Ut=ce[pt];Ne(Ut[0]+We*E,Ut[1]+We*E,Ut[2]+We*E)}}a.addGroup(_e,u.length/3-_e,0)})(),function(){const _e=u.length/3;let pt=0;Mt(Ot,pt),pt+=Ot.length;for(let Ut=0,be=ve.length;Ut<be;Ut++){const Ae=ve[Ut];Mt(Ae,pt),pt+=Ae.length}a.addGroup(_e,u.length/3-_e,1)}()}this.setAttribute("position",new yn(u,3)),this.setAttribute("uv",new yn(d,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(i,a,u){if(u.shapes=[],Array.isArray(i))for(let d=0,p=i.length;d<p;d++){const v=i[d];u.shapes.push(v.uuid)}else u.shapes.push(i.uuid);return a.extrudePath!==void 0&&(u.options.extrudePath=a.extrudePath.toJSON()),u}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,i){const a=[];for(let d=0,p=t.shapes.length;d<p;d++){const v=i[t.shapes[d]];a.push(v)}const u=t.options.extrudePath;return u!==void 0&&(t.options.extrudePath=new oh[u.type]().fromJSON(u)),new Ya(a,t.options)}}const nd={generateTopUV:function(f,t,i,a,u){const d=t[3*i],p=t[3*i+1],v=t[3*a],_=t[3*a+1],y=t[3*u],E=t[3*u+1];return[new Ge(d,p),new Ge(v,_),new Ge(y,E)]},generateSideWallUV:function(f,t,i,a,u,d){const p=t[3*i],v=t[3*i+1],_=t[3*i+2],y=t[3*a],E=t[3*a+1],A=t[3*a+2],M=t[3*u],P=t[3*u+1],I=t[3*u+2],N=t[3*d],O=t[3*d+1],V=t[3*d+2];return Math.abs(v-E)<Math.abs(p-y)?[new Ge(p,1-_),new Ge(y,1-A),new Ge(M,1-I),new Ge(N,1-V)]:[new Ge(v,1-_),new Ge(E,1-A),new Ge(P,1-I),new Ge(O,1-V)]}};class Du extends gn{constructor(t=1,i=0){const a=(1+Math.sqrt(5))/2;super([-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,i),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new Du(t.radius,t.detail)}}class rd extends Hn{constructor(t,i=12,a=0,u=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:t,segments:i,phiStart:a,phiLength:u},i=Math.floor(i),u=Hi(u,0,2*Math.PI);const d=[],p=[],v=[],_=1/i,y=new ot,E=new Ge;for(let A=0;A<=i;A++){const M=a+A*_*u,P=Math.sin(M),I=Math.cos(M);for(let N=0;N<=t.length-1;N++)y.x=t[N].x*P,y.y=t[N].y,y.z=t[N].x*I,p.push(y.x,y.y,y.z),E.x=A/i,E.y=N/(t.length-1),v.push(E.x,E.y)}for(let A=0;A<i;A++)for(let M=0;M<t.length-1;M++){const P=M+A*t.length,I=P,N=P+t.length,O=P+t.length+1,V=P+1;d.push(I,N,V),d.push(N,O,V)}if(this.setIndex(d),this.setAttribute("position",new yn(p,3)),this.setAttribute("uv",new yn(v,2)),this.computeVertexNormals(),u===2*Math.PI){const A=this.attributes.normal.array,M=new ot,P=new ot,I=new ot,N=i*t.length*3;for(let O=0,V=0;O<t.length;O++,V+=3)M.x=A[V+0],M.y=A[V+1],M.z=A[V+2],P.x=A[N+V+0],P.y=A[N+V+1],P.z=A[N+V+2],I.addVectors(M,P).normalize(),A[V+0]=A[N+V+0]=I.x,A[V+1]=A[N+V+1]=I.y,A[V+2]=A[N+V+2]=I.z}}static fromJSON(t){return new rd(t.points,t.segments,t.phiStart,t.phiLength)}}class oc extends gn{constructor(t=1,i=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,i),this.type="OctahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new oc(t.radius,t.detail)}}class Ks extends Hn{constructor(t,i,a){super(),this.type="ParametricGeometry",this.parameters={func:t,slices:i,stacks:a};const u=[],d=[],p=[],v=[],_=1e-5,y=new ot,E=new ot,A=new ot,M=new ot,P=new ot;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const I=i+1;for(let N=0;N<=a;N++){const O=N/a;for(let V=0;V<=i;V++){const Y=V/i;t(Y,O,E),d.push(E.x,E.y,E.z),Y-_>=0?(t(Y-_,O,A),M.subVectors(E,A)):(t(Y+_,O,A),M.subVectors(A,E)),O-_>=0?(t(Y,O-_,A),P.subVectors(E,A)):(t(Y,O+_,A),P.subVectors(A,E)),y.crossVectors(M,P).normalize(),p.push(y.x,y.y,y.z),v.push(Y,O)}}for(let N=0;N<a;N++)for(let O=0;O<i;O++){const V=N*I+O,Y=N*I+O+1,at=(N+1)*I+O+1,st=(N+1)*I+O;u.push(V,Y,st),u.push(Y,at,st)}this.setIndex(u),this.setAttribute("position",new yn(d,3)),this.setAttribute("normal",new yn(p,3)),this.setAttribute("uv",new yn(v,2))}}class Qs extends Hn{constructor(t=.5,i=1,a=8,u=1,d=0,p=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:i,thetaSegments:a,phiSegments:u,thetaStart:d,thetaLength:p},a=Math.max(3,a);const v=[],_=[],y=[],E=[];let A=t;const M=(i-t)/(u=Math.max(1,u)),P=new ot,I=new Ge;for(let N=0;N<=u;N++){for(let O=0;O<=a;O++){const V=d+O/a*p;P.x=A*Math.cos(V),P.y=A*Math.sin(V),_.push(P.x,P.y,P.z),y.push(0,0,1),I.x=(P.x/i+1)/2,I.y=(P.y/i+1)/2,E.push(I.x,I.y)}A+=M}for(let N=0;N<u;N++){const O=N*(a+1);for(let V=0;V<a;V++){const Y=V+O,at=Y,st=Y+a+1,yt=Y+a+2,bt=Y+1;v.push(at,st,bt),v.push(st,yt,bt)}}this.setIndex(v),this.setAttribute("position",new yn(_,3)),this.setAttribute("normal",new yn(y,3)),this.setAttribute("uv",new yn(E,2))}static fromJSON(t){return new Qs(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class sc extends Hn{constructor(t,i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:i};const a=[],u=[],d=[],p=[];let v=0,_=0;if(Array.isArray(t)===!1)y(t);else for(let E=0;E<t.length;E++)y(t[E]),this.addGroup(v,_,E),v+=_,_=0;function y(E){const A=u.length/3,M=E.extractPoints(i);let P=M.shape;const I=M.holes;va.isClockWise(P)===!1&&(P=P.reverse());for(let O=0,V=I.length;O<V;O++){const Y=I[O];va.isClockWise(Y)===!0&&(I[O]=Y.reverse())}const N=va.triangulateShape(P,I);for(let O=0,V=I.length;O<V;O++){const Y=I[O];P=P.concat(Y)}for(let O=0,V=P.length;O<V;O++){const Y=P[O];u.push(Y.x,Y.y,0),d.push(0,0,1),p.push(Y.x,Y.y)}for(let O=0,V=N.length;O<V;O++){const Y=N[O],at=Y[0]+A,st=Y[1]+A,yt=Y[2]+A;a.push(at,st,yt),_+=3}}this.setIndex(a),this.setAttribute("position",new yn(u,3)),this.setAttribute("normal",new yn(d,3)),this.setAttribute("uv",new yn(p,2))}toJSON(){const t=super.toJSON();return function(i,a){if(a.shapes=[],Array.isArray(i))for(let u=0,d=i.length;u<d;u++){const p=i[u];a.shapes.push(p.uuid)}else a.shapes.push(i.uuid);return a}(this.parameters.shapes,t)}static fromJSON(t,i){const a=[];for(let u=0,d=t.shapes.length;u<d;u++){const p=i[t.shapes[u]];a.push(p)}return new sc(a,t.curveSegments)}}class ac extends Hn{constructor(t=1,i=8,a=6,u=0,d=2*Math.PI,p=0,v=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:i,heightSegments:a,phiStart:u,phiLength:d,thetaStart:p,thetaLength:v},i=Math.max(3,Math.floor(i)),a=Math.max(2,Math.floor(a));const _=Math.min(p+v,Math.PI);let y=0;const E=[],A=new ot,M=new ot,P=[],I=[],N=[],O=[];for(let V=0;V<=a;V++){const Y=[],at=V/a;let st=0;V==0&&p==0?st=.5/i:V==a&&_==Math.PI&&(st=-.5/i);for(let yt=0;yt<=i;yt++){const bt=yt/i;A.x=-t*Math.cos(u+bt*d)*Math.sin(p+at*v),A.y=t*Math.cos(p+at*v),A.z=t*Math.sin(u+bt*d)*Math.sin(p+at*v),I.push(A.x,A.y,A.z),M.copy(A).normalize(),N.push(M.x,M.y,M.z),O.push(bt+st,1-at),Y.push(y++)}E.push(Y)}for(let V=0;V<a;V++)for(let Y=0;Y<i;Y++){const at=E[V][Y+1],st=E[V][Y],yt=E[V+1][Y],bt=E[V+1][Y+1];(V!==0||p>0)&&P.push(at,st,bt),(V!==a-1||_<Math.PI)&&P.push(st,yt,bt)}this.setIndex(P),this.setAttribute("position",new yn(I,3)),this.setAttribute("normal",new yn(N,3)),this.setAttribute("uv",new yn(O,2))}static fromJSON(t){return new ac(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class id extends gn{constructor(t=1,i=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,i),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:i}}static fromJSON(t){return new id(t.radius,t.detail)}}class Wp extends Ya{constructor(t,i={}){const a=i.font;if(!a||!a.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Hn;const u=a.generateShapes(t,i.size);i.depth=i.height!==void 0?i.height:50,i.bevelThickness===void 0&&(i.bevelThickness=10),i.bevelSize===void 0&&(i.bevelSize=8),i.bevelEnabled===void 0&&(i.bevelEnabled=!1),super(u,i),this.type="TextGeometry"}}class od extends Hn{constructor(t=1,i=.4,a=8,u=6,d=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:i,radialSegments:a,tubularSegments:u,arc:d},a=Math.floor(a),u=Math.floor(u);const p=[],v=[],_=[],y=[],E=new ot,A=new ot,M=new ot;for(let P=0;P<=a;P++)for(let I=0;I<=u;I++){const N=I/u*d,O=P/a*Math.PI*2;A.x=(t+i*Math.cos(O))*Math.cos(N),A.y=(t+i*Math.cos(O))*Math.sin(N),A.z=i*Math.sin(O),v.push(A.x,A.y,A.z),E.x=t*Math.cos(N),E.y=t*Math.sin(N),M.subVectors(A,E).normalize(),_.push(M.x,M.y,M.z),y.push(I/u),y.push(P/a)}for(let P=1;P<=a;P++)for(let I=1;I<=u;I++){const N=(u+1)*P+I-1,O=(u+1)*(P-1)+I-1,V=(u+1)*(P-1)+I,Y=(u+1)*P+I;p.push(N,O,Y),p.push(O,V,Y)}this.setIndex(p),this.setAttribute("position",new yn(v,3)),this.setAttribute("normal",new yn(_,3)),this.setAttribute("uv",new yn(y,2))}static fromJSON(t){return new od(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class uc extends Hn{constructor(t=1,i=.4,a=64,u=8,d=2,p=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:i,tubularSegments:a,radialSegments:u,p:d,q:p},a=Math.floor(a),u=Math.floor(u);const v=[],_=[],y=[],E=[],A=new ot,M=new ot,P=new ot,I=new ot,N=new ot,O=new ot,V=new ot;for(let at=0;at<=a;++at){const st=at/a*d*Math.PI*2;Y(st,d,p,t,P),Y(st+.01,d,p,t,I),O.subVectors(I,P),V.addVectors(I,P),N.crossVectors(O,V),V.crossVectors(N,O),N.normalize(),V.normalize();for(let yt=0;yt<=u;++yt){const bt=yt/u*Math.PI*2,_t=-i*Math.cos(bt),Et=i*Math.sin(bt);A.x=P.x+(_t*V.x+Et*N.x),A.y=P.y+(_t*V.y+Et*N.y),A.z=P.z+(_t*V.z+Et*N.z),_.push(A.x,A.y,A.z),M.subVectors(A,P).normalize(),y.push(M.x,M.y,M.z),E.push(at/a),E.push(yt/u)}}for(let at=1;at<=a;at++)for(let st=1;st<=u;st++){const yt=(u+1)*(at-1)+(st-1),bt=(u+1)*at+(st-1),_t=(u+1)*at+st,Et=(u+1)*(at-1)+st;v.push(yt,bt,Et),v.push(bt,_t,Et)}function Y(at,st,yt,bt,_t){const Et=Math.cos(at),Ce=Math.sin(at),ge=yt/st*at,ve=Math.cos(ge);_t.x=bt*(2+ve)*.5*Et,_t.y=bt*(2+ve)*Ce*.5,_t.z=bt*Math.sin(ge)*.5}this.setIndex(v),this.setAttribute("position",new yn(_,3)),this.setAttribute("normal",new yn(y,3)),this.setAttribute("uv",new yn(E,2))}static fromJSON(t){return new uc(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class sd extends Hn{constructor(t,i=64,a=1,u=8,d=!1){super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:i,radius:a,radialSegments:u,closed:d};const p=t.computeFrenetFrames(i,d);this.tangents=p.tangents,this.normals=p.normals,this.binormals=p.binormals;const v=new ot,_=new ot,y=new Ge;let E=new ot;const A=[],M=[],P=[],I=[];function N(O){E=t.getPointAt(O/i,E);const V=p.normals[O],Y=p.binormals[O];for(let at=0;at<=u;at++){const st=at/u*Math.PI*2,yt=Math.sin(st),bt=-Math.cos(st);_.x=bt*V.x+yt*Y.x,_.y=bt*V.y+yt*Y.y,_.z=bt*V.z+yt*Y.z,_.normalize(),M.push(_.x,_.y,_.z),v.x=E.x+a*_.x,v.y=E.y+a*_.y,v.z=E.z+a*_.z,A.push(v.x,v.y,v.z)}}(function(){for(let O=0;O<i;O++)N(O);N(d===!1?i:0),function(){for(let O=0;O<=i;O++)for(let V=0;V<=u;V++)y.x=O/i,y.y=V/u,P.push(y.x,y.y)}(),function(){for(let O=1;O<=i;O++)for(let V=1;V<=u;V++){const Y=(u+1)*(O-1)+(V-1),at=(u+1)*O+(V-1),st=(u+1)*O+V,yt=(u+1)*(O-1)+V;I.push(Y,at,yt),I.push(at,st,yt)}}()})(),this.setIndex(I),this.setAttribute("position",new yn(A,3)),this.setAttribute("normal",new yn(M,3)),this.setAttribute("uv",new yn(P,2))}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new sd(new oh[t.path.type]().fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class bf extends Hn{constructor(t){if(super(),this.type="WireframeGeometry",t.isGeometry===!0)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const i=[],a=[0,0],u={},d=new ot;if(t.index!==null){const p=t.attributes.position,v=t.index;let _=t.groups;_.length===0&&(_=[{start:0,count:v.count,materialIndex:0}]);for(let y=0,E=_.length;y<E;++y){const A=_[y],M=A.start;for(let P=M,I=M+A.count;P<I;P+=3)for(let N=0;N<3;N++){const O=v.getX(P+N),V=v.getX(P+(N+1)%3);a[0]=Math.min(O,V),a[1]=Math.max(O,V);const Y=a[0]+","+a[1];u[Y]===void 0&&(u[Y]={index1:a[0],index2:a[1]})}}for(const y in u){const E=u[y];d.fromBufferAttribute(p,E.index1),i.push(d.x,d.y,d.z),d.fromBufferAttribute(p,E.index2),i.push(d.x,d.y,d.z)}}else{const p=t.attributes.position;for(let v=0,_=p.count/3;v<_;v++)for(let y=0;y<3;y++){const E=3*v+y;d.fromBufferAttribute(p,E),i.push(d.x,d.y,d.z);const A=3*v+(y+1)%3;d.fromBufferAttribute(p,A),i.push(d.x,d.y,d.z)}}this.setAttribute("position",new yn(i,3))}}var Qf=Object.freeze({__proto__:null,BoxGeometry:Xs,BoxBufferGeometry:Xs,CircleGeometry:le,CircleBufferGeometry:le,ConeGeometry:mn,ConeBufferGeometry:mn,CylinderGeometry:Oe,CylinderBufferGeometry:Oe,DodecahedronGeometry:Cn,DodecahedronBufferGeometry:Cn,EdgesGeometry:Fn,ExtrudeGeometry:Ya,ExtrudeBufferGeometry:Ya,IcosahedronGeometry:Du,IcosahedronBufferGeometry:Du,LatheGeometry:rd,LatheBufferGeometry:rd,OctahedronGeometry:oc,OctahedronBufferGeometry:oc,ParametricGeometry:Ks,ParametricBufferGeometry:Ks,PlaneGeometry:mo,PlaneBufferGeometry:mo,PolyhedronGeometry:gn,PolyhedronBufferGeometry:gn,RingGeometry:Qs,RingBufferGeometry:Qs,ShapeGeometry:sc,ShapeBufferGeometry:sc,SphereGeometry:ac,SphereBufferGeometry:ac,TetrahedronGeometry:id,TetrahedronBufferGeometry:id,TextGeometry:Wp,TextBufferGeometry:Wp,TorusGeometry:od,TorusBufferGeometry:od,TorusKnotGeometry:uc,TorusKnotBufferGeometry:uc,TubeGeometry:sd,TubeBufferGeometry:sd,WireframeGeometry:bf});class wf extends zi{constructor(t){super(),this.type="ShadowMaterial",this.color=new pn(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}wf.prototype.isShadowMaterial=!0;class ad extends fo{constructor(t){super(t),this.type="RawShaderMaterial"}}ad.prototype.isRawShaderMaterial=!0;class sp extends zi{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new pn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cr,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this}}sp.prototype.isMeshStandardMaterial=!0;class Xp extends sp{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ge(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(i){this.reflectivity=Hi(2.5*(i-1)/(i+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new pn(1,1,1),this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new pn).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this}}Xp.prototype.isMeshPhysicalMaterial=!0;class Tf extends zi{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new pn(16777215),this.specular=new pn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cr,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ur,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}Tf.prototype.isMeshPhongMaterial=!0;class ml extends zi{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new pn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cr,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}ml.prototype.isMeshToonMaterial=!0;class Yp extends zi{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cr,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}Yp.prototype.isMeshNormalMaterial=!0;class Sf extends zi{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ur,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}Sf.prototype.isMeshLambertMaterial=!0;class _a extends zi{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new pn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cr,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}_a.prototype.isMeshMatcapMaterial=!0;class xr extends oo{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}xr.prototype.isLineDashedMaterial=!0;var Pm=Object.freeze({__proto__:null,ShadowMaterial:wf,SpriteMaterial:vo,RawShaderMaterial:ad,ShaderMaterial:fo,PointsMaterial:cl,MeshPhysicalMaterial:Xp,MeshStandardMaterial:sp,MeshPhongMaterial:Tf,MeshToonMaterial:ml,MeshNormalMaterial:Yp,MeshLambertMaterial:Sf,MeshDepthMaterial:$l,MeshDistanceMaterial:_s,MeshBasicMaterial:Oi,MeshMatcapMaterial:_a,LineDashedMaterial:xr,LineBasicMaterial:oo,Material:zi});const Kr={arraySlice:function(f,t,i){return Kr.isTypedArray(f)?new f.constructor(f.subarray(t,i!==void 0?i:f.length)):f.slice(t,i)},convertArray:function(f,t,i){return!f||!i&&f.constructor===t?f:typeof t.BYTES_PER_ELEMENT=="number"?new t(f):Array.prototype.slice.call(f)},isTypedArray:function(f){return ArrayBuffer.isView(f)&&!(f instanceof DataView)},getKeyframeOrder:function(f){const t=f.length,i=new Array(t);for(let a=0;a!==t;++a)i[a]=a;return i.sort(function(a,u){return f[a]-f[u]}),i},sortedArray:function(f,t,i){const a=f.length,u=new f.constructor(a);for(let d=0,p=0;p!==a;++d){const v=i[d]*t;for(let _=0;_!==t;++_)u[p++]=f[v+_]}return u},flattenJSON:function(f,t,i,a){let u=1,d=f[0];for(;d!==void 0&&d[a]===void 0;)d=f[u++];if(d===void 0)return;let p=d[a];if(p!==void 0)if(Array.isArray(p))do p=d[a],p!==void 0&&(t.push(d.time),i.push.apply(i,p)),d=f[u++];while(d!==void 0);else if(p.toArray!==void 0)do p=d[a],p!==void 0&&(t.push(d.time),p.toArray(i,i.length)),d=f[u++];while(d!==void 0);else do p=d[a],p!==void 0&&(t.push(d.time),i.push(p)),d=f[u++];while(d!==void 0)},subclip:function(f,t,i,a,u=30){const d=f.clone();d.name=t;const p=[];for(let _=0;_<d.tracks.length;++_){const y=d.tracks[_],E=y.getValueSize(),A=[],M=[];for(let P=0;P<y.times.length;++P){const I=y.times[P]*u;if(!(I<i||I>=a)){A.push(y.times[P]);for(let N=0;N<E;++N)M.push(y.values[P*E+N])}}A.length!==0&&(y.times=Kr.convertArray(A,y.times.constructor),y.values=Kr.convertArray(M,y.values.constructor),p.push(y))}d.tracks=p;let v=1/0;for(let _=0;_<d.tracks.length;++_)v>d.tracks[_].times[0]&&(v=d.tracks[_].times[0]);for(let _=0;_<d.tracks.length;++_)d.tracks[_].shift(-1*v);return d.resetDuration(),d},makeClipAdditive:function(f,t=0,i=f,a=30){a<=0&&(a=30);const u=i.tracks.length,d=t/a;for(let p=0;p<u;++p){const v=i.tracks[p],_=v.ValueTypeName;if(_==="bool"||_==="string")continue;const y=f.tracks.find(function(V){return V.name===v.name&&V.ValueTypeName===_});if(y===void 0)continue;let E=0;const A=v.getValueSize();v.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(E=A/3);let M=0;const P=y.getValueSize();y.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(M=P/3);const I=v.times.length-1;let N;if(d<=v.times[0]){const V=E,Y=A-E;N=Kr.arraySlice(v.values,V,Y)}else if(d>=v.times[I]){const V=I*A+E,Y=V+A-E;N=Kr.arraySlice(v.values,V,Y)}else{const V=v.createInterpolant(),Y=E,at=A-E;V.evaluate(d),N=Kr.arraySlice(V.resultBuffer,Y,at)}_==="quaternion"&&new eo().fromArray(N).normalize().conjugate().toArray(N);const O=y.times.length;for(let V=0;V<O;++V){const Y=V*P+M;if(_==="quaternion")eo.multiplyQuaternionsFlat(y.values,Y,N,0,y.values,Y);else{const at=P-2*M;for(let st=0;st<at;++st)y.values[Y+st]-=N[st]}}}return f.blendMode=Pl,f}};class bs{constructor(t,i,a,u){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=u!==void 0?u:new i.constructor(a),this.sampleValues=i,this.valueSize=a,this.settings=null,this.DefaultSettings_={}}evaluate(t){const i=this.parameterPositions;let a=this._cachedIndex,u=i[a],d=i[a-1];t:{e:{let p;n:{r:if(!(t<u)){for(let v=a+2;;){if(u===void 0){if(t<d)break r;return a=i.length,this._cachedIndex=a,this.afterEnd_(a-1,t,d)}if(a===v)break;if(d=u,u=i[++a],t<u)break e}p=i.length;break n}if(t>=d)break t;{const v=i[1];t<v&&(a=2,d=v);for(let _=a-2;;){if(d===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,u);if(a===_)break;if(u=d,d=i[--a-1],t>=d)break e}p=a,a=0}}for(;a<p;){const v=a+p>>>1;t<i[v]?p=v:a=v+1}if(u=i[a],d=i[a-1],d===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,u);if(u===void 0)return a=i.length,this._cachedIndex=a,this.afterEnd_(a-1,d,t)}this._cachedIndex=a,this.intervalChanged_(a,d,u)}return this.interpolate_(a,d,t,u)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const i=this.resultBuffer,a=this.sampleValues,u=this.valueSize,d=t*u;for(let p=0;p!==u;++p)i[p]=a[d+p];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}bs.prototype.beforeStart_=bs.prototype.copySampleValue_,bs.prototype.afterEnd_=bs.prototype.copySampleValue_;class Ef extends bs{constructor(t,i,a,u){super(t,i,a,u),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ia,endingEnd:ia}}intervalChanged_(t,i,a){const u=this.parameterPositions;let d=t-2,p=t+1,v=u[d],_=u[p];if(v===void 0)switch(this.getSettings_().endingStart){case oa:d=t,v=2*i-a;break;case ss:d=u.length-2,v=i+u[d]-u[d+1];break;default:d=t,v=a}if(_===void 0)switch(this.getSettings_().endingEnd){case oa:p=t,_=2*a-i;break;case ss:p=1,_=a+u[1]-u[0];break;default:p=t-1,_=i}const y=.5*(a-i),E=this.valueSize;this._weightPrev=y/(i-v),this._weightNext=y/(_-a),this._offsetPrev=d*E,this._offsetNext=p*E}interpolate_(t,i,a,u){const d=this.resultBuffer,p=this.sampleValues,v=this.valueSize,_=t*v,y=_-v,E=this._offsetPrev,A=this._offsetNext,M=this._weightPrev,P=this._weightNext,I=(a-i)/(u-i),N=I*I,O=N*I,V=-M*O+2*M*N-M*I,Y=(1+M)*O+(-1.5-2*M)*N+(-.5+M)*I+1,at=(-1-P)*O+(1.5+P)*N+.5*I,st=P*O-P*N;for(let yt=0;yt!==v;++yt)d[yt]=V*p[E+yt]+Y*p[y+yt]+at*p[_+yt]+st*p[A+yt];return d}}class ap extends bs{constructor(t,i,a,u){super(t,i,a,u)}interpolate_(t,i,a,u){const d=this.resultBuffer,p=this.sampleValues,v=this.valueSize,_=t*v,y=_-v,E=(a-i)/(u-i),A=1-E;for(let M=0;M!==v;++M)d[M]=p[y+M]*A+p[_+M]*E;return d}}class ah extends bs{constructor(t,i,a,u){super(t,i,a,u)}interpolate_(t){return this.copySampleValue_(t-1)}}class qa{constructor(t,i,a,u){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Kr.convertArray(i,this.TimeBufferType),this.values=Kr.convertArray(a,this.ValueBufferType),this.setInterpolation(u||this.DefaultInterpolation)}static toJSON(t){const i=t.constructor;let a;if(i.toJSON!==this.toJSON)a=i.toJSON(t);else{a={name:t.name,times:Kr.convertArray(t.times,Array),values:Kr.convertArray(t.values,Array)};const u=t.getInterpolation();u!==t.DefaultInterpolation&&(a.interpolation=u)}return a.type=t.ValueTypeName,a}InterpolantFactoryMethodDiscrete(t){return new ah(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new ap(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Ef(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let i;switch(t){case Al:i=this.InterpolantFactoryMethodDiscrete;break;case Gu:i=this.InterpolantFactoryMethodLinear;break;case ri:i=this.InterpolantFactoryMethodSmooth}if(i===void 0){const a="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(t===this.DefaultInterpolation)throw new Error(a);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",a),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Al;case this.InterpolantFactoryMethodLinear:return Gu;case this.InterpolantFactoryMethodSmooth:return ri}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const i=this.times;for(let a=0,u=i.length;a!==u;++a)i[a]+=t}return this}scale(t){if(t!==1){const i=this.times;for(let a=0,u=i.length;a!==u;++a)i[a]*=t}return this}trim(t,i){const a=this.times,u=a.length;let d=0,p=u-1;for(;d!==u&&a[d]<t;)++d;for(;p!==-1&&a[p]>i;)--p;if(++p,d!==0||p!==u){d>=p&&(p=Math.max(p,1),d=p-1);const v=this.getValueSize();this.times=Kr.arraySlice(a,d,p),this.values=Kr.arraySlice(this.values,d*v,p*v)}return this}validate(){let t=!0;const i=this.getValueSize();i-Math.floor(i)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const a=this.times,u=this.values,d=a.length;d===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let p=null;for(let v=0;v!==d;v++){const _=a[v];if(typeof _=="number"&&isNaN(_)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,v,_),t=!1;break}if(p!==null&&p>_){console.error("THREE.KeyframeTrack: Out of order keys.",this,v,_,p),t=!1;break}p=_}if(u!==void 0&&Kr.isTypedArray(u))for(let v=0,_=u.length;v!==_;++v){const y=u[v];if(isNaN(y)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,v,y),t=!1;break}}return t}optimize(){const t=Kr.arraySlice(this.times),i=Kr.arraySlice(this.values),a=this.getValueSize(),u=this.getInterpolation()===ri,d=t.length-1;let p=1;for(let v=1;v<d;++v){let _=!1;const y=t[v];if(y!==t[v+1]&&(v!==1||y!==t[0]))if(u)_=!0;else{const E=v*a,A=E-a,M=E+a;for(let P=0;P!==a;++P){const I=i[E+P];if(I!==i[A+P]||I!==i[M+P]){_=!0;break}}}if(_){if(v!==p){t[p]=t[v];const E=v*a,A=p*a;for(let M=0;M!==a;++M)i[A+M]=i[E+M]}++p}}if(d>0){t[p]=t[d];for(let v=d*a,_=p*a,y=0;y!==a;++y)i[_+y]=i[v+y];++p}return p!==t.length?(this.times=Kr.arraySlice(t,0,p),this.values=Kr.arraySlice(i,0,p*a)):(this.times=t,this.values=i),this}clone(){const t=Kr.arraySlice(this.times,0),i=Kr.arraySlice(this.values,0),a=new this.constructor(this.name,t,i);return a.createInterpolant=this.createInterpolant,a}}qa.prototype.TimeBufferType=Float32Array,qa.prototype.ValueBufferType=Float32Array,qa.prototype.DefaultInterpolation=Gu;class uh extends qa{}uh.prototype.ValueTypeName="bool",uh.prototype.ValueBufferType=Array,uh.prototype.DefaultInterpolation=Al,uh.prototype.InterpolantFactoryMethodLinear=void 0,uh.prototype.InterpolantFactoryMethodSmooth=void 0;class up extends qa{}up.prototype.ValueTypeName="color";class ud extends qa{}ud.prototype.ValueTypeName="number";class Mf extends bs{constructor(t,i,a,u){super(t,i,a,u)}interpolate_(t,i,a,u){const d=this.resultBuffer,p=this.sampleValues,v=this.valueSize,_=(a-i)/(u-i);let y=t*v;for(let E=y+v;y!==E;y+=4)eo.slerpFlat(d,0,p,y-v,p,y,_);return d}}class Nu extends qa{InterpolantFactoryMethodLinear(t){return new Mf(this.times,this.values,this.getValueSize(),t)}}Nu.prototype.ValueTypeName="quaternion",Nu.prototype.DefaultInterpolation=Gu,Nu.prototype.InterpolantFactoryMethodSmooth=void 0;class Fu extends qa{}Fu.prototype.ValueTypeName="string",Fu.prototype.ValueBufferType=Array,Fu.prototype.DefaultInterpolation=Al,Fu.prototype.InterpolantFactoryMethodLinear=void 0,Fu.prototype.InterpolantFactoryMethodSmooth=void 0;class ld extends qa{}ld.prototype.ValueTypeName="vector";class lp{constructor(t,i=-1,a,u=ou){this.name=t,this.tracks=a,this.duration=i,this.blendMode=u,this.uuid=wo(),this.duration<0&&this.resetDuration()}static parse(t){const i=[],a=t.tracks,u=1/(t.fps||1);for(let p=0,v=a.length;p!==v;++p)i.push(Cm(a[p]).scale(u));const d=new this(t.name,t.duration,i,t.blendMode);return d.uuid=t.uuid,d}static toJSON(t){const i=[],a=t.tracks,u={name:t.name,duration:t.duration,tracks:i,uuid:t.uuid,blendMode:t.blendMode};for(let d=0,p=a.length;d!==p;++d)i.push(qa.toJSON(a[d]));return u}static CreateFromMorphTargetSequence(t,i,a,u){const d=i.length,p=[];for(let v=0;v<d;v++){let _=[],y=[];_.push((v+d-1)%d,v,(v+1)%d),y.push(0,1,0);const E=Kr.getKeyframeOrder(_);_=Kr.sortedArray(_,1,E),y=Kr.sortedArray(y,1,E),u||_[0]!==0||(_.push(d),y.push(y[0])),p.push(new ud(".morphTargetInfluences["+i[v].name+"]",_,y).scale(1/a))}return new this(t,-1,p)}static findByName(t,i){let a=t;if(!Array.isArray(t)){const u=t;a=u.geometry&&u.geometry.animations||u.animations}for(let u=0;u<a.length;u++)if(a[u].name===i)return a[u];return null}static CreateClipsFromMorphTargetSequences(t,i,a){const u={},d=/^([\w-]*?)([\d]+)$/;for(let v=0,_=t.length;v<_;v++){const y=t[v],E=y.name.match(d);if(E&&E.length>1){const A=E[1];let M=u[A];M||(u[A]=M=[]),M.push(y)}}const p=[];for(const v in u)p.push(this.CreateFromMorphTargetSequence(v,u[v],i,a));return p}static parseAnimation(t,i){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const a=function(E,A,M,P,I){if(M.length!==0){const N=[],O=[];Kr.flattenJSON(M,N,O,P),N.length!==0&&I.push(new E(A,N,O))}},u=[],d=t.name||"default",p=t.fps||30,v=t.blendMode;let _=t.length||-1;const y=t.hierarchy||[];for(let E=0;E<y.length;E++){const A=y[E].keys;if(A&&A.length!==0)if(A[0].morphTargets){const M={};let P;for(P=0;P<A.length;P++)if(A[P].morphTargets)for(let I=0;I<A[P].morphTargets.length;I++)M[A[P].morphTargets[I]]=-1;for(const I in M){const N=[],O=[];for(let V=0;V!==A[P].morphTargets.length;++V){const Y=A[P];N.push(Y.time),O.push(Y.morphTarget===I?1:0)}u.push(new ud(".morphTargetInfluence["+I+"]",N,O))}_=M.length*(p||1)}else{const M=".bones["+i[E].name+"]";a(ld,M+".position",A,"pos",u),a(Nu,M+".quaternion",A,"rot",u),a(ld,M+".scale",A,"scl",u)}}return u.length===0?null:new this(d,_,u,v)}resetDuration(){let t=0;for(let i=0,a=this.tracks.length;i!==a;++i){const u=this.tracks[i];t=Math.max(t,u.times[u.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let i=0;i<this.tracks.length;i++)t=t&&this.tracks[i].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let i=0;i<this.tracks.length;i++)t.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Cm(f){if(f.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ud;case"vector":case"vector2":case"vector3":case"vector4":return ld;case"color":return up;case"quaternion":return Nu;case"bool":case"boolean":return uh;case"string":return Fu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(f.type);if(f.times===void 0){const i=[],a=[];Kr.flattenJSON(f.keys,i,a,"value"),f.times=i,f.values=a}return t.parse!==void 0?t.parse(f):new t(f.name,f.times,f.values,f.interpolation)}const rs={enabled:!1,files:{},add:function(f,t){this.enabled!==!1&&(this.files[f]=t)},get:function(f){if(this.enabled!==!1)return this.files[f]},remove:function(f){delete this.files[f]},clear:function(){this.files={}}};class lh{constructor(t,i,a){const u=this;let d=!1,p=0,v=0,_;const y=[];this.onStart=void 0,this.onLoad=t,this.onProgress=i,this.onError=a,this.itemStart=function(E){v++,d===!1&&u.onStart!==void 0&&u.onStart(E,p,v),d=!0},this.itemEnd=function(E){p++,u.onProgress!==void 0&&u.onProgress(E,p,v),p===v&&(d=!1,u.onLoad!==void 0&&u.onLoad())},this.itemError=function(E){u.onError!==void 0&&u.onError(E)},this.resolveURL=function(E){return _?_(E):E},this.setURLModifier=function(E){return _=E,this},this.addHandler=function(E,A){return y.push(E,A),this},this.removeHandler=function(E){const A=y.indexOf(E);return A!==-1&&y.splice(A,2),this},this.getHandler=function(E){for(let A=0,M=y.length;A<M;A+=2){const P=y[A],I=y[A+1];if(P.global&&(P.lastIndex=0),P.test(E))return I}return null}}}const Af=new lh;class jo{constructor(t){this.manager=t!==void 0?t:Af,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const a=this;return new Promise(function(u,d){a.load(t,u,i,d)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const ya={};class Za extends jo{constructor(t){super(t)}load(t,i,a,u){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const d=this,p=rs.get(t);if(p!==void 0)return d.manager.itemStart(t),setTimeout(function(){i&&i(p),d.manager.itemEnd(t)},0),p;if(ya[t]!==void 0)return void ya[t].push({onLoad:i,onProgress:a,onError:u});const v=t.match(/^data:(.*?)(;base64)?,(.*)$/);let _;if(v){const y=v[1],E=!!v[2];let A=v[3];A=decodeURIComponent(A),E&&(A=atob(A));try{let M;const P=(this.responseType||"").toLowerCase();switch(P){case"arraybuffer":case"blob":const I=new Uint8Array(A.length);for(let O=0;O<A.length;O++)I[O]=A.charCodeAt(O);M=P==="blob"?new Blob([I.buffer],{type:y}):I.buffer;break;case"document":M=new DOMParser().parseFromString(A,y);break;case"json":M=JSON.parse(A);break;default:M=A}setTimeout(function(){i&&i(M),d.manager.itemEnd(t)},0)}catch(M){setTimeout(function(){u&&u(M),d.manager.itemError(t),d.manager.itemEnd(t)},0)}}else{ya[t]=[],ya[t].push({onLoad:i,onProgress:a,onError:u}),_=new XMLHttpRequest,_.open("GET",t,!0),_.addEventListener("load",function(y){const E=this.response,A=ya[t];if(delete ya[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),rs.add(t,E);for(let M=0,P=A.length;M<P;M++){const I=A[M];I.onLoad&&I.onLoad(E)}d.manager.itemEnd(t)}else{for(let M=0,P=A.length;M<P;M++){const I=A[M];I.onError&&I.onError(y)}d.manager.itemError(t),d.manager.itemEnd(t)}},!1),_.addEventListener("progress",function(y){const E=ya[t];for(let A=0,M=E.length;A<M;A++){const P=E[A];P.onProgress&&P.onProgress(y)}},!1),_.addEventListener("error",function(y){const E=ya[t];delete ya[t];for(let A=0,M=E.length;A<M;A++){const P=E[A];P.onError&&P.onError(y)}d.manager.itemError(t),d.manager.itemEnd(t)},!1),_.addEventListener("abort",function(y){const E=ya[t];delete ya[t];for(let A=0,M=E.length;A<M;A++){const P=E[A];P.onError&&P.onError(y)}d.manager.itemError(t),d.manager.itemEnd(t)},!1),this.responseType!==void 0&&(_.responseType=this.responseType),this.withCredentials!==void 0&&(_.withCredentials=this.withCredentials),_.overrideMimeType&&_.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const y in this.requestHeader)_.setRequestHeader(y,this.requestHeader[y]);_.send(null)}return d.manager.itemStart(t),_}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class tm extends jo{constructor(t){super(t)}load(t,i,a,u){const d=this,p=new Za(this.manager);p.setPath(this.path),p.setRequestHeader(this.requestHeader),p.setWithCredentials(this.withCredentials),p.load(t,function(v){try{i(d.parse(JSON.parse(v)))}catch(_){u?u(_):console.error(_),d.manager.itemError(t)}},a,u)}parse(t){const i=[];for(let a=0;a<t.length;a++){const u=lp.parse(t[a]);i.push(u)}return i}}class Rm extends jo{constructor(t){super(t)}load(t,i,a,u){const d=this,p=[],v=new St,_=new Za(this.manager);_.setPath(this.path),_.setResponseType("arraybuffer"),_.setRequestHeader(this.requestHeader),_.setWithCredentials(d.withCredentials);let y=0;function E(A){_.load(t[A],function(M){const P=d.parse(M,!0);p[A]={width:P.width,height:P.height,format:P.format,mipmaps:P.mipmaps},y+=1,y===6&&(P.mipmapCount===1&&(v.minFilter=Un),v.image=p,v.format=P.format,v.needsUpdate=!0,i&&i(v))},a,u)}if(Array.isArray(t))for(let A=0,M=t.length;A<M;++A)E(A);else _.load(t,function(A){const M=d.parse(A,!0);if(M.isCubemap){const P=M.mipmaps.length/M.mipmapCount;for(let I=0;I<P;I++){p[I]={mipmaps:[]};for(let N=0;N<M.mipmapCount;N++)p[I].mipmaps.push(M.mipmaps[I*M.mipmapCount+N]),p[I].format=M.format,p[I].width=M.width,p[I].height=M.height}v.image=p}else v.image.width=M.width,v.image.height=M.height,v.mipmaps=M.mipmaps;M.mipmapCount===1&&(v.minFilter=Un),v.format=M.format,v.needsUpdate=!0,i&&i(v)},a,u);return v}}class hd extends jo{constructor(t){super(t)}load(t,i,a,u){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const d=this,p=rs.get(t);if(p!==void 0)return d.manager.itemStart(t),setTimeout(function(){i&&i(p),d.manager.itemEnd(t)},0),p;const v=document.createElementNS("http://www.w3.org/1999/xhtml","img");function _(){v.removeEventListener("load",_,!1),v.removeEventListener("error",y,!1),rs.add(t,this),i&&i(this),d.manager.itemEnd(t)}function y(E){v.removeEventListener("load",_,!1),v.removeEventListener("error",y,!1),u&&u(E),d.manager.itemError(t),d.manager.itemEnd(t)}return v.addEventListener("load",_,!1),v.addEventListener("error",y,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(v.crossOrigin=this.crossOrigin),d.manager.itemStart(t),v.src=t,v}}class em extends jo{constructor(t){super(t)}load(t,i,a,u){const d=new $u,p=new hd(this.manager);p.setCrossOrigin(this.crossOrigin),p.setPath(this.path);let v=0;function _(y){p.load(t[y],function(E){d.images[y]=E,v++,v===6&&(d.needsUpdate=!0,i&&i(d))},void 0,u)}for(let y=0;y<t.length;++y)_(y);return d}}class Pf extends jo{constructor(t){super(t)}load(t,i,a,u){const d=this,p=new Ro,v=new Za(this.manager);return v.setResponseType("arraybuffer"),v.setRequestHeader(this.requestHeader),v.setPath(this.path),v.setWithCredentials(d.withCredentials),v.load(t,function(_){const y=d.parse(_);y&&(y.image!==void 0?p.image=y.image:y.data!==void 0&&(p.image.width=y.width,p.image.height=y.height,p.image.data=y.data),p.wrapS=y.wrapS!==void 0?y.wrapS:re,p.wrapT=y.wrapT!==void 0?y.wrapT:re,p.magFilter=y.magFilter!==void 0?y.magFilter:Un,p.minFilter=y.minFilter!==void 0?y.minFilter:Un,p.anisotropy=y.anisotropy!==void 0?y.anisotropy:1,y.encoding!==void 0&&(p.encoding=y.encoding),y.flipY!==void 0&&(p.flipY=y.flipY),y.format!==void 0&&(p.format=y.format),y.type!==void 0&&(p.type=y.type),y.mipmaps!==void 0&&(p.mipmaps=y.mipmaps,p.minFilter=gi),y.mipmapCount===1&&(p.minFilter=Un),y.generateMipmaps!==void 0&&(p.generateMipmaps=y.generateMipmaps),p.needsUpdate=!0,i&&i(p,y))},a,u),p}}class nm extends jo{constructor(t){super(t)}load(t,i,a,u){const d=new ui,p=new hd(this.manager);return p.setCrossOrigin(this.crossOrigin),p.setPath(this.path),p.load(t,function(v){d.image=v;const _=t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0;d.format=_?_n:Sn,d.needsUpdate=!0,i!==void 0&&i(d)},a,u),d}}class qp extends An{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);t.equals(i)||this.curves.push(new dl(i,t))}getPoint(t){const i=t*this.getLength(),a=this.getCurveLengths();let u=0;for(;u<a.length;){if(a[u]>=i){const d=a[u]-i,p=this.curves[u],v=p.getLength(),_=v===0?0:1-d/v;return p.getPointAt(_)}u++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let i=0;for(let a=0,u=this.curves.length;a<u;a++)i+=this.curves[a].getLength(),t.push(i);return this.cacheLengths=t,t}getSpacedPoints(t=40){const i=[];for(let a=0;a<=t;a++)i.push(this.getPoint(a/t));return this.autoClose&&i.push(i[0]),i}getPoints(t=12){const i=[];let a;for(let u=0,d=this.curves;u<d.length;u++){const p=d[u],v=p&&p.isEllipseCurve?2*t:p&&(p.isLineCurve||p.isLineCurve3)?1:p&&p.isSplineCurve?t*p.points.length:t,_=p.getPoints(v);for(let y=0;y<_.length;y++){const E=_[y];a&&a.equals(E)||(i.push(E),a=E)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(t){super.copy(t),this.curves=[];for(let i=0,a=t.curves.length;i<a;i++){const u=t.curves[i];this.curves.push(u.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let i=0,a=this.curves.length;i<a;i++){const u=this.curves[i];t.curves.push(u.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let i=0,a=t.curves.length;i<a;i++){const u=t.curves[i];this.curves.push(new oh[u.type]().fromJSON(u))}return this}}class hp extends qp{constructor(t){super(),this.type="Path",this.currentPoint=new Ge,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let i=1,a=t.length;i<a;i++)this.lineTo(t[i].x,t[i].y);return this}moveTo(t,i){return this.currentPoint.set(t,i),this}lineTo(t,i){const a=new dl(this.currentPoint.clone(),new Ge(t,i));return this.curves.push(a),this.currentPoint.set(t,i),this}quadraticCurveTo(t,i,a,u){const d=new pl(this.currentPoint.clone(),new Ge(t,i),new Ge(a,u));return this.curves.push(d),this.currentPoint.set(a,u),this}bezierCurveTo(t,i,a,u,d,p){const v=new Xa(this.currentPoint.clone(),new Ge(t,i),new Ge(a,u),new Ge(d,p));return this.curves.push(v),this.currentPoint.set(d,p),this}splineThru(t){const i=[this.currentPoint.clone()].concat(t),a=new fl(i);return this.curves.push(a),this.currentPoint.copy(t[t.length-1]),this}arc(t,i,a,u,d,p){const v=this.currentPoint.x,_=this.currentPoint.y;return this.absarc(t+v,i+_,a,u,d,p),this}absarc(t,i,a,u,d,p){return this.absellipse(t,i,a,a,u,d,p),this}ellipse(t,i,a,u,d,p,v,_){const y=this.currentPoint.x,E=this.currentPoint.y;return this.absellipse(t+y,i+E,a,u,d,p,v,_),this}absellipse(t,i,a,u,d,p,v,_){const y=new jn(t,i,a,u,d,p,v,_);if(this.curves.length>0){const A=y.getPoint(0);A.equals(this.currentPoint)||this.lineTo(A.x,A.y)}this.curves.push(y);const E=y.getPoint(1);return this.currentPoint.copy(E),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class gl extends hp{constructor(t){super(t),this.uuid=wo(),this.type="Shape",this.holes=[]}getPointsHoles(t){const i=[];for(let a=0,u=this.holes.length;a<u;a++)i[a]=this.holes[a].getPoints(t);return i}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let i=0,a=t.holes.length;i<a;i++){const u=t.holes[i];this.holes.push(u.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let i=0,a=this.holes.length;i<a;i++){const u=this.holes[i];t.holes.push(u.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let i=0,a=t.holes.length;i<a;i++){const u=t.holes[i];this.holes.push(new hp().fromJSON(u))}return this}}class xa extends mr{constructor(t,i=1){super(),this.type="Light",this.color=new pn(t),this.intensity=i}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const i=super.toJSON(t);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}xa.prototype.isLight=!0;class cp extends xa{constructor(t,i,a){super(t,a),this.type="HemisphereLight",this.position.copy(mr.DefaultUp),this.updateMatrix(),this.groundColor=new pn(i)}copy(t){return xa.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}cp.prototype.isHemisphereLight=!0;const Zp=new wn,Cf=new ot,rm=new ot;class Rf{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Ge(512,512),this.map=null,this.mapPass=null,this.matrix=new wn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ka,this._frameExtents=new Ge(1,1),this._viewportCount=1,this._viewports=[new Rr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const i=this.camera,a=this.matrix;Cf.setFromMatrixPosition(t.matrixWorld),i.position.copy(Cf),rm.setFromMatrixPosition(t.target.matrixWorld),i.lookAt(rm),i.updateMatrixWorld(),Zp.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Zp),a.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),a.multiply(i.projectionMatrix),a.multiply(i.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class dp extends Rf{constructor(){super(new Zi(50,1,.5,500)),this.focus=1}updateMatrices(t){const i=this.camera,a=2*uu*t.angle*this.focus,u=this.mapSize.width/this.mapSize.height,d=t.distance||i.far;a===i.fov&&u===i.aspect&&d===i.far||(i.fov=a,i.aspect=u,i.far=d,i.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}dp.prototype.isSpotLightShadow=!0;class Jp extends xa{constructor(t,i,a=0,u=Math.PI/3,d=0,p=1){super(t,i),this.type="SpotLight",this.position.copy(mr.DefaultUp),this.updateMatrix(),this.target=new mr,this.distance=a,this.angle=u,this.penumbra=d,this.decay=p,this.shadow=new dp}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}Jp.prototype.isSpotLight=!0;const pp=new wn,fp=new ot,If=new ot;class im extends Rf{constructor(){super(new Zi(90,1,.5,500)),this._frameExtents=new Ge(4,2),this._viewportCount=6,this._viewports=[new Rr(2,1,1,1),new Rr(0,1,1,1),new Rr(3,1,1,1),new Rr(1,1,1,1),new Rr(3,0,1,1),new Rr(1,0,1,1)],this._cubeDirections=[new ot(1,0,0),new ot(-1,0,0),new ot(0,0,1),new ot(0,0,-1),new ot(0,1,0),new ot(0,-1,0)],this._cubeUps=[new ot(0,1,0),new ot(0,1,0),new ot(0,1,0),new ot(0,1,0),new ot(0,0,1),new ot(0,0,-1)]}updateMatrices(t,i=0){const a=this.camera,u=this.matrix,d=t.distance||a.far;d!==a.far&&(a.far=d,a.updateProjectionMatrix()),fp.setFromMatrixPosition(t.matrixWorld),a.position.copy(fp),If.copy(a.position),If.add(this._cubeDirections[i]),a.up.copy(this._cubeUps[i]),a.lookAt(If),a.updateMatrixWorld(),u.makeTranslation(-fp.x,-fp.y,-fp.z),pp.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(pp)}}im.prototype.isPointLightShadow=!0;class Lf extends xa{constructor(t,i,a=0,u=1){super(t,i),this.type="PointLight",this.distance=a,this.decay=u,this.shadow=new im}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}Lf.prototype.isPointLight=!0;class mp extends jl{constructor(t=-1,i=1,a=1,u=-1,d=.1,p=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=i,this.top=a,this.bottom=u,this.near=d,this.far=p,this.updateProjectionMatrix()}copy(t,i){return super.copy(t,i),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,i,a,u,d,p){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=a,this.view.offsetY=u,this.view.width=d,this.view.height=p,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),a=(this.right+this.left)/2,u=(this.top+this.bottom)/2;let d=a-t,p=a+t,v=u+i,_=u-i;if(this.view!==null&&this.view.enabled){const y=(this.right-this.left)/this.view.fullWidth/this.zoom,E=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=y*this.view.offsetX,p=d+y*this.view.width,v-=E*this.view.offsetY,_=v-E*this.view.height}this.projectionMatrix.makeOrthographic(d,p,v,_,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const i=super.toJSON(t);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}mp.prototype.isOrthographicCamera=!0;class om extends Rf{constructor(){super(new mp(-5,5,5,-5,.5,500))}}om.prototype.isDirectionalLightShadow=!0;class Of extends xa{constructor(t,i){super(t,i),this.type="DirectionalLight",this.position.copy(mr.DefaultUp),this.updateMatrix(),this.target=new mr,this.shadow=new om}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}Of.prototype.isDirectionalLight=!0;class Df extends xa{constructor(t,i){super(t,i),this.type="AmbientLight"}}Df.prototype.isAmbientLight=!0;class hh extends xa{constructor(t,i,a=10,u=10){super(t,i),this.type="RectAreaLight",this.width=a,this.height=u}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const i=super.toJSON(t);return i.object.width=this.width,i.object.height=this.height,i}}hh.prototype.isRectAreaLight=!0;class $p{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new ot)}set(t){for(let i=0;i<9;i++)this.coefficients[i].copy(t[i]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,i){const a=t.x,u=t.y,d=t.z,p=this.coefficients;return i.copy(p[0]).multiplyScalar(.282095),i.addScaledVector(p[1],.488603*u),i.addScaledVector(p[2],.488603*d),i.addScaledVector(p[3],.488603*a),i.addScaledVector(p[4],a*u*1.092548),i.addScaledVector(p[5],u*d*1.092548),i.addScaledVector(p[6],.315392*(3*d*d-1)),i.addScaledVector(p[7],a*d*1.092548),i.addScaledVector(p[8],.546274*(a*a-u*u)),i}getIrradianceAt(t,i){const a=t.x,u=t.y,d=t.z,p=this.coefficients;return i.copy(p[0]).multiplyScalar(.886227),i.addScaledVector(p[1],1.023328*u),i.addScaledVector(p[2],1.023328*d),i.addScaledVector(p[3],1.023328*a),i.addScaledVector(p[4],.858086*a*u),i.addScaledVector(p[5],.858086*u*d),i.addScaledVector(p[6],.743125*d*d-.247708),i.addScaledVector(p[7],.858086*a*d),i.addScaledVector(p[8],.429043*(a*a-u*u)),i}add(t){for(let i=0;i<9;i++)this.coefficients[i].add(t.coefficients[i]);return this}addScaledSH(t,i){for(let a=0;a<9;a++)this.coefficients[a].addScaledVector(t.coefficients[a],i);return this}scale(t){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(t);return this}lerp(t,i){for(let a=0;a<9;a++)this.coefficients[a].lerp(t.coefficients[a],i);return this}equals(t){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(t.coefficients[i]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,i=0){const a=this.coefficients;for(let u=0;u<9;u++)a[u].fromArray(t,i+3*u);return this}toArray(t=[],i=0){const a=this.coefficients;for(let u=0;u<9;u++)a[u].toArray(t,i+3*u);return t}static getBasisAt(t,i){const a=t.x,u=t.y,d=t.z;i[0]=.282095,i[1]=.488603*u,i[2]=.488603*d,i[3]=.488603*a,i[4]=1.092548*a*u,i[5]=1.092548*u*d,i[6]=.315392*(3*d*d-1),i[7]=1.092548*a*d,i[8]=.546274*(a*a-u*u)}}$p.prototype.isSphericalHarmonics3=!0;class vl extends xa{constructor(t=new $p,i=1){super(void 0,i),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const i=super.toJSON(t);return i.object.sh=this.sh.toArray(),i}}vl.prototype.isLightProbe=!0;class Re extends jo{constructor(t){super(t),this.textures={}}load(t,i,a,u){const d=this,p=new Za(d.manager);p.setPath(d.path),p.setRequestHeader(d.requestHeader),p.setWithCredentials(d.withCredentials),p.load(t,function(v){try{i(d.parse(JSON.parse(v)))}catch(_){u?u(_):console.error(_),d.manager.itemError(t)}},a,u)}parse(t){const i=this.textures;function a(d){return i[d]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",d),i[d]}const u=new Pm[t.type];if(t.uuid!==void 0&&(u.uuid=t.uuid),t.name!==void 0&&(u.name=t.name),t.color!==void 0&&u.color!==void 0&&u.color.setHex(t.color),t.roughness!==void 0&&(u.roughness=t.roughness),t.metalness!==void 0&&(u.metalness=t.metalness),t.sheen!==void 0&&(u.sheen=new pn().setHex(t.sheen)),t.emissive!==void 0&&u.emissive!==void 0&&u.emissive.setHex(t.emissive),t.specular!==void 0&&u.specular!==void 0&&u.specular.setHex(t.specular),t.shininess!==void 0&&(u.shininess=t.shininess),t.clearcoat!==void 0&&(u.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(u.clearcoatRoughness=t.clearcoatRoughness),t.transmission!==void 0&&(u.transmission=t.transmission),t.thickness!==void 0&&(u.thickness=t.thickness),t.attenuationDistance!==void 0&&(u.attenuationDistance=t.attenuationDistance),t.attenuationColor!==void 0&&u.attenuationColor!==void 0&&u.attenuationColor.setHex(t.attenuationColor),t.fog!==void 0&&(u.fog=t.fog),t.flatShading!==void 0&&(u.flatShading=t.flatShading),t.blending!==void 0&&(u.blending=t.blending),t.combine!==void 0&&(u.combine=t.combine),t.side!==void 0&&(u.side=t.side),t.shadowSide!==void 0&&(u.shadowSide=t.shadowSide),t.opacity!==void 0&&(u.opacity=t.opacity),t.transparent!==void 0&&(u.transparent=t.transparent),t.alphaTest!==void 0&&(u.alphaTest=t.alphaTest),t.depthTest!==void 0&&(u.depthTest=t.depthTest),t.depthWrite!==void 0&&(u.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(u.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(u.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(u.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(u.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(u.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(u.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(u.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(u.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(u.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(u.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(u.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(u.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(u.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(u.rotation=t.rotation),t.linewidth!==1&&(u.linewidth=t.linewidth),t.dashSize!==void 0&&(u.dashSize=t.dashSize),t.gapSize!==void 0&&(u.gapSize=t.gapSize),t.scale!==void 0&&(u.scale=t.scale),t.polygonOffset!==void 0&&(u.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(u.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(u.polygonOffsetUnits=t.polygonOffsetUnits),t.morphTargets!==void 0&&(u.morphTargets=t.morphTargets),t.morphNormals!==void 0&&(u.morphNormals=t.morphNormals),t.dithering!==void 0&&(u.dithering=t.dithering),t.alphaToCoverage!==void 0&&(u.alphaToCoverage=t.alphaToCoverage),t.premultipliedAlpha!==void 0&&(u.premultipliedAlpha=t.premultipliedAlpha),t.vertexTangents!==void 0&&(u.vertexTangents=t.vertexTangents),t.visible!==void 0&&(u.visible=t.visible),t.toneMapped!==void 0&&(u.toneMapped=t.toneMapped),t.userData!==void 0&&(u.userData=t.userData),t.vertexColors!==void 0&&(typeof t.vertexColors=="number"?u.vertexColors=t.vertexColors>0:u.vertexColors=t.vertexColors),t.uniforms!==void 0)for(const d in t.uniforms){const p=t.uniforms[d];switch(u.uniforms[d]={},p.type){case"t":u.uniforms[d].value=a(p.value);break;case"c":u.uniforms[d].value=new pn().setHex(p.value);break;case"v2":u.uniforms[d].value=new Ge().fromArray(p.value);break;case"v3":u.uniforms[d].value=new ot().fromArray(p.value);break;case"v4":u.uniforms[d].value=new Rr().fromArray(p.value);break;case"m3":u.uniforms[d].value=new Ii().fromArray(p.value);break;case"m4":u.uniforms[d].value=new wn().fromArray(p.value);break;default:u.uniforms[d].value=p.value}}if(t.defines!==void 0&&(u.defines=t.defines),t.vertexShader!==void 0&&(u.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(u.fragmentShader=t.fragmentShader),t.extensions!==void 0)for(const d in t.extensions)u.extensions[d]=t.extensions[d];if(t.shading!==void 0&&(u.flatShading=t.shading===1),t.size!==void 0&&(u.size=t.size),t.sizeAttenuation!==void 0&&(u.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(u.map=a(t.map)),t.matcap!==void 0&&(u.matcap=a(t.matcap)),t.alphaMap!==void 0&&(u.alphaMap=a(t.alphaMap)),t.bumpMap!==void 0&&(u.bumpMap=a(t.bumpMap)),t.bumpScale!==void 0&&(u.bumpScale=t.bumpScale),t.normalMap!==void 0&&(u.normalMap=a(t.normalMap)),t.normalMapType!==void 0&&(u.normalMapType=t.normalMapType),t.normalScale!==void 0){let d=t.normalScale;Array.isArray(d)===!1&&(d=[d,d]),u.normalScale=new Ge().fromArray(d)}return t.displacementMap!==void 0&&(u.displacementMap=a(t.displacementMap)),t.displacementScale!==void 0&&(u.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(u.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(u.roughnessMap=a(t.roughnessMap)),t.metalnessMap!==void 0&&(u.metalnessMap=a(t.metalnessMap)),t.emissiveMap!==void 0&&(u.emissiveMap=a(t.emissiveMap)),t.emissiveIntensity!==void 0&&(u.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(u.specularMap=a(t.specularMap)),t.envMap!==void 0&&(u.envMap=a(t.envMap)),t.envMapIntensity!==void 0&&(u.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(u.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(u.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(u.lightMap=a(t.lightMap)),t.lightMapIntensity!==void 0&&(u.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(u.aoMap=a(t.aoMap)),t.aoMapIntensity!==void 0&&(u.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(u.gradientMap=a(t.gradientMap)),t.clearcoatMap!==void 0&&(u.clearcoatMap=a(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(u.clearcoatRoughnessMap=a(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(u.clearcoatNormalMap=a(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(u.clearcoatNormalScale=new Ge().fromArray(t.clearcoatNormalScale)),t.transmissionMap!==void 0&&(u.transmissionMap=a(t.transmissionMap)),t.thicknessMap!==void 0&&(u.thicknessMap=a(t.thicknessMap)),u}setTextures(t){return this.textures=t,this}}class Kp{static decodeText(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);let i="";for(let a=0,u=t.length;a<u;a++)i+=String.fromCharCode(t[a]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(t){const i=t.lastIndexOf("/");return i===-1?"./":t.substr(0,i+1)}}class lc extends Hn{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}lc.prototype.isInstancedBufferGeometry=!0;class cd extends yr{constructor(t,i,a,u=1){typeof a=="number"&&(u=a,a=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,i,a),this.meshPerAttribute=u}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}cd.prototype.isInstancedBufferAttribute=!0;class Qp extends jo{constructor(t){super(t)}load(t,i,a,u){const d=this,p=new Za(d.manager);p.setPath(d.path),p.setRequestHeader(d.requestHeader),p.setWithCredentials(d.withCredentials),p.load(t,function(v){try{i(d.parse(JSON.parse(v)))}catch(_){u?u(_):console.error(_),d.manager.itemError(t)}},a,u)}parse(t){const i={},a={};function u(A,M){if(i[M]!==void 0)return i[M];const P=A.interleavedBuffers[M],I=function(V,Y){if(a[Y]!==void 0)return a[Y];const at=V.arrayBuffers[Y],st=new Uint32Array(at).buffer;return a[Y]=st,st}(A,P.buffer),N=$o(P.type,I),O=new Cu(N,P.stride);return O.uuid=P.uuid,i[M]=O,O}const d=t.isInstancedBufferGeometry?new lc:new Hn,p=t.data.index;if(p!==void 0){const A=$o(p.type,p.array);d.setIndex(new yr(A,1))}const v=t.data.attributes;for(const A in v){const M=v[A];let P;if(M.isInterleavedBufferAttribute){const I=u(t.data,M.data);P=new oi(I,M.itemSize,M.offset,M.normalized)}else{const I=$o(M.type,M.array);P=new(M.isInstancedBufferAttribute?cd:yr)(I,M.itemSize,M.normalized)}M.name!==void 0&&(P.name=M.name),M.usage!==void 0&&P.setUsage(M.usage),M.updateRange!==void 0&&(P.updateRange.offset=M.updateRange.offset,P.updateRange.count=M.updateRange.count),d.setAttribute(A,P)}const _=t.data.morphAttributes;if(_)for(const A in _){const M=_[A],P=[];for(let I=0,N=M.length;I<N;I++){const O=M[I];let V;if(O.isInterleavedBufferAttribute){const Y=u(t.data,O.data);V=new oi(Y,O.itemSize,O.offset,O.normalized)}else{const Y=$o(O.type,O.array);V=new yr(Y,O.itemSize,O.normalized)}O.name!==void 0&&(V.name=O.name),P.push(V)}d.morphAttributes[A]=P}t.data.morphTargetsRelative&&(d.morphTargetsRelative=!0);const y=t.data.groups||t.data.drawcalls||t.data.offsets;if(y!==void 0)for(let A=0,M=y.length;A!==M;++A){const P=y[A];d.addGroup(P.start,P.count,P.materialIndex)}const E=t.data.boundingSphere;if(E!==void 0){const A=new ot;E.center!==void 0&&A.fromArray(E.center),d.boundingSphere=new Jo(A,E.radius)}return t.name&&(d.name=t.name),t.userData&&(d.userData=t.userData),d}}class sm extends jo{constructor(t){super(t)}load(t,i,a,u){const d=this,p=this.path===""?Kp.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||p;const v=new Za(this.manager);v.setPath(this.path),v.setRequestHeader(this.requestHeader),v.setWithCredentials(this.withCredentials),v.load(t,function(_){let y=null;try{y=JSON.parse(_)}catch(A){return u!==void 0&&u(A),void console.error("THREE:ObjectLoader: Can't parse "+t+".",A.message)}const E=y.metadata;E!==void 0&&E.type!==void 0&&E.type.toLowerCase()!=="geometry"?d.parse(y,i):console.error("THREE.ObjectLoader: Can't load "+t)},a,u)}async loadAsync(t,i){const a=this.path===""?Kp.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||a;const u=new Za(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials);const d=await u.loadAsync(t,i),p=JSON.parse(d),v=p.metadata;if(v===void 0||v.type===void 0||v.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+t);return await this.parseAsync(p)}parse(t,i){const a=this.parseAnimations(t.animations),u=this.parseShapes(t.shapes),d=this.parseGeometries(t.geometries,u),p=this.parseImages(t.images,function(){i!==void 0&&i(y)}),v=this.parseTextures(t.textures,p),_=this.parseMaterials(t.materials,v),y=this.parseObject(t.object,d,_,v,a),E=this.parseSkeletons(t.skeletons,y);if(this.bindSkeletons(y,E),i!==void 0){let A=!1;for(const M in p)if(p[M]instanceof HTMLImageElement){A=!0;break}A===!1&&i(y)}return y}async parseAsync(t){const i=this.parseAnimations(t.animations),a=this.parseShapes(t.shapes),u=this.parseGeometries(t.geometries,a),d=await this.parseImagesAsync(t.images),p=this.parseTextures(t.textures,d),v=this.parseMaterials(t.materials,p),_=this.parseObject(t.object,u,v,p,i),y=this.parseSkeletons(t.skeletons,_);return this.bindSkeletons(_,y),_}parseShapes(t){const i={};if(t!==void 0)for(let a=0,u=t.length;a<u;a++){const d=new gl().fromJSON(t[a]);i[d.uuid]=d}return i}parseSkeletons(t,i){const a={},u={};if(i.traverse(function(d){d.isBone&&(u[d.uuid]=d)}),t!==void 0)for(let d=0,p=t.length;d<p;d++){const v=new hl().fromJSON(t[d],u);a[v.uuid]=v}return a}parseGeometries(t,i){const a={};if(t!==void 0){const u=new Qp;for(let d=0,p=t.length;d<p;d++){let v;const _=t[d];switch(_.type){case"BufferGeometry":case"InstancedBufferGeometry":v=u.parse(_);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:_.type in Qf?v=Qf[_.type].fromJSON(_,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${_.type}"`)}v.uuid=_.uuid,_.name!==void 0&&(v.name=_.name),v.isBufferGeometry===!0&&_.userData!==void 0&&(v.userData=_.userData),a[_.uuid]=v}}return a}parseMaterials(t,i){const a={},u={};if(t!==void 0){const d=new Re;d.setTextures(i);for(let p=0,v=t.length;p<v;p++){const _=t[p];if(_.type==="MultiMaterial"){const y=[];for(let E=0;E<_.materials.length;E++){const A=_.materials[E];a[A.uuid]===void 0&&(a[A.uuid]=d.parse(A)),y.push(a[A.uuid])}u[_.uuid]=y}else a[_.uuid]===void 0&&(a[_.uuid]=d.parse(_)),u[_.uuid]=a[_.uuid]}}return u}parseAnimations(t){const i={};if(t!==void 0)for(let a=0;a<t.length;a++){const u=t[a],d=lp.parse(u);i[d.uuid]=d}return i}parseImages(t,i){const a=this,u={};let d;function p(v){if(typeof v=="string"){const _=v;return function(y){return a.manager.itemStart(y),d.load(y,function(){a.manager.itemEnd(y)},void 0,function(){a.manager.itemError(y),a.manager.itemEnd(y)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(_)?_:a.resourcePath+_)}return v.data?{data:$o(v.type,v.data),width:v.width,height:v.height}:null}if(t!==void 0&&t.length>0){const v=new lh(i);d=new hd(v),d.setCrossOrigin(this.crossOrigin);for(let _=0,y=t.length;_<y;_++){const E=t[_],A=E.url;if(Array.isArray(A)){u[E.uuid]=[];for(let M=0,P=A.length;M<P;M++){const I=p(A[M]);I!==null&&(I instanceof HTMLImageElement?u[E.uuid].push(I):u[E.uuid].push(new Ro(I.data,I.width,I.height)))}}else{const M=p(E.url);M!==null&&(u[E.uuid]=M)}}}return u}async parseImagesAsync(t){const i=this,a={};let u;async function d(p){if(typeof p=="string"){const v=p,_=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(v)?v:i.resourcePath+v;return await u.loadAsync(_)}return p.data?{data:$o(p.type,p.data),width:p.width,height:p.height}:null}if(t!==void 0&&t.length>0){u=new hd(this.manager),u.setCrossOrigin(this.crossOrigin);for(let p=0,v=t.length;p<v;p++){const _=t[p],y=_.url;if(Array.isArray(y)){a[_.uuid]=[];for(let E=0,A=y.length;E<A;E++){const M=y[E],P=await d(M);P!==null&&(P instanceof HTMLImageElement?a[_.uuid].push(P):a[_.uuid].push(new Ro(P.data,P.width,P.height)))}}else{const E=await d(_.url);E!==null&&(a[_.uuid]=E)}}}return a}parseTextures(t,i){function a(d,p){return typeof d=="number"?d:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",d),p[d])}const u={};if(t!==void 0)for(let d=0,p=t.length;d<p;d++){const v=t[d];let _;v.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',v.uuid),i[v.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",v.image);const y=i[v.image];Array.isArray(y)?(_=new $u(y),y.length===6&&(_.needsUpdate=!0)):(_=y&&y.data?new Ro(y.data,y.width,y.height):new ui(y),y&&(_.needsUpdate=!0)),_.uuid=v.uuid,v.name!==void 0&&(_.name=v.name),v.mapping!==void 0&&(_.mapping=a(v.mapping,tf)),v.offset!==void 0&&_.offset.fromArray(v.offset),v.repeat!==void 0&&_.repeat.fromArray(v.repeat),v.center!==void 0&&_.center.fromArray(v.center),v.rotation!==void 0&&(_.rotation=v.rotation),v.wrap!==void 0&&(_.wrapS=a(v.wrap[0],am),_.wrapT=a(v.wrap[1],am)),v.format!==void 0&&(_.format=v.format),v.type!==void 0&&(_.type=v.type),v.encoding!==void 0&&(_.encoding=v.encoding),v.minFilter!==void 0&&(_.minFilter=a(v.minFilter,ba)),v.magFilter!==void 0&&(_.magFilter=a(v.magFilter,ba)),v.anisotropy!==void 0&&(_.anisotropy=v.anisotropy),v.flipY!==void 0&&(_.flipY=v.flipY),v.premultiplyAlpha!==void 0&&(_.premultiplyAlpha=v.premultiplyAlpha),v.unpackAlignment!==void 0&&(_.unpackAlignment=v.unpackAlignment),u[v.uuid]=_}return u}parseObject(t,i,a,u,d){let p,v,_;function y(M){return i[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",M),i[M]}function E(M){if(M!==void 0){if(Array.isArray(M)){const P=[];for(let I=0,N=M.length;I<N;I++){const O=M[I];a[O]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",O),P.push(a[O])}return P}return a[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",M),a[M]}}function A(M){return u[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",M),u[M]}switch(t.type){case"Scene":p=new Kl,t.background!==void 0&&(Number.isInteger(t.background)?p.background=new pn(t.background):p.background=A(t.background)),t.environment!==void 0&&(p.environment=A(t.environment)),t.fog!==void 0&&(t.fog.type==="Fog"?p.fog=new Pu(t.fog.color,t.fog.near,t.fog.far):t.fog.type==="FogExp2"&&(p.fog=new sl(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":p=new Zi(t.fov,t.aspect,t.near,t.far),t.focus!==void 0&&(p.focus=t.focus),t.zoom!==void 0&&(p.zoom=t.zoom),t.filmGauge!==void 0&&(p.filmGauge=t.filmGauge),t.filmOffset!==void 0&&(p.filmOffset=t.filmOffset),t.view!==void 0&&(p.view=Object.assign({},t.view));break;case"OrthographicCamera":p=new mp(t.left,t.right,t.top,t.bottom,t.near,t.far),t.zoom!==void 0&&(p.zoom=t.zoom),t.view!==void 0&&(p.view=Object.assign({},t.view));break;case"AmbientLight":p=new Df(t.color,t.intensity);break;case"DirectionalLight":p=new Of(t.color,t.intensity);break;case"PointLight":p=new Lf(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":p=new hh(t.color,t.intensity,t.width,t.height);break;case"SpotLight":p=new Jp(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":p=new cp(t.color,t.groundColor,t.intensity);break;case"LightProbe":p=new vl().fromJSON(t);break;case"SkinnedMesh":v=y(t.geometry),_=E(t.material),p=new ll(v,_),t.bindMode!==void 0&&(p.bindMode=t.bindMode),t.bindMatrix!==void 0&&p.bindMatrix.fromArray(t.bindMatrix),t.skeleton!==void 0&&(p.skeleton=t.skeleton);break;case"Mesh":v=y(t.geometry),_=E(t.material),p=new Ni(v,_);break;case"InstancedMesh":v=y(t.geometry),_=E(t.material);const M=t.count,P=t.instanceMatrix,I=t.instanceColor;p=new qc(v,_,M),p.instanceMatrix=new yr(new Float32Array(P.array),16),I!==void 0&&(p.instanceColor=new yr(new Float32Array(I.array),I.itemSize));break;case"LOD":p=new Xc;break;case"Line":p=new Va(y(t.geometry),E(t.material));break;case"LineLoop":p=new tp(y(t.geometry),E(t.material));break;case"LineSegments":p=new ts(y(t.geometry),E(t.material));break;case"PointCloud":case"Points":p=new H(y(t.geometry),E(t.material));break;case"Sprite":p=new nh(E(t.material));break;case"Group":p=new Au;break;case"Bone":p=new io;break;default:p=new mr}if(p.uuid=t.uuid,t.name!==void 0&&(p.name=t.name),t.matrix!==void 0?(p.matrix.fromArray(t.matrix),t.matrixAutoUpdate!==void 0&&(p.matrixAutoUpdate=t.matrixAutoUpdate),p.matrixAutoUpdate&&p.matrix.decompose(p.position,p.quaternion,p.scale)):(t.position!==void 0&&p.position.fromArray(t.position),t.rotation!==void 0&&p.rotation.fromArray(t.rotation),t.quaternion!==void 0&&p.quaternion.fromArray(t.quaternion),t.scale!==void 0&&p.scale.fromArray(t.scale)),t.castShadow!==void 0&&(p.castShadow=t.castShadow),t.receiveShadow!==void 0&&(p.receiveShadow=t.receiveShadow),t.shadow&&(t.shadow.bias!==void 0&&(p.shadow.bias=t.shadow.bias),t.shadow.normalBias!==void 0&&(p.shadow.normalBias=t.shadow.normalBias),t.shadow.radius!==void 0&&(p.shadow.radius=t.shadow.radius),t.shadow.mapSize!==void 0&&p.shadow.mapSize.fromArray(t.shadow.mapSize),t.shadow.camera!==void 0&&(p.shadow.camera=this.parseObject(t.shadow.camera))),t.visible!==void 0&&(p.visible=t.visible),t.frustumCulled!==void 0&&(p.frustumCulled=t.frustumCulled),t.renderOrder!==void 0&&(p.renderOrder=t.renderOrder),t.userData!==void 0&&(p.userData=t.userData),t.layers!==void 0&&(p.layers.mask=t.layers),t.children!==void 0){const M=t.children;for(let P=0;P<M.length;P++)p.add(this.parseObject(M[P],i,a,u,d))}if(t.animations!==void 0){const M=t.animations;for(let P=0;P<M.length;P++){const I=M[P];p.animations.push(d[I])}}if(t.type==="LOD"){t.autoUpdate!==void 0&&(p.autoUpdate=t.autoUpdate);const M=t.levels;for(let P=0;P<M.length;P++){const I=M[P],N=p.getObjectByProperty("uuid",I.object);N!==void 0&&p.addLevel(N,I.distance)}}return p}bindSkeletons(t,i){Object.keys(i).length!==0&&t.traverse(function(a){if(a.isSkinnedMesh===!0&&a.skeleton!==void 0){const u=i[a.skeleton];u===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",a.skeleton):a.bind(u,a.bindMatrix)}})}setTexturePath(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}const tf={UVMapping:yo,CubeReflectionMapping:Q,CubeRefractionMapping:ft,EquirectangularReflectionMapping:dt,EquirectangularRefractionMapping:Lt,CubeUVReflectionMapping:Ct,CubeUVRefractionMapping:It},am={RepeatWrapping:Zt,ClampToEdgeWrapping:re,MirroredRepeatWrapping:pe},ba={NearestFilter:Kt,NearestMipmapNearestFilter:qe,NearestMipmapLinearFilter:Pn,LinearFilter:Un,LinearMipmapNearestFilter:jr,LinearMipmapLinearFilter:gi};class wa extends jo{constructor(t){super(t),typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,i,a,u){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const d=this,p=rs.get(t);if(p!==void 0)return d.manager.itemStart(t),setTimeout(function(){i&&i(p),d.manager.itemEnd(t)},0),p;const v={};v.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",v.headers=this.requestHeader,fetch(t,v).then(function(_){return _.blob()}).then(function(_){return createImageBitmap(_,Object.assign(d.options,{colorSpaceConversion:"none"}))}).then(function(_){rs.add(t,_),i&&i(_),d.manager.itemEnd(t)}).catch(function(_){u&&u(_),d.manager.itemError(t),d.manager.itemEnd(t)}),d.manager.itemStart(t)}}wa.prototype.isImageBitmapLoader=!0;class _l{constructor(){this.type="ShapePath",this.color=new pn,this.subPaths=[],this.currentPath=null}moveTo(t,i){return this.currentPath=new hp,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,i),this}lineTo(t,i){return this.currentPath.lineTo(t,i),this}quadraticCurveTo(t,i,a,u){return this.currentPath.quadraticCurveTo(t,i,a,u),this}bezierCurveTo(t,i,a,u,d,p){return this.currentPath.bezierCurveTo(t,i,a,u,d,p),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t,i){function a(Y){const at=[];for(let st=0,yt=Y.length;st<yt;st++){const bt=Y[st],_t=new gl;_t.curves=bt.curves,at.push(_t)}return at}function u(Y,at){const st=at.length;let yt=!1;for(let bt=st-1,_t=0;_t<st;bt=_t++){let Et=at[bt],Ce=at[_t],ge=Ce.x-Et.x,ve=Ce.y-Et.y;if(Math.abs(ve)>Number.EPSILON){if(ve<0&&(Et=at[_t],ge=-ge,Ce=at[bt],ve=-ve),Y.y<Et.y||Y.y>Ce.y)continue;if(Y.y===Et.y){if(Y.x===Et.x)return!0}else{const ce=ve*(Y.x-Et.x)-ge*(Y.y-Et.y);if(ce===0)return!0;if(ce<0)continue;yt=!yt}}else{if(Y.y!==Et.y)continue;if(Ce.x<=Y.x&&Y.x<=Et.x||Et.x<=Y.x&&Y.x<=Ce.x)return!0}}return yt}const d=va.isClockWise,p=this.subPaths;if(p.length===0)return[];if(i===!0)return a(p);let v,_,y;const E=[];if(p.length===1)return _=p[0],y=new gl,y.curves=_.curves,E.push(y),E;let A=!d(p[0].getPoints());A=t?!A:A;const M=[],P=[];let I,N,O=[],V=0;P[V]=void 0,O[V]=[];for(let Y=0,at=p.length;Y<at;Y++)_=p[Y],I=_.getPoints(),v=d(I),v=t?!v:v,v?(!A&&P[V]&&V++,P[V]={s:new gl,p:I},P[V].s.curves=_.curves,A&&V++,O[V]=[]):O[V].push({h:_,p:I[0]});if(!P[0])return a(p);if(P.length>1){let Y=!1;const at=[];for(let st=0,yt=P.length;st<yt;st++)M[st]=[];for(let st=0,yt=P.length;st<yt;st++){const bt=O[st];for(let _t=0;_t<bt.length;_t++){const Et=bt[_t];let Ce=!0;for(let ge=0;ge<P.length;ge++)u(Et.p,P[ge].p)&&(st!==ge&&at.push({froms:st,tos:ge,hole:_t}),Ce?(Ce=!1,M[ge].push(Et)):Y=!0);Ce&&M[st].push(Et)}}at.length>0&&(Y||(O=M))}for(let Y=0,at=P.length;Y<at;Y++){y=P[Y].s,E.push(y),N=O[Y];for(let st=0,yt=N.length;st<yt;st++)y.holes.push(N[st].h)}return E}}class Bu{constructor(t){this.type="Font",this.data=t}generateShapes(t,i=100){const a=[],u=function(d,p,v){const _=Array.from(d),y=p/v.resolution,E=(v.boundingBox.yMax-v.boundingBox.yMin+v.underlineThickness)*y,A=[];let M=0,P=0;for(let I=0;I<_.length;I++){const N=_[I];if(N===`
`)M=0,P-=E;else{const O=ch(N,y,M,P,v);M+=O.offsetX,A.push(O.path)}}return A}(t,i,this.data);for(let d=0,p=u.length;d<p;d++)Array.prototype.push.apply(a,u[d].toShapes());return a}}function ch(f,t,i,a,u){const d=u.glyphs[f]||u.glyphs["?"];if(!d)return void console.error('THREE.Font: character "'+f+'" does not exists in font family '+u.familyName+".");const p=new _l;let v,_,y,E,A,M,P,I;if(d.o){const N=d._cachedOutline||(d._cachedOutline=d.o.split(" "));for(let O=0,V=N.length;O<V;)switch(N[O++]){case"m":v=N[O++]*t+i,_=N[O++]*t+a,p.moveTo(v,_);break;case"l":v=N[O++]*t+i,_=N[O++]*t+a,p.lineTo(v,_);break;case"q":y=N[O++]*t+i,E=N[O++]*t+a,A=N[O++]*t+i,M=N[O++]*t+a,p.quadraticCurveTo(A,M,y,E);break;case"b":y=N[O++]*t+i,E=N[O++]*t+a,A=N[O++]*t+i,M=N[O++]*t+a,P=N[O++]*t+i,I=N[O++]*t+a,p.bezierCurveTo(A,M,P,I,y,E)}}return{offsetX:d.ha*t,path:p}}Bu.prototype.isFont=!0;class Io extends jo{constructor(t){super(t)}load(t,i,a,u){const d=this,p=new Za(this.manager);p.setPath(this.path),p.setRequestHeader(this.requestHeader),p.setWithCredentials(d.withCredentials),p.load(t,function(v){let _;try{_=JSON.parse(v)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),_=JSON.parse(v.substring(65,v.length-2))}const y=d.parse(_);i&&i(y)},a,u)}parse(t){return new Bu(t)}}let dd;const gp={getContext:function(){return dd===void 0&&(dd=new(window.AudioContext||window.webkitAudioContext)),dd},setContext:function(f){dd=f}};class dh extends jo{constructor(t){super(t)}load(t,i,a,u){const d=this,p=new Za(this.manager);p.setResponseType("arraybuffer"),p.setPath(this.path),p.setRequestHeader(this.requestHeader),p.setWithCredentials(this.withCredentials),p.load(t,function(v){try{const _=v.slice(0);gp.getContext().decodeAudioData(_,function(y){i(y)})}catch(_){u?u(_):console.error(_),d.manager.itemError(t)}},a,u)}}class Nf extends vl{constructor(t,i,a=1){super(void 0,a);const u=new pn().set(t),d=new pn().set(i),p=new ot(u.r,u.g,u.b),v=new ot(d.r,d.g,d.b),_=Math.sqrt(Math.PI),y=_*Math.sqrt(.75);this.sh.coefficients[0].copy(p).add(v).multiplyScalar(_),this.sh.coefficients[1].copy(p).sub(v).multiplyScalar(y)}}Nf.prototype.isHemisphereLightProbe=!0;class um extends vl{constructor(t,i=1){super(void 0,i);const a=new pn().set(t);this.sh.coefficients[0].set(a.r,a.g,a.b).multiplyScalar(2*Math.sqrt(Math.PI))}}um.prototype.isAmbientLightProbe=!0;const Ja=new wn,Wt=new wn;class lm{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Zi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Zi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const i=this._cache;if(i.focus!==t.focus||i.fov!==t.fov||i.aspect!==t.aspect*this.aspect||i.near!==t.near||i.far!==t.far||i.zoom!==t.zoom||i.eyeSep!==this.eyeSep){i.focus=t.focus,i.fov=t.fov,i.aspect=t.aspect*this.aspect,i.near=t.near,i.far=t.far,i.zoom=t.zoom,i.eyeSep=this.eyeSep;const a=t.projectionMatrix.clone(),u=i.eyeSep/2,d=u*i.near/i.focus,p=i.near*Math.tan(uo*i.fov*.5)/i.zoom;let v,_;Wt.elements[12]=-u,Ja.elements[12]=u,v=-p*i.aspect+d,_=p*i.aspect+d,a.elements[0]=2*i.near/(_-v),a.elements[8]=(_+v)/(_-v),this.cameraL.projectionMatrix.copy(a),v=-p*i.aspect-d,_=p*i.aspect-d,a.elements[0]=2*i.near/(_-v),a.elements[8]=(_+v)/(_-v),this.cameraR.projectionMatrix.copy(a)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Wt),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Ja)}}class hm{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=cm(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=cm();t=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=t}return t}}function cm(){return(typeof performance=="undefined"?Date:performance).now()}const ph=new ot,Ff=new eo,ef=new ot,fh=new ot;class Bf extends mr{constructor(){super(),this.type="AudioListener",this.context=gp.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new hm}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const i=this.context.listener,a=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(ph,Ff,ef),fh.set(0,0,-1).applyQuaternion(Ff),i.positionX){const u=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(ph.x,u),i.positionY.linearRampToValueAtTime(ph.y,u),i.positionZ.linearRampToValueAtTime(ph.z,u),i.forwardX.linearRampToValueAtTime(fh.x,u),i.forwardY.linearRampToValueAtTime(fh.y,u),i.forwardZ.linearRampToValueAtTime(fh.z,u),i.upX.linearRampToValueAtTime(a.x,u),i.upY.linearRampToValueAtTime(a.y,u),i.upZ.linearRampToValueAtTime(a.z,u)}else i.setPosition(ph.x,ph.y,ph.z),i.setOrientation(fh.x,fh.y,fh.z,a.x,a.y,a.z)}}class nf extends mr{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,i=this.filters.length;t<i;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,i=this.filters.length;t<i;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),this._connected===!0?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl!==!1)return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(this.hasPlaybackControl!==!1)return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const yl=new ot,dm=new eo,pm=new ot,hc=new ot;class Im extends nf{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,i,a){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=a,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(yl,dm,pm),hc.set(0,0,1).applyQuaternion(dm);const i=this.panner;if(i.positionX){const a=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(yl.x,a),i.positionY.linearRampToValueAtTime(yl.y,a),i.positionZ.linearRampToValueAtTime(yl.z,a),i.orientationX.linearRampToValueAtTime(hc.x,a),i.orientationY.linearRampToValueAtTime(hc.y,a),i.orientationZ.linearRampToValueAtTime(hc.z,a)}else i.setPosition(yl.x,yl.y,yl.z),i.setOrientation(hc.x,hc.y,hc.z)}}class fm{constructor(t,i=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const i=this.getFrequencyData();for(let a=0;a<i.length;a++)t+=i[a];return t/i.length}}class mm{constructor(t,i,a){let u,d,p;switch(this.binding=t,this.valueSize=a,i){case"quaternion":u=this._slerp,d=this._slerpAdditive,p=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*a),this._workIndex=5;break;case"string":case"bool":u=this._select,d=this._select,p=this._setAdditiveIdentityOther,this.buffer=new Array(5*a);break;default:u=this._lerp,d=this._lerpAdditive,p=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*a)}this._mixBufferRegion=u,this._mixBufferRegionAdditive=d,this._setIdentity=p,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,i){const a=this.buffer,u=this.valueSize,d=t*u+u;let p=this.cumulativeWeight;if(p===0){for(let v=0;v!==u;++v)a[d+v]=a[v];p=i}else{p+=i;const v=i/p;this._mixBufferRegion(a,d,0,v,u)}this.cumulativeWeight=p}accumulateAdditive(t){const i=this.buffer,a=this.valueSize,u=a*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,u,0,t,a),this.cumulativeWeightAdditive+=t}apply(t){const i=this.valueSize,a=this.buffer,u=t*i+i,d=this.cumulativeWeight,p=this.cumulativeWeightAdditive,v=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,d<1){const _=i*this._origIndex;this._mixBufferRegion(a,u,_,1-d,i)}p>0&&this._mixBufferRegionAdditive(a,u,this._addIndex*i,1,i);for(let _=i,y=i+i;_!==y;++_)if(a[_]!==a[_+i]){v.setValue(a,u);break}}saveOriginalState(){const t=this.binding,i=this.buffer,a=this.valueSize,u=a*this._origIndex;t.getValue(i,u);for(let d=a,p=u;d!==p;++d)i[d]=i[u+d%a];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,i=t+this.valueSize;for(let a=t;a<i;a++)this.buffer[a]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let a=0;a<this.valueSize;a++)this.buffer[i+a]=this.buffer[t+a]}_select(t,i,a,u,d){if(u>=.5)for(let p=0;p!==d;++p)t[i+p]=t[a+p]}_slerp(t,i,a,u){eo.slerpFlat(t,i,t,i,t,a,u)}_slerpAdditive(t,i,a,u,d){const p=this._workIndex*d;eo.multiplyQuaternionsFlat(t,p,t,i,t,a),eo.slerpFlat(t,i,t,i,t,p,u)}_lerp(t,i,a,u,d){const p=1-u;for(let v=0;v!==d;++v){const _=i+v;t[_]=t[_]*p+t[a+v]*u}}_lerpAdditive(t,i,a,u,d){for(let p=0;p!==d;++p){const v=i+p;t[v]=t[v]+t[a+p]*u}}}const Lm=new RegExp("[\\[\\]\\.:\\/]","g"),vp="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",rf=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),gm=/(WCOD+)?/.source.replace("WCOD",vp),pd=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Uf=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),vm=new RegExp("^"+rf+gm+pd+Uf+"$"),fi=["material","materials","bones"];class Or{constructor(t,i,a){this.path=i,this.parsedPath=a||Or.parseTrackName(i),this.node=Or.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,a){return t&&t.isAnimationObjectGroup?new Or.Composite(t,i,a):new Or(t,i,a)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Lm,"")}static parseTrackName(t){const i=vm.exec(t);if(!i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const a={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},u=a.nodeName&&a.nodeName.lastIndexOf(".");if(u!==void 0&&u!==-1){const d=a.nodeName.substring(u+1);fi.indexOf(d)!==-1&&(a.nodeName=a.nodeName.substring(0,u),a.objectName=d)}if(a.propertyName===null||a.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return a}static findNode(t,i){if(!i||i===""||i==="."||i===-1||i===t.name||i===t.uuid)return t;if(t.skeleton){const a=t.skeleton.getBoneByName(i);if(a!==void 0)return a}if(t.children){const a=function(d){for(let p=0;p<d.length;p++){const v=d[p];if(v.name===i||v.uuid===i)return v;const _=a(v.children);if(_)return _}return null},u=a(t.children);if(u)return u}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.node[this.propertyName]}_getValue_array(t,i){const a=this.resolvedProperty;for(let u=0,d=a.length;u!==d;++u)t[i++]=a[u]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const a=this.resolvedProperty;for(let u=0,d=a.length;u!==d;++u)a[u]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const a=this.resolvedProperty;for(let u=0,d=a.length;u!==d;++u)a[u]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const a=this.resolvedProperty;for(let u=0,d=a.length;u!==d;++u)a[u]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,a=i.objectName,u=i.propertyName;let d=i.propertyIndex;if(t||(t=Or.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(a){let y=i.objectIndex;switch(a){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let E=0;E<t.length;E++)if(t[E].name===y){y=E;break}break;default:if(t[a]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[a]}if(y!==void 0){if(t[y]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[y]}}const p=t[u];if(p===void 0){const y=i.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+y+"."+u+" but it wasn't found.",t)}let v=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?v=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(v=this.Versioning.MatrixWorldNeedsUpdate);let _=this.BindingType.Direct;if(d!==void 0){if(u==="morphTargetInfluences"){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);t.morphTargetDictionary[d]!==void 0&&(d=t.morphTargetDictionary[d])}_=this.BindingType.ArrayElement,this.resolvedProperty=p,this.propertyIndex=d}else p.fromArray!==void 0&&p.toArray!==void 0?(_=this.BindingType.HasFromToArray,this.resolvedProperty=p):Array.isArray(p)?(_=this.BindingType.EntireArray,this.resolvedProperty=p):this.propertyName=u;this.getValue=this.GetterByBindingType[_],this.setValue=this.SetterByBindingTypeAndVersioning[_][v]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Or.Composite=class{constructor(f,t,i){const a=i||Or.parseTrackName(t);this._targetGroup=f,this._bindings=f.subscribe_(t,a)}getValue(f,t){this.bind();const i=this._targetGroup.nCachedObjects_,a=this._bindings[i];a!==void 0&&a.getValue(f,t)}setValue(f,t){const i=this._bindings;for(let a=this._targetGroup.nCachedObjects_,u=i.length;a!==u;++a)i[a].setValue(f,t)}bind(){const f=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=f.length;t!==i;++t)f[t].bind()}unbind(){const f=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=f.length;t!==i;++t)f[t].unbind()}},Or.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Or.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Or.prototype.GetterByBindingType=[Or.prototype._getValue_direct,Or.prototype._getValue_array,Or.prototype._getValue_arrayElement,Or.prototype._getValue_toArray],Or.prototype.SetterByBindingTypeAndVersioning=[[Or.prototype._setValue_direct,Or.prototype._setValue_direct_setNeedsUpdate,Or.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Or.prototype._setValue_array,Or.prototype._setValue_array_setNeedsUpdate,Or.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Or.prototype._setValue_arrayElement,Or.prototype._setValue_arrayElement_setNeedsUpdate,Or.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Or.prototype._setValue_fromArray,Or.prototype._setValue_fromArray_setNeedsUpdate,Or.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class kf{constructor(){this.uuid=wo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let a=0,u=arguments.length;a!==u;++a)t[arguments[a].uuid]=a;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const t=this._objects,i=this._indicesByUUID,a=this._paths,u=this._parsedPaths,d=this._bindings,p=d.length;let v,_=t.length,y=this.nCachedObjects_;for(let E=0,A=arguments.length;E!==A;++E){const M=arguments[E],P=M.uuid;let I=i[P];if(I===void 0){I=_++,i[P]=I,t.push(M);for(let N=0,O=p;N!==O;++N)d[N].push(new Or(M,a[N],u[N]))}else if(I<y){v=t[I];const N=--y,O=t[N];i[O.uuid]=I,t[I]=O,i[P]=N,t[N]=M;for(let V=0,Y=p;V!==Y;++V){const at=d[V],st=at[N];let yt=at[I];at[I]=st,yt===void 0&&(yt=new Or(M,a[V],u[V])),at[N]=yt}}else t[I]!==v&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=y}remove(){const t=this._objects,i=this._indicesByUUID,a=this._bindings,u=a.length;let d=this.nCachedObjects_;for(let p=0,v=arguments.length;p!==v;++p){const _=arguments[p],y=_.uuid,E=i[y];if(E!==void 0&&E>=d){const A=d++,M=t[A];i[M.uuid]=E,t[E]=M,i[y]=A,t[A]=_;for(let P=0,I=u;P!==I;++P){const N=a[P],O=N[A],V=N[E];N[E]=O,N[A]=V}}}this.nCachedObjects_=d}uncache(){const t=this._objects,i=this._indicesByUUID,a=this._bindings,u=a.length;let d=this.nCachedObjects_,p=t.length;for(let v=0,_=arguments.length;v!==_;++v){const y=arguments[v].uuid,E=i[y];if(E!==void 0)if(delete i[y],E<d){const A=--d,M=t[A],P=--p,I=t[P];i[M.uuid]=E,t[E]=M,i[I.uuid]=A,t[A]=I,t.pop();for(let N=0,O=u;N!==O;++N){const V=a[N],Y=V[A],at=V[P];V[E]=Y,V[A]=at,V.pop()}}else{const A=--p,M=t[A];A>0&&(i[M.uuid]=E),t[E]=M,t.pop();for(let P=0,I=u;P!==I;++P){const N=a[P];N[E]=N[A],N.pop()}}}this.nCachedObjects_=d}subscribe_(t,i){const a=this._bindingsIndicesByPath;let u=a[t];const d=this._bindings;if(u!==void 0)return d[u];const p=this._paths,v=this._parsedPaths,_=this._objects,y=_.length,E=this.nCachedObjects_,A=new Array(y);u=d.length,a[t]=u,p.push(t),v.push(i),d.push(A);for(let M=E,P=_.length;M!==P;++M){const I=_[M];A[M]=new Or(I,t,i)}return A}unsubscribe_(t){const i=this._bindingsIndicesByPath,a=i[t];if(a!==void 0){const u=this._paths,d=this._parsedPaths,p=this._bindings,v=p.length-1,_=p[v];i[t[v]]=a,p[a]=_,p.pop(),d[a]=d[v],d.pop(),u[a]=u[v],u.pop()}}}kf.prototype.isAnimationObjectGroup=!0;class Gf{constructor(t,i,a=null,u=i.blendMode){this._mixer=t,this._clip=i,this._localRoot=a,this.blendMode=u;const d=i.tracks,p=d.length,v=new Array(p),_={endingStart:ia,endingEnd:ia};for(let y=0;y!==p;++y){const E=d[y].createInterpolant(null);v[y]=E,E.settings=_}this._interpolantSettings=_,this._interpolants=v,this._propertyBindings=new Array(p),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=vd,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,i){return this.loop=t,this.repetitions=i,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,i,a){if(t.fadeOut(i),this.fadeIn(i),a){const u=this._clip.duration,d=t._clip.duration,p=d/u,v=u/d;t.warp(1,p,i),this.warp(v,1,i)}return this}crossFadeTo(t,i,a){return t.crossFadeFrom(this,i,a)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,i,a){const u=this._mixer,d=u.time,p=this.timeScale;let v=this._timeScaleInterpolant;v===null&&(v=u._lendControlInterpolant(),this._timeScaleInterpolant=v);const _=v.parameterPositions,y=v.sampleValues;return _[0]=d,_[1]=d+a,y[0]=t/p,y[1]=i/p,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,i,a,u){if(!this.enabled)return void this._updateWeight(t);const d=this._startTime;if(d!==null){const _=(t-d)*a;if(_<0||a===0)return;this._startTime=null,i=a*_}i*=this._updateTimeScale(t);const p=this._updateTime(i),v=this._updateWeight(t);if(v>0){const _=this._interpolants,y=this._propertyBindings;switch(this.blendMode){case Pl:for(let E=0,A=_.length;E!==A;++E)_[E].evaluate(p),y[E].accumulateAdditive(v);break;case ou:default:for(let E=0,A=_.length;E!==A;++E)_[E].evaluate(p),y[E].accumulate(u,v)}}}_updateWeight(t){let i=0;if(this.enabled){i=this.weight;const a=this._weightInterpolant;if(a!==null){const u=a.evaluate(t)[0];i*=u,t>a.parameterPositions[1]&&(this.stopFading(),u===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(t){let i=0;if(!this.paused){i=this.timeScale;const a=this._timeScaleInterpolant;a!==null&&(i*=a.evaluate(t)[0],t>a.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i))}return this._effectiveTimeScale=i,i}_updateTime(t){const i=this._clip.duration,a=this.loop;let u=this.time+t,d=this._loopCount;const p=a===No;if(t===0)return d===-1?u:p&&(1&d)==1?i-u:u;if(a===Ci){d===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(u>=i)u=i;else{if(!(u<0)){this.time=u;break t}u=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=u,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(d===-1&&(t>=0?(d=0,this._setEndings(!0,this.repetitions===0,p)):this._setEndings(this.repetitions===0,!0,p)),u>=i||u<0){const v=Math.floor(u/i);u-=i*v,d+=Math.abs(v);const _=this.repetitions-d;if(_<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,u=t>0?i:0,this.time=u,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(_===1){const y=t<0;this._setEndings(y,!y,p)}else this._setEndings(!1,!1,p);this._loopCount=d,this.time=u,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:v})}}else this.time=u;if(p&&(1&d)==1)return i-u}return u}_setEndings(t,i,a){const u=this._interpolantSettings;a?(u.endingStart=oa,u.endingEnd=oa):(u.endingStart=t?this.zeroSlopeAtStart?oa:ia:ss,u.endingEnd=i?this.zeroSlopeAtEnd?oa:ia:ss)}_scheduleFading(t,i,a){const u=this._mixer,d=u.time;let p=this._weightInterpolant;p===null&&(p=u._lendControlInterpolant(),this._weightInterpolant=p);const v=p.parameterPositions,_=p.sampleValues;return v[0]=d,_[0]=i,v[1]=d+t,_[1]=a,this}}class Hf extends Ra{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,i){const a=t._localRoot||this._root,u=t._clip.tracks,d=u.length,p=t._propertyBindings,v=t._interpolants,_=a.uuid,y=this._bindingsByRootAndName;let E=y[_];E===void 0&&(E={},y[_]=E);for(let A=0;A!==d;++A){const M=u[A],P=M.name;let I=E[P];if(I!==void 0)p[A]=I;else{if(I=p[A],I!==void 0){I._cacheIndex===null&&(++I.referenceCount,this._addInactiveBinding(I,_,P));continue}const N=i&&i._propertyBindings[A].binding.parsedPath;I=new mm(Or.create(a,P,N),M.ValueTypeName,M.getValueSize()),++I.referenceCount,this._addInactiveBinding(I,_,P),p[A]=I}v[A].resultBuffer=I.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){const a=(t._localRoot||this._root).uuid,u=t._clip.uuid,d=this._actionsByClip[u];this._bindAction(t,d&&d.knownActions[0]),this._addInactiveAction(t,u,a)}const i=t._propertyBindings;for(let a=0,u=i.length;a!==u;++a){const d=i[a];d.useCount++==0&&(this._lendBinding(d),d.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const i=t._propertyBindings;for(let a=0,u=i.length;a!==u;++a){const d=i[a];--d.useCount==0&&(d.restoreOriginalState(),this._takeBackBinding(d))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const i=t._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(t,i,a){const u=this._actions,d=this._actionsByClip;let p=d[i];if(p===void 0)p={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,d[i]=p;else{const v=p.knownActions;t._byClipCacheIndex=v.length,v.push(t)}t._cacheIndex=u.length,u.push(t),p.actionByRoot[a]=t}_removeInactiveAction(t){const i=this._actions,a=i[i.length-1],u=t._cacheIndex;a._cacheIndex=u,i[u]=a,i.pop(),t._cacheIndex=null;const d=t._clip.uuid,p=this._actionsByClip,v=p[d],_=v.knownActions,y=_[_.length-1],E=t._byClipCacheIndex;y._byClipCacheIndex=E,_[E]=y,_.pop(),t._byClipCacheIndex=null,delete v.actionByRoot[(t._localRoot||this._root).uuid],_.length===0&&delete p[d],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const i=t._propertyBindings;for(let a=0,u=i.length;a!==u;++a){const d=i[a];--d.referenceCount==0&&this._removeInactiveBinding(d)}}_lendAction(t){const i=this._actions,a=t._cacheIndex,u=this._nActiveActions++,d=i[u];t._cacheIndex=u,i[u]=t,d._cacheIndex=a,i[a]=d}_takeBackAction(t){const i=this._actions,a=t._cacheIndex,u=--this._nActiveActions,d=i[u];t._cacheIndex=u,i[u]=t,d._cacheIndex=a,i[a]=d}_addInactiveBinding(t,i,a){const u=this._bindingsByRootAndName,d=this._bindings;let p=u[i];p===void 0&&(p={},u[i]=p),p[a]=t,t._cacheIndex=d.length,d.push(t)}_removeInactiveBinding(t){const i=this._bindings,a=t.binding,u=a.rootNode.uuid,d=a.path,p=this._bindingsByRootAndName,v=p[u],_=i[i.length-1],y=t._cacheIndex;_._cacheIndex=y,i[y]=_,i.pop(),delete v[d],Object.keys(v).length===0&&delete p[u]}_lendBinding(t){const i=this._bindings,a=t._cacheIndex,u=this._nActiveBindings++,d=i[u];t._cacheIndex=u,i[u]=t,d._cacheIndex=a,i[a]=d}_takeBackBinding(t){const i=this._bindings,a=t._cacheIndex,u=--this._nActiveBindings,d=i[u];t._cacheIndex=u,i[u]=t,d._cacheIndex=a,i[a]=d}_lendControlInterpolant(){const t=this._controlInterpolants,i=this._nActiveControlInterpolants++;let a=t[i];return a===void 0&&(a=new ap(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),a.__cacheIndex=i,t[i]=a),a}_takeBackControlInterpolant(t){const i=this._controlInterpolants,a=t.__cacheIndex,u=--this._nActiveControlInterpolants,d=i[u];t.__cacheIndex=u,i[u]=t,d.__cacheIndex=a,i[a]=d}clipAction(t,i,a){const u=i||this._root,d=u.uuid;let p=typeof t=="string"?lp.findByName(u,t):t;const v=p!==null?p.uuid:t,_=this._actionsByClip[v];let y=null;if(a===void 0&&(a=p!==null?p.blendMode:ou),_!==void 0){const A=_.actionByRoot[d];if(A!==void 0&&A.blendMode===a)return A;y=_.knownActions[0],p===null&&(p=y._clip)}if(p===null)return null;const E=new Gf(this,p,i,a);return this._bindAction(E,y),this._addInactiveAction(E,v,d),E}existingAction(t,i){const a=i||this._root,u=a.uuid,d=typeof t=="string"?lp.findByName(a,t):t,p=d?d.uuid:t,v=this._actionsByClip[p];return v!==void 0&&v.actionByRoot[u]||null}stopAllAction(){const t=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)t[i].stop();return this}update(t){t*=this.timeScale;const i=this._actions,a=this._nActiveActions,u=this.time+=t,d=Math.sign(t),p=this._accuIndex^=1;for(let y=0;y!==a;++y)i[y]._update(u,t,d,p);const v=this._bindings,_=this._nActiveBindings;for(let y=0;y!==_;++y)v[y].apply(p);return this}setTime(t){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const i=this._actions,a=t.uuid,u=this._actionsByClip,d=u[a];if(d!==void 0){const p=d.knownActions;for(let v=0,_=p.length;v!==_;++v){const y=p[v];this._deactivateAction(y);const E=y._cacheIndex,A=i[i.length-1];y._cacheIndex=null,y._byClipCacheIndex=null,A._cacheIndex=E,i[E]=A,i.pop(),this._removeInactiveBindingsForAction(y)}delete u[a]}}uncacheRoot(t){const i=t.uuid,a=this._actionsByClip;for(const d in a){const p=a[d].actionByRoot[i];p!==void 0&&(this._deactivateAction(p),this._removeInactiveAction(p))}const u=this._bindingsByRootAndName[i];if(u!==void 0)for(const d in u){const p=u[d];p.restoreOriginalState(),this._removeInactiveBinding(p)}}uncacheAction(t,i){const a=this.existingAction(t,i);a!==null&&(this._deactivateAction(a),this._removeInactiveAction(a))}}Hf.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class mh{constructor(t){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new mh(this.value.clone===void 0?this.value:this.value.clone())}}class cc extends Cu{constructor(t,i,a=1){super(t,i),this.meshPerAttribute=a}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const i=super.clone(t);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(t){const i=super.toJSON(t);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}cc.prototype.isInstancedInterleavedBuffer=!0;class of{constructor(t,i,a,u,d){this.buffer=t,this.type=i,this.itemSize=a,this.elementSize=u,this.count=d,this.version=0}set needsUpdate(t){t===!0&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,i){return this.type=t,this.elementSize=i,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}of.prototype.isGLBufferAttribute=!0;class _m{constructor(t,i,a=0,u=1/0){this.ray=new cs(t,i),this.near=a,this.far=u,this.camera=null,this.layers=new fu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,i){this.ray.set(t,i)}setFromCamera(t,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(t,i=!1,a=[]){return zf(t,this,a,i),a.sort(ym),a}intersectObjects(t,i=!1,a=[]){for(let u=0,d=t.length;u<d;u++)zf(t[u],this,a,i);return a.sort(ym),a}}function ym(f,t){return f.distance-t.distance}function zf(f,t,i,a){if(f.layers.test(t.layers)&&f.raycast(t,i),a===!0){const u=f.children;for(let d=0,p=u.length;d<p;d++)zf(u[d],t,i,!0)}}class jf{constructor(t=1,i=0,a=0){return this.radius=t,this.phi=i,this.theta=a,this}set(t,i,a){return this.radius=t,this.phi=i,this.theta=a,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,i,a){return this.radius=Math.sqrt(t*t+i*i+a*a),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,a),this.phi=Math.acos(Hi(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class sf{constructor(t=1,i=0,a=0){return this.radius=t,this.theta=i,this.y=a,this}set(t,i,a){return this.radius=t,this.theta=i,this.y=a,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,i,a){return this.radius=Math.sqrt(t*t+a*a),this.theta=Math.atan2(t,a),this.y=i,this}clone(){return new this.constructor().copy(this)}}const xm=new Ge;class fd{constructor(t=new Ge(1/0,1/0),i=new Ge(-1/0,-1/0)){this.min=t,this.max=i}set(t,i){return this.min.copy(t),this.max.copy(i),this}setFromPoints(t){this.makeEmpty();for(let i=0,a=t.length;i<a;i++)this.expandByPoint(t[i]);return this}setFromCenterAndSize(t,i){const a=xm.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(a),this.max.copy(t).add(a),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,i){return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,i){return i.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return xm.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}fd.prototype.isBox2=!0;const bm=new ot,_p=new ot;class Vf{constructor(t=new ot,i=new ot){this.start=t,this.end=i}set(t,i){return this.start.copy(t),this.end.copy(i),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,i){return this.delta(i).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,i){bm.subVectors(t,this.start),_p.subVectors(this.end,this.start);const a=_p.dot(_p);let u=_p.dot(bm)/a;return i&&(u=Hi(u,0,1)),u}closestPointToPoint(t,i,a){const u=this.closestPointToPointParameter(t,i);return this.delta(a).multiplyScalar(u).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class wm extends mr{constructor(t){super(),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}wm.prototype.isImmediateRenderObject=!0;const ki=new ot;class Om extends mr{constructor(t,i){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;const a=new Hn,u=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let p=0,v=1,_=32;p<_;p++,v++){const y=p/_*Math.PI*2,E=v/_*Math.PI*2;u.push(Math.cos(y),Math.sin(y),1,Math.cos(E),Math.sin(E),1)}a.setAttribute("position",new yn(u,3));const d=new oo({fog:!1,toneMapped:!1});this.cone=new ts(a,d),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,i=t*Math.tan(this.light.angle);this.cone.scale.set(i,i,t),ki.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ki),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const o=new ot,n=new wn,e=new wn;class r extends ts{constructor(t){const i=function _(y){const E=[];y&&y.isBone&&E.push(y);for(let A=0;A<y.children.length;A++)E.push.apply(E,_(y.children[A]));return E}(t),a=new Hn,u=[],d=[],p=new pn(0,0,1),v=new pn(0,1,0);for(let _=0;_<i.length;_++){const y=i[_];y.parent&&y.parent.isBone&&(u.push(0,0,0),u.push(0,0,0),d.push(p.r,p.g,p.b),d.push(v.r,v.g,v.b))}a.setAttribute("position",new yn(u,3)),a.setAttribute("color",new yn(d,3)),super(a,new oo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=i,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const i=this.bones,a=this.geometry,u=a.getAttribute("position");e.copy(this.root.matrixWorld).invert();for(let d=0,p=0;d<i.length;d++){const v=i[d];v.parent&&v.parent.isBone&&(n.multiplyMatrices(e,v.matrixWorld),o.setFromMatrixPosition(n),u.setXYZ(p,o.x,o.y,o.z),n.multiplyMatrices(e,v.parent.matrixWorld),o.setFromMatrixPosition(n),u.setXYZ(p+1,o.x,o.y,o.z),p+=2)}a.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}class s extends Ni{constructor(t,i,a){super(new ac(i,4,2),new Oi({wireframe:!0,fog:!1,toneMapped:!1})),this.light=t,this.light.updateMatrixWorld(),this.color=a,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const l=new ot,h=new pn,m=new pn;class x extends mr{constructor(t,i,a){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=a;const u=new oc(i);u.rotateY(.5*Math.PI),this.material=new Oi({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const d=u.getAttribute("position"),p=new Float32Array(3*d.count);u.setAttribute("color",new yr(p,3)),this.add(new Ni(u,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=t.geometry.getAttribute("color");h.copy(this.light.color),m.copy(this.light.groundColor);for(let a=0,u=i.count;a<u;a++){const d=a<u/2?h:m;i.setXYZ(a,d.r,d.g,d.b)}i.needsUpdate=!0}t.lookAt(l.setFromMatrixPosition(this.light.matrixWorld).negate())}}class b extends ts{constructor(t=10,i=10,a=4473924,u=8947848){a=new pn(a),u=new pn(u);const d=i/2,p=t/i,v=t/2,_=[],y=[];for(let A=0,M=0,P=-v;A<=i;A++,P+=p){_.push(-v,0,P,v,0,P),_.push(P,0,-v,P,0,v);const I=A===d?a:u;I.toArray(y,M),M+=3,I.toArray(y,M),M+=3,I.toArray(y,M),M+=3,I.toArray(y,M),M+=3}const E=new Hn;E.setAttribute("position",new yn(_,3)),E.setAttribute("color",new yn(y,3)),super(E,new oo({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class w extends ts{constructor(t=10,i=16,a=8,u=64,d=4473924,p=8947848){d=new pn(d),p=new pn(p);const v=[],_=[];for(let E=0;E<=i;E++){const A=E/i*(2*Math.PI),M=Math.sin(A)*t,P=Math.cos(A)*t;v.push(0,0,0),v.push(M,0,P);const I=1&E?d:p;_.push(I.r,I.g,I.b),_.push(I.r,I.g,I.b)}for(let E=0;E<=a;E++){const A=1&E?d:p,M=t-t/a*E;for(let P=0;P<u;P++){let I=P/u*(2*Math.PI),N=Math.sin(I)*M,O=Math.cos(I)*M;v.push(N,0,O),_.push(A.r,A.g,A.b),I=(P+1)/u*(2*Math.PI),N=Math.sin(I)*M,O=Math.cos(I)*M,v.push(N,0,O),_.push(A.r,A.g,A.b)}}const y=new Hn;y.setAttribute("position",new yn(v,3)),y.setAttribute("color",new yn(_,3)),super(y,new oo({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const R=new ot,U=new ot,B=new ot;class j extends mr{constructor(t,i,a){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,i===void 0&&(i=1);let u=new Hn;u.setAttribute("position",new yn([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const d=new oo({fog:!1,toneMapped:!1});this.lightPlane=new Va(u,d),this.add(this.lightPlane),u=new Hn,u.setAttribute("position",new yn([0,0,0,0,0,1],3)),this.targetLine=new Va(u,d),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){R.setFromMatrixPosition(this.light.matrixWorld),U.setFromMatrixPosition(this.light.target.matrixWorld),B.subVectors(U,R),this.lightPlane.lookAt(U),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(U),this.targetLine.scale.z=B.length()}}const K=new ot,ut=new jl;class gt extends ts{constructor(t){const i=new Hn,a=new oo({color:16777215,vertexColors:!0,toneMapped:!1}),u=[],d=[],p={},v=new pn(16755200),_=new pn(16711680),y=new pn(43775),E=new pn(16777215),A=new pn(3355443);function M(I,N,O){P(I,O),P(N,O)}function P(I,N){u.push(0,0,0),d.push(N.r,N.g,N.b),p[I]===void 0&&(p[I]=[]),p[I].push(u.length/3-1)}M("n1","n2",v),M("n2","n4",v),M("n4","n3",v),M("n3","n1",v),M("f1","f2",v),M("f2","f4",v),M("f4","f3",v),M("f3","f1",v),M("n1","f1",v),M("n2","f2",v),M("n3","f3",v),M("n4","f4",v),M("p","n1",_),M("p","n2",_),M("p","n3",_),M("p","n4",_),M("u1","u2",y),M("u2","u3",y),M("u3","u1",y),M("c","t",E),M("p","c",A),M("cn1","cn2",A),M("cn3","cn4",A),M("cf1","cf2",A),M("cf3","cf4",A),i.setAttribute("position",new yn(u,3)),i.setAttribute("color",new yn(d,3)),super(i,a),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=p,this.update()}update(){const t=this.geometry,i=this.pointMap;ut.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Rt("c",i,t,ut,0,0,-1),Rt("t",i,t,ut,0,0,1),Rt("n1",i,t,ut,-1,-1,-1),Rt("n2",i,t,ut,1,-1,-1),Rt("n3",i,t,ut,-1,1,-1),Rt("n4",i,t,ut,1,1,-1),Rt("f1",i,t,ut,-1,-1,1),Rt("f2",i,t,ut,1,-1,1),Rt("f3",i,t,ut,-1,1,1),Rt("f4",i,t,ut,1,1,1),Rt("u1",i,t,ut,.7,1.1,-1),Rt("u2",i,t,ut,-.7,1.1,-1),Rt("u3",i,t,ut,0,2,-1),Rt("cf1",i,t,ut,-1,0,1),Rt("cf2",i,t,ut,1,0,1),Rt("cf3",i,t,ut,0,-1,1),Rt("cf4",i,t,ut,0,1,1),Rt("cn1",i,t,ut,-1,0,-1),Rt("cn2",i,t,ut,1,0,-1),Rt("cn3",i,t,ut,0,-1,-1),Rt("cn4",i,t,ut,0,1,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Rt(f,t,i,a,u,d,p){K.set(u,d,p).unproject(a);const v=t[f];if(v!==void 0){const _=i.getAttribute("position");for(let y=0,E=v.length;y<E;y++)_.setXYZ(v[y],K.x,K.y,K.z)}}const Le=new So;class en extends ts{constructor(t,i=16776960){const a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),u=new Float32Array(24),d=new Hn;d.setIndex(new yr(a,1)),d.setAttribute("position",new yr(u,3)),super(d,new oo({color:i,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(t!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Le.setFromObject(this.object),Le.isEmpty())return;const i=Le.min,a=Le.max,u=this.geometry.attributes.position,d=u.array;d[0]=a.x,d[1]=a.y,d[2]=a.z,d[3]=i.x,d[4]=a.y,d[5]=a.z,d[6]=i.x,d[7]=i.y,d[8]=a.z,d[9]=a.x,d[10]=i.y,d[11]=a.z,d[12]=a.x,d[13]=a.y,d[14]=i.z,d[15]=i.x,d[16]=a.y,d[17]=i.z,d[18]=i.x,d[19]=i.y,d[20]=i.z,d[21]=a.x,d[22]=i.y,d[23]=i.z,u.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t){return ts.prototype.copy.call(this,t),this.object=t.object,this}}class At extends ts{constructor(t,i=16776960){const a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),u=new Hn;u.setIndex(new yr(a,1)),u.setAttribute("position",new yn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(u,new oo({color:i,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}}class oe extends Va{constructor(t,i=1,a=16776960){const u=a,d=new Hn;d.setAttribute("position",new yn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),d.computeBoundingSphere(),super(d,new oo({color:u,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=i;const p=new Hn;p.setAttribute("position",new yn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),p.computeBoundingSphere(),this.add(new Ni(p,new Oi({color:u,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){let i=-this.plane.constant;Math.abs(i)<1e-8&&(i=1e-8),this.scale.set(.5*this.size,.5*this.size,i),this.children[0].material.side=i<0?L:Gt,this.lookAt(this.plane.normal),super.updateMatrixWorld(t)}}const qt=new ot;let ne,Je;class Pe extends mr{constructor(t=new ot(0,0,1),i=new ot(0,0,0),a=1,u=16776960,d=.2*a,p=.2*d){super(),this.type="ArrowHelper",ne===void 0&&(ne=new Hn,ne.setAttribute("position",new yn([0,0,0,0,1,0],3)),Je=new Oe(0,.5,1,5,1),Je.translate(0,-.5,0)),this.position.copy(i),this.line=new Va(ne,new oo({color:u,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ni(Je,new Oi({color:u,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(a,d,p)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{qt.set(t.z,0,-t.x).normalize();const i=Math.acos(t.y);this.quaternion.setFromAxisAngle(qt,i)}}setLength(t,i=.2*t,a=.2*i){this.line.scale.set(1,Math.max(1e-4,t-i),1),this.line.updateMatrix(),this.cone.scale.set(a,i,a),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}}class $t extends ts{constructor(t=1){const i=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],a=new Hn;a.setAttribute("position",new yn(i,3)),a.setAttribute("color",new yn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(a,new oo({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,i,a){const u=new pn,d=this.geometry.attributes.color.array;return u.set(t),u.toArray(d,0),u.toArray(d,3),u.set(i),u.toArray(d,6),u.toArray(d,9),u.set(a),u.toArray(d,12),u.toArray(d,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const Ee=new Float32Array(1),hn=new Int32Array(Ee.buffer);class Ve{static toHalfFloat(t){Ee[0]=t;const i=hn[0];let a=i>>16&32768,u=i>>12&2047;const d=i>>23&255;return d<103?a:d>142?(a|=31744,a|=(d==255?0:1)&&8388607&i,a):d<113?(u|=2048,a|=(u>>114-d)+(u>>113-d&1),a):(a|=d-112<<10|u>>1,a+=1&u,a)}}const He=Math.pow(2,8),cn=[.125,.215,.35,.446,.526,.582],Be=5+cn.length,me={[bo]:0,[di]:1,[he]:2,[fe]:3,[Gn]:4,[pr]:5,[Bt]:6},sn=new Oi({side:L,depthWrite:!1,depthTest:!1}),Bn=new Ni(new Xs,sn),tr=new mp,{_lodPlanes:br,_sizeLods:nr,_sigmas:gr}=Yn(),Qr=new pn;let qr=null;const Zr=(1+Math.sqrt(5))/2,Vi=1/Zr,Jn=[new ot(1,1,1),new ot(-1,1,1),new ot(1,1,-1),new ot(-1,1,-1),new ot(0,Zr,Vi),new ot(0,Zr,-Vi),new ot(Vi,0,Zr),new ot(-Vi,0,Zr),new ot(Zr,Vi,0),new ot(-Zr,Vi,0)];function ti(f){const t=Math.max(f.r,f.g,f.b),i=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);return f.multiplyScalar(Math.pow(2,-i)),(i+128)/255}class Wr{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function(i){const a=new Float32Array(i),u=new ot(0,1,0);return new ad({name:"SphericalGaussianBlur",defines:{n:i},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:a},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:u},inputEncoding:{value:me[bo]},outputEncoding:{value:me[bo]}},vertexShader:af(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			${uf()}

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:k,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(t,i=0,a=.1,u=100){qr=this._renderer.getRenderTarget();const d=this._allocateTargets();return this._sceneToCubeUV(t,a,u,d),i>0&&this._blur(d,0,0,i),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(t){return this._fromTexture(t)}fromCubemap(t){return this._fromTexture(t)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=yp(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=dc(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let t=0;t<br.length;t++)br[t].dispose()}_cleanup(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(qr),t.scissorTest=!1,Ta(t,0,0,t.width,t.height)}_fromTexture(t){qr=this._renderer.getRenderTarget();const i=this._allocateTargets(t);return this._textureToCubeUV(t,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(t){const i={magFilter:Kt,minFilter:Kt,generateMipmaps:!1,type:Oo,format:on,encoding:ir(t)?t.encoding:he,depthBuffer:!1},a=Wi(i);return a.depthBuffer=!t,this._pingPongRenderTarget=Wi(i),a}_compileMaterial(t){const i=new Ni(br[0],t);this._renderer.compile(i,tr)}_sceneToCubeUV(t,i,a,u){const d=new Zi(90,1,i,a),p=[1,-1,1,1,1,1],v=[1,1,1,-1,-1,-1],_=this._renderer,y=_.autoClear,E=_.outputEncoding,A=_.toneMapping;_.getClearColor(Qr),_.toneMapping=Lr,_.outputEncoding=bo,_.autoClear=!1;let M=!1;const P=t.background;if(P){if(P.isColor){sn.color.copy(P).convertSRGBToLinear(),t.background=null;const I=ti(sn.color);sn.opacity=I,M=!0}}else{sn.color.copy(Qr).convertSRGBToLinear();const I=ti(sn.color);sn.opacity=I,M=!0}for(let I=0;I<6;I++){const N=I%3;N==0?(d.up.set(0,p[I],0),d.lookAt(v[I],0,0)):N==1?(d.up.set(0,0,p[I]),d.lookAt(0,v[I],0)):(d.up.set(0,p[I],0),d.lookAt(0,0,v[I])),Ta(u,N*He,I>2?He:0,He,He),_.setRenderTarget(u),M&&_.render(Bn,d),_.render(t,d)}_.toneMapping=A,_.outputEncoding=E,_.autoClear=y}_textureToCubeUV(t,i){const a=this._renderer;t.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=yp()):this._equirectShader==null&&(this._equirectShader=dc());const u=t.isCubeTexture?this._cubemapShader:this._equirectShader,d=new Ni(br[0],u),p=u.uniforms;p.envMap.value=t,t.isCubeTexture||p.texelSize.value.set(1/t.image.width,1/t.image.height),p.inputEncoding.value=me[t.encoding],p.outputEncoding.value=me[i.texture.encoding],Ta(i,0,0,3*He,2*He),a.setRenderTarget(i),a.render(d,tr)}_applyPMREM(t){const i=this._renderer,a=i.autoClear;i.autoClear=!1;for(let u=1;u<Be;u++){const d=Math.sqrt(gr[u]*gr[u]-gr[u-1]*gr[u-1]),p=Jn[(u-1)%Jn.length];this._blur(t,u-1,u,d,p)}i.autoClear=a}_blur(t,i,a,u,d){const p=this._pingPongRenderTarget;this._halfBlur(t,p,i,a,u,"latitudinal",d),this._halfBlur(p,t,a,a,u,"longitudinal",d)}_halfBlur(t,i,a,u,d,p,v){const _=this._renderer,y=this._blurMaterial;p!=="latitudinal"&&p!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const E=new Ni(br[u],y),A=y.uniforms,M=nr[a]-1,P=isFinite(d)?Math.PI/(2*M):2*Math.PI/39,I=d/P,N=isFinite(d)?1+Math.floor(3*I):20;N>20&&console.warn(`sigmaRadians, ${d}, is too large and will clip, as it requested ${N} samples when the maximum is set to 20`);const O=[];let V=0;for(let at=0;at<20;++at){const st=at/I,yt=Math.exp(-st*st/2);O.push(yt),at==0?V+=yt:at<N&&(V+=2*yt)}for(let at=0;at<O.length;at++)O[at]=O[at]/V;A.envMap.value=t.texture,A.samples.value=N,A.weights.value=O,A.latitudinal.value=p==="latitudinal",v&&(A.poleAxis.value=v),A.dTheta.value=P,A.mipInt.value=8-a,A.inputEncoding.value=me[t.texture.encoding],A.outputEncoding.value=me[t.texture.encoding];const Y=nr[u];Ta(i,3*Math.max(0,He-2*Y),(u===0?0:2*He)+2*Y*(u>4?u-8+4:0),3*Y,2*Y),_.setRenderTarget(i),_.render(E,tr)}}function ir(f){return f!==void 0&&f.type===Oo&&(f.encoding===bo||f.encoding===di||f.encoding===Bt)}function Yn(){const f=[],t=[],i=[];let a=8;for(let u=0;u<Be;u++){const d=Math.pow(2,a);t.push(d);let p=1/d;u>4?p=cn[u-8+4-1]:u==0&&(p=0),i.push(p);const v=1/(d-1),_=-v/2,y=1+v/2,E=[_,_,y,_,y,y,_,_,y,y,_,y],A=6,M=6,P=3,I=2,N=1,O=new Float32Array(P*M*A),V=new Float32Array(I*M*A),Y=new Float32Array(N*M*A);for(let st=0;st<A;st++){const yt=st%3*2/3-1,bt=st>2?0:-1,_t=[yt,bt,0,yt+2/3,bt,0,yt+2/3,bt+1,0,yt,bt,0,yt+2/3,bt+1,0,yt,bt+1,0];O.set(_t,P*M*st),V.set(E,I*M*st);const Et=[st,st,st,st,st,st];Y.set(Et,N*M*st)}const at=new Hn;at.setAttribute("position",new yr(O,P)),at.setAttribute("uv",new yr(V,I)),at.setAttribute("faceIndex",new yr(Y,N)),f.push(at),a>4&&a--}return{_lodPlanes:f,_sizeLods:t,_sigmas:i}}function Wi(f){const t=new To(3*He,3*He,f);return t.texture.mapping=Ct,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Ta(f,t,i,a,u){f.viewport.set(t,i,a,u),f.scissor.set(t,i,a,u)}function dc(){const f=new Ge(1,1);return new ad({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:f},inputEncoding:{value:me[bo]},outputEncoding:{value:me[bo]}},vertexShader:af(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${uf()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:k,depthTest:!1,depthWrite:!1})}function yp(){return new ad({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:me[bo]},outputEncoding:{value:me[bo]}},vertexShader:af(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${uf()}

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:k,depthTest:!1,depthWrite:!1})}function af(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function uf(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}const Tm=0,Jm=1,$m=0,Km=1,Qm=2;function tg(f){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),f}function eg(f=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),f.isMultiMaterial=!0,f.materials=f,f.clone=function(){return f.slice()},f}function ng(f,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new H(f,t)}function rg(f){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new nh(f)}function ig(f,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new H(f,t)}function og(f){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new cl(f)}function sg(f){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new cl(f)}function ag(f){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new cl(f)}function ug(f,t,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new ot(f,t,i)}function lg(f,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new yr(f,t).setUsage(au)}function hg(f,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new On(f,t)}function cg(f,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Ac(f,t)}function dg(f,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Eo(f,t)}function pg(f,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ca(f,t)}function fg(f,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Hl(f,t)}function mg(f,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Td(f,t)}function gg(f,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Bo(f,t)}function vg(f,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new yn(f,t)}function _g(f,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Ls(f,t)}function yg(f){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new $t(f)}function xg(f,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new en(f,t)}function bg(f,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ts(new Fn(f.geometry),new oo({color:t!==void 0?t:16777215}))}function wg(f,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ts(new bf(f.geometry),new oo({color:t!==void 0?t:16777215}))}function Tg(f){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Za(f)}function Sg(f){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Pf(f)}function Eg(f,t,i){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Ds(f,i)}function Mg(){console.error("THREE.CanvasRenderer has been removed")}function Ag(){console.error("THREE.JSONLoader has been removed.")}An.create=function(f,t){return console.log("THREE.Curve.create() has been deprecated"),f.prototype=Object.create(An.prototype),f.prototype.constructor=f,f.prototype.getPoint=t,f},hp.prototype.fromPoints=function(f){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(f)},b.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},r.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},jo.prototype.extractUrlBase=function(f){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Kp.extractUrlBase(f)},jo.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},fd.prototype.center=function(f){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(f)},fd.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},fd.prototype.isIntersectionBox=function(f){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(f)},fd.prototype.size=function(f){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(f)},So.prototype.center=function(f){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(f)},So.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},So.prototype.isIntersectionBox=function(f){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(f)},So.prototype.isIntersectionSphere=function(f){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(f)},So.prototype.size=function(f){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(f)},Jo.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ka.prototype.setFromMatrix=function(f){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(f)},Vf.prototype.center=function(f){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(f)},Ii.prototype.flattenToArrayOffset=function(f,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(f,t)},Ii.prototype.multiplyVector3=function(f){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),f.applyMatrix3(this)},Ii.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Ii.prototype.applyToBufferAttribute=function(f){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),f.applyMatrix3(this)},Ii.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Ii.prototype.getInverse=function(f){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(f).invert()},wn.prototype.extractPosition=function(f){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(f)},wn.prototype.flattenToArrayOffset=function(f,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(f,t)},wn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new ot().setFromMatrixColumn(this,3)},wn.prototype.setRotationFromQuaternion=function(f){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(f)},wn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},wn.prototype.multiplyVector3=function(f){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),f.applyMatrix4(this)},wn.prototype.multiplyVector4=function(f){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),f.applyMatrix4(this)},wn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},wn.prototype.rotateAxis=function(f){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),f.transformDirection(this)},wn.prototype.crossVector=function(f){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),f.applyMatrix4(this)},wn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},wn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},wn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},wn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},wn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},wn.prototype.applyToBufferAttribute=function(f){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),f.applyMatrix4(this)},wn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},wn.prototype.makeFrustum=function(f,t,i,a,u,d){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(f,t,a,i,u,d)},wn.prototype.getInverse=function(f){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(f).invert()},Go.prototype.isIntersectionLine=function(f){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(f)},eo.prototype.multiplyVector3=function(f){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),f.applyQuaternion(this)},eo.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},cs.prototype.isIntersectionBox=function(f){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(f)},cs.prototype.isIntersectionPlane=function(f){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(f)},cs.prototype.isIntersectionSphere=function(f){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(f)},Mi.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Mi.prototype.barycoordFromPoint=function(f,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(f,t)},Mi.prototype.midpoint=function(f){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(f)},Mi.prototypenormal=function(f){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(f)},Mi.prototype.plane=function(f){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(f)},Mi.barycoordFromPoint=function(f,t,i,a,u){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Mi.getBarycoord(f,t,i,a,u)},Mi.normal=function(f,t,i,a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Mi.getNormal(f,t,i,a)},gl.prototype.extractAllPoints=function(f){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(f)},gl.prototype.extrude=function(f){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ya(this,f)},gl.prototype.makeGeometry=function(f){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new sc(this,f)},Ge.prototype.fromAttribute=function(f,t,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(f,t,i)},Ge.prototype.distanceToManhattan=function(f){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(f)},Ge.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ot.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},ot.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},ot.prototype.getPositionFromMatrix=function(f){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(f)},ot.prototype.getScaleFromMatrix=function(f){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(f)},ot.prototype.getColumnFromMatrix=function(f,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,f)},ot.prototype.applyProjection=function(f){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(f)},ot.prototype.fromAttribute=function(f,t,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(f,t,i)},ot.prototype.distanceToManhattan=function(f){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(f)},ot.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Rr.prototype.fromAttribute=function(f,t,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(f,t,i)},Rr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},mr.prototype.getChildByName=function(f){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(f)},mr.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},mr.prototype.translate=function(f,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,f)},mr.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},mr.prototype.applyMatrix=function(f){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(f)},Object.defineProperties(mr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(f){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=f}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Ni.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Ni.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Hu},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),ll.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Zi.prototype.setLens=function(f,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(f)},Object.defineProperties(xa.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(f){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=f}},shadowCameraLeft:{set:function(f){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=f}},shadowCameraRight:{set:function(f){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=f}},shadowCameraTop:{set:function(f){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=f}},shadowCameraBottom:{set:function(f){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=f}},shadowCameraNear:{set:function(f){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=f}},shadowCameraFar:{set:function(f){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=f}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(f){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=f}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(f){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=f}},shadowMapHeight:{set:function(f){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=f}}}),Object.defineProperties(yr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===au},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(au)}}}),yr.prototype.setDynamic=function(f){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(f===!0?au:Ri),this},yr.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},yr.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Hn.prototype.addIndex=function(f){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(f)},Hn.prototype.addAttribute=function(f,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?f==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(f,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(f,new yr(arguments[1],arguments[2])))},Hn.prototype.addDrawCall=function(f,t,i){i!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(f,t)},Hn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Hn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Hn.prototype.removeAttribute=function(f){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(f)},Hn.prototype.applyMatrix=function(f){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(f)},Object.defineProperties(Hn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Cu.prototype.setDynamic=function(f){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(f===!0?au:Ri),this},Cu.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ya.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Ya.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Ya.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Kl.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},mh.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(zi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new pn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(f){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=f===z}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(f){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=f}}}),Object.defineProperties(fo.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(f){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=f}}}),Yr.prototype.clearTarget=function(f,t,i,a){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(f),this.clear(t,i,a)},Yr.prototype.animate=function(f){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(f)},Yr.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Yr.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Yr.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Yr.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Yr.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Yr.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Yr.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Yr.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Yr.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Yr.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Yr.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Yr.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Yr.prototype.enableScissorTest=function(f){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(f)},Yr.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Yr.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Yr.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Yr.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Yr.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Yr.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Yr.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Yr.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Yr.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Yr.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Yr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(f){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=f}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(f){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=f}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(f){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=f===!0?di:bo}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(hr.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(To.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(f){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=f}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(f){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=f}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(f){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=f}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(f){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=f}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(f){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=f}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(f){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=f}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(f){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=f}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(f){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=f}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(f){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=f}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(f){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=f}}}),nf.prototype.load=function(f){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return new dh().load(f,function(i){t.setBuffer(i)}),this},fm.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ic.prototype.updateCubeMap=function(f,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(f,t)},Ic.prototype.clear=function(f,t,i,a){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(f,t,i,a)},as.crossOrigin=void 0,as.loadTexture=function(f,t,i,a){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const u=new nm;u.setCrossOrigin(this.crossOrigin);const d=u.load(f,i,void 0,a);return t&&(d.mapping=t),d},as.loadTextureCube=function(f,t,i,a){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const u=new em;u.setCrossOrigin(this.crossOrigin);const d=u.load(f,i,void 0,a);return t&&(d.mapping=t),d},as.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},as.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Pg={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Cg(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:J}})),typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=J)},function(Ie,C,T){var J=T(24),G=T(25);function lt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}C.parse=k,C.resolve=function(X,tt){return k(X,!1,!0).resolve(tt)},C.resolveObject=function(X,tt){return X?k(X,!1,!0).resolveObject(tt):tt},C.format=function(X){return G.isString(X)&&(X=k(X)),X instanceof lt?X.format():lt.prototype.format.call(X)},C.Url=lt;var Z=/^([a-z0-9.+-]+:)/i,W=/:[0-9]*$/,mt=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,et=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),nt=["'"].concat(et),ct=["%","/","?",";","#"].concat(nt),Nt=["/","?","#"],Xt=/^[+a-z0-9A-Z_-]{0,63}$/,Gt=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,L={javascript:!0,"javascript:":!0},F={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},rt=T(26);function k(X,tt,ht){if(X&&G.isObject(X)&&X instanceof lt)return X;var ue=new lt;return ue.parse(X,tt,ht),ue}lt.prototype.parse=function(X,tt,ht){if(!G.isString(X))throw new TypeError("Parameter 'url' must be a string, not "+typeof X);var ue=X.indexOf("?"),je=ue!==-1&&ue<X.indexOf("#")?"?":"#",te=X.split(je);te[0]=te[0].replace(/\\/g,"/");var xt=X=te.join(je);if(xt=xt.trim(),!ht&&X.split("#").length===1){var zt=mt.exec(xt);if(zt)return this.path=xt,this.href=xt,this.pathname=zt[1],zt[2]?(this.search=zt[2],this.query=tt?rt.parse(this.search.substr(1)):this.search.substr(1)):tt&&(this.search="",this.query={}),this}var Vt=Z.exec(xt);if(Vt){var $=(Vt=Vt[0]).toLowerCase();this.protocol=$,xt=xt.substr(Vt.length)}if(ht||Vt||xt.match(/^\/\/[^@\/]+@[^@\/]+/)){var Dt=xt.substr(0,2)==="//";!Dt||Vt&&F[Vt]||(xt=xt.substr(2),this.slashes=!0)}if(!F[Vt]&&(Dt||Vt&&!z[Vt])){for(var Ht,Yt,kt=-1,Qt=0;Qt<Nt.length;Qt++)(de=xt.indexOf(Nt[Qt]))!==-1&&(kt===-1||de<kt)&&(kt=de);for((Yt=kt===-1?xt.lastIndexOf("@"):xt.lastIndexOf("@",kt))!==-1&&(Ht=xt.slice(0,Yt),xt=xt.slice(Yt+1),this.auth=decodeURIComponent(Ht)),kt=-1,Qt=0;Qt<ct.length;Qt++){var de;(de=xt.indexOf(ct[Qt]))!==-1&&(kt===-1||de<kt)&&(kt=de)}kt===-1&&(kt=xt.length),this.host=xt.slice(0,kt),xt=xt.slice(kt),this.parseHost(),this.hostname=this.hostname||"";var Ke=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Ke)for(var ke=this.hostname.split(/\./),$n=(Qt=0,ke.length);Qt<$n;Qt++){var Qe=ke[Qt];if(Qe&&!Qe.match(Xt)){for(var Kn="",kn=0,qn=Qe.length;kn<qn;kn++)Qe.charCodeAt(kn)>127?Kn+="x":Kn+=Qe[kn];if(!Kn.match(Xt)){var bn=ke.slice(0,Qt),Nr=ke.slice(Qt+1),kr=Qe.match(Gt);kr&&(bn.push(kr[1]),Nr.unshift(kr[2])),Nr.length&&(xt="/"+Nr.join(".")+xt),this.hostname=bn.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),Ke||(this.hostname=J.toASCII(this.hostname));var Ir=this.port?":"+this.port:"",Jr=this.hostname||"";this.host=Jr+Ir,this.href+=this.host,Ke&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),xt[0]!=="/"&&(xt="/"+xt))}if(!L[$])for(Qt=0,$n=nt.length;Qt<$n;Qt++){var Pr=nt[Qt];if(xt.indexOf(Pr)!==-1){var Ur=encodeURIComponent(Pr);Ur===Pr&&(Ur=escape(Pr)),xt=xt.split(Pr).join(Ur)}}var Xi=xt.indexOf("#");Xi!==-1&&(this.hash=xt.substr(Xi),xt=xt.slice(0,Xi));var Sr=xt.indexOf("?");if(Sr!==-1?(this.search=xt.substr(Sr),this.query=xt.substr(Sr+1),tt&&(this.query=rt.parse(this.query)),xt=xt.slice(0,Sr)):tt&&(this.search="",this.query={}),xt&&(this.pathname=xt),z[$]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){Ir=this.pathname||"";var Lr=this.search||"";this.path=Ir+Lr}return this.href=this.format(),this},lt.prototype.format=function(){var X=this.auth||"";X&&(X=(X=encodeURIComponent(X)).replace(/%3A/i,":"),X+="@");var tt=this.protocol||"",ht=this.pathname||"",ue=this.hash||"",je=!1,te="";this.host?je=X+this.host:this.hostname&&(je=X+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(je+=":"+this.port)),this.query&&G.isObject(this.query)&&Object.keys(this.query).length&&(te=rt.stringify(this.query));var xt=this.search||te&&"?"+te||"";return tt&&tt.substr(-1)!==":"&&(tt+=":"),this.slashes||(!tt||z[tt])&&je!==!1?(je="//"+(je||""),ht&&ht.charAt(0)!=="/"&&(ht="/"+ht)):je||(je=""),ue&&ue.charAt(0)!=="#"&&(ue="#"+ue),xt&&xt.charAt(0)!=="?"&&(xt="?"+xt),tt+je+(ht=ht.replace(/[?#]/g,function(zt){return encodeURIComponent(zt)}))+(xt=xt.replace("#","%23"))+ue},lt.prototype.resolve=function(X){return this.resolveObject(k(X,!1,!0)).format()},lt.prototype.resolveObject=function(X){if(G.isString(X)){var tt=new lt;tt.parse(X,!1,!0),X=tt}for(var ht=new lt,ue=Object.keys(this),je=0;je<ue.length;je++){var te=ue[je];ht[te]=this[te]}if(ht.hash=X.hash,X.href==="")return ht.href=ht.format(),ht;if(X.slashes&&!X.protocol){for(var xt=Object.keys(X),zt=0;zt<xt.length;zt++){var Vt=xt[zt];Vt!=="protocol"&&(ht[Vt]=X[Vt])}return z[ht.protocol]&&ht.hostname&&!ht.pathname&&(ht.path=ht.pathname="/"),ht.href=ht.format(),ht}if(X.protocol&&X.protocol!==ht.protocol){if(!z[X.protocol]){for(var $=Object.keys(X),Dt=0;Dt<$.length;Dt++){var Ht=$[Dt];ht[Ht]=X[Ht]}return ht.href=ht.format(),ht}if(ht.protocol=X.protocol,X.host||F[X.protocol])ht.pathname=X.pathname;else{for(var Yt=(X.pathname||"").split("/");Yt.length&&!(X.host=Yt.shift()););X.host||(X.host=""),X.hostname||(X.hostname=""),Yt[0]!==""&&Yt.unshift(""),Yt.length<2&&Yt.unshift(""),ht.pathname=Yt.join("/")}if(ht.search=X.search,ht.query=X.query,ht.host=X.host||"",ht.auth=X.auth,ht.hostname=X.hostname||X.host,ht.port=X.port,ht.pathname||ht.search){var kt=ht.pathname||"",Qt=ht.search||"";ht.path=kt+Qt}return ht.slashes=ht.slashes||X.slashes,ht.href=ht.format(),ht}var de=ht.pathname&&ht.pathname.charAt(0)==="/",Ke=X.host||X.pathname&&X.pathname.charAt(0)==="/",ke=Ke||de||ht.host&&X.pathname,$n=ke,Qe=ht.pathname&&ht.pathname.split("/")||[],Kn=(Yt=X.pathname&&X.pathname.split("/")||[],ht.protocol&&!z[ht.protocol]);if(Kn&&(ht.hostname="",ht.port=null,ht.host&&(Qe[0]===""?Qe[0]=ht.host:Qe.unshift(ht.host)),ht.host="",X.protocol&&(X.hostname=null,X.port=null,X.host&&(Yt[0]===""?Yt[0]=X.host:Yt.unshift(X.host)),X.host=null),ke=ke&&(Yt[0]===""||Qe[0]==="")),Ke)ht.host=X.host||X.host===""?X.host:ht.host,ht.hostname=X.hostname||X.hostname===""?X.hostname:ht.hostname,ht.search=X.search,ht.query=X.query,Qe=Yt;else if(Yt.length)Qe||(Qe=[]),Qe.pop(),Qe=Qe.concat(Yt),ht.search=X.search,ht.query=X.query;else if(!G.isNullOrUndefined(X.search))return Kn&&(ht.hostname=ht.host=Qe.shift(),(kr=!!(ht.host&&ht.host.indexOf("@")>0)&&ht.host.split("@"))&&(ht.auth=kr.shift(),ht.host=ht.hostname=kr.shift())),ht.search=X.search,ht.query=X.query,G.isNull(ht.pathname)&&G.isNull(ht.search)||(ht.path=(ht.pathname?ht.pathname:"")+(ht.search?ht.search:"")),ht.href=ht.format(),ht;if(!Qe.length)return ht.pathname=null,ht.search?ht.path="/"+ht.search:ht.path=null,ht.href=ht.format(),ht;for(var kn=Qe.slice(-1)[0],qn=(ht.host||X.host||Qe.length>1)&&(kn==="."||kn==="..")||kn==="",bn=0,Nr=Qe.length;Nr>=0;Nr--)(kn=Qe[Nr])==="."?Qe.splice(Nr,1):kn===".."?(Qe.splice(Nr,1),bn++):bn&&(Qe.splice(Nr,1),bn--);if(!ke&&!$n)for(;bn--;bn)Qe.unshift("..");!ke||Qe[0]===""||Qe[0]&&Qe[0].charAt(0)==="/"||Qe.unshift(""),qn&&Qe.join("/").substr(-1)!=="/"&&Qe.push("");var kr,Ir=Qe[0]===""||Qe[0]&&Qe[0].charAt(0)==="/";return Kn&&(ht.hostname=ht.host=Ir?"":Qe.length?Qe.shift():"",(kr=!!(ht.host&&ht.host.indexOf("@")>0)&&ht.host.split("@"))&&(ht.auth=kr.shift(),ht.host=ht.hostname=kr.shift())),(ke=ke||ht.host&&Qe.length)&&!Ir&&Qe.unshift(""),Qe.length?ht.pathname=Qe.join("/"):(ht.pathname=null,ht.path=null),G.isNull(ht.pathname)&&G.isNull(ht.search)||(ht.path=(ht.pathname?ht.pathname:"")+(ht.search?ht.search:"")),ht.auth=X.auth||ht.auth,ht.slashes=ht.slashes||X.slashes,ht.href=ht.format(),ht},lt.prototype.parseHost=function(){var X=this.host,tt=W.exec(X);tt&&((tt=tt[0])!==":"&&(this.port=tt.substr(1)),X=X.substr(0,X.length-tt.length)),X&&(this.hostname=X)}},function(Ie,C,T){Ie.exports=function(J,G){if(J){G=G||{};for(var lt={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},Z=lt.parser[G.strictMode?"strict":"loose"].exec(J),W={},mt=14;mt--;)W[lt.key[mt]]=Z[mt]||"";return W[lt.q.name]={},W[lt.key[12]].replace(lt.q.parser,function(et,nt,ct){nt&&(W[lt.q.name][nt]=ct)}),W}}},function(Ie,C,T){var J=T(29);Ie.exports=function(G,lt){lt=lt||{};var Z=new J,W=lt.inPlace||!1,mt=G.map(function(nt){return W?nt:{width:nt.width,height:nt.height,item:nt}});mt=mt.sort(function(nt,ct){return ct.width*ct.height-nt.width*nt.height}),Z.fit(mt);var et={width:mt.reduce(function(nt,ct){return Math.max(nt,ct.x+ct.width)},0),height:mt.reduce(function(nt,ct){return Math.max(nt,ct.y+ct.height)},0)};return W||(et.items=mt),et}},function(Ie,C,T){(function(J){Ie.exports=function G(lt,Z,W){function mt(ct,Nt){if(!Z[ct]){if(!lt[ct]){if(et)return et(ct,!0);var Xt=new Error("Cannot find module '"+ct+"'");throw Xt.code="MODULE_NOT_FOUND",Xt}var Gt=Z[ct]={exports:{}};lt[ct][0].call(Gt.exports,function(L){var F=lt[ct][1][L];return mt(F||L)},Gt,Gt.exports,G,lt,Z,W)}return Z[ct].exports}for(var et=!1,nt=0;nt<W.length;nt++)mt(W[nt]);return mt}({1:[function(G,lt,Z){(function(W){var mt,et,nt=W.MutationObserver||W.WebKitMutationObserver;if(nt){var ct=0,Nt=new nt(F),Xt=W.document.createTextNode("");Nt.observe(Xt,{characterData:!0}),mt=function(){Xt.data=ct=++ct%2}}else if(W.setImmediate||W.MessageChannel===void 0)mt="document"in W&&"onreadystatechange"in W.document.createElement("script")?function(){var z=W.document.createElement("script");z.onreadystatechange=function(){F(),z.onreadystatechange=null,z.parentNode.removeChild(z),z=null},W.document.documentElement.appendChild(z)}:function(){setTimeout(F,0)};else{var Gt=new W.MessageChannel;Gt.port1.onmessage=F,mt=function(){Gt.port2.postMessage(0)}}var L=[];function F(){var z,rt;et=!0;for(var k=L.length;k;){for(rt=L,L=[],z=-1;++z<k;)rt[z]();k=L.length}et=!1}lt.exports=function(z){L.push(z)!==1||et||mt()}}).call(this,J!==void 0?J:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(G,lt,Z){var W=G(1);function mt(){}var et={},nt=["REJECTED"],ct=["FULFILLED"],Nt=["PENDING"];function Xt(k){if(typeof k!="function")throw new TypeError("resolver must be a function");this.state=Nt,this.queue=[],this.outcome=void 0,k!==mt&&z(this,k)}function Gt(k,X,tt){this.promise=k,typeof X=="function"&&(this.onFulfilled=X,this.callFulfilled=this.otherCallFulfilled),typeof tt=="function"&&(this.onRejected=tt,this.callRejected=this.otherCallRejected)}function L(k,X,tt){W(function(){var ht;try{ht=X(tt)}catch(ue){return et.reject(k,ue)}ht===k?et.reject(k,new TypeError("Cannot resolve promise with itself")):et.resolve(k,ht)})}function F(k){var X=k&&k.then;if(k&&(typeof k=="object"||typeof k=="function")&&typeof X=="function")return function(){X.apply(k,arguments)}}function z(k,X){var tt=!1;function ht(te){tt||(tt=!0,et.reject(k,te))}function ue(te){tt||(tt=!0,et.resolve(k,te))}var je=rt(function(){X(ue,ht)});je.status==="error"&&ht(je.value)}function rt(k,X){var tt={};try{tt.value=k(X),tt.status="success"}catch(ht){tt.status="error",tt.value=ht}return tt}lt.exports=Xt,Xt.prototype.catch=function(k){return this.then(null,k)},Xt.prototype.then=function(k,X){if(typeof k!="function"&&this.state===ct||typeof X!="function"&&this.state===nt)return this;var tt=new this.constructor(mt);return this.state!==Nt?L(tt,this.state===ct?k:X,this.outcome):this.queue.push(new Gt(tt,k,X)),tt},Gt.prototype.callFulfilled=function(k){et.resolve(this.promise,k)},Gt.prototype.otherCallFulfilled=function(k){L(this.promise,this.onFulfilled,k)},Gt.prototype.callRejected=function(k){et.reject(this.promise,k)},Gt.prototype.otherCallRejected=function(k){L(this.promise,this.onRejected,k)},et.resolve=function(k,X){var tt=rt(F,X);if(tt.status==="error")return et.reject(k,tt.value);var ht=tt.value;if(ht)z(k,ht);else{k.state=ct,k.outcome=X;for(var ue=-1,je=k.queue.length;++ue<je;)k.queue[ue].callFulfilled(X)}return k},et.reject=function(k,X){k.state=nt,k.outcome=X;for(var tt=-1,ht=k.queue.length;++tt<ht;)k.queue[tt].callRejected(X);return k},Xt.resolve=function(k){return k instanceof this?k:et.resolve(new this(mt),k)},Xt.reject=function(k){var X=new this(mt);return et.reject(X,k)},Xt.all=function(k){var X=this;if(Object.prototype.toString.call(k)!=="[object Array]")return this.reject(new TypeError("must be an array"));var tt=k.length,ht=!1;if(!tt)return this.resolve([]);for(var ue=new Array(tt),je=0,te=-1,xt=new this(mt);++te<tt;)zt(k[te],te);return xt;function zt(Vt,$){X.resolve(Vt).then(function(Dt){ue[$]=Dt,++je!==tt||ht||(ht=!0,et.resolve(xt,ue))},function(Dt){ht||(ht=!0,et.reject(xt,Dt))})}},Xt.race=function(k){var X=this;if(Object.prototype.toString.call(k)!=="[object Array]")return this.reject(new TypeError("must be an array"));var tt=k.length,ht=!1;if(!tt)return this.resolve([]);for(var ue,je=-1,te=new this(mt);++je<tt;)ue=k[je],X.resolve(ue).then(function(xt){ht||(ht=!0,et.resolve(te,xt))},function(xt){ht||(ht=!0,et.reject(te,xt))});return te}},{1:1}],3:[function(G,lt,Z){(function(W){typeof W.Promise!="function"&&(W.Promise=G(2))}).call(this,J!==void 0?J:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(G,lt,Z){var W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},mt=function(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch{return}}();function et(Q,ft){Q=Q||[],ft=ft||{};try{return new Blob(Q,ft)}catch(Ct){if(Ct.name!=="TypeError")throw Ct;for(var dt=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder),Lt=0;Lt<Q.length;Lt+=1)dt.append(Q[Lt]);return dt.getBlob(ft.type)}}typeof Promise=="undefined"&&G(3);var nt=Promise;function ct(Q,ft){ft&&Q.then(function(dt){ft(null,dt)},function(dt){ft(dt)})}function Nt(Q,ft,dt){typeof ft=="function"&&Q.then(ft),typeof dt=="function"&&Q.catch(dt)}function Xt(Q){return typeof Q!="string"&&(console.warn(Q+" used as a key, but it is not a string."),Q=String(Q)),Q}function Gt(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var L=void 0,F={},z=Object.prototype.toString;function rt(Q){return typeof L=="boolean"?nt.resolve(L):function(ft){return new nt(function(dt){var Lt=ft.transaction("local-forage-detect-blob-support","readwrite"),Ct=et([""]);Lt.objectStore("local-forage-detect-blob-support").put(Ct,"key"),Lt.onabort=function(It){It.preventDefault(),It.stopPropagation(),dt(!1)},Lt.oncomplete=function(){var It=navigator.userAgent.match(/Chrome\/(\d+)/),Zt=navigator.userAgent.match(/Edge\//);dt(Zt||!It||parseInt(It[1],10)>=43)}}).catch(function(){return!1})}(Q).then(function(ft){return L=ft})}function k(Q){var ft=F[Q.name],dt={};dt.promise=new nt(function(Lt,Ct){dt.resolve=Lt,dt.reject=Ct}),ft.deferredOperations.push(dt),ft.dbReady?ft.dbReady=ft.dbReady.then(function(){return dt.promise}):ft.dbReady=dt.promise}function X(Q){var ft=F[Q.name].deferredOperations.pop();if(ft)return ft.resolve(),ft.promise}function tt(Q,ft){var dt=F[Q.name].deferredOperations.pop();if(dt)return dt.reject(ft),dt.promise}function ht(Q,ft){return new nt(function(dt,Lt){if(F[Q.name]=F[Q.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},Q.db){if(!ft)return dt(Q.db);k(Q),Q.db.close()}var Ct=[Q.name];ft&&Ct.push(Q.version);var It=mt.open.apply(mt,Ct);ft&&(It.onupgradeneeded=function(Zt){var re=It.result;try{re.createObjectStore(Q.storeName),Zt.oldVersion<=1&&re.createObjectStore("local-forage-detect-blob-support")}catch(pe){if(pe.name!=="ConstraintError")throw pe;console.warn('The database "'+Q.name+'" has been upgraded from version '+Zt.oldVersion+" to version "+Zt.newVersion+', but the storage "'+Q.storeName+'" already exists.')}}),It.onerror=function(Zt){Zt.preventDefault(),Lt(It.error)},It.onsuccess=function(){dt(It.result),X(Q)}})}function ue(Q){return ht(Q,!1)}function je(Q){return ht(Q,!0)}function te(Q,ft){if(!Q.db)return!0;var dt=!Q.db.objectStoreNames.contains(Q.storeName),Lt=Q.version<Q.db.version,Ct=Q.version>Q.db.version;if(Lt&&(Q.version!==ft&&console.warn('The database "'+Q.name+`" can't be downgraded from version `+Q.db.version+" to version "+Q.version+"."),Q.version=Q.db.version),Ct||dt){if(dt){var It=Q.db.version+1;It>Q.version&&(Q.version=It)}return!0}return!1}function xt(Q){return et([function(ft){for(var dt=ft.length,Lt=new ArrayBuffer(dt),Ct=new Uint8Array(Lt),It=0;It<dt;It++)Ct[It]=ft.charCodeAt(It);return Lt}(atob(Q.data))],{type:Q.type})}function zt(Q){return Q&&Q.__local_forage_encoded_blob}function Vt(Q){var ft=this,dt=ft._initReady().then(function(){var Lt=F[ft._dbInfo.name];if(Lt&&Lt.dbReady)return Lt.dbReady});return Nt(dt,Q,Q),dt}function $(Q,ft,dt,Lt){Lt===void 0&&(Lt=1);try{var Ct=Q.db.transaction(Q.storeName,ft);dt(null,Ct)}catch(It){if(Lt>0&&(!Q.db||It.name==="InvalidStateError"||It.name==="NotFoundError"))return nt.resolve().then(function(){if(!Q.db||It.name==="NotFoundError"&&!Q.db.objectStoreNames.contains(Q.storeName)&&Q.version<=Q.db.version)return Q.db&&(Q.version=Q.db.version+1),je(Q)}).then(function(){return function(Zt){k(Zt);for(var re=F[Zt.name],pe=re.forages,Kt=0;Kt<pe.length;Kt++){var qe=pe[Kt];qe._dbInfo.db&&(qe._dbInfo.db.close(),qe._dbInfo.db=null)}return Zt.db=null,ue(Zt).then(function(ie){return Zt.db=ie,te(Zt)?je(Zt):ie}).then(function(ie){Zt.db=re.db=ie;for(var Pn=0;Pn<pe.length;Pn++)pe[Pn]._dbInfo.db=ie}).catch(function(ie){throw tt(Zt,ie),ie})}(Q).then(function(){$(Q,ft,dt,Lt-1)})}).catch(dt);dt(It)}}var Dt={_driver:"asyncStorage",_initStorage:function(Q){var ft=this,dt={db:null};if(Q)for(var Lt in Q)dt[Lt]=Q[Lt];var Ct=F[dt.name];Ct||(Ct={forages:[],db:null,dbReady:null,deferredOperations:[]},F[dt.name]=Ct),Ct.forages.push(ft),ft._initReady||(ft._initReady=ft.ready,ft.ready=Vt);var It=[];function Zt(){return nt.resolve()}for(var re=0;re<Ct.forages.length;re++){var pe=Ct.forages[re];pe!==ft&&It.push(pe._initReady().catch(Zt))}var Kt=Ct.forages.slice(0);return nt.all(It).then(function(){return dt.db=Ct.db,ue(dt)}).then(function(qe){return dt.db=qe,te(dt,ft._defaultConfig.version)?je(dt):qe}).then(function(qe){dt.db=Ct.db=qe,ft._dbInfo=dt;for(var ie=0;ie<Kt.length;ie++){var Pn=Kt[ie];Pn!==ft&&(Pn._dbInfo.db=dt.db,Pn._dbInfo.version=dt.version)}})},_support:function(){try{if(!mt||!mt.open)return!1;var Q=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ft=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!Q||ft)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch{return!1}}(),iterate:function(Q,ft){var dt=this,Lt=new nt(function(Ct,It){dt.ready().then(function(){$(dt._dbInfo,"readonly",function(Zt,re){if(Zt)return It(Zt);try{var pe=re.objectStore(dt._dbInfo.storeName).openCursor(),Kt=1;pe.onsuccess=function(){var qe=pe.result;if(qe){var ie=qe.value;zt(ie)&&(ie=xt(ie));var Pn=Q(ie,qe.key,Kt++);Pn!==void 0?Ct(Pn):qe.continue()}else Ct()},pe.onerror=function(){It(pe.error)}}catch(qe){It(qe)}})}).catch(It)});return ct(Lt,ft),Lt},getItem:function(Q,ft){var dt=this;Q=Xt(Q);var Lt=new nt(function(Ct,It){dt.ready().then(function(){$(dt._dbInfo,"readonly",function(Zt,re){if(Zt)return It(Zt);try{var pe=re.objectStore(dt._dbInfo.storeName).get(Q);pe.onsuccess=function(){var Kt=pe.result;Kt===void 0&&(Kt=null),zt(Kt)&&(Kt=xt(Kt)),Ct(Kt)},pe.onerror=function(){It(pe.error)}}catch(Kt){It(Kt)}})}).catch(It)});return ct(Lt,ft),Lt},setItem:function(Q,ft,dt){var Lt=this;Q=Xt(Q);var Ct=new nt(function(It,Zt){var re;Lt.ready().then(function(){return re=Lt._dbInfo,z.call(ft)==="[object Blob]"?rt(re.db).then(function(pe){return pe?ft:(Kt=ft,new nt(function(qe,ie){var Pn=new FileReader;Pn.onerror=ie,Pn.onloadend=function(ar){var Un=btoa(ar.target.result||"");qe({__local_forage_encoded_blob:!0,data:Un,type:Kt.type})},Pn.readAsBinaryString(Kt)}));var Kt}):ft}).then(function(pe){$(Lt._dbInfo,"readwrite",function(Kt,qe){if(Kt)return Zt(Kt);try{var ie=qe.objectStore(Lt._dbInfo.storeName);pe===null&&(pe=void 0);var Pn=ie.put(pe,Q);qe.oncomplete=function(){pe===void 0&&(pe=null),It(pe)},qe.onabort=qe.onerror=function(){var ar=Pn.error?Pn.error:Pn.transaction.error;Zt(ar)}}catch(ar){Zt(ar)}})}).catch(Zt)});return ct(Ct,dt),Ct},removeItem:function(Q,ft){var dt=this;Q=Xt(Q);var Lt=new nt(function(Ct,It){dt.ready().then(function(){$(dt._dbInfo,"readwrite",function(Zt,re){if(Zt)return It(Zt);try{var pe=re.objectStore(dt._dbInfo.storeName).delete(Q);re.oncomplete=function(){Ct()},re.onerror=function(){It(pe.error)},re.onabort=function(){var Kt=pe.error?pe.error:pe.transaction.error;It(Kt)}}catch(Kt){It(Kt)}})}).catch(It)});return ct(Lt,ft),Lt},clear:function(Q){var ft=this,dt=new nt(function(Lt,Ct){ft.ready().then(function(){$(ft._dbInfo,"readwrite",function(It,Zt){if(It)return Ct(It);try{var re=Zt.objectStore(ft._dbInfo.storeName).clear();Zt.oncomplete=function(){Lt()},Zt.onabort=Zt.onerror=function(){var pe=re.error?re.error:re.transaction.error;Ct(pe)}}catch(pe){Ct(pe)}})}).catch(Ct)});return ct(dt,Q),dt},length:function(Q){var ft=this,dt=new nt(function(Lt,Ct){ft.ready().then(function(){$(ft._dbInfo,"readonly",function(It,Zt){if(It)return Ct(It);try{var re=Zt.objectStore(ft._dbInfo.storeName).count();re.onsuccess=function(){Lt(re.result)},re.onerror=function(){Ct(re.error)}}catch(pe){Ct(pe)}})}).catch(Ct)});return ct(dt,Q),dt},key:function(Q,ft){var dt=this,Lt=new nt(function(Ct,It){Q<0?Ct(null):dt.ready().then(function(){$(dt._dbInfo,"readonly",function(Zt,re){if(Zt)return It(Zt);try{var pe=re.objectStore(dt._dbInfo.storeName),Kt=!1,qe=pe.openKeyCursor();qe.onsuccess=function(){var ie=qe.result;ie?Q===0||Kt?Ct(ie.key):(Kt=!0,ie.advance(Q)):Ct(null)},qe.onerror=function(){It(qe.error)}}catch(ie){It(ie)}})}).catch(It)});return ct(Lt,ft),Lt},keys:function(Q){var ft=this,dt=new nt(function(Lt,Ct){ft.ready().then(function(){$(ft._dbInfo,"readonly",function(It,Zt){if(It)return Ct(It);try{var re=Zt.objectStore(ft._dbInfo.storeName).openKeyCursor(),pe=[];re.onsuccess=function(){var Kt=re.result;Kt?(pe.push(Kt.key),Kt.continue()):Lt(pe)},re.onerror=function(){Ct(re.error)}}catch(Kt){Ct(Kt)}})}).catch(Ct)});return ct(dt,Q),dt},dropInstance:function(Q,ft){ft=Gt.apply(this,arguments);var dt=this.config();(Q=typeof Q!="function"&&Q||{}).name||(Q.name=Q.name||dt.name,Q.storeName=Q.storeName||dt.storeName);var Lt,Ct=this;if(Q.name){var It=Q.name===dt.name&&Ct._dbInfo.db,Zt=It?nt.resolve(Ct._dbInfo.db):ue(Q).then(function(re){var pe=F[Q.name],Kt=pe.forages;pe.db=re;for(var qe=0;qe<Kt.length;qe++)Kt[qe]._dbInfo.db=re;return re});Lt=Q.storeName?Zt.then(function(re){if(re.objectStoreNames.contains(Q.storeName)){var pe=re.version+1;k(Q);var Kt=F[Q.name],qe=Kt.forages;re.close();for(var ie=0;ie<qe.length;ie++){var Pn=qe[ie];Pn._dbInfo.db=null,Pn._dbInfo.version=pe}return new nt(function(ar,Un){var jr=mt.open(Q.name,pe);jr.onerror=function(Xo){jr.result.close(),Un(Xo)},jr.onupgradeneeded=function(){jr.result.deleteObjectStore(Q.storeName)},jr.onsuccess=function(){var Xo=jr.result;Xo.close(),ar(Xo)}}).then(function(ar){Kt.db=ar;for(var Un=0;Un<qe.length;Un++){var jr=qe[Un];jr._dbInfo.db=ar,X(jr._dbInfo)}}).catch(function(ar){throw(tt(Q,ar)||nt.resolve()).catch(function(){}),ar})}}):Zt.then(function(re){k(Q);var pe=F[Q.name],Kt=pe.forages;re.close();for(var qe=0;qe<Kt.length;qe++)Kt[qe]._dbInfo.db=null;return new nt(function(ie,Pn){var ar=mt.deleteDatabase(Q.name);ar.onerror=ar.onblocked=function(Un){var jr=ar.result;jr&&jr.close(),Pn(Un)},ar.onsuccess=function(){var Un=ar.result;Un&&Un.close(),ie(Un)}}).then(function(ie){pe.db=ie;for(var Pn=0;Pn<Kt.length;Pn++)X(Kt[Pn]._dbInfo)}).catch(function(ie){throw(tt(Q,ie)||nt.resolve()).catch(function(){}),ie})})}else Lt=nt.reject("Invalid arguments");return ct(Lt,ft),Lt}},Ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Yt=/^~~local_forage_type~([^~]+)~/,kt="__lfsc__:".length,Qt=kt+"arbf".length,de=Object.prototype.toString;function Ke(Q){var ft,dt,Lt,Ct,It,Zt=.75*Q.length,re=Q.length,pe=0;Q[Q.length-1]==="="&&(Zt--,Q[Q.length-2]==="="&&Zt--);var Kt=new ArrayBuffer(Zt),qe=new Uint8Array(Kt);for(ft=0;ft<re;ft+=4)dt=Ht.indexOf(Q[ft]),Lt=Ht.indexOf(Q[ft+1]),Ct=Ht.indexOf(Q[ft+2]),It=Ht.indexOf(Q[ft+3]),qe[pe++]=dt<<2|Lt>>4,qe[pe++]=(15&Lt)<<4|Ct>>2,qe[pe++]=(3&Ct)<<6|63&It;return Kt}function ke(Q){var ft,dt=new Uint8Array(Q),Lt="";for(ft=0;ft<dt.length;ft+=3)Lt+=Ht[dt[ft]>>2],Lt+=Ht[(3&dt[ft])<<4|dt[ft+1]>>4],Lt+=Ht[(15&dt[ft+1])<<2|dt[ft+2]>>6],Lt+=Ht[63&dt[ft+2]];return dt.length%3==2?Lt=Lt.substring(0,Lt.length-1)+"=":dt.length%3==1&&(Lt=Lt.substring(0,Lt.length-2)+"=="),Lt}var $n={serialize:function(Q,ft){var dt="";if(Q&&(dt=de.call(Q)),Q&&(dt==="[object ArrayBuffer]"||Q.buffer&&de.call(Q.buffer)==="[object ArrayBuffer]")){var Lt,Ct="__lfsc__:";Q instanceof ArrayBuffer?(Lt=Q,Ct+="arbf"):(Lt=Q.buffer,dt==="[object Int8Array]"?Ct+="si08":dt==="[object Uint8Array]"?Ct+="ui08":dt==="[object Uint8ClampedArray]"?Ct+="uic8":dt==="[object Int16Array]"?Ct+="si16":dt==="[object Uint16Array]"?Ct+="ur16":dt==="[object Int32Array]"?Ct+="si32":dt==="[object Uint32Array]"?Ct+="ui32":dt==="[object Float32Array]"?Ct+="fl32":dt==="[object Float64Array]"?Ct+="fl64":ft(new Error("Failed to get type for BinaryArray"))),ft(Ct+ke(Lt))}else if(dt==="[object Blob]"){var It=new FileReader;It.onload=function(){var Zt="~~local_forage_type~"+Q.type+"~"+ke(this.result);ft("__lfsc__:blob"+Zt)},It.readAsArrayBuffer(Q)}else try{ft(JSON.stringify(Q))}catch(Zt){console.error("Couldn't convert value into a JSON string: ",Q),ft(null,Zt)}},deserialize:function(Q){if(Q.substring(0,kt)!=="__lfsc__:")return JSON.parse(Q);var ft,dt=Q.substring(Qt),Lt=Q.substring(kt,Qt);if(Lt==="blob"&&Yt.test(dt)){var Ct=dt.match(Yt);ft=Ct[1],dt=dt.substring(Ct[0].length)}var It=Ke(dt);switch(Lt){case"arbf":return It;case"blob":return et([It],{type:ft});case"si08":return new Int8Array(It);case"ui08":return new Uint8Array(It);case"uic8":return new Uint8ClampedArray(It);case"si16":return new Int16Array(It);case"ur16":return new Uint16Array(It);case"si32":return new Int32Array(It);case"ui32":return new Uint32Array(It);case"fl32":return new Float32Array(It);case"fl64":return new Float64Array(It);default:throw new Error("Unkown type: "+Lt)}},stringToBuffer:Ke,bufferToString:ke};function Qe(Q,ft,dt,Lt){Q.executeSql("CREATE TABLE IF NOT EXISTS "+ft.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],dt,Lt)}function Kn(Q,ft,dt,Lt,Ct,It){Q.executeSql(dt,Lt,Ct,function(Zt,re){re.code===re.SYNTAX_ERR?Zt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ft.storeName],function(pe,Kt){Kt.rows.length?It(pe,re):Qe(pe,ft,function(){pe.executeSql(dt,Lt,Ct,It)},It)},It):It(Zt,re)},It)}function kn(Q,ft,dt,Lt){var Ct=this;Q=Xt(Q);var It=new nt(function(Zt,re){Ct.ready().then(function(){ft===void 0&&(ft=null);var pe=ft,Kt=Ct._dbInfo;Kt.serializer.serialize(ft,function(qe,ie){ie?re(ie):Kt.db.transaction(function(Pn){Kn(Pn,Kt,"INSERT OR REPLACE INTO "+Kt.storeName+" (key, value) VALUES (?, ?)",[Q,qe],function(){Zt(pe)},function(ar,Un){re(Un)})},function(Pn){if(Pn.code===Pn.QUOTA_ERR){if(Lt>0)return void Zt(kn.apply(Ct,[Q,pe,dt,Lt-1]));re(Pn)}})})}).catch(re)});return ct(It,dt),It}function qn(Q){return new nt(function(ft,dt){Q.transaction(function(Lt){Lt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Ct,It){for(var Zt=[],re=0;re<It.rows.length;re++)Zt.push(It.rows.item(re).name);ft({db:Q,storeNames:Zt})},function(Ct,It){dt(It)})},function(Lt){dt(Lt)})})}var bn={_driver:"webSQLStorage",_initStorage:function(Q){var ft=this,dt={db:null};if(Q)for(var Lt in Q)dt[Lt]=typeof Q[Lt]!="string"?Q[Lt].toString():Q[Lt];var Ct=new nt(function(It,Zt){try{dt.db=openDatabase(dt.name,String(dt.version),dt.description,dt.size)}catch(re){return Zt(re)}dt.db.transaction(function(re){Qe(re,dt,function(){ft._dbInfo=dt,It()},function(pe,Kt){Zt(Kt)})},Zt)});return dt.serializer=$n,Ct},_support:typeof openDatabase=="function",iterate:function(Q,ft){var dt=this,Lt=new nt(function(Ct,It){dt.ready().then(function(){var Zt=dt._dbInfo;Zt.db.transaction(function(re){Kn(re,Zt,"SELECT * FROM "+Zt.storeName,[],function(pe,Kt){for(var qe=Kt.rows,ie=qe.length,Pn=0;Pn<ie;Pn++){var ar=qe.item(Pn),Un=ar.value;if(Un&&(Un=Zt.serializer.deserialize(Un)),(Un=Q(Un,ar.key,Pn+1))!==void 0)return void Ct(Un)}Ct()},function(pe,Kt){It(Kt)})})}).catch(It)});return ct(Lt,ft),Lt},getItem:function(Q,ft){var dt=this;Q=Xt(Q);var Lt=new nt(function(Ct,It){dt.ready().then(function(){var Zt=dt._dbInfo;Zt.db.transaction(function(re){Kn(re,Zt,"SELECT * FROM "+Zt.storeName+" WHERE key = ? LIMIT 1",[Q],function(pe,Kt){var qe=Kt.rows.length?Kt.rows.item(0).value:null;qe&&(qe=Zt.serializer.deserialize(qe)),Ct(qe)},function(pe,Kt){It(Kt)})})}).catch(It)});return ct(Lt,ft),Lt},setItem:function(Q,ft,dt){return kn.apply(this,[Q,ft,dt,1])},removeItem:function(Q,ft){var dt=this;Q=Xt(Q);var Lt=new nt(function(Ct,It){dt.ready().then(function(){var Zt=dt._dbInfo;Zt.db.transaction(function(re){Kn(re,Zt,"DELETE FROM "+Zt.storeName+" WHERE key = ?",[Q],function(){Ct()},function(pe,Kt){It(Kt)})})}).catch(It)});return ct(Lt,ft),Lt},clear:function(Q){var ft=this,dt=new nt(function(Lt,Ct){ft.ready().then(function(){var It=ft._dbInfo;It.db.transaction(function(Zt){Kn(Zt,It,"DELETE FROM "+It.storeName,[],function(){Lt()},function(re,pe){Ct(pe)})})}).catch(Ct)});return ct(dt,Q),dt},length:function(Q){var ft=this,dt=new nt(function(Lt,Ct){ft.ready().then(function(){var It=ft._dbInfo;It.db.transaction(function(Zt){Kn(Zt,It,"SELECT COUNT(key) as c FROM "+It.storeName,[],function(re,pe){var Kt=pe.rows.item(0).c;Lt(Kt)},function(re,pe){Ct(pe)})})}).catch(Ct)});return ct(dt,Q),dt},key:function(Q,ft){var dt=this,Lt=new nt(function(Ct,It){dt.ready().then(function(){var Zt=dt._dbInfo;Zt.db.transaction(function(re){Kn(re,Zt,"SELECT key FROM "+Zt.storeName+" WHERE id = ? LIMIT 1",[Q+1],function(pe,Kt){var qe=Kt.rows.length?Kt.rows.item(0).key:null;Ct(qe)},function(pe,Kt){It(Kt)})})}).catch(It)});return ct(Lt,ft),Lt},keys:function(Q){var ft=this,dt=new nt(function(Lt,Ct){ft.ready().then(function(){var It=ft._dbInfo;It.db.transaction(function(Zt){Kn(Zt,It,"SELECT key FROM "+It.storeName,[],function(re,pe){for(var Kt=[],qe=0;qe<pe.rows.length;qe++)Kt.push(pe.rows.item(qe).key);Lt(Kt)},function(re,pe){Ct(pe)})})}).catch(Ct)});return ct(dt,Q),dt},dropInstance:function(Q,ft){ft=Gt.apply(this,arguments);var dt=this.config();(Q=typeof Q!="function"&&Q||{}).name||(Q.name=Q.name||dt.name,Q.storeName=Q.storeName||dt.storeName);var Lt,Ct=this;return ct(Lt=Q.name?new nt(function(It){var Zt;Zt=Q.name===dt.name?Ct._dbInfo.db:openDatabase(Q.name,"","",0),Q.storeName?It({db:Zt,storeNames:[Q.storeName]}):It(qn(Zt))}).then(function(It){return new nt(function(Zt,re){It.db.transaction(function(pe){function Kt(ar){return new nt(function(Un,jr){pe.executeSql("DROP TABLE IF EXISTS "+ar,[],function(){Un()},function(Xo,gi){jr(gi)})})}for(var qe=[],ie=0,Pn=It.storeNames.length;ie<Pn;ie++)qe.push(Kt(It.storeNames[ie]));nt.all(qe).then(function(){Zt()}).catch(function(ar){re(ar)})},function(pe){re(pe)})})}):nt.reject("Invalid arguments"),ft),Lt}};function Nr(Q,ft){var dt=Q.name+"/";return Q.storeName!==ft.storeName&&(dt+=Q.storeName+"/"),dt}function kr(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch{return!0}}()||localStorage.length>0}var Ir={_driver:"localStorageWrapper",_initStorage:function(Q){var ft={};if(Q)for(var dt in Q)ft[dt]=Q[dt];return ft.keyPrefix=Nr(Q,this._defaultConfig),kr()?(this._dbInfo=ft,ft.serializer=$n,nt.resolve()):nt.reject()},_support:function(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function(Q,ft){var dt=this,Lt=dt.ready().then(function(){for(var Ct=dt._dbInfo,It=Ct.keyPrefix,Zt=It.length,re=localStorage.length,pe=1,Kt=0;Kt<re;Kt++){var qe=localStorage.key(Kt);if(qe.indexOf(It)===0){var ie=localStorage.getItem(qe);if(ie&&(ie=Ct.serializer.deserialize(ie)),(ie=Q(ie,qe.substring(Zt),pe++))!==void 0)return ie}}});return ct(Lt,ft),Lt},getItem:function(Q,ft){var dt=this;Q=Xt(Q);var Lt=dt.ready().then(function(){var Ct=dt._dbInfo,It=localStorage.getItem(Ct.keyPrefix+Q);return It&&(It=Ct.serializer.deserialize(It)),It});return ct(Lt,ft),Lt},setItem:function(Q,ft,dt){var Lt=this;Q=Xt(Q);var Ct=Lt.ready().then(function(){ft===void 0&&(ft=null);var It=ft;return new nt(function(Zt,re){var pe=Lt._dbInfo;pe.serializer.serialize(ft,function(Kt,qe){if(qe)re(qe);else try{localStorage.setItem(pe.keyPrefix+Q,Kt),Zt(It)}catch(ie){ie.name!=="QuotaExceededError"&&ie.name!=="NS_ERROR_DOM_QUOTA_REACHED"||re(ie),re(ie)}})})});return ct(Ct,dt),Ct},removeItem:function(Q,ft){var dt=this;Q=Xt(Q);var Lt=dt.ready().then(function(){var Ct=dt._dbInfo;localStorage.removeItem(Ct.keyPrefix+Q)});return ct(Lt,ft),Lt},clear:function(Q){var ft=this,dt=ft.ready().then(function(){for(var Lt=ft._dbInfo.keyPrefix,Ct=localStorage.length-1;Ct>=0;Ct--){var It=localStorage.key(Ct);It.indexOf(Lt)===0&&localStorage.removeItem(It)}});return ct(dt,Q),dt},length:function(Q){var ft=this.keys().then(function(dt){return dt.length});return ct(ft,Q),ft},key:function(Q,ft){var dt=this,Lt=dt.ready().then(function(){var Ct,It=dt._dbInfo;try{Ct=localStorage.key(Q)}catch{Ct=null}return Ct&&(Ct=Ct.substring(It.keyPrefix.length)),Ct});return ct(Lt,ft),Lt},keys:function(Q){var ft=this,dt=ft.ready().then(function(){for(var Lt=ft._dbInfo,Ct=localStorage.length,It=[],Zt=0;Zt<Ct;Zt++){var re=localStorage.key(Zt);re.indexOf(Lt.keyPrefix)===0&&It.push(re.substring(Lt.keyPrefix.length))}return It});return ct(dt,Q),dt},dropInstance:function(Q,ft){if(ft=Gt.apply(this,arguments),!(Q=typeof Q!="function"&&Q||{}).name){var dt=this.config();Q.name=Q.name||dt.name,Q.storeName=Q.storeName||dt.storeName}var Lt,Ct=this;return ct(Lt=Q.name?new nt(function(It){Q.storeName?It(Nr(Q,Ct._defaultConfig)):It(Q.name+"/")}).then(function(It){for(var Zt=localStorage.length-1;Zt>=0;Zt--){var re=localStorage.key(Zt);re.indexOf(It)===0&&localStorage.removeItem(re)}}):nt.reject("Invalid arguments"),ft),Lt}},Jr=function(Q,ft){for(var dt,Lt,Ct=Q.length,It=0;It<Ct;){if((dt=Q[It])===(Lt=ft)||typeof dt=="number"&&typeof Lt=="number"&&isNaN(dt)&&isNaN(Lt))return!0;It++}return!1},Pr=Array.isArray||function(Q){return Object.prototype.toString.call(Q)==="[object Array]"},Ur={},Xi={},Sr={INDEXEDDB:Dt,WEBSQL:bn,LOCALSTORAGE:Ir},Lr=[Sr.INDEXEDDB._driver,Sr.WEBSQL._driver,Sr.LOCALSTORAGE._driver],mi=["dropInstance"],ws=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(mi),Ln={description:"",driver:Lr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function so(Q,ft){Q[ft]=function(){var dt=arguments;return Q.ready().then(function(){return Q[ft].apply(Q,dt)})}}function $i(){for(var Q=1;Q<arguments.length;Q++){var ft=arguments[Q];if(ft)for(var dt in ft)ft.hasOwnProperty(dt)&&(Pr(ft[dt])?arguments[0][dt]=ft[dt].slice():arguments[0][dt]=ft[dt])}return arguments[0]}var yo=new(function(){function Q(ft){for(var dt in function(It,Zt){if(!(It instanceof Zt))throw new TypeError("Cannot call a class as a function")}(this,Q),Sr)if(Sr.hasOwnProperty(dt)){var Lt=Sr[dt],Ct=Lt._driver;this[dt]=Ct,Ur[Ct]||this.defineDriver(Lt)}this._defaultConfig=$i({},Ln),this._config=$i({},this._defaultConfig,ft),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return Q.prototype.config=function(ft){if((ft===void 0?"undefined":W(ft))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var dt in ft){if(dt==="storeName"&&(ft[dt]=ft[dt].replace(/\W/g,"_")),dt==="version"&&typeof ft[dt]!="number")return new Error("Database version must be a number.");this._config[dt]=ft[dt]}return!("driver"in ft)||!ft.driver||this.setDriver(this._config.driver)}return typeof ft=="string"?this._config[ft]:this._config},Q.prototype.defineDriver=function(ft,dt,Lt){var Ct=new nt(function(It,Zt){try{var re=ft._driver,pe=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!ft._driver)return void Zt(pe);for(var Kt=ws.concat("_initStorage"),qe=0,ie=Kt.length;qe<ie;qe++){var Pn=Kt[qe];if((!Jr(mi,Pn)||ft[Pn])&&typeof ft[Pn]!="function")return void Zt(pe)}(function(){for(var Un=function(Qa){return function(){var Oo=new Error("Method "+Qa+" is not implemented by the current driver"),Ma=nt.reject(Oo);return ct(Ma,arguments[arguments.length-1]),Ma}},jr=0,Xo=mi.length;jr<Xo;jr++){var gi=mi[jr];ft[gi]||(ft[gi]=Un(gi))}})();var ar=function(Un){Ur[re]&&console.info("Redefining LocalForage driver: "+re),Ur[re]=ft,Xi[re]=Un,It()};"_support"in ft?ft._support&&typeof ft._support=="function"?ft._support().then(ar,Zt):ar(!!ft._support):ar(!0)}catch(Un){Zt(Un)}});return Nt(Ct,dt,Lt),Ct},Q.prototype.driver=function(){return this._driver||null},Q.prototype.getDriver=function(ft,dt,Lt){var Ct=Ur[ft]?nt.resolve(Ur[ft]):nt.reject(new Error("Driver not found."));return Nt(Ct,dt,Lt),Ct},Q.prototype.getSerializer=function(ft){var dt=nt.resolve($n);return Nt(dt,ft),dt},Q.prototype.ready=function(ft){var dt=this,Lt=dt._driverSet.then(function(){return dt._ready===null&&(dt._ready=dt._initDriver()),dt._ready});return Nt(Lt,ft,ft),Lt},Q.prototype.setDriver=function(ft,dt,Lt){var Ct=this;Pr(ft)||(ft=[ft]);var It=this._getSupportedDrivers(ft);function Zt(){Ct._config.driver=Ct.driver()}function re(Kt){return Ct._extend(Kt),Zt(),Ct._ready=Ct._initStorage(Ct._config),Ct._ready}var pe=this._driverSet!==null?this._driverSet.catch(function(){return nt.resolve()}):nt.resolve();return this._driverSet=pe.then(function(){var Kt=It[0];return Ct._dbInfo=null,Ct._ready=null,Ct.getDriver(Kt).then(function(qe){Ct._driver=qe._driver,Zt(),Ct._wrapLibraryMethodsWithReady(),Ct._initDriver=function(ie){return function(){var Pn=0;return function ar(){for(;Pn<ie.length;){var Un=ie[Pn];return Pn++,Ct._dbInfo=null,Ct._ready=null,Ct.getDriver(Un).then(re).catch(ar)}Zt();var jr=new Error("No available storage method found.");return Ct._driverSet=nt.reject(jr),Ct._driverSet}()}}(It)})}).catch(function(){Zt();var Kt=new Error("No available storage method found.");return Ct._driverSet=nt.reject(Kt),Ct._driverSet}),Nt(this._driverSet,dt,Lt),this._driverSet},Q.prototype.supports=function(ft){return!!Xi[ft]},Q.prototype._extend=function(ft){$i(this,ft)},Q.prototype._getSupportedDrivers=function(ft){for(var dt=[],Lt=0,Ct=ft.length;Lt<Ct;Lt++){var It=ft[Lt];this.supports(It)&&dt.push(It)}return dt},Q.prototype._wrapLibraryMethodsWithReady=function(){for(var ft=0,dt=ws.length;ft<dt;ft++)so(this,ws[ft])},Q.prototype.createInstance=function(ft){return new Q(ft)},Q}());lt.exports=yo},{3:3}]},{},[4])(4)}).call(this,T(4))},function(Ie,C){Ie.exports=function(T){return T.webpackPolyfill||(T.deprecate=function(){},T.paths=[],T.children||(T.children=[]),Object.defineProperty(T,"loaded",{enumerable:!0,get:function(){return T.l}}),Object.defineProperty(T,"id",{enumerable:!0,get:function(){return T.i}}),T.webpackPolyfill=1),T}},function(Ie,C,T){var J=Object.prototype.hasOwnProperty,G="~";function lt(){}function Z(nt,ct,Nt){this.fn=nt,this.context=ct,this.once=Nt||!1}function W(nt,ct,Nt,Xt,Gt){if(typeof Nt!="function")throw new TypeError("The listener must be a function");var L=new Z(Nt,Xt||nt,Gt),F=G?G+ct:ct;return nt._events[F]?nt._events[F].fn?nt._events[F]=[nt._events[F],L]:nt._events[F].push(L):(nt._events[F]=L,nt._eventsCount++),nt}function mt(nt,ct){--nt._eventsCount==0?nt._events=new lt:delete nt._events[ct]}function et(){this._events=new lt,this._eventsCount=0}Object.create&&(lt.prototype=Object.create(null),new lt().__proto__||(G=!1)),et.prototype.eventNames=function(){var nt,ct,Nt=[];if(this._eventsCount===0)return Nt;for(ct in nt=this._events)J.call(nt,ct)&&Nt.push(G?ct.slice(1):ct);return Object.getOwnPropertySymbols?Nt.concat(Object.getOwnPropertySymbols(nt)):Nt},et.prototype.listeners=function(nt){var ct=G?G+nt:nt,Nt=this._events[ct];if(!Nt)return[];if(Nt.fn)return[Nt.fn];for(var Xt=0,Gt=Nt.length,L=new Array(Gt);Xt<Gt;Xt++)L[Xt]=Nt[Xt].fn;return L},et.prototype.listenerCount=function(nt){var ct=G?G+nt:nt,Nt=this._events[ct];return Nt?Nt.fn?1:Nt.length:0},et.prototype.emit=function(nt,ct,Nt,Xt,Gt,L){var F=G?G+nt:nt;if(!this._events[F])return!1;var z,rt,k=this._events[F],X=arguments.length;if(k.fn){switch(k.once&&this.removeListener(nt,k.fn,void 0,!0),X){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,ct),!0;case 3:return k.fn.call(k.context,ct,Nt),!0;case 4:return k.fn.call(k.context,ct,Nt,Xt),!0;case 5:return k.fn.call(k.context,ct,Nt,Xt,Gt),!0;case 6:return k.fn.call(k.context,ct,Nt,Xt,Gt,L),!0}for(rt=1,z=new Array(X-1);rt<X;rt++)z[rt-1]=arguments[rt];k.fn.apply(k.context,z)}else{var tt,ht=k.length;for(rt=0;rt<ht;rt++)switch(k[rt].once&&this.removeListener(nt,k[rt].fn,void 0,!0),X){case 1:k[rt].fn.call(k[rt].context);break;case 2:k[rt].fn.call(k[rt].context,ct);break;case 3:k[rt].fn.call(k[rt].context,ct,Nt);break;case 4:k[rt].fn.call(k[rt].context,ct,Nt,Xt);break;default:if(!z)for(tt=1,z=new Array(X-1);tt<X;tt++)z[tt-1]=arguments[tt];k[rt].fn.apply(k[rt].context,z)}}return!0},et.prototype.on=function(nt,ct,Nt){return W(this,nt,ct,Nt,!1)},et.prototype.once=function(nt,ct,Nt){return W(this,nt,ct,Nt,!0)},et.prototype.removeListener=function(nt,ct,Nt,Xt){var Gt=G?G+nt:nt;if(!this._events[Gt])return this;if(!ct)return mt(this,Gt),this;var L=this._events[Gt];if(L.fn)L.fn!==ct||Xt&&!L.once||Nt&&L.context!==Nt||mt(this,Gt);else{for(var F=0,z=[],rt=L.length;F<rt;F++)(L[F].fn!==ct||Xt&&!L[F].once||Nt&&L[F].context!==Nt)&&z.push(L[F]);z.length?this._events[Gt]=z.length===1?z[0]:z:mt(this,Gt)}return this},et.prototype.removeAllListeners=function(nt){var ct;return nt?(ct=G?G+nt:nt,this._events[ct]&&mt(this,ct)):(this._events=new lt,this._eventsCount=0),this},et.prototype.off=et.prototype.removeListener,et.prototype.addListener=et.prototype.on,et.prefixed=G,et.EventEmitter=et,Ie.exports=et},function(Ie,C,T){function J($,Dt,Ht){Ht=Ht||2;var Yt,kt,Qt,de,Ke,ke,$n,Qe=Dt&&Dt.length,Kn=Qe?Dt[0]*Ht:$.length,kn=G($,0,Kn,Ht,!0),qn=[];if(!kn||kn.next===kn.prev)return qn;if(Qe&&(kn=function(Nr,kr,Ir,Jr){var Pr,Ur,Xi,Sr,Lr,mi=[];for(Pr=0,Ur=kr.length;Pr<Ur;Pr++)Xi=kr[Pr]*Jr,Sr=Pr<Ur-1?kr[Pr+1]*Jr:Nr.length,(Lr=G(Nr,Xi,Sr,Jr,!1))===Lr.next&&(Lr.steiner=!0),mi.push(L(Lr));for(mi.sort(ct),Pr=0;Pr<mi.length;Pr++)Ir=lt(Ir=Nt(mi[Pr],Ir),Ir.next);return Ir}($,Dt,kn,Ht)),$.length>80*Ht){Yt=Qt=$[0],kt=de=$[1];for(var bn=Ht;bn<Kn;bn+=Ht)(Ke=$[bn])<Yt&&(Yt=Ke),(ke=$[bn+1])<kt&&(kt=ke),Ke>Qt&&(Qt=Ke),ke>de&&(de=ke);$n=($n=Math.max(Qt-Yt,de-kt))!==0?1/$n:0}return Z(kn,qn,Ht,Yt,kt,$n),qn}function G($,Dt,Ht,Yt,kt){var Qt,de;if(kt===Vt($,Dt,Ht,Yt)>0)for(Qt=Dt;Qt<Ht;Qt+=Yt)de=te(Qt,$[Qt],$[Qt+1],de);else for(Qt=Ht-Yt;Qt>=Dt;Qt-=Yt)de=te(Qt,$[Qt],$[Qt+1],de);return de&&k(de,de.next)&&(xt(de),de=de.next),de}function lt($,Dt){if(!$)return $;Dt||(Dt=$);var Ht,Yt=$;do if(Ht=!1,Yt.steiner||!k(Yt,Yt.next)&&rt(Yt.prev,Yt,Yt.next)!==0)Yt=Yt.next;else{if(xt(Yt),(Yt=Dt=Yt.prev)===Yt.next)break;Ht=!0}while(Ht||Yt!==Dt);return Dt}function Z($,Dt,Ht,Yt,kt,Qt,de){if($){!de&&Qt&&function(Qe,Kn,kn,qn){var bn=Qe;do bn.z===null&&(bn.z=Gt(bn.x,bn.y,Kn,kn,qn)),bn.prevZ=bn.prev,bn.nextZ=bn.next,bn=bn.next;while(bn!==Qe);bn.prevZ.nextZ=null,bn.prevZ=null,function(Nr){var kr,Ir,Jr,Pr,Ur,Xi,Sr,Lr,mi=1;do{for(Ir=Nr,Nr=null,Ur=null,Xi=0;Ir;){for(Xi++,Jr=Ir,Sr=0,kr=0;kr<mi&&(Sr++,Jr=Jr.nextZ);kr++);for(Lr=mi;Sr>0||Lr>0&&Jr;)Sr!==0&&(Lr===0||!Jr||Ir.z<=Jr.z)?(Pr=Ir,Ir=Ir.nextZ,Sr--):(Pr=Jr,Jr=Jr.nextZ,Lr--),Ur?Ur.nextZ=Pr:Nr=Pr,Pr.prevZ=Ur,Ur=Pr;Ir=Jr}Ur.nextZ=null,mi*=2}while(Xi>1)}(bn)}($,Yt,kt,Qt);for(var Ke,ke,$n=$;$.prev!==$.next;)if(Ke=$.prev,ke=$.next,Qt?mt($,Yt,kt,Qt):W($))Dt.push(Ke.i/Ht),Dt.push($.i/Ht),Dt.push(ke.i/Ht),xt($),$=ke.next,$n=ke.next;else if(($=ke)===$n){de?de===1?Z($=et(lt($),Dt,Ht),Dt,Ht,Yt,kt,Qt,2):de===2&&nt($,Dt,Ht,Yt,kt,Qt):Z(lt($),Dt,Ht,Yt,kt,Qt,1);break}}}function W($){var Dt=$.prev,Ht=$,Yt=$.next;if(rt(Dt,Ht,Yt)>=0)return!1;for(var kt=$.next.next;kt!==$.prev;){if(F(Dt.x,Dt.y,Ht.x,Ht.y,Yt.x,Yt.y,kt.x,kt.y)&&rt(kt.prev,kt,kt.next)>=0)return!1;kt=kt.next}return!0}function mt($,Dt,Ht,Yt){var kt=$.prev,Qt=$,de=$.next;if(rt(kt,Qt,de)>=0)return!1;for(var Ke=kt.x<Qt.x?kt.x<de.x?kt.x:de.x:Qt.x<de.x?Qt.x:de.x,ke=kt.y<Qt.y?kt.y<de.y?kt.y:de.y:Qt.y<de.y?Qt.y:de.y,$n=kt.x>Qt.x?kt.x>de.x?kt.x:de.x:Qt.x>de.x?Qt.x:de.x,Qe=kt.y>Qt.y?kt.y>de.y?kt.y:de.y:Qt.y>de.y?Qt.y:de.y,Kn=Gt(Ke,ke,Dt,Ht,Yt),kn=Gt($n,Qe,Dt,Ht,Yt),qn=$.prevZ,bn=$.nextZ;qn&&qn.z>=Kn&&bn&&bn.z<=kn;){if(qn!==$.prev&&qn!==$.next&&F(kt.x,kt.y,Qt.x,Qt.y,de.x,de.y,qn.x,qn.y)&&rt(qn.prev,qn,qn.next)>=0||(qn=qn.prevZ,bn!==$.prev&&bn!==$.next&&F(kt.x,kt.y,Qt.x,Qt.y,de.x,de.y,bn.x,bn.y)&&rt(bn.prev,bn,bn.next)>=0))return!1;bn=bn.nextZ}for(;qn&&qn.z>=Kn;){if(qn!==$.prev&&qn!==$.next&&F(kt.x,kt.y,Qt.x,Qt.y,de.x,de.y,qn.x,qn.y)&&rt(qn.prev,qn,qn.next)>=0)return!1;qn=qn.prevZ}for(;bn&&bn.z<=kn;){if(bn!==$.prev&&bn!==$.next&&F(kt.x,kt.y,Qt.x,Qt.y,de.x,de.y,bn.x,bn.y)&&rt(bn.prev,bn,bn.next)>=0)return!1;bn=bn.nextZ}return!0}function et($,Dt,Ht){var Yt=$;do{var kt=Yt.prev,Qt=Yt.next.next;!k(kt,Qt)&&X(kt,Yt,Yt.next,Qt)&&ue(kt,Qt)&&ue(Qt,kt)&&(Dt.push(kt.i/Ht),Dt.push(Yt.i/Ht),Dt.push(Qt.i/Ht),xt(Yt),xt(Yt.next),Yt=$=Qt),Yt=Yt.next}while(Yt!==$);return lt(Yt)}function nt($,Dt,Ht,Yt,kt,Qt){var de=$;do{for(var Ke=de.next.next;Ke!==de.prev;){if(de.i!==Ke.i&&z(de,Ke)){var ke=je(de,Ke);return de=lt(de,de.next),ke=lt(ke,ke.next),Z(de,Dt,Ht,Yt,kt,Qt),void Z(ke,Dt,Ht,Yt,kt,Qt)}Ke=Ke.next}de=de.next}while(de!==$)}function ct($,Dt){return $.x-Dt.x}function Nt($,Dt){var Ht=function(Qt,de){var Ke,ke=de,$n=Qt.x,Qe=Qt.y,Kn=-1/0;do{if(Qe<=ke.y&&Qe>=ke.next.y&&ke.next.y!==ke.y){var kn=ke.x+(Qe-ke.y)*(ke.next.x-ke.x)/(ke.next.y-ke.y);if(kn<=$n&&kn>Kn){if(Kn=kn,kn===$n){if(Qe===ke.y)return ke;if(Qe===ke.next.y)return ke.next}Ke=ke.x<ke.next.x?ke:ke.next}}ke=ke.next}while(ke!==de);if(!Ke)return null;if($n===Kn)return Ke;var qn,bn=Ke,Nr=Ke.x,kr=Ke.y,Ir=1/0;ke=Ke;do $n>=ke.x&&ke.x>=Nr&&$n!==ke.x&&F(Qe<kr?$n:Kn,Qe,Nr,kr,Qe<kr?Kn:$n,Qe,ke.x,ke.y)&&(qn=Math.abs(Qe-ke.y)/($n-ke.x),ue(ke,Qt)&&(qn<Ir||qn===Ir&&(ke.x>Ke.x||ke.x===Ke.x&&Xt(Ke,ke)))&&(Ke=ke,Ir=qn)),ke=ke.next;while(ke!==bn);return Ke}($,Dt);if(!Ht)return Dt;var Yt=je(Ht,$),kt=lt(Ht,Ht.next);return lt(Yt,Yt.next),Dt===Ht?kt:Dt}function Xt($,Dt){return rt($.prev,$,Dt.prev)<0&&rt(Dt.next,$,$.next)<0}function Gt($,Dt,Ht,Yt,kt){return($=1431655765&(($=858993459&(($=252645135&(($=16711935&(($=32767*($-Ht)*kt)|$<<8))|$<<4))|$<<2))|$<<1))|(Dt=1431655765&((Dt=858993459&((Dt=252645135&((Dt=16711935&((Dt=32767*(Dt-Yt)*kt)|Dt<<8))|Dt<<4))|Dt<<2))|Dt<<1))<<1}function L($){var Dt=$,Ht=$;do(Dt.x<Ht.x||Dt.x===Ht.x&&Dt.y<Ht.y)&&(Ht=Dt),Dt=Dt.next;while(Dt!==$);return Ht}function F($,Dt,Ht,Yt,kt,Qt,de,Ke){return(kt-de)*(Dt-Ke)-($-de)*(Qt-Ke)>=0&&($-de)*(Yt-Ke)-(Ht-de)*(Dt-Ke)>=0&&(Ht-de)*(Qt-Ke)-(kt-de)*(Yt-Ke)>=0}function z($,Dt){return $.next.i!==Dt.i&&$.prev.i!==Dt.i&&!function(Ht,Yt){var kt=Ht;do{if(kt.i!==Ht.i&&kt.next.i!==Ht.i&&kt.i!==Yt.i&&kt.next.i!==Yt.i&&X(kt,kt.next,Ht,Yt))return!0;kt=kt.next}while(kt!==Ht);return!1}($,Dt)&&(ue($,Dt)&&ue(Dt,$)&&function(Ht,Yt){var kt=Ht,Qt=!1,de=(Ht.x+Yt.x)/2,Ke=(Ht.y+Yt.y)/2;do kt.y>Ke!=kt.next.y>Ke&&kt.next.y!==kt.y&&de<(kt.next.x-kt.x)*(Ke-kt.y)/(kt.next.y-kt.y)+kt.x&&(Qt=!Qt),kt=kt.next;while(kt!==Ht);return Qt}($,Dt)&&(rt($.prev,$,Dt.prev)||rt($,Dt.prev,Dt))||k($,Dt)&&rt($.prev,$,$.next)>0&&rt(Dt.prev,Dt,Dt.next)>0)}function rt($,Dt,Ht){return(Dt.y-$.y)*(Ht.x-Dt.x)-(Dt.x-$.x)*(Ht.y-Dt.y)}function k($,Dt){return $.x===Dt.x&&$.y===Dt.y}function X($,Dt,Ht,Yt){var kt=ht(rt($,Dt,Ht)),Qt=ht(rt($,Dt,Yt)),de=ht(rt(Ht,Yt,$)),Ke=ht(rt(Ht,Yt,Dt));return kt!==Qt&&de!==Ke||!(kt!==0||!tt($,Ht,Dt))||!(Qt!==0||!tt($,Yt,Dt))||!(de!==0||!tt(Ht,$,Yt))||!(Ke!==0||!tt(Ht,Dt,Yt))}function tt($,Dt,Ht){return Dt.x<=Math.max($.x,Ht.x)&&Dt.x>=Math.min($.x,Ht.x)&&Dt.y<=Math.max($.y,Ht.y)&&Dt.y>=Math.min($.y,Ht.y)}function ht($){return $>0?1:$<0?-1:0}function ue($,Dt){return rt($.prev,$,$.next)<0?rt($,Dt,$.next)>=0&&rt($,$.prev,Dt)>=0:rt($,Dt,$.prev)<0||rt($,$.next,Dt)<0}function je($,Dt){var Ht=new zt($.i,$.x,$.y),Yt=new zt(Dt.i,Dt.x,Dt.y),kt=$.next,Qt=Dt.prev;return $.next=Dt,Dt.prev=$,Ht.next=kt,kt.prev=Ht,Yt.next=Ht,Ht.prev=Yt,Qt.next=Yt,Yt.prev=Qt,Yt}function te($,Dt,Ht,Yt){var kt=new zt($,Dt,Ht);return Yt?(kt.next=Yt.next,kt.prev=Yt,Yt.next.prev=kt,Yt.next=kt):(kt.prev=kt,kt.next=kt),kt}function xt($){$.next.prev=$.prev,$.prev.next=$.next,$.prevZ&&($.prevZ.nextZ=$.nextZ),$.nextZ&&($.nextZ.prevZ=$.prevZ)}function zt($,Dt,Ht){this.i=$,this.x=Dt,this.y=Ht,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Vt($,Dt,Ht,Yt){for(var kt=0,Qt=Dt,de=Ht-Yt;Qt<Ht;Qt+=Yt)kt+=($[de]-$[Qt])*($[Qt+1]+$[de+1]),de=Qt;return kt}Ie.exports=J,Ie.exports.default=J,J.deviation=function($,Dt,Ht,Yt){var kt=Dt&&Dt.length,Qt=kt?Dt[0]*Ht:$.length,de=Math.abs(Vt($,0,Qt,Ht));if(kt)for(var Ke=0,ke=Dt.length;Ke<ke;Ke++){var $n=Dt[Ke]*Ht,Qe=Ke<ke-1?Dt[Ke+1]*Ht:$.length;de-=Math.abs(Vt($,$n,Qe,Ht))}var Kn=0;for(Ke=0;Ke<Yt.length;Ke+=3){var kn=Yt[Ke]*Ht,qn=Yt[Ke+1]*Ht,bn=Yt[Ke+2]*Ht;Kn+=Math.abs(($[kn]-$[bn])*($[qn+1]-$[kn+1])-($[kn]-$[qn])*($[bn+1]-$[kn+1]))}return de===0&&Kn===0?0:Math.abs((Kn-de)/de)},J.flatten=function($){for(var Dt=$[0][0].length,Ht={vertices:[],holes:[],dimensions:Dt},Yt=0,kt=0;kt<$.length;kt++){for(var Qt=0;Qt<$[kt].length;Qt++)for(var de=0;de<Dt;de++)Ht.vertices.push($[kt][Qt][de]);kt>0&&(Yt+=$[kt-1].length,Ht.holes.push(Yt))}return Ht}},function(Ie,C,T){Ie.exports=function(J){var G={};function lt(Z){if(G[Z])return G[Z].exports;var W=G[Z]={i:Z,l:!1,exports:{}};return J[Z].call(W.exports,W,W.exports,lt),W.l=!0,W.exports}return lt.m=J,lt.c=G,lt.d=function(Z,W,mt){lt.o(Z,W)||Object.defineProperty(Z,W,{enumerable:!0,get:mt})},lt.r=function(Z){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(Z,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Z,"__esModule",{value:!0})},lt.t=function(Z,W){if(1&W&&(Z=lt(Z)),8&W||4&W&&typeof Z=="object"&&Z&&Z.__esModule)return Z;var mt=Object.create(null);if(lt.r(mt),Object.defineProperty(mt,"default",{enumerable:!0,value:Z}),2&W&&typeof Z!="string")for(var et in Z)lt.d(mt,et,function(nt){return Z[nt]}.bind(null,et));return mt},lt.n=function(Z){var W=Z&&Z.__esModule?function(){return Z.default}:function(){return Z};return lt.d(W,"a",W),W},lt.o=function(Z,W){return Object.prototype.hasOwnProperty.call(Z,W)},lt.p="",lt(lt.s=34)}([function(J,G){J.exports=T(5)},function(J,G){J.exports=`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
}
`},function(J,G){J.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform float lines[26];
varying vec2 vUv;
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float middleAlpha = 0.0;
	float endAlpha = 0.0;
	float headLength = 0.0;
	if (timePercent < 0.5) {
		middleAlpha = 1.0;
		endAlpha = 1.0 - (timePercent / 0.5);
	}
	else {
		middleAlpha = 1.0 - ((timePercent - 0.5) / 0.5);
		endAlpha = 0.0;
	}
	for (int i = 0; i < 26; i++) {
		float halfDis = lines[i] / 2.0;
		float middleX = headLength + halfDis;
		headLength += lines[i];
		if (abs(vUv.x - middleX) <= halfDis) {
			srcColor.a = endAlpha + (((halfDis - abs(vUv.x - middleX)) / halfDis) * (middleAlpha - endAlpha));
			gl_FragColor = blendSrcOver(srcColor, distColor);
			return ;
		}
	}
	gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`},function(J,G){J.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
void main() {
	float maxR;
	float ringR;
	float radiusMin;
	float radiusMax;
	float dist;
	vec2 uv = vec2(vUv.x, vUv.y);
	maxR = length(transform(vec2(1.0, 1.0)));
	ringR = 1.0 / 6.0;
	radiusMin = timePercent * maxR;
	radiusMax = radiusMin + ringR;
	dist = length(transform(uv));
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	if (dist < radiusMin) {
		srcColor.a = 0.0;
	}
	else if ((dist >= radiusMin) && (dist <= radiusMax)) {
		srcColor.a = (dist - radiusMin) / ringR;
	}
	else {
		srcColor.a = 1.0;
	}
	if (timePercent >= 1.0) {
		srcColor.a = 0.0;
	}
	else if (timePercent == 0.0) {
		srcColor.a = 1.0;
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(J,G){J.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
vec2 offset(float progress[4], float band, float amp, float radius) {
	vec2 tc = vUv.xy;
	vec2 uv = vec2(0.0, 0.0);
	vec2 p;
	float len;
	vec2 uv_offset;
	float wave_width = band * radius;
	for (int i = 0; i < 4; i += 1) {
		if (progress[i] == -1.0) {
			continue;
		}
		p = tc - vec2(0.5, 0.5);
		p.x = (p.x * width) / height;
		len = length(p);
		float current_progress = progress[i];
		float current_radius = radius * current_progress;
		float damp_factor = 1.0;
		if (current_progress > .5) {
			damp_factor = (1.0 - current_progress) * 2.0;
		}
		float cut_factor = clamp((wave_width * damp_factor) - abs(current_radius - len), 0.0, 1.0);
		float waves_factor = (4.0 * len) / radius;
		uv_offset = (((p / len) * cos((waves_factor - (current_progress * 10.0)) * 3.14)) * amp) * cut_factor;
		uv += uv_offset;
	}
	return uv;
}
void main() {
	float maxR;
	float ringR;
	float radiusMin;
	float radiusMax;
	float dist;
	float progress[4];
	vec2 uv = vUv.xy;
	vec2 uvOffset = vec2(0.0, 0.0);
	maxR = length(transform(vec2(1.0, 1.0)));
	ringR = 1.0 / 6.0;
	radiusMin = timePercent * maxR;
	radiusMax = radiusMin + ringR;
	dist = length(transform(uv));
	for (int i = 0; i < 4; i++) {
		progress[i] = timePercent + (0.1 * float(i));
		if (progress[i] < 0.0) {
			progress[i] = 0.0;
		}
	}
	uvOffset = offset(progress, 0.2, 0.3, 1.0);
	vec4 srcColor = texture2D(texturePrev, fract(vUv + uvOffset));
	vec4 distColor = texture2D(textureNext, fract(vUv + uvOffset));
	if (dist < radiusMin) {
		srcColor.a = 0.0;
	}
	else if ((dist >= radiusMin) && (dist <= radiusMax)) {
		srcColor.a = (dist - radiusMin) / ringR;
	}
	else {
		srcColor.a = 1.0;
	}
	if (timePercent >= 1.0) {
		srcColor.a = 0.0;
	}
	else if (timePercent == 0.0) {
		srcColor.a = 1.0;
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(J,G){J.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alphaStart = timePercent > 0.5 ? ((timePercent - 0.5) / 0.5) * 1.0 : 1.0;
	float alphaEnd = timePercent < 0.5 ? ((0.5 - timePercent) / 0.5) * 1.0 : 0.0;
	float rectStart = 0.5 * (1.0 - timePercent);
	float rectEnd = rectStart + 0.5;
	if (timePercent <= 0.33) {
		alphaStart = 1.0;
		alphaEnd = (1.0 - (timePercent / 0.33)) * 1.0;
		rectStart = 0.5;
		rectEnd = 1.0;
	}
	else if ((timePercent > 0.33) && (timePercent <= 0.66)) {
		alphaStart = 1.0;
		alphaEnd = 0.0;
		rectEnd = 1.0 - (((timePercent - 0.33) / 0.33) * 0.5);
		rectStart = rectEnd - 0.5;
	}
	else {
		alphaStart = ((1.0 - timePercent) / (1.0 - 0.66)) * 1.0;
		alphaEnd = 0.0;
		rectStart = 0.0;
		rectEnd = 0.5;
	}
	if (vUv.x >= rectEnd) {
		srcColor.a = 0.0;
	}
	else if (vUv.x <= rectStart) {
		srcColor.a = 1.0;
	}
	else {
		srcColor.a = alphaStart - (((vUv.x - rectStart) / 0.5) * (alphaStart - alphaEnd));
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(J,G){J.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform sampler2D dissolveTexture;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 dissolveColor = texture2D(dissolveTexture, vUv);
	if (dissolveColor.r == 0.0) {
		result = srcColor;
	}
	else {
		result = distColor;
	}
	gl_FragColor = result;
}
`},function(J,G){J.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	if (timePercent < 0.5) {
		float stagePercent = timePercent / 0.5;
		result = srcColor + (stagePercent * (1.0 - srcColor));
	}
	else {
		float stagePercent = (timePercent - 0.5) / 0.5;
		result = 1.0 - (stagePercent * (1.0 - distColor));
	}
	gl_FragColor = result;
}
`},function(J,G){J.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	srcColor.a = 1.0 - timePercent;
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float line = interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 3);
	if (vUv.y > line) {
		vec2 uv = vUv.xy;
		uv.y -= line;
		result = texture2D(texturePrev, uv);
	}
	else {
		vec2 uv = vUv.xy;
		uv.y += (1.0 - line);
		result = texture2D(textureNext, uv);
	}
	gl_FragColor = result;
}
`},function(J,G){J.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec2 rectLeft = vec2(0.25, 0.5);
	vec2 rectRight = vec2(0.5, 0.75);
	vec2 alphaLeft = vec2(1.0, 1.0);
	vec2 alphaRight = vec2(1.0, 1.0);
	if (timePercent <= 0.333) {
		alphaLeft.y = 1.0 - (timePercent / 0.333);
		alphaRight.x = 1.0 - (timePercent / 0.333);
	}
	else if ((timePercent <= 0.666) && (timePercent > 0.333)) {
		rectLeft.x -= (((timePercent - 0.333) / 0.333) * 0.25);
		rectLeft.y = rectLeft.x + 0.25;
		rectRight.y += (((timePercent - 0.333) / 0.333) * 0.25);
		rectRight.x = rectRight.y - 0.25;
		alphaLeft.y = 0.0;
		alphaRight.x = 0.0;
	}
	else {
		rectLeft = vec2(0.0, 0.25);
		rectRight = vec2(0.75, 1.0);
		alphaLeft.y = 0.0;
		alphaRight.x = 0.0;
		alphaLeft.x = 1.0 - ((timePercent - 0.666) / (1.0 - 0.666));
		alphaRight.y = 1.0 - ((timePercent - 0.666) / (1.0 - 0.666));
	}
	if ((vUv.x < rectLeft.x) || (vUv.x > rectRight.y)) {
		srcColor.a = 1.0;
	}
	else if ((vUv.x > rectLeft.y) && (vUv.x < rectRight.x)) {
		srcColor.a = 0.0;
	}
	else {
		if ((vUv.x >= rectLeft.x) && (vUv.x <= rectLeft.y)) {
			srcColor.a = alphaLeft.x - (((vUv.x - rectLeft.x) / (rectLeft.y - rectLeft.x)) * (alphaLeft.x - alphaLeft.y));
		}
		else {
			srcColor.a = alphaRight.y - (((rectRight.y - vUv.x) / (rectLeft.y - rectLeft.x)) * (alphaRight.y - alphaRight.x));
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(J,G){J.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 uv4 = vec4(vUv.x, vUv.y, 1.0, 1.0);
	float scale = 1.0;
	float transform = 0.0;
	if (timePercent < 0.5) {
		scale = 1.0 - ((timePercent / 0.5) * 0.05);
		transform = (1.0 - scale) * 0.5;
	}
	else {
		scale = 0.95 + (((timePercent - 0.5) / 0.5) * 0.05);
		transform = (1.0 - scale) * 0.5;
	}
	mat4 matrix = mat4(scale, 0.0, 0.0, 0.0, 0.0, scale, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, transform, transform, 0.0, 1.0);
	vec4 uv = matrix * uv4;
	vec4 srcColor = texture2D(texturePrev, uv.xy);
	vec4 distColor = texture2D(textureNext, uv.xy);
	vec4 result = timePercent < 0.5 ? srcColor : distColor;
	vec3 start;
	vec3 end;
	vec3 white = vec3(1.0, 1.0, 1.0);
	if ((timePercent < 0.25) || (timePercent > 0.75)) {
		result *= 1.0;
	}
	else if ((timePercent >= 0.25) && (timePercent <= 0.5)) {
		if (timePercent <= 0.375) {
			start = result.rgb;
			end = start + (((timePercent - 0.25) / 0.125) * (white - result.rgb));
		}
		else {
			start = result.rgb + (((timePercent - 0.375) / 0.125) * (white - result.rgb));
			end = white;
		}
		result = vec4(start - (vUv.x * (start - end)), result.a);
	}
	else if ((timePercent > 0.5) && (timePercent <= 0.75)) {
		if (timePercent < 0.625) {
			start = white - (((timePercent - 0.5) / 0.125) * (white - result.rgb));
			end = white;
		}
		else {
			start = result.rgb;
			end = white - (((timePercent - 0.625) / 0.125) * (white - result.rgb));
		}
		result = vec4(start - (vUv.x * (start - end)), result.a);
	}
	gl_FragColor = result;
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float line = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	if (vUv.x > line) {
		result = texture2D(textureNext, vUv);
	}
	else {
		vec2 uv = vUv.xy;
		uv.x = 1.0 - (line - vUv.x);
		result = texture2D(texturePrev, uv);
	}
	gl_FragColor = result;
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float line = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 3);
	if (vUv.x > line) {
		vec2 uv = vUv.xy;
		uv.x = vUv.x - line;
		result = texture2D(textureNext, uv);
	}
	else {
		result = texture2D(texturePrev, vUv);
	}
	gl_FragColor = result;
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
mat3 yuv2rgb = mat3(1.0, 0.0, 1.13983, 1.0, -0.39465, -0.58060, 1.0, 2.03211, 0.0);
mat3 rgb2yuv = mat3(0.2126, 0.7152, 0.0722, -0.09991, -0.33609, 0.43600, 0.615, -0.5586, -0.05639);
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec3 result;
	float resultAlpha;
	if (timePercent < 0.5) {
		result = srcColor.rgb * rgb2yuv;
		result.r += interpolationFloat(0.0, 1.0, 0.0, 0.5, timePercent, 0);
		resultAlpha = srcColor.a;
	}
	else {
		result = distColor.rgb * rgb2yuv;
		result.r += interpolationFloat(1.0, 0.0, 0.5, 1.0, timePercent, 0);
		resultAlpha = distColor.a;
	}
	result *= yuv2rgb;
	gl_FragColor = vec4(result.rgb, resultAlpha);
}
`},function(J,G){J.exports=`uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
attribute vec2 segment;
attribute float times;
varying vec2 vUv;
varying float fakePercent;
void main() {
	vUv = uv;
	float width = segmentWidth * horizontalSegments;
	float height = segmentHeight * verticalSegments;
	vec4 newPosition = vec4(position, 1.0);
	vec2 segmentOrigin = vec2(((segment.x + 0.5) * segmentWidth) - (width * 0.5), (height * 0.5) - ((1.0 * (segment.y + 0.5)) * segmentHeight));
	if (timePercent > times) {
		float percent = (timePercent - times) / 0.7;
		if (percent > 1.0) {
			percent = 1.0;
		}
		if (percent > 0.5) {
			percent += 1.0;
		}
		mat4 matrix = mat4(cos((-1.0 * percent) * 3.14), 0.0, sin((-1.0 * percent) * 3.14), 0.0, 0.0, 1.0, 0.0, 0.0, -sin((-1.0 * percent) * 3.14), 0.0, cos((-1.0 * percent) * 3.14), 0.0, 0.0, 0.0, 0.0, 1.0);
		newPosition.x -= segmentOrigin.x;
		newPosition.y -= segmentOrigin.y;
		newPosition = matrix * newPosition;
		newPosition.x += segmentOrigin.x;
		newPosition.y += segmentOrigin.y;
		if (segment.x < (horizontalSegments / 2.0)) {
			fakePercent = percent - (abs((horizontalSegments / 2.0) - segment.x) * (0.25 / horizontalSegments));
		}
		else {
			fakePercent = percent + (abs((horizontalSegments / 2.0) - segment.x) * (0.25 / horizontalSegments));
		}
	}
	if ((timePercent < 0.0001) || (timePercent > 0.9999)) {
		gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
		return ;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(J,G){J.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float fakePercent;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = srcColor;
	if (fakePercent > 0.5) {
		color = distColor;
	}
	if ((fakePercent < 0.5) && (fakePercent > 0.35)) {
		color.a = 0.5;
	}
	gl_FragColor = color;
}
`},function(J,G){J.exports=`#define PI 3.14159265
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
uniform float duration;
attribute vec2 segment;
attribute float times;
varying vec2 vUv;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	vUv = uv;
	float width = segmentWidth * horizontalSegments;
	float height = segmentHeight * verticalSegments;
	mat4 matrix;
	float stagePercent;
	vec4 newPosition = vec4(position, 1.0);
	float selfTimePercent = (timePercent - times) / (4.0 / 5.0);
	if (selfTimePercent < 0.0) {
		selfTimePercent = 0.0;
	}
	else if (selfTimePercent > 1.0) {
		selfTimePercent = 1.0;
	}
	if (selfTimePercent < (2.0 / 5.0)) {
		stagePercent = selfTimePercent / (2.0 / 5.0);
		newPosition.x -= (0.5 * width);
		matrix = rotateY(((-1.0 * stagePercent) * PI) * 0.5);
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
	}
	else if ((selfTimePercent >= (2.0 / 5.0)) && (selfTimePercent < (3.0 / 5.0))) {
		stagePercent = (selfTimePercent - (2.0 / 5.0)) / (1.0 / 5.0);
		newPosition.x -= (0.5 * width);
		newPosition = rotateY((-1.0 * PI) * 0.5) * newPosition;
		matrix = rotateY(((-1.0 * stagePercent) * PI) * 2.0);
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
		newPosition.x -= (width * stagePercent);
	}
	else {
		float offset = (((newPosition.x + (0.5 * width)) / width) * 2.0) / 5.0;
		stagePercent = (selfTimePercent - (1.0 / 5.0)) / ((2.0 / 5.0) + offset);
		if (stagePercent > 1.0) {
			stagePercent = 1.0;
		}
		vec4 vvUvv = vec4(vUv.x - 0.5, vUv.y - 0.5, 0.0, 1.0);
		vvUvv = rotateY(-1.0 * PI) * vvUvv;
		vUv = vvUvv.xy + 0.5;
		newPosition.x -= (0.5 * width);
		matrix = rotateY((((-1.0 * stagePercent) * PI) * 0.5) - (PI * 2.5));
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
		newPosition.x -= width;
	}
	if ((timePercent < 0.0001) || (timePercent > 0.9999)) {
		vUv = uv;
		gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
		return ;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(J,G){J.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = srcColor;
	if (timePercent > 0.5) {
		color = distColor;
	}
	if (timePercent < 0.0001) {
		color = srcColor;
	}
	else if (timePercent > 0.9999) {
		color = distColor;
	}
	gl_FragColor = color;
}
`},function(J,G){J.exports=`#define PI 3.14159265
attribute float index;
attribute float type;
attribute float delay;
uniform float timePercent;
uniform float segmentWidth;
uniform float segments;
varying vec2 vUv;
varying float vType;
varying float rotatePercent;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	vUv = uv;
	vType = type;
	vec4 newPosition = vec4(position, 1.0);
	float selfPercent = (timePercent - delay) / 0.7;
	rotatePercent = selfPercent;
	if (selfPercent < 0.0) {
		selfPercent = 0.0;
	}
	else if (selfPercent > 1.0) {
		selfPercent = 1.0;
	}
	float offsetX = ((segments * segmentWidth) * 0.5) - ((index + 0.5) * segmentWidth);
	float offsetZ = segmentWidth * 0.5;
	newPosition.x += offsetX;
	newPosition.z += offsetZ;
	newPosition.x *= (0.9 + ((abs(timePercent - 0.5) / 0.5) * 0.1));
	newPosition.z *= (0.9 + ((abs(timePercent - 0.5) / 0.5) * 0.1));
	newPosition = rotateY((PI * 0.5) * selfPercent) * newPosition;
	newPosition.x -= offsetX;
	newPosition.z -= offsetZ;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(J,G){J.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float vType;
varying float rotatePercent;
mat3 yuv2rgb = mat3(1.0, 0.0, 1.13983, 1.0, -0.39465, -0.58060, 1.0, 2.03211, 0.0);
mat3 rgb2yuv = mat3(0.2126, 0.7152, 0.0722, -0.09991, -0.33609, 0.43600, 0.615, -0.5586, -0.05639);
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec3 srcYuv;
	vec3 distYuv;
	if (rotatePercent < 0.5) {
		distYuv = distColor.rgb * rgb2yuv;
		distYuv.r *= (1.0 - (abs(rotatePercent - 0.5) / 0.5));
		distColor = vec4(distYuv * yuv2rgb, distColor.a);
	}
	else {
		srcYuv = distColor.rgb * rgb2yuv;
		srcYuv.r *= (abs(rotatePercent - 0.5) / 0.5);
		srcColor = vec4(srcYuv * yuv2rgb, srcColor.a);
	}
	vec4 color = vType < 0.5 ? srcColor : distColor;
	gl_FragColor = color;
}
`},function(J,G){J.exports=`float easeInFloat(float t, float b, float c, float d) {
	t = t / d;
	return ((c * t) * t) + b;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.141592653
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
attribute float isLeft;
varying vec2 vUv;
varying vec4 shadow;
void main() {
	vUv = uv;
	float scaleX;
	float transform;
	float displacement;
	vec4 newPosition = vec4(position, 1.0);
	vec4 glPosition = (projectionMatrix * modelViewMatrix) * newPosition;
	float crestCount = 24.0;
	float width = horizontalSegments * segmentWidth;
	float height = verticalSegments * segmentHeight;
	float heightFactor = (newPosition.y + (height * 0.5)) / height;
	float scaleY = interpolationFloat(1.0, 1.05, 0.0, 0.11, timePercent, 0);
	newPosition.y += (height * 0.5);
	newPosition.y *= scaleY;
	newPosition.y -= (height * 0.5);
	newPosition.y += 10.0;
	if ((timePercent > 0.0) && (timePercent < 0.333)) {
		float delay = (1.0 - heightFactor) * 0.1;
		scaleX = interpolationFloat(1.0, 0.5, 0.0 + delay, 0.333, timePercent, 1);
	}
	else if ((timePercent >= 0.333) && (timePercent < 0.5)) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.5, 0.25, 0.333, 0.5, timePercent, 2);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop - incr;
	}
	else if ((timePercent >= 0.5) && (timePercent < 0.583)) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.25, 0.5, 0.5, 0.583, timePercent, 1);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop - incr;
	}
	else if (timePercent >= 0.583) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.5, 0.75, 0.583, 0.666, timePercent, 2);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop + incr;
	}
	if (timePercent > 0.583) {
		displacement = (isLeft < 0.5 ? 1.0 : -1.0) * interpolationFloat(0.0, width / 2.0, 0.583, 1.0, timePercent, 0);
	}
	float ampTop = interpolationFloat(0.0, 1.0, 0.0, 0.11, timePercent, 0);
	float ampBottom = interpolationFloat(0.0, 1.0, 0.11, 0.22, timePercent, 0);
	float amp = ampBottom + (heightFactor * abs(ampBottom - ampTop));
	float foo = newPosition.x * ((crestCount * PI) / width);
	newPosition.z = (amp * cos(foo + (PI / 2.0))) * 20.0;
	transform = (isLeft < 0.5 ? -1.0 : 1.0) * (width * 0.5);
	newPosition.x += transform;
	newPosition.x *= scaleX;
	newPosition.x -= transform;
	newPosition.x += displacement;
	shadow = vec4(0.0, 0.0, 0.0, 0.0);
	if (newPosition.z < 15.0) {
		float alpha = 0.3 * (1.0 - ((newPosition.z + 20.0) / 35.0));
		shadow.a = alpha * amp;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(J,G){J.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying vec4 shadow;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = blendSrcOver(shadow, srcColor);
	gl_FragColor = color;
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265
uniform float timePercent;
uniform float aCoefficient;
uniform float zCurveLimit;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
varying vec2 vUv;
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float curve;
	float aStart = interpolationFloat(0.00000009, aCoefficient, 0.0, 0.5, timePercent, 0);
	float aEnd = 0.0000009;
	float zStart = interpolationFloat(0.0, zCurveLimit, 0.0, 0.5, timePercent, 0);
	float zEnd = 0.0;
	float a = interpolationFloat(aStart, aEnd, 0.0, halfWidth * 2.0, newPosition.x + halfWidth, 0);
	float z = interpolationFloat(zStart, zEnd, 0.0, halfWidth * 2.0, newPosition.x + halfWidth, 0);
	newPosition.z -= (((-a * newPosition.y) * newPosition.y) + z);
	float scaleYStart = interpolationFloat(1.0, 0.8, 0.0, 0.5, timePercent, 0);
	float scaleYEnd = 1.0;
	float scaleY = interpolationFloat(scaleYStart, scaleYEnd, 0.0, halfWidth * 2.0, newPosition.x + halfWidth, 0);
	newPosition.y += halfHeight;
	newPosition.y *= scaleY;
	float angle = interpolationFloat(0.0, -((2.0 * PI) / 3.0), 0.111, 1.0, timePercent, 1);
	mat4 rotateX = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), sin(angle), 0.0, 0.0, -sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	newPosition = rotateX * newPosition;
	newPosition.y -= halfHeight;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
	vec4 shadow = vec4(0.0, 0.0, 0.0, alpha);
	gl_FragColor = blendSrcOver(shadow, srcColor);
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
varying vec2 vUv;
varying float shadowAlpha;
mat2 rotateOrigin(float angle) {
	return mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec2 shadowPosition = vec2(position.xy);
	float rotateAngle = PI * 0.27;
	float min_r = halfWidth * 0.05;
	shadowPosition = rotateOrigin(rotateAngle) * shadowPosition;
	vec4 newPosition = vec4(shadowPosition.xy, position.z, 1.0);
	float line = interpolationFloat(0.0, halfWidth * 2.8, 0.0, 1.0, timePercent, 1);
	float dis2BaseLine = halfWidth - newPosition.x;
	float dis2Line = line - dis2BaseLine;
	float L = line <= (halfWidth * 2.0) ? line : halfWidth * 2.0;
	float r = L / PI;
	r = r < min_r ? min_r : r;
	float angle = dis2Line / r;
	if (((dis2Line > 0.0) && (dis2Line < (line * 0.5))) && (r > min_r)) {
		shadowAlpha = interpolationFloat(0.0, 0.3, 0.0, line * 0.5, dis2Line, 0);
	}
	else {
		shadowAlpha = 0.0;
	}
	if (dis2BaseLine < line) {
		newPosition.x = ((sin(angle) * r) + halfWidth) - line;
		newPosition.z = (r - (cos(angle) * r)) * 0.5;
	}
	vec2 finalPosition = vec2(newPosition.xy);
	finalPosition = rotateOrigin(-rotateAngle) * finalPosition;
	gl_Position = (projectionMatrix * modelViewMatrix) * vec4(finalPosition.xy, newPosition.z, 1.0);
}
`},function(J,G){J.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float shadowAlpha;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 shadow = vec4(0.0, 0.0, 0.0, shadowAlpha);
	gl_FragColor = blendSrcOver(shadow, srcColor);
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
varying vec2 vUv;
mat4 rotateX(float angle) {
	return mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), sin(angle), 0.0, 0.0, -sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float delay = interpolationFloat(0.0, 0.08, 0.0, halfWidth * 2.0, halfWidth + newPosition.x, 0);
	float arc = halfHeight - newPosition.y;
	float L;
	if (timePercent < 0.8) {
		L = interpolationFloat(halfHeight * 4.0, halfHeight * 22.0, 0.3 + delay, 0.8, timePercent, 0);
	}
	else {
		L = interpolationFloat(halfHeight * 22.0, halfHeight * 300.0, 0.8, 1.0, timePercent, 0);
	}
	float r = L / (2.0 * PI);
	float angle = PI - (arc / r);
	float y = sin(angle) * r;
	float z = cos(angle) * r;
	newPosition.y = halfHeight - y;
	newPosition.z = (z + r) * 0.45;
	float rotateAngle = interpolationFloat(-PI * 0.5, 0.0, 0.0 + delay, 0.4, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(rotateAngle) * newPosition;
	newPosition.y += halfHeight;
	float backRotate1 = interpolationFloat(0.0, PI * 0.03, 0.75, 0.9, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(backRotate1) * newPosition;
	newPosition.y += halfHeight;
	float backRotate2 = interpolationFloat(0.0, -PI * 0.03, 0.8, 1.0, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(backRotate2) * newPosition;
	newPosition.y += halfHeight;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
	vec4 shadow = vec4(0.0, 0.0, 0.0, 0.0);
	gl_FragColor = blendSrcOver(shadow, distColor);
}
`},function(J,G){J.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float shadowAngle = PI / 6.0;
	float clockAngle;
	vec2 a;
	vec2 b = transform(vUv);
	float angle;
	if (timePercent < 0.5) {
		a = vec2(0.0, 0.5);
		clockAngle = interpolationFloat(0.0, PI, 0.0, 0.5, timePercent, 0);
		if (b.x > 0.0) {
			angle = acos(((a.x * b.x) + (a.y * b.y)) / (sqrt((a.x * a.x) + (a.y * a.y)) * sqrt((b.x * b.x) + (b.y * b.y))));
			if (angle < clockAngle) {
				if (angle > (clockAngle - shadowAngle)) {
					float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
					srcColor.a = shadowAlpha;
				}
				else {
					srcColor.a = 0.0;
				}
			}
		}
		else {
			srcColor.a = 1.0;
		}
	}
	else {
		a = vec2(0.0, -0.5);
		clockAngle = interpolationFloat(0.0, PI + shadowAngle, 0.5, 1.0, timePercent, 0);
		if (b.x <= 0.0) {
			angle = acos(((a.x * b.x) + (a.y * b.y)) / (sqrt((a.x * a.x) + (a.y * a.y)) * sqrt((b.x * b.x) + (b.y * b.y))));
			if (angle < clockAngle) {
				if (angle > (clockAngle - shadowAngle)) {
					float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
					srcColor.a = shadowAlpha;
				}
				else {
					srcColor.a = 0.0;
				}
			}
		}
		else {
			srcColor.a = 0.0;
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
void main() {
	vec2 uv = vUv;
	bool useSrc = false;
	vec2 row;
	float delay = 0.02;
	for (int i = 0; i < 7; i++) {
		float fi = float(i);
		row.r = (fi * 1.0) / 7.0;
		row.g = (float(i + 1) * 1.0) / 7.0;
		if ((vUv.y <= row.g) && (vUv.y > row.r)) {
			if ((i % 2) == 0) {
				float x = interpolationFloat(0.0, 1.0, delay * fi, (delay * fi) + 0.86, timePercent, 1);
				if (vUv.x < x) {
					useSrc = false;
				}
				else {
					uv.x -= x;
					useSrc = true;
				}
			}
			else {
				float x = interpolationFloat(1.0, 0.0, delay * fi, (delay * fi) + 0.86, timePercent, 1);
				if (vUv.x < x) {
					uv.x = (1.0 - x) + uv.x;
					useSrc = true;
				}
				else {
					useSrc = false;
				}
			}
			break;
		}
	}
	vec4 srcColor = texture2D(texturePrev, uv);
	vec4 distColor = texture2D(textureNext, uv);
	gl_FragColor = useSrc ? srcColor : distColor;
}
`},function(J,G){J.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
void main() {
	vec2 uvSrc = vUv;
	vec2 uvDist = vUv;
	float scaleSrc = interpolationFloat(1.0, 0.1, 0.0, 1.0, timePercent, 0);
	float scaleDist = interpolationFloat(2.0, 1.0, 0.0, 1.0, timePercent, 0);
	uvSrc -= 0.5;
	uvSrc *= scaleSrc;
	uvSrc += 0.5;
	uvDist -= 0.5;
	uvDist *= scaleDist;
	uvDist += 0.5;
	vec4 srcColor = texture2D(texturePrev, uvSrc);
	srcColor.a = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 0);
	vec4 distColor;
	if ((((uvDist.x > 1.0) || (uvDist.x < 0.0)) || (uvDist.y > 1.0)) || (uvDist.y < 0.0)) {
		distColor = vec4(0.0, 0.0, 0.0, 1.0);
	}
	else {
		distColor = texture2D(textureNext, uvDist);
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(J,G){J.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
varying vec2 vUv;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float stageOneAngle = PI / 14.0;
	float stageTwoAngle = (PI * 12.0) / 14.0;
	float stage_1 = 0.1;
	float stage_2 = 0.8;
	if (timePercent < 0.5) {
		newPosition.z = interpolationFloat(0.0, -100.0, 0.0, 0.5, timePercent, 0);
	}
	else {
		newPosition.z = interpolationFloat(-100.0, 0.0, 0.5, 1.0, timePercent, 0);
	}
	if (timePercent < stage_1) {
		float angle = interpolationFloat(0.0, stageOneAngle, 0.0, stage_1, timePercent, 0);
		newPosition.x += halfWidth;
		newPosition *= rotateY(angle);
		newPosition.x -= halfWidth;
	}
	else if ((timePercent >= stage_1) && (timePercent < stage_2)) {
		if (timePercent > 0.5) {
			newPosition *= rotateY(PI);
		}
		float offset = halfWidth - (sin((PI * 0.5) - stageOneAngle) * halfWidth);
		float angle = interpolationFloat(0.0, stageTwoAngle, stage_1, stage_2, timePercent, 0);
		newPosition *= rotateY(angle);
		newPosition.x += halfWidth;
		newPosition *= rotateY(stageOneAngle);
		newPosition.x -= halfWidth;
		newPosition.x += interpolationFloat(0.0, 2.0 * offset, stage_1, stage_2, timePercent, 0);
	}
	else {
		float angle = interpolationFloat(-stageOneAngle, 0.0, stage_2, 1.0, timePercent, 0);
		newPosition.x -= halfWidth;
		newPosition *= rotateY(angle);
		newPosition.x += halfWidth;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(J,G){J.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	gl_FragColor = timePercent < 0.5 ? srcColor : distColor;
}
`},function(J,G,lt){lt.r(G),lt.d(G,"TransactionPlayer",function(){return Yo});var Z=lt(0);class W{constructor(){this.camera=new Z.OrthographicCamera(10,10,10,10),this.camera.position.z=100,this.camera.position.x=0,this.camera.position.y=0}focus(Pt,xe){Pt.position.z=50}updateAspect(Pt,xe){this.camera.left=-1*Pt/2,this.camera.right=Pt/2,this.camera.top=xe/2,this.camera.bottom=-1*xe/2,this.camera.updateProjectionMatrix()}}class mt{constructor(){this.camera=new W,this.mesh=new Z.Mesh,this.material=null,this.geometry=null}addObjects(Pt){this.mesh.position.z=50,Pt.add(this.mesh)}setTexture(Pt,xe,Fe,$e){this.camera.updateAspect(Fe,$e),this.geometry=new Z.PlaneGeometry(Fe,$e,1,1),this.material=new Z.ShaderMaterial({fragmentShader:this.fragmentShader,vertexShader:`
varying vec2 vUv;
void main(){
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`}),this.material.uniforms={width:{value:Fe},height:{value:$e},texturePrev:{value:Pt},textureNext:{value:xe},timePercent:{value:0}},this.mesh.geometry=this.geometry,this.mesh.material=this.material}updateAnimation(Pt){this.material.uniforms.timePercent.value=Pt}dispose(){var Pt,xe;(Pt=this.geometry)===null||Pt===void 0||Pt.dispose(),(xe=this.material)===null||xe===void 0||xe.dispose()}}var et=lt(1),nt=lt.n(et),ct=lt(2),Nt=lt.n(ct),Xt=lt(3),Gt=lt.n(Xt),L=lt(4),F=lt.n(L),z=lt(5),rt=lt.n(z),k=lt(6),X=lt.n(k),tt=lt(7),ht=lt.n(tt),ue=lt(8),je=lt.n(ue),te=lt(9),xt=lt.n(te),zt=lt(10),Vt=lt.n(zt),$=lt(11),Dt=lt.n($),Ht=lt(12),Yt=lt.n(Ht),kt=lt(13),Qt=lt.n(kt),de=lt(14),Ke=lt.n(de);class ke{constructor(){this.camera=new Z.PerspectiveCamera(60,1,1,2e3),this.camera.position.z=1e3,this.camera.position.x=0,this.camera.position.y=0}updateAspect(Pt,xe){this.camera.aspect=Pt/xe,this.camera.updateProjectionMatrix()}focus(Pt,xe){const Fe=.5*xe/Math.tan(Math.PI/6);Pt.position.z=1e3-Fe}}class $n{constructor(){this.geometry=new Z.BufferGeometry,this.material=null,this.camera=new ke,this.mesh=new Z.Mesh,this.textureWidth=0,this.textureHeight=0,this.prevTexture=new Z.Texture,this.nextTexture=new Z.Texture}horizontalSegments(){return Math.ceil(this.verticalSegments*this.textureWidth/this.textureHeight)}initMesh(Pt,xe){const Fe=[],$e=[],un=[],Rn=this.verticalSegments,_n=this.horizontalSegments(),Sn=Pt/2,vr=xe/2,_r=Pt/_n,on=xe/Rn,ln=this.extraAttributes(),or=Object.keys(ln),vi=or.reduce((Zn,Fr)=>(Zn[Fr]=[],Zn),{});for(let Zn=0;Zn<Rn;Zn++){const Fr=Zn*on-vr;for(let hi=0;hi<_n;hi++){const Er=hi*_r-Sn;$e.push(Er,-Fr,0),un.push(1*hi/_n,1-1*Zn/Rn),or.forEach($r=>vi[$r].push(...ln[$r].generator(Zn,hi))),$e.push(Er+_r,-Fr,0),un.push(1*(hi+1)/_n,1-1*Zn/Rn),or.forEach($r=>vi[$r].push(...ln[$r].generator(Zn,hi))),$e.push(Er,-Fr-on,0),un.push(1*hi/_n,1-1*(Zn+1)/Rn),or.forEach($r=>vi[$r].push(...ln[$r].generator(Zn,hi))),$e.push(Er+_r,-Fr-on,0),un.push(1*(hi+1)/_n,1-1*(Zn+1)/Rn),or.forEach($r=>vi[$r].push(...ln[$r].generator(Zn,hi)))}}for(let Zn=0;Zn<Rn*_n;Zn++){const Fr=4*Zn,hi=Fr+1,Er=Fr+2,$r=Fr+3;Fe.push(hi,Fr,$r),Fe.push(Fr,Er,$r)}return this.geometry.setIndex(Fe),this.geometry.setAttribute("position",new Z.Float32BufferAttribute($e,3)),this.geometry.setAttribute("uv",new Z.Float32BufferAttribute(new Float32Array(un),2)),or.forEach(Zn=>{this.geometry.setAttribute(Zn,new Z.Float32BufferAttribute(new Float32Array(vi[Zn]),ln[Zn].itemSize))}),{verticalSegments:Rn,horizontalSegments:_n,segmentWidth:_r,segmentHeight:on}}initObject(){this.material=new Z.ShaderMaterial({fragmentShader:this.fragmentShader,vertexShader:this.vertexShader,side:Z.DoubleSide})}setTexture(Pt,xe,Fe,$e){this.textureHeight=$e,this.textureWidth=Fe,this.prevTexture=Pt,this.nextTexture=xe,this.initObject();const{verticalSegments:un,horizontalSegments:Rn,segmentWidth:_n,segmentHeight:Sn}=this.initMesh(Fe,$e);this.material.uniforms={segmentWidth:{value:_n},segmentHeight:{value:Sn},verticalSegments:{value:un},horizontalSegments:{value:Rn},timePercent:{value:0},texturePrev:{value:Pt},textureNext:{value:xe}},this.mesh.geometry=this.geometry,this.camera.updateAspect(Fe,$e),this.camera.focus(this.mesh,$e),this.material.transparent=!0,this.mesh.material=this.material}addObjects(Pt){Pt.add(this.mesh)}updateAnimation(Pt){this.material.uniforms.timePercent.value=Pt}dispose(){var Pt,xe;(Pt=this.geometry)===null||Pt===void 0||Pt.dispose(),(xe=this.material)===null||xe===void 0||xe.dispose()}}var Qe=lt(15),Kn=lt.n(Qe),kn=lt(16),qn=lt.n(kn),bn=lt(17),Nr=lt.n(bn),kr=lt(18),Ir=lt.n(kr),Jr=lt(19),Pr=lt.n(Jr),Ur=lt(20),Xi=lt.n(Ur),Sr=lt(21),Lr=lt.n(Sr),mi=lt(22),ws=lt.n(mi),Ln=lt(23),so=lt.n(Ln),$i=lt(24),yo=lt.n($i),Q=lt(25),ft=lt.n(Q),dt=lt(26),Lt=lt.n(dt);class Ct extends $n{constructor(){super(...arguments),this.duration=1250,this.fragmentShader=Lt.a,this.vertexShader=ft.a,this.verticalSegments=100}addObjects(Pt){Pt.add(this.mesh),Pt.background=this.nextTexture}extraAttributes(){return{}}}var It=lt(27),Zt=lt.n(It),re=lt(28),pe=lt.n(re),Kt=lt(29),qe=lt.n(Kt),ie=lt(30),Pn=lt.n(ie),ar=lt(31),Un=lt.n(ar),jr=lt(32),Xo=lt.n(jr),gi=lt(33),Qa=lt.n(gi);const Oo=new Z.Vector3(0,-0,0).multiplyScalar(.1);class Ma{constructor(Pt,xe,Fe,$e,un){this.position=new Z.Vector3,this.previous=new Z.Vector3,this.original=new Z.Vector3,this.a=new Z.Vector3(0,0,0),this.mass=$e,this.invMass=1/$e,this.tmp=new Z.Vector3,this.tmp2=new Z.Vector3,un(Pt,xe,this.position),un(Pt,xe,this.previous),un(Pt,xe,this.original)}addForce(Pt){this.a.add(this.tmp2.copy(Pt).multiplyScalar(this.invMass))}integrate(Pt,xe,Fe){const $e=.25*Math.PI,un=.25*-Math.PI,Rn=new Z.Matrix3,_n=new Z.Matrix3;Rn.set(Math.cos($e),-Math.sin($e),0,Math.sin($e),Math.cos($e),0,0,0,1),_n.set(Math.cos(un),-Math.sin(un),0,Math.sin(un),Math.cos(un),0,0,0,1);const Sn=this.tmp.subVectors(this.position,this.previous);Sn.multiplyScalar(.97).add(this.position),Sn.add(this.a.multiplyScalar(Pt)),this.tmp=this.previous,this.previous=this.position,this.position=Sn,this.a.set(0,0,0)}}class ea{constructor(Pt,xe,Fe){this.width=Pt,this.height=xe;const $e=[],un=[];for(let _n=0;_n<=xe;_n++)for(let Sn=0;Sn<=Pt;Sn++)$e.push(new Ma(Sn/Pt,_n/xe,0,.1,Fe));for(let _n=0;_n<xe;_n++)for(let Sn=0;Sn<Pt;Sn++)un.push([$e[Rn(Sn,_n)],$e[Rn(Sn,_n+1)],25]),un.push([$e[Rn(Sn,_n)],$e[Rn(Sn+1,_n)],25]);for(let _n=Pt,Sn=0;Sn<xe;Sn++)un.push([$e[Rn(_n,Sn)],$e[Rn(_n,Sn+1)],25]);for(let _n=xe,Sn=0;Sn<Pt;Sn++)un.push([$e[Rn(Sn,_n)],$e[Rn(Sn+1,_n)],25]);function Rn(_n,Sn){return _n+Sn*(Pt+1)}this.particles=$e,this.constraints=un,this.index=Rn}}const Aa={RandomLines:class extends mt{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Nt.a}genRandomLines(){let jt=[1];for(let xe=20;xe--;){let Fe=jt.sort((Sn,vr)=>vr-Sn)[0],$e=jt.indexOf(Fe),un=Math.random(),Rn=Fe*un,_n=Fe*(1-un);jt.splice($e,1),jt.push(Rn,_n)}let Pt=jt.length;for(;Pt;){let xe=Math.floor(Math.random()*Pt--);[jt[xe],jt[Pt]]=[jt[Pt],jt[xe]]}return jt}setTexture(jt,Pt,xe,Fe){super.setTexture(jt,Pt,xe,Fe),this.material.uniforms.lines={value:this.genRandomLines()},this.material.vertexShader=nt.a}},Shape:class extends mt{constructor(){super(...arguments),this.duration=800,this.fragmentShader=Gt.a}},Ripples:class extends mt{constructor(){super(...arguments),this.duration=1400,this.fragmentShader=F.a}},Erase:class extends mt{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=rt.a}},Dissolve:class extends mt{constructor(){super(...arguments),this.duration=1200,this.fragmentShader=X.a,this.dissolveIndices={}}random40(){return Math.ceil(40*Math.random())}setTexture(jt,Pt,xe,Fe){super.setTexture(jt,Pt,xe,Fe);for(let $e=0;$e<1600;$e++){let un=this.random40(),Rn=this.random40();for(;this.dissolveIndices[`${un}_${Rn}`]!==void 0;)un=this.random40(),Rn=this.random40();this.dissolveIndices[`${un}_${Rn}`]=0}this.material.uniforms.dissolveTexture={value:this.genDissolveToTexture()}}genDissolveToTexture(){var jt=new Uint8Array(4800);for(let Pt=0;Pt<1600;Pt++){const xe=Pt%40+1,Fe=Math.floor(Pt/40)+1,$e=3*Pt;this.dissolveIndices[`${xe}_${Fe}`]===0?(jt[$e]=0,jt[$e+1]=0,jt[$e+2]=0):(jt[$e]=255,jt[$e+1]=255,jt[$e+2]=255)}return new Z.DataTexture(jt,40,40,Z.RGBFormat)}updateAnimation(jt){const Pt=1600*jt-Object.keys(this.dissolveIndices).filter(xe=>this.dissolveIndices[xe]===1).length;for(let xe=0;xe<Pt;xe++){const Fe=Object.keys(this.dissolveIndices).filter(un=>this.dissolveIndices[un]===0),$e=Math.ceil(Math.random()*Fe.length)-1;this.dissolveIndices[Fe[$e]]=1}this.material.uniforms.dissolveTexture.value=this.genDissolveToTexture()}},Smooth:class extends mt{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=ht.a}},FadeInOut:class extends mt{constructor(){super(...arguments),this.duration=700,this.fragmentShader=je.a}},Push:class extends mt{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=xt.a}},Separation:class extends mt{constructor(){super(...arguments),this.duration=1500,this.fragmentShader=Vt.a}},Display:class extends mt{constructor(){super(...arguments),this.duration=3400,this.fragmentShader=Dt.a}},Uncover:class extends mt{constructor(){super(...arguments),this.duration=750,this.fragmentShader=Yt.a}},Cover:class extends mt{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Qt.a}},Flash:class extends mt{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Ke.a}},Checkerboard:class extends $n{constructor(){super(...arguments),this.duration=2500,this.fragmentShader=qn.a,this.vertexShader=Kn.a,this.vIndex="",this.delay=0,this.verticalSegments=5}extraAttributes(){return{times:{itemSize:1,generator:(jt,Pt)=>(this.vIndex!==`${jt}${Pt}`&&(this.delay=.3*Math.random(),this.vIndex=`${jt}${Pt}`),[this.delay])},segment:{itemSize:2,generator:(jt,Pt)=>[Pt,jt]}}}},Vortex:class{constructor(){this.duration=4e3,this.geometry=new Z.BufferGeometry,this.material=new Z.ShaderMaterial({fragmentShader:Ir.a,vertexShader:Nr.a,side:Z.DoubleSide}),this.camera=new ke,this.mesh=new Z.Mesh}initData(jt,Pt){const xe=[],Fe=[],$e=[],un=[],Rn=[],_n=[],Sn=Math.ceil(124*jt/Pt),vr=jt/2,_r=Pt/2,on=jt/Sn,ln=Pt/124;for(let or=0;or<124;or++){const vi=or*ln-_r;for(let Zn=0;Zn<Sn;Zn++){const Fr=Zn*on-vr,hi=Math.ceil((Zn+1)/((Sn+1)/12)),Er=.4/hi,$r=(hi-1)*Er+Math.random()*Er;Fe.push(Fr,-vi,0),un.push(1*Zn/Sn,1-1*or/124),$e.push(0,0,1),Rn.push(Zn,or),_n.push($r),Fe.push(Fr+on,-vi,0),un.push(1*(Zn+1)/Sn,1-1*or/124),$e.push(0,0,1),Rn.push(Zn,or),_n.push($r),Fe.push(Fr,-vi-ln,0),un.push(1*Zn/Sn,1-1*(or+1)/124),$e.push(0,0,1),Rn.push(Zn,or),_n.push($r),Fe.push(Fr+on,-vi-ln,0),un.push(1*(Zn+1)/Sn,1-1*(or+1)/124),$e.push(0,0,1),Rn.push(Zn,or),_n.push($r)}}for(let or=0;or<124*Sn;or++){const vi=4*or,Zn=vi+1,Fr=vi+2,hi=vi+3;xe.push(Zn,vi,hi),xe.push(vi,Fr,hi)}return this.geometry.setIndex(xe),this.geometry.setAttribute("position",new Z.Float32BufferAttribute(Fe,3)),this.geometry.setAttribute("normal",new Z.Float32BufferAttribute($e,3)),this.geometry.setAttribute("uv",new Z.Float32BufferAttribute(new Float32Array(un),2)),this.geometry.setAttribute("segment",new Z.Float32BufferAttribute(new Float32Array(Rn),2)),this.geometry.setAttribute("times",new Z.Float32BufferAttribute(new Float32Array(_n),1)),{verticalSegments:124,horizontalSegments:Sn,segmentWidth:on,segmentHeight:ln}}setTexture(jt,Pt){const{width:xe,height:Fe}=jt.image,{verticalSegments:$e,horizontalSegments:un,segmentWidth:Rn,segmentHeight:_n}=this.initData(xe,Fe);this.material.uniforms={duration:{value:this.duration},segmentWidth:{value:Rn},segmentHeight:{value:_n},verticalSegments:{value:$e},horizontalSegments:{value:un},timePercent:{value:0},texturePrev:{value:jt},textureNext:{value:Pt}},this.camera.updateAspect(xe,Fe),this.camera.focus(this.mesh,Fe),this.mesh.geometry=this.geometry,new Z.MeshPhongMaterial({side:Z.DoubleSide,vertexColors:!0}).wireframe=!0,this.material.transparent=!0,this.mesh.material=this.material,console.log(Z)}addObjects(jt){jt.add(this.mesh)}updateAnimation(jt){this.material.uniforms.timePercent.value=jt}dispose(){var jt,Pt;(jt=this.geometry)===null||jt===void 0||jt.dispose(),(Pt=this.material)===null||Pt===void 0||Pt.dispose()}},WindowShades:class{constructor(){this.duration=1600,this.geometry=new Z.BufferGeometry,this.material=new Z.ShaderMaterial({fragmentShader:Xi.a,vertexShader:Pr.a,side:Z.DoubleSide}),this.horizontalSegments=16,this.meshToCameraDistance=0,this.camera=new ke,this.mesh=new Z.Mesh}initData(jt,Pt){const xe=[],Fe=[],$e=[],un=[],Rn=[],_n=[],Sn=jt/2,vr=Pt/2,_r=jt/this.horizontalSegments;for(let on=0;on<this.horizontalSegments;on++){const ln=Math.abs(on-Math.ceil(this.horizontalSegments/2))*(.3/Math.ceil(this.horizontalSegments/2)),or=on*_r-Sn;Fe.push(or,vr,0),$e.push(0),un.push(on/this.horizontalSegments,1),Rn.push(on),_n.push(ln),Fe.push(or+_r,vr,0),$e.push(0),un.push((on+1)/this.horizontalSegments,1),Rn.push(on),_n.push(ln),Fe.push(or,-1*vr,0),$e.push(0),un.push(on/this.horizontalSegments,0),Rn.push(on),_n.push(ln),Fe.push(or+_r,-1*vr,0),un.push((on+1)/this.horizontalSegments,0),$e.push(0),Rn.push(on),_n.push(ln),Fe.push(or+_r,vr,0),$e.push(1),un.push(on/this.horizontalSegments,1),Rn.push(on),_n.push(ln),Fe.push(or+_r,vr,-1*_r),$e.push(1),un.push((on+1)/this.horizontalSegments,1),Rn.push(on),_n.push(ln),Fe.push(or+_r,-1*vr,0),$e.push(1),un.push(on/this.horizontalSegments,0),Rn.push(on),_n.push(ln),Fe.push(or+_r,-1*vr,-1*_r),un.push((on+1)/this.horizontalSegments,0),$e.push(1),Rn.push(on),_n.push(ln)}for(let on=0;on<this.horizontalSegments;on++){const ln=8*on,or=ln+1,vi=ln+2,Zn=ln+3,Fr=ln+4,hi=ln+5,Er=ln+6,$r=ln+7;xe.push(or,ln,Zn),xe.push(ln,vi,Zn),xe.push(hi,Fr,$r),xe.push(Fr,Er,$r)}this.geometry.setIndex(xe),this.geometry.setAttribute("position",new Z.Float32BufferAttribute(Fe,3)),this.geometry.setAttribute("uv",new Z.Float32BufferAttribute(new Float32Array(un),2)),this.geometry.setAttribute("index",new Z.Float32BufferAttribute(new Float32Array(Rn),1)),this.geometry.setAttribute("type",new Z.Float32BufferAttribute(new Float32Array($e),1)),this.geometry.setAttribute("delay",new Z.Float32BufferAttribute(new Float32Array(_n),1))}setTexture(jt,Pt,xe,Fe){this.initData(xe,Fe),this.material.uniforms={segments:{value:this.horizontalSegments},segmentWidth:{value:xe/this.horizontalSegments},timePercent:{value:0},texturePrev:{value:jt},textureNext:{value:Pt}},this.meshToCameraDistance=.5*Fe/Math.tan(Math.PI/6),this.camera.updateAspect(xe,Fe),this.camera.focus(this.mesh,Fe),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material}addObjects(jt){jt.add(this.mesh)}updateAnimation(jt){this.material.uniforms.timePercent.value=jt}dispose(){var jt,Pt;(jt=this.geometry)===null||jt===void 0||jt.dispose(),(Pt=this.material)===null||Pt===void 0||Pt.dispose()}},Curtain:class extends $n{constructor(){super(...arguments),this.duration=6e3,this.fragmentShader=ws.a,this.vertexShader=Lr.a,this.verticalSegments=100}extraAttributes(){return{isLeft:{itemSize:1,generator:(jt,Pt)=>[Pt<this.horizontalSegments()/2?1:0]}}}addObjects(jt){super.addObjects(jt),this.mesh.position.z+=20,jt.background=this.nextTexture}},Fall:class extends $n{constructor(){super(...arguments),this.zCurveLimit=100,this.duration=2e3,this.verticalSegments=100,this.fragmentShader=yo.a,this.vertexShader=so.a}extraAttributes(){return{}}setTexture(jt,Pt,xe,Fe){super.setTexture(jt,Pt,xe,Fe),this.material.uniforms.zCurveLimit={value:this.zCurveLimit},this.material.uniforms.aCoefficient={value:this.zCurveLimit/(this.textureHeight/2*(this.textureHeight/2))}}addObjects(jt){jt.add(this.mesh),jt.background=this.nextTexture}updateAnimation(jt){this.material.uniforms.timePercent.value=jt}},Suspension:class extends Ct{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=pe.a,this.vertexShader=Zt.a}addObjects(jt){jt.add(this.mesh),jt.background=this.prevTexture}},Clock:class extends mt{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=qe.a}},Combing:class extends mt{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Pn.a}},Scale:class extends mt{constructor(){super(...arguments),this.duration=900,this.fragmentShader=Un.a}},PeelOff:Ct,Flip:class extends $n{constructor(){super(...arguments),this.duration=1250,this.fragmentShader=Qa.a,this.vertexShader=Xo.a,this.verticalSegments=1}extraAttributes(){return{}}},Wind:class{constructor(){this.duration=2e3,this.camera=new ke,this.mesh=new Z.Mesh,this.geometry=null,this.material=new Z.MeshLambertMaterial({side:Z.DoubleSide,alphaTest:.5}),this.tmpForce=new Z.Vector3,this.windForce=new Z.Vector3(0,0,0),this.cloth=null,this.nextTexture=null,this.diff=new Z.Vector3,this.xSegs=10,this.ySegs=10,this.width=10,this.height=10,this.enablePins=!0,this.animate=jt=>{this.simulate(jt),this.render(),requestAnimationFrame(this.animate)}}setTexture(jt,Pt,xe,Fe){const $e=xe,un=Fe;this.xSegs=Math.ceil($e/25),this.ySegs=Math.ceil(un/25),this.width=25*this.xSegs,this.height=25*this.ySegs;const Rn=function(_n,Sn){return function(vr,_r,on){const ln=(vr-.5)*_n,or=(_r+.5)*Sn;on.set(ln,or,0)}}(25*this.xSegs,25*this.ySegs);this.cloth=new ea(this.xSegs,this.ySegs,Rn),this.nextTexture=Pt,this.camera.updateAspect($e,un),this.material.map=jt,this.geometry=new Z.ParametricBufferGeometry(Rn,this.cloth.width,this.cloth.height),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material,this.mesh.castShadow=!0,this.mesh.position.y-=un,this.mesh.customDepthMaterial=new Z.MeshDepthMaterial({depthPacking:Z.RGBADepthPacking,map:jt,alphaTest:.5}),this.camera.focus(this.mesh,un)}addObjects(jt){jt.add(this.mesh),jt.background=this.nextTexture,jt.add(new Z.AmbientLight(6710886));const Pt=new Z.DirectionalLight(14674943,1);Pt.position.set(0,0,100),Pt.position.multiplyScalar(1.3),Pt.castShadow=!0,Pt.shadow.mapSize.width=1024,Pt.shadow.mapSize.height=1024;const xe=300;Pt.shadow.camera.left=-xe,Pt.shadow.camera.right=xe,Pt.shadow.camera.top=xe,Pt.shadow.camera.bottom=-xe,Pt.shadow.camera.far=1e3,jt.add(Pt),this.animate(0)}satisfyConstraints(jt,Pt,xe){this.diff.subVectors(Pt.position,jt.position);const Fe=this.diff.length();if(Fe===0)return;const $e=this.diff.multiplyScalar(1-xe/Fe).multiplyScalar(.5);jt.position.add($e),Pt.position.sub($e)}simulate(jt){const Pt=20*Math.abs(Math.cos(jt/70));this.windForce.set(Math.abs(Math.sin(jt/300)),Math.abs(Math.cos(jt/200)),Math.sin(jt/1e3)),this.windForce.normalize(),this.windForce.x*=50*Pt,this.windForce.y*=50*Pt,this.windForce.z*=.2*Pt;const xe=this.cloth.particles;let Fe;const $e=new Z.Vector3,un=this.geometry.index,Rn=this.geometry.attributes.normal;for(let vr=0,_r=un.count;vr<_r;vr+=3)for(let on=0;on<3;on++)Fe=un.getX(vr+on),$e.fromBufferAttribute(Rn,Fe),this.tmpForce.copy($e).normalize().multiplyScalar($e.dot(this.windForce)),xe[Fe].addForce(this.tmpForce);for(let vr=0,_r=xe.length;vr<_r;vr++){const on=xe[vr];on.addForce(Oo),on.integrate(144e-6,this.width,this.height)}const _n=this.cloth.constraints,Sn=_n.length;for(let vr=0;vr<Sn;vr++){const _r=_n[vr];this.satisfyConstraints(_r[0],_r[1],_r[2])}for(let vr=0,_r=xe.length;vr<_r;vr++){const on=xe[vr].position;on.y<-250&&(on.y=-250)}if(this.enablePins){let vr=new Array(this.xSegs+1).fill("").map((_r,on)=>on);for(let _r=0;_r<this.ySegs+1;_r++)vr.push(_r*(this.xSegs+1));for(let _r=0,on=vr.length;_r<on;_r++){const ln=xe[vr[_r]];ln.position.copy(ln.original),ln.previous.copy(ln.original)}}}render(){const jt=this.cloth.particles;for(let Pt=0,xe=jt.length;Pt<xe;Pt++){const Fe=jt[Pt].position;this.geometry.attributes.position.setXYZ(Pt,Fe.x,Fe.y,Fe.z)}this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeVertexNormals()}updateAnimation(jt){jt>.5&&(this.enablePins=!1),jt>.9999&&(this.mesh.visible=!1)}dispose(){var jt,Pt;(jt=this.geometry)===null||jt===void 0||jt.dispose(),(Pt=this.material)===null||Pt===void 0||Pt.dispose()}}},vh={linear:(jt,Pt,xe,Fe)=>xe*jt/Fe+Pt,easeIn:(jt,Pt,xe,Fe)=>xe*(jt/=Fe)*jt+Pt,strongEaseIn:(jt,Pt,xe,Fe)=>xe*(jt/=Fe)*jt*jt*jt*jt+Pt,strongEaseOut:(jt,Pt,xe,Fe)=>xe*((jt=jt/Fe-1)*jt*jt*jt*jt+1)+Pt,sineaseIn:(jt,Pt,xe,Fe)=>xe*(jt/=Fe)*jt*jt+Pt,sineaseOut:(jt,Pt,xe,Fe)=>xe*((jt=jt/Fe-1)*jt*jt+1)+Pt};class Yo{constructor(){this.startTime=0,this.lastTime=0,this.reverse=!1,this.scene=new Z.Scene,this.delay=0,this.easeFn=vh.linear,this.preset=null,this.onTransactionEnd=()=>{},this.textureLoader=new Z.TextureLoader,this.prevTexture=null,this.nextTexture=null,this.renderer=new Z.WebGLRenderer({alpha:!0,premultipliedAlpha:!0}),this.isPlaying=!1,this.animate=(Pt=-1)=>{var xe,Fe,$e;this.renderer.clear(),Pt>this.delay&&this.lastTime===0&&(this.lastTime=Pt,this.startTime=Pt);let un=0;this.lastTime>0&&un<1&&(un=this.easeFn(Pt-this.startTime,0,1,(Fe=(xe=this.preset)===null||xe===void 0?void 0:xe.duration)!==null&&Fe!==void 0?Fe:0)),un>1&&(un=1),($e=this.preset)===null||$e===void 0||$e.updateAnimation(this.reverse?1-un:un),this.rerender(),un<1?window.requestAnimationFrame(this.animate):(this.dispose(),this.onTransactionEnd())}}play(Pt){var xe,Fe,$e;Pt.onTransactionEnd&&(this.onTransactionEnd=Pt.onTransactionEnd),this.init(Pt),this.renderer.setSize(Pt.stageWidth,Pt.stageHeight),this.preset=new Aa[Pt.presetType],Pt.duration&&Number.isInteger(Pt.duration)&&(this.preset.duration=Pt.duration),this.prevTexture=this.textureLoader.load(Pt.prevTextureUrl),this.nextTexture=this.textureLoader.load(Pt.nextTextureUrl),this.reverse?(xe=this.preset)===null||xe===void 0||xe.setTexture(this.nextTexture,this.prevTexture,Pt.textureWidth,Pt.textureHeight):(Fe=this.preset)===null||Fe===void 0||Fe.setTexture(this.prevTexture,this.nextTexture,Pt.textureWidth,Pt.textureHeight),($e=this.preset)===null||$e===void 0||$e.addObjects(this.scene),this.animate(),this.isPlaying=!0}init(Pt){this.reverse=Pt.reverse,Pt.delay&&Number.isInteger(Pt.delay)&&(this.delay=Pt.delay),Pt.easeFn&&(this.easeFn=vh[Pt.easeFn]),this.startTime=0,this.lastTime=0,this.scene.clear(),this.renderer.shadowMap.enabled=!0,this.renderer.autoClear=!1}rerender(){var Pt;this.renderer.clear(),((Pt=this.preset)===null||Pt===void 0?void 0:Pt.camera.camera)&&this.renderer.render(this.scene,this.preset.camera.camera)}skip(){var Pt;(Pt=this.preset)===null||Pt===void 0||Pt.updateAnimation(this.reverse?0:1),this.rerender(),this.dispose(),this.onTransactionEnd()}dispose(){var Pt,xe,Fe;this.isPlaying=!1,(Pt=this.preset)===null||Pt===void 0||Pt.dispose(),(xe=this.prevTexture)===null||xe===void 0||xe.dispose(),(Fe=this.nextTexture)===null||Fe===void 0||Fe.dispose()}}}])},function(Ie,C,T){(function(J){var G=T(15),lt=T(16),Z=setTimeout;function W(F){return Boolean(F&&F.length!==void 0)}function mt(){}function et(F){if(!(this instanceof et))throw new TypeError("Promises must be constructed via new");if(typeof F!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],L(F,this)}function nt(F,z){for(;F._state===3;)F=F._value;F._state!==0?(F._handled=!0,et._immediateFn(function(){var rt=F._state===1?z.onFulfilled:z.onRejected;if(rt!==null){var k;try{k=rt(F._value)}catch(X){return void Nt(z.promise,X)}ct(z.promise,k)}else(F._state===1?ct:Nt)(z.promise,F._value)})):F._deferreds.push(z)}function ct(F,z){try{if(z===F)throw new TypeError("A promise cannot be resolved with itself.");if(z&&(typeof z=="object"||typeof z=="function")){var rt=z.then;if(z instanceof et)return F._state=3,F._value=z,void Xt(F);if(typeof rt=="function")return void L((k=rt,X=z,function(){k.apply(X,arguments)}),F)}F._state=1,F._value=z,Xt(F)}catch(tt){Nt(F,tt)}var k,X}function Nt(F,z){F._state=2,F._value=z,Xt(F)}function Xt(F){F._state===2&&F._deferreds.length===0&&et._immediateFn(function(){F._handled||et._unhandledRejectionFn(F._value)});for(var z=0,rt=F._deferreds.length;z<rt;z++)nt(F,F._deferreds[z]);F._deferreds=null}function Gt(F,z,rt){this.onFulfilled=typeof F=="function"?F:null,this.onRejected=typeof z=="function"?z:null,this.promise=rt}function L(F,z){var rt=!1;try{F(function(k){rt||(rt=!0,ct(z,k))},function(k){rt||(rt=!0,Nt(z,k))})}catch(k){if(rt)return;rt=!0,Nt(z,k)}}et.prototype.catch=function(F){return this.then(null,F)},et.prototype.then=function(F,z){var rt=new this.constructor(mt);return nt(this,new Gt(F,z,rt)),rt},et.prototype.finally=G.a,et.all=function(F){return new et(function(z,rt){if(!W(F))return rt(new TypeError("Promise.all accepts an array"));var k=Array.prototype.slice.call(F);if(k.length===0)return z([]);var X=k.length;function tt(ue,je){try{if(je&&(typeof je=="object"||typeof je=="function")){var te=je.then;if(typeof te=="function")return void te.call(je,function(xt){tt(ue,xt)},rt)}k[ue]=je,--X==0&&z(k)}catch(xt){rt(xt)}}for(var ht=0;ht<k.length;ht++)tt(ht,k[ht])})},et.allSettled=lt.a,et.resolve=function(F){return F&&typeof F=="object"&&F.constructor===et?F:new et(function(z){z(F)})},et.reject=function(F){return new et(function(z,rt){rt(F)})},et.race=function(F){return new et(function(z,rt){if(!W(F))return rt(new TypeError("Promise.race accepts an array"));for(var k=0,X=F.length;k<X;k++)et.resolve(F[k]).then(z,rt)})},et._immediateFn=typeof J=="function"&&function(F){J(F)}||function(F){Z(F,0)},et._unhandledRejectionFn=function(F){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",F)},C.a=et}).call(this,T(21).setImmediate)},function(Ie,C,T){C.a=function(J){var G=this.constructor;return this.then(function(lt){return G.resolve(J()).then(function(){return lt})},function(lt){return G.resolve(J()).then(function(){return G.reject(lt)})})}},function(Ie,C,T){C.a=function(J){return new this(function(G,lt){if(!J||J.length===void 0)return lt(new TypeError(typeof J+" "+J+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var Z=Array.prototype.slice.call(J);if(Z.length===0)return G([]);var W=Z.length;function mt(nt,ct){if(ct&&(typeof ct=="object"||typeof ct=="function")){var Nt=ct.then;if(typeof Nt=="function")return void Nt.call(ct,function(Xt){mt(nt,Xt)},function(Xt){Z[nt]={status:"rejected",reason:Xt},--W==0&&G(Z)})}Z[nt]={status:"fulfilled",value:ct},--W==0&&G(Z)}for(var et=0;et<Z.length;et++)mt(et,Z[et])})}},function(Ie,C,T){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var J=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,lt=Object.prototype.propertyIsEnumerable;function Z(W){if(W==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(W)}Ie.exports=function(){try{if(!Object.assign)return!1;var W=new String("abc");if(W[5]="de",Object.getOwnPropertyNames(W)[0]==="5")return!1;for(var mt={},et=0;et<10;et++)mt["_"+String.fromCharCode(et)]=et;if(Object.getOwnPropertyNames(mt).map(function(ct){return mt[ct]}).join("")!=="0123456789")return!1;var nt={};return"abcdefghijklmnopqrst".split("").forEach(function(ct){nt[ct]=ct}),Object.keys(Object.assign({},nt)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(W,mt){for(var et,nt,ct=Z(W),Nt=1;Nt<arguments.length;Nt++){for(var Xt in et=Object(arguments[Nt]))G.call(et,Xt)&&(ct[Xt]=et[Xt]);if(J){nt=J(et);for(var Gt=0;Gt<nt.length;Gt++)lt.call(et,nt[Gt])&&(ct[nt[Gt]]=et[nt[Gt]])}}return ct}},function(Ie,C){Ie.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
}
`},function(Ie,C){Ie.exports=`precision mediump float;
#define KERNEL 7
varying vec2 vTextureCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 inputSize;
uniform float uStartAlpha;
uniform float uEndAlpha;
uniform int uBlur;
void main() {
	float halfHeight = uShapeFilterArea.w / 2.0;
	vec2 cod = vTextureCoord * inputSize.xy;
	if (cod.y < halfHeight) {
		gl_FragColor = texture2D(uSampler, vTextureCoord);
	}
	else {
		float alpha = uStartAlpha - (((cod.y - halfHeight) / halfHeight) * (uStartAlpha - uEndAlpha));
		vec2 cord = vec2(vTextureCoord.x, (uShapeFilterArea.w - cod.y) / inputSize.y);
		vec4 outputColor = texture2D(uSampler, cord);
		outputColor *= alpha;
		gl_FragColor = outputColor;
	}
}
`},function(Ie,C,T){(function(J){var G;/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){var lt=function(){this.init()};lt.prototype={init:function(){var L=this||Z;return L._counter=1e3,L._html5AudioPool=[],L.html5PoolSize=10,L._codecs={},L._howls=[],L._muted=!1,L._volume=1,L._canPlayEvent="canplaythrough",L._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,L.masterGain=null,L.noAudio=!1,L.usingWebAudio=!0,L.autoSuspend=!0,L.ctx=null,L.autoUnlock=!0,L._setup(),L},volume:function(L){var F=this||Z;if(L=parseFloat(L),F.ctx||Gt(),L!==void 0&&L>=0&&L<=1){if(F._volume=L,F._muted)return F;F.usingWebAudio&&F.masterGain.gain.setValueAtTime(L,Z.ctx.currentTime);for(var z=0;z<F._howls.length;z++)if(!F._howls[z]._webAudio)for(var rt=F._howls[z]._getSoundIds(),k=0;k<rt.length;k++){var X=F._howls[z]._soundById(rt[k]);X&&X._node&&(X._node.volume=X._volume*L)}return F}return F._volume},mute:function(L){var F=this||Z;F.ctx||Gt(),F._muted=L,F.usingWebAudio&&F.masterGain.gain.setValueAtTime(L?0:F._volume,Z.ctx.currentTime);for(var z=0;z<F._howls.length;z++)if(!F._howls[z]._webAudio)for(var rt=F._howls[z]._getSoundIds(),k=0;k<rt.length;k++){var X=F._howls[z]._soundById(rt[k]);X&&X._node&&(X._node.muted=!!L||X._muted)}return F},stop:function(){for(var L=this||Z,F=0;F<L._howls.length;F++)L._howls[F].stop();return L},unload:function(){for(var L=this||Z,F=L._howls.length-1;F>=0;F--)L._howls[F].unload();return L.usingWebAudio&&L.ctx&&L.ctx.close!==void 0&&(L.ctx.close(),L.ctx=null,Gt()),L},codecs:function(L){return(this||Z)._codecs[L.replace(/^x-/,"")]},_setup:function(){var L=this||Z;if(L.state=L.ctx&&L.ctx.state||"suspended",L._autoSuspend(),!L.usingWebAudio)if(typeof Audio!="undefined")try{new Audio().oncanplaythrough===void 0&&(L._canPlayEvent="canplay")}catch{L.noAudio=!0}else L.noAudio=!0;try{new Audio().muted&&(L.noAudio=!0)}catch{}return L.noAudio||L._setupCodecs(),L},_setupCodecs:function(){var L=this||Z,F=null;try{F=typeof Audio!="undefined"?new Audio:null}catch{return L}if(!F||typeof F.canPlayType!="function")return L;var z=F.canPlayType("audio/mpeg;").replace(/^no$/,""),rt=L._navigator?L._navigator.userAgent:"",k=rt.match(/OPR\/([0-6].)/g),X=k&&parseInt(k[0].split("/")[1],10)<33,tt=rt.indexOf("Safari")!==-1&&rt.indexOf("Chrome")===-1,ht=rt.match(/Version\/(.*?) /),ue=tt&&ht&&parseInt(ht[1],10)<15;return L._codecs={mp3:!(X||!z&&!F.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!z,opus:!!F.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!F.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!F.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(F.canPlayType('audio/wav; codecs="1"')||F.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!F.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!F.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(F.canPlayType("audio/x-m4a;")||F.canPlayType("audio/m4a;")||F.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(F.canPlayType("audio/x-m4b;")||F.canPlayType("audio/m4b;")||F.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(F.canPlayType("audio/x-mp4;")||F.canPlayType("audio/mp4;")||F.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(ue||!F.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(ue||!F.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!F.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(F.canPlayType("audio/x-flac;")||F.canPlayType("audio/flac;")).replace(/^no$/,"")},L},_unlockAudio:function(){var L=this||Z;if(!L._audioUnlocked&&L.ctx){L._audioUnlocked=!1,L.autoUnlock=!1,L._mobileUnloaded||L.ctx.sampleRate===44100||(L._mobileUnloaded=!0,L.unload()),L._scratchBuffer=L.ctx.createBuffer(1,1,22050);var F=function(z){for(;L._html5AudioPool.length<L.html5PoolSize;)try{var rt=new Audio;rt._unlocked=!0,L._releaseHtml5Audio(rt)}catch{L.noAudio=!0;break}for(var k=0;k<L._howls.length;k++)if(!L._howls[k]._webAudio)for(var X=L._howls[k]._getSoundIds(),tt=0;tt<X.length;tt++){var ht=L._howls[k]._soundById(X[tt]);ht&&ht._node&&!ht._node._unlocked&&(ht._node._unlocked=!0,ht._node.load())}L._autoResume();var ue=L.ctx.createBufferSource();ue.buffer=L._scratchBuffer,ue.connect(L.ctx.destination),ue.start===void 0?ue.noteOn(0):ue.start(0),typeof L.ctx.resume=="function"&&L.ctx.resume(),ue.onended=function(){ue.disconnect(0),L._audioUnlocked=!0,document.removeEventListener("touchstart",F,!0),document.removeEventListener("touchend",F,!0),document.removeEventListener("click",F,!0),document.removeEventListener("keydown",F,!0);for(var je=0;je<L._howls.length;je++)L._howls[je]._emit("unlock")}};return document.addEventListener("touchstart",F,!0),document.addEventListener("touchend",F,!0),document.addEventListener("click",F,!0),document.addEventListener("keydown",F,!0),L}},_obtainHtml5Audio:function(){var L=this||Z;if(L._html5AudioPool.length)return L._html5AudioPool.pop();var F=new Audio().play();return F&&typeof Promise!="undefined"&&(F instanceof Promise||typeof F.then=="function")&&F.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(L){var F=this||Z;return L._unlocked&&F._html5AudioPool.push(L),F},_autoSuspend:function(){var L=this;if(L.autoSuspend&&L.ctx&&L.ctx.suspend!==void 0&&Z.usingWebAudio){for(var F=0;F<L._howls.length;F++)if(L._howls[F]._webAudio){for(var z=0;z<L._howls[F]._sounds.length;z++)if(!L._howls[F]._sounds[z]._paused)return L}return L._suspendTimer&&clearTimeout(L._suspendTimer),L._suspendTimer=setTimeout(function(){if(L.autoSuspend){L._suspendTimer=null,L.state="suspending";var rt=function(){L.state="suspended",L._resumeAfterSuspend&&(delete L._resumeAfterSuspend,L._autoResume())};L.ctx.suspend().then(rt,rt)}},3e4),L}},_autoResume:function(){var L=this;if(L.ctx&&L.ctx.resume!==void 0&&Z.usingWebAudio)return L.state==="running"&&L.ctx.state!=="interrupted"&&L._suspendTimer?(clearTimeout(L._suspendTimer),L._suspendTimer=null):L.state==="suspended"||L.state==="running"&&L.ctx.state==="interrupted"?(L.ctx.resume().then(function(){L.state="running";for(var F=0;F<L._howls.length;F++)L._howls[F]._emit("resume")}),L._suspendTimer&&(clearTimeout(L._suspendTimer),L._suspendTimer=null)):L.state==="suspending"&&(L._resumeAfterSuspend=!0),L}};var Z=new lt,W=function(L){L.src&&L.src.length!==0?this.init(L):console.error("An array of source files must be passed with any new Howl.")};W.prototype={init:function(L){var F=this;return Z.ctx||Gt(),F._autoplay=L.autoplay||!1,F._format=typeof L.format!="string"?L.format:[L.format],F._html5=L.html5||!1,F._muted=L.mute||!1,F._loop=L.loop||!1,F._pool=L.pool||5,F._preload=typeof L.preload!="boolean"&&L.preload!=="metadata"||L.preload,F._rate=L.rate||1,F._sprite=L.sprite||{},F._src=typeof L.src!="string"?L.src:[L.src],F._volume=L.volume!==void 0?L.volume:1,F._xhr={method:L.xhr&&L.xhr.method?L.xhr.method:"GET",headers:L.xhr&&L.xhr.headers?L.xhr.headers:null,withCredentials:!(!L.xhr||!L.xhr.withCredentials)&&L.xhr.withCredentials},F._duration=0,F._state="unloaded",F._sounds=[],F._endTimers={},F._queue=[],F._playLock=!1,F._onend=L.onend?[{fn:L.onend}]:[],F._onfade=L.onfade?[{fn:L.onfade}]:[],F._onload=L.onload?[{fn:L.onload}]:[],F._onloaderror=L.onloaderror?[{fn:L.onloaderror}]:[],F._onplayerror=L.onplayerror?[{fn:L.onplayerror}]:[],F._onpause=L.onpause?[{fn:L.onpause}]:[],F._onplay=L.onplay?[{fn:L.onplay}]:[],F._onstop=L.onstop?[{fn:L.onstop}]:[],F._onmute=L.onmute?[{fn:L.onmute}]:[],F._onvolume=L.onvolume?[{fn:L.onvolume}]:[],F._onrate=L.onrate?[{fn:L.onrate}]:[],F._onseek=L.onseek?[{fn:L.onseek}]:[],F._onunlock=L.onunlock?[{fn:L.onunlock}]:[],F._onresume=[],F._webAudio=Z.usingWebAudio&&!F._html5,Z.ctx!==void 0&&Z.ctx&&Z.autoUnlock&&Z._unlockAudio(),Z._howls.push(F),F._autoplay&&F._queue.push({event:"play",action:function(){F.play()}}),F._preload&&F._preload!=="none"&&F.load(),F},load:function(){var L=null;if(Z.noAudio)this._emit("loaderror",null,"No audio support.");else{typeof this._src=="string"&&(this._src=[this._src]);for(var F=0;F<this._src.length;F++){var z,rt;if(this._format&&this._format[F])z=this._format[F];else{if(typeof(rt=this._src[F])!="string"){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(z=/^data:audio\/([^;,]+);/i.exec(rt))||(z=/\.([^.]+)$/.exec(rt.split("?",1)[0])),z&&(z=z[1].toLowerCase())}if(z||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),z&&Z.codecs(z)){L=this._src[F];break}}if(L)return this._src=L,this._state="loading",window.location.protocol==="https:"&&L.slice(0,5)==="http:"&&(this._html5=!0,this._webAudio=!1),new mt(this),this._webAudio&&nt(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(L,F){var z=this,rt=null;if(typeof L=="number")rt=L,L=null;else{if(typeof L=="string"&&z._state==="loaded"&&!z._sprite[L])return null;if(L===void 0&&(L="__default",!z._playLock)){for(var k=0,X=0;X<z._sounds.length;X++)z._sounds[X]._paused&&!z._sounds[X]._ended&&(k++,rt=z._sounds[X]._id);k===1?L=null:rt=null}}var tt=rt?z._soundById(rt):z._inactiveSound();if(!tt)return null;if(rt&&!L&&(L=tt._sprite||"__default"),z._state!=="loaded"){tt._sprite=L,tt._ended=!1;var ht=tt._id;return z._queue.push({event:"play",action:function(){z.play(ht)}}),ht}if(rt&&!tt._paused)return F||z._loadQueue("play"),tt._id;z._webAudio&&Z._autoResume();var ue=Math.max(0,tt._seek>0?tt._seek:z._sprite[L][0]/1e3),je=Math.max(0,(z._sprite[L][0]+z._sprite[L][1])/1e3-ue),te=1e3*je/Math.abs(tt._rate),xt=z._sprite[L][0]/1e3,zt=(z._sprite[L][0]+z._sprite[L][1])/1e3;tt._sprite=L,tt._ended=!1;var Vt=function(){tt._paused=!1,tt._seek=ue,tt._start=xt,tt._stop=zt,tt._loop=!(!tt._loop&&!z._sprite[L][2])};if(!(ue>=zt)){var $=tt._node;if(z._webAudio){var Dt=function(){z._playLock=!1,Vt(),z._refreshBuffer(tt);var Qt=tt._muted||z._muted?0:tt._volume;$.gain.setValueAtTime(Qt,Z.ctx.currentTime),tt._playStart=Z.ctx.currentTime,$.bufferSource.start===void 0?tt._loop?$.bufferSource.noteGrainOn(0,ue,86400):$.bufferSource.noteGrainOn(0,ue,je):tt._loop?$.bufferSource.start(0,ue,86400):$.bufferSource.start(0,ue,je),te!==1/0&&(z._endTimers[tt._id]=setTimeout(z._ended.bind(z,tt),te)),F||setTimeout(function(){z._emit("play",tt._id),z._loadQueue()},0)};Z.state==="running"&&Z.ctx.state!=="interrupted"?Dt():(z._playLock=!0,z.once("resume",Dt),z._clearTimer(tt._id))}else{var Ht=function(){$.currentTime=ue,$.muted=tt._muted||z._muted||Z._muted||$.muted,$.volume=tt._volume*Z.volume(),$.playbackRate=tt._rate;try{var Qt=$.play();if(Qt&&typeof Promise!="undefined"&&(Qt instanceof Promise||typeof Qt.then=="function")?(z._playLock=!0,Vt(),Qt.then(function(){z._playLock=!1,$._unlocked=!0,F?z._loadQueue():z._emit("play",tt._id)}).catch(function(){z._playLock=!1,z._emit("playerror",tt._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),tt._ended=!0,tt._paused=!0})):F||(z._playLock=!1,Vt(),z._emit("play",tt._id)),$.playbackRate=tt._rate,$.paused)return void z._emit("playerror",tt._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");L!=="__default"||tt._loop?z._endTimers[tt._id]=setTimeout(z._ended.bind(z,tt),te):(z._endTimers[tt._id]=function(){z._ended(tt),$.removeEventListener("ended",z._endTimers[tt._id],!1)},$.addEventListener("ended",z._endTimers[tt._id],!1))}catch(de){z._emit("playerror",tt._id,de)}};$.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&($.src=z._src,$.load());var Yt=window&&window.ejecta||!$.readyState&&Z._navigator.isCocoonJS;if($.readyState>=3||Yt)Ht();else{z._playLock=!0,z._state="loading";var kt=function(){z._state="loaded",Ht(),$.removeEventListener(Z._canPlayEvent,kt,!1)};$.addEventListener(Z._canPlayEvent,kt,!1),z._clearTimer(tt._id)}}return tt._id}z._ended(tt)},pause:function(L){var F=this;if(F._state!=="loaded"||F._playLock)return F._queue.push({event:"pause",action:function(){F.pause(L)}}),F;for(var z=F._getSoundIds(L),rt=0;rt<z.length;rt++){F._clearTimer(z[rt]);var k=F._soundById(z[rt]);if(k&&!k._paused&&(k._seek=F.seek(z[rt]),k._rateSeek=0,k._paused=!0,F._stopFade(z[rt]),k._node))if(F._webAudio){if(!k._node.bufferSource)continue;k._node.bufferSource.stop===void 0?k._node.bufferSource.noteOff(0):k._node.bufferSource.stop(0),F._cleanBuffer(k._node)}else isNaN(k._node.duration)&&k._node.duration!==1/0||k._node.pause();arguments[1]||F._emit("pause",k?k._id:null)}return F},stop:function(L,F){var z=this;if(z._state!=="loaded"||z._playLock)return z._queue.push({event:"stop",action:function(){z.stop(L)}}),z;for(var rt=z._getSoundIds(L),k=0;k<rt.length;k++){z._clearTimer(rt[k]);var X=z._soundById(rt[k]);X&&(X._seek=X._start||0,X._rateSeek=0,X._paused=!0,X._ended=!0,z._stopFade(rt[k]),X._node&&(z._webAudio?X._node.bufferSource&&(X._node.bufferSource.stop===void 0?X._node.bufferSource.noteOff(0):X._node.bufferSource.stop(0),z._cleanBuffer(X._node)):isNaN(X._node.duration)&&X._node.duration!==1/0||(X._node.currentTime=X._start||0,X._node.pause(),X._node.duration===1/0&&z._clearSound(X._node))),F||z._emit("stop",X._id))}return z},mute:function(L,F){var z=this;if(z._state!=="loaded"||z._playLock)return z._queue.push({event:"mute",action:function(){z.mute(L,F)}}),z;if(F===void 0){if(typeof L!="boolean")return z._muted;z._muted=L}for(var rt=z._getSoundIds(F),k=0;k<rt.length;k++){var X=z._soundById(rt[k]);X&&(X._muted=L,X._interval&&z._stopFade(X._id),z._webAudio&&X._node?X._node.gain.setValueAtTime(L?0:X._volume,Z.ctx.currentTime):X._node&&(X._node.muted=!!Z._muted||L),z._emit("mute",X._id))}return z},volume:function(){var L,F,z,rt=this,k=arguments;if(k.length===0)return rt._volume;if(k.length===1||k.length===2&&k[1]===void 0){var X=rt._getSoundIds(),tt=X.indexOf(k[0]);tt>=0?F=parseInt(k[0],10):L=parseFloat(k[0])}else k.length>=2&&(L=parseFloat(k[0]),F=parseInt(k[1],10));if(!(L!==void 0&&L>=0&&L<=1))return(z=F?rt._soundById(F):rt._sounds[0])?z._volume:0;if(rt._state!=="loaded"||rt._playLock)return rt._queue.push({event:"volume",action:function(){rt.volume.apply(rt,k)}}),rt;F===void 0&&(rt._volume=L),F=rt._getSoundIds(F);for(var ht=0;ht<F.length;ht++)(z=rt._soundById(F[ht]))&&(z._volume=L,k[2]||rt._stopFade(F[ht]),rt._webAudio&&z._node&&!z._muted?z._node.gain.setValueAtTime(L,Z.ctx.currentTime):z._node&&!z._muted&&(z._node.volume=L*Z.volume()),rt._emit("volume",z._id));return rt},fade:function(L,F,z,rt){var k=this;if(k._state!=="loaded"||k._playLock)return k._queue.push({event:"fade",action:function(){k.fade(L,F,z,rt)}}),k;L=Math.min(Math.max(0,parseFloat(L)),1),F=Math.min(Math.max(0,parseFloat(F)),1),z=parseFloat(z),k.volume(L,rt);for(var X=k._getSoundIds(rt),tt=0;tt<X.length;tt++){var ht=k._soundById(X[tt]);if(ht){if(rt||k._stopFade(X[tt]),k._webAudio&&!ht._muted){var ue=Z.ctx.currentTime,je=ue+z/1e3;ht._volume=L,ht._node.gain.setValueAtTime(L,ue),ht._node.gain.linearRampToValueAtTime(F,je)}k._startFadeInterval(ht,L,F,z,X[tt],rt===void 0)}}return k},_startFadeInterval:function(L,F,z,rt,k,X){var tt=this,ht=F,ue=z-F,je=Math.abs(ue/.01),te=Math.max(4,je>0?rt/je:rt),xt=Date.now();L._fadeTo=z,L._interval=setInterval(function(){var zt=(Date.now()-xt)/rt;xt=Date.now(),ht+=ue*zt,ht=Math.round(100*ht)/100,ht=ue<0?Math.max(z,ht):Math.min(z,ht),tt._webAudio?L._volume=ht:tt.volume(ht,L._id,!0),X&&(tt._volume=ht),(z<F&&ht<=z||z>F&&ht>=z)&&(clearInterval(L._interval),L._interval=null,L._fadeTo=null,tt.volume(z,L._id),tt._emit("fade",L._id))},te)},_stopFade:function(L){var F=this._soundById(L);return F&&F._interval&&(this._webAudio&&F._node.gain.cancelScheduledValues(Z.ctx.currentTime),clearInterval(F._interval),F._interval=null,this.volume(F._fadeTo,L),F._fadeTo=null,this._emit("fade",L)),this},loop:function(){var L,F,z,rt=this,k=arguments;if(k.length===0)return rt._loop;if(k.length===1){if(typeof k[0]!="boolean")return!!(z=rt._soundById(parseInt(k[0],10)))&&z._loop;L=k[0],rt._loop=L}else k.length===2&&(L=k[0],F=parseInt(k[1],10));for(var X=rt._getSoundIds(F),tt=0;tt<X.length;tt++)(z=rt._soundById(X[tt]))&&(z._loop=L,rt._webAudio&&z._node&&z._node.bufferSource&&(z._node.bufferSource.loop=L,L&&(z._node.bufferSource.loopStart=z._start||0,z._node.bufferSource.loopEnd=z._stop,rt.playing(X[tt])&&(rt.pause(X[tt],!0),rt.play(X[tt],!0)))));return rt},rate:function(){var L,F,z,rt=this,k=arguments;if(k.length===0)F=rt._sounds[0]._id;else if(k.length===1){var X=rt._getSoundIds(),tt=X.indexOf(k[0]);tt>=0?F=parseInt(k[0],10):L=parseFloat(k[0])}else k.length===2&&(L=parseFloat(k[0]),F=parseInt(k[1],10));if(typeof L!="number")return(z=rt._soundById(F))?z._rate:rt._rate;if(rt._state!=="loaded"||rt._playLock)return rt._queue.push({event:"rate",action:function(){rt.rate.apply(rt,k)}}),rt;F===void 0&&(rt._rate=L),F=rt._getSoundIds(F);for(var ht=0;ht<F.length;ht++)if(z=rt._soundById(F[ht])){rt.playing(F[ht])&&(z._rateSeek=rt.seek(F[ht]),z._playStart=rt._webAudio?Z.ctx.currentTime:z._playStart),z._rate=L,rt._webAudio&&z._node&&z._node.bufferSource?z._node.bufferSource.playbackRate.setValueAtTime(L,Z.ctx.currentTime):z._node&&(z._node.playbackRate=L);var ue=rt.seek(F[ht]),je=(rt._sprite[z._sprite][0]+rt._sprite[z._sprite][1])/1e3-ue,te=1e3*je/Math.abs(z._rate);!rt._endTimers[F[ht]]&&z._paused||(rt._clearTimer(F[ht]),rt._endTimers[F[ht]]=setTimeout(rt._ended.bind(rt,z),te)),rt._emit("rate",z._id)}return rt},seek:function(){var L,F,z=this,rt=arguments;if(rt.length===0)z._sounds.length&&(F=z._sounds[0]._id);else if(rt.length===1){var k=z._getSoundIds(),X=k.indexOf(rt[0]);X>=0?F=parseInt(rt[0],10):z._sounds.length&&(F=z._sounds[0]._id,L=parseFloat(rt[0]))}else rt.length===2&&(L=parseFloat(rt[0]),F=parseInt(rt[1],10));if(F===void 0)return 0;if(typeof L=="number"&&(z._state!=="loaded"||z._playLock))return z._queue.push({event:"seek",action:function(){z.seek.apply(z,rt)}}),z;var tt=z._soundById(F);if(tt){if(!(typeof L=="number"&&L>=0)){if(z._webAudio){var ht=z.playing(F)?Z.ctx.currentTime-tt._playStart:0,ue=tt._rateSeek?tt._rateSeek-tt._seek:0;return tt._seek+(ue+ht*Math.abs(tt._rate))}return tt._node.currentTime}var je=z.playing(F);je&&z.pause(F,!0),tt._seek=L,tt._ended=!1,z._clearTimer(F),z._webAudio||!tt._node||isNaN(tt._node.duration)||(tt._node.currentTime=L);var te=function(){je&&z.play(F,!0),z._emit("seek",F)};if(je&&!z._webAudio){var xt=function(){z._playLock?setTimeout(xt,0):te()};setTimeout(xt,0)}else te()}return z},playing:function(L){if(typeof L=="number"){var F=this._soundById(L);return!!F&&!F._paused}for(var z=0;z<this._sounds.length;z++)if(!this._sounds[z]._paused)return!0;return!1},duration:function(L){var F=this._duration,z=this._soundById(L);return z&&(F=this._sprite[z._sprite][1]/1e3),F},state:function(){return this._state},unload:function(){for(var L=this,F=L._sounds,z=0;z<F.length;z++)F[z]._paused||L.stop(F[z]._id),L._webAudio||(L._clearSound(F[z]._node),F[z]._node.removeEventListener("error",F[z]._errorFn,!1),F[z]._node.removeEventListener(Z._canPlayEvent,F[z]._loadFn,!1),F[z]._node.removeEventListener("ended",F[z]._endFn,!1),Z._releaseHtml5Audio(F[z]._node)),delete F[z]._node,L._clearTimer(F[z]._id);var rt=Z._howls.indexOf(L);rt>=0&&Z._howls.splice(rt,1);var k=!0;for(z=0;z<Z._howls.length;z++)if(Z._howls[z]._src===L._src||L._src.indexOf(Z._howls[z]._src)>=0){k=!1;break}return et&&k&&delete et[L._src],Z.noAudio=!1,L._state="unloaded",L._sounds=[],L=null,null},on:function(L,F,z,rt){var k=this["_on"+L];return typeof F=="function"&&k.push(rt?{id:z,fn:F,once:rt}:{id:z,fn:F}),this},off:function(L,F,z){var rt=this["_on"+L],k=0;if(typeof F=="number"&&(z=F,F=null),F||z)for(k=0;k<rt.length;k++){var X=z===rt[k].id;if(F===rt[k].fn&&X||!F&&X){rt.splice(k,1);break}}else if(L)this["_on"+L]=[];else{var tt=Object.keys(this);for(k=0;k<tt.length;k++)tt[k].indexOf("_on")===0&&Array.isArray(this[tt[k]])&&(this[tt[k]]=[])}return this},once:function(L,F,z){return this.on(L,F,z,1),this},_emit:function(L,F,z){for(var rt=this["_on"+L],k=rt.length-1;k>=0;k--)rt[k].id&&rt[k].id!==F&&L!=="load"||(setTimeout(function(X){X.call(this,F,z)}.bind(this,rt[k].fn),0),rt[k].once&&this.off(L,rt[k].fn,rt[k].id));return this._loadQueue(L),this},_loadQueue:function(L){if(this._queue.length>0){var F=this._queue[0];F.event===L&&(this._queue.shift(),this._loadQueue()),L||F.action()}return this},_ended:function(L){var F=L._sprite;if(!this._webAudio&&L._node&&!L._node.paused&&!L._node.ended&&L._node.currentTime<L._stop)return setTimeout(this._ended.bind(this,L),100),this;var z=!(!L._loop&&!this._sprite[F][2]);if(this._emit("end",L._id),!this._webAudio&&z&&this.stop(L._id,!0).play(L._id),this._webAudio&&z){this._emit("play",L._id),L._seek=L._start||0,L._rateSeek=0,L._playStart=Z.ctx.currentTime;var rt=1e3*(L._stop-L._start)/Math.abs(L._rate);this._endTimers[L._id]=setTimeout(this._ended.bind(this,L),rt)}return this._webAudio&&!z&&(L._paused=!0,L._ended=!0,L._seek=L._start||0,L._rateSeek=0,this._clearTimer(L._id),this._cleanBuffer(L._node),Z._autoSuspend()),this._webAudio||z||this.stop(L._id,!0),this},_clearTimer:function(L){if(this._endTimers[L]){if(typeof this._endTimers[L]!="function")clearTimeout(this._endTimers[L]);else{var F=this._soundById(L);F&&F._node&&F._node.removeEventListener("ended",this._endTimers[L],!1)}delete this._endTimers[L]}return this},_soundById:function(L){for(var F=0;F<this._sounds.length;F++)if(L===this._sounds[F]._id)return this._sounds[F];return null},_inactiveSound:function(){this._drain();for(var L=0;L<this._sounds.length;L++)if(this._sounds[L]._ended)return this._sounds[L].reset();return new mt(this)},_drain:function(){var L=this._pool,F=0,z=0;if(!(this._sounds.length<L)){for(z=0;z<this._sounds.length;z++)this._sounds[z]._ended&&F++;for(z=this._sounds.length-1;z>=0;z--){if(F<=L)return;this._sounds[z]._ended&&(this._webAudio&&this._sounds[z]._node&&this._sounds[z]._node.disconnect(0),this._sounds.splice(z,1),F--)}}},_getSoundIds:function(L){if(L===void 0){for(var F=[],z=0;z<this._sounds.length;z++)F.push(this._sounds[z]._id);return F}return[L]},_refreshBuffer:function(L){return L._node.bufferSource=Z.ctx.createBufferSource(),L._node.bufferSource.buffer=et[this._src],L._panner?L._node.bufferSource.connect(L._panner):L._node.bufferSource.connect(L._node),L._node.bufferSource.loop=L._loop,L._loop&&(L._node.bufferSource.loopStart=L._start||0,L._node.bufferSource.loopEnd=L._stop||0),L._node.bufferSource.playbackRate.setValueAtTime(L._rate,Z.ctx.currentTime),this},_cleanBuffer:function(L){var F=Z._navigator&&Z._navigator.vendor.indexOf("Apple")>=0;if(Z._scratchBuffer&&L.bufferSource&&(L.bufferSource.onended=null,L.bufferSource.disconnect(0),F))try{L.bufferSource.buffer=Z._scratchBuffer}catch{}return L.bufferSource=null,this},_clearSound:function(L){/MSIE |Trident\//.test(Z._navigator&&Z._navigator.userAgent)||(L.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var mt=function(L){this._parent=L,this.init()};mt.prototype={init:function(){var L=this._parent;return this._muted=L._muted,this._loop=L._loop,this._volume=L._volume,this._rate=L._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++Z._counter,L._sounds.push(this),this.create(),this},create:function(){var L=this._parent,F=Z._muted||this._muted||this._parent._muted?0:this._volume;return L._webAudio?(this._node=Z.ctx.createGain===void 0?Z.ctx.createGainNode():Z.ctx.createGain(),this._node.gain.setValueAtTime(F,Z.ctx.currentTime),this._node.paused=!0,this._node.connect(Z.masterGain)):Z.noAudio||(this._node=Z._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(Z._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=L._src,this._node.preload=L._preload===!0?"auto":L._preload,this._node.volume=F*Z.volume(),this._node.load()),this},reset:function(){var L=this._parent;return this._muted=L._muted,this._loop=L._loop,this._volume=L._volume,this._rate=L._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++Z._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var L=this._parent;L._duration=Math.ceil(10*this._node.duration)/10,Object.keys(L._sprite).length===0&&(L._sprite={__default:[0,1e3*L._duration]}),L._state!=="loaded"&&(L._state="loaded",L._emit("load"),L._loadQueue()),this._node.removeEventListener(Z._canPlayEvent,this._loadFn,!1)},_endListener:function(){var L=this._parent;L._duration===1/0&&(L._duration=Math.ceil(10*this._node.duration)/10,L._sprite.__default[1]===1/0&&(L._sprite.__default[1]=1e3*L._duration),L._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}};var et={},nt=function(L){var F=L._src;if(et[F])return L._duration=et[F].duration,void Xt(L);if(/^data:[^;]+;base64,/.test(F)){for(var z=atob(F.split(",")[1]),rt=new Uint8Array(z.length),k=0;k<z.length;++k)rt[k]=z.charCodeAt(k);Nt(rt.buffer,L)}else{var X=new XMLHttpRequest;X.open(L._xhr.method,F,!0),X.withCredentials=L._xhr.withCredentials,X.responseType="arraybuffer",L._xhr.headers&&Object.keys(L._xhr.headers).forEach(function(tt){X.setRequestHeader(tt,L._xhr.headers[tt])}),X.onload=function(){var tt=(X.status+"")[0];tt==="0"||tt==="2"||tt==="3"?Nt(X.response,L):L._emit("loaderror",null,"Failed loading audio file with status: "+X.status+".")},X.onerror=function(){L._webAudio&&(L._html5=!0,L._webAudio=!1,L._sounds=[],delete et[F],L.load())},ct(X)}},ct=function(L){try{L.send()}catch{L.onerror()}},Nt=function(L,F){var z=function(){F._emit("loaderror",null,"Decoding audio data failed.")},rt=function(k){k&&F._sounds.length>0?(et[F._src]=k,Xt(F,k)):z()};typeof Promise!="undefined"&&Z.ctx.decodeAudioData.length===1?Z.ctx.decodeAudioData(L).then(rt).catch(z):Z.ctx.decodeAudioData(L,rt,z)},Xt=function(L,F){F&&!L._duration&&(L._duration=F.duration),Object.keys(L._sprite).length===0&&(L._sprite={__default:[0,1e3*L._duration]}),L._state!=="loaded"&&(L._state="loaded",L._emit("load"),L._loadQueue())},Gt=function(){if(Z.usingWebAudio){try{typeof AudioContext!="undefined"?Z.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?Z.ctx=new webkitAudioContext:Z.usingWebAudio=!1}catch{Z.usingWebAudio=!1}Z.ctx||(Z.usingWebAudio=!1);var L=/iP(hone|od|ad)/.test(Z._navigator&&Z._navigator.platform),F=Z._navigator&&Z._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),z=F?parseInt(F[1],10):null;if(L&&z&&z<9){var rt=/safari/.test(Z._navigator&&Z._navigator.userAgent.toLowerCase());Z._navigator&&!rt&&(Z.usingWebAudio=!1)}Z.usingWebAudio&&(Z.masterGain=Z.ctx.createGain===void 0?Z.ctx.createGainNode():Z.ctx.createGain(),Z.masterGain.gain.setValueAtTime(Z._muted?0:Z._volume,Z.ctx.currentTime),Z.masterGain.connect(Z.ctx.destination)),Z._setup()}};(G=function(){return{Howler:Z,Howl:W}}.apply(C,[]))===void 0||(Ie.exports=G),C.Howler=Z,C.Howl=W,J!==void 0?(J.HowlerGlobal=lt,J.Howler=Z,J.Howl=W,J.Sound=mt):typeof window!="undefined"&&(window.HowlerGlobal=lt,window.Howler=Z,window.Howl=W,window.Sound=mt)})(),function(){var lt;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(W){if(!this.ctx||!this.ctx.listener)return this;for(var mt=this._howls.length-1;mt>=0;mt--)this._howls[mt].stereo(W);return this},HowlerGlobal.prototype.pos=function(W,mt,et){return this.ctx&&this.ctx.listener?(mt=typeof mt!="number"?this._pos[1]:mt,et=typeof et!="number"?this._pos[2]:et,typeof W!="number"?this._pos:(this._pos=[W,mt,et],this.ctx.listener.positionX!==void 0?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(W,mt,et,nt,ct,Nt){if(!this.ctx||!this.ctx.listener)return this;var Xt=this._orientation;return mt=typeof mt!="number"?Xt[1]:mt,et=typeof et!="number"?Xt[2]:et,nt=typeof nt!="number"?Xt[3]:nt,ct=typeof ct!="number"?Xt[4]:ct,Nt=typeof Nt!="number"?Xt[5]:Nt,typeof W!="number"?Xt:(this._orientation=[W,mt,et,nt,ct,Nt],this.ctx.listener.forwardX!==void 0?(this.ctx.listener.forwardX.setTargetAtTime(W,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(mt,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(et,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(nt,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(ct,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(Nt,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(W,mt,et,nt,ct,Nt),this)},Howl.prototype.init=(lt=Howl.prototype.init,function(W){return this._orientation=W.orientation||[1,0,0],this._stereo=W.stereo||null,this._pos=W.pos||null,this._pannerAttr={coneInnerAngle:W.coneInnerAngle!==void 0?W.coneInnerAngle:360,coneOuterAngle:W.coneOuterAngle!==void 0?W.coneOuterAngle:360,coneOuterGain:W.coneOuterGain!==void 0?W.coneOuterGain:0,distanceModel:W.distanceModel!==void 0?W.distanceModel:"inverse",maxDistance:W.maxDistance!==void 0?W.maxDistance:1e4,panningModel:W.panningModel!==void 0?W.panningModel:"HRTF",refDistance:W.refDistance!==void 0?W.refDistance:1,rolloffFactor:W.rolloffFactor!==void 0?W.rolloffFactor:1},this._onstereo=W.onstereo?[{fn:W.onstereo}]:[],this._onpos=W.onpos?[{fn:W.onpos}]:[],this._onorientation=W.onorientation?[{fn:W.onorientation}]:[],lt.call(this,W)}),Howl.prototype.stereo=function(W,mt){var et=this;if(!et._webAudio)return et;if(et._state!=="loaded")return et._queue.push({event:"stereo",action:function(){et.stereo(W,mt)}}),et;var nt=Howler.ctx.createStereoPanner===void 0?"spatial":"stereo";if(mt===void 0){if(typeof W!="number")return et._stereo;et._stereo=W,et._pos=[W,0,0]}for(var ct=et._getSoundIds(mt),Nt=0;Nt<ct.length;Nt++){var Xt=et._soundById(ct[Nt]);if(Xt){if(typeof W!="number")return Xt._stereo;Xt._stereo=W,Xt._pos=[W,0,0],Xt._node&&(Xt._pannerAttr.panningModel="equalpower",Xt._panner&&Xt._panner.pan||Z(Xt,nt),nt==="spatial"?Xt._panner.positionX!==void 0?(Xt._panner.positionX.setValueAtTime(W,Howler.ctx.currentTime),Xt._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),Xt._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):Xt._panner.setPosition(W,0,0):Xt._panner.pan.setValueAtTime(W,Howler.ctx.currentTime)),et._emit("stereo",Xt._id)}}return et},Howl.prototype.pos=function(W,mt,et,nt){var ct=this;if(!ct._webAudio)return ct;if(ct._state!=="loaded")return ct._queue.push({event:"pos",action:function(){ct.pos(W,mt,et,nt)}}),ct;if(mt=typeof mt!="number"?0:mt,et=typeof et!="number"?-.5:et,nt===void 0){if(typeof W!="number")return ct._pos;ct._pos=[W,mt,et]}for(var Nt=ct._getSoundIds(nt),Xt=0;Xt<Nt.length;Xt++){var Gt=ct._soundById(Nt[Xt]);if(Gt){if(typeof W!="number")return Gt._pos;Gt._pos=[W,mt,et],Gt._node&&(Gt._panner&&!Gt._panner.pan||Z(Gt,"spatial"),Gt._panner.positionX!==void 0?(Gt._panner.positionX.setValueAtTime(W,Howler.ctx.currentTime),Gt._panner.positionY.setValueAtTime(mt,Howler.ctx.currentTime),Gt._panner.positionZ.setValueAtTime(et,Howler.ctx.currentTime)):Gt._panner.setPosition(W,mt,et)),ct._emit("pos",Gt._id)}}return ct},Howl.prototype.orientation=function(W,mt,et,nt){var ct=this;if(!ct._webAudio)return ct;if(ct._state!=="loaded")return ct._queue.push({event:"orientation",action:function(){ct.orientation(W,mt,et,nt)}}),ct;if(mt=typeof mt!="number"?ct._orientation[1]:mt,et=typeof et!="number"?ct._orientation[2]:et,nt===void 0){if(typeof W!="number")return ct._orientation;ct._orientation=[W,mt,et]}for(var Nt=ct._getSoundIds(nt),Xt=0;Xt<Nt.length;Xt++){var Gt=ct._soundById(Nt[Xt]);if(Gt){if(typeof W!="number")return Gt._orientation;Gt._orientation=[W,mt,et],Gt._node&&(Gt._panner||(Gt._pos||(Gt._pos=ct._pos||[0,0,-.5]),Z(Gt,"spatial")),Gt._panner.orientationX!==void 0?(Gt._panner.orientationX.setValueAtTime(W,Howler.ctx.currentTime),Gt._panner.orientationY.setValueAtTime(mt,Howler.ctx.currentTime),Gt._panner.orientationZ.setValueAtTime(et,Howler.ctx.currentTime)):Gt._panner.setOrientation(W,mt,et)),ct._emit("orientation",Gt._id)}}return ct},Howl.prototype.pannerAttr=function(){var W,mt,et,nt=this,ct=arguments;if(!nt._webAudio)return nt;if(ct.length===0)return nt._pannerAttr;if(ct.length===1){if(typeof ct[0]!="object")return(et=nt._soundById(parseInt(ct[0],10)))?et._pannerAttr:nt._pannerAttr;W=ct[0],mt===void 0&&(W.pannerAttr||(W.pannerAttr={coneInnerAngle:W.coneInnerAngle,coneOuterAngle:W.coneOuterAngle,coneOuterGain:W.coneOuterGain,distanceModel:W.distanceModel,maxDistance:W.maxDistance,refDistance:W.refDistance,rolloffFactor:W.rolloffFactor,panningModel:W.panningModel}),nt._pannerAttr={coneInnerAngle:W.pannerAttr.coneInnerAngle!==void 0?W.pannerAttr.coneInnerAngle:nt._coneInnerAngle,coneOuterAngle:W.pannerAttr.coneOuterAngle!==void 0?W.pannerAttr.coneOuterAngle:nt._coneOuterAngle,coneOuterGain:W.pannerAttr.coneOuterGain!==void 0?W.pannerAttr.coneOuterGain:nt._coneOuterGain,distanceModel:W.pannerAttr.distanceModel!==void 0?W.pannerAttr.distanceModel:nt._distanceModel,maxDistance:W.pannerAttr.maxDistance!==void 0?W.pannerAttr.maxDistance:nt._maxDistance,refDistance:W.pannerAttr.refDistance!==void 0?W.pannerAttr.refDistance:nt._refDistance,rolloffFactor:W.pannerAttr.rolloffFactor!==void 0?W.pannerAttr.rolloffFactor:nt._rolloffFactor,panningModel:W.pannerAttr.panningModel!==void 0?W.pannerAttr.panningModel:nt._panningModel})}else ct.length===2&&(W=ct[0],mt=parseInt(ct[1],10));for(var Nt=nt._getSoundIds(mt),Xt=0;Xt<Nt.length;Xt++)if(et=nt._soundById(Nt[Xt])){var Gt=et._pannerAttr;Gt={coneInnerAngle:W.coneInnerAngle!==void 0?W.coneInnerAngle:Gt.coneInnerAngle,coneOuterAngle:W.coneOuterAngle!==void 0?W.coneOuterAngle:Gt.coneOuterAngle,coneOuterGain:W.coneOuterGain!==void 0?W.coneOuterGain:Gt.coneOuterGain,distanceModel:W.distanceModel!==void 0?W.distanceModel:Gt.distanceModel,maxDistance:W.maxDistance!==void 0?W.maxDistance:Gt.maxDistance,refDistance:W.refDistance!==void 0?W.refDistance:Gt.refDistance,rolloffFactor:W.rolloffFactor!==void 0?W.rolloffFactor:Gt.rolloffFactor,panningModel:W.panningModel!==void 0?W.panningModel:Gt.panningModel};var L=et._panner;L?(L.coneInnerAngle=Gt.coneInnerAngle,L.coneOuterAngle=Gt.coneOuterAngle,L.coneOuterGain=Gt.coneOuterGain,L.distanceModel=Gt.distanceModel,L.maxDistance=Gt.maxDistance,L.refDistance=Gt.refDistance,L.rolloffFactor=Gt.rolloffFactor,L.panningModel=Gt.panningModel):(et._pos||(et._pos=nt._pos||[0,0,-.5]),Z(et,"spatial"))}return nt},Sound.prototype.init=function(W){return function(){var mt=this._parent;this._orientation=mt._orientation,this._stereo=mt._stereo,this._pos=mt._pos,this._pannerAttr=mt._pannerAttr,W.call(this),this._stereo?mt.stereo(this._stereo):this._pos&&mt.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(W){return function(){var mt=this._parent;return this._orientation=mt._orientation,this._stereo=mt._stereo,this._pos=mt._pos,this._pannerAttr=mt._pannerAttr,this._stereo?mt.stereo(this._stereo):this._pos?mt.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,mt._refreshBuffer(this)),W.call(this)}}(Sound.prototype.reset);var Z=function(W,mt){(mt=mt||"spatial")==="spatial"?(W._panner=Howler.ctx.createPanner(),W._panner.coneInnerAngle=W._pannerAttr.coneInnerAngle,W._panner.coneOuterAngle=W._pannerAttr.coneOuterAngle,W._panner.coneOuterGain=W._pannerAttr.coneOuterGain,W._panner.distanceModel=W._pannerAttr.distanceModel,W._panner.maxDistance=W._pannerAttr.maxDistance,W._panner.refDistance=W._pannerAttr.refDistance,W._panner.rolloffFactor=W._pannerAttr.rolloffFactor,W._panner.panningModel=W._pannerAttr.panningModel,W._panner.positionX!==void 0?(W._panner.positionX.setValueAtTime(W._pos[0],Howler.ctx.currentTime),W._panner.positionY.setValueAtTime(W._pos[1],Howler.ctx.currentTime),W._panner.positionZ.setValueAtTime(W._pos[2],Howler.ctx.currentTime)):W._panner.setPosition(W._pos[0],W._pos[1],W._pos[2]),W._panner.orientationX!==void 0?(W._panner.orientationX.setValueAtTime(W._orientation[0],Howler.ctx.currentTime),W._panner.orientationY.setValueAtTime(W._orientation[1],Howler.ctx.currentTime),W._panner.orientationZ.setValueAtTime(W._orientation[2],Howler.ctx.currentTime)):W._panner.setOrientation(W._orientation[0],W._orientation[1],W._orientation[2])):(W._panner=Howler.ctx.createStereoPanner(),W._panner.pan.setValueAtTime(W._stereo,Howler.ctx.currentTime)),W._panner.connect(W._node),W._paused||W._parent.pause(W._id,!0).play(W._id,!0)}}()}).call(this,T(4))},function(Ie,C,T){(function(J){var G=J!==void 0&&J||typeof self!="undefined"&&self||window,lt=Function.prototype.apply;function Z(W,mt){this._id=W,this._clearFn=mt}C.setTimeout=function(){return new Z(lt.call(setTimeout,G,arguments),clearTimeout)},C.setInterval=function(){return new Z(lt.call(setInterval,G,arguments),clearInterval)},C.clearTimeout=C.clearInterval=function(W){W&&W.close()},Z.prototype.unref=Z.prototype.ref=function(){},Z.prototype.close=function(){this._clearFn.call(G,this._id)},C.enroll=function(W,mt){clearTimeout(W._idleTimeoutId),W._idleTimeout=mt},C.unenroll=function(W){clearTimeout(W._idleTimeoutId),W._idleTimeout=-1},C._unrefActive=C.active=function(W){clearTimeout(W._idleTimeoutId);var mt=W._idleTimeout;mt>=0&&(W._idleTimeoutId=setTimeout(function(){W._onTimeout&&W._onTimeout()},mt))},T(22),C.setImmediate=typeof self!="undefined"&&self.setImmediate||J!==void 0&&J.setImmediate||this&&this.setImmediate,C.clearImmediate=typeof self!="undefined"&&self.clearImmediate||J!==void 0&&J.clearImmediate||this&&this.clearImmediate}).call(this,T(4))},function(Ie,C,T){(function(J,G){(function(lt,Z){if(!lt.setImmediate){var W,mt,et,nt,ct,Nt=1,Xt={},Gt=!1,L=lt.document,F=Object.getPrototypeOf&&Object.getPrototypeOf(lt);F=F&&F.setTimeout?F:lt,{}.toString.call(lt.process)==="[object process]"?W=function(k){G.nextTick(function(){rt(k)})}:function(){if(lt.postMessage&&!lt.importScripts){var k=!0,X=lt.onmessage;return lt.onmessage=function(){k=!1},lt.postMessage("","*"),lt.onmessage=X,k}}()?(nt="setImmediate$"+Math.random()+"$",ct=function(k){k.source===lt&&typeof k.data=="string"&&k.data.indexOf(nt)===0&&rt(+k.data.slice(nt.length))},lt.addEventListener?lt.addEventListener("message",ct,!1):lt.attachEvent("onmessage",ct),W=function(k){lt.postMessage(nt+k,"*")}):lt.MessageChannel?((et=new MessageChannel).port1.onmessage=function(k){rt(k.data)},W=function(k){et.port2.postMessage(k)}):L&&"onreadystatechange"in L.createElement("script")?(mt=L.documentElement,W=function(k){var X=L.createElement("script");X.onreadystatechange=function(){rt(k),X.onreadystatechange=null,mt.removeChild(X),X=null},mt.appendChild(X)}):W=function(k){setTimeout(rt,0,k)},F.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var X=new Array(arguments.length-1),tt=0;tt<X.length;tt++)X[tt]=arguments[tt+1];var ht={callback:k,args:X};return Xt[Nt]=ht,W(Nt),Nt++},F.clearImmediate=z}function z(k){delete Xt[k]}function rt(k){if(Gt)setTimeout(rt,0,k);else{var X=Xt[k];if(X){Gt=!0;try{(function(tt){var ht=tt.callback,ue=tt.args;switch(ue.length){case 0:ht();break;case 1:ht(ue[0]);break;case 2:ht(ue[0],ue[1]);break;case 3:ht(ue[0],ue[1],ue[2]);break;default:ht.apply(void 0,ue)}})(X)}finally{z(k),Gt=!1}}}}})(typeof self=="undefined"?J===void 0?this:J:self)}).call(this,T(4),T(23))},function(Ie,C){var T,J,G=Ie.exports={};function lt(){throw new Error("setTimeout has not been defined")}function Z(){throw new Error("clearTimeout has not been defined")}function W(F){if(T===setTimeout)return setTimeout(F,0);if((T===lt||!T)&&setTimeout)return T=setTimeout,setTimeout(F,0);try{return T(F,0)}catch{try{return T.call(null,F,0)}catch{return T.call(this,F,0)}}}(function(){try{T=typeof setTimeout=="function"?setTimeout:lt}catch{T=lt}try{J=typeof clearTimeout=="function"?clearTimeout:Z}catch{J=Z}})();var mt,et=[],nt=!1,ct=-1;function Nt(){nt&&mt&&(nt=!1,mt.length?et=mt.concat(et):ct=-1,et.length&&Xt())}function Xt(){if(!nt){var F=W(Nt);nt=!0;for(var z=et.length;z;){for(mt=et,et=[];++ct<z;)mt&&mt[ct].run();ct=-1,z=et.length}mt=null,nt=!1,function(rt){if(J===clearTimeout)return clearTimeout(rt);if((J===Z||!J)&&clearTimeout)return J=clearTimeout,clearTimeout(rt);try{J(rt)}catch{try{return J.call(null,rt)}catch{return J.call(this,rt)}}}(F)}}function Gt(F,z){this.fun=F,this.array=z}function L(){}G.nextTick=function(F){var z=new Array(arguments.length-1);if(arguments.length>1)for(var rt=1;rt<arguments.length;rt++)z[rt-1]=arguments[rt];et.push(new Gt(F,z)),et.length!==1||nt||W(Xt)},Gt.prototype.run=function(){this.fun.apply(null,this.array)},G.title="browser",G.browser=!0,G.env={},G.argv=[],G.version="",G.versions={},G.on=L,G.addListener=L,G.once=L,G.off=L,G.removeListener=L,G.removeAllListeners=L,G.emit=L,G.prependListener=L,G.prependOnceListener=L,G.listeners=function(F){return[]},G.binding=function(F){throw new Error("process.binding is not supported")},G.cwd=function(){return"/"},G.chdir=function(F){throw new Error("process.chdir is not supported")},G.umask=function(){return 0}},function(Ie,C,T){(function(J,G){var lt;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(Z){C&&C.nodeType,J&&J.nodeType;var W=typeof G=="object"&&G;W.global!==W&&W.window!==W&&W.self;var mt,et=2147483647,nt=/^xn--/,ct=/[^\x20-\x7E]/,Nt=/[\x2E\u3002\uFF0E\uFF61]/g,Xt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Gt=Math.floor,L=String.fromCharCode;function F(te){throw new RangeError(Xt[te])}function z(te,xt){for(var zt=te.length,Vt=[];zt--;)Vt[zt]=xt(te[zt]);return Vt}function rt(te,xt){var zt=te.split("@"),Vt="";return zt.length>1&&(Vt=zt[0]+"@",te=zt[1]),Vt+z((te=te.replace(Nt,".")).split("."),xt).join(".")}function k(te){for(var xt,zt,Vt=[],$=0,Dt=te.length;$<Dt;)(xt=te.charCodeAt($++))>=55296&&xt<=56319&&$<Dt?(64512&(zt=te.charCodeAt($++)))==56320?Vt.push(((1023&xt)<<10)+(1023&zt)+65536):(Vt.push(xt),$--):Vt.push(xt);return Vt}function X(te){return z(te,function(xt){var zt="";return xt>65535&&(zt+=L((xt-=65536)>>>10&1023|55296),xt=56320|1023&xt),zt+=L(xt)}).join("")}function tt(te,xt){return te+22+75*(te<26)-((xt!=0)<<5)}function ht(te,xt,zt){var Vt=0;for(te=zt?Gt(te/700):te>>1,te+=Gt(te/xt);te>455;Vt+=36)te=Gt(te/35);return Gt(Vt+36*te/(te+38))}function ue(te){var xt,zt,Vt,$,Dt,Ht,Yt,kt,Qt,de,Ke,ke=[],$n=te.length,Qe=0,Kn=128,kn=72;for((zt=te.lastIndexOf("-"))<0&&(zt=0),Vt=0;Vt<zt;++Vt)te.charCodeAt(Vt)>=128&&F("not-basic"),ke.push(te.charCodeAt(Vt));for($=zt>0?zt+1:0;$<$n;){for(Dt=Qe,Ht=1,Yt=36;$>=$n&&F("invalid-input"),((kt=(Ke=te.charCodeAt($++))-48<10?Ke-22:Ke-65<26?Ke-65:Ke-97<26?Ke-97:36)>=36||kt>Gt((et-Qe)/Ht))&&F("overflow"),Qe+=kt*Ht,!(kt<(Qt=Yt<=kn?1:Yt>=kn+26?26:Yt-kn));Yt+=36)Ht>Gt(et/(de=36-Qt))&&F("overflow"),Ht*=de;kn=ht(Qe-Dt,xt=ke.length+1,Dt==0),Gt(Qe/xt)>et-Kn&&F("overflow"),Kn+=Gt(Qe/xt),Qe%=xt,ke.splice(Qe++,0,Kn)}return X(ke)}function je(te){var xt,zt,Vt,$,Dt,Ht,Yt,kt,Qt,de,Ke,ke,$n,Qe,Kn,kn=[];for(ke=(te=k(te)).length,xt=128,zt=0,Dt=72,Ht=0;Ht<ke;++Ht)(Ke=te[Ht])<128&&kn.push(L(Ke));for(Vt=$=kn.length,$&&kn.push("-");Vt<ke;){for(Yt=et,Ht=0;Ht<ke;++Ht)(Ke=te[Ht])>=xt&&Ke<Yt&&(Yt=Ke);for(Yt-xt>Gt((et-zt)/($n=Vt+1))&&F("overflow"),zt+=(Yt-xt)*$n,xt=Yt,Ht=0;Ht<ke;++Ht)if((Ke=te[Ht])<xt&&++zt>et&&F("overflow"),Ke==xt){for(kt=zt,Qt=36;!(kt<(de=Qt<=Dt?1:Qt>=Dt+26?26:Qt-Dt));Qt+=36)Kn=kt-de,Qe=36-de,kn.push(L(tt(de+Kn%Qe,0))),kt=Gt(Kn/Qe);kn.push(L(tt(kt,0))),Dt=ht(zt,$n,Vt==$),zt=0,++Vt}++zt,++xt}return kn.join("")}mt={version:"1.4.1",ucs2:{decode:k,encode:X},decode:ue,encode:je,toASCII:function(te){return rt(te,function(xt){return ct.test(xt)?"xn--"+je(xt):xt})},toUnicode:function(te){return rt(te,function(xt){return nt.test(xt)?ue(xt.slice(4).toLowerCase()):xt})}},(lt=function(){return mt}.call(C,T,C,J))===void 0||(J.exports=lt)})()}).call(this,T(10)(Ie),T(4))},function(Ie,C,T){Ie.exports={isString:function(J){return typeof J=="string"},isObject:function(J){return typeof J=="object"&&J!==null},isNull:function(J){return J===null},isNullOrUndefined:function(J){return J==null}}},function(Ie,C,T){C.decode=C.parse=T(27),C.encode=C.stringify=T(28)},function(Ie,C,T){function J(lt,Z){return Object.prototype.hasOwnProperty.call(lt,Z)}Ie.exports=function(lt,Z,W,mt){Z=Z||"&",W=W||"=";var et={};if(typeof lt!="string"||lt.length===0)return et;var nt=/\+/g;lt=lt.split(Z);var ct=1e3;mt&&typeof mt.maxKeys=="number"&&(ct=mt.maxKeys);var Nt=lt.length;ct>0&&Nt>ct&&(Nt=ct);for(var Xt=0;Xt<Nt;++Xt){var Gt,L,F,z,rt=lt[Xt].replace(nt,"%20"),k=rt.indexOf(W);k>=0?(Gt=rt.substr(0,k),L=rt.substr(k+1)):(Gt=rt,L=""),F=decodeURIComponent(Gt),z=decodeURIComponent(L),J(et,F)?G(et[F])?et[F].push(z):et[F]=[et[F],z]:et[F]=z}return et};var G=Array.isArray||function(lt){return Object.prototype.toString.call(lt)==="[object Array]"}},function(Ie,C,T){var J=function(W){switch(typeof W){case"string":return W;case"boolean":return W?"true":"false";case"number":return isFinite(W)?W:"";default:return""}};Ie.exports=function(W,mt,et,nt){return mt=mt||"&",et=et||"=",W===null&&(W=void 0),typeof W=="object"?lt(Z(W),function(ct){var Nt=encodeURIComponent(J(ct))+et;return G(W[ct])?lt(W[ct],function(Xt){return Nt+encodeURIComponent(J(Xt))}).join(mt):Nt+encodeURIComponent(J(W[ct]))}).join(mt):nt?encodeURIComponent(J(nt))+et+encodeURIComponent(J(W)):""};var G=Array.isArray||function(W){return Object.prototype.toString.call(W)==="[object Array]"};function lt(W,mt){if(W.map)return W.map(mt);for(var et=[],nt=0;nt<W.length;nt++)et.push(mt(W[nt],nt));return et}var Z=Object.keys||function(W){var mt=[];for(var et in W)Object.prototype.hasOwnProperty.call(W,et)&&mt.push(et);return mt}},function(Ie,C){var T=function(){};T.prototype={fit:function(J){var G,lt,Z,W,mt=J.length,et=mt>0?J[0].width:0,nt=mt>0?J[0].height:0;for(this.root={x:0,y:0,width:et,height:nt},G=0;G<mt;G++)Z=J[G],(lt=this.findNode(this.root,Z.width,Z.height))?(W=this.splitNode(lt,Z.width,Z.height),Z.x=W.x,Z.y=W.y):(W=this.growNode(Z.width,Z.height),Z.x=W.x,Z.y=W.y)},findNode:function(J,G,lt){return J.used?this.findNode(J.right,G,lt)||this.findNode(J.down,G,lt):G<=J.width&&lt<=J.height?J:null},splitNode:function(J,G,lt){return J.used=!0,J.down={x:J.x,y:J.y+lt,width:J.width,height:J.height-lt},J.right={x:J.x+G,y:J.y,width:J.width-G,height:lt},J},growNode:function(J,G){var lt=J<=this.root.width,Z=G<=this.root.height,W=Z&&this.root.height>=this.root.width+J,mt=lt&&this.root.width>=this.root.height+G;return W?this.growRight(J,G):mt?this.growDown(J,G):Z?this.growRight(J,G):lt?this.growDown(J,G):null},growRight:function(J,G){var lt;return this.root={used:!0,x:0,y:0,width:this.root.width+J,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:J,height:this.root.height}},(lt=this.findNode(this.root,J,G))?this.splitNode(lt,J,G):null},growDown:function(J,G){var lt;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+G,down:{x:0,y:this.root.height,width:this.root.width,height:G},right:this.root},(lt=this.findNode(this.root,J,G))?this.splitNode(lt,J,G):null}},Ie.exports=T},function(Ie,C,T){T.r(C),T.d(C,"SLIDE_EVENTS",function(){return ki}),T.d(C,"Slide",function(){return Om});var J={};T.r(J),T.d(J,"isMobile",function(){return Sr}),T.d(J,"EventEmitter",function(){return ar.a}),T.d(J,"earcut",function(){return jr.a}),T.d(J,"BaseTextureCache",function(){return si}),T.d(J,"CanvasRenderTarget",function(){return Tl}),T.d(J,"DATA_URI",function(){return yh}),T.d(J,"ProgramCache",function(){return wl}),T.d(J,"TextureCache",function(){return Ki}),T.d(J,"clearTextureCache",function(){return fc}),T.d(J,"correctBlendMode",function(){return $e}),T.d(J,"createIndicesForQuads",function(){return Sn}),T.d(J,"decomposeDataUri",function(){return Do}),T.d(J,"deprecation",function(){return is}),T.d(J,"destroyTextureCache",function(){return pc}),T.d(J,"determineCrossOrigin",function(){return md}),T.d(J,"getBufferType",function(){return vr}),T.d(J,"getResolutionOfUrl",function(){return ao}),T.d(J,"hex2rgb",function(){return Yo}),T.d(J,"hex2string",function(){return jt}),T.d(J,"interleaveTypedArrays",function(){return on}),T.d(J,"isPow2",function(){return or}),T.d(J,"isWebGLSupported",function(){return Aa}),T.d(J,"log2",function(){return vi}),T.d(J,"nextPow2",function(){return ln}),T.d(J,"premultiplyBlendMode",function(){return Fe}),T.d(J,"premultiplyRgba",function(){return un}),T.d(J,"premultiplyTint",function(){return Rn}),T.d(J,"premultiplyTintToRgba",function(){return _n}),T.d(J,"removeItems",function(){return Zn}),T.d(J,"rgb2hex",function(){return xe}),T.d(J,"sayHello",function(){return ea}),T.d(J,"sign",function(){return Fr}),T.d(J,"skipHello",function(){return Ma}),T.d(J,"string2hex",function(){return Pt}),T.d(J,"trimCanvas",function(){return _h}),T.d(J,"uid",function(){return Er}),T.d(J,"url",function(){return gi});var G={};T.r(G),T.d(G,"utils",function(){return J}),T.d(G,"AccessibilityManager",function(){return Al}),T.d(G,"accessibleTarget",function(){return vd}),T.d(G,"InteractionData",function(){return oa}),T.d(G,"InteractionEvent",function(){return ou}),T.d(G,"InteractionManager",function(){return bo}),T.d(G,"InteractionTrackingData",function(){return Pl}),T.d(G,"interactiveTarget",function(){return Ts}),T.d(G,"Application",function(){return Yu}),T.d(G,"AbstractBatchRenderer",function(){return bc}),T.d(G,"AbstractMultiResource",function(){return Cr}),T.d(G,"AbstractRenderer",function(){return mu}),T.d(G,"ArrayResource",function(){return Cl}),T.d(G,"Attribute",function(){return Ll}),T.d(G,"BaseImageResource",function(){return sa}),T.d(G,"BaseRenderTexture",function(){return _d}),T.d(G,"BaseTexture",function(){return fr}),T.d(G,"BatchDrawCall",function(){return gu}),T.d(G,"BatchGeometry",function(){return kl}),T.d(G,"BatchPluginFactory",function(){return mr}),T.d(G,"BatchRenderer",function(){return Cs}),T.d(G,"BatchShaderGenerator",function(){return Xu}),T.d(G,"BatchSystem",function(){return xi}),T.d(G,"BatchTextureArray",function(){return Ul}),T.d(G,"Buffer",function(){return Yi}),T.d(G,"BufferResource",function(){return pr}),T.d(G,"CanvasResource",function(){return Qi}),T.d(G,"ContextSystem",function(){return yc}),T.d(G,"CubeResource",function(){return Rl}),T.d(G,"Filter",function(){return ro}),T.d(G,"FilterState",function(){return uu}),T.d(G,"FilterSystem",function(){return Sh}),T.d(G,"Framebuffer",function(){return ju}),T.d(G,"FramebufferSystem",function(){return Ii}),T.d(G,"GLFramebuffer",function(){return xd}),T.d(G,"GLProgram",function(){return ps}),T.d(G,"GLTexture",function(){return Fl}),T.d(G,"Geometry",function(){return Ca}),T.d(G,"GeometrySystem",function(){return Eh}),T.d(G,"IGLUniformData",function(){return ds}),T.d(G,"INSTALLED",function(){return Bt}),T.d(G,"ImageBitmapResource",function(){return Il}),T.d(G,"ImageResource",function(){return vc}),T.d(G,"MaskData",function(){return ui}),T.d(G,"MaskSystem",function(){return Nl}),T.d(G,"ObjectRenderer",function(){return Ia}),T.d(G,"Program",function(){return du}),T.d(G,"ProjectionSystem",function(){return ho}),T.d(G,"Quad",function(){return Ra}),T.d(G,"QuadUv",function(){return qi}),T.d(G,"RenderTexture",function(){return Ri}),T.d(G,"RenderTexturePool",function(){return au}),T.d(G,"RenderTextureSystem",function(){return wn}),T.d(G,"Renderer",function(){return Vs}),T.d(G,"Resource",function(){return Gn}),T.d(G,"SVGResource",function(){return su}),T.d(G,"ScissorSystem",function(){return As}),T.d(G,"Shader",function(){return Oa}),T.d(G,"ShaderSystem",function(){return js}),T.d(G,"SpriteMaskFilter",function(){return aa}),T.d(G,"State",function(){return Da}),T.d(G,"StateSystem",function(){return Ei}),T.d(G,"StencilSystem",function(){return zs}),T.d(G,"System",function(){return qo}),T.d(G,"Texture",function(){return Dn}),T.d(G,"TextureGCSystem",function(){return co}),T.d(G,"TextureMatrix",function(){return Jo}),T.d(G,"TextureSystem",function(){return fs}),T.d(G,"TextureUvs",function(){return yd}),T.d(G,"UniformGroup",function(){return uo}),T.d(G,"VideoResource",function(){return zu}),T.d(G,"ViewableBuffer",function(){return vu}),T.d(G,"autoDetectRenderer",function(){return Li}),T.d(G,"autoDetectResource",function(){return he}),T.d(G,"checkMaxIfStatementsInShader",function(){return Gs}),T.d(G,"defaultFilterVertex",function(){return Bl}),T.d(G,"defaultVertex",function(){return Ps}),T.d(G,"resources",function(){return Rs}),T.d(G,"systems",function(){return _u}),T.d(G,"uniformParsers",function(){return Ms}),T.d(G,"Extract",function(){return Gl}),T.d(G,"AppLoaderPlugin",function(){return $o}),T.d(G,"Loader",function(){return Ls}),T.d(G,"LoaderResource",function(){return Os}),T.d(G,"TextureLoader",function(){return yn}),T.d(G,"BlobResource",function(){return Hn}),T.d(G,"CompressedTextureLoader",function(){return ji}),T.d(G,"CompressedTextureResource",function(){return zl}),T.d(G,"DDSLoader",function(){return Xs}),T.d(G,"FORMATS_TO_COMPONENTS",function(){return Ns}),T.d(G,"INTERNAL_FORMATS",function(){return lr}),T.d(G,"INTERNAL_FORMAT_TO_BYTES_PER_PIXEL",function(){return bi}),T.d(G,"KTXLoader",function(){return ka}),T.d(G,"TYPES_TO_BYTES_PER_COMPONENT",function(){return Go}),T.d(G,"TYPES_TO_BYTES_PER_PIXEL",function(){return Nn}),T.d(G,"ParticleContainer",function(){return Ze}),T.d(G,"ParticleRenderer",function(){return Ad}),T.d(G,"BasePrepare",function(){return Bd}),T.d(G,"CountLimiter",function(){return Rp}),T.d(G,"Prepare",function(){return Lp}),T.d(G,"TimeLimiter",function(){return Nc}),T.d(G,"Spritesheet",function(){return kd}),T.d(G,"SpritesheetLoader",function(){return Op}),T.d(G,"TilingSprite",function(){return Fc}),T.d(G,"TilingSpriteRenderer",function(){return Dp}),T.d(G,"BitmapFont",function(){return Mu}),T.d(G,"BitmapFontData",function(){return Jl}),T.d(G,"BitmapFontLoader",function(){return pi}),T.d(G,"BitmapText",function(){return kc}),T.d(G,"Ticker",function(){return ri}),T.d(G,"TickerPlugin",function(){return ia}),T.d(G,"UPDATE_PRIORITY",function(){return No}),T.d(G,"ALPHA_MODES",function(){return It}),T.d(G,"BLEND_MODES",function(){return Ln}),T.d(G,"BUFFER_BITS",function(){return ws}),T.d(G,"CLEAR_MODES",function(){return Zt}),T.d(G,"DRAW_MODES",function(){return so}),T.d(G,"ENV",function(){return Lr}),T.d(G,"FORMATS",function(){return $i}),T.d(G,"GC_MODES",function(){return re}),T.d(G,"MASK_TYPES",function(){return Kt}),T.d(G,"MIPMAP_MODES",function(){return Ct}),T.d(G,"MSAA_QUALITY",function(){return qe}),T.d(G,"PRECISION",function(){return pe}),T.d(G,"RENDERER_TYPE",function(){return mi}),T.d(G,"SAMPLER_TYPES",function(){return ft}),T.d(G,"SCALE_MODES",function(){return dt}),T.d(G,"TARGETS",function(){return yo}),T.d(G,"TYPES",function(){return Q}),T.d(G,"WRAP_MODES",function(){return Lt}),T.d(G,"Bounds",function(){return ru}),T.d(G,"Container",function(){return Ci}),T.d(G,"DisplayObject",function(){return ci}),T.d(G,"TemporaryDisplayObject",function(){return iu}),T.d(G,"FillStyle",function(){return Ys}),T.d(G,"GRAPHICS_CURVES",function(){return Vl}),T.d(G,"Graphics",function(){return vs}),T.d(G,"GraphicsData",function(){return fa}),T.d(G,"GraphicsGeometry",function(){return Qu}),T.d(G,"LINE_CAP",function(){return er}),T.d(G,"LINE_JOIN",function(){return mo}),T.d(G,"LineStyle",function(){return Po}),T.d(G,"graphicsUtils",function(){return Mp}),T.d(G,"Circle",function(){return ei}),T.d(G,"DEG_TO_RAD",function(){return El}),T.d(G,"Ellipse",function(){return ra}),T.d(G,"Matrix",function(){return yi}),T.d(G,"ObservablePoint",function(){return eu}),T.d(G,"PI_2",function(){return Uu}),T.d(G,"Point",function(){return ai}),T.d(G,"Polygon",function(){return tu}),T.d(G,"RAD_TO_DEG",function(){return na}),T.d(G,"Rectangle",function(){return dr}),T.d(G,"RoundedRectangle",function(){return mc}),T.d(G,"SHAPES",function(){return _i}),T.d(G,"Transform",function(){return Ml}),T.d(G,"groupD8",function(){return ni}),T.d(G,"Mesh",function(){return Bs}),T.d(G,"MeshBatchUvs",function(){return Yh}),T.d(G,"MeshGeometry",function(){return zo}),T.d(G,"MeshMaterial",function(){return Zh}),T.d(G,"NineSlicePlane",function(){return Yd}),T.d(G,"PlaneGeometry",function(){return Vc}),T.d(G,"RopeGeometry",function(){return ma}),T.d(G,"SimpleMesh",function(){return Xd}),T.d(G,"SimplePlane",function(){return eh}),T.d(G,"SimpleRope",function(){return $h}),T.d(G,"Runner",function(){return di}),T.d(G,"Sprite",function(){return li}),T.d(G,"AnimatedSprite",function(){return nh}),T.d(G,"TEXT_GRADIENT",function(){return Yl}),T.d(G,"Text",function(){return Oc}),T.d(G,"TextMetrics",function(){return Ko}),T.d(G,"TextStyle",function(){return tl}),T.d(G,"isMobile",function(){return Sr}),T.d(G,"settings",function(){return ie}),T.d(G,"VERSION",function(){return Wc}),T.d(G,"filters",function(){return Iu});var lt=T(0),Z=T.n(lt),W=T(1),mt=T(13),et=T(14),nt=T(17),ct=T.n(nt);/*!
 * @pixi/polyfill - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */if(self.Promise||(self.Promise=et.a),Object.assign||(Object.assign=ct.a),Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()}),!self.performance||!self.performance.now){var Nt=Date.now();self.performance||(self.performance={}),self.performance.now=function(){return Date.now()-Nt}}for(var Xt=Date.now(),Gt=["ms","moz","webkit","o"],L=0;L<Gt.length&&!self.requestAnimationFrame;++L){var F=Gt[L];self.requestAnimationFrame=self[F+"RequestAnimationFrame"],self.cancelAnimationFrame=self[F+"CancelAnimationFrame"]||self[F+"CancelRequestAnimationFrame"]}self.requestAnimationFrame||(self.requestAnimationFrame=function(o){if(typeof o!="function")throw new TypeError(o+"is not a function");var n=Date.now(),e=16+Xt-n;return e<0&&(e=0),Xt=n,self.setTimeout(function(){Xt=Date.now(),o(performance.now())},e)}),self.cancelAnimationFrame||(self.cancelAnimationFrame=function(o){return clearTimeout(o)}),Math.sign||(Math.sign=function(o){return(o=Number(o))===0||isNaN(o)?o:o>0?1:-1}),Number.isInteger||(Number.isInteger=function(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o}),self.ArrayBuffer||(self.ArrayBuffer=Array),self.Float32Array||(self.Float32Array=Array),self.Uint32Array||(self.Uint32Array=Array),self.Uint16Array||(self.Uint16Array=Array),self.Uint8Array||(self.Uint8Array=Array),self.Int32Array||(self.Int32Array=Array);var z=/iPhone/i,rt=/iPod/i,k=/iPad/i,X=/\biOS-universal(?:.+)Mac\b/i,tt=/\bAndroid(?:.+)Mobile\b/i,ht=/Android/i,ue=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,je=/Silk/i,te=/Windows Phone/i,xt=/\bWindows(?:.+)ARM\b/i,zt=/BlackBerry/i,Vt=/BB10/i,$=/Opera Mini/i,Dt=/\b(CriOS|Chrome)(?:.+)Mobile/i,Ht=/Mobile(?:.+)Firefox\b/i,Yt=function(o){return o!==void 0&&o.platform==="MacIntel"&&typeof o.maxTouchPoints=="number"&&o.maxTouchPoints>1&&typeof MSStream=="undefined"};/*!
 * @pixi/settings - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var kt,Qt,de,Ke,ke,$n,Qe,Kn,kn,qn,bn,Nr,kr,Ir,Jr,Pr,Ur,Xi,Sr=function(o){var n={userAgent:"",platform:"",maxTouchPoints:0};o||typeof navigator=="undefined"?typeof o=="string"?n.userAgent=o:o&&o.userAgent&&(n={userAgent:o.userAgent,platform:o.platform,maxTouchPoints:o.maxTouchPoints||0}):n={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var e=n.userAgent,r=e.split("[FBAN");r[1]!==void 0&&(e=r[0]),(r=e.split("Twitter"))[1]!==void 0&&(e=r[0]);var s=function(h){return function(m){return m.test(h)}}(e),l={apple:{phone:s(z)&&!s(te),ipod:s(rt),tablet:!s(z)&&(s(k)||Yt(n))&&!s(te),universal:s(X),device:(s(z)||s(rt)||s(k)||s(X)||Yt(n))&&!s(te)},amazon:{phone:s(ue),tablet:!s(ue)&&s(je),device:s(ue)||s(je)},android:{phone:!s(te)&&s(ue)||!s(te)&&s(tt),tablet:!s(te)&&!s(ue)&&!s(tt)&&(s(je)||s(ht)),device:!s(te)&&(s(ue)||s(je)||s(tt)||s(ht))||s(/\bokhttp\b/i)},windows:{phone:s(te),tablet:s(xt),device:s(te)||s(xt)},other:{blackberry:s(zt),blackberry10:s(Vt),opera:s($),firefox:s(Ht),chrome:s(Dt),device:s(zt)||s(Vt)||s($)||s(Ht)||s(Dt)},any:!1,phone:!1,tablet:!1};return l.any=l.apple.device||l.android.device||l.windows.device||l.other.device,l.phone=l.apple.phone||l.android.phone||l.windows.phone,l.tablet=l.apple.tablet||l.android.tablet||l.windows.tablet,l}(self.navigator);(function(o){o[o.WEBGL_LEGACY=0]="WEBGL_LEGACY",o[o.WEBGL=1]="WEBGL",o[o.WEBGL2=2]="WEBGL2"})(kt||(kt={})),function(o){o[o.UNKNOWN=0]="UNKNOWN",o[o.WEBGL=1]="WEBGL",o[o.CANVAS=2]="CANVAS"}(Qt||(Qt={})),function(o){o[o.COLOR=16384]="COLOR",o[o.DEPTH=256]="DEPTH",o[o.STENCIL=1024]="STENCIL"}(de||(de={})),function(o){o[o.NORMAL=0]="NORMAL",o[o.ADD=1]="ADD",o[o.MULTIPLY=2]="MULTIPLY",o[o.SCREEN=3]="SCREEN",o[o.OVERLAY=4]="OVERLAY",o[o.DARKEN=5]="DARKEN",o[o.LIGHTEN=6]="LIGHTEN",o[o.COLOR_DODGE=7]="COLOR_DODGE",o[o.COLOR_BURN=8]="COLOR_BURN",o[o.HARD_LIGHT=9]="HARD_LIGHT",o[o.SOFT_LIGHT=10]="SOFT_LIGHT",o[o.DIFFERENCE=11]="DIFFERENCE",o[o.EXCLUSION=12]="EXCLUSION",o[o.HUE=13]="HUE",o[o.SATURATION=14]="SATURATION",o[o.COLOR=15]="COLOR",o[o.LUMINOSITY=16]="LUMINOSITY",o[o.NORMAL_NPM=17]="NORMAL_NPM",o[o.ADD_NPM=18]="ADD_NPM",o[o.SCREEN_NPM=19]="SCREEN_NPM",o[o.NONE=20]="NONE",o[o.SRC_OVER=0]="SRC_OVER",o[o.SRC_IN=21]="SRC_IN",o[o.SRC_OUT=22]="SRC_OUT",o[o.SRC_ATOP=23]="SRC_ATOP",o[o.DST_OVER=24]="DST_OVER",o[o.DST_IN=25]="DST_IN",o[o.DST_OUT=26]="DST_OUT",o[o.DST_ATOP=27]="DST_ATOP",o[o.ERASE=26]="ERASE",o[o.SUBTRACT=28]="SUBTRACT",o[o.XOR=29]="XOR"}(Ke||(Ke={})),function(o){o[o.POINTS=0]="POINTS",o[o.LINES=1]="LINES",o[o.LINE_LOOP=2]="LINE_LOOP",o[o.LINE_STRIP=3]="LINE_STRIP",o[o.TRIANGLES=4]="TRIANGLES",o[o.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",o[o.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(ke||(ke={})),function(o){o[o.RGBA=6408]="RGBA",o[o.RGB=6407]="RGB",o[o.ALPHA=6406]="ALPHA",o[o.LUMINANCE=6409]="LUMINANCE",o[o.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",o[o.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",o[o.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}($n||($n={})),function(o){o[o.TEXTURE_2D=3553]="TEXTURE_2D",o[o.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",o[o.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",o[o.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",o[o.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",o[o.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",o[o.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Qe||(Qe={})),function(o){o[o.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",o[o.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",o[o.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",o[o.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",o[o.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",o[o.FLOAT=5126]="FLOAT",o[o.HALF_FLOAT=36193]="HALF_FLOAT"}(Kn||(Kn={})),function(o){o[o.FLOAT=0]="FLOAT",o[o.INT=1]="INT",o[o.UINT=2]="UINT"}(kn||(kn={})),function(o){o[o.NEAREST=0]="NEAREST",o[o.LINEAR=1]="LINEAR"}(qn||(qn={})),function(o){o[o.CLAMP=33071]="CLAMP",o[o.REPEAT=10497]="REPEAT",o[o.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(bn||(bn={})),function(o){o[o.OFF=0]="OFF",o[o.POW2=1]="POW2",o[o.ON=2]="ON",o[o.ON_MANUAL=3]="ON_MANUAL"}(Nr||(Nr={})),function(o){o[o.NPM=0]="NPM",o[o.UNPACK=1]="UNPACK",o[o.PMA=2]="PMA",o[o.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",o[o.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",o[o.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(kr||(kr={})),function(o){o[o.NO=0]="NO",o[o.YES=1]="YES",o[o.AUTO=2]="AUTO",o[o.BLEND=0]="BLEND",o[o.CLEAR=1]="CLEAR",o[o.BLIT=2]="BLIT"}(Ir||(Ir={})),function(o){o[o.AUTO=0]="AUTO",o[o.MANUAL=1]="MANUAL"}(Jr||(Jr={})),function(o){o.LOW="lowp",o.MEDIUM="mediump",o.HIGH="highp"}(Pr||(Pr={})),function(o){o[o.NONE=0]="NONE",o[o.SCISSOR=1]="SCISSOR",o[o.STENCIL=2]="STENCIL",o[o.SPRITE=3]="SPRITE"}(Ur||(Ur={})),function(o){o[o.NONE=0]="NONE",o[o.LOW=2]="LOW",o[o.MEDIUM=4]="MEDIUM",o[o.HIGH=8]="HIGH"}(Xi||(Xi={}));var Lr,mi,ws,Ln,so,$i,yo,Q,ft,dt,Lt,Ct,It,Zt,re,pe,Kt,qe,ie={MIPMAP_TEXTURES:Nr.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(o){var n=!0;if(Sr.tablet||Sr.phone){var e;Sr.apple.device&&(e=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(e[1],10)<11&&(n=!1),Sr.android.device&&(e=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(e[1],10)<7&&(n=!1)}return n?o:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:Jr.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:bn.CLAMP,SCALE_MODE:qn.LINEAR,PRECISION_VERTEX:Pr.HIGH,PRECISION_FRAGMENT:Sr.apple.device?Pr.HIGH:Pr.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!Sr.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},Pn=T(11),ar=T.n(Pn),Un=T(12),jr=T.n(Un),Xo=T(6);(function(o){o[o.WEBGL_LEGACY=0]="WEBGL_LEGACY",o[o.WEBGL=1]="WEBGL",o[o.WEBGL2=2]="WEBGL2"})(Lr||(Lr={})),function(o){o[o.UNKNOWN=0]="UNKNOWN",o[o.WEBGL=1]="WEBGL",o[o.CANVAS=2]="CANVAS"}(mi||(mi={})),function(o){o[o.COLOR=16384]="COLOR",o[o.DEPTH=256]="DEPTH",o[o.STENCIL=1024]="STENCIL"}(ws||(ws={})),function(o){o[o.NORMAL=0]="NORMAL",o[o.ADD=1]="ADD",o[o.MULTIPLY=2]="MULTIPLY",o[o.SCREEN=3]="SCREEN",o[o.OVERLAY=4]="OVERLAY",o[o.DARKEN=5]="DARKEN",o[o.LIGHTEN=6]="LIGHTEN",o[o.COLOR_DODGE=7]="COLOR_DODGE",o[o.COLOR_BURN=8]="COLOR_BURN",o[o.HARD_LIGHT=9]="HARD_LIGHT",o[o.SOFT_LIGHT=10]="SOFT_LIGHT",o[o.DIFFERENCE=11]="DIFFERENCE",o[o.EXCLUSION=12]="EXCLUSION",o[o.HUE=13]="HUE",o[o.SATURATION=14]="SATURATION",o[o.COLOR=15]="COLOR",o[o.LUMINOSITY=16]="LUMINOSITY",o[o.NORMAL_NPM=17]="NORMAL_NPM",o[o.ADD_NPM=18]="ADD_NPM",o[o.SCREEN_NPM=19]="SCREEN_NPM",o[o.NONE=20]="NONE",o[o.SRC_OVER=0]="SRC_OVER",o[o.SRC_IN=21]="SRC_IN",o[o.SRC_OUT=22]="SRC_OUT",o[o.SRC_ATOP=23]="SRC_ATOP",o[o.DST_OVER=24]="DST_OVER",o[o.DST_IN=25]="DST_IN",o[o.DST_OUT=26]="DST_OUT",o[o.DST_ATOP=27]="DST_ATOP",o[o.ERASE=26]="ERASE",o[o.SUBTRACT=28]="SUBTRACT",o[o.XOR=29]="XOR"}(Ln||(Ln={})),function(o){o[o.POINTS=0]="POINTS",o[o.LINES=1]="LINES",o[o.LINE_LOOP=2]="LINE_LOOP",o[o.LINE_STRIP=3]="LINE_STRIP",o[o.TRIANGLES=4]="TRIANGLES",o[o.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",o[o.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(so||(so={})),function(o){o[o.RGBA=6408]="RGBA",o[o.RGB=6407]="RGB",o[o.ALPHA=6406]="ALPHA",o[o.LUMINANCE=6409]="LUMINANCE",o[o.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",o[o.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",o[o.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}($i||($i={})),function(o){o[o.TEXTURE_2D=3553]="TEXTURE_2D",o[o.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",o[o.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",o[o.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",o[o.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",o[o.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",o[o.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(yo||(yo={})),function(o){o[o.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",o[o.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",o[o.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",o[o.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",o[o.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",o[o.FLOAT=5126]="FLOAT",o[o.HALF_FLOAT=36193]="HALF_FLOAT"}(Q||(Q={})),function(o){o[o.FLOAT=0]="FLOAT",o[o.INT=1]="INT",o[o.UINT=2]="UINT"}(ft||(ft={})),function(o){o[o.NEAREST=0]="NEAREST",o[o.LINEAR=1]="LINEAR"}(dt||(dt={})),function(o){o[o.CLAMP=33071]="CLAMP",o[o.REPEAT=10497]="REPEAT",o[o.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Lt||(Lt={})),function(o){o[o.OFF=0]="OFF",o[o.POW2=1]="POW2",o[o.ON=2]="ON",o[o.ON_MANUAL=3]="ON_MANUAL"}(Ct||(Ct={})),function(o){o[o.NPM=0]="NPM",o[o.UNPACK=1]="UNPACK",o[o.PMA=2]="PMA",o[o.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",o[o.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",o[o.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(It||(It={})),function(o){o[o.NO=0]="NO",o[o.YES=1]="YES",o[o.AUTO=2]="AUTO",o[o.BLEND=0]="BLEND",o[o.CLEAR=1]="CLEAR",o[o.BLIT=2]="BLIT"}(Zt||(Zt={})),function(o){o[o.AUTO=0]="AUTO",o[o.MANUAL=1]="MANUAL"}(re||(re={})),function(o){o.LOW="lowp",o.MEDIUM="mediump",o.HIGH="highp"}(pe||(pe={})),function(o){o[o.NONE=0]="NONE",o[o.SCISSOR=1]="SCISSOR",o[o.STENCIL=2]="STENCIL",o[o.SPRITE=3]="SPRITE"}(Kt||(Kt={})),function(o){o[o.NONE=0]="NONE",o[o.LOW=2]="LOW",o[o.MEDIUM=4]="MEDIUM",o[o.HIGH=8]="HIGH"}(qe||(qe={}));/*!
 * @pixi/utils - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var gi={parse:Xo.parse,format:Xo.format,resolve:Xo.resolve};ie.RETINA_PREFIX=/@([0-9\.]+)x/,ie.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Qa,Oo=!1;function Ma(){Oo=!0}function ea(o){var n;if(!Oo){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=[`
 %c %c %c PixiJS 6.0.4 - \u2730 `+o+` \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(n=self.console).log.apply(n,e)}else self.console&&self.console.log("PixiJS 6.0.4 - "+o+" - http://www.pixijs.com/");Oo=!0}}function Aa(){return Qa===void 0&&(Qa=function(){var o={stencil:!0,failIfMajorPerformanceCaveat:ie.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!self.WebGLRenderingContext)return!1;var n=document.createElement("canvas"),e=n.getContext("webgl",o)||n.getContext("experimental-webgl",o),r=!(!e||!e.getContextAttributes().stencil);if(e){var s=e.getExtension("WEBGL_lose_context");s&&s.loseContext()}return e=null,r}catch{return!1}}()),Qa}var vh={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Yo(o,n){return n===void 0&&(n=[]),n[0]=(o>>16&255)/255,n[1]=(o>>8&255)/255,n[2]=(255&o)/255,n}function jt(o){var n=o.toString(16);return"#"+(n="000000".substr(0,6-n.length)+n)}function Pt(o){return typeof o=="string"&&(o=vh[o.toLowerCase()]||o)[0]==="#"&&(o=o.substr(1)),parseInt(o,16)}function xe(o){return(255*o[0]<<16)+(255*o[1]<<8)+(255*o[2]|0)}var Fe=function(){for(var o=[],n=[],e=0;e<32;e++)o[e]=e,n[e]=e;o[Ln.NORMAL_NPM]=Ln.NORMAL,o[Ln.ADD_NPM]=Ln.ADD,o[Ln.SCREEN_NPM]=Ln.SCREEN,n[Ln.NORMAL]=Ln.NORMAL_NPM,n[Ln.ADD]=Ln.ADD_NPM,n[Ln.SCREEN]=Ln.SCREEN_NPM;var r=[];return r.push(n),r.push(o),r}();function $e(o,n){return Fe[n?1:0][o]}function un(o,n,e,r){return e=e||new Float32Array(4),r||r===void 0?(e[0]=o[0]*n,e[1]=o[1]*n,e[2]=o[2]*n):(e[0]=o[0],e[1]=o[1],e[2]=o[2]),e[3]=n,e}function Rn(o,n){if(n===1)return(255*n<<24)+o;if(n===0)return 0;var e=o>>16&255,r=o>>8&255,s=255&o;return(255*n<<24)+((e=e*n+.5|0)<<16)+((r=r*n+.5|0)<<8)+(s=s*n+.5|0)}function _n(o,n,e,r){return(e=e||new Float32Array(4))[0]=(o>>16&255)/255,e[1]=(o>>8&255)/255,e[2]=(255&o)/255,(r||r===void 0)&&(e[0]*=n,e[1]*=n,e[2]*=n),e[3]=n,e}function Sn(o,n){n===void 0&&(n=null);var e=6*o;if((n=n||new Uint16Array(e)).length!==e)throw new Error("Out buffer length is incorrect, got "+n.length+" and expected "+e);for(var r=0,s=0;r<e;r+=6,s+=4)n[r+0]=s+0,n[r+1]=s+1,n[r+2]=s+2,n[r+3]=s+0,n[r+4]=s+2,n[r+5]=s+3;return n}function vr(o){if(o.BYTES_PER_ELEMENT===4)return o instanceof Float32Array?"Float32Array":o instanceof Uint32Array?"Uint32Array":"Int32Array";if(o.BYTES_PER_ELEMENT===2){if(o instanceof Uint16Array)return"Uint16Array"}else if(o.BYTES_PER_ELEMENT===1&&o instanceof Uint8Array)return"Uint8Array";return null}var _r={Float32Array,Uint32Array,Int32Array,Uint8Array};function on(o,n){for(var e=0,r=0,s={},l=0;l<o.length;l++)r+=n[l],e+=o[l].length;var h=new ArrayBuffer(4*e),m=null,x=0;for(l=0;l<o.length;l++){var b=n[l],w=o[l],R=vr(w);s[R]||(s[R]=new _r[R](h)),m=s[R];for(var U=0;U<w.length;U++)m[(U/b|0)*r+x+U%b]=w[U];x+=b}return new Float32Array(h)}function ln(o){return o+=o===0?1:0,--o,o|=o>>>1,o|=o>>>2,o|=o>>>4,o|=o>>>8,(o|=o>>>16)+1}function or(o){return!(o&o-1||!o)}function vi(o){var n=(o>65535?1:0)<<4,e=((o>>>=n)>255?1:0)<<3;return n|=e,n|=e=((o>>>=e)>15?1:0)<<2,(n|=e=((o>>>=e)>3?1:0)<<1)|(o>>>=e)>>1}function Zn(o,n,e){var r,s=o.length;if(!(n>=s||e===0)){var l=s-(e=n+e>s?s-n:e);for(r=n;r<l;++r)o[r]=o[r+e];o.length=l}}function Fr(o){return o===0?0:o<0?-1:1}var hi=0;function Er(){return++hi}var $r={};function is(o,n,e){if(e===void 0&&(e=3),!$r[n]){var r=new Error().stack;r===void 0?console.warn("PixiJS Deprecation Warning: ",n+`
Deprecated since v`+o):(r=r.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",n+`
Deprecated since v`+o),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",n+`
Deprecated since v`+o),console.warn(r))),$r[n]=!0}}var wl={},Ki=Object.create(null),si=Object.create(null);function pc(){var o;for(o in Ki)Ki[o].destroy();for(o in si)si[o].destroy()}function fc(){var o;for(o in Ki)delete Ki[o];for(o in si)delete si[o]}var Tl=function(){function o(n,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||ie.RESOLUTION,this.resize(n,e)}return o.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},o.prototype.resize=function(n,e){this.canvas.width=n*this.resolution,this.canvas.height=e*this.resolution},o.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(o.prototype,"width",{get:function(){return this.canvas.width},set:function(n){this.canvas.width=n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.canvas.height},set:function(n){this.canvas.height=n},enumerable:!1,configurable:!0}),o}();function _h(o){var n,e,r,s=o.width,l=o.height,h=o.getContext("2d"),m=h.getImageData(0,0,s,l).data,x=m.length,b={top:null,left:null,right:null,bottom:null},w=null;for(n=0;n<x;n+=4)m[n+3]!==0&&(e=n/4%s,r=~~(n/4/s),b.top===null&&(b.top=r),(b.left===null||e<b.left)&&(b.left=e),(b.right===null||b.right<e)&&(b.right=e+1),(b.bottom===null||b.bottom<r)&&(b.bottom=r));return b.top!==null&&(s=b.right-b.left,l=b.bottom-b.top+1,w=h.getImageData(b.left,b.top,s,l)),{height:l,width:s,data:w}}var Sl,yh=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Do(o){var n=yh.exec(o);if(n)return{mediaType:n[1]?n[1].toLowerCase():void 0,subType:n[2]?n[2].toLowerCase():void 0,charset:n[3]?n[3].toLowerCase():void 0,encoding:n[4]?n[4].toLowerCase():void 0,data:n[5]}}function md(o,n){if(n===void 0&&(n=self.location),o.indexOf("data:")===0)return"";n=n||self.location,Sl||(Sl=document.createElement("a")),Sl.href=o;var e=gi.parse(Sl.href),r=!e.port&&n.port===""||e.port===n.port;return e.hostname===n.hostname&&r&&e.protocol===n.protocol?"":"anonymous"}function ao(o,n){var e=ie.RETINA_PREFIX.exec(o);return e?parseFloat(e[1]):n!==void 0?n:1}/*!
 * @pixi/math - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var _i,Uu=2*Math.PI,na=180/Math.PI,El=Math.PI/180;(function(o){o[o.POLY=0]="POLY",o[o.RECT=1]="RECT",o[o.CIRC=2]="CIRC",o[o.ELIP=3]="ELIP",o[o.RREC=4]="RREC"})(_i||(_i={}));var dr=function(){function o(n,e,r,s){n===void 0&&(n=0),e===void 0&&(e=0),r===void 0&&(r=0),s===void 0&&(s=0),this.x=Number(n),this.y=Number(e),this.width=Number(r),this.height=Number(s),this.type=_i.RECT}return Object.defineProperty(o.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(o,"EMPTY",{get:function(){return new o(0,0,0,0)},enumerable:!1,configurable:!0}),o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height)},o.prototype.copyFrom=function(n){return this.x=n.x,this.y=n.y,this.width=n.width,this.height=n.height,this},o.prototype.copyTo=function(n){return n.x=this.x,n.y=this.y,n.width=this.width,n.height=this.height,n},o.prototype.contains=function(n,e){return!(this.width<=0||this.height<=0)&&n>=this.x&&n<this.x+this.width&&e>=this.y&&e<this.y+this.height},o.prototype.pad=function(n,e){return n===void 0&&(n=0),e===void 0&&(e=n),this.x-=n,this.y-=e,this.width+=2*n,this.height+=2*e,this},o.prototype.fit=function(n){var e=Math.max(this.x,n.x),r=Math.min(this.x+this.width,n.x+n.width),s=Math.max(this.y,n.y),l=Math.min(this.y+this.height,n.y+n.height);return this.x=e,this.width=Math.max(r-e,0),this.y=s,this.height=Math.max(l-s,0),this},o.prototype.ceil=function(n,e){n===void 0&&(n=1),e===void 0&&(e=.001);var r=Math.ceil((this.x+this.width-e)*n)/n,s=Math.ceil((this.y+this.height-e)*n)/n;return this.x=Math.floor((this.x+e)*n)/n,this.y=Math.floor((this.y+e)*n)/n,this.width=r-this.x,this.height=s-this.y,this},o.prototype.enlarge=function(n){var e=Math.min(this.x,n.x),r=Math.max(this.x+this.width,n.x+n.width),s=Math.min(this.y,n.y),l=Math.max(this.y+this.height,n.y+n.height);return this.x=e,this.width=r-e,this.y=s,this.height=l-s,this},o.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},o}(),ei=function(){function o(n,e,r){n===void 0&&(n=0),e===void 0&&(e=0),r===void 0&&(r=0),this.x=n,this.y=e,this.radius=r,this.type=_i.CIRC}return o.prototype.clone=function(){return new o(this.x,this.y,this.radius)},o.prototype.contains=function(n,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,s=this.x-n,l=this.y-e;return(s*=s)+(l*=l)<=r},o.prototype.getBounds=function(){return new dr(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},o.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},o}(),ra=function(){function o(n,e,r,s){n===void 0&&(n=0),e===void 0&&(e=0),r===void 0&&(r=0),s===void 0&&(s=0),this.x=n,this.y=e,this.width=r,this.height=s,this.type=_i.ELIP}return o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height)},o.prototype.contains=function(n,e){if(this.width<=0||this.height<=0)return!1;var r=(n-this.x)/this.width,s=(e-this.y)/this.height;return(r*=r)+(s*=s)<=1},o.prototype.getBounds=function(){return new dr(this.x-this.width,this.y-this.height,this.width,this.height)},o.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},o}(),tu=function(){function o(){for(var n=arguments,e=[],r=0;r<arguments.length;r++)e[r]=n[r];var s=Array.isArray(e[0])?e[0]:e;if(typeof s[0]!="number"){for(var l=[],h=0,m=s.length;h<m;h++)l.push(s[h].x,s[h].y);s=l}this.points=s,this.type=_i.POLY,this.closeStroke=!0}return o.prototype.clone=function(){var n=new o(this.points.slice());return n.closeStroke=this.closeStroke,n},o.prototype.contains=function(n,e){for(var r=!1,s=this.points.length/2,l=0,h=s-1;l<s;h=l++){var m=this.points[2*l],x=this.points[2*l+1],b=this.points[2*h],w=this.points[2*h+1];x>e!=w>e&&n<(e-x)/(w-x)*(b-m)+m&&(r=!r)}return r},o.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce(function(n,e){return n+", "+e},"")+"]"},o}(),mc=function(){function o(n,e,r,s,l){n===void 0&&(n=0),e===void 0&&(e=0),r===void 0&&(r=0),s===void 0&&(s=0),l===void 0&&(l=20),this.x=n,this.y=e,this.width=r,this.height=s,this.radius=l,this.type=_i.RREC}return o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.radius)},o.prototype.contains=function(n,e){if(this.width<=0||this.height<=0)return!1;if(n>=this.x&&n<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||n>=this.x+this.radius&&n<=this.x+this.width-this.radius)return!0;var r=n-(this.x+this.radius),s=e-(this.y+this.radius),l=this.radius*this.radius;if(r*r+s*s<=l||(r=n-(this.x+this.width-this.radius))*r+s*s<=l||r*r+(s=e-(this.y+this.height-this.radius))*s<=l||(r=n-(this.x+this.radius))*r+s*s<=l)return!0}return!1},o.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},o}(),ai=function(){function o(n,e){n===void 0&&(n=0),e===void 0&&(e=0),this.x=0,this.y=0,this.x=n,this.y=e}return o.prototype.clone=function(){return new o(this.x,this.y)},o.prototype.copyFrom=function(n){return this.set(n.x,n.y),this},o.prototype.copyTo=function(n){return n.set(this.x,this.y),n},o.prototype.equals=function(n){return n.x===this.x&&n.y===this.y},o.prototype.set=function(n,e){return n===void 0&&(n=0),e===void 0&&(e=n),this.x=n,this.y=e,this},o.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},o}(),eu=function(){function o(n,e,r,s){r===void 0&&(r=0),s===void 0&&(s=0),this._x=r,this._y=s,this.cb=n,this.scope=e}return o.prototype.clone=function(n,e){return n===void 0&&(n=this.cb),e===void 0&&(e=this.scope),new o(n,e,this._x,this._y)},o.prototype.set=function(n,e){return n===void 0&&(n=0),e===void 0&&(e=n),this._x===n&&this._y===e||(this._x=n,this._y=e,this.cb.call(this.scope)),this},o.prototype.copyFrom=function(n){return this._x===n.x&&this._y===n.y||(this._x=n.x,this._y=n.y,this.cb.call(this.scope)),this},o.prototype.copyTo=function(n){return n.set(this._x,this._y),n},o.prototype.equals=function(n){return n.x===this._x&&n.y===this._y},o.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(o.prototype,"x",{get:function(){return this._x},set:function(n){this._x!==n&&(this._x=n,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"y",{get:function(){return this._y},set:function(n){this._y!==n&&(this._y=n,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),o}(),yi=function(){function o(n,e,r,s,l,h){n===void 0&&(n=1),e===void 0&&(e=0),r===void 0&&(r=0),s===void 0&&(s=1),l===void 0&&(l=0),h===void 0&&(h=0),this.array=null,this.a=n,this.b=e,this.c=r,this.d=s,this.tx=l,this.ty=h}return o.prototype.fromArray=function(n){this.a=n[0],this.b=n[1],this.c=n[3],this.d=n[4],this.tx=n[2],this.ty=n[5]},o.prototype.set=function(n,e,r,s,l,h){return this.a=n,this.b=e,this.c=r,this.d=s,this.tx=l,this.ty=h,this},o.prototype.toArray=function(n,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return n?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},o.prototype.apply=function(n,e){e=e||new ai;var r=n.x,s=n.y;return e.x=this.a*r+this.c*s+this.tx,e.y=this.b*r+this.d*s+this.ty,e},o.prototype.applyInverse=function(n,e){e=e||new ai;var r=1/(this.a*this.d+this.c*-this.b),s=n.x,l=n.y;return e.x=this.d*r*s+-this.c*r*l+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*l+-this.b*r*s+(-this.ty*this.a+this.tx*this.b)*r,e},o.prototype.translate=function(n,e){return this.tx+=n,this.ty+=e,this},o.prototype.scale=function(n,e){return this.a*=n,this.d*=e,this.c*=n,this.b*=e,this.tx*=n,this.ty*=e,this},o.prototype.rotate=function(n){var e=Math.cos(n),r=Math.sin(n),s=this.a,l=this.c,h=this.tx;return this.a=s*e-this.b*r,this.b=s*r+this.b*e,this.c=l*e-this.d*r,this.d=l*r+this.d*e,this.tx=h*e-this.ty*r,this.ty=h*r+this.ty*e,this},o.prototype.append=function(n){var e=this.a,r=this.b,s=this.c,l=this.d;return this.a=n.a*e+n.b*s,this.b=n.a*r+n.b*l,this.c=n.c*e+n.d*s,this.d=n.c*r+n.d*l,this.tx=n.tx*e+n.ty*s+this.tx,this.ty=n.tx*r+n.ty*l+this.ty,this},o.prototype.setTransform=function(n,e,r,s,l,h,m,x,b){return this.a=Math.cos(m+b)*l,this.b=Math.sin(m+b)*l,this.c=-Math.sin(m-x)*h,this.d=Math.cos(m-x)*h,this.tx=n-(r*this.a+s*this.c),this.ty=e-(r*this.b+s*this.d),this},o.prototype.prepend=function(n){var e=this.tx;if(n.a!==1||n.b!==0||n.c!==0||n.d!==1){var r=this.a,s=this.c;this.a=r*n.a+this.b*n.c,this.b=r*n.b+this.b*n.d,this.c=s*n.a+this.d*n.c,this.d=s*n.b+this.d*n.d}return this.tx=e*n.a+this.ty*n.c+n.tx,this.ty=e*n.b+this.ty*n.d+n.ty,this},o.prototype.decompose=function(n){var e=this.a,r=this.b,s=this.c,l=this.d,h=n.pivot,m=-Math.atan2(-s,l),x=Math.atan2(r,e),b=Math.abs(m+x);return b<1e-5||Math.abs(Uu-b)<1e-5?(n.rotation=x,n.skew.x=n.skew.y=0):(n.rotation=0,n.skew.x=m,n.skew.y=x),n.scale.x=Math.sqrt(e*e+r*r),n.scale.y=Math.sqrt(s*s+l*l),n.position.x=this.tx+(h.x*e+h.y*s),n.position.y=this.ty+(h.x*r+h.y*l),n},o.prototype.invert=function(){var n=this.a,e=this.b,r=this.c,s=this.d,l=this.tx,h=n*s-e*r;return this.a=s/h,this.b=-e/h,this.c=-r/h,this.d=n/h,this.tx=(r*this.ty-s*l)/h,this.ty=-(n*this.ty-e*l)/h,this},o.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},o.prototype.clone=function(){var n=new o;return n.a=this.a,n.b=this.b,n.c=this.c,n.d=this.d,n.tx=this.tx,n.ty=this.ty,n},o.prototype.copyTo=function(n){return n.a=this.a,n.b=this.b,n.c=this.c,n.d=this.d,n.tx=this.tx,n.ty=this.ty,n},o.prototype.copyFrom=function(n){return this.a=n.a,this.b=n.b,this.c=n.c,this.d=n.d,this.tx=n.tx,this.ty=n.ty,this},o.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(o,"IDENTITY",{get:function(){return new o},enumerable:!1,configurable:!0}),Object.defineProperty(o,"TEMP_MATRIX",{get:function(){return new o},enumerable:!1,configurable:!0}),o}(),ks=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],os=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],nu=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Pa=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],xh=[],bh=[],ku=Math.sign;(function(){for(var o=0;o<16;o++){var n=[];xh.push(n);for(var e=0;e<16;e++)for(var r=ku(ks[o]*ks[e]+nu[o]*os[e]),s=ku(os[o]*ks[e]+Pa[o]*os[e]),l=ku(ks[o]*nu[e]+nu[o]*Pa[e]),h=ku(os[o]*nu[e]+Pa[o]*Pa[e]),m=0;m<16;m++)if(ks[m]===r&&os[m]===s&&nu[m]===l&&Pa[m]===h){n.push(m);break}}for(o=0;o<16;o++){var x=new yi;x.set(ks[o],os[o],nu[o],Pa[o],0,0),bh.push(x)}})();var ni={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(o){return ks[o]},uY:function(o){return os[o]},vX:function(o){return nu[o]},vY:function(o){return Pa[o]},inv:function(o){return 8&o?15&o:7&-o},add:function(o,n){return xh[o][n]},sub:function(o,n){return xh[o][ni.inv(n)]},rotate180:function(o){return 4^o},isVertical:function(o){return(3&o)==2},byDirection:function(o,n){return 2*Math.abs(o)<=Math.abs(n)?n>=0?ni.S:ni.N:2*Math.abs(n)<=Math.abs(o)?o>0?ni.E:ni.W:n>0?o>0?ni.SE:ni.SW:o>0?ni.NE:ni.NW},matrixAppendRotationInv:function(o,n,e,r){e===void 0&&(e=0),r===void 0&&(r=0);var s=bh[ni.inv(n)];s.tx=e,s.ty=r,o.append(s)}},Ml=function(){function o(){this.worldTransform=new yi,this.localTransform=new yi,this.position=new eu(this.onChange,this,0,0),this.scale=new eu(this.onChange,this,1,1),this.pivot=new eu(this.onChange,this,0,0),this.skew=new eu(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return o.prototype.onChange=function(){this._localID++},o.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},o.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},o.prototype.updateLocalTransform=function(){var n=this.localTransform;this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d),this._currentLocalID=this._localID,this._parentID=-1)},o.prototype.updateTransform=function(n){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==n._worldID){var r=n.worldTransform,s=this.worldTransform;s.a=e.a*r.a+e.b*r.c,s.b=e.a*r.b+e.b*r.d,s.c=e.c*r.a+e.d*r.c,s.d=e.c*r.b+e.d*r.d,s.tx=e.tx*r.a+e.ty*r.c+r.tx,s.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=n._worldID,this._worldID++}},o.prototype.setFromMatrix=function(n){n.decompose(this),this._localID++},Object.defineProperty(o.prototype,"rotation",{get:function(){return this._rotation},set:function(n){this._rotation!==n&&(this._rotation=n,this.updateSkew())},enumerable:!1,configurable:!0}),o.IDENTITY=new o,o}();/*!
 * @pixi/display - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ie.SORTABLE_CHILDREN=!1;var ru=function(){function o(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return o.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},o.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},o.prototype.getRectangle=function(n){return this.minX>this.maxX||this.minY>this.maxY?dr.EMPTY:((n=n||new dr(0,0,1,1)).x=this.minX,n.y=this.minY,n.width=this.maxX-this.minX,n.height=this.maxY-this.minY,n)},o.prototype.addPoint=function(n){this.minX=Math.min(this.minX,n.x),this.maxX=Math.max(this.maxX,n.x),this.minY=Math.min(this.minY,n.y),this.maxY=Math.max(this.maxY,n.y)},o.prototype.addPointMatrix=function(n,e){var r=n.a,s=n.b,l=n.c,h=n.d,m=n.tx,x=n.ty,b=r*e.x+l*e.y+m,w=s*e.x+h*e.y+x;this.minX=Math.min(this.minX,b),this.maxX=Math.max(this.maxX,b),this.minY=Math.min(this.minY,w),this.maxY=Math.max(this.maxY,w)},o.prototype.addQuad=function(n){var e=this.minX,r=this.minY,s=this.maxX,l=this.maxY,h=n[0],m=n[1];e=h<e?h:e,r=m<r?m:r,s=h>s?h:s,l=m>l?m:l,e=(h=n[2])<e?h:e,r=(m=n[3])<r?m:r,s=h>s?h:s,l=m>l?m:l,e=(h=n[4])<e?h:e,r=(m=n[5])<r?m:r,s=h>s?h:s,l=m>l?m:l,e=(h=n[6])<e?h:e,r=(m=n[7])<r?m:r,s=h>s?h:s,l=m>l?m:l,this.minX=e,this.minY=r,this.maxX=s,this.maxY=l},o.prototype.addFrame=function(n,e,r,s,l){this.addFrameMatrix(n.worldTransform,e,r,s,l)},o.prototype.addFrameMatrix=function(n,e,r,s,l){var h=n.a,m=n.b,x=n.c,b=n.d,w=n.tx,R=n.ty,U=this.minX,B=this.minY,j=this.maxX,K=this.maxY,ut=h*e+x*r+w,gt=m*e+b*r+R;U=ut<U?ut:U,B=gt<B?gt:B,j=ut>j?ut:j,K=gt>K?gt:K,U=(ut=h*s+x*r+w)<U?ut:U,B=(gt=m*s+b*r+R)<B?gt:B,j=ut>j?ut:j,K=gt>K?gt:K,U=(ut=h*e+x*l+w)<U?ut:U,B=(gt=m*e+b*l+R)<B?gt:B,j=ut>j?ut:j,K=gt>K?gt:K,U=(ut=h*s+x*l+w)<U?ut:U,B=(gt=m*s+b*l+R)<B?gt:B,j=ut>j?ut:j,K=gt>K?gt:K,this.minX=U,this.minY=B,this.maxX=j,this.maxY=K},o.prototype.addVertexData=function(n,e,r){for(var s=this.minX,l=this.minY,h=this.maxX,m=this.maxY,x=e;x<r;x+=2){var b=n[x],w=n[x+1];s=b<s?b:s,l=w<l?w:l,h=b>h?b:h,m=w>m?w:m}this.minX=s,this.minY=l,this.maxX=h,this.maxY=m},o.prototype.addVertices=function(n,e,r,s){this.addVerticesMatrix(n.worldTransform,e,r,s)},o.prototype.addVerticesMatrix=function(n,e,r,s,l,h){l===void 0&&(l=0),h===void 0&&(h=l);for(var m=n.a,x=n.b,b=n.c,w=n.d,R=n.tx,U=n.ty,B=this.minX,j=this.minY,K=this.maxX,ut=this.maxY,gt=r;gt<s;gt+=2){var Rt=e[gt],Le=e[gt+1],en=m*Rt+b*Le+R,At=w*Le+x*Rt+U;B=Math.min(B,en-l),K=Math.max(K,en+l),j=Math.min(j,At-h),ut=Math.max(ut,At+h)}this.minX=B,this.minY=j,this.maxX=K,this.maxY=ut},o.prototype.addBounds=function(n){var e=this.minX,r=this.minY,s=this.maxX,l=this.maxY;this.minX=n.minX<e?n.minX:e,this.minY=n.minY<r?n.minY:r,this.maxX=n.maxX>s?n.maxX:s,this.maxY=n.maxY>l?n.maxY:l},o.prototype.addBoundsMask=function(n,e){var r=n.minX>e.minX?n.minX:e.minX,s=n.minY>e.minY?n.minY:e.minY,l=n.maxX<e.maxX?n.maxX:e.maxX,h=n.maxY<e.maxY?n.maxY:e.maxY;if(r<=l&&s<=h){var m=this.minX,x=this.minY,b=this.maxX,w=this.maxY;this.minX=r<m?r:m,this.minY=s<x?s:x,this.maxX=l>b?l:b,this.maxY=h>w?h:w}},o.prototype.addBoundsMatrix=function(n,e){this.addFrameMatrix(e,n.minX,n.minY,n.maxX,n.maxY)},o.prototype.addBoundsArea=function(n,e){var r=n.minX>e.x?n.minX:e.x,s=n.minY>e.y?n.minY:e.y,l=n.maxX<e.x+e.width?n.maxX:e.x+e.width,h=n.maxY<e.y+e.height?n.maxY:e.y+e.height;if(r<=l&&s<=h){var m=this.minX,x=this.minY,b=this.maxX,w=this.maxY;this.minX=r<m?r:m,this.minY=s<x?s:x,this.maxX=l>b?l:b,this.maxY=h>w?h:w}},o.prototype.pad=function(n,e){n===void 0&&(n=0),e===void 0&&(e=n),this.isEmpty()||(this.minX-=n,this.maxX+=n,this.minY-=e,this.maxY+=e)},o.prototype.addFramePad=function(n,e,r,s,l,h){n-=l,e-=h,r+=l,s+=h,this.minX=this.minX<n?this.minX:n,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s},o}(),gc=function(o,n){return(gc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function xo(o,n){function e(){this.constructor=o}gc(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var ci=function(o){function n(){var e=o.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new Ml,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new ru,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return xo(n,o),n.mixin=function(e){for(var r=Object.keys(e),s=0;s<r.length;++s){var l=r[s];Object.defineProperty(n.prototype,l,Object.getOwnPropertyDescriptor(e,l))}},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},n.prototype.getBounds=function(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new dr),r=this._boundsRect),this._bounds.getRectangle(r)},n.prototype.getLocalBounds=function(e){e||(this._localBoundsRect||(this._localBoundsRect=new dr),e=this._localBoundsRect),this._localBounds||(this._localBounds=new ru);var r=this.transform,s=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var l=this._bounds,h=this._boundsID;this._bounds=this._localBounds;var m=this.getBounds(!1,e);return this.parent=s,this.transform=r,this._bounds=l,this._bounds.updateID+=this._boundsID-h,m},n.prototype.toGlobal=function(e,r,s){return s===void 0&&(s=!1),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)},n.prototype.toLocal=function(e,r,s,l){return r&&(e=r.toGlobal(e,s,l)),l||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,s)},n.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},n.prototype.setTransform=function(e,r,s,l,h,m,x,b,w){return e===void 0&&(e=0),r===void 0&&(r=0),s===void 0&&(s=1),l===void 0&&(l=1),h===void 0&&(h=0),m===void 0&&(m=0),x===void 0&&(x=0),b===void 0&&(b=0),w===void 0&&(w=0),this.position.x=e,this.position.y=r,this.scale.x=s||1,this.scale.y=l||1,this.rotation=h,this.skew.x=m,this.skew.y=x,this.pivot.x=b,this.pivot.y=w,this},n.prototype.destroy=function(e){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(n.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new iu),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),n.prototype.enableTempParent=function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e},n.prototype.disableTempParent=function(e){this.parent=e},Object.defineProperty(n.prototype,"x",{get:function(){return this.position.x},set:function(e){this.transform.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.position.y},set:function(e){this.transform.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"skew",{get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"angle",{get:function(){return this.transform.rotation*na},set:function(e){this.transform.rotation=e*El},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mask",{get:function(){return this._mask},set:function(e){var r;this._mask&&((r=this._mask.maskObject||this._mask).renderable=!0,r.isMask=!1),this._mask=e,this._mask&&((r=this._mask.maskObject||this._mask).renderable=!1,r.isMask=!0)},enumerable:!1,configurable:!0}),n}(ar.a),iu=function(o){function n(){var e=o!==null&&o.apply(this,arguments)||this;return e.sortDirty=null,e}return xo(n,o),n}(ci);function gd(o,n){return o.zIndex===n.zIndex?o._lastSortedIndex-n._lastSortedIndex:o.zIndex-n.zIndex}ci.prototype.displayObjectUpdateTransform=ci.prototype.updateTransform;var Ci=function(o){function n(){var e=o.call(this)||this;return e.children=[],e.sortableChildren=ie.SORTABLE_CHILDREN,e.sortDirty=!1,e}return xo(n,o),n.prototype.onChildrenChange=function(e){},n.prototype.addChild=function(){for(var e=arguments,r=[],s=0;s<arguments.length;s++)r[s]=e[s];if(r.length>1)for(var l=0;l<r.length;l++)this.addChild(r[l]);else{var h=r[0];h.parent&&h.parent.removeChild(h),h.parent=this,this.sortDirty=!0,h.transform._parentID=-1,this.children.push(h),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",h,this,this.children.length-1),h.emit("added",this)}return r[0]},n.prototype.addChildAt=function(e,r){if(r<0||r>this.children.length)throw new Error(e+"addChildAt: The index "+r+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(r,0,e),this._boundsID++,this.onChildrenChange(r),e.emit("added",this),this.emit("childAdded",e,this,r),e},n.prototype.swapChildren=function(e,r){if(e!==r){var s=this.getChildIndex(e),l=this.getChildIndex(r);this.children[s]=r,this.children[l]=e,this.onChildrenChange(s<l?s:l)}},n.prototype.getChildIndex=function(e){var r=this.children.indexOf(e);if(r===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return r},n.prototype.setChildIndex=function(e,r){if(r<0||r>=this.children.length)throw new Error("The index "+r+" supplied is out of bounds "+this.children.length);var s=this.getChildIndex(e);Zn(this.children,s,1),this.children.splice(r,0,e),this.onChildrenChange(r)},n.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},n.prototype.removeChild=function(){for(var e=arguments,r=[],s=0;s<arguments.length;s++)r[s]=e[s];if(r.length>1)for(var l=0;l<r.length;l++)this.removeChild(r[l]);else{var h=r[0],m=this.children.indexOf(h);if(m===-1)return null;h.parent=null,h.transform._parentID=-1,Zn(this.children,m,1),this._boundsID++,this.onChildrenChange(m),h.emit("removed",this),this.emit("childRemoved",h,this,m)}return r[0]},n.prototype.removeChildAt=function(e){var r=this.getChildAt(e);return r.parent=null,r.transform._parentID=-1,Zn(this.children,e,1),this._boundsID++,this.onChildrenChange(e),r.emit("removed",this),this.emit("childRemoved",r,this,e),r},n.prototype.removeChildren=function(e,r){e===void 0&&(e=0),r===void 0&&(r=this.children.length);var s,l=e,h=r-l;if(h>0&&h<=r){s=this.children.splice(l,h);for(var m=0;m<s.length;++m)s[m].parent=null,s[m].transform&&(s[m].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(e),m=0;m<s.length;++m)s[m].emit("removed",this),this.emit("childRemoved",s[m],this,m);return s}if(h===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},n.prototype.sortChildren=function(){for(var e=!1,r=0,s=this.children.length;r<s;++r){var l=this.children[r];l._lastSortedIndex=r,e||l.zIndex===0||(e=!0)}e&&this.children.length>1&&this.children.sort(gd),this.sortDirty=!1},n.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,r=this.children.length;e<r;++e){var s=this.children[e];s.visible&&s.updateTransform()}},n.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var r=this.children[e];if(r.visible&&r.renderable)if(r.calculateBounds(),r._mask){var s=r._mask.maskObject||r._mask;s.calculateBounds(),this._bounds.addBoundsMask(r._bounds,s._bounds)}else r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds)}this._bounds.updateID=this._boundsID},n.prototype.getLocalBounds=function(e,r){r===void 0&&(r=!1);var s=o.prototype.getLocalBounds.call(this,e);if(!r)for(var l=0,h=this.children.length;l<h;++l){var m=this.children[l];m.visible&&m.updateTransform()}return s},n.prototype._calculateBounds=function(){},n.prototype.render=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else{this._render(e);for(var r=0,s=this.children.length;r<s;++r)this.children[r].render(e)}},n.prototype.renderAdvanced=function(e){e.batch.flush();var r=this.filters,s=this._mask;if(r){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var l=0;l<r.length;l++)r[l].enabled&&this._enabledFilters.push(r[l]);this._enabledFilters.length&&e.filter.push(this,this._enabledFilters)}s&&e.mask.push(this,this._mask),this._render(e),l=0;for(var h=this.children.length;l<h;l++)this.children[l].render(e);e.batch.flush(),s&&e.mask.pop(this),r&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},n.prototype._render=function(e){},n.prototype.destroy=function(e){o.prototype.destroy.call(this),this.sortDirty=!1;var r=typeof e=="boolean"?e:e&&e.children,s=this.removeChildren(0,this.children.length);if(r)for(var l=0;l<s.length;++l)s[l].destroy(e)},Object.defineProperty(n.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var r=this.getLocalBounds().width;this.scale.x=r!==0?e/r:1,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var r=this.getLocalBounds().height;this.scale.y=r!==0?e/r:1,this._height=e},enumerable:!1,configurable:!0}),n}(ci);Ci.prototype.containerUpdateTransform=Ci.prototype.updateTransform;/*!
 * @pixi/accessibility - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/accessibility is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var vd={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};ci.mixin(vd);var No,Al=function(){function o(n){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Sr.tablet||Sr.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2 .toString(),this.div=e,this.renderer=n,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),self.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(o.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),o.prototype.createTouchHook=function(){var n=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2 .toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",function(){n._isMobileAccessibility=!0,n.activate(),n.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e},o.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},o.prototype.activate=function(){var n;this._isActive||(this._isActive=!0,self.document.addEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(n=this.renderer.view.parentNode)===null||n===void 0||n.appendChild(this.div))},o.prototype.deactivate=function(){var n;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(n=this.div.parentNode)===null||n===void 0||n.removeChild(this.div))},o.prototype.updateAccessibleObjects=function(n){if(n.visible&&n.accessibleChildren){n.accessible&&n.interactive&&(n._accessibleActive||this.addChild(n),n.renderId=this.renderId);for(var e=n.children,r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}},o.prototype.update=function(){var n=performance.now();if(!(Sr.android.device&&n<this.androidUpdateCount)&&(this.androidUpdateCount=n+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),r=e.left,s=e.top,l=e.width,h=e.height,m=this.renderer,x=m.width,b=m.height,w=m.resolution,R=l/x*w,U=h/b*w,B=this.div;B.style.left=r+"px",B.style.top=s+"px",B.style.width=x+"px",B.style.height=b+"px";for(var j=0;j<this.children.length;j++){var K=this.children[j];if(K.renderId!==this.renderId)K._accessibleActive=!1,Zn(this.children,j,1),this.div.removeChild(K._accessibleDiv),this.pool.push(K._accessibleDiv),K._accessibleDiv=null,j--;else{B=K._accessibleDiv;var ut=K.hitArea,gt=K.worldTransform;K.hitArea?(B.style.left=(gt.tx+ut.x*gt.a)*R+"px",B.style.top=(gt.ty+ut.y*gt.d)*U+"px",B.style.width=ut.width*gt.a*R+"px",B.style.height=ut.height*gt.d*U+"px"):(ut=K.getBounds(),this.capHitArea(ut),B.style.left=ut.x*R+"px",B.style.top=ut.y*U+"px",B.style.width=ut.width*R+"px",B.style.height=ut.height*U+"px",B.title!==K.accessibleTitle&&K.accessibleTitle!==null&&(B.title=K.accessibleTitle),B.getAttribute("aria-label")!==K.accessibleHint&&K.accessibleHint!==null&&B.setAttribute("aria-label",K.accessibleHint)),K.accessibleTitle===B.title&&K.tabIndex===B.tabIndex||(B.title=K.accessibleTitle,B.tabIndex=K.tabIndex,this.debug&&this.updateDebugHTML(B))}}this.renderId++}},o.prototype.updateDebugHTML=function(n){n.innerHTML="type: "+n.type+"</br> title : "+n.title+"</br> tabIndex: "+n.tabIndex},o.prototype.capHitArea=function(n){n.x<0&&(n.width+=n.x,n.x=0),n.y<0&&(n.height+=n.y,n.y=0);var e=this.renderer,r=e.width,s=e.height;n.x+n.width>r&&(n.width=r-n.x),n.y+n.height>s&&(n.height=s-n.y)},o.prototype.addChild=function(n){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2 .toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=n.accessiblePointerEvents,e.type=n.accessibleType,n.accessibleTitle&&n.accessibleTitle!==null?e.title=n.accessibleTitle:n.accessibleHint&&n.accessibleHint!==null||(e.title="displayObject "+n.tabIndex),n.accessibleHint&&n.accessibleHint!==null&&e.setAttribute("aria-label",n.accessibleHint),this.debug&&this.updateDebugHTML(e),n._accessibleActive=!0,n._accessibleDiv=e,e.displayObject=n,this.children.push(n),this.div.appendChild(n._accessibleDiv),n._accessibleDiv.tabIndex=n.tabIndex},o.prototype._onClick=function(n){var e=this.renderer.plugins.interaction,r=n.target.displayObject,s=e.eventData;e.dispatchEvent(r,"click",s),e.dispatchEvent(r,"pointertap",s),e.dispatchEvent(r,"tap",s)},o.prototype._onFocus=function(n){n.target.getAttribute("aria-live")||n.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,r=n.target.displayObject,s=e.eventData;e.dispatchEvent(r,"mouseover",s)},o.prototype._onFocusOut=function(n){n.target.getAttribute("aria-live")||n.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,r=n.target.displayObject,s=e.eventData;e.dispatchEvent(r,"mouseout",s)},o.prototype._onKeyDown=function(n){n.keyCode===9&&this.activate()},o.prototype._onMouseMove=function(n){n.movementX===0&&n.movementY===0||this.deactivate()},o.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},o}();/*!
 * @pixi/ticker - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ie.TARGET_FPMS=.06,function(o){o[o.INTERACTION=50]="INTERACTION",o[o.HIGH=25]="HIGH",o[o.NORMAL=0]="NORMAL",o[o.LOW=-25]="LOW",o[o.UTILITY=-50]="UTILITY"}(No||(No={}));var Gu=function(){function o(n,e,r,s){e===void 0&&(e=null),r===void 0&&(r=0),s===void 0&&(s=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=n,this.context=e,this.priority=r,this.once=s}return o.prototype.match=function(n,e){return e===void 0&&(e=null),this.fn===n&&this.context===e},o.prototype.emit=function(n){this.fn&&(this.context?this.fn.call(this.context,n):this.fn(n));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},o.prototype.connect=function(n){this.previous=n,n.next&&(n.next.previous=this),this.next=n.next,n.next=this},o.prototype.destroy=function(n){n===void 0&&(n=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=n?null:e,this.previous=null,e},o}(),ri=function(){function o(){var n=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Gu(null,null,1/0),this.deltaMS=1/ie.TARGET_FPMS,this.elapsedMS=1/ie.TARGET_FPMS,this._tick=function(e){n._requestId=null,n.started&&(n.update(e),n.started&&n._requestId===null&&n._head.next&&(n._requestId=requestAnimationFrame(n._tick)))}}return o.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},o.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},o.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},o.prototype.add=function(n,e,r){return r===void 0&&(r=No.NORMAL),this._addListener(new Gu(n,e,r))},o.prototype.addOnce=function(n,e,r){return r===void 0&&(r=No.NORMAL),this._addListener(new Gu(n,e,r,!0))},o.prototype._addListener=function(n){var e=this._head.next,r=this._head;if(e){for(;e;){if(n.priority>e.priority){n.connect(r);break}r=e,e=e.next}n.previous||n.connect(r)}else n.connect(r);return this._startIfPossible(),this},o.prototype.remove=function(n,e){for(var r=this._head.next;r;)r=r.match(n,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(o.prototype,"count",{get:function(){if(!this._head)return 0;for(var n=0,e=this._head;e=e.next;)n++;return n},enumerable:!1,configurable:!0}),o.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},o.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},o.prototype.destroy=function(){if(!this._protected){this.stop();for(var n=this._head.next;n;)n=n.destroy(!0);this._head.destroy(),this._head=null}},o.prototype.update=function(n){var e;if(n===void 0&&(n=performance.now()),n>this.lastTime){if((e=this.elapsedMS=n-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=n-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=n-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ie.TARGET_FPMS;for(var s=this._head,l=s.next;l;)l=l.emit(this.deltaTime);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=n},Object.defineProperty(o.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(n){var e=Math.min(this.maxFPS,n),r=Math.min(Math.max(0,e)/1e3,ie.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(n){if(n===0)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,n);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(o,"shared",{get:function(){if(!o._shared){var n=o._shared=new o;n.autoStart=!0,n._protected=!0}return o._shared},enumerable:!1,configurable:!0}),Object.defineProperty(o,"system",{get:function(){if(!o._system){var n=o._system=new o;n.autoStart=!0,n._protected=!0}return o._system},enumerable:!1,configurable:!0}),o}(),ia=function(){function o(){}return o.init=function(n){var e=this;n=Object.assign({autoStart:!0,sharedTicker:!1},n),Object.defineProperty(this,"ticker",{set:function(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,No.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=n.sharedTicker?ri.shared:new ri,n.autoStart&&this.start()},o.destroy=function(){if(this._ticker){var n=this._ticker;this.ticker=null,n.destroy()}},o}(),oa=function(){function o(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new ai,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(o.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),o.prototype.getLocalPosition=function(n,e,r){return n.worldTransform.applyInverse(r||this.global,e)},o.prototype.copyEvent=function(n){"isPrimary"in n&&n.isPrimary&&(this.isPrimary=!0),this.button="button"in n&&n.button;var e="buttons"in n&&n.buttons;this.buttons=Number.isInteger(e)?e:"which"in n&&n.which,this.width="width"in n&&n.width,this.height="height"in n&&n.height,this.tiltX="tiltX"in n&&n.tiltX,this.tiltY="tiltY"in n&&n.tiltY,this.pointerType="pointerType"in n&&n.pointerType,this.pressure="pressure"in n&&n.pressure,this.rotationAngle="rotationAngle"in n&&n.rotationAngle,this.twist="twist"in n&&n.twist||0,this.tangentialPressure="tangentialPressure"in n&&n.tangentialPressure||0},o.prototype.reset=function(){this.isPrimary=!1},o}(),ss=function(o,n){return(ss=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},ou=function(){function o(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return o.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},o.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},o}(),Pl=function(){function o(n){this._pointerId=n,this._flags=o.FLAGS.NONE}return o.prototype._doSet=function(n,e){this._flags=e?this._flags|n:this._flags&~n},Object.defineProperty(o.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"flags",{get:function(){return this._flags},set:function(n){this._flags=n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"none",{get:function(){return this._flags===o.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"over",{get:function(){return(this._flags&o.FLAGS.OVER)!=0},set:function(n){this._doSet(o.FLAGS.OVER,n)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"rightDown",{get:function(){return(this._flags&o.FLAGS.RIGHT_DOWN)!=0},set:function(n){this._doSet(o.FLAGS.RIGHT_DOWN,n)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"leftDown",{get:function(){return(this._flags&o.FLAGS.LEFT_DOWN)!=0},set:function(n){this._doSet(o.FLAGS.LEFT_DOWN,n)},enumerable:!1,configurable:!0}),o.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),o}(),Hu=function(){function o(){this._tempPoint=new ai}return o.prototype.recursiveFindHit=function(n,e,r,s,l){if(!e||!e.visible)return!1;var h=n.data.global,m=!1,x=l=e.interactive||l,b=!0;if(e.hitArea?(s&&(e.worldTransform.applyInverse(h,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?m=!0:(s=!1,b=!1)),x=!1):e._mask&&s&&(e._mask.containsPoint&&e._mask.containsPoint(h)||(s=!1)),b&&e.interactiveChildren&&e.children)for(var w=e.children,R=w.length-1;R>=0;R--){var U=w[R],B=this.recursiveFindHit(n,U,r,s,x);if(B){if(!U.parent)continue;x=!1,B&&(n.target&&(s=!1),m=!0)}}return l&&(s&&!n.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(h)&&(m=!0),e.interactive&&(m&&!n.target&&(n.target=e),r&&r(n,e,!!m))),m},o.prototype.findHit=function(n,e,r,s){this.recursiveFindHit(n,e,r,s,!1)},o}(),Ts={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(o){o?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};ci.mixin(Ts);var wh={target:null,data:{global:null}},bo=function(o){function n(e,r){var s=o.call(this)||this;return r=r||{},s.renderer=e,s.autoPreventDefault=r.autoPreventDefault===void 0||r.autoPreventDefault,s.interactionFrequency=r.interactionFrequency||10,s.mouse=new oa,s.mouse.identifier=1,s.mouse.global.set(-999999),s.activeInteractionData={},s.activeInteractionData[1]=s.mouse,s.interactionDataPool=[],s.eventData=new ou,s.interactionDOMElement=null,s.moveWhenInside=!1,s.eventsAdded=!1,s.tickerAdded=!1,s.mouseOverRenderer=!("PointerEvent"in self),s.supportsTouchEvents="ontouchstart"in self,s.supportsPointerEvents=!!self.PointerEvent,s.onPointerUp=s.onPointerUp.bind(s),s.processPointerUp=s.processPointerUp.bind(s),s.onPointerCancel=s.onPointerCancel.bind(s),s.processPointerCancel=s.processPointerCancel.bind(s),s.onPointerDown=s.onPointerDown.bind(s),s.processPointerDown=s.processPointerDown.bind(s),s.onPointerMove=s.onPointerMove.bind(s),s.processPointerMove=s.processPointerMove.bind(s),s.onPointerOut=s.onPointerOut.bind(s),s.processPointerOverOut=s.processPointerOverOut.bind(s),s.onPointerOver=s.onPointerOver.bind(s),s.cursorStyles={default:"inherit",pointer:"pointer"},s.currentCursorMode=null,s.cursor=null,s.resolution=1,s.delayedEvents=[],s.search=new Hu,s._tempDisplayObject=new iu,s._useSystemTicker=r.useSystemTicker===void 0||r.useSystemTicker,s.setTargetElement(s.renderer.view,s.renderer.resolution),s}return function(e,r){function s(){this.constructor=e}ss(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),Object.defineProperty(n.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),n.prototype.hitTest=function(e,r){return wh.target=null,wh.data.global=e,r||(r=this.lastObjectRendered),this.processInteractive(wh,r,null,!0),wh.target},n.prototype.setTargetElement=function(e,r){r===void 0&&(r=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=r,this.addEvents(),this.addTickerListener()},n.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(ri.system.add(this.tickerUpdate,this,No.INTERACTION),this.tickerAdded=!0)},n.prototype.removeTickerListener=function(){this.tickerAdded&&(ri.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},n.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none"),this.supportsPointerEvents?(self.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),self.addEventListener("pointercancel",this.onPointerCancel,!0),self.addEventListener("pointerup",this.onPointerUp,!0)):(self.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),self.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},n.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(self.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),self.removeEventListener("pointercancel",this.onPointerCancel,!0),self.removeEventListener("pointerup",this.onPointerUp,!0)):(self.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),self.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},n.prototype.tickerUpdate=function(e){this._deltaTime+=e,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},n.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var r=this.activeInteractionData[e];if(r.originalEvent&&r.pointerType!=="touch"){var s=this.configureInteractionEventForDOMEvent(this.eventData,r.originalEvent,r);this.processInteractive(s,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},n.prototype.setCursorMode=function(e){e=e||"default";var r=!0;if(self.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(r=!1),this.currentCursorMode!==e){this.currentCursorMode=e;var s=this.cursorStyles[e];if(s)switch(typeof s){case"string":r&&(this.interactionDOMElement.style.cursor=s);break;case"function":s(e);break;case"object":r&&Object.assign(this.interactionDOMElement.style,s)}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},n.prototype.dispatchEvent=function(e,r,s){s.stopPropagationHint&&e!==s.stopsPropagatingAt||(s.currentTarget=e,s.type=r,e.emit(r,s),e[r]&&e[r](s))},n.prototype.delayDispatchEvent=function(e,r,s){this.delayedEvents.push({displayObject:e,eventString:r,eventData:s})},n.prototype.mapPositionToPoint=function(e,r,s){var l;l=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var h=1/this.resolution;e.x=(r-l.left)*(this.interactionDOMElement.width/l.width)*h,e.y=(s-l.top)*(this.interactionDOMElement.height/l.height)*h},n.prototype.processInteractive=function(e,r,s,l){var h=this.search.findHit(e,r,s,l),m=this.delayedEvents;if(!m.length)return h;e.stopPropagationHint=!1;var x=m.length;this.delayedEvents=[];for(var b=0;b<x;b++){var w=m[b],R=w.displayObject,U=w.eventString,B=w.eventData;B.stopsPropagatingAt===R&&(B.stopPropagationHint=!0),this.dispatchEvent(R,U,B)}return h},n.prototype.onPointerDown=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var r=this.normalizeToPointerData(e);this.autoPreventDefault&&r[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(var s=r.length,l=0;l<s;l++){var h=r[l],m=this.getInteractionDataForPointerId(h),x=this.configureInteractionEventForDOMEvent(this.eventData,h,m);if(x.data.originalEvent=e,this.processInteractive(x,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",x),h.pointerType==="touch")this.emit("touchstart",x);else if(h.pointerType==="mouse"||h.pointerType==="pen"){var b=h.button===2;this.emit(b?"rightdown":"mousedown",this.eventData)}}}},n.prototype.processPointerDown=function(e,r,s){var l=e.data,h=e.data.identifier;if(s){if(r.trackedPointers[h]||(r.trackedPointers[h]=new Pl(h)),this.dispatchEvent(r,"pointerdown",e),l.pointerType==="touch")this.dispatchEvent(r,"touchstart",e);else if(l.pointerType==="mouse"||l.pointerType==="pen"){var m=l.button===2;m?r.trackedPointers[h].rightDown=!0:r.trackedPointers[h].leftDown=!0,this.dispatchEvent(r,m?"rightdown":"mousedown",e)}}},n.prototype.onPointerComplete=function(e,r,s){for(var l=this.normalizeToPointerData(e),h=l.length,m=e.target!==this.interactionDOMElement?"outside":"",x=0;x<h;x++){var b=l[x],w=this.getInteractionDataForPointerId(b),R=this.configureInteractionEventForDOMEvent(this.eventData,b,w);if(R.data.originalEvent=e,this.processInteractive(R,this.lastObjectRendered,s,r||!m),this.emit(r?"pointercancel":"pointerup"+m,R),b.pointerType==="mouse"||b.pointerType==="pen"){var U=b.button===2;this.emit(U?"rightup"+m:"mouseup"+m,R)}else b.pointerType==="touch"&&(this.emit(r?"touchcancel":"touchend"+m,R),this.releaseInteractionDataForPointerId(b.pointerId))}},n.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!0,this.processPointerCancel)},n.prototype.processPointerCancel=function(e,r){var s=e.data,l=e.data.identifier;r.trackedPointers[l]!==void 0&&(delete r.trackedPointers[l],this.dispatchEvent(r,"pointercancel",e),s.pointerType==="touch"&&this.dispatchEvent(r,"touchcancel",e))},n.prototype.onPointerUp=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!1,this.processPointerUp)},n.prototype.processPointerUp=function(e,r,s){var l=e.data,h=e.data.identifier,m=r.trackedPointers[h],x=l.pointerType==="touch",b=l.pointerType==="mouse"||l.pointerType==="pen",w=!1;if(b){var R=l.button===2,U=Pl.FLAGS,B=R?U.RIGHT_DOWN:U.LEFT_DOWN,j=m!==void 0&&m.flags&B;s?(this.dispatchEvent(r,R?"rightup":"mouseup",e),j&&(this.dispatchEvent(r,R?"rightclick":"click",e),w=!0)):j&&this.dispatchEvent(r,R?"rightupoutside":"mouseupoutside",e),m&&(R?m.rightDown=!1:m.leftDown=!1)}s?(this.dispatchEvent(r,"pointerup",e),x&&this.dispatchEvent(r,"touchend",e),m&&(b&&!w||this.dispatchEvent(r,"pointertap",e),x&&(this.dispatchEvent(r,"tap",e),m.over=!1))):m&&(this.dispatchEvent(r,"pointerupoutside",e),x&&this.dispatchEvent(r,"touchendoutside",e)),m&&m.none&&delete r.trackedPointers[h]},n.prototype.onPointerMove=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var r=this.normalizeToPointerData(e);r[0].pointerType!=="mouse"&&r[0].pointerType!=="pen"||(this._didMove=!0,this.cursor=null);for(var s=r.length,l=0;l<s;l++){var h=r[l],m=this.getInteractionDataForPointerId(h),x=this.configureInteractionEventForDOMEvent(this.eventData,h,m);x.data.originalEvent=e,this.processInteractive(x,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",x),h.pointerType==="touch"&&this.emit("touchmove",x),h.pointerType!=="mouse"&&h.pointerType!=="pen"||this.emit("mousemove",x)}r[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},n.prototype.processPointerMove=function(e,r,s){var l=e.data,h=l.pointerType==="touch",m=l.pointerType==="mouse"||l.pointerType==="pen";m&&this.processPointerOverOut(e,r,s),this.moveWhenInside&&!s||(this.dispatchEvent(r,"pointermove",e),h&&this.dispatchEvent(r,"touchmove",e),m&&this.dispatchEvent(r,"mousemove",e))},n.prototype.onPointerOut=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var r=this.normalizeToPointerData(e)[0];r.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var s=this.getInteractionDataForPointerId(r),l=this.configureInteractionEventForDOMEvent(this.eventData,r,s);l.data.originalEvent=r,this.processInteractive(l,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",l),r.pointerType==="mouse"||r.pointerType==="pen"?this.emit("mouseout",l):this.releaseInteractionDataForPointerId(s.identifier)}},n.prototype.processPointerOverOut=function(e,r,s){var l=e.data,h=e.data.identifier,m=l.pointerType==="mouse"||l.pointerType==="pen",x=r.trackedPointers[h];s&&!x&&(x=r.trackedPointers[h]=new Pl(h)),x!==void 0&&(s&&this.mouseOverRenderer?(x.over||(x.over=!0,this.delayDispatchEvent(r,"pointerover",e),m&&this.delayDispatchEvent(r,"mouseover",e)),m&&this.cursor===null&&(this.cursor=r.cursor)):x.over&&(x.over=!1,this.dispatchEvent(r,"pointerout",this.eventData),m&&this.dispatchEvent(r,"mouseout",e),x.none&&delete r.trackedPointers[h]))},n.prototype.onPointerOver=function(e){var r=this.normalizeToPointerData(e)[0],s=this.getInteractionDataForPointerId(r),l=this.configureInteractionEventForDOMEvent(this.eventData,r,s);l.data.originalEvent=r,r.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",l),r.pointerType!=="mouse"&&r.pointerType!=="pen"||this.emit("mouseover",l)},n.prototype.getInteractionDataForPointerId=function(e){var r,s=e.pointerId;return s===1||e.pointerType==="mouse"?r=this.mouse:this.activeInteractionData[s]?r=this.activeInteractionData[s]:((r=this.interactionDataPool.pop()||new oa).identifier=s,this.activeInteractionData[s]=r),r.copyEvent(e),r},n.prototype.releaseInteractionDataForPointerId=function(e){var r=this.activeInteractionData[e];r&&(delete this.activeInteractionData[e],r.reset(),this.interactionDataPool.push(r))},n.prototype.configureInteractionEventForDOMEvent=function(e,r,s){return e.data=s,this.mapPositionToPoint(s.global,r.clientX,r.clientY),r.pointerType==="touch"&&(r.globalX=s.global.x,r.globalY=s.global.y),s.originalEvent=r,e.reset(),e},n.prototype.normalizeToPointerData=function(e){var r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var s=0,l=e.changedTouches.length;s<l;s++){var h=e.changedTouches[s];h.button===void 0&&(h.button=e.touches.length?1:0),h.buttons===void 0&&(h.buttons=e.touches.length?1:0),h.isPrimary===void 0&&(h.isPrimary=e.touches.length===1&&e.type==="touchstart"),h.width===void 0&&(h.width=h.radiusX||1),h.height===void 0&&(h.height=h.radiusY||1),h.tiltX===void 0&&(h.tiltX=0),h.tiltY===void 0&&(h.tiltY=0),h.pointerType===void 0&&(h.pointerType="touch"),h.pointerId===void 0&&(h.pointerId=h.identifier||0),h.pressure===void 0&&(h.pressure=h.force||.5),h.twist===void 0&&(h.twist=0),h.tangentialPressure===void 0&&(h.tangentialPressure=0),h.layerX===void 0&&(h.layerX=h.offsetX=h.clientX),h.layerY===void 0&&(h.layerY=h.offsetY=h.clientY),h.isNormalized=!0,r.push(h)}else if(self.MouseEvent&&(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof self.PointerEvent))r.push(e);else{var m=e;m.isPrimary===void 0&&(m.isPrimary=!0),m.width===void 0&&(m.width=1),m.height===void 0&&(m.height=1),m.tiltX===void 0&&(m.tiltX=0),m.tiltY===void 0&&(m.tiltY=0),m.pointerType===void 0&&(m.pointerType="mouse"),m.pointerId===void 0&&(m.pointerId=1),m.pressure===void 0&&(m.pressure=.5),m.twist===void 0&&(m.twist=0),m.tangentialPressure===void 0&&(m.tangentialPressure=0),m.isNormalized=!0,r.push(m)}return r},n.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},n}(ar.a),di=function(){function o(n){this.items=[],this._name=n,this._aliasCount=0}return o.prototype.emit=function(n,e,r,s,l,h,m,x){if(arguments.length>8)throw new Error("max arguments reached");var b=this,w=b.name,R=b.items;this._aliasCount++;for(var U=0,B=R.length;U<B;U++)R[U][w](n,e,r,s,l,h,m,x);return R===this.items&&this._aliasCount--,this},o.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},o.prototype.add=function(n){return n[this._name]&&(this.ensureNonAliasedItems(),this.remove(n),this.items.push(n)),this},o.prototype.remove=function(n){var e=this.items.indexOf(n);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},o.prototype.contains=function(n){return this.items.indexOf(n)!==-1},o.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},o.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(o.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),o}();Object.defineProperties(di.prototype,{dispatch:{value:di.prototype.emit},run:{value:di.prototype.emit}}),ie.PREFER_ENV=Sr.any?Lr.WEBGL:Lr.WEBGL2,ie.STRICT_TEXTURE_CACHE=!1;var Bt=[];function he(o,n){if(!o)return null;var e="";if(typeof o=="string"){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(o);r&&(e=r[1].toLowerCase())}for(var s=Bt.length-1;s>=0;--s){var l=Bt[s];if(l.test&&l.test(o,e))return new l(o,n)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var we=function(o,n){return(we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function fe(o,n){function e(){this.constructor=o}we(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var Gn=function(){function o(n,e){n===void 0&&(n=0),e===void 0&&(e=0),this._width=n,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new di("setRealSize"),this.onUpdate=new di("update"),this.onError=new di("onError")}return o.prototype.bind=function(n){this.onResize.add(n),this.onUpdate.add(n),this.onError.add(n),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},o.prototype.unbind=function(n){this.onResize.remove(n),this.onUpdate.remove(n),this.onError.remove(n)},o.prototype.resize=function(n,e){n===this._width&&e===this._height||(this._width=n,this._height=e,this.onResize.emit(n,e))},Object.defineProperty(o.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),o.prototype.update=function(){this.destroyed||this.onUpdate.emit()},o.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(o.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),o.prototype.style=function(n,e,r){return!1},o.prototype.dispose=function(){},o.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},o.test=function(n,e){return!1},o}(),pr=function(o){function n(e,r){var s=this,l=r||{},h=l.width,m=l.height;if(!h||!m)throw new Error("BufferResource width or height invalid");return(s=o.call(this,h,m)||this).data=e,s}return fe(n,o),n.prototype.upload=function(e,r,s){var l=e.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===It.UNPACK);var h=r.realWidth,m=r.realHeight;return s.width===h&&s.height===m?l.texSubImage2D(r.target,0,0,0,h,m,r.format,r.type,this.data):(s.width=h,s.height=m,l.texImage2D(r.target,0,s.internalFormat,h,m,0,r.format,s.type,this.data)),!0},n.prototype.dispose=function(){this.data=null},n.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},n}(Gn),Gi={scaleMode:dt.NEAREST,format:$i.RGBA,alphaMode:It.NPM},fr=function(o){function n(e,r){e===void 0&&(e=null),r===void 0&&(r=null);var s=o.call(this)||this,l=(r=r||{}).alphaMode,h=r.mipmap,m=r.anisotropicLevel,x=r.scaleMode,b=r.width,w=r.height,R=r.wrapMode,U=r.format,B=r.type,j=r.target,K=r.resolution,ut=r.resourceOptions;return!e||e instanceof Gn||((e=he(e,ut)).internal=!0),s.width=b||0,s.height=w||0,s.resolution=K||ie.RESOLUTION,s.mipmap=h!==void 0?h:ie.MIPMAP_TEXTURES,s.anisotropicLevel=m!==void 0?m:ie.ANISOTROPIC_LEVEL,s.wrapMode=R||ie.WRAP_MODE,s.scaleMode=x!==void 0?x:ie.SCALE_MODE,s.format=U||$i.RGBA,s.type=B||Q.UNSIGNED_BYTE,s.target=j||yo.TEXTURE_2D,s.alphaMode=l!==void 0?l:It.UNPACK,s.uid=Er(),s.touched=0,s.isPowerOfTwo=!1,s._refreshPOT(),s._glTextures={},s.dirtyId=0,s.dirtyStyleId=0,s.cacheId=null,s.valid=b>0&&w>0,s.textureCacheIds=[],s.destroyed=!1,s.resource=null,s._batchEnabled=0,s._batchLocation=0,s.parentTextureArray=null,s.setResource(e),s}return fe(n,o),Object.defineProperty(n.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),n.prototype.setStyle=function(e,r){var s;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,s=!0),r!==void 0&&r!==this.mipmap&&(this.mipmap=r,s=!0),s&&this.dirtyStyleId++,this},n.prototype.setSize=function(e,r,s){return this.resolution=s||this.resolution,this.width=e,this.height=r,this._refreshPOT(),this.update(),this},n.prototype.setRealSize=function(e,r,s){return this.resolution=s||this.resolution,this.width=e/this.resolution,this.height=r/this.resolution,this._refreshPOT(),this.update(),this},n.prototype._refreshPOT=function(){this.isPowerOfTwo=or(this.realWidth)&&or(this.realHeight)},n.prototype.setResolution=function(e){var r=this.resolution;return r===e||(this.resolution=e,this.valid&&(this.width=this.width*r/e,this.height=this.height*r/e,this.emit("update",this)),this._refreshPOT()),this},n.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},n.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},n.prototype.onError=function(e){this.emit("error",this,e)},n.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete si[this.cacheId],delete Ki[this.cacheId],this.cacheId=null),this.dispose(),n.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},n.prototype.dispose=function(){this.emit("dispose",this)},n.prototype.castToBaseTexture=function(){return this},n.from=function(e,r,s){s===void 0&&(s=ie.STRICT_TEXTURE_CACHE);var l=typeof e=="string",h=null;if(l)h=e;else{if(!e._pixiId){var m=r&&r.pixiIdPrefix||"pixiid";e._pixiId=m+"_"+Er()}h=e._pixiId}var x=si[h];if(l&&s&&!x)throw new Error('The cacheId "'+h+'" does not exist in BaseTextureCache.');return x||((x=new n(e,r)).cacheId=h,n.addToCache(x,h)),x},n.fromBuffer=function(e,r,s,l){e=e||new Float32Array(r*s*4);var h=new pr(e,{width:r,height:s}),m=e instanceof Float32Array?Q.FLOAT:Q.UNSIGNED_BYTE;return new n(h,Object.assign(Gi,l||{width:r,height:s,type:m}))},n.addToCache=function(e,r){r&&(e.textureCacheIds.indexOf(r)===-1&&e.textureCacheIds.push(r),si[r]&&console.warn("BaseTexture added to the cache with an id ["+r+"] that already had an entry"),si[r]=e)},n.removeFromCache=function(e){if(typeof e=="string"){var r=si[e];if(r){var s=r.textureCacheIds.indexOf(e);return s>-1&&r.textureCacheIds.splice(s,1),delete si[e],r}}else if(e&&e.textureCacheIds){for(var l=0;l<e.textureCacheIds.length;++l)delete si[e.textureCacheIds[l]];return e.textureCacheIds.length=0,e}return null},n._globalBatch=0,n}(ar.a),Cr=function(o){function n(e,r){var s=this,l=r||{},h=l.width,m=l.height;(s=o.call(this,h,m)||this).items=[],s.itemDirtyIds=[];for(var x=0;x<e;x++){var b=new fr;s.items.push(b),s.itemDirtyIds.push(-2)}return s.length=e,s._load=null,s.baseTexture=null,s}return fe(n,o),n.prototype.initFromArray=function(e,r){for(var s=0;s<this.length;s++)e[s]&&(e[s].castToBaseTexture?this.addBaseTextureAt(e[s].castToBaseTexture(),s):e[s]instanceof Gn?this.addResourceAt(e[s],s):this.addResourceAt(he(e[s],r),s))},n.prototype.dispose=function(){for(var e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},n.prototype.addResourceAt=function(e,r){if(!this.items[r])throw new Error("Index "+r+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this},n.prototype.bind=function(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");o.prototype.bind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)},n.prototype.unbind=function(e){o.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)},n.prototype.load=function(){var e=this;if(this._load)return this._load;var r=this.items.map(function(s){return s.resource}).filter(function(s){return s}).map(function(s){return s.load()});return this._load=Promise.all(r).then(function(){var s=e.items[0],l=s.realWidth,h=s.realHeight;return e.resize(l,h),Promise.resolve(e)}),this._load},n}(Gn),Cl=function(o){function n(e,r){var s,l,h=this,m=r||{},x=m.width,b=m.height;return Array.isArray(e)?(s=e,l=e.length):l=e,h=o.call(this,l,{width:x,height:b})||this,s&&h.initFromArray(s,r),h}return fe(n,o),n.prototype.addBaseTextureAt=function(e,r){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,r),this},n.prototype.bind=function(e){o.prototype.bind.call(this,e),e.target=yo.TEXTURE_2D_ARRAY},n.prototype.upload=function(e,r,s){var l=this.length,h=this.itemDirtyIds,m=this.items,x=e.gl;s.dirtyId<0&&x.texImage3D(x.TEXTURE_2D_ARRAY,0,r.format,this._width,this._height,l,0,r.format,r.type,null);for(var b=0;b<l;b++){var w=m[b];h[b]<w.dirtyId&&(h[b]=w.dirtyId,w.valid&&x.texSubImage3D(x.TEXTURE_2D_ARRAY,0,0,0,b,w.resource.width,w.resource.height,1,r.format,r.type,w.resource.source))}return!0},n}(Cr),sa=function(o){function n(e){var r=this,s=e,l=s.naturalWidth||s.videoWidth||s.width,h=s.naturalHeight||s.videoHeight||s.height;return(r=o.call(this,l,h)||this).source=e,r.noSubImage=!1,r}return fe(n,o),n.crossOrigin=function(e,r,s){s===void 0&&r.indexOf("data:")!==0?e.crossOrigin=md(r):s!==!1&&(e.crossOrigin=typeof s=="string"?s:"anonymous")},n.prototype.upload=function(e,r,s,l){var h=e.gl,m=r.realWidth,x=r.realHeight;return l=l||this.source,h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===It.UNPACK),this.noSubImage||r.target!==h.TEXTURE_2D||s.width!==m||s.height!==x?(s.width=m,s.height=x,h.texImage2D(r.target,0,r.format,r.format,r.type,l)):h.texSubImage2D(h.TEXTURE_2D,0,0,0,r.format,r.type,l),!0},n.prototype.update=function(){if(!this.destroyed){var e=this.source,r=e.naturalWidth||e.videoWidth||e.width,s=e.naturalHeight||e.videoHeight||e.height;this.resize(r,s),o.prototype.update.call(this)}},n.prototype.dispose=function(){this.source=null},n}(Gn),Qi=function(o){function n(e){return o.call(this,e)||this}return fe(n,o),n.test=function(e){var r=self.OffscreenCanvas;return!!(r&&e instanceof r)||self.HTMLCanvasElement&&e instanceof HTMLCanvasElement},n}(sa),Rl=function(o){function n(e,r){var s=this,l=r||{},h=l.width,m=l.height,x=l.autoLoad,b=l.linkBaseTexture;if(e&&e.length!==n.SIDES)throw new Error("Invalid length. Got "+e.length+", expected 6");s=o.call(this,6,{width:h,height:m})||this;for(var w=0;w<n.SIDES;w++)s.items[w].target=yo.TEXTURE_CUBE_MAP_POSITIVE_X+w;return s.linkBaseTexture=b!==!1,e&&s.initFromArray(e,r),x!==!1&&s.load(),s}return fe(n,o),n.prototype.bind=function(e){o.prototype.bind.call(this,e),e.target=yo.TEXTURE_CUBE_MAP},n.prototype.addBaseTextureAt=function(e,r,s){if(!this.items[r])throw new Error("Index "+r+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,r)}else e.target=yo.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this},n.prototype.upload=function(e,r,s){for(var l=this.itemDirtyIds,h=0;h<n.SIDES;h++){var m=this.items[h];l[h]<m.dirtyId&&(m.valid&&m.resource?(m.resource.upload(e,m,s),l[h]=m.dirtyId):l[h]<-1&&(e.gl.texImage2D(m.target,0,s.internalFormat,r.realWidth,r.realHeight,0,r.format,s.type,null),l[h]=-1))}return!0},n.test=function(e){return Array.isArray(e)&&e.length===n.SIDES},n.SIDES=6,n}(Cr),vc=function(o){function n(e,r){var s=this;if(r=r||{},!(e instanceof HTMLImageElement)){var l=new Image;sa.crossOrigin(l,e,r.crossorigin),l.src=e,e=l}return s=o.call(this,e)||this,!e.complete&&s._width&&s._height&&(s._width=0,s._height=0),s.url=e.src,s._process=null,s.preserveBitmap=!1,s.createBitmap=(r.createBitmap!==void 0?r.createBitmap:ie.CREATE_IMAGE_BITMAP)&&!!self.createImageBitmap,s.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,s.bitmap=null,s._load=null,r.autoLoad!==!1&&s.load(),s}return fe(n,o),n.prototype.load=function(e){var r=this;return this._load||(e!==void 0&&(this.createBitmap=e),this._load=new Promise(function(s,l){var h=r.source;r.url=h.src;var m=function(){r.destroyed||(h.onload=null,h.onerror=null,r.resize(h.width,h.height),r._load=null,r.createBitmap?s(r.process()):s(r))};h.complete&&h.src?m():(h.onload=m,h.onerror=function(x){l(x),r.onError.emit(x)})})),this._load},n.prototype.process=function(){var e=this,r=this.source;return this._process!==null?this._process:this.bitmap===null&&self.createImageBitmap?(this._process=self.createImageBitmap(r,0,0,r.width,r.height,{premultiplyAlpha:this.alphaMode===It.UNPACK?"premultiply":"none"}).then(function(s){return e.destroyed?Promise.reject():(e.bitmap=s,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},n.prototype.upload=function(e,r,s){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,e,r,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,e,r,s,this.bitmap),!this.preserveBitmap){var l=!0,h=r._glTextures;for(var m in h){var x=h[m];if(x!==s&&x.dirtyId!==r.dirtyId){l=!1;break}}l&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},n.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},n.test=function(e){return typeof e=="string"||e instanceof HTMLImageElement},n}(sa),su=function(o){function n(e,r){var s=this;return r=r||{},(s=o.call(this,document.createElement("canvas"))||this)._width=0,s._height=0,s.svg=e,s.scale=r.scale||1,s._overrideWidth=r.width,s._overrideHeight=r.height,s._resolve=null,s._crossorigin=r.crossorigin,s._load=null,r.autoLoad!==!1&&s.load(),s}return fe(n,o),n.prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(r){if(e._resolve=function(){e.resize(e.source.width,e.source.height),r(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},n.prototype._loadSvg=function(){var e=this,r=new Image;sa.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=function(s){e._resolve&&(r.onerror=null,e.onError.emit(s))},r.onload=function(){if(e._resolve){var s=r.width,l=r.height;if(!s||!l)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var h=s*e.scale,m=l*e.scale;(e._overrideWidth||e._overrideHeight)&&(h=e._overrideWidth||e._overrideHeight/l*s,m=e._overrideHeight||e._overrideWidth/s*l),h=Math.round(h),m=Math.round(m);var x=e.source;x.width=h,x.height=m,x._pixiId="canvas_"+Er(),x.getContext("2d").drawImage(r,0,0,s,l,0,0,h,m),e._resolve(),e._resolve=null}}},n.getSize=function(e){var r=n.SVG_SIZE.exec(e),s={};return r&&(s[r[1]]=Math.round(parseFloat(r[3])),s[r[5]]=Math.round(parseFloat(r[7]))),s},n.prototype.dispose=function(){o.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},n.test=function(e,r){return r==="svg"||typeof e=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(e)||typeof e=="string"&&e.indexOf("<svg")===0},n.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,n}(sa),zu=function(o){function n(e,r){var s=this;if(r=r||{},!(e instanceof HTMLVideoElement)){var l=document.createElement("video");l.setAttribute("preload","auto"),l.setAttribute("webkit-playsinline",""),l.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);var h=e[0].src||e[0];sa.crossOrigin(l,h,r.crossorigin);for(var m=0;m<e.length;++m){var x=document.createElement("source"),b=e[m],w=b.src,R=b.mime,U=(w=w||e[m]).split("?").shift().toLowerCase(),B=U.substr(U.lastIndexOf(".")+1);R=R||n.MIME_TYPES[B]||"video/"+B,x.src=w,x.type=R,l.appendChild(x)}e=l}return(s=o.call(this,e)||this).noSubImage=!0,s._autoUpdate=!0,s._isConnectedToTicker=!1,s._updateFPS=r.updateFPS||0,s._msToNextUpdate=0,s.autoPlay=r.autoPlay!==!1,s._load=null,s._resolve=null,s._onCanPlay=s._onCanPlay.bind(s),s._onError=s._onError.bind(s),r.autoLoad!==!1&&s.load(),s}return fe(n,o),n.prototype.update=function(e){if(!this.destroyed){var r=ri.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(o.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},n.prototype.load=function(){var e=this;if(this._load)return this._load;var r=this.source;return(r.readyState===r.HAVE_ENOUGH_DATA||r.readyState===r.HAVE_FUTURE_DATA)&&r.width&&r.height&&(r.complete=!0),r.addEventListener("play",this._onPlayStart.bind(this)),r.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(r.addEventListener("canplay",this._onCanPlay),r.addEventListener("canplaythrough",this._onCanPlay),r.addEventListener("error",this._onError,!0)),this._load=new Promise(function(s){e.valid?s(e):(e._resolve=s,r.load())}),this._load},n.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},n.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&e.paused===!1&&e.ended===!1&&e.readyState>2},n.prototype._isSourceReady=function(){var e=this.source;return e.readyState===3||e.readyState===4},n.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(ri.shared.add(this.update,this),this._isConnectedToTicker=!0)},n.prototype._onPlayStop=function(){this._isConnectedToTicker&&(ri.shared.remove(this.update,this),this._isConnectedToTicker=!1)},n.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var r=this.valid;this.resize(e.videoWidth,e.videoHeight),!r&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},n.prototype.dispose=function(){this._isConnectedToTicker&&ri.shared.remove(this.update,this);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),o.prototype.dispose.call(this)},Object.defineProperty(n.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(ri.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(ri.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),n.test=function(e,r){return self.HTMLVideoElement&&e instanceof HTMLVideoElement||n.TYPES.indexOf(r)>-1},n.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],n.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},n}(sa),Il=function(o){function n(e){return o.call(this,e)||this}return fe(n,o),n.test=function(e){return!!self.createImageBitmap&&e instanceof ImageBitmap},n}(sa);Bt.push(vc,Il,Qi,zu,su,pr,Rl,Cl);var Gr={__proto__:null,Resource:Gn,BaseImageResource:sa,INSTALLED:Bt,autoDetectResource:he,AbstractMultiResource:Cr,ArrayResource:Cl,BufferResource:pr,CanvasResource:Qi,CubeResource:Rl,ImageResource:vc,SVGResource:su,VideoResource:zu,ImageBitmapResource:Il},qo=function(){function o(n){this.renderer=n}return o.prototype.destroy=function(){this.renderer=null},o}(),bp=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return fe(n,o),n.prototype.upload=function(e,r,s){var l=e.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===It.UNPACK);var h=r.realWidth,m=r.realHeight;return s.width===h&&s.height===m?l.texSubImage2D(r.target,0,0,0,h,m,r.format,r.type,this.data):(s.width=h,s.height=m,l.texImage2D(r.target,0,e.context.webGLVersion===1?l.DEPTH_COMPONENT:l.DEPTH_COMPONENT16,h,m,0,r.format,r.type,this.data)),!0},n}(pr),ju=function(){function o(n,e){this.width=Math.ceil(n||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new di("disposeFramebuffer"),this.multisample=qe.NONE}return Object.defineProperty(o.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),o.prototype.addColorTexture=function(n,e){return n===void 0&&(n=0),this.colorTextures[n]=e||new fr(null,{scaleMode:dt.NEAREST,resolution:1,mipmap:Ct.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},o.prototype.addDepthTexture=function(n){return this.depthTexture=n||new fr(new bp(null,{width:this.width,height:this.height}),{scaleMode:dt.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Ct.OFF,format:$i.DEPTH_COMPONENT,type:Q.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},o.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},o.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},o.prototype.resize=function(n,e){if(n=Math.ceil(n),e=Math.ceil(e),n!==this.width||e!==this.height){this.width=n,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var s=this.colorTextures[r],l=s.resolution;s.setSize(n/l,e/l)}this.depthTexture&&(l=this.depthTexture.resolution,this.depthTexture.setSize(n/l,e/l))}},o.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},o.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},o}(),_d=function(o){function n(e){var r=this;if(typeof e=="number"){var s=arguments[0],l=arguments[1],h=arguments[2],m=arguments[3];e={width:s,height:l,scaleMode:h,resolution:m}}r=o.call(this,null,e)||this;var x=e||{},b=x.width,w=x.height;return r.mipmap=Ct.OFF,r.width=Math.ceil(b)||100,r.height=Math.ceil(w)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new ju(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return fe(n,o),n.prototype.resize=function(e,r){e=Math.ceil(e),r=Math.ceil(r),this.framebuffer.resize(e*this.resolution,r*this.resolution)},n.prototype.dispose=function(){this.framebuffer.dispose(),o.prototype.dispose.call(this)},n.prototype.destroy=function(){o.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},n}(fr),yd=function(){function o(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return o.prototype.set=function(n,e,r){var s=e.width,l=e.height;if(r){var h=n.width/2/s,m=n.height/2/l,x=n.x/s+h,b=n.y/l+m;r=ni.add(r,ni.NW),this.x0=x+h*ni.uX(r),this.y0=b+m*ni.uY(r),r=ni.add(r,2),this.x1=x+h*ni.uX(r),this.y1=b+m*ni.uY(r),r=ni.add(r,2),this.x2=x+h*ni.uX(r),this.y2=b+m*ni.uY(r),r=ni.add(r,2),this.x3=x+h*ni.uX(r),this.y3=b+m*ni.uY(r)}else this.x0=n.x/s,this.y0=n.y/l,this.x1=(n.x+n.width)/s,this.y1=n.y/l,this.x2=(n.x+n.width)/s,this.y2=(n.y+n.height)/l,this.x3=n.x/s,this.y3=(n.y+n.height)/l;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},o.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},o}(),wp=new yd,Dn=function(o){function n(e,r,s,l,h,m){var x=o.call(this)||this;if(x.noFrame=!1,r||(x.noFrame=!0,r=new dr(0,0,1,1)),e instanceof n&&(e=e.baseTexture),x.baseTexture=e,x._frame=r,x.trim=l,x.valid=!1,x._uvs=wp,x.uvMatrix=null,x.orig=s||r,x._rotate=Number(h||0),h===!0)x._rotate=2;else if(x._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return x.defaultAnchor=m?new ai(m.x,m.y):new ai(0,0),x._updateID=0,x.textureCacheIds=[],e.valid?x.noFrame?e.valid&&x.onBaseTextureUpdated(e):x.frame=r:e.once("loaded",x.onBaseTextureUpdated,x),x.noFrame&&e.on("update",x.onBaseTextureUpdated,x),x}return fe(n,o),n.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},n.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},n.prototype.destroy=function(e){if(this.baseTexture){if(e){var r=this.baseTexture.resource;r&&r.url&&Ki[r.url]&&n.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,n.removeFromCache(this),this.textureCacheIds=null},n.prototype.clone=function(){var e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),s=new n(this.baseTexture,!this.noFrame&&e,r,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(s._frame=e),s},n.prototype.updateUvs=function(){this._uvs===wp&&(this._uvs=new yd),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},n.from=function(e,r,s){r===void 0&&(r={}),s===void 0&&(s=ie.STRICT_TEXTURE_CACHE);var l=typeof e=="string",h=null;if(l)h=e;else{if(!e._pixiId){var m=r&&r.pixiIdPrefix||"pixiid";e._pixiId=m+"_"+Er()}h=e._pixiId}var x=Ki[h];if(l&&s&&!x)throw new Error('The cacheId "'+h+'" does not exist in TextureCache.');return x||(r.resolution||(r.resolution=ao(e)),(x=new n(new fr(e,r))).baseTexture.cacheId=h,fr.addToCache(x.baseTexture,h),n.addToCache(x,h)),x},n.fromURL=function(e,r){var s=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),l=n.from(e,Object.assign({resourceOptions:s},r),!1),h=l.baseTexture.resource;return l.baseTexture.valid?Promise.resolve(l):h.load().then(function(){return Promise.resolve(l)})},n.fromBuffer=function(e,r,s,l){return new n(fr.fromBuffer(e,r,s,l))},n.fromLoader=function(e,r,s,l){var h=new fr(e,Object.assign({scaleMode:ie.SCALE_MODE,resolution:ao(r)},l)),m=h.resource;m instanceof vc&&(m.url=r);var x=new n(h);return s||(s=r),fr.addToCache(x.baseTexture,s),n.addToCache(x,s),s!==r&&(fr.addToCache(x.baseTexture,r),n.addToCache(x,r)),x.baseTexture.valid?Promise.resolve(x):new Promise(function(b){x.baseTexture.once("loaded",function(){return b(x)})})},n.addToCache=function(e,r){r&&(e.textureCacheIds.indexOf(r)===-1&&e.textureCacheIds.push(r),Ki[r]&&console.warn("Texture added to the cache with an id ["+r+"] that already had an entry"),Ki[r]=e)},n.removeFromCache=function(e){if(typeof e=="string"){var r=Ki[e];if(r){var s=r.textureCacheIds.indexOf(e);return s>-1&&r.textureCacheIds.splice(s,1),delete Ki[e],r}}else if(e&&e.textureCacheIds){for(var l=0;l<e.textureCacheIds.length;++l)Ki[e.textureCacheIds[l]]===e&&delete Ki[e.textureCacheIds[l]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(n.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var r=e.x,s=e.y,l=e.width,h=e.height,m=r+l>this.baseTexture.width,x=s+h>this.baseTexture.height;if(m||x){var b=m&&x?"and":"or",w="X: "+r+" + "+l+" = "+(r+l)+" > "+this.baseTexture.width,R="Y: "+s+" + "+h+" = "+(s+h)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+w+" "+b+" "+R)}this.valid=l&&h&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),n.prototype.castToBaseTexture=function(){return this.baseTexture},n}(ar.a);function Ss(o){o.destroy=function(){},o.on=function(){},o.once=function(){},o.emit=function(){}}Dn.EMPTY=new Dn(new fr),Ss(Dn.EMPTY),Ss(Dn.EMPTY.baseTexture),Dn.WHITE=function(){var o=document.createElement("canvas");o.width=16,o.height=16;var n=o.getContext("2d");return n.fillStyle="white",n.fillRect(0,0,16,16),new Dn(new fr(new Qi(o)))}(),Ss(Dn.WHITE),Ss(Dn.WHITE.baseTexture);var Ri=function(o){function n(e,r){var s=o.call(this,e,r)||this;return s.valid=!0,s.filterFrame=null,s.filterPoolKey=null,s.updateUvs(),s}return fe(n,o),Object.defineProperty(n.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),n.prototype.resize=function(e,r,s){s===void 0&&(s=!0),e=Math.ceil(e),r=Math.ceil(r),this.valid=e>0&&r>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=r,s&&this.baseTexture.resize(e,r),this.updateUvs()},n.prototype.setResolution=function(e){var r=this.baseTexture;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))},n.create=function(e){for(var r=arguments,s=[],l=1;l<arguments.length;l++)s[l-1]=r[l];return typeof e=="number"&&(is("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),e={width:e,height:s[0],scaleMode:s[1],resolution:s[2]}),new n(new _d(e))},n}(Dn),au=function(){function o(n){this.texturePool={},this.textureOptions=n||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return o.prototype.createTexture=function(n,e){var r=new _d(Object.assign({width:n,height:e,resolution:1},this.textureOptions));return new Ri(r)},o.prototype.getOptimalTexture=function(n,e,r){r===void 0&&(r=1);var s=o.SCREEN_KEY;n*=r,e*=r,this.enableFullScreen&&n===this._pixelsWidth&&e===this._pixelsHeight||(s=(65535&(n=ln(n)))<<16|65535&(e=ln(e))),this.texturePool[s]||(this.texturePool[s]=[]);var l=this.texturePool[s].pop();return l||(l=this.createTexture(n,e)),l.filterPoolKey=s,l.setResolution(r),l},o.prototype.getFilterTexture=function(n,e){var r=this.getOptimalTexture(n.width,n.height,e||n.resolution);return r.filterFrame=n.filterFrame,r},o.prototype.returnTexture=function(n){var e=n.filterPoolKey;n.filterFrame=null,this.texturePool[e].push(n)},o.prototype.returnFilterTexture=function(n){this.returnTexture(n)},o.prototype.clear=function(n){if(n=n!==!1)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var s=0;s<r.length;s++)r[s].destroy(!0)}this.texturePool={}},o.prototype.setScreenSize=function(n){if(n.width!==this._pixelsWidth||n.height!==this._pixelsHeight){var e=o.SCREEN_KEY,r=this.texturePool[e];if(this.enableFullScreen=n.width>0&&n.height>0,r)for(var s=0;s<r.length;s++)r[s].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=n.width,this._pixelsHeight=n.height}},o.SCREEN_KEY="screen",o}(),Ll=function(){function o(n,e,r,s,l,h,m){e===void 0&&(e=0),r===void 0&&(r=!1),s===void 0&&(s=Q.FLOAT),this.buffer=n,this.size=e,this.normalized=r,this.type=s,this.stride=l,this.start=h,this.instance=m}return o.prototype.destroy=function(){this.buffer=null},o.from=function(n,e,r,s,l){return new o(n,e,r,s,l)},o}(),Tp=0,Yi=function(){function o(n,e,r){e===void 0&&(e=!0),r===void 0&&(r=!1),this.data=n||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=Tp++,this.disposeRunner=new di("disposeBuffer")}return o.prototype.update=function(n){this.data=n||this.data,this._updateID++},o.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},o.prototype.destroy=function(){this.dispose(),this.data=null},o.from=function(n){return n instanceof Array&&(n=new Float32Array(n)),new o(n)},o}();function Th(o){if(o.BYTES_PER_ELEMENT===4)return o instanceof Float32Array?"Float32Array":o instanceof Uint32Array?"Uint32Array":"Int32Array";if(o.BYTES_PER_ELEMENT===2){if(o instanceof Uint16Array)return"Uint16Array"}else if(o.BYTES_PER_ELEMENT===1&&o instanceof Uint8Array)return"Uint8Array";return null}var Sp={Float32Array,Uint32Array,Int32Array,Uint8Array},Ol={5126:4,5123:2,5121:1},Vu=0,_c={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Ca=function(){function o(n,e){n===void 0&&(n=[]),e===void 0&&(e={}),this.buffers=n,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Vu++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new di("disposeGeometry"),this.refCount=0}return o.prototype.addAttribute=function(n,e,r,s,l,h,m,x){if(r===void 0&&(r=0),s===void 0&&(s=!1),x===void 0&&(x=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Yi||(e instanceof Array&&(e=new Float32Array(e)),e=new Yi(e));var b=n.split("|");if(b.length>1){for(var w=0;w<b.length;w++)this.addAttribute(b[w],e,r,s,l);return this}var R=this.buffers.indexOf(e);return R===-1&&(this.buffers.push(e),R=this.buffers.length-1),this.attributes[n]=new Ll(R,r,s,l,h,m,x),this.instanced=this.instanced||x,this},o.prototype.getAttribute=function(n){return this.attributes[n]},o.prototype.getBuffer=function(n){return this.buffers[this.getAttribute(n).buffer]},o.prototype.addIndex=function(n){return n instanceof Yi||(n instanceof Array&&(n=new Uint16Array(n)),n=new Yi(n)),n.index=!0,this.indexBuffer=n,this.buffers.indexOf(n)===-1&&this.buffers.push(n),this},o.prototype.getIndex=function(){return this.indexBuffer},o.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var n,e=[],r=[],s=new Yi;for(n in this.attributes){var l=this.attributes[n],h=this.buffers[l.buffer];e.push(h.data),r.push(l.size*Ol[l.type]/4),l.buffer=0}for(s.data=function(m,x){for(var b=0,w=0,R={},U=0;U<m.length;U++)w+=x[U],b+=m[U].length;var B=new ArrayBuffer(4*b),j=null,K=0;for(U=0;U<m.length;U++){var ut=x[U],gt=m[U],Rt=Th(gt);R[Rt]||(R[Rt]=new Sp[Rt](B)),j=R[Rt];for(var Le=0;Le<gt.length;Le++)j[(Le/ut|0)*w+K+Le%ut]=gt[Le];K+=ut}return new Float32Array(B)}(e,r),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},o.prototype.getSize=function(){for(var n in this.attributes){var e=this.attributes[n];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},o.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},o.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},o.prototype.clone=function(){for(var n=new o,e=0;e<this.buffers.length;e++)n.buffers[e]=new Yi(this.buffers[e].data.slice(0));for(var e in this.attributes){var r=this.attributes[e];n.attributes[e]=new Ll(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(n.indexBuffer=n.buffers[this.buffers.indexOf(this.indexBuffer)],n.indexBuffer.index=!0),n},o.merge=function(n){for(var e,r=new o,s=[],l=[],h=[],m=0;m<n.length;m++){e=n[m];for(var x=0;x<e.buffers.length;x++)l[x]=l[x]||0,l[x]+=e.buffers[x].data.length,h[x]=0}for(m=0;m<e.buffers.length;m++)s[m]=new _c[Th(e.buffers[m].data)](l[m]),r.buffers[m]=new Yi(s[m]);for(m=0;m<n.length;m++)for(e=n[m],x=0;x<e.buffers.length;x++)s[x].set(e.buffers[x].data,h[x]),h[x]+=e.buffers[x].data.length;if(r.attributes=e.attributes,e.indexBuffer){r.indexBuffer=r.buffers[e.buffers.indexOf(e.indexBuffer)],r.indexBuffer.index=!0;var b=0,w=0,R=0,U=0;for(m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){U=m;break}for(var m in e.attributes){var B=e.attributes[m];(0|B.buffer)===U&&(w+=B.size*Ol[B.type]/4)}for(m=0;m<n.length;m++){var j=n[m].indexBuffer.data;for(x=0;x<j.length;x++)r.indexBuffer.data[x+R]+=b;b+=e.buffers[U].data.length/w,R+=j.length}}return r},o}(),Ra=function(o){function n(){var e=o.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return fe(n,o),n}(Ca),qi=function(o){function n(){var e=o.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new Yi(e.vertices),e.uvBuffer=new Yi(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return fe(n,o),n.prototype.map=function(e,r){var s=0,l=0;return this.uvs[0]=s,this.uvs[1]=l,this.uvs[2]=s+r.width/e.width,this.uvs[3]=l,this.uvs[4]=s+r.width/e.width,this.uvs[5]=l+r.height/e.height,this.uvs[6]=s,this.uvs[7]=l+r.height/e.height,s=r.x,l=r.y,this.vertices[0]=s,this.vertices[1]=l,this.vertices[2]=s+r.width,this.vertices[3]=l,this.vertices[4]=s+r.width,this.vertices[5]=l+r.height,this.vertices[6]=s,this.vertices[7]=l+r.height,this.invalidate(),this},n.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},n}(Ca),Wu=0,uo=function(){function o(n,e){this.uniforms=n,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Wu++,this.static=!!e}return o.prototype.update=function(){this.dirtyId++},o.prototype.add=function(n,e,r){this.uniforms[n]=new o(e,r)},o.from=function(n,e){return new o(n,e)},o}(),uu=function(){function o(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new dr,this.destinationFrame=new dr,this.bindingSourceFrame=new dr,this.bindingDestinationFrame=new dr,this.filters=[],this.transform=null}return o.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},o}(),wo=[new ai,new ai,new ai,new ai],Hi=new yi,Sh=function(o){function n(e){var r=o.call(this,e)||this;return r.defaultFilterStack=[{}],r.texturePool=new au,r.texturePool.setScreenSize(e.view),r.statePool=[],r.quad=new Ra,r.quadUv=new qi,r.tempRect=new dr,r.activeState={},r.globalUniforms=new uo({outputFrame:new dr,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return fe(n,o),n.prototype.push=function(e,r){for(var s=this.renderer,l=this.defaultFilterStack,h=this.statePool.pop()||new uu,m=this.renderer.renderTexture,x=r[0].resolution,b=r[0].padding,w=r[0].autoFit,R=r[0].legacy,U=1;U<r.length;U++){var B=r[U];x=Math.min(x,B.resolution),b=this.useMaxPadding?Math.max(b,B.padding):b+B.padding,w=w&&B.autoFit,R=R||B.legacy}if(l.length===1&&(this.defaultFilterStack[0].renderTexture=m.current),l.push(h),h.resolution=x,h.legacy=R,h.target=e,h.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),h.sourceFrame.pad(b),w){var j=this.tempRect.copyFrom(m.sourceFrame);s.projection.transform&&this.transformAABB(Hi.copyFrom(s.projection.transform).invert(),j),h.sourceFrame.fit(j)}this.roundFrame(h.sourceFrame,m.current?m.current.resolution:s.resolution,m.sourceFrame,m.destinationFrame,s.projection.transform),h.renderTexture=this.getOptimalFilterTexture(h.sourceFrame.width,h.sourceFrame.height,x),h.filters=r,h.destinationFrame.width=h.renderTexture.width,h.destinationFrame.height=h.renderTexture.height;var K=this.tempRect;K.x=0,K.y=0,K.width=h.sourceFrame.width,K.height=h.sourceFrame.height,h.renderTexture.filterFrame=h.sourceFrame,h.bindingSourceFrame.copyFrom(m.sourceFrame),h.bindingDestinationFrame.copyFrom(m.destinationFrame),h.transform=s.projection.transform,s.projection.transform=null,m.bind(h.renderTexture,h.sourceFrame,K),s.framebuffer.clear(0,0,0,0)},n.prototype.pop=function(){var e=this.defaultFilterStack,r=e.pop(),s=r.filters;this.activeState=r;var l=this.globalUniforms.uniforms;l.outputFrame=r.sourceFrame,l.resolution=r.resolution;var h=l.inputSize,m=l.inputPixel,x=l.inputClamp;if(h[0]=r.destinationFrame.width,h[1]=r.destinationFrame.height,h[2]=1/h[0],h[3]=1/h[1],m[0]=h[0]*r.resolution,m[1]=h[1]*r.resolution,m[2]=1/m[0],m[3]=1/m[1],x[0]=.5*m[2],x[1]=.5*m[3],x[2]=r.sourceFrame.width*h[2]-.5*m[2],x[3]=r.sourceFrame.height*h[3]-.5*m[3],r.legacy){var b=l.filterArea;b[0]=r.destinationFrame.width,b[1]=r.destinationFrame.height,b[2]=r.sourceFrame.x,b[3]=r.sourceFrame.y,l.filterClamp=l.inputClamp}this.globalUniforms.update();var w=e[e.length-1];if(r.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,r.renderTexture,w.renderTexture,Zt.BLEND,r),this.returnFilterTexture(r.renderTexture);else{var R=r.renderTexture,U=this.getOptimalFilterTexture(R.width,R.height,r.resolution);U.filterFrame=R.filterFrame;var B=0;for(B=0;B<s.length-1;++B){s[B].apply(this,R,U,Zt.CLEAR,r);var j=R;R=U,U=j}s[B].apply(this,R,w.renderTexture,Zt.BLEND,r),this.returnFilterTexture(R),this.returnFilterTexture(U)}r.clear(),this.statePool.push(r)},n.prototype.bindAndClear=function(e,r){r===void 0&&(r=Zt.CLEAR);var s=this.renderer,l=s.renderTexture,h=s.state;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e&&e.filterFrame){var m=this.tempRect;m.x=0,m.y=0,m.width=e.filterFrame.width,m.height=e.filterFrame.height,l.bind(e,e.filterFrame,m)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?l.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var x=1&h.stateId||this.forceClear;(r===Zt.CLEAR||r===Zt.BLIT&&x)&&this.renderer.framebuffer.clear(0,0,0,0)},n.prototype.applyFilter=function(e,r,s,l){var h=this.renderer;h.state.set(e.state),this.bindAndClear(s,l),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,h.shader.bind(e),e.legacy?(this.quadUv.map(r._frame,r.filterFrame),h.geometry.bind(this.quadUv),h.geometry.draw(so.TRIANGLES)):(h.geometry.bind(this.quad),h.geometry.draw(so.TRIANGLE_STRIP))},n.prototype.calculateSpriteMatrix=function(e,r){var s=this.activeState,l=s.sourceFrame,h=s.destinationFrame,m=r._texture.orig,x=e.set(h.width,0,0,h.height,l.x,l.y),b=r.worldTransform.copyTo(yi.TEMP_MATRIX);return b.invert(),x.prepend(b),x.scale(1/m.width,1/m.height),x.translate(r.anchor.x,r.anchor.y),x},n.prototype.destroy=function(){this.texturePool.clear(!1)},n.prototype.getOptimalFilterTexture=function(e,r,s){return s===void 0&&(s=1),this.texturePool.getOptimalTexture(e,r,s)},n.prototype.getFilterTexture=function(e,r){if(typeof e=="number"){var s=e;e=r,r=s}e=e||this.activeState.renderTexture;var l=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution);return l.filterFrame=e.filterFrame,l},n.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},n.prototype.emptyPool=function(){this.texturePool.clear(!0)},n.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},n.prototype.transformAABB=function(e,r){var s=wo[0],l=wo[1],h=wo[2],m=wo[3];s.set(r.left,r.top),l.set(r.left,r.bottom),h.set(r.right,r.top),m.set(r.right,r.bottom),e.apply(s,s),e.apply(l,l),e.apply(h,h),e.apply(m,m);var x=Math.min(s.x,l.x,h.x,m.x),b=Math.min(s.y,l.y,h.y,m.y),w=Math.max(s.x,l.x,h.x,m.x),R=Math.max(s.y,l.y,h.y,m.y);r.x=x,r.y=b,r.width=w-x,r.height=R-b},n.prototype.roundFrame=function(e,r,s,l,h){if(h){var m=h.a,x=h.b,b=h.c,w=h.d;if(!(x===0&&b===0||m===0&&w===0))return}(h=h?Hi.copyFrom(h):Hi.identity()).translate(-s.x,-s.y).scale(l.width/s.width,l.height/s.height).translate(l.x,l.y),this.transformAABB(h,e),e.ceil(r),this.transformAABB(h.invert(),e)},n}(qo),Ia=function(){function o(n){this.renderer=n}return o.prototype.flush=function(){},o.prototype.destroy=function(){this.renderer=null},o.prototype.start=function(){},o.prototype.stop=function(){this.flush()},o.prototype.render=function(n){},o}(),xi=function(o){function n(e){var r=o.call(this,e)||this;return r.emptyRenderer=new Ia(e),r.currentRenderer=r.emptyRenderer,r}return fe(n,o),n.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},n.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},n.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},n.prototype.copyBoundTextures=function(e,r){for(var s=this.renderer.texture.boundTextures,l=r-1;l>=0;--l)e[l]=s[l]||null,e[l]&&(e[l]._batchLocation=l)},n.prototype.boundArray=function(e,r,s,l){for(var h=e.elements,m=e.ids,x=e.count,b=0,w=0;w<x;w++){var R=h[w],U=R._batchLocation;if(U>=0&&U<l&&r[U]===R)m[w]=U;else for(;b<l;){var B=r[b];if(!B||B._batchEnabled!==s||B._batchLocation!==b){m[w]=b,R._batchLocation=b,r[b]=R;break}b++}}},n}(qo),to=0,yc=function(o){function n(e){var r=o.call(this,e)||this;return r.webGLVersion=1,r.extensions={},r.supports={uint32Indices:!1},r.handleContextLost=r.handleContextLost.bind(r),r.handleContextRestored=r.handleContextRestored.bind(r),e.view.addEventListener("webglcontextlost",r.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",r.handleContextRestored,!1),r}return fe(n,o),Object.defineProperty(n.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),n.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=to++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},n.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=to++,this.renderer.runners.contextChange.emit(e)},n.prototype.initFromOptions=function(e){var r=this.createContext(this.renderer.view,e);this.initFromContext(r)},n.prototype.createContext=function(e,r){var s;if(ie.PREFER_ENV>=Lr.WEBGL2&&(s=e.getContext("webgl2",r)),s)this.webGLVersion=2;else if(this.webGLVersion=1,!(s=e.getContext("webgl",r)||e.getContext("experimental-webgl",r)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl},n.prototype.getExtensions=function(){var e=this.gl,r={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})},n.prototype.handleContextLost=function(e){e.preventDefault()},n.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},n.prototype.destroy=function(){var e=this.renderer.view;e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},n.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},n.prototype.validateContext=function(e){var r=e.getContextAttributes(),s="WebGL2RenderingContext"in self&&e instanceof self.WebGL2RenderingContext;s&&(this.webGLVersion=2),r.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var l=s||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=l,l||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},n}(qo),xd=function(o){this.framebuffer=o,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=qe.NONE,this.msaaBuffer=null,this.blitFramebuffer=null},Ge=new dr,Ii=function(o){function n(e){var r=o.call(this,e)||this;return r.managedFramebuffers=[],r.unknownFramebuffer=new ju(10,10),r.msaaSamples=null,r}return fe(n,o),n.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new dr,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var r=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;ie.PREFER_ENV===Lr.WEBGL_LEGACY&&(r=null,s=null),r?e.drawBuffers=function(l){return r.drawBuffersWEBGL(l)}:(this.hasMRT=!1,e.drawBuffers=function(){}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},n.prototype.bind=function(e,r){var s=this.gl;if(e){var l=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,s.bindFramebuffer(s.FRAMEBUFFER,l.framebuffer)),l.dirtyId!==e.dirtyId&&(l.dirtyId=e.dirtyId,l.dirtyFormat!==e.dirtyFormat?(l.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)):l.dirtySize!==e.dirtySize&&(l.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var h=0;h<e.colorTextures.length;h++){var m=e.colorTextures[h];this.renderer.texture.unbind(m.parentTextureArray||m)}e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},n.prototype.setViewport=function(e,r,s,l){var h=this.viewport;h.width===s&&h.height===l&&h.x===e&&h.y===r||(h.x=e,h.y=r,h.width=s,h.height=l,this.gl.viewport(e,r,s,l))},Object.defineProperty(n.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),n.prototype.clear=function(e,r,s,l,h){h===void 0&&(h=ws.COLOR|ws.DEPTH);var m=this.gl;m.clearColor(e,r,s,l),m.clear(h)},n.prototype.initFramebuffer=function(e){var r=this.gl,s=new xd(r.createFramebuffer());return s.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(e),e.disposeRunner.add(this),s},n.prototype.resizeFramebuffer=function(e){var r=this.gl,s=e.glFramebuffers[this.CONTEXT_UID];s.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,s.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e.width,e.height));for(var l=e.colorTextures,h=0;h<l.length;h++)this.renderer.texture.bind(l[h],0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},n.prototype.updateFramebuffer=function(e){var r=this.gl,s=e.glFramebuffers[this.CONTEXT_UID],l=e.colorTextures.length;r.drawBuffers||(l=Math.min(l,1)),s.multisample>1&&(s.msaaBuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,s.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,s.multisample,r.RGBA8,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,s.msaaBuffer));for(var h=[],m=0;m<l;m++)if(!(m===0&&s.multisample>1)){var x=e.colorTextures[m],b=x.parentTextureArray||x;this.renderer.texture.bind(b,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+m,x.target,b._glTextures[this.CONTEXT_UID].texture,0),h.push(r.COLOR_ATTACHMENT0+m)}if(h.length>1&&r.drawBuffers(h),e.depthTexture&&this.writeDepthTexture){var w=e.depthTexture;this.renderer.texture.bind(w,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,w._glTextures[this.CONTEXT_UID].texture,0)}s.stencil||!e.stencil&&!e.depth||(s.stencil=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,s.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e.width,e.height),e.depthTexture||r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,s.stencil))},n.prototype.detectSamples=function(e){var r=this.msaaSamples,s=qe.NONE;if(e<=1||r===null)return s;for(var l=0;l<r.length;l++)if(r[l]<=e){s=r[l];break}return s===1&&(s=qe.NONE),s},n.prototype.blit=function(e,r,s){var l=this.current,h=this.renderer,m=this.gl,x=this.CONTEXT_UID;if(h.context.webGLVersion===2&&l){var b=l.glFramebuffers[x];if(b){if(!e){if(b.multisample<=1)return;b.blitFramebuffer||(b.blitFramebuffer=new ju(l.width,l.height),b.blitFramebuffer.addColorTexture(0,l.colorTextures[0])),(e=b.blitFramebuffer).width=l.width,e.height=l.height}r||((r=Ge).width=l.width,r.height=l.height),s||(s=r);var w=r.width===s.width&&r.height===s.height;this.bind(e),m.bindFramebuffer(m.READ_FRAMEBUFFER,b.framebuffer),m.blitFramebuffer(r.x,r.y,r.width,r.height,s.x,s.y,s.width,s.height,m.COLOR_BUFFER_BIT,w?m.NEAREST:m.LINEAR)}}},n.prototype.disposeFramebuffer=function(e,r){var s=e.glFramebuffers[this.CONTEXT_UID],l=this.gl;if(s){delete e.glFramebuffers[this.CONTEXT_UID];var h=this.managedFramebuffers.indexOf(e);h>=0&&this.managedFramebuffers.splice(h,1),e.disposeRunner.remove(this),r||(l.deleteFramebuffer(s.framebuffer),s.stencil&&l.deleteRenderbuffer(s.stencil))}},n.prototype.disposeAll=function(e){var r=this.managedFramebuffers;this.managedFramebuffers=[];for(var s=0;s<r.length;s++)this.disposeFramebuffer(r[s],e)},n.prototype.forceStencil=function(){var e=this.current;if(e){var r=e.glFramebuffers[this.CONTEXT_UID];if(r&&!r.stencil){e.enableStencil();var s=e.width,l=e.height,h=this.gl,m=h.createRenderbuffer();h.bindRenderbuffer(h.RENDERBUFFER,m),h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_STENCIL,s,l),r.stencil=m,h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.RENDERBUFFER,m)}}},n.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new dr},n}(qo),lu=function(o){this.buffer=o||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},as={5126:4,5123:2,5121:1},Eh=function(o){function n(e){var r=o.call(this,e)||this;return r._activeGeometry=null,r._activeVao=null,r.hasVao=!0,r.hasInstance=!0,r.canUseUInt32ElementIndex=!1,r.managedGeometries={},r.managedBuffers={},r}return fe(n,o),n.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){var s=this.renderer.context.extensions.vertexArrayObject;ie.PREFER_ENV===Lr.WEBGL_LEGACY&&(s=null),s?(e.createVertexArray=function(){return s.createVertexArrayOES()},e.bindVertexArray=function(h){return s.bindVertexArrayOES(h)},e.deleteVertexArray=function(h){return s.deleteVertexArrayOES(h)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(r.webGLVersion!==2){var l=e.getExtension("ANGLE_instanced_arrays");l?(e.vertexAttribDivisor=function(h,m){return l.vertexAttribDivisorANGLE(h,m)},e.drawElementsInstanced=function(h,m,x,b,w){return l.drawElementsInstancedANGLE(h,m,x,b,w)},e.drawArraysInstanced=function(h,m,x,b){return l.drawArraysInstancedANGLE(h,m,x,b)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex},n.prototype.bind=function(e,r){r=r||this.renderer.shader.shader;var s=this.gl,l=e.glVertexArrayObjects[this.CONTEXT_UID],h=!1;l||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=l={},h=!0);var m=l[r.program.id]||this.initGeometryVao(e,r.program,h);this._activeGeometry=e,this._activeVao!==m&&(this._activeVao=m,this.hasVao?s.bindVertexArray(m):this.activateVao(e,r.program)),this.updateBuffers()},n.prototype.reset=function(){this.unbind()},n.prototype.updateBuffers=function(){for(var e=this._activeGeometry,r=this.gl,s=0;s<e.buffers.length;s++){var l=e.buffers[s],h=l._glBuffers[this.CONTEXT_UID];if(l._updateID!==h.updateID){h.updateID=l._updateID;var m=l.index?r.ELEMENT_ARRAY_BUFFER:r.ARRAY_BUFFER;if(r.bindBuffer(m,h.buffer),this._boundBuffer=h,h.byteLength>=l.data.byteLength)r.bufferSubData(m,0,l.data);else{var x=l.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;h.byteLength=l.data.byteLength,r.bufferData(m,l.data,x)}}}},n.prototype.checkCompatibility=function(e,r){var s=e.attributes,l=r.attributeData;for(var h in l)if(!s[h])throw new Error('shader and geometry incompatible, geometry missing the "'+h+'" attribute')},n.prototype.getSignature=function(e,r){var s=e.attributes,l=r.attributeData,h=["g",e.id];for(var m in s)l[m]&&h.push(m);return h.join("-")},n.prototype.initGeometryVao=function(e,r,s){s===void 0&&(s=!0),this.checkCompatibility(e,r);var l=this.gl,h=this.CONTEXT_UID,m=this.getSignature(e,r),x=e.glVertexArrayObjects[this.CONTEXT_UID],b=x[m];if(b)return x[r.id]=b,b;var w=e.buffers,R=e.attributes,U={},B={};for(var j in w)U[j]=0,B[j]=0;for(var j in R)!R[j].size&&r.attributeData[j]?R[j].size=r.attributeData[j].size:R[j].size||console.warn("PIXI Geometry attribute '"+j+"' size cannot be determined (likely the bound shader does not have the attribute)"),U[R[j].buffer]+=R[j].size*as[R[j].type];for(var j in R){var K=R[j],ut=K.size;K.stride===void 0&&(U[K.buffer]===ut*as[K.type]?K.stride=0:K.stride=U[K.buffer]),K.start===void 0&&(K.start=B[K.buffer],B[K.buffer]+=ut*as[K.type])}b=l.createVertexArray(),l.bindVertexArray(b);for(var gt=0;gt<w.length;gt++){var Rt=w[gt];Rt._glBuffers[h]||(Rt._glBuffers[h]=new lu(l.createBuffer()),this.managedBuffers[Rt.id]=Rt,Rt.disposeRunner.add(this)),s&&Rt._glBuffers[h].refCount++}return this.activateVao(e,r),this._activeVao=b,x[r.id]=b,x[m]=b,b},n.prototype.disposeBuffer=function(e,r){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var s=e._glBuffers[this.CONTEXT_UID],l=this.gl;e.disposeRunner.remove(this),s&&(r||l.deleteBuffer(s.buffer),delete e._glBuffers[this.CONTEXT_UID])}},n.prototype.disposeGeometry=function(e,r){if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var s=e.glVertexArrayObjects[this.CONTEXT_UID],l=this.gl,h=e.buffers;if(e.disposeRunner.remove(this),s){for(var m=0;m<h.length;m++){var x=h[m]._glBuffers[this.CONTEXT_UID];x.refCount--,x.refCount!==0||r||this.disposeBuffer(h[m],r)}if(!r){for(var b in s)if(b[0]==="g"){var w=s[b];this._activeVao===w&&this.unbind(),l.deleteVertexArray(w)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},n.prototype.disposeAll=function(e){for(var r=Object.keys(this.managedGeometries),s=0;s<r.length;s++)this.disposeGeometry(this.managedGeometries[r[s]],e);for(r=Object.keys(this.managedBuffers),s=0;s<r.length;s++)this.disposeBuffer(this.managedBuffers[r[s]],e)},n.prototype.activateVao=function(e,r){var s=this.gl,l=this.CONTEXT_UID,h=e.buffers,m=e.attributes;e.indexBuffer&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.indexBuffer._glBuffers[l].buffer);var x=null;for(var b in m){var w=m[b],R=h[w.buffer]._glBuffers[l];if(r.attributeData[b]){x!==R&&(s.bindBuffer(s.ARRAY_BUFFER,R.buffer),x=R);var U=r.attributeData[b].location;if(s.enableVertexAttribArray(U),s.vertexAttribPointer(U,w.size,w.type||s.FLOAT,w.normalized,w.stride,w.start),w.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");s.vertexAttribDivisor(U,1)}}}},n.prototype.draw=function(e,r,s,l){var h=this.gl,m=this._activeGeometry;if(m.indexBuffer){var x=m.indexBuffer.data.BYTES_PER_ELEMENT,b=x===2?h.UNSIGNED_SHORT:h.UNSIGNED_INT;x===2||x===4&&this.canUseUInt32ElementIndex?m.instanced?h.drawElementsInstanced(e,r||m.indexBuffer.data.length,b,(s||0)*x,l||1):h.drawElements(e,r||m.indexBuffer.data.length,b,(s||0)*x):console.warn("unsupported index buffer type: uint32")}else m.instanced?h.drawArraysInstanced(e,s,r||m.getSize(),l||1):h.drawArrays(e,s,r||m.getSize());return this},n.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},n}(qo),ui=function(){function o(n){n===void 0&&(n=null),this.type=Kt.NONE,this.autoDetect=!0,this.maskObject=n||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return o.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Kt.NONE,this.autoDetect=!0),this._target=null},o.prototype.copyCountersOrReset=function(n){n?(this._stencilCounter=n._stencilCounter,this._scissorCounter=n._scissorCounter,this._scissorRect=n._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},o}();function hu(o,n,e){var r=o.createShader(n);return o.shaderSource(r,e),o.compileShader(r),r}function Rr(o,n,e,r){var s=hu(o,o.VERTEX_SHADER,n),l=hu(o,o.FRAGMENT_SHADER,e),h=o.createProgram();if(o.attachShader(h,s),o.attachShader(h,l),r)for(var m in r)o.bindAttribLocation(h,r[m],m);return o.linkProgram(h),o.getProgramParameter(h,o.LINK_STATUS)||(o.getShaderParameter(s,o.COMPILE_STATUS)||(console.warn(n),console.error(o.getShaderInfoLog(s))),o.getShaderParameter(l,o.COMPILE_STATUS)||(console.warn(e),console.error(o.getShaderInfoLog(l))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",o.getProgramParameter(h,o.VALIDATE_STATUS)),console.error("gl.getError()",o.getError()),o.getProgramInfoLog(h)!==""&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",o.getProgramInfoLog(h)),o.deleteProgram(h),h=null),o.deleteShader(s),o.deleteShader(l),h}function To(o){for(var n=new Array(o),e=0;e<n.length;e++)n[e]=!1;return n}function cu(o,n){switch(o){case"float":return 0;case"vec2":return new Float32Array(2*n);case"vec3":return new Float32Array(3*n);case"vec4":return new Float32Array(4*n);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*n);case"ivec3":return new Int32Array(3*n);case"ivec4":return new Int32Array(4*n);case"uvec2":return new Uint32Array(2*n);case"uvec3":return new Uint32Array(3*n);case"uvec4":return new Uint32Array(4*n);case"bool":return!1;case"bvec2":return To(2*n);case"bvec3":return To(3*n);case"bvec4":return To(4*n);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Dl,eo={},ot=eo;function xc(){if(ot===eo||ot&&ot.isContextLost()){var o=document.createElement("canvas"),n=void 0;ie.PREFER_ENV>=Lr.WEBGL2&&(n=o.getContext("webgl2",{})),n||((n=o.getContext("webgl",{})||o.getContext("experimental-webgl",{}))?n.getExtension("WEBGL_draw_buffers"):n=null),ot=n}return ot}function bd(o,n,e){if(o.substring(0,9)!=="precision"){var r=n;return n===pe.HIGH&&e!==pe.HIGH&&(r=pe.MEDIUM),"precision "+r+` float;
`+o}return e!==pe.HIGH&&o.substring(0,15)==="precision highp"?o.replace("precision highp","precision mediump"):o}var So={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function us(o){return So[o]}var La=null,q={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Es(o,n){if(!La){var e=Object.keys(q);La={};for(var r=0;r<e.length;++r){var s=e[r];La[o[s]]=q[s]}}return La[n]}var Ms=[{test:function(o){return o.type==="float"&&o.size===1},code:function(o){return`
            if(uv["`+o+'"] !== ud["'+o+`"].value)
            {
                ud["`+o+'"].value = uv["'+o+`"]
                gl.uniform1f(ud["`+o+'"].location, uv["'+o+`"])
            }
            `}},{test:function(o){return(o.type==="sampler2D"||o.type==="samplerCube"||o.type==="sampler2DArray")&&o.size===1&&!o.isArray},code:function(o){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+o+`"], t);

            if(ud["`+o+`"].value !== t)
            {
                ud["`+o+`"].value = t;
                gl.uniform1i(ud["`+o+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(o,n){return o.type==="mat3"&&o.size===1&&n.a!==void 0},code:function(o){return`
            gl.uniformMatrix3fv(ud["`+o+'"].location, false, uv["'+o+`"].toArray(true));
            `}},{test:function(o,n){return o.type==="vec2"&&o.size===1&&n.x!==void 0},code:function(o){return`
                cv = ud["`+o+`"].value;
                v = uv["`+o+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+o+`"].location, v.x, v.y);
                }`}},{test:function(o){return o.type==="vec2"&&o.size===1},code:function(o){return`
                cv = ud["`+o+`"].value;
                v = uv["`+o+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+o+`"].location, v[0], v[1]);
                }
            `}},{test:function(o,n){return o.type==="vec4"&&o.size===1&&n.width!==void 0},code:function(o){return`
                cv = ud["`+o+`"].value;
                v = uv["`+o+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+o+`"].location, v.x, v.y, v.width, v.height)
                }`}},{test:function(o){return o.type==="vec4"&&o.size===1},code:function(o){return`
                cv = ud["`+o+`"].value;
                v = uv["`+o+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+o+`"].location, v[0], v[1], v[2], v[3])
                }`}}],lo={float:`
    if(cv !== v)
    {
        cv.v = v;
        gl.uniform1f(location, v)
    }`,vec2:`
    if(cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",uint:"gl.uniform1ui(location, v)",uvec2:"gl.uniform2ui(location, v[0], v[1])",uvec3:"gl.uniform3ui(location, v[0], v[1], v[2])",uvec4:"gl.uniform4ui(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},ur={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},no,Fo=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function ls(o){for(var n="",e=0;e<o;++e)e>0&&(n+=`
else `),e<o-1&&(n+="if(test == "+e+".0){}");return n}function Gs(o,n){if(o===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var e=n.createShader(n.FRAGMENT_SHADER);;){var r=Fo.replace(/%forloop%/gi,ls(o));if(n.shaderSource(e,r),n.compileShader(e),n.getShaderParameter(e,n.COMPILE_STATUS))break;o=o/2|0}return o}var Zo=0,Hs={},du=function(){function o(n,e,r){r===void 0&&(r="pixi-shader"),this.id=Zo++,this.vertexSrc=n||o.defaultVertexSrc,this.fragmentSrc=e||o.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),Hs[r]?(Hs[r]++,r+="-"+Hs[r]):Hs[r]=1,this.vertexSrc="#define SHADER_NAME "+r+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+r+`
`+this.fragmentSrc,this.vertexSrc=bd(this.vertexSrc,ie.PRECISION_VERTEX,pe.HIGH),this.fragmentSrc=bd(this.fragmentSrc,ie.PRECISION_FRAGMENT,function(){if(!Dl){Dl=pe.MEDIUM;var s=xc();if(s&&s.getShaderPrecisionFormat){var l=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT);Dl=l.precision?pe.HIGH:pe.MEDIUM}}return Dl}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return o.prototype.extractData=function(n,e){var r=xc();if(r){var s=Rr(r,n,e);this.attributeData=this.getAttributeData(s,r),this.uniformData=this.getUniformData(s,r),r.deleteProgram(s)}else this.uniformData={},this.attributeData={}},o.prototype.getAttributeData=function(n,e){for(var r={},s=[],l=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES),h=0;h<l;h++){var m=e.getActiveAttrib(n,h),x=Es(e,m.type),b={type:x,name:m.name,size:us(x),location:0};r[m.name]=b,s.push(b)}for(s.sort(function(w,R){return w.name>R.name?1:-1}),h=0;h<s.length;h++)s[h].location=h;return r},o.prototype.getUniformData=function(n,e){for(var r={},s=e.getProgramParameter(n,e.ACTIVE_UNIFORMS),l=0;l<s;l++){var h=e.getActiveUniform(n,l),m=h.name.replace(/\[.*?\]$/,""),x=h.name.match(/\[.*?\]$/),b=Es(e,h.type);r[m]={type:b,size:h.size,isArray:x,value:cu(b,h.size)}}return r},Object.defineProperty(o,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(o,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`},enumerable:!1,configurable:!0}),o.from=function(n,e,r){var s=n+e,l=wl[s];return l||(wl[s]=l=new o(n,e,r)),l},o}(),Oa=function(){function o(n,e){for(var r in this.program=n,this.uniformGroup=e?e instanceof uo?e:new uo(e):new uo({}),n.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))}return o.prototype.checkUniformExists=function(n,e){if(e.uniforms[n])return!0;for(var r in e.uniforms){var s=e.uniforms[r];if(s.group&&this.checkUniformExists(n,s))return!0}return!1},o.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(o.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),o.from=function(n,e,r){return new o(du.from(n,e),r)},o}(),Da=function(){function o(){this.data=0,this.blendMode=Ln.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(o.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(n){!!(1&this.data)!==n&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(n){!!(2&this.data)!==n&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(n){!!(4&this.data)!==n&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(n){!!(8&this.data)!==n&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(n){!!(32&this.data)!==n&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(n){!!(16&this.data)!==n&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"blendMode",{get:function(){return this._blendMode},set:function(n){this.blend=n!==Ln.NONE,this._blendMode=n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(n){this.offsets=!!n,this._polygonOffset=n},enumerable:!1,configurable:!0}),o.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},o.for2d=function(){var n=new o;return n.depthTest=!1,n.blend=!0,n},o}(),ro=function(o){function n(e,r,s){var l=this,h=du.from(e||n.defaultVertexSrc,r||n.defaultFragmentSrc);return(l=o.call(this,h,s)||this).padding=0,l.resolution=ie.FILTER_RESOLUTION,l.enabled=!0,l.autoFit=!0,l.legacy=!!l.program.attributeData.aTextureCoord,l.state=new Da,l}return fe(n,o),n.prototype.apply=function(e,r,s,l,h){e.applyFilter(this,r,s,l)},Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`},enumerable:!1,configurable:!0}),n}(Oa),pu=new yi,Jo=function(){function o(n,e){this._texture=n,this.mapCoord=new yi,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=e===void 0?.5:e,this.isSimple=!1}return Object.defineProperty(o.prototype,"texture",{get:function(){return this._texture},set:function(n){this._texture=n,this._textureID=-1},enumerable:!1,configurable:!0}),o.prototype.multiplyUvs=function(n,e){e===void 0&&(e=n);for(var r=this.mapCoord,s=0;s<n.length;s+=2){var l=n[s],h=n[s+1];e[s]=l*r.a+h*r.c+r.tx,e[s+1]=l*r.b+h*r.d+r.ty}return e},o.prototype.update=function(n){var e=this._texture;if(!e||!e.valid||!n&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var s=e.orig,l=e.trim;l&&(pu.set(s.width/l.width,0,0,s.height/l.height,-l.x/l.width,-l.y/l.height),this.mapCoord.append(pu));var h=e.baseTexture,m=this.uClampFrame,x=this.clampMargin/h.resolution,b=this.clampOffset;return m[0]=(e._frame.x+x+b)/h.width,m[1]=(e._frame.y+x+b)/h.height,m[2]=(e._frame.x+e._frame.width-x+b)/h.width,m[3]=(e._frame.y+e._frame.height-x+b)/h.height,this.uClampOffset[0]=b/h.realWidth,this.uClampOffset[1]=b/h.realHeight,this.isSimple=e._frame.width===h.width&&e._frame.height===h.height&&e.rotate===0,!0},o}(),aa=function(o){function n(e){var r=this,s=new yi;return r=o.call(this,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`)||this,e.renderable=!1,r.maskSprite=e,r.maskMatrix=s,r}return fe(n,o),n.prototype.apply=function(e,r,s,l){var h=this.maskSprite,m=h._texture;m.valid&&(m.uvMatrix||(m.uvMatrix=new Jo(m,0)),m.uvMatrix.update(),this.uniforms.npmAlpha=m.baseTexture.alphaMode?0:1,this.uniforms.mask=m,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,h).prepend(m.uvMatrix.mapCoord),this.uniforms.alpha=h.worldAlpha,this.uniforms.maskClamp=m.uvMatrix.uClampFrame,e.applyFilter(this,r,s,l))},n}(ro),Nl=function(o){function n(e){var r=o.call(this,e)||this;return r.enableScissor=!0,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return fe(n,o),n.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},n.prototype.push=function(e,r){var s=r;if(!s.isMaskData){var l=this.maskDataPool.pop()||new ui;l.pooled=!0,l.maskObject=r,s=l}switch(s.autoDetect&&this.detect(s),s.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),s._target=e,s.type){case Kt.SCISSOR:this.maskStack.push(s),this.renderer.scissor.push(s);break;case Kt.STENCIL:this.maskStack.push(s),this.renderer.stencil.push(s);break;case Kt.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s),this.maskStack.push(s)}},n.prototype.pop=function(e){var r=this.maskStack.pop();if(r&&r._target===e){switch(r.type){case Kt.SCISSOR:this.renderer.scissor.pop();break;case Kt.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case Kt.SPRITE:this.popSpriteMask()}r.reset(),r.pooled&&this.maskDataPool.push(r)}},n.prototype.detect=function(e){var r=e.maskObject;if(r.isSprite)e.type=Kt.SPRITE;else if(e.type=Kt.STENCIL,this.enableScissor&&r.isFastRect&&r.isFastRect()){var s=r.worldTransform,l=Math.atan2(s.b,s.a),h=Math.atan2(s.d,s.c);l=Math.round(l*(180/Math.PI)*100),h=((h=Math.round(h*(180/Math.PI)*100)-l)%18e3+18e3)%18e3,(l=(l%9e3+9e3)%9e3)==0&&h===9e3&&(e.type=Kt.SCISSOR)}},n.prototype.pushSpriteMask=function(e){var r=e.maskObject,s=e._target,l=this.alphaMaskPool[this.alphaMaskIndex];l||(l=this.alphaMaskPool[this.alphaMaskIndex]=[new aa(r)]),l[0].resolution=this.renderer.resolution,l[0].maskSprite=r;var h=s.filterArea;s.filterArea=r.getBounds(!0),this.renderer.filter.push(s,l),s.filterArea=h,this.alphaMaskIndex++},n.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},n}(qo),hs=function(o){function n(e){var r=o.call(this,e)||this;return r.maskStack=[],r.glConst=0,r}return fe(n,o),n.prototype.getStackLength=function(){return this.maskStack.length},n.prototype.setMaskStack=function(e){var r=this.renderer.gl,s=this.getStackLength();this.maskStack=e;var l=this.getStackLength();l!==s&&(l===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))},n.prototype._useCurrent=function(){},n.prototype.destroy=function(){o.prototype.destroy.call(this),this.maskStack=null},n}(qo),As=function(o){function n(e){var r=o.call(this,e)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return fe(n,o),n.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},n.prototype.push=function(e){var r=e.maskObject;r.renderable=!0;var s=e._scissorRect,l=r.getBounds(!0),h=this.renderer.gl;r.renderable=!1,s?l.fit(s):h.enable(h.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=l,this._useCurrent()},n.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},n.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,r=this.renderer.renderTexture.current,s=this.renderer.projection,l=s.transform,h=s.sourceFrame,m=s.destinationFrame,x=r?r.resolution:this.renderer.resolution,b=m.width/h.width,w=m.height/h.height,R=((e.x-h.x)*b+m.x)*x,U=((e.y-h.y)*w+m.y)*x,B=e.width*b*x,j=e.height*w*x;l&&(R+=l.tx*x,U+=l.ty*x),r||(U=this.renderer.height-j-U),this.renderer.gl.scissor(R,U,B,j)},n}(hs),zs=function(o){function n(e){var r=o.call(this,e)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return fe(n,o),n.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},n.prototype.push=function(e){var r=e.maskObject,s=this.renderer.gl,l=e._stencilCounter;l===0&&(this.renderer.framebuffer.forceStencil(),s.enable(s.STENCIL_TEST)),e._stencilCounter++,s.colorMask(!1,!1,!1,!1),s.stencilFunc(s.EQUAL,l,this._getBitwiseMask()),s.stencilOp(s.KEEP,s.KEEP,s.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),this.renderer.framebuffer.blit(),r.renderable=!1,this._useCurrent()},n.prototype.pop=function(e){var r=this.renderer.gl;this.getStackLength()===0?(r.disable(r.STENCIL_TEST),r.clear(r.STENCIL_BUFFER_BIT),r.clearStencil(0)):(r.colorMask(!1,!1,!1,!1),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},n.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},n.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},n}(hs),ho=function(o){function n(e){var r=o.call(this,e)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new yi,r.transform=null,r}return fe(n,o),n.prototype.update=function(e,r,s,l){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,l),this.transform&&this.projectionMatrix.append(this.transform);var h=this.renderer;h.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,h.globalUniforms.update(),h.shader.shader&&h.shader.syncUniformGroup(h.shader.shader.uniforms.globals)},n.prototype.calculateProjection=function(e,r,s,l){var h=this.projectionMatrix,m=l?-1:1;h.identity(),h.a=1/r.width*2,h.d=m*(1/r.height*2),h.tx=-1-r.x*h.a,h.ty=-m-r.y*h.d},n.prototype.setTransform=function(e){},n}(qo),ua=new dr,cs=new dr,wn=function(o){function n(e){var r=o.call(this,e)||this;return r.clearColor=e._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new dr,r.destinationFrame=new dr,r.viewportFrame=new dr,r}return fe(n,o),n.prototype.bind=function(e,r,s){e===void 0&&(e=null);var l,h,m,x=this.renderer;this.current=e,e?(m=(l=e.baseTexture).resolution,r||(ua.width=e.frame.width,ua.height=e.frame.height,r=ua),s||(cs.x=e.frame.x,cs.y=e.frame.y,cs.width=r.width,cs.height=r.height,s=cs),h=l.framebuffer):(m=x.resolution,r||(ua.width=x.screen.width,ua.height=x.screen.height,r=ua),s||((s=ua).width=r.width,s.height=r.height));var b=this.viewportFrame;b.x=s.x*m,b.y=s.y*m,b.width=s.width*m,b.height=s.height*m,e||(b.y=x.view.height-(b.y+b.height)),this.renderer.framebuffer.bind(h,b),this.renderer.projection.update(s,r,m,!h),e?this.renderer.mask.setMaskStack(l.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(s)},n.prototype.clear=function(e,r){e=this.current?e||this.current.baseTexture.clearColor:e||this.clearColor;var s=this.destinationFrame,l=this.current?this.current.baseTexture:this.renderer.screen,h=s.width!==l.width||s.height!==l.height;if(h){var m=this.viewportFrame,x=m.x,b=m.y,w=m.width,R=m.height;this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(x,b,w,R)}this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],r),h&&this.renderer.scissor.pop()},n.prototype.resize=function(){this.bind(null)},n.prototype.reset=function(){this.bind(null)},n}(qo),ds=function(){},ps=function(){function o(n,e){this.program=n,this.uniformData=e,this.uniformGroups={}}return o.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},o}(),lf=0,Mh={textureCount:0},js=function(o){function n(e){var r=o.call(this,e)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=lf++,r}return fe(n,o),n.prototype.systemCheck=function(){if(!function(){if(typeof no=="boolean")return no;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");no=e({a:"b"},"a","b")===!0}catch{no=!1}return no}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},n.prototype.contextChange=function(e){this.gl=e,this.reset()},n.prototype.bind=function(e,r){e.uniforms.globals=this.renderer.globalUniforms;var s=e.program,l=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(e);return this.shader=e,this.program!==s&&(this.program=s,this.gl.useProgram(l.program)),r||(Mh.textureCount=0,this.syncUniformGroup(e.uniformGroup,Mh)),l},n.prototype.setUniforms=function(e){var r=this.shader.program,s=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(s.uniformData,e,this.renderer)},n.prototype.syncUniformGroup=function(e,r){var s=this.getglProgram();e.static&&e.dirtyId===s.uniformGroups[e.id]||(s.uniformGroups[e.id]=e.dirtyId,this.syncUniforms(e,s,r))},n.prototype.syncUniforms=function(e,r,s){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,s)},n.prototype.createSyncGroups=function(e){var r=this.getSignature(e,this.shader.program.uniformData);return this.cache[r]||(this.cache[r]=function(s,l){var h=[`
        var v = null;
        var cv = null
        var t = 0;
        var gl = renderer.gl
    `];for(var m in s.uniforms){var x=l[m];if(x){for(var b=s.uniforms[m],w=!1,R=0;R<Ms.length;R++)if(Ms[R].test(x,b)){h.push(Ms[R].code(m,b)),w=!0;break}if(!w){var U=(x.size===1?lo:ur)[x.type].replace("location",'ud["'+m+'"].location');h.push(`
            cv = ud["`+m+`"].value;
            v = uv["`+m+`"];
            `+U+";")}}else s.uniforms[m].group&&h.push(`
                    renderer.shader.syncUniformGroup(uv["`+m+`"], syncData);
                `)}return new Function("ud","uv","renderer","syncData",h.join(`
`))}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]},n.prototype.getSignature=function(e,r){var s=e.uniforms,l=[];for(var h in s)l.push(h),r[h]&&l.push(r[h].type);return l.join("-")},n.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},n.prototype.generateShader=function(e){var r=this.gl,s=e.program,l={};for(var h in s.attributeData)l[h]=s.attributeData[h].location;var m=Rr(r,s.vertexSrc,s.fragmentSrc,l),x={};for(var h in s.uniformData){var b=s.uniformData[h];x[h]={location:r.getUniformLocation(m,h),value:cu(b.type,b.size)}}var w=new ps(m,x);return s.glPrograms[this.renderer.CONTEXT_UID]=w,w},n.prototype.reset=function(){this.program=null,this.shader=null},n.prototype.destroy=function(){this.destroyed=!0},n}(qo),Ei=function(o){function n(e){var r=o.call(this,e)||this;return r.gl=null,r.stateId=0,r.polygonOffset=0,r.blendMode=Ln.NONE,r._blendEq=!1,r.map=[],r.map[0]=r.setBlend,r.map[1]=r.setOffset,r.map[2]=r.setCullFace,r.map[3]=r.setDepthTest,r.map[4]=r.setFrontFace,r.map[5]=r.setDepthMask,r.checks=[],r.defaultState=new Da,r.defaultState.blend=!0,r}return fe(n,o),n.prototype.contextChange=function(e){this.gl=e,this.blendModes=function(r,s){return s===void 0&&(s=[]),s[Ln.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.ADD]=[r.ONE,r.ONE],s[Ln.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.NONE]=[0,0],s[Ln.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],s[Ln.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],s[Ln.SRC_IN]=[r.DST_ALPHA,r.ZERO],s[Ln.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],s[Ln.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],s[Ln.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],s[Ln.DST_IN]=[r.ZERO,r.SRC_ALPHA],s[Ln.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],s[Ln.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],s[Ln.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],s[Ln.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],s}(e),this.set(this.defaultState),this.reset()},n.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var r=this.stateId^e.data,s=0;r;)1&r&&this.map[s].call(this,!!(e.data&1<<s)),r>>=1,s++;this.stateId=e.data}for(s=0;s<this.checks.length;s++)this.checks[s](this,e)},n.prototype.forceState=function(e){e=e||this.defaultState;for(var r=0;r<this.map.length;r++)this.map[r].call(this,!!(e.data&1<<r));for(r=0;r<this.checks.length;r++)this.checks[r](this,e);this.stateId=e.data},n.prototype.setBlend=function(e){this.updateCheck(n.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},n.prototype.setOffset=function(e){this.updateCheck(n.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},n.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},n.prototype.setDepthMask=function(e){this.gl.depthMask(e)},n.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},n.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},n.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var r=this.blendModes[e],s=this.gl;r.length===2?s.blendFunc(r[0],r[1]):s.blendFuncSeparate(r[0],r[1],r[2],r[3]),r.length===6?(this._blendEq=!0,s.blendEquationSeparate(r[4],r[5])):this._blendEq&&(this._blendEq=!1,s.blendEquationSeparate(s.FUNC_ADD,s.FUNC_ADD))}},n.prototype.setPolygonOffset=function(e,r){this.gl.polygonOffset(e,r)},n.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},n.prototype.updateCheck=function(e,r){var s=this.checks.indexOf(e);r&&s===-1?this.checks.push(e):r||s===-1||this.checks.splice(s,1)},n.checkBlendMode=function(e,r){e.setBlendMode(r.blendMode)},n.checkPolygonOffset=function(e,r){e.setPolygonOffset(1,r.polygonOffset)},n}(qo),co=function(o){function n(e){var r=o.call(this,e)||this;return r.count=0,r.checkCount=0,r.maxIdle=ie.GC_MAX_IDLE,r.checkCountMax=ie.GC_MAX_CHECK_COUNT,r.mode=ie.GC_MODE,r}return fe(n,o),n.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==re.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},n.prototype.run=function(){for(var e=this.renderer.texture,r=e.managedTextures,s=!1,l=0;l<r.length;l++){var h=r[l];!h.framebuffer&&this.count-h.touched>this.maxIdle&&(e.destroyTexture(h,!0),r[l]=null,s=!0)}if(s){var m=0;for(l=0;l<r.length;l++)r[l]!==null&&(r[m++]=r[l]);r.length=m}},n.prototype.unload=function(e){var r=this.renderer.texture,s=e._texture;s&&!s.framebuffer&&r.destroyTexture(s);for(var l=e.children.length-1;l>=0;l--)this.unload(e.children[l])},n}(qo),Fl=function(o){this.texture=o,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121,this.samplerType=0},fs=function(o){function n(e){var r=o.call(this,e)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new fr,r.hasIntegerTextures=!1,r}return fe(n,o),n.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(var s=0;s<r;s++)this.boundTextures[s]=null;this.emptyTextures={};var l=new Fl(e.createTexture());for(e.bindTexture(e.TEXTURE_2D,l.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=l,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Fl(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture),s=0;s<6;s++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);for(e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),s=0;s<this.boundTextures.length;s++)this.bind(null,s)},n.prototype.bind=function(e,r){r===void 0&&(r=0);var s=this.gl;if(e){if((e=e.castToBaseTexture()).parentTextureArray)return;if(e.valid){e.touched=this.renderer.textureGC.count;var l=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,s.activeTexture(s.TEXTURE0+r)),s.bindTexture(e.target,l.texture)),l.dirtyId!==e.dirtyId&&(this.currentLocation!==r&&(this.currentLocation=r,s.activeTexture(s.TEXTURE0+r)),this.updateTexture(e)),this.boundTextures[r]=e}}else this.currentLocation!==r&&(this.currentLocation=r,s.activeTexture(s.TEXTURE0+r)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[r]=null},n.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},n.prototype.unbind=function(e){var r=this.gl,s=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var l=0;l<s.length;l++)s[l]===this.unknownTexture&&this.bind(null,l)}for(l=0;l<s.length;l++)s[l]===e&&(this.currentLocation!==l&&(r.activeTexture(r.TEXTURE0+l),this.currentLocation=l),r.bindTexture(e.target,this.emptyTextures[e.target].texture),s[l]=null)},n.prototype.ensureSamplerType=function(e){var r=this.boundTextures,s=this.hasIntegerTextures,l=this.CONTEXT_UID;if(s)for(var h=e-1;h>=0;--h){var m=r[h];m&&m._glTextures[l].samplerType!==ft.FLOAT&&this.renderer.texture.unbind(m)}},n.prototype.initTexture=function(e){var r=new Fl(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r},n.prototype.initTextureType=function(e,r){if(r.internalFormat=e.format,r.type=e.type,this.webGLVersion===2){var s=this.renderer.gl;e.type===s.FLOAT&&e.format===s.RGBA&&(r.internalFormat=s.RGBA32F),e.type===Q.HALF_FLOAT&&(r.type=s.HALF_FLOAT),r.type===s.HALF_FLOAT&&e.format===s.RGBA&&(r.internalFormat=s.RGBA16F)}},n.prototype.updateTexture=function(e){var r=e._glTextures[this.CONTEXT_UID];if(r){var s=this.renderer;if(this.initTextureType(e,r),e.resource&&e.resource.upload(s,e,r))r.samplerType!==ft.FLOAT&&(this.hasIntegerTextures=!0);else{var l=e.realWidth,h=e.realHeight,m=s.gl;(r.width!==l||r.height!==h||r.dirtyId<0)&&(r.width=l,r.height=h,m.texImage2D(e.target,0,r.internalFormat,l,h,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}},n.prototype.destroyTexture=function(e,r){var s=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),s.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){var l=this.managedTextures.indexOf(e);l!==-1&&Zn(this.managedTextures,l,1)}},n.prototype.updateTextureStyle=function(e){var r=e._glTextures[this.CONTEXT_UID];r&&(e.mipmap!==Ct.POW2&&this.webGLVersion===2||e.isPowerOfTwo?r.mipmap=e.mipmap>=1:r.mipmap=!1,this.webGLVersion===2||e.isPowerOfTwo?r.wrapMode=e.wrapMode:r.wrapMode=Lt.CLAMP,e.resource&&e.resource.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)},n.prototype.setStyle=function(e,r){var s=this.gl;if(r.mipmap&&e.mipmap!==Ct.ON_MANUAL&&s.generateMipmap(e.target),s.texParameteri(e.target,s.TEXTURE_WRAP_S,r.wrapMode),s.texParameteri(e.target,s.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,e.scaleMode===dt.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);var l=this.renderer.context.extensions.anisotropicFiltering;if(l&&e.anisotropicLevel>0&&e.scaleMode===dt.LINEAR){var h=Math.min(e.anisotropicLevel,s.getParameter(l.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(e.target,l.TEXTURE_MAX_ANISOTROPY_EXT,h)}}else s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,e.scaleMode===dt.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(e.target,s.TEXTURE_MAG_FILTER,e.scaleMode===dt.LINEAR?s.LINEAR:s.NEAREST)},n}(qo),la={__proto__:null,FilterSystem:Sh,BatchSystem:xi,ContextSystem:yc,FramebufferSystem:Ii,GeometrySystem:Eh,MaskSystem:Nl,ScissorSystem:As,StencilSystem:zs,ProjectionSystem:ho,RenderTextureSystem:wn,ShaderSystem:js,StateSystem:Ei,TextureGCSystem:co,TextureSystem:fs},fu=new yi,mu=function(o){function n(e,r){e===void 0&&(e=mi.UNKNOWN);var s=o.call(this)||this;return r=Object.assign({},ie.RENDER_OPTIONS,r),s.options=r,s.type=e,s.screen=new dr(0,0,r.width,r.height),s.view=r.view||document.createElement("canvas"),s.resolution=r.resolution||ie.RESOLUTION,s.useContextAlpha=r.useContextAlpha,s.autoDensity=!!r.autoDensity,s.preserveDrawingBuffer=r.preserveDrawingBuffer,s.clearBeforeRender=r.clearBeforeRender,s._backgroundColor=0,s._backgroundColorRgba=[0,0,0,1],s._backgroundColorString="#000000",s.backgroundColor=r.backgroundColor||s._backgroundColor,s.backgroundAlpha=r.backgroundAlpha,r.transparent!==void 0&&(is("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),s.useContextAlpha=r.transparent,s.backgroundAlpha=r.transparent?0:1),s._lastObjectRendered=null,s.plugins={},s}return fe(n,o),n.prototype.initPlugins=function(e){for(var r in e)this.plugins[r]=new e[r](this)},Object.defineProperty(n.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),n.prototype.resize=function(e,r){this.screen.width=e,this.screen.height=r,this.view.width=e*this.resolution,this.view.height=r*this.resolution,this.autoDensity&&(this.view.style.width=e+"px",this.view.style.height=r+"px"),this.emit("resize",e,r)},n.prototype.generateTexture=function(e,r,s,l){(l=l||e.getLocalBounds(null,!0)).width===0&&(l.width=1),l.height===0&&(l.height=1);var h=Ri.create({width:0|l.width,height:0|l.height,scaleMode:r,resolution:s});return fu.tx=-l.x,fu.ty=-l.y,this.render(e,{renderTexture:h,clear:!1,transform:fu,skipUpdateTransform:!!e.parent}),h},n.prototype.destroy=function(e){for(var r in this.plugins)this.plugins[r].destroy(),this.plugins[r]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=mi.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=jt(e),Yo(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(e){this._backgroundColorRgba[3]=e},enumerable:!1,configurable:!0}),n}(ar.a),Vs=function(o){function n(e){var r=o.call(this,mi.WEBGL,e)||this;return e=r.options,r.gl=null,r.CONTEXT_UID=0,r.runners={destroy:new di("destroy"),contextChange:new di("contextChange"),reset:new di("reset"),update:new di("update"),postrender:new di("postrender"),prerender:new di("prerender"),resize:new di("resize")},r.globalUniforms=new uo({projectionMatrix:new yi},!0),r.addSystem(Nl,"mask").addSystem(yc,"context").addSystem(Ei,"state").addSystem(js,"shader").addSystem(fs,"texture").addSystem(Eh,"geometry").addSystem(Ii,"framebuffer").addSystem(As,"scissor").addSystem(zs,"stencil").addSystem(ho,"projection").addSystem(co,"textureGC").addSystem(Sh,"filter").addSystem(wn,"renderTexture").addSystem(xi,"batch"),r.initPlugins(n.__plugins),e.context?r.context.initFromContext(e.context):r.context.initFromOptions({alpha:!!r.useContextAlpha,antialias:e.antialias,premultipliedAlpha:r.useContextAlpha&&r.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:r.options.powerPreference}),r.renderingToScreen=!0,ea(r.context.webGLVersion===2?"WebGL 2":"WebGL 1"),r.resize(r.options.width,r.options.height),r}return fe(n,o),n.create=function(e){if(Aa())return new n(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},n.prototype.addSystem=function(e,r){r||(r=e.name);var s=new e(this);if(this[r])throw new Error('Whoops! The name "'+r+'" is already in use');for(var l in this[r]=s,this.runners)this.runners[l].add(s);return this},n.prototype.render=function(e,r){var s,l,h,m;if(r&&(r instanceof Ri?(is("6.0.0","Renderer#render arguments changed, use options instead."),s=r,l=arguments[2],h=arguments[3],m=arguments[4]):(s=r.renderTexture,l=r.clear,h=r.transform,m=r.skipUpdateTransform)),this.renderingToScreen=!s,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=h,!this.context.isLost){if(s||(this._lastObjectRendered=e),!m){var x=e.enableTempParent();e.updateTransform(),e.disableTempParent(x)}this.renderTexture.bind(s),this.batch.currentRenderer.start(),(l!==void 0?l:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),s&&s.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},n.prototype.resize=function(e,r){o.prototype.resize.call(this,e,r),this.runners.resize.emit(e,r)},n.prototype.reset=function(){return this.runners.reset.emit(),this},n.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},n.prototype.destroy=function(e){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();o.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(n.prototype,"extract",{get:function(){return is("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),n.registerPlugin=function(e,r){n.__plugins=n.__plugins||{},n.__plugins[e]=r},n}(mu);function Li(o){return Vs.create(o)}var Ps=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Bl=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,gu=function(){this.texArray=null,this.blend=0,this.type=so.TRIANGLES,this.start=0,this.size=0,this.data=null},Ul=function(){function o(){this.elements=[],this.ids=[],this.count=0}return o.prototype.clear=function(){for(var n=0;n<this.count;n++)this.elements[n]=null;this.count=0},o}(),vu=function(){function o(n){typeof n=="number"?this.rawBinaryData=new ArrayBuffer(n):n instanceof Uint8Array?this.rawBinaryData=n.buffer:this.rawBinaryData=n,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(o.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),o.prototype.view=function(n){return this[n+"View"]},o.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},o.sizeOf=function(n){switch(n){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(n+" isn't a valid view type")}},o}(),bc=function(o){function n(e){var r=o.call(this,e)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=Da.for2d(),r.size=4*ie.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),e.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return fe(n,o),n.prototype.contextChange=function(){var e=this.renderer.gl;ie.PREFER_ENV===Lr.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),ie.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=Gs(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()},n.prototype.initFlushBuffers=function(){for(var e=n._drawCallPool,r=n._textureArrayPool,s=this.size/4,l=Math.floor(s/this.MAX_TEXTURES)+1;e.length<s;)e.push(new gu);for(;r.length<l;)r.push(new Ul);for(var h=0;h<this.MAX_TEXTURES;h++)this._tempBoundTextures[h]=null},n.prototype.onPrerender=function(){this._flushId=0},n.prototype.render=function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},n.prototype.buildTexturesAndDrawCalls=function(){var e=this._bufferedTextures,r=this.MAX_TEXTURES,s=n._textureArrayPool,l=this.renderer.batch,h=this._tempBoundTextures,m=this.renderer.textureGC.count,x=++fr._globalBatch,b=0,w=s[0],R=0;l.copyBoundTextures(h,r);for(var U=0;U<this._bufferSize;++U){var B=e[U];e[U]=null,B._batchEnabled!==x&&(w.count>=r&&(l.boundArray(w,h,x,r),this.buildDrawCalls(w,R,U),R=U,w=s[++b],++x),B._batchEnabled=x,B.touched=m,w.elements[w.count++]=B)}for(w.count>0&&(l.boundArray(w,h,x,r),this.buildDrawCalls(w,R,this._bufferSize),++b,++x),U=0;U<h.length;U++)h[U]=null;fr._globalBatch=x},n.prototype.buildDrawCalls=function(e,r,s){var l=this._bufferedElements,h=this._attributeBuffer,m=this._indexBuffer,x=this.vertexSize,b=n._drawCallPool,w=this._dcIndex,R=this._aIndex,U=this._iIndex,B=b[w];B.start=this._iIndex,B.texArray=e;for(var j=r;j<s;++j){var K=l[j],ut=K._texture.baseTexture,gt=Fe[ut.alphaMode?1:0][K.blendMode];l[j]=null,r<j&&B.blend!==gt&&(B.size=U-B.start,r=j,(B=b[++w]).texArray=e,B.start=U),this.packInterleavedGeometry(K,h,m,R,U),R+=K.vertexData.length/2*x,U+=K.indices.length,B.blend=gt}r<s&&(B.size=U-B.start,++w),this._dcIndex=w,this._aIndex=R,this._iIndex=U},n.prototype.bindAndClearTexArray=function(e){for(var r=this.renderer.texture,s=0;s<e.count;s++)r.bind(e.elements[s],e.ids[s]),e.elements[s]=null;e.count=0},n.prototype.updateGeometry=function(){var e=this._packedGeometries,r=this._attributeBuffer,s=this._indexBuffer;ie.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(s),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(s),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},n.prototype.drawBatches=function(){for(var e=this._dcIndex,r=this.renderer,s=r.gl,l=r.state,h=n._drawCallPool,m=null,x=0;x<e;x++){var b=h[x],w=b.texArray,R=b.type,U=b.size,B=b.start,j=b.blend;m!==w&&(m=w,this.bindAndClearTexArray(w)),this.state.blendMode=j,l.set(this.state),s.drawElements(R,U,s.UNSIGNED_SHORT,2*B)}},n.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},n.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),ie.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},n.prototype.stop=function(){this.flush()},n.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),o.prototype.destroy.call(this)},n.prototype.getAttributeBuffer=function(e){var r=ln(Math.ceil(e/8)),s=vi(r),l=8*r;this._aBuffers.length<=s&&(this._iBuffers.length=s+1);var h=this._aBuffers[l];return h||(this._aBuffers[l]=h=new vu(l*this.vertexSize*4)),h},n.prototype.getIndexBuffer=function(e){var r=ln(Math.ceil(e/12)),s=vi(r),l=12*r;this._iBuffers.length<=s&&(this._iBuffers.length=s+1);var h=this._iBuffers[s];return h||(this._iBuffers[s]=h=new Uint16Array(l)),h},n.prototype.packInterleavedGeometry=function(e,r,s,l,h){for(var m=r.uint32View,x=r.float32View,b=l/this.vertexSize,w=e.uvs,R=e.indices,U=e.vertexData,B=e._texture.baseTexture._batchLocation,j=Math.min(e.worldAlpha,1),K=j<1&&e._texture.baseTexture.alphaMode?Rn(e._tintRGB,j):e._tintRGB+(255*j<<24),ut=0;ut<U.length;ut+=2)x[l++]=U[ut],x[l++]=U[ut+1],x[l++]=w[ut],x[l++]=w[ut+1],m[l++]=K,x[l++]=B;for(ut=0;ut<R.length;ut++)s[h++]=b+R[ut]},n._drawCallPool=[],n._textureArrayPool=[],n}(Ia),Xu=function(){function o(n,e){if(this.vertexSrc=n,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return o.prototype.generateShader=function(n){if(!this.programCache[n]){for(var e=new Int32Array(n),r=0;r<n;r++)e[r]=r;this.defaultGroupCache[n]=uo.from({uSamplers:e},!0);var s=this.fragTemplate;s=(s=s.replace(/%count%/gi,""+n)).replace(/%forloop%/gi,this.generateSampleSrc(n)),this.programCache[n]=new du(this.vertexSrc,s)}var l={tint:new Float32Array([1,1,1,1]),translationMatrix:new yi,default:this.defaultGroupCache[n]};return new Oa(this.programCache[n],l)},o.prototype.generateSampleSrc=function(n){var e="";e+=`
`,e+=`
`;for(var r=0;r<n;r++)r>0&&(e+=`
else `),r<n-1&&(e+="if(vTextureId < "+r+".5)"),e+=`
{`,e+=`
	color = texture2D(uSamplers[`+r+"], vTextureCoord);",e+=`
}`;return e+=`
`,e+=`
`},o}(),kl=function(o){function n(e){e===void 0&&(e=!1);var r=o.call(this)||this;return r._buffer=new Yi(null,e,!1),r._indexBuffer=new Yi(null,e,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,Q.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,Q.FLOAT).addAttribute("aColor",r._buffer,4,!0,Q.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,Q.FLOAT).addIndex(r._indexBuffer),r}return fe(n,o),n}(Ca),wd=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,wc=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,mr=function(){function o(){}return o.create=function(n){var e=Object.assign({vertex:wd,fragment:wc,geometryClass:kl,vertexSize:6},n),r=e.vertex,s=e.fragment,l=e.vertexSize,h=e.geometryClass;return function(m){function x(b){var w=m.call(this,b)||this;return w.shaderGenerator=new Xu(r,s),w.geometryClass=h,w.vertexSize=l,w}return fe(x,m),x}(bc)},Object.defineProperty(o,"defaultVertexSrc",{get:function(){return wd},enumerable:!1,configurable:!0}),Object.defineProperty(o,"defaultFragmentTemplate",{get:function(){return wc},enumerable:!1,configurable:!0}),o}(),Cs=mr.create(),Rs={},Tc=function(o){Object.defineProperty(Rs,o,{get:function(){return is("6.0.0","PIXI.systems."+o+" has moved to PIXI."+o),Gr[o]}})};for(var Is in Gr)Tc(Is);var _u={},Na=function(o){Object.defineProperty(_u,o,{get:function(){return is("6.0.0","PIXI.resources."+o+" has moved to PIXI."+o),la[o]}})};for(var Is in la)Na(Is);/*!
 * @pixi/app - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Yu=function(){function o(n){var e=this;this.stage=new Ci,n=Object.assign({forceCanvas:!1},n),this.renderer=Li(n),o._plugins.forEach(function(r){r.init.call(e,n)})}return o.registerPlugin=function(n){o._plugins.push(n)},o.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(o.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),o.prototype.destroy=function(n,e){var r=this,s=o._plugins.slice(0);s.reverse(),s.forEach(function(l){l.destroy.call(r)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(n),this.renderer=null},o._plugins=[],o}(),Sc=function(){function o(){}return o.init=function(n){var e=this;Object.defineProperty(this,"resizeTo",{set:function(r){self.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(self.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame(function(){return e.resize()}))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var r,s;if(e.cancelResize(),e._resizeTo===self)r=self.innerWidth,s=self.innerHeight;else{var l=e._resizeTo;r=l.clientWidth,s=l.clientHeight}e.renderer.resize(r,s)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=n.resizeTo||null},o.destroy=function(){self.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},o}();Yu.registerPlugin(Sc);/*!
 * @pixi/extract - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ah=new dr,Gl=function(){function o(n){this.renderer=n}return o.prototype.image=function(n,e,r){var s=new Image;return s.src=this.base64(n,e,r),s},o.prototype.base64=function(n,e,r){return this.canvas(n).toDataURL(e,r)},o.prototype.canvas=function(n){var e,r,s,l=this.renderer,h=!1,m=!1;n&&(n instanceof Ri?s=n:(s=this.renderer.generateTexture(n),m=!0)),s?(e=s.baseTexture.resolution,r=s.frame,h=!1,l.renderTexture.bind(s)):(e=this.renderer.resolution,h=!0,(r=Ah).width=this.renderer.width,r.height=this.renderer.height,l.renderTexture.bind(null));var x=Math.floor(r.width*e+1e-4),b=Math.floor(r.height*e+1e-4),w=new Tl(x,b,1),R=new Uint8Array(4*x*b),U=l.gl;U.readPixels(r.x*e,r.y*e,x,b,U.RGBA,U.UNSIGNED_BYTE,R);var B=w.context.getImageData(0,0,x,b);if(o.arrayPostDivide(R,B.data),w.context.putImageData(B,0,0),h){var j=new Tl(w.width,w.height,1);j.context.scale(1,-1),j.context.drawImage(w.canvas,0,-b),w.destroy(),w=j}return m&&s.destroy(!0),w.canvas},o.prototype.pixels=function(n){var e,r,s,l=this.renderer,h=!1;n&&(n instanceof Ri?s=n:(s=this.renderer.generateTexture(n),h=!0)),s?(e=s.baseTexture.resolution,r=s.frame,l.renderTexture.bind(s)):(e=l.resolution,(r=Ah).width=l.width,r.height=l.height,l.renderTexture.bind(null));var m=r.width*e,x=r.height*e,b=new Uint8Array(4*m*x),w=l.gl;return w.readPixels(r.x*e,r.y*e,m,x,w.RGBA,w.UNSIGNED_BYTE,b),h&&s.destroy(!0),o.arrayPostDivide(b,b),b},o.prototype.destroy=function(){this.renderer=null},o.arrayPostDivide=function(n,e){for(var r=0;r<n.length;r+=4){var s=e[r+3]=n[r+3];s!==0?(e[r]=Math.round(Math.min(255*n[r]/s,255)),e[r+1]=Math.round(Math.min(255*n[r+1]/s,255)),e[r+2]=Math.round(Math.min(255*n[r+2]/s,255))):(e[r]=n[r],e[r+1]=n[r+1],e[r+2]=n[r+2])}},o}(),Mi=T(7),Ec=T.n(Mi),zi=T(2),Qn=T.n(zi);/*!
 * resource-loader - v3.0.1
 * https://github.com/pixijs/pixi-sound
 * Compiled Tue, 02 Jul 2019 14:06:18 UTC
 *
 * resource-loader is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */function po(){}function Ph(o,n,e,r){var s=0,l=o.length;(function h(m){m||s===l?e&&e(m):r?setTimeout(function(){n(o[s++],h)},1):n(o[s++],h)})()}function qu(o){return function(){if(o===null)throw new Error("Callback was already called.");var n=o;o=null,n.apply(this,arguments)}}function Mc(o,n){if(n==null)n=1;else if(n===0)throw new Error("Concurrency must not be zero");var e=0,r={_tasks:[],concurrency:n,saturated:po,unsaturated:po,buffer:n/4,empty:po,drain:po,error:po,started:!1,paused:!1,push:function(h,m){s(h,!1,m)},kill:function(){e=0,r.drain=po,r.started=!1,r._tasks=[]},unshift:function(h,m){s(h,!0,m)},process:function(){for(;!r.paused&&e<r.concurrency&&r._tasks.length;){var h=r._tasks.shift();r._tasks.length===0&&r.empty(),(e+=1)===r.concurrency&&r.saturated(),o(h.data,qu(l(h)))}},length:function(){return r._tasks.length},running:function(){return e},idle:function(){return r._tasks.length+e===0},pause:function(){r.paused!==!0&&(r.paused=!0)},resume:function(){if(r.paused!==!1){r.paused=!1;for(var h=1;h<=r.concurrency;h++)r.process()}}};function s(h,m,x){if(x!=null&&typeof x!="function")throw new Error("task callback must be a function");if(r.started=!0,h==null&&r.idle())setTimeout(function(){return r.drain()},1);else{var b={data:h,callback:typeof x=="function"?x:po};m?r._tasks.unshift(b):r._tasks.push(b),setTimeout(function(){return r.process()},1)}}function l(h){return function(){e-=1,h.callback.apply(h,arguments),arguments[0]!=null&&r.error(arguments[0],h.data),e<=r.concurrency-r.buffer&&r.unsaturated(),r.idle()&&r.drain(),r.process()}}return r}var Ch={};function pn(o,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,r.key,r)}}function Oi(o,n,e){return n&&pn(o.prototype,n),e&&pn(o,e),o}var ii=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),ha=null;function yr(){}var On=function(){function o(e,r,s){if(typeof e!="string"||typeof r!="string")throw new Error("Both name and url are required for constructing a resource.");s=s||{},this._flags=0,this._setFlag(o.STATUS_FLAGS.DATA_URL,r.indexOf("data:")===0),this.name=e,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=s.crossOrigin===!0?"anonymous":s.crossOrigin,this.timeout=s.timeout||0,this.loadType=s.loadType||this._determineLoadType(),this.xhrType=s.xhrType,this.metadata=s.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=o.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=yr,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Qn.a,this.onProgress=new Qn.a,this.onComplete=new Qn.a,this.onAfterMiddleware=new Qn.a}o.setExtensionLoadType=function(e,r){Ac(o._loadTypeMap,e,r)},o.setExtensionXhrType=function(e,r){Ac(o._xhrTypeMap,e,r)};var n=o.prototype;return n.complete=function(){this._clearEvents(),this._finish()},n.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=o.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},n.load=function(e){var r=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout(function(){return e(r)},1);else switch(e&&this.onComplete.once(e),this._setFlag(o.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),this.crossOrigin!==!1&&typeof this.crossOrigin=="string"||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case o.LOAD_TYPE.IMAGE:this.type=o.TYPE.IMAGE,this._loadElement("image");break;case o.LOAD_TYPE.AUDIO:this.type=o.TYPE.AUDIO,this._loadSourceElement("audio");break;case o.LOAD_TYPE.VIDEO:this.type=o.TYPE.VIDEO,this._loadSourceElement("video");break;case o.LOAD_TYPE.XHR:default:ii&&this.crossOrigin?this._loadXdr():this._loadXhr()}},n._hasFlag=function(e){return(this._flags&e)!=0},n._setFlag=function(e,r){this._flags=r?this._flags|e:this._flags&~e},n._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},n._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(o.STATUS_FLAGS.COMPLETE,!0),this._setFlag(o.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},n._loadElement=function(e){this.metadata.loadElement?this.data=this.metadata.loadElement:e==="image"&&window.Image!==void 0?this.data=new Image:this.data=document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},n._loadSourceElement=function(e){if(this.metadata.loadElement?this.data=this.metadata.loadElement:e==="audio"&&window.Audio!==void 0?this.data=new Audio:this.data=document.createElement(e),this.data!==null){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var r=this.metadata.mimeType,s=0;s<this.url.length;++s)this.data.appendChild(this._createSource(e,this.url[s],Array.isArray(r)?r[s]:r));else{var l=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(l)?l[0]:l))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+e)},n._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===o.XHR_RESPONSE_TYPE.JSON||this.xhrType===o.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=o.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},n._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XDomainRequest;e.timeout=this.timeout||5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXhrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open("GET",this.url,!0),setTimeout(function(){return e.send()},1)},n._createSource=function(e,r,s){s||(s=e+"/"+this._getExtension(r));var l=document.createElement("source");return l.src=r,l.type=s,l},n._onError=function(e){this.abort("Failed to load element using: "+e.target.nodeName)},n._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},n._onTimeout=function(){this.abort("Load timed out.")},n._xhrOnError=function(){var e=this.xhr;this.abort(Eo(e)+" Request failed. Status: "+e.status+', text: "'+e.statusText+'"')},n._xhrOnTimeout=function(){var e=this.xhr;this.abort(Eo(e)+" Request timed out.")},n._xhrOnAbort=function(){var e=this.xhr;this.abort(Eo(e)+" Request was aborted by the user.")},n._xhrOnLoad=function(){var e=this.xhr,r="",s=e.status===void 0?200:e.status;if(e.responseType!==""&&e.responseType!=="text"&&e.responseType!==void 0||(r=e.responseText),s===0&&(r.length>0||e.responseType===o.XHR_RESPONSE_TYPE.BUFFER)?s=200:s===1223&&(s=204),(s/100|0)==2){if(this.xhrType===o.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=o.TYPE.TEXT;else if(this.xhrType===o.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=o.TYPE.JSON}catch(m){return void this.abort("Error trying to parse loaded json: "+m)}else if(this.xhrType===o.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var l=new DOMParser;this.data=l.parseFromString(r,"text/xml")}else{var h=document.createElement("div");h.innerHTML=r,this.data=h}this.type=o.TYPE.XML}catch(m){return void this.abort("Error trying to parse loaded xml: "+m)}else this.data=e.response||r;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},n._determineCrossOrigin=function(e,r){if(e.indexOf("data:")===0)return"";if(window.origin!==window.location.origin)return"anonymous";r=r||window.location,ha||(ha=document.createElement("a")),ha.href=e;var s=!(e=Ec()(ha.href,{strictMode:!0})).port&&r.port===""||e.port===r.port,l=e.protocol?e.protocol+":":"";return e.host===r.hostname&&s&&l===r.protocol?"":"anonymous"},n._determineXhrType=function(){return o._xhrTypeMap[this.extension]||o.XHR_RESPONSE_TYPE.TEXT},n._determineLoadType=function(){return o._loadTypeMap[this.extension]||o.LOAD_TYPE.XHR},n._getExtension=function(){var e=this.url,r="";if(this.isDataUrl){var s=e.indexOf("/");r=e.substring(s+1,e.indexOf(";",s))}else{var l=e.indexOf("?"),h=e.indexOf("#"),m=Math.min(l>-1?l:e.length,h>-1?h:e.length);r=(e=e.substring(0,m)).substring(e.lastIndexOf(".")+1)}return r.toLowerCase()},n._getMimeFromXhrType=function(e){switch(e){case o.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case o.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case o.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case o.XHR_RESPONSE_TYPE.JSON:return"application/json";case o.XHR_RESPONSE_TYPE.DEFAULT:case o.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},Oi(o,[{key:"isDataUrl",get:function(){return this._hasFlag(o.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(o.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(o.STATUS_FLAGS.LOADING)}}]),o}();function Ac(o,n,e){n&&n.indexOf(".")===0&&(n=n.substring(1)),n&&(o[n]=e)}function Eo(o){return o.toString().replace("object ","")}On.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},On.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},On.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},On.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},On._loadTypeMap={gif:On.LOAD_TYPE.IMAGE,png:On.LOAD_TYPE.IMAGE,bmp:On.LOAD_TYPE.IMAGE,jpg:On.LOAD_TYPE.IMAGE,jpeg:On.LOAD_TYPE.IMAGE,tif:On.LOAD_TYPE.IMAGE,tiff:On.LOAD_TYPE.IMAGE,webp:On.LOAD_TYPE.IMAGE,tga:On.LOAD_TYPE.IMAGE,svg:On.LOAD_TYPE.IMAGE,"svg+xml":On.LOAD_TYPE.IMAGE,mp3:On.LOAD_TYPE.AUDIO,ogg:On.LOAD_TYPE.AUDIO,wav:On.LOAD_TYPE.AUDIO,mp4:On.LOAD_TYPE.VIDEO,webm:On.LOAD_TYPE.VIDEO},On._xhrTypeMap={xhtml:On.XHR_RESPONSE_TYPE.DOCUMENT,html:On.XHR_RESPONSE_TYPE.DOCUMENT,htm:On.XHR_RESPONSE_TYPE.DOCUMENT,xml:On.XHR_RESPONSE_TYPE.DOCUMENT,tmx:On.XHR_RESPONSE_TYPE.DOCUMENT,svg:On.XHR_RESPONSE_TYPE.DOCUMENT,tsx:On.XHR_RESPONSE_TYPE.DOCUMENT,gif:On.XHR_RESPONSE_TYPE.BLOB,png:On.XHR_RESPONSE_TYPE.BLOB,bmp:On.XHR_RESPONSE_TYPE.BLOB,jpg:On.XHR_RESPONSE_TYPE.BLOB,jpeg:On.XHR_RESPONSE_TYPE.BLOB,tif:On.XHR_RESPONSE_TYPE.BLOB,tiff:On.XHR_RESPONSE_TYPE.BLOB,webp:On.XHR_RESPONSE_TYPE.BLOB,tga:On.XHR_RESPONSE_TYPE.BLOB,json:On.XHR_RESPONSE_TYPE.JSON,text:On.XHR_RESPONSE_TYPE.TEXT,txt:On.XHR_RESPONSE_TYPE.TEXT,ttf:On.XHR_RESPONSE_TYPE.BUFFER,otf:On.XHR_RESPONSE_TYPE.BUFFER},On.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var ca=window.URL||window.webkitURL,Hl={caching:function(o,n){var e=this;Ch[o.url]?(o.data=Ch[o.url],o.complete()):o.onComplete.once(function(){return Ch[e.url]=e.data}),n()},parsing:function(o,n){if(o.data){if(o.xhr&&o.xhrType===On.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&typeof o.data!="string"){if(o.data.type.indexOf("image")===0){var e=ca.createObjectURL(o.data);return o.blob=o.data,o.data=new Image,o.data.src=e,o.type=On.TYPE.IMAGE,void(o.data.onload=function(){ca.revokeObjectURL(e),o.data.onload=null,n()})}}else{var r=o.xhr.getResponseHeader("content-type");if(r&&r.indexOf("image")===0)return o.data=new Image,o.data.src="data:"+r+";base64,"+function(s){for(var l="",h=0;h<s.length;){for(var m=[0,0,0],x=[0,0,0,0],b=0;b<m.length;++b)h<s.length?m[b]=255&s.charCodeAt(h++):m[b]=0;switch(x[0]=m[0]>>2,x[1]=(3&m[0])<<4|m[1]>>4,x[2]=(15&m[1])<<2|m[2]>>6,x[3]=63&m[2],h-(s.length-1)){case 2:x[3]=64,x[2]=64;break;case 1:x[3]=64}for(var w=0;w<x.length;++w)l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(x[w])}return l}(o.xhr.responseText),o.type=On.TYPE.IMAGE,void(o.data.onload=function(){o.data.onload=null,n()})}n()}else n()}},Td=/(#[\w-]+)?$/,Bo=function(){function o(e,r){var s=this;e===void 0&&(e=""),r===void 0&&(r=10),this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(m,x){return s._loadResource(m,x)},this._queue=Mc(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new Qn.a,this.onError=new Qn.a,this.onLoad=new Qn.a,this.onStart=new Qn.a,this.onComplete=new Qn.a;for(var l=0;l<o._defaultBeforeMiddleware.length;++l)this.pre(o._defaultBeforeMiddleware[l]);for(var h=0;h<o._defaultAfterMiddleware.length;++h)this.use(o._defaultAfterMiddleware[h])}var n=o.prototype;return n.add=function(e,r,s,l){if(Array.isArray(e)){for(var h=0;h<e.length;++h)this.add(e[h]);return this}if(typeof e=="object"&&(l=r||e.callback||e.onComplete,s=e,r=e.url,e=e.name||e.key||e.url),typeof r!="string"&&(l=s,s=r,r=e),typeof r!="string")throw new Error("No url passed to add resource to loader.");if(typeof s=="function"&&(l=s,s=null),this.loading&&(!s||!s.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[e])throw new Error('Resource named "'+e+'" already exists.');if(r=this._prepareUrl(r),this.resources[e]=new On(e,r,s),typeof l=="function"&&this.resources[e].onAfterMiddleware.once(l),this.loading){for(var m=s.parentResource,x=[],b=0;b<m.children.length;++b)m.children[b].isComplete||x.push(m.children[b]);var w=m.progressChunk*(x.length+1)/(x.length+2);m.children.push(this.resources[e]),m.progressChunk=w;for(var R=0;R<x.length;++R)x[R].progressChunk=w;this.resources[e].progressChunk=w}return this._queue.push(this.resources[e]),this},n.pre=function(e){return this._beforeMiddleware.push(e),this},n.use=function(e){return this._afterMiddleware.push(e),this},n.reset=function(){for(var e in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var r=this.resources[e];r._onLoadBinding&&r._onLoadBinding.detach(),r.isLoading&&r.abort()}return this.resources={},this},n.load=function(e){if(typeof e=="function"&&this.onComplete.once(e),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var r=100/this._queue._tasks.length,s=0;s<this._queue._tasks.length;++s)this._queue._tasks[s].data.progressChunk=r;this._onStart(),this._queue.resume()}return this},n._prepareUrl=function(e){var r,s=Ec()(e,{strictMode:!0});if(r=s.protocol||!s.path||e.indexOf("//")===0?e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&e.charAt(0)!=="/"?this.baseUrl+"/"+e:this.baseUrl+e,this.defaultQueryString){var l=Td.exec(r)[0];(r=r.substr(0,r.length-l.length)).indexOf("?")!==-1?r+="&"+this.defaultQueryString:r+="?"+this.defaultQueryString,r+=l}return r},n._loadResource=function(e,r){var s=this;e._dequeue=r,Ph(this._beforeMiddleware,function(l,h){l.call(s,e,function(){h(e.isComplete?{}:null)})},function(){e.isComplete?s._onLoad(e):(e._onLoadBinding=e.onComplete.once(s._onLoad,s),e.load())},!0)},n._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},n._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},n._onLoad=function(e){var r=this;e._onLoadBinding=null,this._resourcesParsing.push(e),e._dequeue(),Ph(this._afterMiddleware,function(s,l){s.call(r,e,l)},function(){e.onAfterMiddleware.dispatch(e),r.progress=Math.min(100,r.progress+e.progressChunk),r.onProgress.dispatch(r,e),e.error?r.onError.dispatch(e.error,r,e):r.onLoad.dispatch(r,e),r._resourcesParsing.splice(r._resourcesParsing.indexOf(e),1),r._queue.idle()&&r._resourcesParsing.length===0&&r._onComplete()},!0)},Oi(o,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(e){this._queue.concurrency=e}}]),o}();Bo._defaultBeforeMiddleware=[],Bo._defaultAfterMiddleware=[],Bo.pre=function(o){return Bo._defaultBeforeMiddleware.push(o),Bo},Bo.use=function(o){return Bo._defaultAfterMiddleware.push(o),Bo};/*!
 * @pixi/loaders - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Pc=function(o,n){return(Pc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},yn=function(){function o(){}return o.add=function(){On.setExtensionLoadType("svg",On.LOAD_TYPE.XHR),On.setExtensionXhrType("svg",On.XHR_RESPONSE_TYPE.TEXT)},o.use=function(n,e){if(!n.data||n.type!==On.TYPE.IMAGE&&n.extension!=="svg")e();else{var r=n.data,s=n.url,l=n.name,h=n.metadata;Dn.fromLoader(r,s,l,h).then(function(m){n.texture=m,e()}).catch(e)}},o}(),Ls=function(o){function n(e,r){for(var s=o.call(this,e,r)||this,l=0;l<n._plugins.length;++l){var h=n._plugins[l],m=h.pre,x=h.use;m&&s.pre(m),x&&s.use(x)}return s._protected=!1,s}return function(e,r){function s(){this.constructor=e}Pc(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(n,"shared",{get:function(){var e=n._shared;return e||((e=new n)._protected=!0,n._shared=e),e},enumerable:!1,configurable:!0}),n.registerPlugin=function(e){return n._plugins.push(e),e.add&&e.add(),n},n._plugins=[],n}(Bo);Ls.registerPlugin({use:Hl.parsing}),Ls.registerPlugin(yn);var Hr,lr,$o=function(){function o(){}return o.init=function(n){n=Object.assign({sharedLoader:!1},n),this.loader=n.sharedLoader?Ls.shared:new Ls},o.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},o}(),Os=On;(function(o){o[o.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",o[o.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",o[o.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",o[o.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",o[o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",o[o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",o[o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",o[o.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",o[o.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",o[o.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",o[o.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",o[o.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",o[o.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",o[o.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",o[o.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",o[o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",o[o.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",o[o.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",o[o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",o[o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",o[o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",o[o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",o[o.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",o[o.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",o[o.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",o[o.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"})(lr||(lr={}));var bi=((Hr={})[lr.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,Hr[lr.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,Hr[lr.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,Hr[lr.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,Hr[lr.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,Hr[lr.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,Hr[lr.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,Hr[lr.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,Hr[lr.COMPRESSED_R11_EAC]=.5,Hr[lr.COMPRESSED_SIGNED_R11_EAC]=.5,Hr[lr.COMPRESSED_RG11_EAC]=1,Hr[lr.COMPRESSED_SIGNED_RG11_EAC]=1,Hr[lr.COMPRESSED_RGB8_ETC2]=.5,Hr[lr.COMPRESSED_RGBA8_ETC2_EAC]=1,Hr[lr.COMPRESSED_SRGB8_ETC2]=.5,Hr[lr.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,Hr[lr.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Hr[lr.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Hr[lr.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,Hr[lr.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,Hr[lr.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,Hr[lr.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,Hr[lr.COMPRESSED_RGB_ETC1_WEBGL]=.5,Hr[lr.COMPRESSED_RGB_ATC_WEBGL]=.5,Hr[lr.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,Hr[lr.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,Hr),Rh=function(o,n){return(Rh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function yu(o,n){function e(){this.constructor=o}Rh(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}function Uo(o,n){var e,r,s,l,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function m(x){return function(b){return function(w){if(e)throw new TypeError("Generator is already executing.");for(;h;)try{if(e=1,r&&(s=2&w[0]?r.return:w[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,w[1])).done)return s;switch(r=0,s&&(w=[2&w[0],s.value]),w[0]){case 0:case 1:s=w;break;case 4:return h.label++,{value:w[1],done:!1};case 5:h.label++,r=w[1],w=[0];continue;case 7:w=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!((s=s.length>0&&s[s.length-1])||w[0]!==6&&w[0]!==2)){h=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){h.label=w[1];break}if(w[0]===6&&h.label<s[1]){h.label=s[1],s=w;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(w);break}s[2]&&h.ops.pop(),h.trys.pop();continue}w=n.call(o,h)}catch(R){w=[6,R],r=0}finally{e=s=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([x,b])}}}var Fa,Xr,Hn=function(o){function n(e,r){r===void 0&&(r={width:1,height:1,autoLoad:!0});var s,l,h=this;return typeof e=="string"?(s=e,l=new Uint8Array):(s=null,l=e),(h=o.call(this,l,r)||this).origin=s,h.buffer=l?new vu(l):null,h.origin&&r.autoLoad!==!1&&h.load(),l&&l.length&&(h.loaded=!0,h.onBlobLoaded(h.buffer.rawBinaryData)),h}return yu(n,o),n.prototype.onBlobLoaded=function(e){},n.prototype.load=function(){return e=this,r=void 0,l=function(){var h;return Uo(this,function(m){switch(m.label){case 0:return[4,fetch(this.origin)];case 1:return[4,m.sent().blob()];case 2:return[4,m.sent().arrayBuffer()];case 3:return h=m.sent(),this.data=new Uint32Array(h),this.buffer=new vu(h),this.loaded=!0,this.onBlobLoaded(h),this.update(),[2,this]}})},new((s=Promise)||(s=Promise))(function(h,m){function x(R){try{w(l.next(R))}catch(U){m(U)}}function b(R){try{w(l.throw(R))}catch(U){m(U)}}function w(R){R.done?h(R.value):new s(function(U){U(R.value)}).then(x,b)}w((l=l.apply(e,r||[])).next())});var e,r,s,l},n}(pr),zl=function(o){function n(e,r){var s=o.call(this,e,r)||this;return s.format=r.format,s.levels=r.levels||1,s._width=r.width,s._height=r.height,s._extension=n._formatToExtension(s.format),(r.levelBuffers||s.buffer)&&(s._levelBuffers=r.levelBuffers||n._createLevelBuffers(e instanceof Uint8Array?e:s.buffer.uint8View,s.format,s.levels,4,4,s.width,s.height)),s}return yu(n,o),n.prototype.upload=function(e,r,s){var l=e.gl;if(!e.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var h=0,m=this.levels;h<m;h++){var x=this._levelBuffers[h],b=x.levelID,w=x.levelWidth,R=x.levelHeight,U=x.levelBuffer;l.compressedTexImage2D(l.TEXTURE_2D,b,this.format,w,R,0,U)}return!0},n.prototype.onBlobLoaded=function(){this._levelBuffers=n._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},n._formatToExtension=function(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},n._createLevelBuffers=function(e,r,s,l,h,m,x){for(var b=new Array(s),w=e.byteOffset,R=m,U=x,B=R+l-1&~(l-1),j=U+h-1&~(h-1),K=B*j*bi[r],ut=0;ut<s;ut++)b[ut]={levelID:ut,levelWidth:s>1?R:B,levelHeight:s>1?U:j,levelBuffer:new Uint8Array(e.buffer,w,K)},w+=K,K=(B=(R=R>>1||1)+l-1&~(l-1))*(j=(U=U>>1||1)+h-1&~(h-1))*bi[r];return b},n}(Hn),ji=function(){function o(){}return o.use=function(n,e){var r=n.data;if(n.type===Os.TYPE.JSON&&r&&r.cacheID&&r.textures){for(var s=r.textures,l=void 0,h=void 0,m=0,x=s.length;m<x;m++){var b=s[m],w=b.src,R=b.format;if(R||(h=w),o.textureFormats[R]){l=w;break}}if(!(l=l||h))return void e(new Error("Cannot load compressed-textures in "+n.url+", make sure you provide a fallback"));if(l===n.url)return void e(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var U={crossOrigin:n.crossOrigin,metadata:n.metadata.imageMetadata,parentResource:n},B=gi.resolve(n.url.replace(this.baseUrl,""),l),j=r.cacheID;this.add(j,B,U,function(K){if(K.error)e(K.error);else{var ut=K.texture,gt=ut===void 0?null:ut,Rt=K.textures,Le=Rt===void 0?{}:Rt;Object.assign(n,{texture:gt,textures:Le}),e()}})}else e()},o.add=function(){var n=document.createElement("canvas").getContext("webgl");if(n){var e={s3tc:n.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:n.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:n.getExtension("WEBGL_compressed_texture_etc"),etc1:n.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:n.getExtension("WEBGL_compressed_texture_atc"),astc:n.getExtension("WEBGL_compressed_texture_astc")};for(var r in o.textureExtensions=e,o.textureFormats={},e){var s=e[r];s&&Object.assign(o.textureFormats,Object.getPrototypeOf(s))}}else console.error("WebGL not available for compressed textures. Silently failing.")},o}();function ms(o,n,e){var r={textures:{},texture:null};return n&&n.map(function(s){return new Dn(new fr(s,Object.assign({mipmap:Ct.OFF,alphaMode:It.NO_PREMULTIPLIED_ALPHA},e)))}).forEach(function(s,l){var h=s.baseTexture,m=o+"-"+(l+1);fr.addToCache(h,m),Dn.addToCache(s,m),l===0&&(fr.addToCache(h,o),Dn.addToCache(s,o),r.texture=s),r.textures[m]=s}),r}Os.setExtensionXhrType("dds",Os.XHR_RESPONSE_TYPE.BUFFER);var Di,ko,Ba=3,Cc=4,Rc=7,xu=19,bu=2,Ih=0,Lh=1,Zu=2,Oh=3;(function(o){o[o.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",o[o.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",o[o.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",o[o.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",o[o.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",o[o.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",o[o.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",o[o.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",o[o.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",o[o.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",o[o.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",o[o.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",o[o.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",o[o.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",o[o.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",o[o.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",o[o.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",o[o.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",o[o.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",o[o.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",o[o.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",o[o.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",o[o.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",o[o.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",o[o.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",o[o.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",o[o.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",o[o.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",o[o.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",o[o.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",o[o.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",o[o.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",o[o.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",o[o.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",o[o.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",o[o.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",o[o.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",o[o.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",o[o.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",o[o.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",o[o.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",o[o.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",o[o.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",o[o.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",o[o.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",o[o.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",o[o.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",o[o.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",o[o.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",o[o.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",o[o.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",o[o.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",o[o.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",o[o.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",o[o.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",o[o.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",o[o.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",o[o.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",o[o.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",o[o.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",o[o.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",o[o.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",o[o.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",o[o.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",o[o.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",o[o.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",o[o.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",o[o.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",o[o.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",o[o.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",o[o.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",o[o.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",o[o.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",o[o.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",o[o.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",o[o.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",o[o.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",o[o.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",o[o.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",o[o.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",o[o.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",o[o.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",o[o.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",o[o.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",o[o.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",o[o.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",o[o.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",o[o.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",o[o.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",o[o.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",o[o.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",o[o.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",o[o.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",o[o.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",o[o.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",o[o.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",o[o.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",o[o.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",o[o.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",o[o.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",o[o.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",o[o.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",o[o.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",o[o.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",o[o.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",o[o.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",o[o.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",o[o.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",o[o.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",o[o.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",o[o.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",o[o.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",o[o.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",o[o.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",o[o.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",o[o.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",o[o.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",o[o.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",o[o.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",o[o.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",o[o.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",o[o.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"})(Di||(Di={})),function(o){o[o.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",o[o.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",o[o.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(ko||(ko={}));var Ws,da,pa,Ni=((Fa={})[827611204]=lr.COMPRESSED_RGBA_S3TC_DXT1_EXT,Fa[861165636]=lr.COMPRESSED_RGBA_S3TC_DXT3_EXT,Fa[894720068]=lr.COMPRESSED_RGBA_S3TC_DXT5_EXT,Fa),Ju=((Xr={})[Di.DXGI_FORMAT_BC1_TYPELESS]=lr.COMPRESSED_RGBA_S3TC_DXT1_EXT,Xr[Di.DXGI_FORMAT_BC1_UNORM]=lr.COMPRESSED_RGBA_S3TC_DXT1_EXT,Xr[Di.DXGI_FORMAT_BC2_TYPELESS]=lr.COMPRESSED_RGBA_S3TC_DXT3_EXT,Xr[Di.DXGI_FORMAT_BC2_UNORM]=lr.COMPRESSED_RGBA_S3TC_DXT3_EXT,Xr[Di.DXGI_FORMAT_BC3_TYPELESS]=lr.COMPRESSED_RGBA_S3TC_DXT5_EXT,Xr[Di.DXGI_FORMAT_BC3_UNORM]=lr.COMPRESSED_RGBA_S3TC_DXT5_EXT,Xr[Di.DXGI_FORMAT_BC1_UNORM_SRGB]=lr.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,Xr[Di.DXGI_FORMAT_BC2_UNORM_SRGB]=lr.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,Xr[Di.DXGI_FORMAT_BC3_UNORM_SRGB]=lr.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,Xr),Xs=function(){function o(){}return o.use=function(n,e){if(n.extension==="dds"&&n.data)try{Object.assign(n,ms(n.name||n.url,o.parse(n.data),n.metadata))}catch(r){return void e(r)}e()},o.parse=function(n){var e=new Uint32Array(n);if(e[0]!==542327876)throw new Error("Invalid DDS file magic word");var r=new Uint32Array(n,0,124/Uint32Array.BYTES_PER_ELEMENT),s=r[Ba],l=r[Cc],h=r[Rc],m=new Uint32Array(n,xu*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),x=m[1];if(4&x){var b=m[bu];if(b!==808540228){var w=Ni[b],R=new Uint8Array(n,128);return[new zl(R,{format:w,width:l,height:s,levels:h})]}var U=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),B=U[Ih],j=U[Lh],K=U[Zu],ut=U[Oh],gt=Ju[B];if(gt===void 0)throw new Error("DDSLoader cannot parse texture data with DXGI format "+B);if(K===4)throw new Error("DDSLoader does not support cubemap textures");if(j===ko.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var Rt=new Array;if(ut===1)Rt.push(new Uint8Array(n,148));else{for(var Le=bi[gt],en=0,At=l,oe=s,qt=0;qt<h;qt++)en+=Math.max(1,At+3&-4)*Math.max(1,oe+3&-4)*Le,At>>>=1,oe>>>=1;var ne=148;for(qt=0;qt<ut;qt++)Rt.push(new Uint8Array(n,ne,en)),ne+=en}return Rt.map(function(Je){return new zl(Je,{format:gt,width:l,height:s,levels:h})})}throw 64&x?new Error("DDSLoader does not support uncompressed texture data."):512&x?new Error("DDSLoader does not supported YUV uncompressed texture data."):131072&x?new Error("DDSLoader does not support single-channel (lumninance) texture data!"):2&x?new Error("DDSLoader does not support single-channel (alpha) texture data!"):new Error("DDSLoader failed to load a texture file due to an unknown reason!")},o}();Os.setExtensionXhrType("ktx",Os.XHR_RESPONSE_TYPE.BUFFER);var Ua=[171,75,84,88,32,49,49,187,13,10,26,10],Mo=12,Sd=16,fo=24,jl=28,Zi=36,Ic=40,$u=44,Ds=48,Dh=52,Ed=56,Md=60,Go=((Ws={})[Q.UNSIGNED_BYTE]=1,Ws[Q.UNSIGNED_SHORT]=2,Ws[Q.FLOAT]=4,Ws[Q.HALF_FLOAT]=8,Ws),Ns=((da={})[$i.RGBA]=4,da[$i.RGB]=3,da[$i.LUMINANCE]=1,da[$i.LUMINANCE_ALPHA]=2,da[$i.ALPHA]=1,da),Nn=((pa={})[Q.UNSIGNED_SHORT_4_4_4_4]=2,pa[Q.UNSIGNED_SHORT_5_5_5_1]=2,pa[Q.UNSIGNED_SHORT_5_6_5]=2,pa),ka=function(){function o(){}return o.use=function(n,e){if(n.extension==="ktx"&&n.data)try{var r=n.name||n.url;Object.assign(n,ms(r,o.parse(r,n.data),n.metadata))}catch(s){return void e(s)}e()},o.parse=function(n,e){var r=new DataView(e);if(!o.validate(n,r))return null;var s=r.getUint32(Mo,!0)===67305985,l=r.getUint32(Sd,s),h=r.getUint32(fo,s),m=r.getUint32(jl,s),x=r.getUint32(Zi,s),b=r.getUint32(Ic,s)||1,w=r.getUint32($u,s)||1,R=r.getUint32(Ds,s)||1,U=r.getUint32(Dh,s),B=r.getUint32(Ed,s),j=r.getUint32(Md,s);if(b===0||w!==1)throw new Error("Only 2D textures are supported");if(U!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(R!==1)throw new Error("WebGL does not support array textures");var K,ut=x+3&-4,gt=b+3&-4,Rt=new Array(R),Le=x*b;if(l===0&&(Le=ut*gt),(K=l!==0?Go[l]?Go[l]*Ns[h]:Nn[l]:bi[m])===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var en=Le*K,At=x,oe=b,qt=ut,ne=gt,Je=64+j,Pe=0;Pe<B;Pe++){for(var $t=r.getUint32(Je,s),Ee=Je+4,hn=0;hn<R;hn++){var Ve=Rt[hn];Ve||(Ve=Rt[hn]=new Array(B)),Ve[Pe]={levelID:Pe,levelWidth:B>1?At:qt,levelHeight:B>1?oe:ne,levelBuffer:new Uint8Array(e,Ee,en)},Ee+=en}Je=(Je+=$t+4)%4!=0?Je+4-Je%4:Je,en=(qt=(At=At>>1||1)+4-1&-4)*(ne=(oe=oe>>1||1)+4-1&-4)*K}if(l!==0)throw new Error("TODO: Uncompressed");return Rt.map(function(He){return new zl(null,{format:m,width:x,height:b,levels:B,levelBuffers:He})})},o.validate=function(n,e){for(var r=0;r<Ua.length;r++)if(e.getUint8(r)!==Ua[r])return console.error(n+" is not a valid *.ktx file!"),!1;return!0},o}(),Nh=function(o,n){return(Nh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function wu(o,n){function e(){this.constructor=o}Nh(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var mo,er,Ze=function(o){function n(e,r,s,l){e===void 0&&(e=1500),s===void 0&&(s=16384),l===void 0&&(l=!1);var h=o.call(this)||this;return s>16384&&(s=16384),h._properties=[!1,!0,!1,!1,!1],h._maxSize=e,h._batchSize=s,h._buffers=null,h._bufferUpdateIDs=[],h._updateID=0,h.interactiveChildren=!1,h.blendMode=Ln.NORMAL,h.autoResize=l,h.roundPixels=!0,h.baseTexture=null,h.setProperties(r),h._tint=0,h.tintRgb=new Float32Array(4),h.tint=16777215,h}return wu(n,o),n.prototype.setProperties=function(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])},n.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,Yo(e,this.tintRgb)},enumerable:!1,configurable:!0}),n.prototype.render=function(e){var r=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return r.onChildrenChange(0)})),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},n.prototype.onChildrenChange=function(e){for(var r=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<r;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[r]=++this._updateID},n.prototype.dispose=function(){if(this._buffers){for(var e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}},n.prototype.destroy=function(e){o.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},n}(Ci),gs=function(){function o(n,e,r){this.geometry=new Ca,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var s=0;s<n.length;++s){var l=n[s];l={attributeName:l.attributeName,size:l.size,uploadFunction:l.uploadFunction,type:l.type||Q.FLOAT,offset:l.offset},e[s]?this.dynamicProperties.push(l):this.staticProperties.push(l)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return o.prototype.initBuffers=function(){var n=this.geometry,e=0;this.indexBuffer=new Yi(Sn(this.size),!0,!0),n.addIndex(this.indexBuffer),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r)(m=this.dynamicProperties[r]).offset=e,e+=m.size,this.dynamicStride+=m.size;var s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new Yi(this.dynamicData,!1,!1);var l=0;for(this.staticStride=0,r=0;r<this.staticProperties.length;++r)(m=this.staticProperties[r]).offset=l,l+=m.size,this.staticStride+=m.size;var h=new ArrayBuffer(this.size*this.staticStride*4*4);for(this.staticData=new Float32Array(h),this.staticDataUint32=new Uint32Array(h),this.staticBuffer=new Yi(this.staticData,!0,!1),r=0;r<this.dynamicProperties.length;++r){var m=this.dynamicProperties[r];n.addAttribute(m.attributeName,this.dynamicBuffer,0,m.type===Q.UNSIGNED_BYTE,m.type,4*this.dynamicStride,4*m.offset)}for(r=0;r<this.staticProperties.length;++r)m=this.staticProperties[r],n.addAttribute(m.attributeName,this.staticBuffer,0,m.type===Q.UNSIGNED_BYTE,m.type,4*this.staticStride,4*m.offset)},o.prototype.uploadDynamic=function(n,e,r){for(var s=0;s<this.dynamicProperties.length;s++){var l=this.dynamicProperties[s];l.uploadFunction(n,e,r,l.type===Q.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,l.offset)}this.dynamicBuffer._updateID++},o.prototype.uploadStatic=function(n,e,r){for(var s=0;s<this.staticProperties.length;s++){var l=this.staticProperties[s];l.uploadFunction(n,e,r,l.type===Q.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,l.offset)}this.staticBuffer._updateID++},o.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},o}(),Ad=function(o){function n(e){var r=o.call(this,e)||this;return r.shader=null,r.properties=null,r.tempMatrix=new yi,r.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:r.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:r.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:r.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:r.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Q.UNSIGNED_BYTE,uploadFunction:r.uploadTint,offset:0}],r.shader=Oa.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,{}),r.state=Da.for2d(),r}return wu(n,o),n.prototype.render=function(e){var r=e.children,s=e._maxSize,l=e._batchSize,h=this.renderer,m=r.length;if(m!==0){m>s&&!e.autoResize&&(m=s);var x=e._buffers;x||(x=e._buffers=this.generateBuffers(e));var b=r[0]._texture.baseTexture;this.state.blendMode=$e(e.blendMode,b.alphaMode),h.state.set(this.state);var w=h.gl,R=e.worldTransform.copyTo(this.tempMatrix);R.prepend(h.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=R.toArray(!0),this.shader.uniforms.uColor=un(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,b.alphaMode),this.shader.uniforms.uSampler=b,this.renderer.shader.bind(this.shader);for(var U=!1,B=0,j=0;B<m;B+=l,j+=1){var K=m-B;K>l&&(K=l),j>=x.length&&x.push(this._generateOneMoreBuffer(e));var ut=x[j];ut.uploadDynamic(r,B,K);var gt=e._bufferUpdateIDs[j]||0;(U=U||ut._updateID<gt)&&(ut._updateID=e._updateID,ut.uploadStatic(r,B,K)),h.geometry.bind(ut.geometry),w.drawElements(w.TRIANGLES,6*K,w.UNSIGNED_SHORT,0)}}},n.prototype.generateBuffers=function(e){for(var r=[],s=e._maxSize,l=e._batchSize,h=e._properties,m=0;m<s;m+=l)r.push(new gs(this.properties,h,l));return r},n.prototype._generateOneMoreBuffer=function(e){var r=e._batchSize,s=e._properties;return new gs(this.properties,s,r)},n.prototype.uploadVertices=function(e,r,s,l,h,m){for(var x=0,b=0,w=0,R=0,U=0;U<s;++U){var B=e[r+U],j=B._texture,K=B.scale.x,ut=B.scale.y,gt=j.trim,Rt=j.orig;gt?(x=(b=gt.x-B.anchor.x*Rt.width)+gt.width,w=(R=gt.y-B.anchor.y*Rt.height)+gt.height):(x=Rt.width*(1-B.anchor.x),b=Rt.width*-B.anchor.x,w=Rt.height*(1-B.anchor.y),R=Rt.height*-B.anchor.y),l[m]=b*K,l[m+1]=R*ut,l[m+h]=x*K,l[m+h+1]=R*ut,l[m+2*h]=x*K,l[m+2*h+1]=w*ut,l[m+3*h]=b*K,l[m+3*h+1]=w*ut,m+=4*h}},n.prototype.uploadPosition=function(e,r,s,l,h,m){for(var x=0;x<s;x++){var b=e[r+x].position;l[m]=b.x,l[m+1]=b.y,l[m+h]=b.x,l[m+h+1]=b.y,l[m+2*h]=b.x,l[m+2*h+1]=b.y,l[m+3*h]=b.x,l[m+3*h+1]=b.y,m+=4*h}},n.prototype.uploadRotation=function(e,r,s,l,h,m){for(var x=0;x<s;x++){var b=e[r+x].rotation;l[m]=b,l[m+h]=b,l[m+2*h]=b,l[m+3*h]=b,m+=4*h}},n.prototype.uploadUvs=function(e,r,s,l,h,m){for(var x=0;x<s;++x){var b=e[r+x]._texture._uvs;b?(l[m]=b.x0,l[m+1]=b.y0,l[m+h]=b.x1,l[m+h+1]=b.y1,l[m+2*h]=b.x2,l[m+2*h+1]=b.y2,l[m+3*h]=b.x3,l[m+3*h+1]=b.y3,m+=4*h):(l[m]=0,l[m+1]=0,l[m+h]=0,l[m+h+1]=0,l[m+2*h]=0,l[m+2*h+1]=0,l[m+3*h]=0,l[m+3*h+1]=0,m+=4*h)}},n.prototype.uploadTint=function(e,r,s,l,h,m){for(var x=0;x<s;++x){var b=e[r+x],w=b._texture.baseTexture.alphaMode>0,R=b.alpha,U=R<1&&w?Rn(b._tintRGB,R):b._tintRGB+(255*R<<24);l[m]=U,l[m+h]=U,l[m+2*h]=U,l[m+3*h]=U,m+=4*h}},n.prototype.destroy=function(){o.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},n}(Ia);(function(o){o.MITER="miter",o.BEVEL="bevel",o.ROUND="round"})(mo||(mo={})),function(o){o.BUTT="butt",o.ROUND="round",o.SQUARE="square"}(er||(er={}));var Vl={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(o,n){if(n===void 0&&(n=20),!this.adaptive||!o||isNaN(o))return n;var e=Math.ceil(o/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},Ys=function(){function o(){this.color=16777215,this.alpha=1,this.texture=Dn.WHITE,this.matrix=null,this.visible=!1,this.reset()}return o.prototype.clone=function(){var n=new o;return n.color=this.color,n.alpha=this.alpha,n.texture=this.texture,n.matrix=this.matrix,n.visible=this.visible,n},o.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Dn.WHITE,this.matrix=null,this.visible=!1},o.prototype.destroy=function(){this.texture=null,this.matrix=null},o}(),Ao=function(o,n){return(Ao=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function Fh(o,n){function e(){this.constructor=o}Ao(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var Bh={build:function(o){o.points=o.shape.points.slice()},triangulate:function(o,n){var e=o.points,r=o.holes,s=n.points,l=n.indices;if(e.length>=6){for(var h=[],m=0;m<r.length;m++){var x=r[m];h.push(e.length/2),e=e.concat(x.points)}var b=jr()(e,h,2);if(!b)return;var w=s.length/2;for(m=0;m<b.length;m+=3)l.push(b[m]+w),l.push(b[m+1]+w),l.push(b[m+2]+w);for(m=0;m<e.length;m++)s.push(e[m])}}},Pd={build:function(o){var n,e,r=o.shape,s=o.points,l=r.x,h=r.y;if(s.length=0,o.type===_i.CIRC)n=r.radius,e=r.radius;else{var m=o.shape;n=m.width,e=m.height}if(n!==0&&e!==0){var x=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(n+e));x/=2.3;for(var b=2*Math.PI/x,w=0;w<x-.5;w++)s.push(l+Math.sin(-b*w)*n,h+Math.cos(-b*w)*e);s.push(s[0],s[1])}},triangulate:function(o,n){var e=o.points,r=n.points,s=n.indices,l=r.length/2,h=l,m=o.shape,x=o.matrix,b=m.x,w=m.y;r.push(o.matrix?x.a*b+x.c*w+x.tx:b,o.matrix?x.b*b+x.d*w+x.ty:w);for(var R=0;R<e.length;R+=2)r.push(e[R],e[R+1]),s.push(l++,h,l)}},Wl={build:function(o){var n=o.shape,e=n.x,r=n.y,s=n.width,l=n.height,h=o.points;h.length=0,h.push(e,r,e+s,r,e+s,r+l,e,r+l)},triangulate:function(o,n){var e=o.points,r=n.points,s=r.length/2;r.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),n.indices.push(s,s+1,s+2,s+1,s+2,s+3)}};function Ku(o,n,e){return o+(n-o)*e}function Uh(o,n,e,r,s,l,h){h===void 0&&(h=[]);for(var m=h,x=0,b=0,w=0,R=0,U=0,B=0,j=0,K=0;j<=20;++j)x=Ku(o,e,K=j/20),b=Ku(n,r,K),w=Ku(e,s,K),R=Ku(r,l,K),U=Ku(x,w,K),B=Ku(b,R,K),m.push(U,B);return m}var Cd={build:function(o){var n=o.shape,e=o.points,r=n.x,s=n.y,l=n.width,h=n.height,m=Math.max(0,Math.min(n.radius,Math.min(l,h)/2));e.length=0,m?(Uh(r,s+m,r,s,r+m,s,e),Uh(r+l-m,s,r+l,s,r+l,s+m,e),Uh(r+l,s+h-m,r+l,s+h,r+l-m,s+h,e),Uh(r+m,s+h,r,s+h,r,s+h-m,e)):e.push(r,s,r+l,s,r+l,s+h,r,s+h)},triangulate:function(o,n){for(var e=o.points,r=n.points,s=n.indices,l=r.length/2,h=jr()(e,null,2),m=0,x=h.length;m<x;m+=3)s.push(h[m]+l),s.push(h[m+1]+l),s.push(h[m+2]+l);for(m=0,x=e.length;m<x;m++)r.push(e[m],e[++m])}};function Rd(o,n,e,r,s,l,h,m){var x,b;h?(x=r,b=-e):(x=-r,b=e);var w=o-e*s+x,R=n-r*s+b,U=o+e*l+x,B=n+r*l+b;return m.push(w,R),m.push(U,B),2}function Xl(o,n,e,r,s,l,h,m){var x=e-o,b=r-n,w=Math.atan2(x,b),R=Math.atan2(s-o,l-n);m&&w<R?w+=2*Math.PI:!m&&w>R&&(R+=2*Math.PI);var U=w,B=R-w,j=Math.abs(B),K=Math.sqrt(x*x+b*b),ut=1+(15*j*Math.sqrt(K)/Math.PI>>0),gt=B/ut;if(U+=gt,m){h.push(o,n),h.push(e,r);for(var Rt=1,Le=U;Rt<ut;Rt++,Le+=gt)h.push(o,n),h.push(o+Math.sin(Le)*K,n+Math.cos(Le)*K);h.push(o,n),h.push(s,l)}else{for(h.push(e,r),h.push(o,n),Rt=1,Le=U;Rt<ut;Rt++,Le+=gt)h.push(o+Math.sin(Le)*K,n+Math.cos(Le)*K),h.push(o,n);h.push(s,l),h.push(o,n)}return 2*ut}function kh(o,n){o.lineStyle.native?function(e,r){var s=0,l=e.shape,h=e.points||l.points,m=l.type!==_i.POLY||l.closeStroke;if(h.length!==0){var x=r.points,b=r.indices,w=h.length/2,R=x.length/2,U=R;for(x.push(h[0],h[1]),s=1;s<w;s++)x.push(h[2*s],h[2*s+1]),b.push(U,U+1),U++;m&&b.push(U,R)}}(o,n):function(e,r){var s=e.shape,l=e.points||s.points.slice(),h=r.closePointEps;if(l.length!==0){var m=e.lineStyle,x=new ai(l[0],l[1]),b=new ai(l[l.length-2],l[l.length-1]),w=s.type!==_i.POLY||s.closeStroke,R=Math.abs(x.x-b.x)<h&&Math.abs(x.y-b.y)<h;if(w){l=l.slice(),R&&(l.pop(),l.pop(),b.set(l[l.length-2],l[l.length-1]));var U=.5*(x.x+b.x),B=.5*(b.y+x.y);l.unshift(U,B),l.push(U,B)}var j=r.points,K=l.length/2,ut=l.length,gt=j.length/2,Rt=m.width/2,Le=Rt*Rt,en=m.miterLimit*m.miterLimit,At=l[0],oe=l[1],qt=l[2],ne=l[3],Je=0,Pe=0,$t=-(oe-ne),Ee=At-qt,hn=0,Ve=0,He=Math.sqrt($t*$t+Ee*Ee);$t/=He,Ee/=He,$t*=Rt,Ee*=Rt;var cn=m.alignment,Be=2*(1-cn),me=2*cn;w||(m.cap===er.ROUND?ut+=Xl(At-$t*(Be-me)*.5,oe-Ee*(Be-me)*.5,At-$t*Be,oe-Ee*Be,At+$t*me,oe+Ee*me,j,!0)+2:m.cap===er.SQUARE&&(ut+=Rd(At,oe,$t,Ee,Be,me,!0,j))),j.push(At-$t*Be,oe-Ee*Be),j.push(At+$t*me,oe+Ee*me);for(var sn=1;sn<K-1;++sn){At=l[2*(sn-1)],oe=l[2*(sn-1)+1],qt=l[2*sn],ne=l[2*sn+1],Je=l[2*(sn+1)],Pe=l[2*(sn+1)+1],$t=-(oe-ne),Ee=At-qt,$t/=He=Math.sqrt($t*$t+Ee*Ee),Ee/=He,$t*=Rt,Ee*=Rt,hn=-(ne-Pe),Ve=qt-Je,hn/=He=Math.sqrt(hn*hn+Ve*Ve),Ve/=He,hn*=Rt,Ve*=Rt;var Bn=qt-At,tr=oe-ne,br=qt-Je,nr=Pe-ne,gr=tr*br-nr*Bn,Qr=gr<0;if(Math.abs(gr)<.1)j.push(qt-$t*Be,ne-Ee*Be),j.push(qt+$t*me,ne+Ee*me);else{var qr=(-$t+At)*(-Ee+ne)-(-$t+qt)*(-Ee+oe),Zr=(-hn+Je)*(-Ve+ne)-(-hn+qt)*(-Ve+Pe),Vi=(Bn*Zr-br*qr)/gr,Jn=(nr*qr-tr*Zr)/gr,ti=(Vi-qt)*(Vi-qt)+(Jn-ne)*(Jn-ne),Wr=qt+(Vi-qt)*Be,ir=ne+(Jn-ne)*Be,Yn=qt-(Vi-qt)*me,Wi=ne-(Jn-ne)*me,Ta=Qr?Be:me;ti<=Math.min(Bn*Bn+tr*tr,br*br+nr*nr)+Ta*Ta*Le?m.join===mo.BEVEL||ti/Le>en?(Qr?(j.push(Wr,ir),j.push(qt+$t*me,ne+Ee*me),j.push(Wr,ir),j.push(qt+hn*me,ne+Ve*me)):(j.push(qt-$t*Be,ne-Ee*Be),j.push(Yn,Wi),j.push(qt-hn*Be,ne-Ve*Be),j.push(Yn,Wi)),ut+=2):m.join===mo.ROUND?Qr?(j.push(Wr,ir),j.push(qt+$t*me,ne+Ee*me),ut+=Xl(qt,ne,qt+$t*me,ne+Ee*me,qt+hn*me,ne+Ve*me,j,!0)+4,j.push(Wr,ir),j.push(qt+hn*me,ne+Ve*me)):(j.push(qt-$t*Be,ne-Ee*Be),j.push(Yn,Wi),ut+=Xl(qt,ne,qt-$t*Be,ne-Ee*Be,qt-hn*Be,ne-Ve*Be,j,!1)+4,j.push(qt-hn*Be,ne-Ve*Be),j.push(Yn,Wi)):(j.push(Wr,ir),j.push(Yn,Wi)):(j.push(qt-$t*Be,ne-Ee*Be),j.push(qt+$t*me,ne+Ee*me),m.join===mo.BEVEL||ti/Le>en||(m.join===mo.ROUND?ut+=Qr?Xl(qt,ne,qt+$t*me,ne+Ee*me,qt+hn*me,ne+Ve*me,j,!0)+2:Xl(qt,ne,qt-$t*Be,ne-Ee*Be,qt-hn*Be,ne-Ve*Be,j,!1)+2:(Qr?(j.push(Yn,Wi),j.push(Yn,Wi)):(j.push(Wr,ir),j.push(Wr,ir)),ut+=2)),j.push(qt-hn*Be,ne-Ve*Be),j.push(qt+hn*me,ne+Ve*me),ut+=2)}}At=l[2*(K-2)],oe=l[2*(K-2)+1],qt=l[2*(K-1)],$t=-(oe-(ne=l[2*(K-1)+1])),Ee=At-qt,$t/=He=Math.sqrt($t*$t+Ee*Ee),Ee/=He,$t*=Rt,Ee*=Rt,j.push(qt-$t*Be,ne-Ee*Be),j.push(qt+$t*me,ne+Ee*me),w||(m.cap===er.ROUND?ut+=Xl(qt-$t*(Be-me)*.5,ne-Ee*(Be-me)*.5,qt-$t*Be,ne-Ee*Be,qt+$t*me,ne+Ee*me,j,!1)+2:m.cap===er.SQUARE&&(ut+=Rd(qt,ne,$t,Ee,Be,me,!1,j)));var dc=r.indices,yp=Vl.epsilon*Vl.epsilon;for(sn=gt;sn<ut+gt-2;++sn)At=j[2*sn],oe=j[2*sn+1],qt=j[2*(sn+1)],ne=j[2*(sn+1)+1],Je=j[2*(sn+2)],Pe=j[2*(sn+2)+1],Math.abs(At*(ne-Pe)+qt*(Pe-oe)+Je*(oe-ne))<yp||dc.push(sn,sn+1,sn+2)}}(o,n)}var Ga,Ha=function(){function o(){}return o.curveTo=function(n,e,r,s,l,h){var m=h[h.length-2],x=h[h.length-1]-e,b=m-n,w=s-e,R=r-n,U=Math.abs(x*R-b*w);if(U<1e-8||l===0)return h[h.length-2]===n&&h[h.length-1]===e||h.push(n,e),null;var B=x*x+b*b,j=w*w+R*R,K=x*w+b*R,ut=l*Math.sqrt(B)/U,gt=l*Math.sqrt(j)/U,Rt=ut*K/B,Le=gt*K/j,en=ut*R+gt*b,At=ut*w+gt*x,oe=b*(gt+Rt),qt=x*(gt+Rt),ne=R*(ut+Le),Je=w*(ut+Le);return{cx:en+n,cy:At+e,radius:l,startAngle:Math.atan2(qt-At,oe-en),endAngle:Math.atan2(Je-At,ne-en),anticlockwise:b*w>R*x}},o.arc=function(n,e,r,s,l,h,m,x,b){for(var w=m-h,R=Vl._segmentsCount(Math.abs(w)*l,40*Math.ceil(Math.abs(w)/Uu)),U=w/(2*R),B=2*U,j=Math.cos(U),K=Math.sin(U),ut=R-1,gt=ut%1/ut,Rt=0;Rt<=ut;++Rt){var Le=U+h+B*(Rt+gt*Rt),en=Math.cos(Le),At=-Math.sin(Le);b.push((j*en+K*At)*l+r,(j*-At+K*en)*l+s)}},o}(),Gh=function(){function o(){}return o.curveLength=function(n,e,r,s,l,h,m,x){for(var b=0,w=0,R=0,U=0,B=0,j=0,K=0,ut=0,gt=0,Rt=0,Le=0,en=n,At=e,oe=1;oe<=10;++oe)Rt=en-(ut=(K=(j=(B=1-(w=oe/10))*B)*B)*n+3*j*w*r+3*B*(R=w*w)*l+(U=R*w)*m),Le=At-(gt=K*e+3*j*w*s+3*B*R*h+U*x),en=ut,At=gt,b+=Math.sqrt(Rt*Rt+Le*Le);return b},o.curveTo=function(n,e,r,s,l,h,m){var x=m[m.length-2],b=m[m.length-1];m.length-=2;var w=Vl._segmentsCount(o.curveLength(x,b,n,e,r,s,l,h)),R=0,U=0,B=0,j=0,K=0;m.push(x,b);for(var ut=1,gt=0;ut<=w;++ut)B=(U=(R=1-(gt=ut/w))*R)*R,K=(j=gt*gt)*gt,m.push(B*x+3*U*gt*n+3*R*j*r+K*l,B*b+3*U*gt*e+3*R*j*s+K*h)},o}(),Id=function(){function o(){}return o.curveLength=function(n,e,r,s,l,h){var m=n-2*r+l,x=e-2*s+h,b=2*r-2*n,w=2*s-2*e,R=4*(m*m+x*x),U=4*(m*b+x*w),B=b*b+w*w,j=2*Math.sqrt(R+U+B),K=Math.sqrt(R),ut=2*R*K,gt=2*Math.sqrt(B),Rt=U/K;return(ut*j+K*U*(j-gt)+(4*B*R-U*U)*Math.log((2*K+Rt+j)/(Rt+gt)))/(4*ut)},o.curveTo=function(n,e,r,s,l){for(var h=l[l.length-2],m=l[l.length-1],x=Vl._segmentsCount(o.curveLength(h,m,n,e,r,s)),b=0,w=0,R=1;R<=x;++R){var U=R/x;b=h+(n-h)*U,w=m+(e-m)*U,l.push(b+(n+(r-n)*U-b)*U,w+(e+(s-e)*U-w)*U)}},o}(),Ld=function(){function o(){this.reset()}return o.prototype.begin=function(n,e,r){this.reset(),this.style=n,this.start=e,this.attribStart=r},o.prototype.end=function(n,e){this.attribSize=e-this.attribStart,this.size=n-this.start},o.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},o}(),Tu=((Ga={})[_i.POLY]=Bh,Ga[_i.CIRC]=Pd,Ga[_i.ELIP]=Pd,Ga[_i.RECT]=Wl,Ga[_i.RREC]=Cd,Ga),Hh=[],Ho=[],fa=function(){function o(n,e,r,s){e===void 0&&(e=null),r===void 0&&(r=null),s===void 0&&(s=null),this.shape=n,this.lineStyle=r,this.fillStyle=e,this.matrix=s,this.type=n.type,this.points=[],this.holes=[]}return o.prototype.clone=function(){return new o(this.shape,this.fillStyle,this.lineStyle,this.matrix)},o.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},o}(),Su=new ai,Ep=new ru,Qu=function(o){function n(){var e=o.call(this)||this;return e.uvsFloat32=null,e.indicesUint16=null,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.dirty=0,e.batchDirty=-1,e.cacheDirty=-1,e.clearDirty=0,e.drawCalls=[],e.batches=[],e.shapeIndex=0,e._bounds=new ru,e.boundsDirty=-1,e.boundsPadding=0,e.batchable=!1,e.indicesUint16=null,e.uvsFloat32=null,e.closePointEps=1e-4,e}return Fh(n,o),Object.defineProperty(n.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),n.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Ho.push(this.drawCalls[e]);for(this.drawCalls.length=0,e=0;e<this.batches.length;e++){var r=this.batches[e];r.reset(),Hh.push(r)}this.batches.length=0},n.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},n.prototype.drawShape=function(e,r,s,l){r===void 0&&(r=null),s===void 0&&(s=null),l===void 0&&(l=null);var h=new fa(e,r,s,l);return this.graphicsData.push(h),this.dirty++,this},n.prototype.drawHole=function(e,r){if(r===void 0&&(r=null),!this.graphicsData.length)return null;var s=new fa(e,null,null,r),l=this.graphicsData[this.graphicsData.length-1];return s.lineStyle=l.lineStyle,l.holes.push(s),this.dirty++,this},n.prototype.destroy=function(){o.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},n.prototype.containsPoint=function(e){for(var r=this.graphicsData,s=0;s<r.length;++s){var l=r[s];if(l.fillStyle.visible&&l.shape&&(l.matrix?l.matrix.applyInverse(e,Su):Su.copyFrom(e),l.shape.contains(Su.x,Su.y))){var h=!1;if(l.holes){for(var m=0;m<l.holes.length;m++)if(l.holes[m].shape.contains(Su.x,Su.y)){h=!0;break}}if(!h)return!0}}return!1},n.prototype.updateBatches=function(e){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var r=this.uvs,s=this.graphicsData,l=null,h=null;this.batches.length>0&&(h=(l=this.batches[this.batches.length-1]).style);for(var m=this.shapeIndex;m<s.length;m++){this.shapeIndex++;var x=s[m],b=x.fillStyle,w=x.lineStyle;Tu[x.type].build(x),x.matrix&&this.transformPoints(x.points,x.matrix);for(var R=0;R<2;R++){var U=R===0?b:w;if(U.visible){var B=U.texture.baseTexture,j=this.indices.length,K=this.points.length/2;B.wrapMode=Lt.REPEAT,R===0?this.processFill(x):this.processLine(x);var ut=this.points.length/2-K;ut!==0&&(l&&!this._compareStyles(h,U)&&(l.end(j,K),l=null),l||((l=Hh.pop()||new Ld).begin(U,j,K),this.batches.push(l),h=U),this.addUvs(this.points,r,U.texture,K,ut,U.matrix))}}}var gt=this.indices.length,Rt=this.points.length/2;if(l&&l.end(gt,Rt),this.batches.length!==0){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var Le=Rt>65535&&e;this.indicesUint16=Le?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},n.prototype._compareStyles=function(e,r){return!(!e||!r)&&e.texture.baseTexture===r.texture.baseTexture&&e.color+e.alpha===r.color+r.alpha&&!!e.native==!!r.native},n.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,r=this.graphicsData.length;e<r;e++){var s=this.graphicsData[e],l=s.fillStyle,h=s.lineStyle;if(l&&!l.texture.baseTexture.valid||h&&!h.texture.baseTexture.valid)return!1}return!0},n.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,r=0,s=e.length;r<s;r++)for(var l=e[r],h=0;h<l.size;h++){var m=l.start+h;this.indicesUint16[m]=this.indicesUint16[m]-l.attribStart}},n.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var e=this.batches,r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<2*n.BATCHABLE_SIZE},n.prototype.buildDrawCalls=function(){for(var e=++fr._globalBatch,r=0;r<this.drawCalls.length;r++)this.drawCalls[r].texArray.clear(),Ho.push(this.drawCalls[r]);this.drawCalls.length=0;var s=this.colors,l=this.textureIds,h=Ho.pop();h||((h=new gu).texArray=new Ul),h.texArray.count=0,h.start=0,h.size=0,h.type=so.TRIANGLES;var m=0,x=null,b=0,w=!1,R=so.TRIANGLES,U=0;for(this.drawCalls.push(h),r=0;r<this.batches.length;r++){var B=this.batches[r],j=B.style,K=j.texture.baseTexture;w!==!!j.native&&(R=(w=!!j.native)?so.LINES:so.TRIANGLES,x=null,m=8,e++),x!==K&&(x=K,K._batchEnabled!==e&&(m===8&&(e++,m=0,h.size>0&&((h=Ho.pop())||((h=new gu).texArray=new Ul),this.drawCalls.push(h)),h.start=U,h.size=0,h.texArray.count=0,h.type=R),K.touched=1,K._batchEnabled=e,K._batchLocation=m,K.wrapMode=Lt.REPEAT,h.texArray.elements[h.texArray.count++]=K,m++)),h.size+=B.size,U+=B.size,b=K._batchLocation,this.addColors(s,j.color,j.alpha,B.attribSize),this.addTextureIds(l,b,B.attribSize)}fr._globalBatch=e,this.packAttributes()},n.prototype.packAttributes=function(){for(var e=this.points,r=this.uvs,s=this.colors,l=this.textureIds,h=new ArrayBuffer(3*e.length*4),m=new Float32Array(h),x=new Uint32Array(h),b=0,w=0;w<e.length/2;w++)m[b++]=e[2*w],m[b++]=e[2*w+1],m[b++]=r[2*w],m[b++]=r[2*w+1],x[b++]=s[w],m[b++]=l[w];this._buffer.update(h),this._indexBuffer.update(this.indicesUint16)},n.prototype.processFill=function(e){e.holes.length?(this.processHoles(e.holes),Bh.triangulate(e,this)):Tu[e.type].triangulate(e,this)},n.prototype.processLine=function(e){kh(e,this);for(var r=0;r<e.holes.length;r++)kh(e.holes[r],this)},n.prototype.processHoles=function(e){for(var r=0;r<e.length;r++){var s=e[r];Tu[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix)}},n.prototype.calculateBounds=function(){var e=this._bounds,r=Ep,s=yi.IDENTITY;this._bounds.clear(),r.clear();for(var l=0;l<this.graphicsData.length;l++){var h=this.graphicsData[l],m=h.shape,x=h.type,b=h.lineStyle,w=h.matrix||yi.IDENTITY,R=0;if(b&&b.visible){var U=b.alignment;R=b.width,x===_i.POLY?R*=.5+Math.abs(.5-U):R*=Math.max(0,U)}if(s!==w&&(r.isEmpty()||(e.addBoundsMatrix(r,s),r.clear()),s=w),x===_i.RECT||x===_i.RREC){var B=m;r.addFramePad(B.x,B.y,B.x+B.width,B.y+B.height,R,R)}else if(x===_i.CIRC){var j=m;r.addFramePad(j.x,j.y,j.x,j.y,j.radius+R,j.radius+R)}else if(x===_i.ELIP){var K=m;r.addFramePad(K.x,K.y,K.x,K.y,K.width+R,K.height+R)}else{var ut=m;e.addVerticesMatrix(s,ut.points,0,ut.points.length,R,R)}}r.isEmpty()||e.addBoundsMatrix(r,s),e.pad(this.boundsPadding,this.boundsPadding)},n.prototype.transformPoints=function(e,r){for(var s=0;s<e.length/2;s++){var l=e[2*s],h=e[2*s+1];e[2*s]=r.a*l+r.c*h+r.tx,e[2*s+1]=r.b*l+r.d*h+r.ty}},n.prototype.addColors=function(e,r,s,l){for(var h=Rn((r>>16)+(65280&r)+((255&r)<<16),s);l-- >0;)e.push(h)},n.prototype.addTextureIds=function(e,r,s){for(;s-- >0;)e.push(r)},n.prototype.addUvs=function(e,r,s,l,h,m){m===void 0&&(m=null);for(var x=0,b=r.length,w=s.frame;x<h;){var R=e[2*(l+x)],U=e[2*(l+x)+1];if(m){var B=m.a*R+m.c*U+m.tx;U=m.b*R+m.d*U+m.ty,R=B}x++,r.push(R/w.width,U/w.height)}var j=s.baseTexture;(w.width<j.width||w.height<j.height)&&this.adjustUvs(r,s,b,h)},n.prototype.adjustUvs=function(e,r,s,l){for(var h=r.baseTexture,m=1e-6,x=s+2*l,b=r.frame,w=b.width/h.width,R=b.height/h.height,U=b.x/b.width,B=b.y/b.height,j=Math.floor(e[s]+m),K=Math.floor(e[s+1]+m),ut=s+2;ut<x;ut+=2)j=Math.min(j,Math.floor(e[ut]+m)),K=Math.min(K,Math.floor(e[ut+1]+m));for(U-=j,B-=K,ut=s;ut<x;ut+=2)e[ut]=(e[ut]+U)*w,e[ut+1]=(e[ut+1]+B)*R},n.BATCHABLE_SIZE=100,n}(kl),Po=function(o){function n(){var e=o!==null&&o.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=er.BUTT,e.join=mo.MITER,e.miterLimit=10,e}return Fh(n,o),n.prototype.clone=function(){var e=new n;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e},n.prototype.reset=function(){o.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},n}(Ys),go=new Float32Array(3),zh={},vs=function(o){function n(e){e===void 0&&(e=null);var r=o.call(this)||this;return r._geometry=e||new Qu,r._geometry.refCount++,r.shader=null,r.state=Da.for2d(),r._fillStyle=new Ys,r._lineStyle=new Po,r._matrix=null,r._holeMode=!1,r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r.pluginName="batch",r._transformID=-1,r.tint=16777215,r.blendMode=Ln.NORMAL,r}return Fh(n,o),Object.defineProperty(n.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),n.prototype.clone=function(){return this.finishPoly(),new n(this._geometry)},Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),n.prototype.lineStyle=function(e,r,s,l,h){return e===void 0&&(e=null),r===void 0&&(r=0),s===void 0&&(s=1),l===void 0&&(l=.5),h===void 0&&(h=!1),typeof e=="number"&&(e={width:e,color:r,alpha:s,alignment:l,native:h}),this.lineTextureStyle(e)},n.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:Dn.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:er.BUTT,join:mo.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this},n.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new tu,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[r-2],e[r-1]))}else this.currentPath=new tu,this.currentPath.closeStroke=!1},n.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},n.prototype.moveTo=function(e,r){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=r,this},n.prototype.lineTo=function(e,r){this.currentPath||this.moveTo(0,0);var s=this.currentPath.points,l=s[s.length-2],h=s[s.length-1];return l===e&&h===r||s.push(e,r),this},n.prototype._initCurve=function(e,r){e===void 0&&(e=0),r===void 0&&(r=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,r]):this.moveTo(e,r)},n.prototype.quadraticCurveTo=function(e,r,s,l){this._initCurve();var h=this.currentPath.points;return h.length===0&&this.moveTo(0,0),Id.curveTo(e,r,s,l,h),this},n.prototype.bezierCurveTo=function(e,r,s,l,h,m){return this._initCurve(),Gh.curveTo(e,r,s,l,h,m,this.currentPath.points),this},n.prototype.arcTo=function(e,r,s,l,h){this._initCurve(e,r);var m=this.currentPath.points,x=Ha.curveTo(e,r,s,l,h,m);if(x){var b=x.cx,w=x.cy,R=x.radius,U=x.startAngle,B=x.endAngle,j=x.anticlockwise;this.arc(b,w,R,U,B,j)}return this},n.prototype.arc=function(e,r,s,l,h,m){if(m===void 0&&(m=!1),l===h)return this;if(!m&&h<=l?h+=Uu:m&&l<=h&&(l+=Uu),h-l==0)return this;var x=e+Math.cos(l)*s,b=r+Math.sin(l)*s,w=this._geometry.closePointEps,R=this.currentPath?this.currentPath.points:null;if(R){var U=Math.abs(R[R.length-2]-x),B=Math.abs(R[R.length-1]-b);U<w&&B<w||R.push(x,b)}else this.moveTo(x,b),R=this.currentPath.points;return Ha.arc(x,b,e,r,s,l,h,m,R),this},n.prototype.beginFill=function(e,r){return e===void 0&&(e=0),r===void 0&&(r=1),this.beginTextureFill({texture:Dn.WHITE,color:e,alpha:r})},n.prototype.beginTextureFill=function(e){e=Object.assign({texture:Dn.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this},n.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},n.prototype.drawRect=function(e,r,s,l){return this.drawShape(new dr(e,r,s,l))},n.prototype.drawRoundedRect=function(e,r,s,l,h){return this.drawShape(new mc(e,r,s,l,h))},n.prototype.drawCircle=function(e,r,s){return this.drawShape(new ei(e,r,s))},n.prototype.drawEllipse=function(e,r,s,l){return this.drawShape(new ra(e,r,s,l))},n.prototype.drawPolygon=function(){for(var e,r=arguments,s=[],l=0;l<arguments.length;l++)s[l]=r[l];var h=!0,m=s[0];m.points?(h=m.closeStroke,e=m.points):e=Array.isArray(s[0])?s[0]:s;var x=new tu(e);return x.closeStroke=h,this.drawShape(x),this},n.prototype.drawShape=function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},n.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},n.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return!(e.length!==1||e[0].shape.type!==_i.RECT||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)},n.prototype._render=function(e){this.finishPoly();var r=this._geometry,s=e.context.supports.uint32Indices;r.updateBatches(s),r.batchable?(this.batchDirty!==r.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},n.prototype._populateBatches=function(){var e=this._geometry,r=this.blendMode,s=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=s,this.vertexData=new Float32Array(e.points);for(var l=0;l<s;l++){var h=e.batches[l],m=h.style.color,x=new Float32Array(this.vertexData.buffer,4*h.attribStart*2,2*h.attribSize),b=new Float32Array(e.uvsFloat32.buffer,4*h.attribStart*2,2*h.attribSize),w={vertexData:x,blendMode:r,indices:new Uint16Array(e.indicesUint16.buffer,2*h.start,h.size),uvs:b,_batchRGB:Yo(m),_tintRGB:m,_texture:h.style.texture,alpha:h.style.alpha,worldAlpha:1};this.batches[l]=w}},n.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var r=0,s=this.batches.length;r<s;r++){var l=this.batches[r];l.worldAlpha=this.worldAlpha*l.alpha,e.plugins[this.pluginName].render(l)}}},n.prototype._renderDirect=function(e){var r=this._resolveDirectShader(e),s=this._geometry,l=this.tint,h=this.worldAlpha,m=r.uniforms,x=s.drawCalls;m.translationMatrix=this.transform.worldTransform,m.tint[0]=(l>>16&255)/255*h,m.tint[1]=(l>>8&255)/255*h,m.tint[2]=(255&l)/255*h,m.tint[3]=h,e.shader.bind(r),e.geometry.bind(s,r),e.state.set(this.state);for(var b=0,w=x.length;b<w;b++)this._renderDrawCallDirect(e,s.drawCalls[b])},n.prototype._renderDrawCallDirect=function(e,r){for(var s=r.texArray,l=r.type,h=r.size,m=r.start,x=s.count,b=0;b<x;b++)e.texture.bind(s.elements[b],b);e.geometry.draw(l,h,m)},n.prototype._resolveDirectShader=function(e){var r=this.shader,s=this.pluginName;if(!r){if(!zh[s]){for(var l=e.plugins.batch.MAX_TEXTURES,h=new Int32Array(l),m=0;m<l;m++)h[m]=m;var x={tint:new Float32Array([1,1,1,1]),translationMatrix:new yi,default:uo.from({uSamplers:h},!0)},b=e.plugins[s]._shader.program;zh[s]=new Oa(b,x)}r=zh[s]}return r},n.prototype._calculateBounds=function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var r=e.bounds,s=r.minX,l=r.minY,h=r.maxX,m=r.maxY;this._bounds.addFrame(this.transform,s,l,h,m)}},n.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,n._TEMP_POINT),this._geometry.containsPoint(n._TEMP_POINT)},n.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=Yo(this.tint,go),r=0;r<this.batches.length;r++){var s=this.batches[r],l=s._batchRGB,h=(e[0]*l[0]*255<<16)+(e[1]*l[1]*255<<8)+(0|e[2]*l[2]*255);s._tintRGB=(h>>16)+(65280&h)+((255&h)<<16)}}},n.prototype.calculateVertices=function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var r=this.transform.worldTransform,s=r.a,l=r.b,h=r.c,m=r.d,x=r.tx,b=r.ty,w=this._geometry.points,R=this.vertexData,U=0,B=0;B<w.length;B+=2){var j=w[B],K=w[B+1];R[U++]=s*j+h*K+x,R[U++]=m*K+l*j+b}}},n.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0),this},n.prototype.setMatrix=function(e){return this._matrix=e,this},n.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},n.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},n.prototype.destroy=function(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,o.prototype.destroy.call(this,e)},n._TEMP_POINT=new ai,n}(Ci),Mp={buildPoly:Bh,buildCircle:Pd,buildRectangle:Wl,buildRoundedRectangle:Cd,buildLine:kh,ArcUtils:Ha,BezierUtils:Gh,QuadraticUtils:Id,BatchPart:Ld,FILL_COMMANDS:Tu,BATCH_POOL:Hh,DRAW_CALL_POOL:Ho},Ap=function(o,n){return(Ap=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Yl,jh=new ai,Fs=new Uint16Array([0,1,2,0,2,3]),li=function(o){function n(e){var r=o.call(this)||this;return r._anchor=new eu(r._onAnchorUpdate,r,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=Ln.NORMAL,r._cachedTint=16777215,r.uvs=null,r.texture=e||Dn.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.indices=Fs,r.pluginName="batch",r.isSprite=!0,r._roundPixels=ie.ROUND_PIXELS,r}return function(e,r){function s(){this.constructor=e}Ap(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Fr(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Fr(this.scale.y)*this._height/this._texture.orig.height)},n.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},n.prototype.calculateVertices=function(){var e=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==e._updateID){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var r=this.transform.worldTransform,s=r.a,l=r.b,h=r.c,m=r.d,x=r.tx,b=r.ty,w=this.vertexData,R=e.trim,U=e.orig,B=this._anchor,j=0,K=0,ut=0,gt=0;if(R?(j=(K=R.x-B._x*U.width)+R.width,ut=(gt=R.y-B._y*U.height)+R.height):(j=(K=-B._x*U.width)+U.width,ut=(gt=-B._y*U.height)+U.height),w[0]=s*K+h*gt+x,w[1]=m*gt+l*K+b,w[2]=s*j+h*gt+x,w[3]=m*gt+l*j+b,w[4]=s*j+h*ut+x,w[5]=m*ut+l*j+b,w[6]=s*K+h*ut+x,w[7]=m*ut+l*K+b,this._roundPixels)for(var Rt=ie.RESOLUTION,Le=0;Le<w.length;++Le)w[Le]=Math.round((w[Le]*Rt|0)/Rt)}},n.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,r=this.vertexTrimmedData,s=e.orig,l=this._anchor,h=this.transform.worldTransform,m=h.a,x=h.b,b=h.c,w=h.d,R=h.tx,U=h.ty,B=-l._x*s.width,j=B+s.width,K=-l._y*s.height,ut=K+s.height;r[0]=m*B+b*K+R,r[1]=w*K+x*B+U,r[2]=m*j+b*K+R,r[3]=w*K+x*j+U,r[4]=m*j+b*ut+R,r[5]=w*ut+x*j+U,r[6]=m*B+b*ut+R,r[7]=w*ut+x*B+U},n.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},n.prototype._calculateBounds=function(){var e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},n.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new dr),e=this._localBoundsRect),this._bounds.getRectangle(e)):o.prototype.getLocalBounds.call(this,e)},n.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,jh);var r=this._texture.orig.width,s=this._texture.orig.height,l=-r*this.anchor.x,h=0;return jh.x>=l&&jh.x<l+r&&(h=-s*this.anchor.y,jh.y>=h&&jh.y<h+s)},n.prototype.destroy=function(e){if(o.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e&&e.texture){var r=typeof e=="boolean"?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null},n.from=function(e,r){return new n(e instanceof Dn?e:Dn.from(e,r))},Object.defineProperty(n.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var r=Fr(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var r=Fr(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Dn.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),n}(Ci),Od=function(o,n){return(Od=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};(function(o){o[o.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",o[o.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(Yl||(Yl={}));var Dd={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Yl.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Nd=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],tl=function(){function o(n){this.styleID=0,this.reset(),Vh(this,n,n)}return o.prototype.clone=function(){var n={};return Vh(n,this,Dd),new o(n)},o.prototype.reset=function(){Vh(this,Dd,Dd)},Object.defineProperty(o.prototype,"align",{get:function(){return this._align},set:function(n){this._align!==n&&(this._align=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"breakWords",{get:function(){return this._breakWords},set:function(n){this._breakWords!==n&&(this._breakWords=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(n){this._dropShadow!==n&&(this._dropShadow=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(n){this._dropShadowAlpha!==n&&(this._dropShadowAlpha=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(n){this._dropShadowAngle!==n&&(this._dropShadowAngle=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(n){this._dropShadowBlur!==n&&(this._dropShadowBlur=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(n){var e=Fd(n);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(n){this._dropShadowDistance!==n&&(this._dropShadowDistance=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fill",{get:function(){return this._fill},set:function(n){var e=Fd(n);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(n){this._fillGradientType!==n&&(this._fillGradientType=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(n){(function(e,r){if(!Array.isArray(e)||!Array.isArray(r)||e.length!==r.length)return!1;for(var s=0;s<e.length;++s)if(e[s]!==r[s])return!1;return!0})(this._fillGradientStops,n)||(this._fillGradientStops=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(n){this.fontFamily!==n&&(this._fontFamily=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontSize",{get:function(){return this._fontSize},set:function(n){this._fontSize!==n&&(this._fontSize=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(n){this._fontStyle!==n&&(this._fontStyle=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(n){this._fontVariant!==n&&(this._fontVariant=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(n){this._fontWeight!==n&&(this._fontWeight=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(n){this._letterSpacing!==n&&(this._letterSpacing=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(n){this._lineHeight!==n&&(this._lineHeight=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"leading",{get:function(){return this._leading},set:function(n){this._leading!==n&&(this._leading=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(n){this._lineJoin!==n&&(this._lineJoin=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(n){this._miterLimit!==n&&(this._miterLimit=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"padding",{get:function(){return this._padding},set:function(n){this._padding!==n&&(this._padding=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"stroke",{get:function(){return this._stroke},set:function(n){var e=Fd(n);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(n){this._strokeThickness!==n&&(this._strokeThickness=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(n){this._textBaseline!==n&&(this._textBaseline=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"trim",{get:function(){return this._trim},set:function(n){this._trim!==n&&(this._trim=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(n){this._whiteSpace!==n&&(this._whiteSpace=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(n){this._wordWrap!==n&&(this._wordWrap=n,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(n){this._wordWrapWidth!==n&&(this._wordWrapWidth=n,this.styleID++)},enumerable:!1,configurable:!0}),o.prototype.toFontString=function(){var n=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;r>=0;r--){var s=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&Nd.indexOf(s)<0&&(s='"'+s+'"'),e[r]=s}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+n+" "+e.join(",")},o}();function Pp(o){return typeof o=="number"?jt(o):(typeof o=="string"&&o.indexOf("0x")===0&&(o=o.replace("0x","#")),o)}function Fd(o){if(Array.isArray(o)){for(var n=0;n<o.length;++n)o[n]=Pp(o[n]);return o}return Pp(o)}function Vh(o,n,e){for(var r in e)Array.isArray(n[r])?o[r]=n[r].slice():o[r]=n[r]}var Ko=function(){function o(n,e,r,s,l,h,m,x,b){this.text=n,this.style=e,this.width=r,this.height=s,this.lines=l,this.lineWidths=h,this.lineHeight=m,this.maxLineWidth=x,this.fontProperties=b}return o.measureText=function(n,e,r,s){s===void 0&&(s=o._canvas),r=r==null?e.wordWrap:r;var l=e.toFontString(),h=o.measureFont(l);h.fontSize===0&&(h.fontSize=e.fontSize,h.ascent=e.fontSize);var m=s.getContext("2d");m.font=l;for(var x=(r?o.wordWrap(n,e,s):n).split(/(?:\r\n|\r|\n)/),b=new Array(x.length),w=0,R=0;R<x.length;R++){var U=m.measureText(x[R]).width+(x[R].length-1)*e.letterSpacing;b[R]=U,w=Math.max(w,U)}var B=w+e.strokeThickness;e.dropShadow&&(B+=e.dropShadowDistance);var j=e.lineHeight||h.fontSize+e.strokeThickness,K=Math.max(j,h.fontSize+e.strokeThickness)+(x.length-1)*(j+e.leading);return e.dropShadow&&(K+=e.dropShadowDistance),new o(n,e,B,K,x,b,j+e.leading,w,h)},o.wordWrap=function(n,e,r){r===void 0&&(r=o._canvas);for(var s=r.getContext("2d"),l=0,h="",m="",x=Object.create(null),b=e.letterSpacing,w=e.whiteSpace,R=o.collapseSpaces(w),U=o.collapseNewlines(w),B=!R,j=e.wordWrapWidth+b,K=o.tokenize(n),ut=0;ut<K.length;ut++){var gt=K[ut];if(o.isNewline(gt)){if(!U){m+=o.addLine(h),B=!R,h="",l=0;continue}gt=" "}if(R){var Rt=o.isBreakingSpace(gt),Le=o.isBreakingSpace(h[h.length-1]);if(Rt&&Le)continue}var en=o.getFromCache(gt,b,x,s);if(en>j)if(h!==""&&(m+=o.addLine(h),h="",l=0),o.canBreakWords(gt,e.breakWords))for(var At=o.wordWrapSplit(gt),oe=0;oe<At.length;oe++){for(var qt=At[oe],ne=1;At[oe+ne];){var Je=At[oe+ne],Pe=qt[qt.length-1];if(o.canBreakChars(Pe,Je,gt,oe,e.breakWords))break;qt+=Je,ne++}oe+=qt.length-1;var $t=o.getFromCache(qt,b,x,s);$t+l>j&&(m+=o.addLine(h),B=!1,h="",l=0),h+=qt,l+=$t}else{h.length>0&&(m+=o.addLine(h),h="",l=0);var Ee=ut===K.length-1;m+=o.addLine(gt,!Ee),B=!1,h="",l=0}else en+l>j&&(B=!1,m+=o.addLine(h),h="",l=0),(h.length>0||!o.isBreakingSpace(gt)||B)&&(h+=gt,l+=en)}return m+=o.addLine(h,!1)},o.addLine=function(n,e){return e===void 0&&(e=!0),n=o.trimRight(n),n=e?n+`
`:n},o.getFromCache=function(n,e,r,s){var l=r[n];if(typeof l!="number"){var h=n.length*e;l=s.measureText(n).width+h,r[n]=l}return l},o.collapseSpaces=function(n){return n==="normal"||n==="pre-line"},o.collapseNewlines=function(n){return n==="normal"},o.trimRight=function(n){if(typeof n!="string")return"";for(var e=n.length-1;e>=0;e--){var r=n[e];if(!o.isBreakingSpace(r))break;n=n.slice(0,-1)}return n},o.isNewline=function(n){return typeof n=="string"&&o._newlines.indexOf(n.charCodeAt(0))>=0},o.isBreakingSpace=function(n,e){return typeof n=="string"&&o._breakingSpaces.indexOf(n.charCodeAt(0))>=0},o.tokenize=function(n){var e=[],r="";if(typeof n!="string")return e;for(var s=0;s<n.length;s++){var l=n[s],h=n[s+1];o.isBreakingSpace(l,h)||o.isNewline(l)?(r!==""&&(e.push(r),r=""),e.push(l)):r+=l}return r!==""&&e.push(r),e},o.canBreakWords=function(n,e){return e},o.canBreakChars=function(n,e,r,s,l){return!0},o.wordWrapSplit=function(n){return n.split("")},o.measureFont=function(n){if(o._fonts[n])return o._fonts[n];var e={ascent:0,descent:0,fontSize:0},r=o._canvas,s=o._context;s.font=n;var l=o.METRICS_STRING+o.BASELINE_SYMBOL,h=Math.ceil(s.measureText(l).width),m=Math.ceil(s.measureText(o.BASELINE_SYMBOL).width),x=Math.ceil(o.HEIGHT_MULTIPLIER*m);m=m*o.BASELINE_MULTIPLIER|0,r.width=h,r.height=x,s.fillStyle="#f00",s.fillRect(0,0,h,x),s.font=n,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(l,0,m);var b=s.getImageData(0,0,h,x).data,w=b.length,R=4*h,U=0,B=0,j=!1;for(U=0;U<m;++U){for(var K=0;K<R;K+=4)if(b[B+K]!==255){j=!0;break}if(j)break;B+=R}for(e.ascent=m-U,B=w-R,j=!1,U=x;U>m;--U){for(K=0;K<R;K+=4)if(b[B+K]!==255){j=!0;break}if(j)break;B-=R}return e.descent=U-m,e.fontSize=e.ascent+e.descent,o._fonts[n]=e,e},o.clearMetrics=function(n){n===void 0&&(n=""),n?delete o._fonts[n]:o._fonts={}},o}(),Lc=function(){try{var o=new OffscreenCanvas(0,0),n=o.getContext("2d");return n&&n.measureText?o:document.createElement("canvas")}catch{return document.createElement("canvas")}}();Lc.width=Lc.height=10,Ko._canvas=Lc,Ko._context=Lc.getContext("2d"),Ko._fonts={},Ko.METRICS_STRING="|\xC9q\xC5",Ko.BASELINE_SYMBOL="M",Ko.BASELINE_MULTIPLIER=1.4,Ko.HEIGHT_MULTIPLIER=2,Ko._newlines=[10,13],Ko._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var hf={texture:!0,children:!1,baseTexture:!0},Oc=function(o){function n(e,r,s){var l=this,h=!1;s||(s=document.createElement("canvas"),h=!0),s.width=3,s.height=3;var m=Dn.from(s);return m.orig=new dr,m.trim=new dr,(l=o.call(this,m)||this)._ownCanvas=h,l.canvas=s,l.context=l.canvas.getContext("2d"),l._resolution=ie.RESOLUTION,l._autoResolution=!0,l._text=null,l._style=null,l._styleListener=null,l._font="",l.text=e,l.style=r,l.localStyleID=-1,l}return function(e,r){function s(){this.constructor=e}Od(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype.updateText=function(e){var r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),this.dirty||!e){this._font=this._style.toFontString();var s,l,h=this.context,m=Ko.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),x=m.width,b=m.height,w=m.lines,R=m.lineHeight,U=m.lineWidths,B=m.maxLineWidth,j=m.fontProperties;this.canvas.width=Math.ceil((Math.max(1,x)+2*r.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,b)+2*r.padding)*this._resolution),h.scale(this._resolution,this._resolution),h.clearRect(0,0,this.canvas.width,this.canvas.height),h.font=this._font,h.lineWidth=r.strokeThickness,h.textBaseline=r.textBaseline,h.lineJoin=r.lineJoin,h.miterLimit=r.miterLimit;for(var K=r.dropShadow?2:1,ut=0;ut<K;++ut){var gt=r.dropShadow&&ut===0,Rt=gt?Math.ceil(Math.max(1,b)+2*r.padding):0,Le=Rt*this._resolution;if(gt){h.fillStyle="black",h.strokeStyle="black";var en=r.dropShadowColor,At=Yo(typeof en=="number"?en:Pt(en));h.shadowColor="rgba("+255*At[0]+","+255*At[1]+","+255*At[2]+","+r.dropShadowAlpha+")",h.shadowBlur=r.dropShadowBlur,h.shadowOffsetX=Math.cos(r.dropShadowAngle)*r.dropShadowDistance,h.shadowOffsetY=Math.sin(r.dropShadowAngle)*r.dropShadowDistance+Le}else h.fillStyle=this._generateFillStyle(r,w,m),h.strokeStyle=r.stroke,h.shadowColor="black",h.shadowBlur=0,h.shadowOffsetX=0,h.shadowOffsetY=0;var oe=(R-j.fontSize)/2;(!n.nextLineHeightBehavior||R-j.fontSize<0)&&(oe=0);for(var qt=0;qt<w.length;qt++)s=r.strokeThickness/2,l=r.strokeThickness/2+qt*R+j.ascent+oe,r.align==="right"?s+=B-U[qt]:r.align==="center"&&(s+=(B-U[qt])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(w[qt],s+r.padding,l+r.padding-Rt,!0),r.fill&&this.drawLetterSpacing(w[qt],s+r.padding,l+r.padding-Rt)}this.updateTexture()}},n.prototype.drawLetterSpacing=function(e,r,s,l){l===void 0&&(l=!1);var h=this._style.letterSpacing;if(h!==0)for(var m=r,x=Array.from?Array.from(e):e.split(""),b=this.context.measureText(e).width,w=0,R=0;R<x.length;++R){var U=x[R];l?this.context.strokeText(U,m,s):this.context.fillText(U,m,s),m+=b-(w=this.context.measureText(e.substring(R+1)).width)+h,b=w}else l?this.context.strokeText(e,r,s):this.context.fillText(e,r,s)},n.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var r=_h(e);r.data&&(e.width=r.width,e.height=r.height,this.context.putImageData(r.data,0,0))}var s=this._texture,l=this._style,h=l.trim?0:l.padding,m=s.baseTexture;s.trim.width=s._frame.width=Math.ceil(e.width/this._resolution),s.trim.height=s._frame.height=Math.ceil(e.height/this._resolution),s.trim.x=-h,s.trim.y=-h,s.orig.width=s._frame.width-2*h,s.orig.height=s._frame.height-2*h,this._onTextureUpdate(),m.setRealSize(e.width,e.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},n.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),o.prototype._render.call(this,e)},n.prototype.getLocalBounds=function(e){return this.updateText(!0),o.prototype.getLocalBounds.call(this,e)},n.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},n.prototype._generateFillStyle=function(e,r,s){var l,h=e.fill;if(!Array.isArray(h))return h;if(h.length===1)return h[0];var m=e.dropShadow?e.dropShadowDistance:0,x=e.padding||0,b=Math.ceil(this.canvas.width/this._resolution)-m-2*x,w=Math.ceil(this.canvas.height/this._resolution)-m-2*x,R=h.slice(),U=e.fillGradientStops.slice();if(!U.length)for(var B=R.length+1,j=1;j<B;++j)U.push(j/B);if(R.unshift(h[0]),U.unshift(0),R.push(h[h.length-1]),U.push(1),e.fillGradientType===Yl.LINEAR_VERTICAL){l=this.context.createLinearGradient(b/2,x,b/2,w+x);var K=(s.fontProperties.fontSize+e.strokeThickness)/w;for(j=0;j<r.length;j++)for(var ut=s.lineHeight*j,gt=0;gt<R.length;gt++){var Rt=0;Rt=typeof U[gt]=="number"?U[gt]:gt/R.length;var Le=Math.min(1,Math.max(0,ut/w+Rt*K));Le=Number(Le.toFixed(5)),l.addColorStop(Le,R[gt])}}else{l=this.context.createLinearGradient(x,w/2,b+x,w/2);var en=R.length+1,At=1;for(j=0;j<R.length;j++){var oe=void 0;oe=typeof U[j]=="number"?U[j]:At/en,l.addColorStop(oe,R[j]),At++}}return l},n.prototype.destroy=function(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},hf,e),o.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(n.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var r=Fr(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var r=Fr(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this._style},set:function(e){e=e||{},this._style=e instanceof tl?e:new tl(e),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e==null?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),n.nextLineHeightBehavior=!1,n}(li);/*!
 * @pixi/prepare - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ie.UPLOADS_PER_FRAME=4;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Cp=function(o,n){return(Cp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Rp=function(){function o(n){this.maxItemsPerFrame=n,this.itemsLeft=0}return o.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},o.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},o}();function cf(o,n){var e=!1;if(o&&o._textures&&o._textures.length){for(var r=0;r<o._textures.length;r++)if(o._textures[r]instanceof Dn){var s=o._textures[r].baseTexture;n.indexOf(s)===-1&&(n.push(s),e=!0)}}return e}function Ip(o,n){if(o.baseTexture instanceof fr){var e=o.baseTexture;return n.indexOf(e)===-1&&n.push(e),!0}return!1}function Dc(o,n){if(o._texture&&o._texture instanceof Dn){var e=o._texture.baseTexture;return n.indexOf(e)===-1&&n.push(e),!0}return!1}function df(o,n){return n instanceof Oc&&(n.updateText(!0),!0)}function pf(o,n){if(n instanceof tl){var e=n.toFontString();return Ko.measureFont(e),!0}return!1}function ff(o,n){if(o instanceof Oc){n.indexOf(o.style)===-1&&n.push(o.style),n.indexOf(o)===-1&&n.push(o);var e=o._texture.baseTexture;return n.indexOf(e)===-1&&n.push(e),!0}return!1}function mf(o,n){return o instanceof tl&&(n.indexOf(o)===-1&&n.push(o),!0)}var Bd=function(){function o(n){var e=this;this.limiter=new Rp(ie.UPLOADS_PER_FRAME),this.renderer=n,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(ff),this.registerFindHook(mf),this.registerFindHook(cf),this.registerFindHook(Ip),this.registerFindHook(Dc),this.registerUploadHook(df),this.registerUploadHook(pf)}return o.prototype.upload=function(n,e){typeof n=="function"&&(e=n,n=null),n&&this.add(n),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,ri.system.addOnce(this.tick,this,No.UTILITY))):e&&e()},o.prototype.tick=function(){setTimeout(this.delayedTick,0)},o.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var n=this.queue[0],e=!1;if(n&&!n._destroyed){for(var r=0,s=this.uploadHooks.length;r<s;r++)if(this.uploadHooks[r](this.uploadHookHelper,n)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)ri.system.addOnce(this.tick,this,No.UTILITY);else{this.ticking=!1;var l=this.completes.slice(0);for(this.completes.length=0,r=0,s=l.length;r<s;r++)l[r]()}},o.prototype.registerFindHook=function(n){return n&&this.addHooks.push(n),this},o.prototype.registerUploadHook=function(n){return n&&this.uploadHooks.push(n),this},o.prototype.add=function(n){for(var e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](n,this.queue);e++);if(n instanceof Ci)for(e=n.children.length-1;e>=0;e--)this.add(n.children[e]);return this},o.prototype.destroy=function(){this.ticking&&ri.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},o}();function Ud(o,n){return n instanceof fr&&(n._glTextures[o.CONTEXT_UID]||o.texture.bind(n),!0)}function gf(o,n){if(!(n instanceof vs))return!1;var e=n.geometry;n.finishPoly(),e.updateBatches();for(var r=e.batches,s=0;s<r.length;s++){var l=r[s].style.texture;l&&Ud(o,l.baseTexture)}return e.batchable||o.geometry.bind(e,n._resolveDirectShader(o)),!0}function vf(o,n){return o instanceof vs&&(n.push(o),!0)}var Lp=function(o){function n(e){var r=o.call(this,e)||this;return r.uploadHookHelper=r.renderer,r.registerFindHook(vf),r.registerUploadHook(Ud),r.registerUploadHook(gf),r}return function(e,r){function s(){this.constructor=e}Cp(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n}(Bd),Nc=function(){function o(n){this.maxMilliseconds=n,this.frameStart=0}return o.prototype.beginFrame=function(){this.frameStart=Date.now()},o.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},o}(),kd=function(){function o(n,e,r){r===void 0&&(r=null),this._texture=n instanceof Dn?n:null,this.baseTexture=n instanceof fr?n:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var s=this.baseTexture.resource;this.resolution=this._updateResolution(r||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return o.prototype._updateResolution=function(n){n===void 0&&(n=null);var e=this.data.meta.scale,r=ao(n,null);return r===null&&(r=e!==void 0?parseFloat(e):1),r!==1&&this.baseTexture.setResolution(r),r},o.prototype.parse=function(n){this._batchIndex=0,this._callback=n,this._frameKeys.length<=o.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},o.prototype._processFrames=function(n){for(var e=n,r=o.BATCH_SIZE;e-n<r&&e<this._frameKeys.length;){var s=this._frameKeys[e],l=this._frames[s],h=l.frame;if(h){var m=null,x=null,b=l.trimmed!==!1&&l.sourceSize?l.sourceSize:l.frame,w=new dr(0,0,Math.floor(b.w)/this.resolution,Math.floor(b.h)/this.resolution);m=l.rotated?new dr(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.h)/this.resolution,Math.floor(h.w)/this.resolution):new dr(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution),l.trimmed!==!1&&l.spriteSourceSize&&(x=new dr(Math.floor(l.spriteSourceSize.x)/this.resolution,Math.floor(l.spriteSourceSize.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution)),this.textures[s]=new Dn(this.baseTexture,m,w,x,l.rotated?2:0,l.anchor),Dn.addToCache(this.textures[s],s)}e++}},o.prototype._processAnimations=function(){var n=this.data.animations||{};for(var e in n){this.animations[e]=[];for(var r=0;r<n[e].length;r++){var s=n[e][r];this.animations[e].push(this.textures[s])}}},o.prototype._parseComplete=function(){var n=this._callback;this._callback=null,this._batchIndex=0,n.call(this,this.textures)},o.prototype._nextBatch=function(){var n=this;this._processFrames(this._batchIndex*o.BATCH_SIZE),this._batchIndex++,setTimeout(function(){n._batchIndex*o.BATCH_SIZE<n._frameKeys.length?n._nextBatch():(n._processAnimations(),n._parseComplete())},0)},o.prototype.destroy=function(n){var e;for(var r in n===void 0&&(n=!1),this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,n&&((e=this._texture)===null||e===void 0||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},o.BATCH_SIZE=1e3,o}(),Op=function(){function o(){}return o.use=function(n,e){var r,s,l=this,h=n.name+"_image";if(n.data&&n.type===Os.TYPE.JSON&&n.data.frames&&!l.resources[h]){var m=(s=(r=n.data)===null||r===void 0?void 0:r.meta)===null||s===void 0?void 0:s.related_multi_packs;if(Array.isArray(m))for(var x=function(B){if(typeof B!="string")return"continue";var j=B.replace(".json",""),K=gi.resolve(n.url.replace(l.baseUrl,""),B);if(l.resources[j]||Object.values(l.resources).some(function(gt){return gi.format(gi.parse(gt.url))===K}))return"continue";var ut={crossOrigin:n.crossOrigin,loadType:Os.LOAD_TYPE.XHR,xhrType:Os.XHR_RESPONSE_TYPE.JSON,parentResource:n};l.add(j,K,ut)},b=0,w=m;b<w.length;b++)x(w[b]);var R={crossOrigin:n.crossOrigin,metadata:n.metadata.imageMetadata,parentResource:n},U=o.getResourcePath(n,l.baseUrl);l.add(h,U,R,function(B){if(B.error)e(B.error);else{var j=new kd(B.texture,n.data,n.url);j.parse(function(){n.spritesheet=j,n.textures=j.textures,e()})}})}else e()},o.getResourcePath=function(n,e){return n.isDataUrl?n.data.meta.image:gi.resolve(n.url.replace(e,""),n.data.meta.image)},o}(),Wh=function(o,n){return(Wh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function Gd(o,n){function e(){this.constructor=o}Wh(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var el=new ai,Fc=function(o){function n(e,r,s){r===void 0&&(r=100),s===void 0&&(s=100);var l=o.call(this,e)||this;return l.tileTransform=new Ml,l._width=r,l._height=s,l.uvMatrix=l.texture.uvMatrix||new Jo(e),l.pluginName="tilingSprite",l.uvRespectAnchor=!1,l}return Gd(n,o),Object.defineProperty(n.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)},enumerable:!1,configurable:!0}),n.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},n.prototype._render=function(e){var r=this._texture;r&&r.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},n.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,r=this._height*-this._anchor._y,s=this._width*(1-this._anchor._x),l=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,r,s,l)},n.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new dr),e=this._localBoundsRect),this._bounds.getRectangle(e)):o.prototype.getLocalBounds.call(this,e)},n.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,el);var r=this._width,s=this._height,l=-r*this.anchor._x;if(el.x>=l&&el.x<l+r){var h=-s*this.anchor._y;if(el.y>=h&&el.y<h+s)return!0}return!1},n.prototype.destroy=function(e){o.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},n.from=function(e,r){return new n(e instanceof Dn?e:Dn.from(e,r),r.width,r.height)},Object.defineProperty(n.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!1,configurable:!0}),n}(li),Xh=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,ql=new yi,Dp=function(o){function n(e){var r=o.call(this,e)||this,s={globals:r.renderer.globalUniforms};return r.shader=Oa.from(Xh,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture2D(uSampler, coord);
    gl_FragColor = texSample * uColor;
}
`,s),r.simpleShader=Oa.from(Xh,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 sample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = sample * uColor;
}
`,s),r.quad=new qi,r.state=Da.for2d(),r}return Gd(n,o),n.prototype.render=function(e){var r=this.renderer,s=this.quad,l=s.vertices;l[0]=l[6]=e._width*-e.anchor.x,l[1]=l[3]=e._height*-e.anchor.y,l[2]=l[4]=e._width*(1-e.anchor.x),l[5]=l[7]=e._height*(1-e.anchor.y);var h=e.uvRespectAnchor?e.anchor.x:0,m=e.uvRespectAnchor?e.anchor.y:0;(l=s.uvs)[0]=l[6]=-h,l[1]=l[3]=-m,l[2]=l[4]=1-h,l[5]=l[7]=1-m,s.invalidate();var x=e._texture,b=x.baseTexture,w=e.tileTransform.localTransform,R=e.uvMatrix,U=b.isPowerOfTwo&&x.frame.width===b.width&&x.frame.height===b.height;U&&(b._glTextures[r.CONTEXT_UID]?U=b.wrapMode!==Lt.CLAMP:b.wrapMode===Lt.CLAMP&&(b.wrapMode=Lt.REPEAT));var B=U?this.simpleShader:this.shader,j=x.width,K=x.height,ut=e._width,gt=e._height;ql.set(w.a*j/ut,w.b*j/gt,w.c*K/ut,w.d*K/gt,w.tx/ut,w.ty/gt),ql.invert(),U?ql.prepend(R.mapCoord):(B.uniforms.uMapCoord=R.mapCoord.toArray(!0),B.uniforms.uClampFrame=R.uClampFrame,B.uniforms.uClampOffset=R.uClampOffset),B.uniforms.uTransform=ql.toArray(!0),B.uniforms.uColor=_n(e.tint,e.worldAlpha,B.uniforms.uColor,b.alphaMode),B.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),B.uniforms.uSampler=x,r.shader.bind(B),r.geometry.bind(s),this.state.blendMode=$e(e.blendMode,b.alphaMode),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},n}(Ia),za=function(o,n){return(za=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function nl(o,n){function e(){this.constructor=o}za(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var Yh=function(){function o(n,e){this.uvBuffer=n,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return o.prototype.update=function(n){if(n||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},o}(),Bc=new ai,qh=new tu,Bs=function(o){function n(e,r,s,l){l===void 0&&(l=so.TRIANGLES);var h=o.call(this)||this;return h.geometry=e,e.refCount++,h.shader=r,h.state=s||Da.for2d(),h.drawMode=l,h.start=0,h.size=0,h.uvs=null,h.indices=null,h.vertexData=new Float32Array(1),h.vertexDirty=-1,h._transformID=-1,h._roundPixels=ie.ROUND_PIXELS,h.batchUvs=null,h}return nl(n,o),Object.defineProperty(n.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"material",{get:function(){return this.shader},set:function(e){this.shader=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(e){this.shader.tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(e){this.shader.texture=e},enumerable:!1,configurable:!0}),n.prototype._render=function(e){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===so.TRIANGLES&&r.length<2*n.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)},n.prototype._renderDefault=function(e){var r=this.shader;r.alpha=this.worldAlpha,r.update&&r.update(),e.batch.flush(),r.program.uniformData.translationMatrix&&(r.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),e.shader.bind(r),e.state.set(this.state),e.geometry.bind(this.geometry,r),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},n.prototype._renderToBatch=function(e){var r=this.geometry,s=this.shader;s.uvMatrix&&(s.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=r.indexBuffer.data,this._tintRGB=s._tintRGB,this._texture=s.texture;var l=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[l]),e.plugins[l].render(this)},n.prototype.calculateVertices=function(){var e=this.geometry.buffers[0],r=e.data,s=e._updateID;if(s!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));for(var l=this.transform.worldTransform,h=l.a,m=l.b,x=l.c,b=l.d,w=l.tx,R=l.ty,U=this.vertexData,B=0;B<U.length/2;B++){var j=r[2*B],K=r[2*B+1];U[2*B]=h*j+x*K+w,U[2*B+1]=m*j+b*K+R}if(this._roundPixels){var ut=ie.RESOLUTION;for(B=0;B<U.length;++B)U[B]=Math.round((U[B]*ut|0)/ut)}this.vertexDirty=s}},n.prototype.calculateUvs=function(){var e=this.geometry.buffers[1],r=this.shader;r.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new Yh(e,r.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},n.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},n.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Bc);for(var r=this.geometry.getBuffer("aVertexPosition").data,s=qh.points,l=this.geometry.getIndex().data,h=l.length,m=this.drawMode===4?3:1,x=0;x+2<h;x+=m){var b=2*l[x],w=2*l[x+1],R=2*l[x+2];if(s[0]=r[b],s[1]=r[b+1],s[2]=r[w],s[3]=r[w+1],s[4]=r[R],s[5]=r[R+1],qh.contains(Bc.x,Bc.y))return!0}return!1},n.prototype.destroy=function(e){o.prototype.destroy.call(this,e),this.geometry.refCount--,this.geometry.refCount===0&&this.geometry.dispose(),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},n.BATCHABLE_SIZE=100,n}(Ci),Zh=function(o){function n(e,r){var s=this,l={uSampler:e,alpha:1,uTextureMatrix:yi.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(l,r.uniforms),(s=o.call(this,r.program||du.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`),l)||this)._colorDirty=!1,s.uvMatrix=new Jo(e),s.batchable=r.program===void 0,s.pluginName=r.pluginName,s.tint=r.tint,s.alpha=r.alpha,s}return nl(n,o),Object.defineProperty(n.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(e){this.uniforms.uSampler!==e&&(this.uniforms.uSampler=e,this.uvMatrix.texture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"alpha",{get:function(){return this._alpha},set:function(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(e){e!==this._tint&&(this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),n.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var e=this.texture.baseTexture;_n(this._tint,this._alpha,this.uniforms.uColor,e.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},n}(Oa),zo=function(o){function n(e,r,s){var l=o.call(this)||this,h=new Yi(e),m=new Yi(r,!0),x=new Yi(s,!0,!0);return l.addAttribute("aVertexPosition",h,2,!1,Q.FLOAT).addAttribute("aTextureCoord",m,2,!1,Q.FLOAT).addIndex(x),l._updateId=-1,l}return nl(n,o),Object.defineProperty(n.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),n}(Ca),Zl=function(o,n){return(Zl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Jl=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},Eu=function(){function o(){}return o.test=function(n){return typeof n=="string"&&n.indexOf("info face=")===0},o.parse=function(n){var e=n.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var s in e){var l=e[s].match(/^[a-z]+/gm)[0],h=e[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),m={};for(var x in h){var b=h[x].split("="),w=b[0],R=b[1].replace(/"/gm,""),U=parseFloat(R),B=isNaN(U)?R:U;m[w]=B}r[l].push(m)}var j=new Jl;return r.info.forEach(function(K){return j.info.push({face:K.face,size:parseInt(K.size,10)})}),r.common.forEach(function(K){return j.common.push({lineHeight:parseInt(K.lineHeight,10)})}),r.page.forEach(function(K){return j.page.push({id:parseInt(K.id,10),file:K.file})}),r.char.forEach(function(K){return j.char.push({id:parseInt(K.id,10),page:parseInt(K.page,10),x:parseInt(K.x,10),y:parseInt(K.y,10),width:parseInt(K.width,10),height:parseInt(K.height,10),xoffset:parseInt(K.xoffset,10),yoffset:parseInt(K.yoffset,10),xadvance:parseInt(K.xadvance,10)})}),r.kerning.forEach(function(K){return j.kerning.push({first:parseInt(K.first,10),second:parseInt(K.second,10),amount:parseInt(K.amount,10)})}),j},o}(),rr=function(){function o(){}return o.test=function(n){return n instanceof XMLDocument&&n.getElementsByTagName("page").length&&n.getElementsByTagName("info")[0].getAttribute("face")!==null},o.parse=function(n){for(var e=new Jl,r=n.getElementsByTagName("info"),s=n.getElementsByTagName("common"),l=n.getElementsByTagName("page"),h=n.getElementsByTagName("char"),m=n.getElementsByTagName("kerning"),x=0;x<r.length;x++)e.info.push({face:r[x].getAttribute("face"),size:parseInt(r[x].getAttribute("size"),10)});for(x=0;x<s.length;x++)e.common.push({lineHeight:parseInt(s[x].getAttribute("lineHeight"),10)});for(x=0;x<l.length;x++)e.page.push({id:parseInt(l[x].getAttribute("id"),10)||0,file:l[x].getAttribute("file")});for(x=0;x<h.length;x++){var b=h[x];e.char.push({id:parseInt(b.getAttribute("id"),10),page:parseInt(b.getAttribute("page"),10)||0,x:parseInt(b.getAttribute("x"),10),y:parseInt(b.getAttribute("y"),10),width:parseInt(b.getAttribute("width"),10),height:parseInt(b.getAttribute("height"),10),xoffset:parseInt(b.getAttribute("xoffset"),10),yoffset:parseInt(b.getAttribute("yoffset"),10),xadvance:parseInt(b.getAttribute("xadvance"),10)})}for(x=0;x<m.length;x++)e.kerning.push({first:parseInt(m[x].getAttribute("first"),10),second:parseInt(m[x].getAttribute("second"),10),amount:parseInt(m[x].getAttribute("amount"),10)});return e},o}(),Hd=function(){function o(){}return o.test=function(n){if(typeof n=="string"&&n.indexOf("<font>")>-1){var e=new self.DOMParser().parseFromString(n,"text/xml");return rr.test(e)}return!1},o.parse=function(n){var e=new self.DOMParser().parseFromString(n,"text/xml");return rr.parse(e)},o}(),Co=[Eu,rr,Hd];function Ai(o){for(var n=0;n<Co.length;n++)if(Co[n].test(o))return Co[n];return null}function ja(o,n,e,r,s,l){var h,m=e.fill;if(!Array.isArray(m))return m;if(m.length===1)return m[0];var x=e.dropShadow?e.dropShadowDistance:0,b=e.padding||0,w=Math.ceil(o.width/r)-x-2*b,R=Math.ceil(o.height/r)-x-2*b,U=m.slice(),B=e.fillGradientStops.slice();if(!B.length)for(var j=U.length+1,K=1;K<j;++K)B.push(K/j);if(U.unshift(m[0]),B.unshift(0),U.push(m[m.length-1]),B.push(1),e.fillGradientType===Yl.LINEAR_VERTICAL){h=n.createLinearGradient(w/2,b,w/2,R+b);var ut=0,gt=(l.fontProperties.fontSize+e.strokeThickness)/R;for(K=0;K<s.length;K++)for(var Rt=l.lineHeight*K,Le=0;Le<U.length;Le++){var en=Rt/R+(typeof B[Le]=="number"?B[Le]:Le/U.length)*gt,At=Math.max(ut,en);At=Math.min(At,1),h.addColorStop(At,U[Le]),ut=At}}else{h=n.createLinearGradient(b,R/2,w+b,R/2);var oe=U.length+1,qt=1;for(K=0;K<U.length;K++){var ne=void 0;ne=typeof B[K]=="number"?B[K]:qt/oe,h.addColorStop(ne,U[K]),qt++}}return h}function Np(o,n,e,r,s,l,h){var m=e.text,x=e.fontProperties;n.translate(r,s),n.scale(l,l);var b=h.strokeThickness/2,w=-h.strokeThickness/2;n.font=h.toFontString(),n.lineWidth=h.strokeThickness,n.textBaseline=h.textBaseline,n.lineJoin=h.lineJoin,n.miterLimit=h.miterLimit,n.fillStyle=ja(o,n,h,l,[m],e),n.strokeStyle=h.stroke,n.font=h.toFontString(),n.lineWidth=h.strokeThickness,n.textBaseline=h.textBaseline,n.lineJoin=h.lineJoin,n.miterLimit=h.miterLimit,n.fillStyle=ja(o,n,h,l,[m],e),n.strokeStyle=h.stroke;var R=h.dropShadowColor,U=Yo(typeof R=="number"?R:Pt(R));h.dropShadow?(n.shadowColor="rgba("+255*U[0]+","+255*U[1]+","+255*U[2]+","+h.dropShadowAlpha+")",n.shadowBlur=h.dropShadowBlur,n.shadowOffsetX=Math.cos(h.dropShadowAngle)*h.dropShadowDistance,n.shadowOffsetY=Math.sin(h.dropShadowAngle)*h.dropShadowDistance):(n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),h.stroke&&h.strokeThickness&&n.strokeText(m,b,w+e.lineHeight-x.descent),h.fill&&n.fillText(m,b,w+e.lineHeight-x.descent),n.setTransform(1,0,0,1,0,0),n.fillStyle="rgba(0, 0, 0, 0)"}var Mu=function(){function o(n,e,r){var s=n.info[0],l=n.common[0],h=ao(n.page[0].file),m={};this._ownsTextures=r,this.font=s.face,this.size=s.size,this.lineHeight=l.lineHeight/h,this.chars={},this.pageTextures=m;for(var x=0;x<n.page.length;x++){var b=n.page[x],w=b.id,R=b.file;m[w]=e instanceof Array?e[x]:e[R]}for(x=0;x<n.char.length;x++){var U=n.char[x],B=(w=U.id,U.page),j=n.char[x],K=j.x,ut=j.y,gt=j.width,Rt=j.height,Le=j.xoffset,en=j.yoffset,At=j.xadvance;ut/=h,gt/=h,Rt/=h,Le/=h,en/=h,At/=h;var oe=new dr((K/=h)+m[B].frame.x/h,ut+m[B].frame.y/h,gt,Rt);this.chars[w]={xOffset:Le,yOffset:en,xAdvance:At,kerning:{},texture:new Dn(m[B].baseTexture,oe),page:B}}for(x=0;x<n.kerning.length;x++){var qt=n.kerning[x],ne=qt.first,Je=qt.second,Pe=qt.amount;ne/=h,Je/=h,Pe/=h,this.chars[Je]&&(this.chars[Je].kerning[ne]=Pe)}}return o.prototype.destroy=function(){for(var n in this.chars)this.chars[n].texture.destroy(),this.chars[n].texture=null;for(var n in this.pageTextures)this._ownsTextures&&this.pageTextures[n].destroy(!0),this.pageTextures[n]=null;this.chars=null,this.pageTextures=null},o.install=function(n,e,r){var s;if(n instanceof Jl)s=n;else{var l=Ai(n);if(!l)throw new Error("Unrecognized data format for font.");s=l.parse(n)}e instanceof Dn&&(e=[e]);var h=new o(s,e,r);return o.available[h.font]=h,h},o.uninstall=function(n){var e=o.available[n];if(!e)throw new Error("No font found named '"+n+"'");e.destroy(),delete o.available[n]},o.from=function(n,e,r){if(!n)throw new Error("[BitmapFont] Property `name` is required.");var s=Object.assign({},o.defaultOptions,r),l=s.chars,h=s.padding,m=s.resolution,x=s.textureWidth,b=s.textureHeight,w=function(sn){typeof sn=="string"&&(sn=[sn]);for(var Bn=[],tr=0,br=sn.length;tr<br;tr++){var nr=sn[tr];if(Array.isArray(nr)){if(nr.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+nr.length+".");var gr=nr[0].charCodeAt(0),Qr=nr[1].charCodeAt(0);if(Qr<gr)throw new Error("[BitmapFont]: Invalid character range.");for(var qr=gr,Zr=Qr;qr<=Zr;qr++)Bn.push(String.fromCharCode(qr))}else Bn.push.apply(Bn,nr.split(""))}if(Bn.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return Bn}(l),R=e instanceof tl?e:new tl(e),U=x,B=new Jl;B.info[0]={face:R.fontFamily,size:R.fontSize},B.common[0]={lineHeight:R.fontSize};for(var j,K,ut,gt=0,Rt=0,Le=0,en=[],At=0;At<w.length;At++){j||((j=document.createElement("canvas")).width=x,j.height=b,K=j.getContext("2d"),ut=new fr(j,{resolution:m}),en.push(new Dn(ut)),B.page.push({id:en.length-1,file:""}));var oe=Ko.measureText(w[At],R,!1,j),qt=oe.width,ne=Math.ceil(oe.height),Je=Math.ceil((R.fontStyle==="italic"?2:1)*qt);if(Rt>=b-ne*m){if(Rt===0)throw new Error("[BitmapFont] textureHeight "+b+"px is too small for "+R.fontSize+"px fonts");--At,j=null,K=null,ut=null,Rt=0,gt=0,Le=0}else if(Le=Math.max(ne+oe.fontProperties.descent,Le),Je*m+gt>=U)--At,Rt+=Le*m,Rt=Math.ceil(Rt),gt=0,Le=0;else{Np(j,K,oe,gt,Rt,m,R);var Pe=oe.text.charCodeAt(0);B.char.push({id:Pe,page:en.length-1,x:gt/m,y:Rt/m,width:Je,height:ne,xoffset:0,yoffset:0,xadvance:Math.ceil(qt-(R.dropShadow?R.dropShadowDistance:0)-(R.stroke?R.strokeThickness:0))}),gt+=(Je+2*h)*m,gt=Math.ceil(gt)}}At=0;for(var $t=w.length;At<$t;At++)for(var Ee=w[At],hn=0;hn<$t;hn++){var Ve=w[hn],He=K.measureText(Ee).width,cn=K.measureText(Ve).width,Be=K.measureText(Ee+Ve).width-(He+cn);Be&&B.kerning.push({first:Ee.charCodeAt(0),second:Ve.charCodeAt(0),amount:Be})}var me=new o(B,en,!0);return o.available[n]!==void 0&&o.uninstall(n),o.available[n]=me,me},o.ALPHA=[["a","z"],["A","Z"]," "],o.NUMERIC=[["0","9"]],o.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],o.ASCII=[[" ","~"]],o.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:o.ALPHANUMERIC},o.available={},o}(),qs=[],Uc=[],kc=function(o){function n(e,r){r===void 0&&(r={});var s=o.call(this)||this;s._tint=16777215;var l=Object.assign({},n.styleDefaults,r),h=l.align,m=l.tint,x=l.maxWidth,b=l.letterSpacing,w=l.fontName,R=l.fontSize;if(!Mu.available[w])throw new Error('Missing BitmapFont "'+w+'"');return s._activePagesMeshData=[],s._textWidth=0,s._textHeight=0,s._align=h,s._tint=m,s._fontName=w,s._fontSize=R||Mu.available[w].size,s._text=e,s._maxWidth=x,s._maxLineHeight=0,s._letterSpacing=b,s._anchor=new eu(function(){s.dirty=!0},s,0,0),s._roundPixels=ie.ROUND_PIXELS,s.dirty=!0,s._textureCache={},s}return function(e,r){function s(){this.constructor=e}Zl(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype.updateText=function(){for(var e,r=Mu.available[this._fontName],s=this._fontSize/r.size,l=new ai,h=[],m=[],x=[],b=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",w=b.length,R=this._maxWidth*r.size/this._fontSize,U=null,B=0,j=0,K=0,ut=-1,gt=0,Rt=0,Le=0,en=0,At=0;At<w;At++){var oe=b.charCodeAt(At),qt=b.charAt(At);if(/(?:\s)/.test(qt)&&(ut=At,gt=B,en++),qt!=="\r"&&qt!==`
`){var ne=r.chars[oe];if(ne){U&&ne.kerning[U]&&(l.x+=ne.kerning[U]);var Je=Uc.pop()||{texture:Dn.EMPTY,line:0,charCode:0,prevSpaces:0,position:new ai};Je.texture=ne.texture,Je.line=K,Je.charCode=oe,Je.position.x=l.x+ne.xOffset+this._letterSpacing/2,Je.position.y=l.y+ne.yOffset,Je.prevSpaces=en,h.push(Je),l.x+=ne.xAdvance+this._letterSpacing,B=l.x,Le=Math.max(Le,ne.yOffset+ne.texture.height),U=oe,ut!==-1&&R>0&&l.x>R&&(Zn(h,1+ut-++Rt,1+At-ut),At=ut,ut=-1,m.push(gt),x.push(h.length>0?h[h.length-1].prevSpaces:0),j=Math.max(j,gt),K++,l.x=0,l.y+=r.lineHeight,U=null,en=0)}}else m.push(B),x.push(-1),j=Math.max(j,B),++K,++Rt,l.x=0,l.y+=r.lineHeight,U=null,en=0}var Pe=b.charAt(b.length-1);Pe!=="\r"&&Pe!==`
`&&(/(?:\s)/.test(Pe)&&(B=gt),m.push(B),j=Math.max(j,B),x.push(-1));var $t=[];for(At=0;At<=K;At++){var Ee=0;this._align==="right"?Ee=j-m[At]:this._align==="center"?Ee=(j-m[At])/2:this._align==="justify"&&(Ee=x[At]<0?0:(j-m[At])/x[At]),$t.push(Ee)}var hn=h.length,Ve={},He=[],cn=this._activePagesMeshData;for(At=0;At<cn.length;At++)qs.push(cn[At]);for(At=0;At<hn;At++){var Be=(qr=h[At].texture).baseTexture.uid;if(!Ve[Be]){if(!(Yn=qs.pop())){var me=new zo,sn=new Zh(Dn.EMPTY);Yn={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new Bs(me,sn),vertices:null,uvs:null,indices:null}}Yn.index=0,Yn.indexCount=0,Yn.vertexCount=0,Yn.uvsCount=0,Yn.total=0;var Bn=this._textureCache;Bn[Be]=Bn[Be]||new Dn(qr.baseTexture),Yn.mesh.texture=Bn[Be],Yn.mesh.tint=this._tint,He.push(Yn),Ve[Be]=Yn}Ve[Be].total++}for(At=0;At<cn.length;At++)He.indexOf(cn[At])===-1&&this.removeChild(cn[At].mesh);for(At=0;At<He.length;At++)He[At].mesh.parent!==this&&this.addChild(He[At].mesh);for(var At in this._activePagesMeshData=He,Ve){var tr=(Yn=Ve[At]).total;if(!(((e=Yn.indices)===null||e===void 0?void 0:e.length)>6*tr)||Yn.vertices.length<2*Bs.BATCHABLE_SIZE)Yn.vertices=new Float32Array(8*tr),Yn.uvs=new Float32Array(8*tr),Yn.indices=new Uint16Array(6*tr);else for(var br=Yn.total,nr=Yn.vertices,gr=4*br*2;gr<nr.length;gr++)nr[gr]=0;Yn.mesh.size=6*tr}for(At=0;At<hn;At++){var Qr=(qt=h[At]).position.x+$t[qt.line]*(this._align==="justify"?qt.prevSpaces:1);this._roundPixels&&(Qr=Math.round(Qr));var qr,Zr=Qr*s,Vi=qt.position.y*s,Jn=Ve[(qr=qt.texture).baseTexture.uid],ti=qr.frame,Wr=qr._uvs,ir=Jn.index++;Jn.indices[6*ir+0]=0+4*ir,Jn.indices[6*ir+1]=1+4*ir,Jn.indices[6*ir+2]=2+4*ir,Jn.indices[6*ir+3]=0+4*ir,Jn.indices[6*ir+4]=2+4*ir,Jn.indices[6*ir+5]=3+4*ir,Jn.vertices[8*ir+0]=Zr,Jn.vertices[8*ir+1]=Vi,Jn.vertices[8*ir+2]=Zr+ti.width*s,Jn.vertices[8*ir+3]=Vi,Jn.vertices[8*ir+4]=Zr+ti.width*s,Jn.vertices[8*ir+5]=Vi+ti.height*s,Jn.vertices[8*ir+6]=Zr,Jn.vertices[8*ir+7]=Vi+ti.height*s,Jn.uvs[8*ir+0]=Wr.x0,Jn.uvs[8*ir+1]=Wr.y0,Jn.uvs[8*ir+2]=Wr.x1,Jn.uvs[8*ir+3]=Wr.y1,Jn.uvs[8*ir+4]=Wr.x2,Jn.uvs[8*ir+5]=Wr.y2,Jn.uvs[8*ir+6]=Wr.x3,Jn.uvs[8*ir+7]=Wr.y3}for(var At in this._textWidth=j*s,this._textHeight=(l.y+r.lineHeight)*s,Ve){var Yn=Ve[At];if(this.anchor.x!==0||this.anchor.y!==0)for(var Wi=0,Ta=this._textWidth*this.anchor.x,dc=this._textHeight*this.anchor.y,yp=0;yp<Yn.total;yp++)Yn.vertices[Wi++]-=Ta,Yn.vertices[Wi++]-=dc,Yn.vertices[Wi++]-=Ta,Yn.vertices[Wi++]-=dc,Yn.vertices[Wi++]-=Ta,Yn.vertices[Wi++]-=dc,Yn.vertices[Wi++]-=Ta,Yn.vertices[Wi++]-=dc;this._maxLineHeight=Le*s;var af=Yn.mesh.geometry.getBuffer("aVertexPosition"),uf=Yn.mesh.geometry.getBuffer("aTextureCoord"),Tm=Yn.mesh.geometry.getIndex();af.data=Yn.vertices,uf.data=Yn.uvs,Tm.data=Yn.indices,af.update(),uf.update(),Tm.update()}for(At=0;At<h.length;At++)Uc.push(h[At])},n.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},n.prototype.getLocalBounds=function(){return this.validate(),o.prototype.getLocalBounds.call(this)},n.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(e){if(this._tint!==e){this._tint=e;for(var r=0;r<this._activePagesMeshData.length;r++)this._activePagesMeshData[r].mesh.tint=e}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(!Mu.available[e])throw new Error('Missing BitmapFont "'+e+'"');this._fontName!==e&&(this._fontName=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"anchor",{get:function(){return this._anchor},set:function(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e==null?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),n.prototype.destroy=function(e){var r=this._textureCache;for(var s in r)r[s].destroy(),delete r[s];this._textureCache=null,o.prototype.destroy.call(this,e)},n.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},n}(Ci),pi=function(){function o(){}return o.add=function(){Os.setExtensionXhrType("fnt",Os.XHR_RESPONSE_TYPE.TEXT)},o.use=function(n,e){var r=Ai(n.data);if(r)for(var s=o.getBaseUrl(this,n),l=r.parse(n.data),h={},m=function(K){h[K.metadata.pageFile]=K.texture,Object.keys(h).length===l.page.length&&(n.bitmapFont=Mu.install(l,h,!0),e())},x=0;x<l.page.length;++x){var b=l.page[x].file,w=s+b,R=!1;for(var U in this.resources){var B=this.resources[U];if(B.url===w){B.metadata.pageFile=b,B.texture?m(B):B.onAfterMiddleware.add(m),R=!0;break}}if(!R){var j={crossOrigin:n.crossOrigin,loadType:Os.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:b},n.metadata.imageMetadata),parentResource:n};this.add(w,j,m)}}else e()},o.getBaseUrl=function(n,e){var r=e.isDataUrl?"":o.dirname(e.url);return e.isDataUrl&&(r==="."&&(r=""),n.baseUrl&&r&&n.baseUrl.charAt(n.baseUrl.length-1)==="/"&&(r+="/")),(r=r.replace(n.baseUrl,""))&&r.charAt(r.length-1)!=="/"&&(r+="/"),r},o.dirname=function(n){var e=n.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===n?".":e===""?"/":e},o}(),wi=function(o,n){return(wi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Fp=function(o){function n(e){e===void 0&&(e=1);var r=o.call(this,Ps,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,{uAlpha:1})||this;return r.alpha=e,r}return function(e,r){function s(){this.constructor=e}wi(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),Object.defineProperty(n.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),n}(ro),Gc=function(o,n){return(Gc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function rl(o,n){function e(){this.constructor=o}Gc(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var Hc,zd,Jh,Qo,il,jd,Bp,$l,_s,hr,Vd,ys,zc,Mr,Au,Wd,ol,Up,_f={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Yr=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);(function(o){o[o.WEBGL_LEGACY=0]="WEBGL_LEGACY",o[o.WEBGL=1]="WEBGL",o[o.WEBGL2=2]="WEBGL2"})(Hc||(Hc={})),function(o){o[o.UNKNOWN=0]="UNKNOWN",o[o.WEBGL=1]="WEBGL",o[o.CANVAS=2]="CANVAS"}(zd||(zd={})),function(o){o[o.COLOR=16384]="COLOR",o[o.DEPTH=256]="DEPTH",o[o.STENCIL=1024]="STENCIL"}(Jh||(Jh={})),function(o){o[o.NORMAL=0]="NORMAL",o[o.ADD=1]="ADD",o[o.MULTIPLY=2]="MULTIPLY",o[o.SCREEN=3]="SCREEN",o[o.OVERLAY=4]="OVERLAY",o[o.DARKEN=5]="DARKEN",o[o.LIGHTEN=6]="LIGHTEN",o[o.COLOR_DODGE=7]="COLOR_DODGE",o[o.COLOR_BURN=8]="COLOR_BURN",o[o.HARD_LIGHT=9]="HARD_LIGHT",o[o.SOFT_LIGHT=10]="SOFT_LIGHT",o[o.DIFFERENCE=11]="DIFFERENCE",o[o.EXCLUSION=12]="EXCLUSION",o[o.HUE=13]="HUE",o[o.SATURATION=14]="SATURATION",o[o.COLOR=15]="COLOR",o[o.LUMINOSITY=16]="LUMINOSITY",o[o.NORMAL_NPM=17]="NORMAL_NPM",o[o.ADD_NPM=18]="ADD_NPM",o[o.SCREEN_NPM=19]="SCREEN_NPM",o[o.NONE=20]="NONE",o[o.SRC_OVER=0]="SRC_OVER",o[o.SRC_IN=21]="SRC_IN",o[o.SRC_OUT=22]="SRC_OUT",o[o.SRC_ATOP=23]="SRC_ATOP",o[o.DST_OVER=24]="DST_OVER",o[o.DST_IN=25]="DST_IN",o[o.DST_OUT=26]="DST_OUT",o[o.DST_ATOP=27]="DST_ATOP",o[o.ERASE=26]="ERASE",o[o.SUBTRACT=28]="SUBTRACT",o[o.XOR=29]="XOR"}(Qo||(Qo={})),function(o){o[o.POINTS=0]="POINTS",o[o.LINES=1]="LINES",o[o.LINE_LOOP=2]="LINE_LOOP",o[o.LINE_STRIP=3]="LINE_STRIP",o[o.TRIANGLES=4]="TRIANGLES",o[o.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",o[o.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(il||(il={})),function(o){o[o.RGBA=6408]="RGBA",o[o.RGB=6407]="RGB",o[o.ALPHA=6406]="ALPHA",o[o.LUMINANCE=6409]="LUMINANCE",o[o.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",o[o.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",o[o.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(jd||(jd={})),function(o){o[o.TEXTURE_2D=3553]="TEXTURE_2D",o[o.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",o[o.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",o[o.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",o[o.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",o[o.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",o[o.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",o[o.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Bp||(Bp={})),function(o){o[o.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",o[o.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",o[o.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",o[o.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",o[o.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",o[o.FLOAT=5126]="FLOAT",o[o.HALF_FLOAT=36193]="HALF_FLOAT"}($l||($l={})),function(o){o[o.FLOAT=0]="FLOAT",o[o.INT=1]="INT",o[o.UINT=2]="UINT"}(_s||(_s={})),function(o){o[o.NEAREST=0]="NEAREST",o[o.LINEAR=1]="LINEAR"}(hr||(hr={})),function(o){o[o.CLAMP=33071]="CLAMP",o[o.REPEAT=10497]="REPEAT",o[o.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Vd||(Vd={})),function(o){o[o.OFF=0]="OFF",o[o.POW2=1]="POW2",o[o.ON=2]="ON",o[o.ON_MANUAL=3]="ON_MANUAL"}(ys||(ys={})),function(o){o[o.NPM=0]="NPM",o[o.UNPACK=1]="UNPACK",o[o.PMA=2]="PMA",o[o.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",o[o.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",o[o.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(zc||(zc={})),function(o){o[o.NO=0]="NO",o[o.YES=1]="YES",o[o.AUTO=2]="AUTO",o[o.BLEND=0]="BLEND",o[o.CLEAR=1]="CLEAR",o[o.BLIT=2]="BLIT"}(Mr||(Mr={})),function(o){o[o.AUTO=0]="AUTO",o[o.MANUAL=1]="MANUAL"}(Au||(Au={})),function(o){o.LOW="lowp",o.MEDIUM="mediump",o.HIGH="highp"}(Wd||(Wd={})),function(o){o[o.NONE=0]="NONE",o[o.SCISSOR=1]="SCISSOR",o[o.STENCIL=2]="STENCIL",o[o.SPRITE=3]="SPRITE"}(ol||(ol={})),function(o){o[o.NONE=0]="NONE",o[o.LOW=2]="LOW",o[o.MEDIUM=4]="MEDIUM",o[o.HIGH=8]="HIGH"}(Up||(Up={}));var jc=function(o){function n(e,r,s,l,h){r===void 0&&(r=8),s===void 0&&(s=4),l===void 0&&(l=ie.FILTER_RESOLUTION),h===void 0&&(h=5);var m=this,x=function(w,R){var U,B=Math.ceil(w/2),j=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`,K="";U=R?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var ut=0;ut<w;ut++){var gt=U.replace("%index%",ut.toString());K+=gt=gt.replace("%sampleIndex%",ut-(B-1)+".0"),K+=`
`}return j=(j=j.replace("%blur%",K)).replace("%size%",w.toString())}(h,e),b=function(w){for(var R,U=_f[w],B=U.length,j=Yr,K="",ut=0;ut<w;ut++){var gt="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",ut.toString());R=ut,ut>=B&&(R=w-ut-1),K+=gt=gt.replace("%value%",U[R].toString()),K+=`
`}return j=(j=j.replace("%blur%",K)).replace("%size%",w.toString())}(h);return(m=o.call(this,x,b)||this).horizontal=e,m.resolution=l,m._quality=0,m.quality=s,m.blur=r,m}return rl(n,o),n.prototype.apply=function(e,r,s,l){if(s?this.horizontal?this.uniforms.strength=1/s.width*(s.width/r.width):this.uniforms.strength=1/s.height*(s.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,s,l);else{var h=e.getFilterTexture(),m=e.renderer,x=r,b=h;this.state.blend=!1,e.applyFilter(this,x,b,Mr.CLEAR);for(var w=1;w<this.passes-1;w++){e.bindAndClear(x,Mr.BLIT),this.uniforms.uSampler=b;var R=b;b=x,x=R,m.shader.bind(this),m.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,b,s,l),e.returnFilterTexture(h)}},Object.defineProperty(n.prototype,"blur",{get:function(){return this.strength},set:function(e){this.padding=1+2*Math.abs(e),this.strength=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"quality",{get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e},enumerable:!1,configurable:!0}),n}(ro),sl=function(o){function n(e,r,s,l){e===void 0&&(e=8),r===void 0&&(r=4),s===void 0&&(s=ie.FILTER_RESOLUTION),l===void 0&&(l=5);var h=o.call(this)||this;return h.blurXFilter=new jc(!0,e,r,s,l),h.blurYFilter=new jc(!1,e,r,s,l),h.resolution=s,h.quality=r,h.blur=e,h.repeatEdgePixels=!1,h}return rl(n,o),n.prototype.apply=function(e,r,s,l){var h=Math.abs(this.blurXFilter.strength),m=Math.abs(this.blurYFilter.strength);if(h&&m){var x=e.getFilterTexture();this.blurXFilter.apply(e,r,x,Mr.CLEAR),this.blurYFilter.apply(e,x,s,l),e.returnFilterTexture(x)}else m?this.blurYFilter.apply(e,r,s,l):this.blurXFilter.apply(e,r,s,l)},n.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(n.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(e){this.blurYFilter.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(e){this._repeatEdgePixels=e,this.updatePadding()},enumerable:!1,configurable:!0}),n}(ro),Pu=function(o,n){return(Pu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Kl=function(o){function n(){var e=this,r={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=o.call(this,Bl,`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,r)||this).alpha=1,e}return function(e,r){function s(){this.constructor=e}Pu(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype._loadMatrix=function(e,r){r===void 0&&(r=!1);var s=e;r&&(this._multiply(s,this.uniforms.m,e),s=this._colorMatrix(s)),this.uniforms.m=s},n.prototype._multiply=function(e,r,s){return e[0]=r[0]*s[0]+r[1]*s[5]+r[2]*s[10]+r[3]*s[15],e[1]=r[0]*s[1]+r[1]*s[6]+r[2]*s[11]+r[3]*s[16],e[2]=r[0]*s[2]+r[1]*s[7]+r[2]*s[12]+r[3]*s[17],e[3]=r[0]*s[3]+r[1]*s[8]+r[2]*s[13]+r[3]*s[18],e[4]=r[0]*s[4]+r[1]*s[9]+r[2]*s[14]+r[3]*s[19]+r[4],e[5]=r[5]*s[0]+r[6]*s[5]+r[7]*s[10]+r[8]*s[15],e[6]=r[5]*s[1]+r[6]*s[6]+r[7]*s[11]+r[8]*s[16],e[7]=r[5]*s[2]+r[6]*s[7]+r[7]*s[12]+r[8]*s[17],e[8]=r[5]*s[3]+r[6]*s[8]+r[7]*s[13]+r[8]*s[18],e[9]=r[5]*s[4]+r[6]*s[9]+r[7]*s[14]+r[8]*s[19]+r[9],e[10]=r[10]*s[0]+r[11]*s[5]+r[12]*s[10]+r[13]*s[15],e[11]=r[10]*s[1]+r[11]*s[6]+r[12]*s[11]+r[13]*s[16],e[12]=r[10]*s[2]+r[11]*s[7]+r[12]*s[12]+r[13]*s[17],e[13]=r[10]*s[3]+r[11]*s[8]+r[12]*s[13]+r[13]*s[18],e[14]=r[10]*s[4]+r[11]*s[9]+r[12]*s[14]+r[13]*s[19]+r[14],e[15]=r[15]*s[0]+r[16]*s[5]+r[17]*s[10]+r[18]*s[15],e[16]=r[15]*s[1]+r[16]*s[6]+r[17]*s[11]+r[18]*s[16],e[17]=r[15]*s[2]+r[16]*s[7]+r[17]*s[12]+r[18]*s[17],e[18]=r[15]*s[3]+r[16]*s[8]+r[17]*s[13]+r[18]*s[18],e[19]=r[15]*s[4]+r[16]*s[9]+r[17]*s[14]+r[18]*s[19]+r[19],e},n.prototype._colorMatrix=function(e){var r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r},n.prototype.brightness=function(e,r){var s=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(s,r)},n.prototype.greyscale=function(e,r){var s=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(s,r)},n.prototype.blackAndWhite=function(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)},n.prototype.hue=function(e,r){e=(e||0)/180*Math.PI;var s=Math.cos(e),l=Math.sin(e),h=1/3,m=(0,Math.sqrt)(h),x=[s+(1-s)*h,h*(1-s)-m*l,h*(1-s)+m*l,0,0,h*(1-s)+m*l,s+h*(1-s),h*(1-s)-m*l,0,0,h*(1-s)-m*l,h*(1-s)+m*l,s+h*(1-s),0,0,0,0,0,1,0];this._loadMatrix(x,r)},n.prototype.contrast=function(e,r){var s=(e||0)+1,l=-.5*(s-1),h=[s,0,0,0,l,0,s,0,0,l,0,0,s,0,l,0,0,0,1,0];this._loadMatrix(h,r)},n.prototype.saturate=function(e,r){e===void 0&&(e=0);var s=2*e/3+1,l=-.5*(s-1),h=[s,l,l,0,0,l,s,l,0,0,l,l,s,0,0,0,0,0,1,0];this._loadMatrix(h,r)},n.prototype.desaturate=function(){this.saturate(-1)},n.prototype.negative=function(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)},n.prototype.sepia=function(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)},n.prototype.technicolor=function(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)},n.prototype.polaroid=function(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)},n.prototype.toBGR=function(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)},n.prototype.kodachrome=function(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)},n.prototype.browni=function(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)},n.prototype.vintage=function(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)},n.prototype.colorTone=function(e,r,s,l,h){var m=((s=s||16770432)>>16&255)/255,x=(s>>8&255)/255,b=(255&s)/255,w=((l=l||3375104)>>16&255)/255,R=(l>>8&255)/255,U=(255&l)/255,B=[.3,.59,.11,0,0,m,x,b,e=e||.2,0,w,R,U,r=r||.15,0,m-w,x-R,b-U,0,0];this._loadMatrix(B,h)},n.prototype.night=function(e,r){var s=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(s,r)},n.prototype.predator=function(e,r){var s=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(s,r)},n.prototype.lsd=function(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)},n.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(n.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),n}(ro);Kl.prototype.grayscale=Kl.prototype.greyscale;/*!
 * @pixi/filter-displacement - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Cu=function(o,n){return(Cu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Fi=function(o){function n(e,r){var s=this,l=new yi;return e.renderable=!1,(s=o.call(this,`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`,`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,{mapSampler:e._texture,filterMatrix:l,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,s.maskMatrix=l,r==null&&(r=20),s.scale=new ai(r,r),s}return function(e,r){function s(){this.constructor=e}Cu(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype.apply=function(e,r,s,l){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var h=this.maskSprite.worldTransform,m=Math.sqrt(h.a*h.a+h.b*h.b),x=Math.sqrt(h.c*h.c+h.d*h.d);m!==0&&x!==0&&(this.uniforms.rotation[0]=h.a/m,this.uniforms.rotation[1]=h.b/m,this.uniforms.rotation[2]=h.c/x,this.uniforms.rotation[3]=h.d/x),e.applyFilter(this,r,s,l)},Object.defineProperty(n.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e},enumerable:!1,configurable:!0}),n}(ro),oi=function(o,n){return(oi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},vo=function(o){function n(){return o.call(this,`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`)||this}return function(e,r){function s(){this.constructor=e}oi(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n}(ro),al=function(o,n){return(al=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},Ql=function(o){function n(e,r){e===void 0&&(e=.5),r===void 0&&(r=Math.random());var s=o.call(this,Bl,`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`,{uNoise:0,uSeed:0})||this;return s.noise=e,s.seed=r,s}return function(e,r){function s(){this.constructor=e}al(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),Object.defineProperty(n.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e},enumerable:!1,configurable:!0}),n}(ro),ul=new yi;ci.prototype._cacheAsBitmap=!1,ci.prototype._cacheData=null,ci.prototype._cacheAsBitmapResolution=null;var th=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(ci.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(o){o!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=o,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(o){var n;this._cacheAsBitmap!==o&&(this._cacheAsBitmap=o,o?(this._cacheData||(this._cacheData=new th),(n=this._cacheData).originalRender=this.render,n.originalRenderCanvas=this.renderCanvas,n.originalUpdateTransform=this.updateTransform,n.originalCalculateBounds=this.calculateBounds,n.originalGetLocalBounds=this.getLocalBounds,n.originalDestroy=this.destroy,n.originalContainsPoint=this.containsPoint,n.originalMask=this._mask,n.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((n=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=n.originalRender,this.renderCanvas=n.originalRenderCanvas,this.calculateBounds=n.originalCalculateBounds,this.getLocalBounds=n.originalGetLocalBounds,this.destroy=n.originalDestroy,this.updateTransform=n.originalUpdateTransform,this.containsPoint=n.originalContainsPoint,this._mask=n.originalMask,this.filterArea=n.originalFilterArea))}}}),ci.prototype._renderCached=function(o){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(o),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(o))},ci.prototype._initCachedDisplayObject=function(o){if(!this._cacheData||!this._cacheData.sprite){var n=this.alpha;this.alpha=1,o.batch.flush();var e=this.getLocalBounds(null,!0).clone();if(this.filters){var r=this.filters[0].padding;e.pad(r)}e.ceil(ie.RESOLUTION);var s=o.renderTexture.current,l=o.renderTexture.sourceFrame.clone(),h=o.renderTexture.destinationFrame.clone(),m=o.projection.transform,x=Ri.create({width:e.width,height:e.height,resolution:this.cacheAsBitmapResolution||o.resolution}),b="cacheAsBitmap_"+Er();this._cacheData.textureCacheId=b,fr.addToCache(x.baseTexture,b),Dn.addToCache(x,b);var w=this.transform.localTransform.copyTo(ul).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender,o.render(this,{renderTexture:x,clear:!0,transform:w,skipUpdateTransform:!1}),o.projection.transform=m,o.renderTexture.bind(s,l,h),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;var R=new li(x);R.transform.worldTransform=this.transform.worldTransform,R.anchor.x=-e.x/e.width,R.anchor.y=-e.y/e.height,R.alpha=n,R._bounds=this._bounds,this._cacheData.sprite=R,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=R.containsPoint.bind(R)}},ci.prototype._renderCachedCanvas=function(o){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(o),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(o))},ci.prototype._initCachedDisplayObjectCanvas=function(o){if(!this._cacheData||!this._cacheData.sprite){var n=this.getLocalBounds(null,!0),e=this.alpha;this.alpha=1;var r=o.context,s=o._projTransform;n.ceil(ie.RESOLUTION);var l=Ri.create({width:n.width,height:n.height}),h="cacheAsBitmap_"+Er();this._cacheData.textureCacheId=h,fr.addToCache(l.baseTexture,h),Dn.addToCache(l,h);var m=ul;this.transform.localTransform.copyTo(m),m.invert(),m.tx-=n.x,m.ty-=n.y,this.renderCanvas=this._cacheData.originalRenderCanvas,o.render(this,{renderTexture:l,clear:!0,transform:m,skipUpdateTransform:!1}),o.context=r,o._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;var x=new li(l);x.transform.worldTransform=this.transform.worldTransform,x.anchor.x=-n.x/n.width,x.anchor.y=-n.y/n.height,x.alpha=e,x._bounds=this._bounds,this._cacheData.sprite=x,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=o._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=x.containsPoint.bind(x)}},ci.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},ci.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},ci.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,fr.removeFromCache(this._cacheData.textureCacheId),Dn.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},ci.prototype._cacheAsBitmapDestroy=function(o){this.cacheAsBitmap=!1,this.destroy(o)},ci.prototype.name=null,Ci.prototype.getChildByName=function(o,n){for(var e=0,r=this.children.length;e<r;e++)if(this.children[e].name===o)return this.children[e];if(n){for(e=0,r=this.children.length;e<r;e++)if(this.children[e].getChildByName){var s=this.children[e].getChildByName(o,!0);if(s)return s}}return null},ci.prototype.getGlobalPosition=function(o,n){return o===void 0&&(o=new ai),n===void 0&&(n=!1),this.parent?this.parent.toGlobal(this.position,o,n):(o.x=this.position.x,o.y=this.position.y),o};/*!
 * @pixi/mesh-extras - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/mesh-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ru=function(o,n){return(Ru=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)};function Zs(o,n){function e(){this.constructor=o}Ru(o,n),o.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var Vc=function(o){function n(e,r,s,l){e===void 0&&(e=100),r===void 0&&(r=100),s===void 0&&(s=10),l===void 0&&(l=10);var h=o.call(this)||this;return h.segWidth=s,h.segHeight=l,h.width=e,h.height=r,h.build(),h}return Zs(n,o),n.prototype.build=function(){for(var e=this.segWidth*this.segHeight,r=[],s=[],l=[],h=this.segWidth-1,m=this.segHeight-1,x=this.width/h,b=this.height/m,w=0;w<e;w++){var R=w%this.segWidth,U=w/this.segWidth|0;r.push(R*x,U*b),s.push(R/h,U/m)}var B=h*m;for(w=0;w<B;w++){var j=w%h,K=w/h|0,ut=K*this.segWidth+j,gt=K*this.segWidth+j+1,Rt=(K+1)*this.segWidth+j,Le=(K+1)*this.segWidth+j+1;l.push(ut,gt,Rt,gt,Le,Rt)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(s),this.indexBuffer.data=new Uint16Array(l),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},n}(zo),ma=function(o){function n(e,r,s){e===void 0&&(e=200),s===void 0&&(s=0);var l=o.call(this,new Float32Array(4*r.length),new Float32Array(4*r.length),new Uint16Array(6*(r.length-1)))||this;return l.points=r,l._width=e,l.textureScale=s,l.build(),l}return Zs(n,o),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),n.prototype.build=function(){var e=this.points;if(e){var r=this.getBuffer("aVertexPosition"),s=this.getBuffer("aTextureCoord"),l=this.getIndex();if(!(e.length<1)){r.data.length/4!==e.length&&(r.data=new Float32Array(4*e.length),s.data=new Float32Array(4*e.length),l.data=new Uint16Array(6*(e.length-1)));var h=s.data,m=l.data;h[0]=0,h[1]=0,h[2]=0,h[3]=1;for(var x=0,b=e[0],w=this._width*this.textureScale,R=e.length,U=0;U<R;U++){var B=4*U;if(this.textureScale>0){var j=b.x-e[U].x,K=b.y-e[U].y,ut=Math.sqrt(j*j+K*K);b=e[U],x+=ut/w}else x=U/(R-1);h[B]=x,h[B+1]=0,h[B+2]=x,h[B+3]=1}var gt=0;for(U=0;U<R-1;U++)B=2*U,m[gt++]=B,m[gt++]=B+1,m[gt++]=B+2,m[gt++]=B+2,m[gt++]=B+1,m[gt++]=B+3;s.update(),l.update(),this.updateVertices()}}},n.prototype.updateVertices=function(){var e=this.points;if(!(e.length<1)){for(var r,s=e[0],l=0,h=0,m=this.buffers[0].data,x=e.length,b=0;b<x;b++){var w=e[b],R=4*b;h=-((r=b<e.length-1?e[b+1]:w).x-s.x),l=r.y-s.y;var U=Math.sqrt(l*l+h*h),B=this.textureScale>0?this.textureScale*this._width/2:this._width/2;l/=U,h/=U,l*=B,h*=B,m[R]=w.x+l,m[R+1]=w.y+h,m[R+2]=w.x-l,m[R+3]=w.y-h,s=w}this.buffers[0].update()}},n.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},n}(zo),$h=function(o){function n(e,r,s){s===void 0&&(s=0);var l=this,h=new ma(e.height,r,s),m=new Zh(e);return s>0&&(e.baseTexture.wrapMode=Lt.REPEAT),(l=o.call(this,h,m)||this).autoUpdate=!0,l}return Zs(n,o),n.prototype._render=function(e){var r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),o.prototype._render.call(this,e)},n}(Bs),eh=function(o){function n(e,r,s){var l=this,h=new Vc(e.width,e.height,r,s),m=new Zh(Dn.WHITE);return(l=o.call(this,h,m)||this).texture=e,l}return Zs(n,o),n.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var e=this.geometry;e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build()},Object.defineProperty(n.prototype,"texture",{get:function(){return this.shader.texture},set:function(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),n.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),o.prototype._render.call(this,e)},n.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),o.prototype.destroy.call(this,e)},n}(Bs),Xd=function(o){function n(e,r,s,l,h){e===void 0&&(e=Dn.EMPTY);var m=this,x=new zo(r,s,l);x.getBuffer("aVertexPosition").static=!1;var b=new Zh(e);return(m=o.call(this,x,b,null,h)||this).autoUpdate=!0,m}return Zs(n,o),Object.defineProperty(n.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e},enumerable:!1,configurable:!0}),n.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),o.prototype._render.call(this,e)},n}(Bs),Yd=function(o){function n(e,r,s,l,h){r===void 0&&(r=10),s===void 0&&(s=10),l===void 0&&(l=10),h===void 0&&(h=10);var m=o.call(this,Dn.WHITE,4,4)||this;return m._origWidth=e.orig.width,m._origHeight=e.orig.height,m._width=m._origWidth,m._height=m._origHeight,m._leftWidth=r,m._rightWidth=l,m._topHeight=s,m._bottomHeight=h,m.texture=e,m}return Zs(n,o),n.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(n.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e},enumerable:!1,configurable:!0}),n.prototype.updateHorizontalVertices=function(){var e=this.vertices,r=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*r,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*r,e[25]=e[27]=e[29]=e[31]=this._height},n.prototype.updateVerticalVertices=function(){var e=this.vertices,r=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*r,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*r,e[6]=e[14]=e[22]=e[30]=this._width},n.prototype._getMinScale=function(){var e=this._leftWidth+this._rightWidth,r=this._width>e?1:this._width/e,s=this._topHeight+this._bottomHeight,l=this._height>s?1:this._height/s;return Math.min(r,l)},Object.defineProperty(n.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(e){this._leftWidth=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(e){this._rightWidth=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"topHeight",{get:function(){return this._topHeight},set:function(e){this._topHeight=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(e){this._bottomHeight=e,this._refresh()},enumerable:!1,configurable:!0}),n.prototype._refresh=function(){var e=this.texture,r=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;var s=1/this._origWidth,l=1/this._origHeight;r[0]=r[8]=r[16]=r[24]=0,r[1]=r[3]=r[5]=r[7]=0,r[6]=r[14]=r[22]=r[30]=1,r[25]=r[27]=r[29]=r[31]=1,r[2]=r[10]=r[18]=r[26]=s*this._leftWidth,r[4]=r[12]=r[20]=r[28]=1-s*this._rightWidth,r[9]=r[11]=r[13]=r[15]=l*this._topHeight,r[17]=r[19]=r[21]=r[23]=1-l*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},n}(eh),qd=function(o,n){return(qd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])})(o,n)},nh=function(o){function n(e,r){r===void 0&&(r=!0);var s=o.call(this,e[0]instanceof Dn?e[0]:e[0].texture)||this;return s._textures=null,s._durations=null,s._autoUpdate=r,s._isConnectedToTicker=!1,s.animationSpeed=1,s.loop=!0,s.updateAnchor=!1,s.onComplete=null,s.onFrameChange=null,s.onLoop=null,s._currentTime=0,s._playing=!1,s._previousFrame=null,s.textures=e,s}return function(e,r){function s(){this.constructor=e}qd(e,r),e.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}(n,o),n.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(ri.shared.remove(this.update,this),this._isConnectedToTicker=!1))},n.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(ri.shared.add(this.update,this,No.HIGH),this._isConnectedToTicker=!0))},n.prototype.gotoAndStop=function(e){this.stop();var r=this.currentFrame;this._currentTime=e,r!==this.currentFrame&&this.updateTexture()},n.prototype.gotoAndPlay=function(e){var r=this.currentFrame;this._currentTime=e,r!==this.currentFrame&&this.updateTexture(),this.play()},n.prototype.update=function(e){if(this._playing){var r=this.animationSpeed*e,s=this.currentFrame;if(this._durations!==null){var l=this._currentTime%1*this._durations[this.currentFrame];for(l+=r/60*1e3;l<0;)this._currentTime--,l+=this._durations[this.currentFrame];var h=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);l>=this._durations[this.currentFrame];)l-=this._durations[this.currentFrame]*h,this._currentTime+=h;this._currentTime+=l/this._durations[this.currentFrame]}else this._currentTime+=r;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):s!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<s||this.animationSpeed<0&&this.currentFrame>s)&&this.onLoop(),this.updateTexture())}},n.prototype.updateTexture=function(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},n.prototype.destroy=function(e){this.stop(),o.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},n.fromFrames=function(e){for(var r=[],s=0;s<e.length;++s)r.push(Dn.from(e[s]));return new n(r)},n.fromImages=function(e){for(var r=[],s=0;s<e.length;++s)r.push(Dn.from(e[s]));return new n(r)},Object.defineProperty(n.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textures",{get:function(){return this._textures},set:function(e){if(e[0]instanceof Dn)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var r=0;r<e.length;r++)this._textures.push(e[r].texture),this._durations.push(e[r].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentFrame",{get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(ri.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(ri.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),n}(li);/*!
 * pixi.js - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Vs.registerPlugin("accessibility",Al),Vs.registerPlugin("extract",Gl),Vs.registerPlugin("interaction",bo),Vs.registerPlugin("particle",Ad),Vs.registerPlugin("prepare",Lp),Vs.registerPlugin("batch",Cs),Vs.registerPlugin("tilingSprite",Dp),Ls.registerPlugin(pi),Ls.registerPlugin(ji),Ls.registerPlugin(Xs),Ls.registerPlugin(ka),Ls.registerPlugin(Op),Yu.registerPlugin(ia),Yu.registerPlugin($o);var Wc="6.0.4",Iu={AlphaFilter:Fp,BlurFilter:sl,BlurFilterPass:jc,ColorMatrixFilter:Kl,DisplacementFilter:Fi,FXAAFilter:vo,NoiseFilter:Ql};class kp{constructor(n){this.target=n}get color(){return this.target.strokeColorFilter.currentColor}set color(n){this.target.strokeColorFilter.color=n}get on(){return this.target.strokeActive?"true":"false"}set on(n){this.target.strokeActive=n==="true"}}class Xc{constructor(n){this.target=n}applyCommand(n,e){this.target.applyCommand(n,e)}}class Zd{constructor(n){this.target=n}get color(){return this.target.fillColorFilter.currentColor}set color(n){this.target.fillColorFilter.color=n}get on(){return this.target.fillActive?"true":"false"}set on(n){this.target.fillActive=n==="true"}}class Jd{constructor(n,e){this.hardHidden=!1,this.target=n,e===!0&&(this.hardHidden=!0)}get opacity(){return this.target.alpha}set opacity(n){this.target.alpha=n}get rotation(){return this.target.rotation/Math.PI*180}set rotation(n){this.target.rotation=n/180*Math.PI}get visibility(){return this.target.visible?"visible":"hidden"}set visibility(n){this.visibility===n||this.hardHidden||(this.target.visible=n==="visible")}}class Gp{constructor(n,e){this.actions=[],this.ctx=e,this.object=n,this.object.interactive=!0}reset(n){this.object.interactive=!1,this.object.removeAllListeners(),this.object=n,this.object.interactive=!0}addAction(n,e){this.actions.push([n,e]),e==="click"?(this.object.addListener("click",()=>this.handleAction(n)),this.object.cursor="pointer"):e==="hover"&&this.object.addListener("mouseover",()=>this.handleAction(n))}addProxy(n){this.proxy=n,this.hitArea=this.getOriginHitArea(),this.proxy.interactive=!0,this.actions.forEach(([e,r])=>{var s,l;r==="click"?(s=this.proxy)===null||s===void 0||s.addListener("click",h=>this.handleProxyAction(h,e)):r==="hover"&&((l=this.proxy)===null||l===void 0||l.addListener("mouseover",h=>this.handleProxyAction(h,e)))})}handleProxyAction(n,e){var r;const s=n.data.global,l=this.object.getGlobalPosition(),h=s.x-l.x+this.object.pivot.x,m=s.y-l.y+this.object.pivot.y;((r=this.hitArea)===null||r===void 0?void 0:r.contains(h,m))&&this.handleAction(e,!0)}getOriginHitArea(){return this.object.hitArea?this.object.hitArea:new mc(0,0,this.object.width,this.object.height)}handleAction(n,e=!1){this.proxy&&!e||(this.ctx.eventHub.emit(xr.hyperlinkTrigger,n),this.execAction(n))}execAction(n){var e;if(n.action==="ppaction://hlinksldjump"){const r=((e=n==null?void 0:n.target)!==null&&e!==void 0?e:"").match(/slide(\d+)\.xml/);r&&r[1]&&this.ctx.eventHub.emit(_a.goto,Number(r[1]))}else n.action==="ppaction://hlinkshowjump?jump=nextslide"?this.ctx.eventHub.emit(_a.next):n.action==="ppaction://hlinkshowjump?jump=previousslide"&&this.ctx.eventHub.emit(_a.prev)}}class Kh{constructor(n,e,r){var s,l,h,m,x,b;this.scaleExt={x:1,y:1},this.scaleOrigin={x:1,y:1},this.designScale={x:1,y:1},this.bound=new dr(0,0,1,1),this.pptX=0,this.pptY=0,this.presetSubType=0,this.designWidth=0,this.designHeight=0,this.designX=0,this.designY=0,this.hasPreset=!1,this.container=new Ci,this.ctx=e,this.style=new Jd(this.container,n.hardHidden),this.designGlobalPosition={x:r.x+((l=(s=n.position)===null||s===void 0?void 0:s.x)!==null&&l!==void 0?l:0),y:r.y+((m=(h=n.position)===null||h===void 0?void 0:h.y)!==null&&m!==void 0?m:0)},(n.hlinkClick||n.hlinkHover)&&(this.hyperlink=new Gp(this.container,this.ctx),n.hlinkHover&&((x=this.hyperlink)===null||x===void 0||x.addAction(n.hlinkHover,"hover")),n.hlinkClick&&((b=this.hyperlink)===null||b===void 0||b.addAction(n.hlinkClick,"click")))}updateScale(){this.container.scale.x=this.designScale.x*this.scaleExt.x*this.scaleOrigin.x,this.container.scale.y=this.designScale.y*this.scaleExt.y*this.scaleOrigin.y}updateTransform(n){var e,r,s,l,h,m,x,b;this.designWidth=n.width,this.designHeight=n.height,this.designX=(r=(e=n.position)===null||e===void 0?void 0:e.x)!==null&&r!==void 0?r:0,this.designY=(l=(s=n.position)===null||s===void 0?void 0:s.y)!==null&&l!==void 0?l:0;const w=this.designWidth/2,R=this.designHeight/2;this.container.width=this.designWidth,this.container.height=this.designHeight,this.container.pivot.x=w,this.container.pivot.y=R;const U=(m=(h=n.position)===null||h===void 0?void 0:h.x)!==null&&m!==void 0?m:0,B=(b=(x=n.position)===null||x===void 0?void 0:x.y)!==null&&b!==void 0?b:0;this.container.x=U+w,this.container.y=B+R,n.scale&&(this.designScale={x:n.scale.x,y:n.scale.y},this.container.scale.x=n.scale.x,this.container.scale.y=n.scale.y),n.rotation&&(this.container.rotation=n.rotation);const j=new vs;j.drawRect(0,0,this.designWidth,this.designHeight),this.container.addChild(j),this.json.hardHidden&&(this.container.visible=!1),this.bound.x=U,this.bound.y=B}get scale(){return this.container.scale}set scale(n){this.scaleOrigin.x=n.x,this.scaleOrigin.y=n.y,this.updateScale()}get design_ppt_w(){return this.designWidth/this.ctx.stageWidth}get design_ppt_h(){return this.designHeight/this.ctx.stageHeight}get design_ppt_x(){return this.designX/this.ctx.stageWidth}get design_ppt_y(){return this.designY/this.ctx.stageHeight}get ppt_w(){return this.scaleExt.x*this.scaleOrigin.x*this.designWidth/this.ctx.stageWidth}set ppt_w(n){this.scaleExt.x=n*this.ctx.stageWidth/this.designWidth,this.updateScale()}get ppt_h(){return this.scaleExt.y*this.scaleOrigin.y*this.designHeight/this.ctx.stageHeight}set ppt_h(n){this.scaleExt.y=n*this.ctx.stageHeight/this.designHeight,this.updateScale()}get ppt_x(){return(this.container.position.x-this.container.pivot.x)/this.ctx.stageWidth}set ppt_x(n){this.pptX=n;const e=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=n*this.ctx.stageWidth+this.container.pivot.x*e}get ppt_y(){return(this.container.position.y-this.container.pivot.y)/this.ctx.stageHeight}set ppt_y(n){this.pptY=n;const e=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=n*this.ctx.stageHeight+this.container.pivot.y*e}get r(){return this.container.rotation}set r(n){this.container.rotation=n}}class Qh{constructor(n){if(this._isInit=!1,this.h=0,this.s=0,this.l=0,this.a=1,n){this._isInit=!0;const e=n.match(/-?[0-9]+/g);e&&(this.h=parseInt(e[0],10),this.s=parseInt(e[1],10)/100,this.l=parseInt(e[2],10)/100)}}isInit(){return this._isInit}by(n,e){e.h=Math.max(Math.min(this.h+n.h,359),0),e.s=Math.max(Math.min(this.s+n.s,1),0),e.l=Math.max(Math.min(this.l+n.l,1),0),e.a=Math.max(Math.min(this.a+n.a,1),0)}fromHexString(n){const[e,r,s,l]=Ro(n);let h=0,m=0,x=0;const b=Math.max(e,r,s),w=Math.min(e,r,s),R=b-w;x=(b+w)/2,R===0?h=0:b===e?h=(r-s)/R%6*60:b===r?h=60*((s-e)/R+2):b===s&&(h=60*((e-r)/R+4)),m=R===0?0:R/(1-Math.abs(2*x-1)),this.h=h,this.s=m,this.l=x,this.a=l}interpolationFrom(n,e,r){const s=n.h+(this.h-n.h)*e,l=n.s+(this.s-n.s)*e,h=n.l+(this.l-n.l)*e,m=n.a+(this.a-n.a)*e;r.h=Math.max(Math.min(s,359),0),r.s=Math.max(Math.min(l,1),0),r.l=Math.max(Math.min(h,1),0),r.a=Math.max(Math.min(m,1),0)}toHexString(){let n=[0,0,0,0];const{h:e,s:r,l:s}=this;if(e<360&&e>=0&&r<=1&&r>=0&&s<=1&&s>=0){let l,h,m;const x=(1-Math.abs(2*s-1))*r,b=x*(1-Math.abs(e/60%2-1)),w=s-x/2;[l,h,m]=e>=0&&e<60?[x,b,0]:e>=60&&e<120?[b,x,0]:e>=120&&e<180?[0,x,b]:e>=180&&e<240?[0,b,x]:e>=240&&e<300?[b,0,x]:[x,0,b],n=[l+w,h+w,m+w,this.a]}return $d(n)}}class ll{constructor(n){this._isInit=!1,this.r=0,this.g=0,this.b=0,this.a=0,n&&(this._isInit=!0,this.fromHexString(n))}fromHexString(n){const[e,r,s,l]=Ro(n);this.r=e,this.g=r,this.b=s,this.a=l}isInit(){return this._isInit}interpolationFrom(n,e,r){r.r=n.r+(this.r-n.r)*e,r.g=n.g+(this.g-n.g)*e,r.b=n.b+(this.b-n.b)*e,r.a=n.a+(this.a-n.a)*e}by(n,e){e.r=Math.min(Math.max(this.r+n.r,0),255),e.g=Math.min(Math.max(this.g+n.g,0),255),e.b=Math.min(Math.max(this.b+n.b,0),255),e.a=Math.min(Math.max(this.a+n.a,0),1)}toHexString(){return $d([this.r,this.g,this.b,this.a])}}function io(o){const n=o.substring(1);return[parseInt(n.substring(0,6),16),parseInt(n.substring(6,8),16)/255]}function Ro(o){return(o=o.replace(/^#/,"")).substring(6,8).length===0&&(o+="FF"),[parseInt(o.substring(0,2).padStart(8,"0"),16)/255,parseInt(o.substring(2,4).padStart(8,"0"),16)/255,parseInt(o.substring(4,6).padStart(8,"0"),16)/255,parseInt(o.substring(6,8).padStart(8,"0"),16)/255]}function $d(o){return"#"+Math.round(255*o[0]).toString(16).padStart(2,"0")+Math.round(255*o[1]).toString(16).padStart(2,"0")+Math.round(255*o[2]).toString(16).padStart(2,"0")+Math.round(255*o[3]).toString(16).padStart(2,"0")}function Yc(o,n,e){const r=Ro(o),s=Ro(n),l=Math.round(255*(r[0]+(s[0]-r[0])*e)),h=Math.round(255*(r[1]+(s[1]-r[1])*e)),m=Math.round(255*(r[2]+(s[2]-r[2])*e)),x=Math.round(255*(r[3]+(s[3]-r[3])*e));return"#"+l.toString(16).padStart(2,"0")+h.toString(16).padStart(2,"0")+m.toString(16).padStart(2,"0")+x.toString(16).padStart(2,"0")}class hl extends ro{constructor(){super(void 0,`
varying vec2 vTextureCoord;

uniform vec4 color;
uniform sampler2D uSampler;

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);

    if (texColor.a > 0.0) {
        vec4 resultColor = color;
        resultColor = resultColor * texColor.a;
        gl_FragColor = resultColor;
    } else {
        gl_FragColor = texColor;
    }
}
`,{color:new Float32Array([0,0,0,0]),active:0}),this.currentColor="#FFFFFFFF"}set color(n){this.currentColor=n;const e=Ro(n);this.uniforms.color=Float32Array.from(e)}get color(){return this.currentColor}}const tc=new Iu.ColorMatrixFilter;tc.matrix=[1,0,0,0,-.2,0,1,0,0,-.2,0,0,1,0,-.2,0,0,0,1,0];const Kd=new Iu.ColorMatrixFilter;Kd.matrix=[1,0,0,0,-.1,0,1,0,0,-.1,0,0,1,0,-.1,0,0,0,1,0];const ec=new Iu.ColorMatrixFilter;ec.matrix=[1,0,0,0,.2,0,1,0,0,.2,0,0,1,0,.2,0,0,0,1,0];const rh=new Iu.ColorMatrixFilter;rh.matrix=[1,0,0,0,.1,0,1,0,0,.1,0,0,1,0,.1,0,0,0,1,0];const qc={darken:tc,darkenLess:Kd,lightenLess:rh,lighten:ec};var oo=T(3),nc=T.n(oo);class Zc{constructor(n){this.scaleX=1,this.scaleY=1,this.pivot={x:0,y:0},this.paths=[],this.hash="",this.width=0,this.height=0,this.graphicsId="",this.textureId="",this.id=n.id,this.type=n.type,this.heightSize=n.heightSize,this.widthSize=n.widthSize,this.fillStyle=n.fillStyle||{fillType:"solidFill",color:"#ffffffff"},this.lineWidth=n.lineWidth||1,this.position=n.position||{x:0,y:0},this.rotate=n.rotation||1,this.path=this.getUnitPath(),this.setScaleFromLineWidth(),this.setScaleFromSize(),this.generatePaths(),this.setPivot()}setPivot(){switch(this.type){case"oval":case"diamond":this.pivot={x:this.width/2,y:this.height/2};break;case"arrow":case"stealth":case"triangle":default:this.pivot={x:this.width,y:this.height/2}}}generatePaths(){this.hash="arrow-"+nc()(this.path),this.paths=[{id:this.id,path:this.path,fill:"norm",hasStroke:!1,hash:this.hash,scale:{x:this.scaleX,y:this.scaleY}}]}getUnitPath(){switch(this.type){case"stealth":return"M 0,0 L 95250,47625 L 0,95250 L 28575,47625 C C";case"oval":return"M 0,47625 A 47625,47625,-3.14159265,6.2831853 C C";case"diamond":return"M 47625,0 L 95250,47625 L 47625,95250 L 0,47625 C C";case"arrow":return"M 9525,0 L 95250,47625 L 9525,95250 L 0,85725 L 68389.5,47625 L 0,9525 C C";case"triangle":return"M 0,0 L 95250,47625 L 0,95250 C C";default:return""}}setScaleFromLineWidth(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=.29*this.lineWidth+.7,this.scaleY*=.29*this.lineWidth+.7;break;default:throw new Error("can't match any arrow type!")}}setScaleFromSize(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=1,this.scaleY*=1;break;default:throw new Error("can't match any arrow type!")}switch(this.widthSize){case"sm":this.scaleX*=3/4;break;case"lg":this.scaleX*=1.25;break;case"med":this.scaleX*=1}switch(this.heightSize){case"sm":this.scaleY*=3/4;break;case"lg":this.scaleY*=1.25;break;case"med":this.scaleY*=1}this.width=10*this.scaleX,this.height=10*this.scaleY}}class ih extends Kh{constructor(n,e,r){super({position:{x:n.x,y:n.y},width:n.width,height:n.height},e,r),this.json=n,this.ctx=e,this.parentGlobalPos=r,this.global={x:r.x+n.x,y:r.y+n.y},this.updateTransform({position:{x:n.x,y:n.y},width:n.width,height:n.height})}get renderContainer(){return this.container}get interactiveContainer(){return this.container}getTextElement(){return null}getBgElement(){return null}get ppt_x(){return this.global.x/this.ctx.stageWidth}set ppt_x(n){const e=n*this.ctx.stageWidth-this.global.x,r=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=this.designX+e+this.container.pivot.x*r}get ppt_y(){return this.global.y/this.ctx.stageHeight}set ppt_y(n){const e=n*this.ctx.stageHeight-this.global.y,r=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=this.designY+e+this.container.pivot.y*r}get design_ppt_x(){return this.global.x/this.ctx.stageWidth}get design_ppt_y(){return this.global.y/this.ctx.stageHeight}}var Qd=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class Jc extends ih{constructor(n,e,r,s,l){super(n,e,r),this.lineWidth=s,this.lineHeight=l}getIterateEntry(){return null}getBgElement(){return null}preRender(){const{fill:n}=this.json;this.fillBgId=this.ctx.fillTexture.addFill(n.fill,this.lineWidth,this.lineHeight),this.fillTextureId=this.ctx.fillTexture.addFill({fillType:"blipFill",src:n.key,filters:[]},n.width,n.height)}render(){return Qd(this,void 0,void 0,function*(){const n=new Ci;if(this.json.highlightColor){const s=new vs,[l,h]=io(this.json.highlightColor);s.beginFill(l,h),s.drawRect(0,0,this.json.width,this.json.height),s.endFill(),n.addChild(s)}if(this.fillBgId&&this.fillTextureId){const s=this.ctx.fillTexture.getTexture(this.fillBgId),l=this.ctx.fillTexture.getTexture(this.fillTextureId);if(s&&l){const h=new li;h.texture=l,h.scale.x=.5,h.scale.y=.5;const m=new li;m.texture=s,m.mask=h,n.addChild(m),n.addChild(h)}}const e=Ri.create({width:this.json.width,height:this.json.height,resolution:2});this.ctx.renderer.render(n,{renderTexture:e});const r=new li;r.texture=e,this.container.addChild(r),this.container.name=this.json.content,n.destroy({children:!0})})}destroy(){this.container.destroy({children:!0,texture:!0})}}var Va=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class Hp extends ih{constructor(){super(...arguments),this.units=[]}getIterateElements(){return this.units}getIterateEntry(n,e,r){return this.units[e]?this.units[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",r),null)}preRender(){for(let n=0,e=this.json.textUnits.length;n<e;n++){const r=this.json.textUnits[n];if(r.fill.fill){const s=new Jc(r,this.ctx,this.global,this.json.width,this.json.height);s.preRender(),this.units.push(s)}}}render(){return Va(this,void 0,void 0,function*(){for(const n of this.units.reverse())yield n.render(),this.container.addChild(n.container)})}destroy(){this.units.forEach(n=>{n.destroy()}),this.container.destroy({children:!1})}}var $c=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class ts extends ih{constructor(){super(...arguments),this.iterateElements=[],this.lines=[]}getIterateElements(){if(this.iterateElements.length>0)return this.iterateElements;const n=this.lines.reduce((e,r)=>e=e.concat(r.getIterateElements()),[]);return this.iterateElements=n,n}getIterateEntry(n,e,r){const s=this.getIterateElements();return s[e]?s[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",r),null)}preRender(){for(let n=0,e=this.json.lines.length;n<e;n++){const r=this.json.lines[n],s=new Hp(r,this.ctx,this.global);s.container.name="line-"+n,s.preRender(),this.lines.push(s)}}render(){return $c(this,void 0,void 0,function*(){for(const n of this.lines)yield n.render(),this.container.addChild(n.container)})}destroy(){this.lines.forEach(n=>{n.destroy()}),this.container.destroy({children:!1})}}var tp=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class cl{constructor(n,e,r,s){this.iterateElements=[],this.paragraphs=[],this.container=new Ci,this.json=n,this.ctx=e,this.parentGlobalPos=s,this.iterateType=r,this.container.name="textBody",this.global={x:this.parentGlobalPos.x+n.position.x,y:this.parentGlobalPos.y+n.position.y},this.container.position.x=n.position.x,this.container.position.y=n.position.y;const l=new vs;l.drawRect(0,0,n.width,n.height),this.container.addChild(l)}updateScale(n){this.container.scale.x=n.x,this.container.scale.y=n.y}getTextElement(n,e){return n==="paragraph"?this.paragraphs[e[0]]:null}getIterateEntry(n,e){return this.iterateElements[n]?this.iterateElements[n]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",e),null)}destroy(){this.paragraphs.forEach(n=>{n.destroy()})}preRender(){for(let n=0,e=this.json.paragraphs.length;n<e;n++){const r=this.json.paragraphs[n],s=new ts(r,this.ctx,this.global);s.preRender(),this.iterateElements=this.iterateElements.concat(s.getIterateElements()),s.container.name="\u6BB5\u843D-"+n,this.paragraphs.push(s)}}render(){return tp(this,void 0,void 0,function*(){for(const e of this.paragraphs)yield e.render(),this.container.addChild(e.container);const{width:n}=this.container;this.container.scale.x<0&&(this.container.x+=-1*n)})}}var c=T(18),g=T.n(c),S=T(19),D=T.n(S);const H={Reflection:class extends ro{constructor(o){super(g.a,D.a,{uShapeFilterArea:new Float32Array([0,0,0,0]),uStartAlpha:o.startAlpha,uEndAlpha:o.endAlpha,uBlur:0}),this.json=o}}};var it=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};const vt={pivot:{x:0,y:0},width:0,height:0};class St extends Kh{constructor(n,e,r){var s,l,h,m;if(super(n,e,r),this.renderContainer=new Ci,this.bgTextureId="",this.bgSprite=new li,this.backgroundMaskTextureId="",this.filterAreaJustifies=[],this.backgroundMask=new li,this.pathStrokeTextureId="",this.pathSprite=new li,this.pathMask=new li,this.pathMaskTextureId="",this.fillColorFilter=new hl,this.strokeColorFilter=new hl,this.id="",this.arrowList=[],this.fill=new Zd(this),this.stroke=new kp(this),this.updateFilterArea=()=>{const x=this.renderContainer.getBounds(!1),b=this.filterAreaJustifies.map(B=>B(x)),w=b.map(B=>B.width),R=b.map(B=>B.height),U=new dr(x.x,x.y,Math.max(...w),Math.max(...R));this.renderContainer.filterArea=U,this.renderContainer.filters.forEach(B=>{B.uniforms.uShapeFilterArea=new Float32Array(4),B.uniforms.uShapeFilterArea[0]=U.x,B.uniforms.uShapeFilterArea[1]=U.y,B.uniforms.uShapeFilterArea[2]=U.width,B.uniforms.uShapeFilterArea[3]=U.height})},this.json=n,this.id=n.id,this.container.name=n.id,this.fillStyle=n.fillStyle,this.lineStyle=n.lineStyle,this.geometry=n.geometry,this.ctx.timingTargets.addTarget(this.id,this),((s=this.fillStyle)===null||s===void 0?void 0:s.fillType)==="solidFill"&&(this.fillColorFilter.currentColor=this.fillStyle.color),((h=(l=this.lineStyle)===null||l===void 0?void 0:l.fill)===null||h===void 0?void 0:h.fillType)==="solidFill"&&(this.strokeColorFilter.currentColor=this.lineStyle.fill.color),this.pathSprite.name="path-fill",this.pathMask.name="path-mask",this.bgSprite.name="bg-fill",this.backgroundMask.name="bg-mask",this.updateTransform(this.json),n.textBody){this.text=new cl(n.textBody,this.ctx,n.textBody.iterateType,{x:this.designGlobalPosition.x,y:this.designGlobalPosition.y});const x={x:1,y:1};((m=this.json.scale)===null||m===void 0?void 0:m.x)&&this.json.scale.x<0&&(x.x=-1),this.text.updateScale(x)}}get interactiveContainer(){return this.renderContainer}get strokeActive(){var n,e;return((e=(n=this.pathSprite.filters)===null||n===void 0?void 0:n.length)!==null&&e!==void 0?e:-1)>0}set strokeActive(n){var e,r;n?((r=(e=this.pathSprite.filters)===null||e===void 0?void 0:e.indexOf(this.strokeColorFilter))!==null&&r!==void 0?r:-1)<0&&(this.pathSprite.filters=[this.strokeColorFilter]):this.pathSprite.filters=[]}get fillActive(){var n,e;return((e=(n=this.bgSprite.filters)===null||n===void 0?void 0:n.length)!==null&&e!==void 0?e:-1)>0}set fillActive(n){var e,r;n?((r=(e=this.bgSprite.filters)===null||e===void 0?void 0:e.indexOf(this.fillColorFilter))!==null&&r!==void 0?r:-1)<0&&(this.bgSprite.filters=[this.fillColorFilter]):this.bgSprite.filters=[]}getTextElement(n,e){var r,s;return(s=(r=this.text)===null||r===void 0?void 0:r.getTextElement(n,e))!==null&&s!==void 0?s:null}getBgElement(){return this}getIterateEntry(n,e,r){return n==="el"||e===0?this:this.text?this.text.getIterateEntry(e-1,r)||null:(this.ctx.eventHub.emit("IterateTimeNodeEnd",r),null)}createBackgroundMask(){return it(this,void 0,void 0,function*(){const n=this.ctx.graphicsTexture.getGraphicsData(this.backgroundMaskTextureId);n&&(this.backgroundMask.texture=n.texture,this.backgroundMask.pivot.x=n.pivot.x,this.backgroundMask.pivot.y=n.pivot.y)})}createBackground(){var n,e,r,s,l,h,m;const{pivot:x,width:b,height:w}=((n=this.geometry)===null||n===void 0?void 0:n.fillTransform)||vt;if(((e=this.fillStyle)===null||e===void 0?void 0:e.fillType)==="gifFill"){const R=this.ctx.fillTexture.getGifFrames(this.fillStyle.src);this.bgSprite=new nh(R,!0),this.bgSprite.play();const U=this.fillStyle.fps/60;let B=1;const j=this.fillStyle.loop;this.bgSprite.animationSpeed=U,this.bgSprite.onLoop=()=>{B+=1,j>0&&B>j&&this.bgSprite.gotoAndStop(R.length-1)},this.bgSprite.height=w||this.designHeight,this.bgSprite.width=b||this.designWidth,this.bgSprite.mask=this.backgroundMask,this.bgSprite.x=x.x,this.bgSprite.y=x.y,this.container.addChild(this.backgroundMask),this.container.addChild(this.bgSprite)}else if(((r=this.fillStyle)===null||r===void 0?void 0:r.fillType)==="groupFill"){if(this.groupFillTextureId){const R=this.ctx.fillTexture.getTexture(this.groupFillTextureId);R&&(this.bgSprite.texture=R,this.bgSprite.mask=this.backgroundMask,this.bgSprite.x=-1*((l=(s=this.json.position)===null||s===void 0?void 0:s.x)!==null&&l!==void 0?l:0),this.bgSprite.y=-1*((m=(h=this.json.position)===null||h===void 0?void 0:h.y)!==null&&m!==void 0?m:0),this.container.addChild(this.bgSprite),this.container.addChild(this.backgroundMask))}}else{const R=this.ctx.fillTexture.getTexture(this.bgTextureId);R&&(this.bgSprite.texture=R,this.bgSprite.mask=this.backgroundMask,this.container.addChild(this.backgroundMask),this.container.addChild(this.bgSprite),this.bgSprite.height=w||this.designHeight,this.bgSprite.width=b||this.designWidth,this.bgSprite.x=x.x,this.bgSprite.y=x.y)}}createPathFill(){const n=this.ctx.fillTexture.getTexture(this.pathStrokeTextureId);n&&(this.pathSprite.texture=n,this.pathSprite.pivot.x=this.pathMask.pivot.x,this.pathSprite.pivot.y=this.pathMask.pivot.y,this.pathMask.pivot.x=0,this.pathMask.pivot.y=0,this.pathSprite.mask=this.pathMask,this.pathSprite.addChild(this.pathMask),this.container.addChild(this.pathSprite))}createPathMask(){return it(this,void 0,void 0,function*(){const n=this.ctx.graphicsTexture.getGraphicsData(this.pathMaskTextureId);if(n){const{texture:e,pivot:r}=n;this.pathMask.texture=e,this.pathMask.pivot.x=r.x,this.pathMask.pivot.y=r.y,this.pathMask.texture=e}})}createFilledPathMask(){var n,e;return it(this,void 0,void 0,function*(){const r=((e=(n=this.geometry)===null||n===void 0?void 0:n.paths)===null||e===void 0?void 0:e.filter(s=>s.fill!=="none"&&s.fill!=="norm"))||[];for(const s of r){const l=this.ctx.graphicsTexture.getGraphicsData(s.id);if(l){const h=new li(l.texture);h.pivot.x=l.pivot.x,h.pivot.y=l.pivot.y;const m=new li(this.bgSprite.texture);m.pivot.x=this.bgSprite.pivot.x,m.pivot.y=this.bgSprite.pivot.y,m.mask=h,m.filters=[qc[s.fill]],this.container.addChild(m),this.container.addChild(h)}}})}createBackgroundTexture(){var n,e,r,s,l;if(this.fillStyle&&this.fillStyle.fillType!=="gifFill"&&this.fillStyle.fillType!=="groupFill"){const h=((n=this.geometry)===null||n===void 0?void 0:n.fillTransform)||vt,m=(h==null?void 0:h.width)||this.designWidth,x=(h==null?void 0:h.height)||this.designHeight;this.bgTextureId=this.ctx.fillTexture.addFill(this.fillStyle,m+((r=(e=this.lineStyle)===null||e===void 0?void 0:e.width)!==null&&r!==void 0?r:0),x+((l=(s=this.lineStyle)===null||s===void 0?void 0:s.width)!==null&&l!==void 0?l:0))}}createPathFillTexture(){var n,e,r,s,l,h;if(((n=this.lineStyle)===null||n===void 0?void 0:n.fill)&&this.lineStyle.fill.fillType!=="gifFill"&&this.lineStyle.fill.fillType!=="groupFill"){const{width:m,height:x}=((e=this.geometry)===null||e===void 0?void 0:e.lineTransform)||vt;this.pathStrokeTextureId=this.ctx.fillTexture.addFill(this.lineStyle.fill,(m||this.designWidth)+((s=(r=this.lineStyle)===null||r===void 0?void 0:r.width)!==null&&s!==void 0?s:0),(x||this.designHeight)+((h=(l=this.lineStyle)===null||l===void 0?void 0:l.width)!==null&&h!==void 0?h:0))}}createArrowFillTexture(){var n;(n=this.json.lineArrowList)===null||n===void 0||n.forEach(e=>{var r,s,l;const h=new Zc(Object.assign(Object.assign({},e),{fillStyle:(r=this.lineStyle)===null||r===void 0?void 0:r.fill,lineWidth:(s=this.lineStyle)===null||s===void 0?void 0:s.width}));h.graphicsId=this.ctx.graphicsTexture.addGraphics((l=h.paths)!==null&&l!==void 0?l:[],h.hash,h.pivot||{x:0,y:0},h.width,h.height,void 0,!0),h.textureId=this.ctx.fillTexture.addFill(h.fillStyle,h.width,h.height),this.arrowList.push(h)})}createArrow(){this.arrowList.forEach(n=>{const e=this.ctx.graphicsTexture.getGraphicsData(n.graphicsId),r=this.ctx.fillTexture.getTexture(n.textureId);if(e&&r){const{texture:s,pivot:l}=e,h=new li(s);h.pivot.x=l.x,h.pivot.y=l.y;const m=new li(r);m.addChild(h),m.mask=h,m.position.x=n.position.x,m.position.y=n.position.y,m.pivot.x=n.pivot.x,m.pivot.y=n.pivot.y,m.width=n.width,m.height=n.height,m.rotation=n.rotate/180*Math.PI,n.sprite=m,this.container.addChild(m)}})}preRender(){var n,e,r,s,l,h,m,x,b,w;this.createBackgroundTexture(),this.createPathFillTexture(),this.createArrowFillTexture();const{width:R,height:U,pivot:B}=((n=this.geometry)===null||n===void 0?void 0:n.lineTransform)||vt,j=R||this.designWidth,K=U||this.designHeight;((e=this.geometry)===null||e===void 0?void 0:e.paths)&&this.geometry.paths.length>0&&(this.pathMaskTextureId=this.ctx.graphicsTexture.addGraphics((s=(r=this.geometry)===null||r===void 0?void 0:r.paths)!==null&&s!==void 0?s:[],this.geometry.hash,B||{x:0,y:0},j,K,this.lineStyle,!1),this.backgroundMaskTextureId=this.ctx.graphicsTexture.addGraphics((h=(l=this.geometry)===null||l===void 0?void 0:l.paths)!==null&&h!==void 0?h:[],this.geometry.hash,B||{x:0,y:0},j,K,this.lineStyle,!0));const ut=((x=(m=this.geometry)===null||m===void 0?void 0:m.paths)===null||x===void 0?void 0:x.filter(gt=>gt.fill!=="none"&&gt.fill!=="norm"))||[];for(const gt of ut)this.ctx.graphicsTexture.addGraphics([gt],gt.hash,(((b=this.geometry)===null||b===void 0?void 0:b.lineTransform)||vt).pivot,j,K,this.lineStyle,!0,gt.id);(w=this.text)===null||w===void 0||w.preRender()}subClassRender(){return it(this,void 0,void 0,function*(){})}setupEffect(){const{effectList:n}=this.json;if(n&&n.length>0){const e=[];return n.forEach(r=>{r.type==="reflection"&&(this.filterAreaJustifies.push(s=>(s.height*=2,s)),e.push(new H.Reflection(r)))}),this.ctx.ticker.add(this.updateFilterArea,void 0,-20),this.renderContainer.filters=e,!0}return!1}render(){var n,e,r,s,l,h,m;return it(this,void 0,void 0,function*(){yield this.createBackgroundMask(),yield this.createBackground(),yield this.subClassRender(),yield this.createFilledPathMask(),yield this.createPathMask(),yield this.createPathFill(),yield this.createArrow(),this.text&&(yield this.text.render()),((n=this.json.textBody)===null||n===void 0?void 0:n.iterateType)==="wd"||((e=this.json.textBody)===null||e===void 0?void 0:e.iterateType)==="lt"?(this.renderContainer.addChild(this.container),this.text&&(this.text.container.position.x=(s=(r=this.json.position)===null||r===void 0?void 0:r.x)!==null&&s!==void 0?s:0,this.text.container.position.y=(h=(l=this.json.position)===null||l===void 0?void 0:l.y)!==null&&h!==void 0?h:0,this.renderContainer.addChild(this.text.container))):(this.text&&this.container.addChild((m=this.text)===null||m===void 0?void 0:m.container),this.renderContainer.addChild(this.container)),this.json.cacheAsBitMap&&(this.renderContainer.cacheAsBitmap=!0)})}destroy(){this.bgSprite.destroy(),this.backgroundMask.destroy(),this.pathSprite.destroy(),this.pathMask.destroy(),this.fillColorFilter.destroy(),this.strokeColorFilter.destroy(),this.arrowList.forEach(n=>{var e;(e=n.sprite)===null||e===void 0||e.destroy()})}}var Ft=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};function ae(o,n){for(const e in n)o.style[e]=n[e]}class le{constructor(n){var e,r;this.progress=document.createElement("div"),this.totalTime=document.createElement("span"),this.playButton=document.createElement("div"),this.pauseButton=document.createElement("div"),this.currentTime=document.createElement("span"),this.mediaController=document.createElement("div"),this.currentProgress=document.createElement("div"),this.playCallBackList=[],this.duration=0,this.start=0,this.end=0,this.changeMediaProgress=s=>{s.stopPropagation();const l=s.offsetX/this.progress.clientWidth*this.duration;this.jumpToTime(l),this.ctx.eventHub.emit(xr.mediaSeek,{id:this.targetId,time:this.media.currentTime,isPlaying:this.media.isPlaying})},this.jumpToTime=(s=0)=>{const l=Math.floor(s)+this.start;this.media.currentTime!==l&&(this.media.currentTime=l,(this.media.paused||this.media.ended)&&setTimeout(()=>{this.media.play().then(()=>this.media.pause())}))},this.showController=s=>{s.stopPropagation(),this.show()},this.getMediaDuration=()=>{this.duration&&!Number.isNaN(this.duration)||(this.duration=this.media.duration,this.end?this.start?this.duration=this.duration-this.end-this.start:this.duration-=this.end:this.start&&(this.duration-=this.start)),this.totalTime.innerText=le.formatTime(this.duration)},this.playMedia=()=>Ft(this,void 0,void 0,function*(){this.playButton.style.display="none",this.pauseButton.style.display="block",yield this.media.play(),this.playCallBackList.forEach(s=>{s()})}),this.pauseMedia=()=>Ft(this,void 0,void 0,function*(){this.playButton.style.display="block",this.pauseButton.style.display="none",yield this.media.pause()}),this.onMouseOut=s=>{s.stopPropagation(),this.mediaController.style.display="none"},this.mediaTimeUpdate=()=>Ft(this,void 0,void 0,function*(){const s=this.media.currentTime-this.start;(s>this.duration||this.media.ended)&&(yield this.pauseMedia(),this.jumpToTime()),this.currentTime.innerText=le.formatTime(s),this.currentProgress.style.flex=(s/this.duration).toString()}),this.onPauseMedia=()=>{this.playButton.style.display="block",this.pauseButton.style.display="none"},this.onPlayMedia=()=>{this.playButton.style.display="none",this.pauseButton.style.display="block",this.playCallBackList.forEach(s=>{s()})},this.playMediaFromCtrl=()=>{this.ctx.eventHub.emit(xr.mediaPlay,{id:this.targetId,time:this.media.currentTime}),this.playMedia()},this.pauseMediaFromCtrl=()=>{this.ctx.eventHub.emit(xr.mediaPause,{id:this.targetId,time:this.media.currentTime}),this.pauseMedia()},this.targetId=n.targetId,this.ctx=n.ctx,this.height=n.height,this.width=n.width,this.position=n.position,this.media=n.media,this.info=n.info,this.canvasElement=n.canvasElement,this.getMedianContainer(),this.createMediaController(),this.info.cut&&(this.start=(e=this.info.cut.start)!==null&&e!==void 0?e:0,this.end=(r=this.info.cut.end)!==null&&r!==void 0?r:0)}getMedianContainer(){let n=document.getElementById("median-container");n||(n=document.createElement("div"),n.id="median-container",this.canvasElement.parentElement.appendChild(n)),this.container=n}static formatTime(n){let e="00:00";if(n){const r=Math.floor(n/60),s=String(r<0?0:r).padStart(2,"0"),l=Math.floor(n%60);e=`${s}:${String(l<0?0:l).padStart(2,"0")}`}return e}createButton(){const n={marginLeft:"15px",marginRight:"10px",fontSize:"0",height:"20px"};ae(this.playButton,Object.assign(Object.assign({},n),{display:"block"}));const e=document.createElement("img");ae(e,{height:"20px"}),e.src="https://convertcdn.netless.link/publicFiles/icon/play.png",this.playButton.appendChild(e),ae(this.pauseButton,Object.assign(Object.assign({},n),{display:"none"}));const r=document.createElement("img");ae(r,{height:"20px"}),r.src="https://convertcdn.netless.link/publicFiles/icon/pause.png",this.pauseButton.appendChild(r)}createTimer(){const n=document.createElement("div");ae(n,{width:"100px"}),this.currentTime.innerText="00:00";const e=document.createElement("span");return e.innerText="/",n.append(this.currentTime,e,this.totalTime),n}createProgress(){ae(this.progress,{flex:"1",position:"relative",marginRight:"10px"});const n=document.createElement("div");ae(n,{background:"#D9D9D9",position:"relative",height:"10px",display:"flex"}),this.progress.appendChild(n),ae(this.currentProgress,{background:"#4F4F4F",top:"0px",left:"0",height:"10px",flex:"0"}),n.appendChild(this.currentProgress)}bindEvent(){this.mediaController.addEventListener("mouseover",this.showController,!1),this.mediaController.addEventListener("mouseout",this.onMouseOut,!1),this.progress.addEventListener("mousedown",this.changeMediaProgress,!1),this.playButton.addEventListener("click",this.playMediaFromCtrl,!1),this.pauseButton.addEventListener("click",this.pauseMediaFromCtrl,!1),this.media.on("durationchange",this.getMediaDuration,!1),this.media.on("timeupdate",this.mediaTimeUpdate,!1),this.media.on("pause",this.onPauseMedia,!1),this.media.on("play",this.onPlayMedia,!1)}createMediaController(){var n,e;const{position:r}=this,s=(e=(n=this.canvasElement.parentElement)===null||n===void 0?void 0:n.offsetWidth)!==null&&e!==void 0?e:0;r.x=r.x>s/2?r.x-300+this.width:r.x,r.y=r.y+this.height/2-25,ae(this.mediaController,{height:"50px",borderRadius:"50px",width:"300px",flexDirection:"row",alignItems:"center",position:"absolute",left:r.x+"px",top:r.y+"px",display:"none",background:"#fff",zIndex:"2",border:"1px solid #ccc"}),this.createButton();const l=this.createTimer();this.createProgress(),this.mediaController.append(this.playButton,this.pauseButton,l,this.progress),this.container.appendChild(this.mediaController),this.bindEvent()}addPlayCallBack(n){this.playCallBackList.push(n)}unbindEvent(){this.mediaController.removeEventListener("mouseover",this.showController,!1),this.progress.removeEventListener("mousedown",this.changeMediaProgress,!1),this.playButton.removeEventListener("click",()=>this.playMedia(),!1),this.pauseButton.removeEventListener("click",()=>this.pauseMedia(),!1),this.media.removeListener("durationchange",this.getMediaDuration,!1),this.media.removeListener("timeupdate",this.mediaTimeUpdate,!1),this.media.removeListener("pause",this.onPauseMedia,!1),this.media.removeListener("play",this.onPlayMedia,!1)}show(){this.mediaController.style.display="flex"}hide(){this.mediaController.style.display="none"}destroy(){var n;this.unbindEvent(),this.playCallBackList=[],(n=this.container)===null||n===void 0||n.removeChild(this.mediaController)}}var Oe=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class mn extends Z.a{constructor(n){var e,r;super(),this.type="video",this.sprite=new li,this.isPlaying=!1,this.id=n.id,this.video=n.video,this.start=(e=n.video.cut)===null||e===void 0?void 0:e.start,this.end=(r=n.video.cut)===null||r===void 0?void 0:r.end,this.container=n.container,this.ctx=n.ctx,this.ctx.medias[this.id]=this,this.videoResource=new zu(this.video.src,{autoLoad:!0,autoPlay:!1,updateFPS:30,crossorigin:!0});const{video:s,width:l,height:h,position:m}=n;this.controller=new le({targetId:n.id,ctx:n.ctx,width:l,height:h,position:m,media:this,info:s,canvasElement:n.canvasElement}),this.controller.addPlayCallBack(()=>{this.sprite.width=l,this.sprite.height=h,setTimeout(()=>{this.sprite.visible=!0},50)});const x=new fr(null,{height:h,width:l});x.resource=this.videoResource,this.videoResource.bind(x),this.sprite=new li,this.sprite.visible=!1,this.sprite.texture=new Dn(x),this.sprite.interactive=!0,this.container.addChild(this.sprite),this.sprite.on("mouseover",b=>{b.stopPropagation(),this.controller.show()}),this.sprite.on("mouseout",b=>{b.stopPropagation(),this.controller.hide()}),["durationchange","timeupdate","pause","play"].forEach(b=>{this.videoResource.source.addEventListener(b,()=>{b!=="timeupdate"||this.isPlaying||this.pause(),this.emit(b)})})}get currentTime(){var n,e;return(e=(n=this.videoResource.source)===null||n===void 0?void 0:n.currentTime)!==null&&e!==void 0?e:0}set currentTime(n){this.videoResource.source&&(this.videoResource.source.currentTime=n)}get paused(){var n,e;return(e=(n=this.videoResource.source)===null||n===void 0?void 0:n.paused)===null||e===void 0||e}get ended(){var n,e;return(e=(n=this.videoResource.source)===null||n===void 0?void 0:n.ended)===null||e===void 0||e}get duration(){var n,e;return(e=(n=this.videoResource.source)===null||n===void 0?void 0:n.duration)!==null&&e!==void 0?e:0}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){var n;return Oe(this,void 0,void 0,function*(){this.isPlaying=!0,yield this.load(),yield(n=this.videoResource.source)===null||n===void 0?void 0:n.play()})}load(){return this.videoResource.load()}pause(){var n;this.isPlaying=!1,(n=this.videoResource.source)===null||n===void 0||n.pause()}togglePause(){this.isPlaying?this.pause():this.play()}seek(n){this.controller.jumpToTime(n)}destroy(){var n;this.sprite.interactive=!1,this.sprite.destroy({texture:!0,baseTexture:!0}),(n=this.videoResource)===null||n===void 0||n.destroy(),this.controller.destroy()}}var gn=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class Cn extends Z.a{constructor(n){super(),this.type="audio",this.isPlaying=!1,this.id=n.id,this.audio=n.audio,this.container=n.container,this.container=n.container,this.audioEl=document.createElement("audio"),this.audioEl.src=this.audio.src,n.audio.cut&&(this.start=n.audio.cut.start,this.end=n.audio.cut.end),this.ctx=n.ctx,this.ctx.medias[this.id]=this;const{width:e,height:r,position:s}=n;this.controller=new le({targetId:n.id,ctx:n.ctx,height:r,width:e,position:s,media:this,info:this.audio,canvasElement:n.canvasElement}),["durationchange","timeupdate","pause","play"].forEach(l=>{this.audioEl.addEventListener(l,()=>{this.emit(l)})})}get currentTime(){return this.audioEl.currentTime}set currentTime(n){this.audioEl.currentTime=n}get paused(){return this.audioEl.paused}get ended(){return this.audioEl.ended}get duration(){return this.audioEl.duration}load(){return Promise.resolve()}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){return gn(this,void 0,void 0,function*(){this.isPlaying=!0,yield this.audioEl.play()})}pause(){this.isPlaying=!1,this.audioEl.pause()}togglePause(){this.isPlaying?this.pause():this.play()}seek(n){this.controller.jumpToTime(n)}destroy(){this.audioEl.pause(),this.controller.destroy()}}var Se=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class Xe extends St{constructor(n,e,r){super(Object.assign(Object.assign({},n),{type:"Shape"}),e,r),this.picTextureId="",this.picSprite=new li,this.picMask=new li,this.cmd=new Xc(this),this.picFill=n.picFill,this.media=n==null?void 0:n.media}applyCommand(n,e){var r,s,l,h,m;if(e==="call")if(/playFrom\(([0-9.]+)\)/.test(n)){const x=n.match(/playFrom\(([0-9.]+)\)/),b=Number(x[1]||"0");(r=this.mediaPlayer)===null||r===void 0||r.play().then(()=>{var w;(w=this.mediaPlayer)===null||w===void 0||w.seek(b)})}else n==="custom-pause"?(s=this.mediaPlayer)===null||s===void 0||s.pause():n==="togglePause"?(l=this.mediaPlayer)===null||l===void 0||l.togglePause():n==="stop"&&((h=this.mediaPlayer)===null||h===void 0||h.pause(),(m=this.mediaPlayer)===null||m===void 0||m.seek(0))}renderPic(){var n,e,r;return Se(this,void 0,void 0,function*(){const s=this.ctx.fillTexture.getTexture(this.picTextureId);s&&(this.picSprite.texture=s),this.picMask.texture=this.backgroundMask.texture,this.picSprite.mask=this.picMask,this.picSprite.width=this.designWidth,this.picSprite.height=this.designHeight,this.container.addChild(this.picSprite),this.container.addChild(this.picMask),((n=this.media)===null||n===void 0?void 0:n.type)==="video"?(this.mediaPlayer=new mn({id:this.json.id+"-video",ctx:this.ctx,video:this.media,height:this.designHeight,width:this.designWidth,position:this.picSprite.getGlobalPosition(),container:this.container,canvasElement:this.ctx.view}),((e=this.mediaPlayer)===null||e===void 0?void 0:e.sprite)&&(this.mediaPlayer.sprite.mask=this.picMask)):((r=this.media)===null||r===void 0?void 0:r.type)==="audio"&&(this.mediaPlayer=new Cn({id:this.json.id+"-audio",ctx:this.ctx,audio:this.media,height:this.designHeight,width:this.designWidth,position:this.picSprite.getGlobalPosition(),container:this.container,canvasElement:this.ctx.view})),this.mediaPlayer&&(this.picSprite.interactive=!0,this.picSprite.on("mouseover",()=>{this.mediaPlayer.showController()}),this.picSprite.on("mouseout",()=>{this.mediaPlayer.hideController()},!1))})}preRender(){if(super.preRender(),this.picFill.fillType!=="gifFill")this.picTextureId=this.ctx.fillTexture.addFill(this.picFill,this.designWidth,this.designHeight);else{let n=1;const e=this.ctx.fillTexture.getGifFrames(this.picFill.src);this.picSprite=new nh(e,!0),this.picSprite.play();const r=this.picFill.fps/60,s=this.picFill.loop;this.picSprite.animationSpeed=r,this.picSprite.onLoop=()=>{n+=1,s>0&&n>s&&this.picSprite.gotoAndStop(e.length-1)}}}subClassRender(){return Se(this,void 0,void 0,function*(){yield this.renderPic()})}destroy(){this.mediaPlayer&&(this.picSprite.interactive=!1,this.mediaPlayer.destroy(),this.mediaPlayer=void 0),this.picSprite.destroy(),this.picMask.destroy()}}var Xn=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class dn extends Kh{constructor(n,e,r){var s,l,h,m;super(n,e,r),this.children=[],this.cacheSprite=new li,this.json=n,this.container.name=n.id,this.ctx.timingTargets.addTarget(n.id,this);const x={x:(l=(s=n.position)===null||s===void 0?void 0:s.x)!==null&&l!==void 0?l:0,y:(m=(h=n.position)===null||h===void 0?void 0:h.y)!==null&&m!==void 0?m:0};n.children.forEach(b=>{let w=null;(b==null?void 0:b.type)==="Shape"?w=new St(b,this.ctx,x):(b==null?void 0:b.type)==="Picture"?w=new Xe(b,this.ctx,x):(b==null?void 0:b.type)==="Container"&&(w=new dn(b,this.ctx,x)),w&&this.children.push(w)}),this.updateTransform(this.json)}get interactiveContainer(){return this.container}get renderContainer(){return this.container}preRender(){if(this.json.fillStyle)if(this.json.fillStyle.fillType==="groupFill")this.fillTextureId=this.groupFillTextureId;else{const{fillStyle:n,width:e,height:r}=this.json;this.fillTextureId=this.ctx.fillTexture.addFill(n,e,r)}for(const n of this.children)n.groupFillTextureId=this.fillTextureId,n.preRender()}getBgElement(){return null}getIterateEntry(){return null}getTextElement(){return null}render(){var n;return Xn(this,void 0,void 0,function*(){const e=new Ci;for(const r of this.children)yield r.render(),r.renderContainer&&e.addChild(r.renderContainer),(r.json.hlinkHover||r.json.hlinkClick)&&((n=r.hyperlink)===null||n===void 0||n.addProxy(this.container));if(this.container.addChild(e),this.json.cacheAsTexture){const r=e.getBounds(),s=Math.min(r.x,this.designX,r.x+r.width,this.designX+this.designWidth),l=Math.max(r.x,this.designX,r.x+r.width,this.designX+this.designWidth),h=Math.min(r.y,this.designY,r.y+r.height,this.designY+this.designHeight),m=l-s,x=Math.max(r.y,this.designY,r.y+r.height,this.designY+this.designHeight)-h,b=this.designX-r.x,w=this.designY-r.y,R=Ri.create({width:m,height:x});e.position.x=b,e.position.y=w,this.ctx.renderer.render(e,{renderTexture:R}),this.cacheSprite.texture=R,this.cacheSprite.position.x=-b,this.cacheSprite.position.y=-w,this.container.addChild(this.cacheSprite),e.position.x=0,e.position.y=0,e.visible=!1}})}destroy(){this.cacheSprite&&this.cacheSprite.destroy({texture:!0}),this.children.forEach(n=>n.destroy()),this.container.destroy()}}class Fn extends Z.a{constructor(n,e,r,s){super(),this.cond={},this.timeoutIds=[],this.condHandle=l=>{if(l)if(l.delay&&l.delay>0){const h=this.setTimeout(()=>{l.event&&(this.cond[l.event]=!0,this.detectTrigger())},l.delay);this.timeoutIds.push(h)}else this.cond[l.event]=!0,this.detectTrigger();else this.detectTrigger()},this.id=n,this.ctx=s,this.eventHubs=r,e.forEach(l=>{this.addCond(l)})}setTriggerParams(n){this.triggerParams=n}addCond(n){const e=()=>this.condHandle(n);n.event&&(/^shape/.test(n.event)||/^time/.test(n.event)?(this.cond[n.event]=!1,this.eventHubs.global.addListener(n.event,e)):/^runtime/.test(n.event)?(this.cond[n.event]=!1,this.eventHubs.runtime.addListener(n.event,e)):/^self/.test(n.event)?n.delay&&n.delay>0&&(this.cond[n.event]=!1,this.eventHubs.runtime.addListener(n.event,e)):this.cond[n.event]=!1)}setTimeout(n,e){let r=0;const s=l=>{r+=l/(ie.TARGET_FPMS||.06),r>=e&&(n(),this.ctx.ticker.remove(s))};return this.ctx.ticker.add(s,void 0,-9),()=>{this.ctx.ticker.remove(s)}}isTrigger(){return Object.keys(this.cond).every(n=>!!this.cond[n])}isTriggerWithoutParent(){return Object.keys(this.cond).filter(n=>n!=="self").every(n=>!!this.cond[n])}detectTrigger(){if(Object.keys(this.cond).every(n=>!!this.cond[n])){Object.keys(this.cond).forEach(e=>{this.cond[e]=!1});const n=this.triggerParams;this.triggerParams=void 0,this.emit("active",n)}}reset(){Object.keys(this.cond).forEach(n=>{this.cond[n]=!1}),this.timeoutIds.forEach(n=>n())}}class An extends Z.a{constructor(n){super(),this.runtimeNodeEventHub=new Z.a,this._currentSeqIndex=0,this._currentSeqState="idle",this.isForward=!0,this.autoPlay=!1,this.handlePrev=()=>{var R,U,B,j,K,ut;this.hasPrev()||!this.isMainSeq?this.currentSeqState==="idle"?(this.decrSeqIndex(),(R=this.commonTimeNode.children[this.currentSeqIndex])===null||R===void 0||R.commonTimeNode.seekToStart(),(U=this.commonTimeNode.children[this.currentSeqIndex])===null||U===void 0||U.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="running"?((B=this.commonTimeNode.children[this.currentSeqIndex])===null||B===void 0||B.commonTimeNode.seekToStart(),(j=this.commonTimeNode.children[this.currentSeqIndex])===null||j===void 0||j.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="end"&&(this.currentSeqIndex>=this.commonTimeNode.children.length&&(this.currentSeqIndex=this.commonTimeNode.children.length-1),(K=this.commonTimeNode.children[this.currentSeqIndex])===null||K===void 0||K.commonTimeNode.seekToStart(),(ut=this.commonTimeNode.children[this.currentSeqIndex])===null||ut===void 0||ut.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.globalEventHub.emit("c:prev slide")},this.handleNext=()=>{var R,U,B,j;this.hasNext()||!this.isMainSeq?this.currentSeqState==="idle"?(R=this.commonTimeNode.children[this.currentSeqIndex])===null||R===void 0||R.commonTimeNode.startTimeNodeForce():this.currentSeqState==="running"?((U=this.commonTimeNode.children[this.currentSeqIndex])===null||U===void 0||U.commonTimeNode.seekToEnd(!1,!0),this.currentSeqState="end",this.incrSeqIndex(),(B=this.commonTimeNode.children[this.currentSeqIndex])===null||B===void 0||B.commonTimeNode.startTimeNodeForce()):this.currentSeqState==="end"&&(this.incrSeqIndex(),(j=this.commonTimeNode.children[this.currentSeqIndex])===null||j===void 0||j.commonTimeNode.startTimeNodeForce()):this.globalEventHub.emit("c:next slide")};const{json:e,iterateType:r,isIterate:s,isSub:l,parent:h,ctx:m,eventHub:x,iterateIndex:b,iterateId:w}=n;this.isMainSeq=e.ctn.nodeType==="mainSeq",this.id=e.ctn.id,this.isIterate=s,this.json=e,this.ctx=m,this.globalEventHub=x,this.commonTimeNode=new Kc({json:e.ctn,isSub:l,eventHubs:{global:x,runtime:this.runtimeNodeEventHub},ctx:m,parent:h,isIterate:!1,iterateType:r,iterateIndex:b,iterateId:w}),this.bindShapeEvent(),this.nextConds=new Fn("mainSeq",e.nextCondLst,{global:x,runtime:this.runtimeNodeEventHub},this.ctx),this.prevConds=new Fn("mainSeq",e.preCondLst,{global:x,runtime:this.runtimeNodeEventHub},this.ctx),this.commonTimeNode.on("timeNodeRestart",()=>{this.currentSeqIndex=0,this.currentSeqState="idle"}),this.commonTimeNode.on("childTimeNodeStart",R=>{const U=this.commonTimeNode.children.findIndex(B=>B.commonTimeNode.uuid===R.id);U>=0&&(this.currentSeqIndex=U),this.currentSeqState="running",this.isMainSeq&&this.ctx.eventHub.emit(xr.mainSeqStepStart,U)}),this.commonTimeNode.on("childTimeNodeEnd",R=>{const U=this.commonTimeNode.children.findIndex(B=>B.commonTimeNode.uuid===R.id);U>=0&&(this.currentSeqIndex=U),this.currentSeqState="end",this.autoPlay&&setTimeout(()=>{this.handleNext()}),this.isMainSeq&&this.ctx.eventHub.emit(xr.mainSeqStepEnd,U)}),this.commonTimeNode.on("timeNodeEndSync",()=>{this.commonTimeNode.resetForRepeat(),setTimeout(()=>{this.currentSeqState="idle",this.currentSeqIndex=0})}),this.nextConds.on("active",this.handleNext),this.prevConds.on("active",this.handlePrev)}get currentSeqIndex(){return this._currentSeqIndex}set currentSeqIndex(n){this._currentSeqIndex=n,this.isMainSeq&&this.ctx.eventHub.emit(xr.mainSeqStepChange,n)}get currentSeqState(){return this._currentSeqState}set currentSeqState(n){this._currentSeqState=n,this.isMainSeq&&this.ctx.eventHub.emit(xr.mainSeqStateChange,n)}get stepLength(){return this.commonTimeNode.children.length}get currentStep(){return this.currentSeqIndex}get currentState(){return this.currentSeqState}startAutoPlay(){this.autoPlay=!0,this.commonTimeNode.children[0].commonTimeNode.startTimeNodeForce()}incrSeqIndex(){this.currentSeqIndex+1<=this.commonTimeNode.children.length&&(this.currentSeqIndex+=1)}decrSeqIndex(){this.currentSeqIndex-1>=-1&&(this.currentSeqIndex-=1)}hasPrev(){return!(this.currentSeqIndex<=0&&this.currentSeqState==="idle")}hasNext(){return!(this.currentSeqIndex>=this.commonTimeNode.children.length||this.currentSeqIndex===this.commonTimeNode.children.length-1&&this.currentSeqState==="end")}bindShapeEvent(){this.json.ctn.nodeType==="interactiveSeq"&&this.json.nextCondLst.forEach(n=>{if(/^shape/.test(n.event)){const e=n.event.split(" ")[1];if(e){const r=this.ctx.timingTargets.getTargetById(e);r&&(r.interactiveContainer.interactive=!0,r.interactiveContainer.cursor="pointer",r.interactiveContainer.on("pointerdown",()=>{const s=`shape ${e} onClick`;this.ctx.mode!=="interactive"&&this.ctx.mode!=="sync"||this.ctx.eventHub.emit(xr.interactiveAnimTrigger,{action:s,seqId:this.json.ctn.id}),this.ctx.mode!=="sync"&&this.ctx.mode!=="local"||this.globalEventHub.emit(s)}))}}})}setCurrentStep(n,e){let r=n;this.commonTimeNode.seekToStart();const{length:s}=this.commonTimeNode.children;if(r===-1&&(r=s-1),r>=0&&r<s)for(let l=0;l<=r;l++){const h=this.commonTimeNode.children[l];l!==r?h.commonTimeNode.seekToEnd(!1,!0):e==="start"?h.commonTimeNode.seekToStart():e==="end"&&h.commonTimeNode.seekToEnd(!1,!0)}this.currentSeqIndex=r,this.currentSeqState=e==="start"?"idle":"end"}}function jn(o,n,e){const r=n.split(".");r.reduce((s,l,h)=>{if(s)return h!==r.length-1?s[l]:void(s[l]=e);console.warn(`${o} not support ${n}`)},o)}function Mn(o,n){return n.split(".").reduce((e,r)=>{if(e)return e[r];console.warn(`${o} not support ${n}`)},o)}const Vn=new class{constructor(){this.runningTimeNodes={}}addRunningTimeNode(o,n,e){const r=`${n}_${o}`;this.runningTimeNodes[r]&&this.runningTimeNodes[r].dispose(!0),this.runningTimeNodes[r]=e}};class Vr{constructor(n){this.timingTarget=null,this.runtimeNodeEventHub=new Z.a,this.onTimeLineStart=()=>{if(this.isConflict){const{target:R}=this.json.cBhvr;if(this.activeWhenConflict==="next"){let U=R.id;R.type==="shape"&&R.txEl&&(U=`${U}-txEl-${R.txEl.range[0]}`),this.commonTimeNode.isIterate&&(U=`${U}-iterate-${this.commonTimeNode.iterateIndex}`),Vn.addRunningTimeNode(U,this.modifyAttrKey,this.commonTimeNode)}else this.activeWhenConflict==="prev"&&this.commonTimeNode.dispose()}};const{isIterate:e,isSub:r,json:s,ctx:l,parent:h,eventHub:m,iterateType:x,iterateIndex:b,iterateId:w}=n;this.json=s,this.id=s.cBhvr.ctn.id,this.ctx=l,this.globalEventHub=m,this.commonTimeNode=new Kc({json:s.cBhvr.ctn,isSub:r,eventHubs:{global:m,runtime:this.runtimeNodeEventHub},ctx:l,parent:h,isIterate:e,iterateType:x,iterateIndex:b,iterateId:w}),this.timingTarget=this.ctx.timingTargets.getTarget(s.cBhvr.target,e,{type:x,index:b,id:w}),this.commonTimeNode.on("seekToStart",()=>this.onSeekToStart()),this.commonTimeNode.on("seekToEnd",()=>this.onSeekToEnd()),this.commonTimeNode.on("timelineStart",this.onTimeLineStart)}}class _o extends Vr{constructor(n){super(n),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.updateStartValue=()=>{this.timingTarget&&(this.startVal=Mn(this.timingTarget,this.json.cBhvr.attrList[0]))},this.onSeekToStart=()=>{const e=this.json.cBhvr.attrList[0];this.startVal!==null&&this.timingTarget&&jn(this.timingTarget,e,this.startVal)},this.onSeekToEnd=()=>{const e=this.json.cBhvr.attrList[0],r=this.json.cBhvr.to||this.json.to;r&&this.timingTarget&&jn(this.timingTarget,e,r)},this.commonTimeNode.on("timeNodeStart",this.updateStartValue),this.commonTimeNode.on("timeNodeCreate",this.updateStartValue),this.commonTimeNode.on("timeUpdate",({duration:e,delta:r})=>{if(r/e>=1){const s=this.json.cBhvr.attrList[0];this.json.cBhvr.attrList.length>1&&console.warn("this.json.cBhvr.attrList.length > 0");const l=this.json.cBhvr.to||this.json.to;l&&this.timingTarget&&jn(this.timingTarget,s,l)}})}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}}class es{constructor(n,e){this.math={pi:Math.PI,e:Math.E,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,cosh:Math.cosh,deg:r=>r/Math.PI*180,exp:Math.exp,floor:Math.floor,ln:Math.log,max:Math.max,min:Math.min,rad:r=>r/180*Math.PI,rand:Math.random,sin:Math.sin,sinh:Math.sinh,sqrt:Math.sqrt,tan:Math.tan,tanh:Math.tanh},this.timingTarget=e,this.val=n.val.value,this.time=n.time,n.fmla&&(this.fmla=this.parseFmla(n.fmla))}parseFmla(n){let e=n.replaceAll("#ppt_h",`(${this.timingTarget.design_ppt_h})`);return e=e.replaceAll("#ppt_w",`(${this.timingTarget.design_ppt_w})`),e=e.replaceAll("#ppt_x",`(${this.timingTarget.design_ppt_x})`),e=e.replaceAll("#ppt_y",`(${this.timingTarget.design_ppt_y})`),e=e.replaceAll("ppt_w","vars.ppt_w"),e=e.replaceAll("ppt_h","vars.ppt_h"),e=e.replaceAll("ppt_x","vars.ppt_x"),e=e.replaceAll("ppt_y","vars.ppt_y"),e=e.replaceAll("#","vars."),["abs","acos","asin","atan","ceil","cos","cosh","deg","exp","floor","ln","max","min","rad","rand","sin","sinh","sqrt","tan","tanh","pi","e"].forEach(r=>{e=e.replaceAll(r,"math."+r)}),new Function("vars","math","$","return "+e)}}class Bi extends es{constructor(n,e,r){super(n,e),this.value=n.val.value,r&&(this.fmla=this.parseFmla(r))}resolveValue(){return this.value}interpolationFrom(n,e,r){const s=n.resolveValue(r),l=s+(this.resolveValue()-s)*e;return n.fmla?n.fmla(r,this.math,l):l}}class Js extends es{constructor(n,e){var r;super(n,e),this.value=(r=n.val)===null||r===void 0?void 0:r.value}interpolationFrom(n,e,r){let s=n.resolveValue(r);return e>this.time&&(s=this.resolveValue()),s}resolveValue(){return this.value||""}}class xs extends es{constructor(n,e){super(n,e),this.fn=this.parseFmla(this.val)}resolveValue(n){return this.fn(n,this.math,1)}interpolationFrom(n,e,r){const s=n.resolveValue(r),l=s+(this.resolveValue(r)-s)*e;return n.fmla?n.fmla(r,this.math,l):l}}class Wa extends Vr{constructor(n){super(n),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.vars={ppt_x:0,ppt_y:0,ppt_w:0,ppt_h:0},this.keyFrames=[],this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal=Mn(this.timingTarget,this.json.cBhvr.attrList[0]))},this.updateVars=()=>{var e,r,s,l;((e=this.timingTarget)===null||e===void 0?void 0:e.ppt_h)&&(this.vars.ppt_h=this.timingTarget.ppt_h),((r=this.timingTarget)===null||r===void 0?void 0:r.ppt_w)&&(this.vars.ppt_w=this.timingTarget.ppt_w),((s=this.timingTarget)===null||s===void 0?void 0:s.ppt_x)&&(this.vars.ppt_x=this.timingTarget.ppt_x),((l=this.timingTarget)===null||l===void 0?void 0:l.ppt_y)&&(this.vars.ppt_y=this.timingTarget.ppt_y)},this.onTimeUpdate=({duration:e,delta:r})=>{const s=r/e,l=this.keyFrames.findIndex(R=>s<=R[0]);if(l<0){const R=this.keyFrames[this.keyFrames.length-1];return void(this.timingTarget&&jn(this.timingTarget,this.json.cBhvr.attrList[0],R[1].resolveValue(this.vars)))}const h=l-1,m=this.keyFrames[l],x=this.keyFrames[h]||m,b=m[0]-x[0]==0?1:(s-x[0])/(m[0]-x[0]),w=m[1].interpolationFrom(x[1],b,this.vars);this.timingTarget&&jn(this.timingTarget,this.json.cBhvr.attrList[0],w)},this.onSeekToStart=()=>{this.startVal!==null&&this.timingTarget&&jn(this.timingTarget,this.json.cBhvr.attrList[0],this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.initKeyFrames(),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timelineStart",this.updateVars),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart)}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}initKeyFrames(){var n;const{valueType:e}=this.json;if(this.json.tavLst.length<=0){if(this.json.to){if(this.json.from||this.startVal){const s={time:0,val:{type:"string",value:this.json.from||this.startVal.toString()},fmla:""};if(e==="num"&&this.timingTarget){const l=new xs(s,this.timingTarget);this.keyFrames.push([s.time,l])}}const r={time:1,val:{type:"string",value:this.json.to},fmla:""};if(e==="num"&&this.timingTarget){const s=new xs(r,this.timingTarget);this.keyFrames.push([r.time,s])}}else if(this.json.by){const r={time:0,val:{type:"string",value:this.json.cBhvr.attrList[0]},fmla:""};if(e==="num"&&this.timingTarget){const l=new xs(r,this.timingTarget);this.keyFrames.push([r.time,l])}const s={time:1,val:{type:"string",value:(((n=r.val)===null||n===void 0?void 0:n.value)||"")+"+"+this.json.by},fmla:""};if(e==="num"&&this.timingTarget){const l=new xs(s,this.timingTarget);this.keyFrames.push([s.time,l])}}}if(this.json.tavLst.length>0){for(const r of this.json.tavLst)if(r.val&&this.timingTarget){let s=null;r.val.type==="string"?e==="num"?s=new xs(r,this.timingTarget):e==="str"&&(s=new Js(r,this.timingTarget)):r.val.type==="number"?s=new Bi(r,this.timingTarget):(r.val.type==="color"||r.val.type==="boolean")&&console.warn("not implements"),s&&this.keyFrames.push([r.time,s])}}}}class Lu extends ro{constructor(n){super(`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;

uniform vec4 inputSize;
uniform vec4 outputFrame;
uniform float percent;
uniform float direction;
uniform float transition;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord(vec2 aVertexPosition)
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    vTransition = transition;
    vDirection = direction;
    vPercent = percent;
    vVertexPosition = aVertexPosition;
    vec2 localVertexPosition = aVertexPosition;
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord(localVertexPosition);
}
`,`
// \u7EB9\u7406\u5750\u6807
varying vec2 vTextureCoord;
// \u9876\u70B9\u5750\u6807
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;

uniform sampler2D uSampler;

void main(void){
    vec4 outputColor;

    float percent = vPercent;
    float direction = vDirection;
    
    if (vTransition < 0.0) {
        percent = 1.0 - percent;
        if (vDirection > 1.5 && vDirection < 2.5) {
            direction = 1.0;
        } else if (vDirection > 0.5 && vDirection < 1.5) {
            direction = 2.0;
        } else if (vDirection > 2.5 && vDirection < 3.5) {
            direction = 4.0;
        } else {
            direction = 3.0;
        }
    }

    if (direction > 1.5 && direction < 2.5) { // \u4ECE\u4E0B\u81F3\u4E0A\u663E\u793A
        if (vVertexPosition.y >= 1.0 - percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.y >= 1.0 - percent && vVertexPosition.y <= 1.0 - percent + 0.2 ) {
            outputColor = outputColor * ((vVertexPosition.y - (1.0 - percent)) / 0.2);
        }
    } else if (direction > 0.5 && direction < 1.5) { // \u4ECE\u4E0A\u81F3\u4E0B\u663E\u793A
        if (vVertexPosition.y <= percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.y <= percent && vVertexPosition.y >= percent - 0.2) {
            outputColor = outputColor * (1.0 - (vVertexPosition.y - (percent - 0.2)) / 0.2);
        }
    } else if (direction > 2.5 && direction < 3.5) { // \u4ECE\u5DE6\u5230\u53F3
        if (vVertexPosition.x <= percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.x <= percent && vVertexPosition.x >= percent - 0.2) {
            outputColor = outputColor * (1.0 - (vVertexPosition.x - (percent - 0.2)) / 0.2);
        }
    } else {
        if (vVertexPosition.x >= 1.0 - percent) {
            outputColor = texture2D(uSampler, vTextureCoord);
        } else {
            outputColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
        if (vVertexPosition.x >= 1.0 - percent && vVertexPosition.x <= 1.0 - percent + 0.2) {
            outputColor = outputColor * ((vVertexPosition.x - (1.0 - percent)) / 0.2);
        }
    }

    gl_FragColor = outputColor;
}
`,{percent:0,direction:1,transition:n})}set percent(n){this.uniforms.percent=n}set direction(n){this.uniforms.direction=n}}class Xa extends ro{constructor(){super(void 0,`
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;

void main(void){
    vec4 color1 = texture2D(uSampler, vTextureCoord);
    if (color1.a != 0.0 && percent < 1.0) {
        float alpha = percent;
        gl_FragColor = color1 * alpha;
        return;
    }
    gl_FragColor = color1;
}
`,{percent:0})}set percent(n){this.uniforms.percent=n}}class ga extends Vr{constructor(n){var e;super(n),this.filterType="",this.isConflict=!0,this.activeWhenConflict="prev",this.onTimeUpdate=({duration:l,delta:h})=>{const m=h/l;this.filter&&(this.filter.percent=m),m>=1&&this.timingTarget&&(this.timingTarget.container.filters=[])},this.onSeekToStart=()=>{this.timingTarget&&(this.timingTarget.container.filters=[])},this.onSeekToEnd=()=>{this.timingTarget&&(this.timingTarget.container.filters=[])},this.commonTimeNode.on("timelineStart",()=>{this.filter&&this.timingTarget&&(this.timingTarget.container.filters=[this.filter])}),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate);let r=0;n.json.transition==="out"?r=-1:n.json.transition==="in"&&(r=1);const s=(e=n.json.filter)===null||e===void 0?void 0:e.match(/^([a-zA-Z]+)(\((.+)\))?/);if(s){const l=s[1],h=s[3];if(l==="wipe"){const m=new Lu(r);h==="up"?m.direction=1:h==="down"?m.direction=2:h==="left"?m.direction=3:h==="right"&&(m.direction=4),this.filter=m,this.filterType=`${l}-${h}`}else if(l==="fade"){const m=new Xa;this.filter=m,this.filterType=""+l}}}get modifyAttrKey(){return this.filterType}}var dl=T(5);class ep extends Vr{constructor(n){super(n),this.isConflict=!0,this.activeWhenConflict="next",this.onTimeUpdate=({duration:e,delta:r})=>{var s;const l=r/e,h=(s=this.path)===null||s===void 0?void 0:s.getPoint(l);this.timingTarget&&h&&(this.timingTarget.ppt_x=h.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=h.y+ +this.timingTarget.design_ppt_y)},this.onSeekToStart=()=>{var e;const r=(e=this.path)===null||e===void 0?void 0:e.getPoint(0);this.timingTarget&&r&&(this.timingTarget.ppt_x=r.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=r.y+this.timingTarget.design_ppt_y)},this.onSeekToEnd=()=>{var e;const r=(e=this.path)===null||e===void 0?void 0:e.getPoint(1);this.timingTarget&&r&&(this.timingTarget.ppt_x=r.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=r.y+this.timingTarget.design_ppt_y)},this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.createPath()}get modifyAttrKey(){return"motion"}createPath(){var n;const e=new dl.Path,r=(n=this.json.path)===null||n===void 0?void 0:n.match(/[MLCmlc][^MLCmlc]+/g);if(r)for(const s of r){const[l,...h]=s.trim().replace(/\s+/g," ").split(" ");if(l==="M"){const[m,x]=h.map(b=>Number(b));e.moveTo(m,x)}else if(l==="L"){const[m,x]=h.map(b=>Number(b));e.lineTo(m,x)}else if(l==="C"){const[m,x,b,w,R,U]=h.map(B=>Number(B));e.bezierCurveTo(m,x,b,w,R,U)}else if(l==="Z")e.closePath();else if(l==="E")console.warn("not implements");else if(l==="c"){const[m,x,b,w,R,U]=h.map(j=>Number(j)),B=e.currentPoint;e.bezierCurveTo(m+B.x,x+B.y,b+B.x,w+B.y,R+B.x,U+B.y)}else if(l==="l"){const m=e.currentPoint,[x,b]=h.map(w=>Number(w));e.lineTo(x+m.x,b+m.y)}else if(l==="m"){const m=e.currentPoint,[x,b]=h.map(w=>Number(w));e.moveTo(x+m.x,b+m.y)}}this.path=e}}class pl extends Vr{constructor(n){super(n),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.onTimelineStart=e=>{e.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:e,delta:r})=>{const s=r/e,l={x:1,y:1};if(this.from&&this.to)l.x=this.from.x+(this.to.x-this.from.x)*s,l.y=this.from.y+(this.to.y-this.from.y)*s;else if(this.by){const h={x:this.by.x,y:this.by.y};l.x=1+(h.x-1)*s,l.y=1+(h.y-1)*s}this.timingTarget&&(this.timingTarget.scale=l)},this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})},this.onSeekToStart=()=>{this.timingTarget&&this.startVal&&(this.timingTarget.scale=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.from=n.json.from,this.to=n.json.to,this.by=n.json.by,this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart)}get modifyAttrKey(){return"scale"}updateCurrentValue(){this.timingTarget&&(this.current={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})}}class rc extends Vr{constructor(n){super(n),this.isConflict=!1,this.activeWhenConflict="next",this.startColorString=null,this.currentColorString="#FFFFFFFF",this.onTimelineStart=e=>{this.from.isInit()||this.from.fromHexString(this.currentColorString),this.to.isInit()||this.from.by(this.by,this.to),e.isReverse||this.updateCurrentValue();const[r]=this.json.cBhvr.attrList[0].split(".");jn(this.timingTarget,r+".on","true")},this.onTimeNodeEnd=()=>{if(this.json.cBhvr.ctn.fill==="remove"){const[e]=this.json.cBhvr.attrList[0].split(".");jn(this.timingTarget,e+".on","false")}},this.onSeekToStart=()=>{if(this.timingTarget){const[e]=this.json.cBhvr.attrList[0].split(".");jn(this.timingTarget,e+".on","false")}},this.onTimeNodeStart=()=>{if(this.timingTarget){const e=Mn(this.timingTarget,this.json.cBhvr.attrList[0]);e&&(this.startColorString=e)}},this.onTimeUpdate=({delta:e,duration:r})=>{const s=e/r;this.to.interpolationFrom(this.from,s,this.target),this.timingTarget&&jn(this.timingTarget,this.json.cBhvr.attrList[0],this.target.toHexString())},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1})},this.json.clrSpc==="rgb"?(this.from=new ll(this.json.from),this.to=new ll(this.json.to),this.by=new ll(this.json.by),this.target=new ll):(this.from=new Qh(this.json.from),this.to=new Qh(this.json.to),this.by=new Qh(this.json.by),this.target=new Qh),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeEnd",this.onTimeNodeEnd),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate)}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}updateCurrentValue(){if(this.timingTarget){const n=Mn(this.timingTarget,this.json.cBhvr.attrList[0]);n&&(this.currentColorString=n)}}}class fl extends Vr{constructor(n){super(n),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.lastVal=null,this.onTimelineStart=e=>{this.lastVal=null,e.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:e,delta:r})=>{const s=r/e;let l=0,h=0;if(this.from!==void 0&&this.to!==void 0){l=this.from,h=this.to;const m=l+(h-l)*s;this.timingTarget&&(this.timingTarget.r=m)}else if(this.by!==void 0){this.lastVal||(this.lastVal=0);const m=this.by*s-this.lastVal;this.lastVal=this.by*s,this.timingTarget&&(this.timingTarget.r+=m)}},this.onTimeNodeStart=()=>{var e;Object(W.isNumber)((e=this.timingTarget)===null||e===void 0?void 0:e.r)&&(this.startVal=this.timingTarget.r)},this.onSeekToStart=()=>{this.timingTarget&&this.startVal!==null&&(this.timingTarget.r=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.from=this.json.from,this.to=this.json.to,this.by=this.json.by,this.by?this.isConflict=!1:this.isConflict=!0,this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate)}get modifyAttrKey(){return"rotate"}updateCurrentValue(){var n;this.currentVal=(n=this.timingTarget)===null||n===void 0?void 0:n.r}}class oh extends Vr{constructor(n){super(n),this.isConflict=!1,this.activeWhenConflict="next",this.isApplied=!1,this.onTimeUpdate=()=>{var e,r;const{cmd:s,cmdType:l}=this.json;!this.isApplied&&s&&l&&(this.isApplied=!0,(r=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||r===void 0||r.applyCommand(s,l))},this.onSeekToStart=()=>{var e,r;(r=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||r===void 0||r.applyCommand("custom-pause","call")},this.onSeekToEnd=()=>{var e,r;(r=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||r===void 0||r.applyCommand("custom-pause","call")},this.commonTimeNode.on("timeNodeStart",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeNodeEnd",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate)}get modifyAttrKey(){var n,e,r,s;return((e=(n=this.json)===null||n===void 0?void 0:n.cmd)!==null&&e!==void 0?e:"")+((s=(r=this.json)===null||r===void 0?void 0:r.cmdType)!==null&&s!==void 0?s:"")}}var zp=T(20);class Ou{constructor(n){Ou.useRtc||(this.howl=new zp.Howl({src:[n]}))}play(){var n;(n=this.howl)===null||n===void 0||n.play()}pause(){var n;(n=this.howl)===null||n===void 0||n.pause()}stop(){var n;(n=this.howl)===null||n===void 0||n.stop()}}Ou.useRtc=!1;class $s{constructor(n){this.runtimeNodeEventHub=new Z.a,this.stopAudio=()=>{this.audio.stop()};const{json:e,isIterate:r,isSub:s,eventHub:l,ctx:h,parent:m,iterateType:x,iterateIndex:b,iterateId:w}=n;this.json=e,this.id=e.cMediaNode.ctn.id,this.commonTimeNode=new Kc({json:e.cMediaNode.ctn,isSub:s,eventHubs:{global:l,runtime:this.runtimeNodeEventHub},ctx:h,parent:m,isIterate:r,iterateType:x,iterateIndex:b,iterateId:w}),this.audio=new Ou(e.cMediaNode.tgtEl),this.commonTimeNode.on("timelineStart",()=>{this.audio.play()}),this.commonTimeNode.on("seekToStart",this.stopAudio),this.commonTimeNode.on("seekToEnd",this.stopAudio),this.commonTimeNode.on("timeNodeDestroy",this.stopAudio)}}var np=T(8),Zf=T.n(np);function Jf(){return Date.now().toString(32)+Math.random().toString(32).substring(2)}function yf(o){const n=[],e=o.filter(x=>{const b=x.width<2048&&x.height<2048;return b||n.push(x),b}).sort((x,b)=>x.width*x.height-b.width*b.height);let r=e.length+1,s=2050,l=2050;const h=[];let m=null;for(;(s>2048||l>2048)&&e.length>0;)r-=1,m=Zf()(e.slice(0,r)),s=m.width,l=m.height;return m&&h.push(m),n.forEach(x=>{const b=Zf()([x]);h.push(b)}),r<e.length?h.concat(yf(e.slice(r))):h}var Em=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class Kc extends Z.a{constructor(n){super(),this.uuid=Date.now().toString(32)+Math.random().toString(32).substring(2),this.isSub=!1,this.isShadow=!1,this.startCount=0,this.applyCount=0,this.isReverse=!1,this.isConflictDispose=!1,this.isIterateEnd=!1,this.parentTimeNode=null,this.isActive=!1,this.isDestroy=!1,this.shouldSeekOnStart=!1,this.repeatTimeoutId=null,this.iterateShadows=[],this.isIterate=!1,this.iterateType="el",this.iterateIndex=0,this.children=[],this.subList=[],this.duration=0,this.timeDelta=0,this.isNegativeSpeed=!1,this.handleEndCond=()=>{this.isActive&&(this.isActive=!1,this.dispose())},this.handleActive=(B=!0)=>{if(this.isActive=!0,this.applyCount+=1,this.json.iterate||this.emit("timeNodeStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startCount>0&&this.json.restart){if(this.json.restart==="never")return;this.json.restart!=="whenNotActive"&&this.json.restart!=="always"||(this.seekToStart(),this.emit("timeNodeRestart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startTimeLine(B))}else this.startTimeLine(B)},this.updateTimeLine=B=>{const j=B/(ie.TARGET_FPMS||.06);this.timeDelta+=j,this.duration-this.timeDelta<=j&&(this.timeDelta=this.duration),this.timeDelta<this.duration?this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?this.duration-this.timeDelta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}):(this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?0:this.duration,duration:this.duration,isReverse:this.isReverse}),this.onTimeLineEnd())},this.handleEnd=(B=!1)=>{(this.isTimeNodeEnd()||B)&&(this.isActive=!1,this.isSub&&this.destroy(),this.emitEndEvents())};const{isSub:e,isIterate:r,ctx:s,eventHubs:l,parent:h,json:m,iterateType:x,iterateId:b,iterateIndex:w}=n;this.isSub=e,this.isIterate=r,this.parentTimeNode=h,this.json=m,this.ctx=s,this.iterateIndex=w,this.eventHubs=l,this.iterateType=x,this.iterateId=b;const R=Number(this.json.dur),U=this.json.spd||1;this.isNegativeSpeed=U<0,Number.isNaN(R)||(this.duration=R/Math.abs(U)),this.setPreStyle(),m.childTnLst&&this.createChildren(m.childTnLst),this.startConds=new Fn(this.json.id||"",m.stCondLst,l,this.ctx),this.endConds=new Fn(this.json.id||"",m.endCondLst,l,this.ctx),m.endSync&&(this.endSync=new Fn(this.json.id||"",[m.endSync],l,this.ctx),this.endSync.on("active",()=>{var B;this.json.nodeType==="interactiveSeq"&&(this.isActive=!1,this.shouldSeekOnStart=!0,this.emit("timeNodeEndSync"),(B=this.endSync)===null||B===void 0||B.reset())})),this.startConds.on("active",B=>{this.isActive||(this.shouldSeekOnStart&&(this.shouldSeekOnStart=!1,this.seekToStart()),this.handleActive(B))}),this.endConds.on("active",()=>{this.handleEndCond(),this.children.forEach(B=>B.commonTimeNode.handleEndCond())}),this.parentTimeNode&&this.parentTimeNode.on("timeNodeStart",()=>{this.applyCount=0}),this.isSub&&this.json.masterRel==="nextClick"&&this.startConds.addCond({event:"shape slide onNext"}),this.json.iterate&&this.isIterate===!1&&this.createIterateShadow()}createIterateShadow(){const n=Jf();let e=!0,r=0;const s=l=>{l===n&&(e=!1,this.ctx.eventHub.removeListener("IterateTimeNodeEnd",s))};for(this.ctx.eventHub.on("IterateTimeNodeEnd",s);e;){const l=JSON.parse(JSON.stringify(this.json)),h=new Kc({json:l,isSub:!1,eventHubs:this.eventHubs,ctx:this.ctx,parent:null,isIterate:!0,iterateType:l.iterate.type,iterateIndex:r,iterateId:n});this.iterateShadows[r]=h,r+=1}}isInfiniteRepeat(){return this.json.repeatCount>999999998}getReverse(){return this.isReverse}setReverse(n){this.isReverse=n}createTimeNode(n,e){let r=null;const s={json:n,isSub:e,isIterate:this.isIterate,eventHub:this.eventHubs.global,ctx:this.ctx,parent:this,iterateType:this.iterateType,iterateIndex:this.iterateIndex,iterateId:this.iterateId};return n.type==="seq"?r=new An(s):n.type==="par"?r=new $f(s):n.type==="set"?r=new _o(s):n.type==="anim"?r=new Wa(s):n.type==="animEffect"?r=new ga(s):n.type==="animMotion"?r=new ep(s):n.type==="animScale"?r=new pl(s):n.type==="animClr"?r=new rc(s):n.type==="animRot"?r=new fl(s):n.type==="cmd"?r=new oh(s):n.type==="audio"&&(r=new $s(s)),r}createSubList(n){this.subList=[],n.forEach(e=>{const r=this.createTimeNode(e,!0);r&&this.subList.push(r)})}createChildren(n){n.forEach(e=>{const r=this.createTimeNode(e,!1);r&&(r.commonTimeNode.on("timeNodeStart",s=>{this.emit("childTimeNodeStart",s)}),r.commonTimeNode.on("timeNodeEnd",s=>{this.emit("childTimeNodeEnd",s),this.children.every(l=>l.commonTimeNode.isTimeNodeEnd())&&(this.json.iterate||this.allChildrenEndHandle())}),this.children.push(r))})}playReverse(){this.isReverse=!0,this.startReverseTimeLine(),this.children.forEach(n=>n.commonTimeNode.playReverse())}allChildrenEndHandle(){if(!this.isDestroy){if(this.json.autoRev&&!this.isReverse)return this.isReverse=!0,void this.playReverse();this.isReverse&&(this.isReverse=!1),this.json.repeatCount&&this.json.repeatCount>this.applyCount?this.repeatTimeoutId=setTimeout(()=>{this.seekToStart(!1),this.resetForRepeat(),this.startTimeNodeRepeat()}):(this.json.iterate&&!this.isIterate&&(this.isIterateEnd=!0),this.eventHubs.runtime.emit("runtime all end"),this.startSubList(),this.handleEnd())}}resetForRepeat(){this.timeDelta=0,this.children.forEach(n=>n.commonTimeNode.resetForRepeat())}startSubList(){this.subList.forEach(n=>n.commonTimeNode.startTimeNode())}startReverseTimeLine(){this.timeDelta=0;const n=1e3/this.ctx.ticker.maxFPS;this.duration<=n&&this.duration>0?(this.emit("timeUpdate",{delta:this.duration,duration:this.duration,isReverse:this.isReverse}),this.ctx.eventHub.emit(xr.animateEnd),this.ctx.ticker.remove(this.updateTimeLine)):this.duration>n&&(this.ctx.eventHub.emit(xr.animateStart),this.ctx.ticker.add(this.updateTimeLine))}startTimeLine(n=!0){if(n&&(this.eventHubs.global.emit(`time ${this.json.id} begin`),this.eventHubs.global.emit(`time ${this.json.id} onBegin`),this.eventHubs.runtime.emit(`runtime ${this.json.id} begin`)),this.json.iterate)return void this.startIterate();this.timeDelta=0,this.emit("timelineStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse});const e=1e3/this.ctx.ticker.maxFPS;this.duration<=e&&this.duration>0?(this.timeDelta=this.isReverse?0:this.duration,this.emit("timeUpdate",{delta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}),this.emit("timelineEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.onTimeLineEnd()):this.duration>e&&(this.ctx.eventHub.emit(xr.animateStart),this.updateTimeLine(0),this.ctx.ticker.add(this.updateTimeLine))}setTimeout(n,e){let r=0;const s=l=>{r+=l/(ie.TARGET_FPMS||.06),r>=e&&(n(),this.ctx.ticker.remove(s))};return this.ctx.ticker.add(s),()=>{this.ctx.ticker.remove(s)}}tickerDelay(n){return new Promise(e=>{this.setTimeout(()=>{e()},n)})}startIterate(){return Em(this,void 0,void 0,function*(){if(this.json.iterate){this.isIterateEnd=!1;for(const n of this.iterateShadows){if(this.isIterateEnd)return;n.children.forEach(e=>{e.commonTimeNode.startTimeNode()}),n.applyCount+=1,yield this.tickerDelay(this.json.iterate.interval)}this.onTimeLineEnd()}})}isNatureTimeEnd(){return this.duration>=0&&this.timeDelta>=this.duration}setPreStyle(){if(!this.json.presetClass)return;const n=[],e=r=>{r.forEach(s=>{var l,h,m;s.cBhvr&&s.cBhvr.target&&n.findIndex(x=>x.id===s.cBhvr.target.id)<0&&n.push(s.cBhvr.target),((h=(l=s==null?void 0:s.cBhvr)===null||l===void 0?void 0:l.ctn)===null||h===void 0?void 0:h.childTnLst)&&s.cBhvr.ctn.childTnLst.length>0&&e(s.cBhvr.ctn.childTnLst),((m=s==null?void 0:s.ctn)===null||m===void 0?void 0:m.childTnLst)&&s.ctn.childTnLst.length>0&&e(s.ctn.childTnLst)})};e(this.json.childTnLst||[]),n.forEach(r=>{if(this.json.iterate){let s=0,l=!0;for(;l;){const h=this.ctx.timingTargets.getTarget(r,!0,{type:this.json.iterate.type,index:s,id:""});h&&(this.setPreStyleForTarget(h),s+=1),l=!!h}}else{const s=this.ctx.timingTargets.getTarget(r,!1);s&&this.setPreStyleForTarget(s)}})}setPreStyleForTarget(n){n&&this.json.presetSubtype&&(n.presetSubType=this.json.presetSubtype),n&&!n.hasPreset&&(this.json.presetClass==="entr"?(n.hasPreset=!0,n.style.visibility="hidden"):this.json.presetClass==="exit"&&(n.hasPreset=!0,n.style.visibility="visible"))}startTimeNodeRepeat(){this.timeDelta=0,this.isActive=!0,this.applyCount+=1,this.startTimeLine(!1),this.json.iterate||this.emit("timeNodeRepeat",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse})}startTimeNodeForce(){this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.timeDelta=0,this.isActive=!0,this.handleActive(!1)}startTimeNode(n=!0){if(this.isDestroy)return;this.collectStartValue(),this.timeDelta=0,this.isReverse=!1,this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.startConds.setTriggerParams(n);const e=this.json.stCondLst.filter(s=>/^self/.test(s.event||""))[0];e&&this.startConds.condHandle(e);const r=this.json.endCondLst.filter(s=>/^self/.test(s.event||""))[0];r&&this.endConds.condHandle(r),this.startConds.condHandle()}onTimeLineEnd(){this.dispose(),(this.children.length===0||this.json.iterate)&&this.allChildrenEndHandle()}clearSubList(){this.subList.forEach(n=>n.commonTimeNode.destroy())}seekToStart(n=!0){if(this.isActive=!1,this.dispose(),this.timeDelta=0,this.isNegativeSpeed,this.emit("seekToStart"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(e=>e.seekToStart(n));if(n)for(let e=this.subList.length-1;e>=0;e--){const r=this.subList[e];r==null||r.commonTimeNode.seekToStart()}for(let e=this.children.length-1;e>=0;e--){const r=this.children[e];r==null||r.commonTimeNode.seekToStart()}for(let e=this.children.length-1;e>=0;e--){const r=this.children[e];r==null||r.commonTimeNode.seekToStart()}}dispose(n=!1){this.isConflictDispose=n,window.clearTimeout(this.repeatTimeoutId),this.ctx.eventHub.emit(xr.animateEnd),this.ctx.ticker.remove(this.updateTimeLine),this.startConds.reset(),this.endConds.reset()}seekToEnd(n,e=!1){if(this.isInfiniteRepeat())return;!this.isActive&&this.applyCount<=0&&this.collectStartValue(),this.applyCount=this.json.repeatCount,this.json.autoRev&&(this.isReverse=!0),this.timeDelta=this.duration,this.isActive=!1,this.dispose();const r=this.json.autoRev||n;if(r?this.emit("seekToStart"):this.emit("seekToEnd"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(s=>s.seekToEnd(r,e));this.children.length===0&&(this.eventHubs.runtime.emit("runtime all end"),this.handleEnd()),this.children.forEach(s=>s.commonTimeNode.seekToEnd(r,e)),e&&this.json.subTnLst&&(this.subList.length<=0&&this.createSubList(this.json.subTnLst),this.subList.forEach(s=>s.commonTimeNode.seekToEnd(!1)))}isTimeNodeEnd(){let n=!0;return this.children.length>0&&(n=n&&this.children.every(e=>e.commonTimeNode.isTimeNodeEnd())),this.json.repeatCount&&(n=n&&this.applyCount>=this.json.repeatCount),this.json.autoRev&&(n=n&&!this.isReverse),n=n&&this.isNatureTimeEnd(),!!this.isConflictDispose||!(!this.isIterateEnd||!this.json.iterate)||n}emitEndEvents(){this.eventHubs.global.emit(`time ${this.json.id} end`),this.eventHubs.global.emit(`time ${this.json.id} onEnd`),this.eventHubs.runtime.emit(`runtime ${this.json.id} end`),this.emit("timeNodeEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse})}collectStartValue(){this.emit("timeNodeCreate"),this.children.forEach(n=>n.commonTimeNode.collectStartValue())}destroy(){this.emit("timeNodeDestroy"),this.isDestroy=!0,this.dispose(),this.startConds.removeAllListeners(),this.endConds.removeAllListeners(),this.children.forEach(n=>n.commonTimeNode.destroy())}}class $f extends Z.a{constructor(n){super(),this.isRunning=!1,this.runtimeNodeEventHub=new Z.a;const{json:e,iterateType:r,isIterate:s,isSub:l,parent:h,ctx:m,eventHub:x,iterateIndex:b,iterateId:w}=n;this.id=e.ctn.id,this.json=e,this.ctx=m,this.isIterate=s,this.globalEventHub=x,this.commonTimeNode=new Kc({json:e.ctn,isSub:l,eventHubs:{global:x,runtime:this.runtimeNodeEventHub},ctx:m,parent:h,isIterate:!1,iterateType:r,iterateIndex:b,iterateId:w}),this.commonTimeNode.on("timeNodeStart",()=>{this.commonTimeNode.children.forEach(R=>{R.commonTimeNode.setReverse(this.commonTimeNode.getReverse()),R.commonTimeNode.startTimeNode()}),this.isRunning||(this.isRunning=!0,this.globalEventHub.emit(`runtime ${this.id} begin`),this.emit("begin"))}),this.commonTimeNode.on("timeNodeRepeat",()=>{this.commonTimeNode.children.forEach(R=>{R.commonTimeNode.startTimeNode(!1)})}),this.commonTimeNode.on("timeNodeEnd",()=>{this.commonTimeNode.isTimeNodeEnd()&&this.isRunning&&(this.isRunning=!1,this.globalEventHub.emit(`runtime ${this.id} end`),this.emit("end"))})}}class Mm{constructor(n,e,r){this.json=n,this.ctx=r;const s=n.timeNodeList.find(l=>l.type==="par"&&l.ctn.nodeType==="tmRoot");s&&(this.tmRoot=new $f({json:s,isSub:!1,isIterate:!1,eventHub:e,ctx:r,parent:null,iterateType:"el",iterateIndex:0,iterateId:""}),this.mainSeq=this.tmRoot.commonTimeNode.children.find(l=>{var h,m,x;return((h=l.json)===null||h===void 0?void 0:h.type)==="seq"&&((x=(m=l.json)===null||m===void 0?void 0:m.ctn)===null||x===void 0?void 0:x.nodeType)==="mainSeq"}))}findSeq(n){var e;return(e=this.tmRoot)===null||e===void 0?void 0:e.commonTimeNode.children.find(r=>{var s,l,h;return((s=r.json)===null||s===void 0?void 0:s.type)==="seq"&&((h=(l=r.json)===null||l===void 0?void 0:l.ctn)===null||h===void 0?void 0:h.id)===n})}start(){var n;this.json.autoPlayMainSeq?setTimeout(()=>{var e;(e=this.mainSeq)===null||e===void 0||e.commonTimeNode.startTimeNode()}):(n=this.mainSeq)===null||n===void 0||n.commonTimeNode.startTimeNode()}setMainSeqApplied(){this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1)}collectMainSeqStartValue(){var n;(n=this.mainSeq)===null||n===void 0||n.commonTimeNode.collectStartValue()}setMainSeqStep(n,e){var r;n===-1&&this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1),(r=this.mainSeq)===null||r===void 0||r.setCurrentStep(n,e)}destroy(){var n;(n=this.tmRoot)===null||n===void 0||n.commonTimeNode.destroy()}hasMainSeq(){return!!this.mainSeq&&this.mainSeq.commonTimeNode.children.length>0}currentMainSeqState(){return this.mainSeq?this.mainSeq.currentState:null}currentMainSeqStep(){return this.mainSeq?this.mainSeq.currentStep:0}currentMainSeqLength(){return this.mainSeq?this.mainSeq.stepLength:0}mainSeqHasNextStep(){return!!this.mainSeq&&this.mainSeq.hasNext()}mainSeqHasPrevStep(){return!!this.mainSeq&&this.mainSeq.hasPrev()}seekInteractiveSeqToEnd(n){const e=this.findSeq(n);e&&e.commonTimeNode.seekToEnd(!1,!0)}}var jp=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class Am extends dn{constructor(n,e,r){super({id:"stage",width:n.width,height:n.height,type:"Container",children:n.children},e,r),this.globalEventHub=new Z.a,this.json=n,this.container.visible=!1,this.ctx=e,this.globalEventHub.on("c:prev slide",()=>{this.ctx.eventHub.emit(_a.prev)}),this.globalEventHub.on("c:next slide",()=>{this.ctx.eventHub.emit(_a.next)});const s=new vs;s.drawRect(0,0,n.width,n.height),this.container.addChild(s)}get interactiveContainer(){return this.container}render(){const n=Object.create(null,{render:{get:()=>super.render}});return jp(this,void 0,void 0,function*(){yield n.render.call(this),this.ctx.eventHub.emit("StageRenderEnd")})}createTiming(){this.json.timing&&(this.timing=new Mm(this.json.timing,this.globalEventHub,this.ctx))}startTiming(){var n;(n=this.timing)===null||n===void 0||n.start()}setMainSeqApplied(){var n;(n=this.timing)===null||n===void 0||n.setMainSeqApplied()}setMainSeqStep(n,e){var r;(r=this.timing)===null||r===void 0||r.setMainSeqStep(n,e)}collectMainSeqStartValue(){var n;(n=this.timing)===null||n===void 0||n.collectMainSeqStartValue()}hasTiming(){return!!this.timing}destroy(){var n;super.destroy(),this.ctx.eventHub.removeAllListeners(),this.ctx.graphicsTexture.destroy(),this.ctx.fillTexture.destroy(),this.globalEventHub.removeAllListeners(),(n=this.timing)===null||n===void 0||n.destroy()}mainSeqStep(){var n,e;return(e=(n=this.timing)===null||n===void 0?void 0:n.currentMainSeqStep())!==null&&e!==void 0?e:0}mainSeqLength(){var n,e;return(e=(n=this.timing)===null||n===void 0?void 0:n.currentMainSeqLength())!==null&&e!==void 0?e:0}mainSeqHasNextStep(){var n,e;return(e=(n=this.timing)===null||n===void 0?void 0:n.mainSeqHasNextStep())!==null&&e!==void 0&&e}mainSeqHasPrevStep(){var n,e;return(e=(n=this.timing)===null||n===void 0?void 0:n.mainSeqHasPrevStep())!==null&&e!==void 0&&e}mainSeqState(){return this.timing?this.timing.currentMainSeqState():null}nextStep(){var n;this.hasTiming()&&((n=this.timing)===null||n===void 0?void 0:n.hasMainSeq())?this.globalEventHub.emit("shape slide onNext"):this.ctx.eventHub.emit(_a.next)}prevStep(){var n;this.hasTiming()&&((n=this.timing)===null||n===void 0?void 0:n.hasMainSeq())?this.globalEventHub.emit("shape slide onPrev"):this.ctx.eventHub.emit(_a.prev)}applyInteractiveAction(n){this.globalEventHub.emit(n)}seekInteractiveSeqToEnd(n){var e;(e=this.timing)===null||e===void 0||e.seekInteractiveSeqToEnd(n)}setMediaState(n,e){return jp(this,void 0,void 0,function*(){const r=this.ctx.medias[n];r&&(e?yield r.play():yield r.pause())})}setMediaCurrentTime(n,e){const r=this.ctx.medias[n];r&&r.seek(e)}}const Ji=134217729;function xf(o,n,e,r,s){let l,h,m,x,b=n[0],w=r[0],R=0,U=0;w>b==w>-b?(l=b,b=n[++R]):(l=w,w=r[++U]);let B=0;if(R<o&&U<e)for(w>b==w>-b?(h=b+l,m=l-(h-b),b=n[++R]):(h=w+l,m=l-(h-w),w=r[++U]),l=h,m!==0&&(s[B++]=m);R<o&&U<e;)w>b==w>-b?(h=l+b,x=h-l,m=l-(h-x)+(b-x),b=n[++R]):(h=l+w,x=h-l,m=l-(h-x)+(w-x),w=r[++U]),l=h,m!==0&&(s[B++]=m);for(;R<o;)h=l+b,x=h-l,m=l-(h-x)+(b-x),b=n[++R],l=h,m!==0&&(s[B++]=m);for(;U<e;)h=l+w,x=h-l,m=l-(h-x)+(w-x),w=r[++U],l=h,m!==0&&(s[B++]=m);return l===0&&B!==0||(s[B++]=l),B}function Ui(o,n){let e=n[0];for(let r=1;r<o;r++)e+=n[r];return e}function sh(o){return new Float64Array(o)}const ic=sh(4),rp=sh(8),ip=sh(12),Qc=sh(16),ns=sh(4);function op(o,n,e,r,s,l){const h=(n-l)*(e-s),m=(o-s)*(r-l),x=h-m;if(h===0||m===0||h>0!=m>0)return x;const b=Math.abs(h+m);return Math.abs(x)>=33306690738754716e-32*b?x:-function(w,R,U,B,j,K,ut){let gt,Rt,Le,en,At,oe,qt,ne,Je,Pe,$t,Ee,hn,Ve,He,cn,Be,me;const sn=w-j,Bn=U-j,tr=R-K,br=B-K;Ve=sn*br,oe=Ji*sn,qt=oe-(oe-sn),ne=sn-qt,oe=Ji*br,Je=oe-(oe-br),Pe=br-Je,He=ne*Pe-(Ve-qt*Je-ne*Je-qt*Pe),cn=tr*Bn,oe=Ji*tr,qt=oe-(oe-tr),ne=tr-qt,oe=Ji*Bn,Je=oe-(oe-Bn),Pe=Bn-Je,Be=ne*Pe-(cn-qt*Je-ne*Je-qt*Pe),$t=He-Be,At=He-$t,ic[0]=He-($t+At)+(At-Be),Ee=Ve+$t,At=Ee-Ve,hn=Ve-(Ee-At)+($t-At),$t=hn-cn,At=hn-$t,ic[1]=hn-($t+At)+(At-cn),me=Ee+$t,At=me-Ee,ic[2]=Ee-(me-At)+($t-At),ic[3]=me;let nr=Ui(4,ic),gr=22204460492503146e-32*ut;if(nr>=gr||-nr>=gr||(At=w-sn,gt=w-(sn+At)+(At-j),At=U-Bn,Le=U-(Bn+At)+(At-j),At=R-tr,Rt=R-(tr+At)+(At-K),At=B-br,en=B-(br+At)+(At-K),gt===0&&Rt===0&&Le===0&&en===0)||(gr=11093356479670487e-47*ut+33306690738754706e-32*Math.abs(nr),nr+=sn*en+br*gt-(tr*Le+Bn*Rt),nr>=gr||-nr>=gr))return nr;Ve=gt*br,oe=Ji*gt,qt=oe-(oe-gt),ne=gt-qt,oe=Ji*br,Je=oe-(oe-br),Pe=br-Je,He=ne*Pe-(Ve-qt*Je-ne*Je-qt*Pe),cn=Rt*Bn,oe=Ji*Rt,qt=oe-(oe-Rt),ne=Rt-qt,oe=Ji*Bn,Je=oe-(oe-Bn),Pe=Bn-Je,Be=ne*Pe-(cn-qt*Je-ne*Je-qt*Pe),$t=He-Be,At=He-$t,ns[0]=He-($t+At)+(At-Be),Ee=Ve+$t,At=Ee-Ve,hn=Ve-(Ee-At)+($t-At),$t=hn-cn,At=hn-$t,ns[1]=hn-($t+At)+(At-cn),me=Ee+$t,At=me-Ee,ns[2]=Ee-(me-At)+($t-At),ns[3]=me;const Qr=xf(4,ic,4,ns,rp);Ve=sn*en,oe=Ji*sn,qt=oe-(oe-sn),ne=sn-qt,oe=Ji*en,Je=oe-(oe-en),Pe=en-Je,He=ne*Pe-(Ve-qt*Je-ne*Je-qt*Pe),cn=tr*Le,oe=Ji*tr,qt=oe-(oe-tr),ne=tr-qt,oe=Ji*Le,Je=oe-(oe-Le),Pe=Le-Je,Be=ne*Pe-(cn-qt*Je-ne*Je-qt*Pe),$t=He-Be,At=He-$t,ns[0]=He-($t+At)+(At-Be),Ee=Ve+$t,At=Ee-Ve,hn=Ve-(Ee-At)+($t-At),$t=hn-cn,At=hn-$t,ns[1]=hn-($t+At)+(At-cn),me=Ee+$t,At=me-Ee,ns[2]=Ee-(me-At)+($t-At),ns[3]=me;const qr=xf(Qr,rp,4,ns,ip);Ve=gt*en,oe=Ji*gt,qt=oe-(oe-gt),ne=gt-qt,oe=Ji*en,Je=oe-(oe-en),Pe=en-Je,He=ne*Pe-(Ve-qt*Je-ne*Je-qt*Pe),cn=Rt*Le,oe=Ji*Rt,qt=oe-(oe-Rt),ne=Rt-qt,oe=Ji*Le,Je=oe-(oe-Le),Pe=Le-Je,Be=ne*Pe-(cn-qt*Je-ne*Je-qt*Pe),$t=He-Be,At=He-$t,ns[0]=He-($t+At)+(At-Be),Ee=Ve+$t,At=Ee-Ve,hn=Ve-(Ee-At)+($t-At),$t=hn-cn,At=hn-$t,ns[1]=hn-($t+At)+(At-cn),me=Ee+$t,At=me-Ee,ns[2]=Ee-(me-At)+($t-At),ns[3]=me;const Zr=xf(qr,ip,4,ns,Qc);return Qc[Zr-1]}(o,n,e,r,s,l,b)}const td=Math.pow(2,-52),ed=new Uint32Array(512);class va{static from(n,e=rd,r=oc){const s=n.length,l=new Float64Array(2*s);for(let h=0;h<s;h++){const m=n[h];l[2*h]=e(m),l[2*h+1]=r(m)}return new va(l)}constructor(n){const e=n.length>>1;if(e>0&&typeof n[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=n;const r=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:n,_hullPrev:e,_hullNext:r,_hullTri:s,_hullHash:l}=this,h=n.length>>1;let m=1/0,x=1/0,b=-1/0,w=-1/0;for(let Pe=0;Pe<h;Pe++){const $t=n[2*Pe],Ee=n[2*Pe+1];$t<m&&(m=$t),Ee<x&&(x=Ee),$t>b&&(b=$t),Ee>w&&(w=Ee),this._ids[Pe]=Pe}const R=(m+b)/2,U=(x+w)/2;let B,j,K,ut=1/0;for(let Pe=0;Pe<h;Pe++){const $t=Vp(R,U,n[2*Pe],n[2*Pe+1]);$t<ut&&(B=Pe,ut=$t)}const gt=n[2*B],Rt=n[2*B+1];ut=1/0;for(let Pe=0;Pe<h;Pe++){if(Pe===B)continue;const $t=Vp(gt,Rt,n[2*Pe],n[2*Pe+1]);$t<ut&&$t>0&&(j=Pe,ut=$t)}let Le=n[2*j],en=n[2*j+1],At=1/0;for(let Pe=0;Pe<h;Pe++){if(Pe===B||Pe===j)continue;const $t=Ya(gt,Rt,Le,en,n[2*Pe],n[2*Pe+1]);$t<At&&(K=Pe,At=$t)}let oe=n[2*K],qt=n[2*K+1];if(At===1/0){for(let Ee=0;Ee<h;Ee++)this._dists[Ee]=n[2*Ee]-n[0]||n[2*Ee+1]-n[1];nd(this._ids,this._dists,0,h-1);const Pe=new Uint32Array(h);let $t=0;for(let Ee=0,hn=-1/0;Ee<h;Ee++){const Ve=this._ids[Ee];this._dists[Ve]>hn&&(Pe[$t++]=Ve,hn=this._dists[Ve])}return this.hull=Pe.subarray(0,$t),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(op(gt,Rt,Le,en,oe,qt)<0){const Pe=j,$t=Le,Ee=en;j=K,Le=oe,en=qt,K=Pe,oe=$t,qt=Ee}const ne=function(Pe,$t,Ee,hn,Ve,He){const cn=Ee-Pe,Be=hn-$t,me=Ve-Pe,sn=He-$t,Bn=cn*cn+Be*Be,tr=me*me+sn*sn,br=.5/(cn*sn-Be*me);return{x:Pe+(sn*Bn-Be*tr)*br,y:$t+(cn*tr-me*Bn)*br}}(gt,Rt,Le,en,oe,qt);this._cx=ne.x,this._cy=ne.y;for(let Pe=0;Pe<h;Pe++)this._dists[Pe]=Vp(n[2*Pe],n[2*Pe+1],ne.x,ne.y);nd(this._ids,this._dists,0,h-1),this._hullStart=B;let Je=3;r[B]=e[K]=j,r[j]=e[B]=K,r[K]=e[j]=B,s[B]=0,s[j]=1,s[K]=2,l.fill(-1),l[this._hashKey(gt,Rt)]=B,l[this._hashKey(Le,en)]=j,l[this._hashKey(oe,qt)]=K,this.trianglesLen=0,this._addTriangle(B,j,K,-1,-1,-1);for(let Pe,$t,Ee=0;Ee<this._ids.length;Ee++){const hn=this._ids[Ee],Ve=n[2*hn],He=n[2*hn+1];if(Ee>0&&Math.abs(Ve-Pe)<=td&&Math.abs(He-$t)<=td||(Pe=Ve,$t=He,hn===B||hn===j||hn===K))continue;let cn=0;for(let tr=0,br=this._hashKey(Ve,He);tr<this._hashSize&&(cn=l[(br+tr)%this._hashSize],cn===-1||cn===r[cn]);tr++);cn=e[cn];let Be,me=cn;for(;Be=r[me],op(Ve,He,n[2*me],n[2*me+1],n[2*Be],n[2*Be+1])>=0;)if(me=Be,me===cn){me=-1;break}if(me===-1)continue;let sn=this._addTriangle(me,hn,r[me],-1,-1,s[me]);s[hn]=this._legalize(sn+2),s[me]=sn,Je++;let Bn=r[me];for(;Be=r[Bn],op(Ve,He,n[2*Bn],n[2*Bn+1],n[2*Be],n[2*Be+1])<0;)sn=this._addTriangle(Bn,hn,Be,s[hn],-1,s[Bn]),s[hn]=this._legalize(sn+2),r[Bn]=Bn,Je--,Bn=Be;if(me===cn)for(;Be=e[me],op(Ve,He,n[2*Be],n[2*Be+1],n[2*me],n[2*me+1])<0;)sn=this._addTriangle(Be,hn,me,-1,s[me],s[Be]),this._legalize(sn+2),s[Be]=sn,r[me]=me,Je--,me=Be;this._hullStart=e[hn]=me,r[me]=e[Bn]=hn,r[hn]=Bn,l[this._hashKey(Ve,He)]=hn,l[this._hashKey(n[2*me],n[2*me+1])]=me}this.hull=new Uint32Array(Je);for(let Pe=0,$t=this._hullStart;Pe<Je;Pe++)this.hull[Pe]=$t,$t=r[$t];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(n,e){return Math.floor(function(r,s){const l=r/(Math.abs(r)+Math.abs(s));return(s>0?3-l:1+l)/4}(n-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(n){const{_triangles:e,_halfedges:r,coords:s}=this;let l=0,h=0;for(;;){const m=r[n],x=n-n%3;if(h=x+(n+2)%3,m===-1){if(l===0)break;n=ed[--l];continue}const b=m-m%3,w=x+(n+1)%3,R=b+(m+2)%3,U=e[h],B=e[n],j=e[w],K=e[R];if(Kf(s[2*U],s[2*U+1],s[2*B],s[2*B+1],s[2*j],s[2*j+1],s[2*K],s[2*K+1])){e[n]=K,e[m]=U;const ut=r[R];if(ut===-1){let Rt=this._hullStart;do{if(this._hullTri[Rt]===R){this._hullTri[Rt]=n;break}Rt=this._hullPrev[Rt]}while(Rt!==this._hullStart)}this._link(n,ut),this._link(m,r[h]),this._link(h,R);const gt=b+(m+1)%3;l<ed.length&&(ed[l++]=gt)}else{if(l===0)break;n=ed[--l]}}return h}_link(n,e){this._halfedges[n]=e,e!==-1&&(this._halfedges[e]=n)}_addTriangle(n,e,r,s,l,h){const m=this.trianglesLen;return this._triangles[m]=n,this._triangles[m+1]=e,this._triangles[m+2]=r,this._link(m,s),this._link(m+1,l),this._link(m+2,h),this.trianglesLen+=3,m}}function Vp(o,n,e,r){const s=o-e,l=n-r;return s*s+l*l}function Kf(o,n,e,r,s,l,h,m){const x=o-h,b=n-m,w=e-h,R=r-m,U=s-h,B=l-m,j=w*w+R*R,K=U*U+B*B;return x*(R*K-j*B)-b*(w*K-j*U)+(x*x+b*b)*(w*B-R*U)<0}function Ya(o,n,e,r,s,l){const h=e-o,m=r-n,x=s-o,b=l-n,w=h*h+m*m,R=x*x+b*b,U=.5/(h*b-m*x),B=(b*w-m*R)*U,j=(h*R-x*w)*U;return B*B+j*j}function nd(o,n,e,r){if(r-e<=20)for(let s=e+1;s<=r;s++){const l=o[s],h=n[l];let m=s-1;for(;m>=e&&n[o[m]]>h;)o[m+1]=o[m--];o[m+1]=l}else{let s=e+1,l=r;Du(o,e+r>>1,s),n[o[e]]>n[o[r]]&&Du(o,e,r),n[o[s]]>n[o[r]]&&Du(o,s,r),n[o[e]]>n[o[s]]&&Du(o,e,s);const h=o[s],m=n[h];for(;;){do s++;while(n[o[s]]<m);do l--;while(n[o[l]]>m);if(l<s)break;Du(o,s,l)}o[e+1]=o[l],o[l]=h,r-s+1>=l-e?(nd(o,n,s,r),nd(o,n,e,l-1)):(nd(o,n,e,l-1),nd(o,n,s,r))}}function Du(o,n,e){const r=o[n];o[n]=o[e],o[e]=r}function rd(o){return o[0]}function oc(o){return o[1]}function Ks(o,n,e=5){return Math.abs(o-n)<=Math.pow(10,-e)}class Qs{constructor(){this.point={x:0,y:0},this.slope=Math.PI/4}static fromPointSlope(n,e){const r=new Qs;return r.point=n,r.slope=e,r}resolveY(n){return Math.tan(this.slope)*(n-this.point.x)+this.point.y}distanceToLinearEquation(n){return Ks(this.slope,n.slope)?this.distanceToPoint(n.point):-1}distanceToPoint(n){let e=0;if(Math.tan(this.slope)*(n.x-this.point.x)+this.point.y===n.y)return 0;e=this.slope>=Math.PI/2?this.slope-Math.PI/2:Math.PI/2+this.slope;const r=Qs.fromPointSlope(n,e),s=this.crossPoint(r);return s?Math.ceil(Math.sqrt(Math.pow(s.x-n.x,2)+Math.pow(s.y-n.y,2))):0}crossPoint(n){if(Ks(n.slope,this.slope))return null;let e=0,r=0;const s=Math.tan(n.slope),l=Math.tan(this.slope),{x:h,y:m}=this.point,{x,y:b}=n.point;return Ks(this.slope,Math.PI/2)?(e=this.point.x,r=s*(e-x)+b):Ks(n.slope,Math.PI/2)?(e=n.point.x,r=l*(e-h)+m):Ks(this.slope,Math.PI)||Ks(this.slope,0)?(r=this.point.y,e=(r-b)/s+x):Ks(n.slope,Math.PI)||Ks(n.slope,0)?(r=n.point.y,e=(r-m)/l+h):(e=(s*x-b+m-l*h)/(s-l),r=l*(e-h)+m),{x:e,y:r}}}function sc(o,n,e){return o.fillType==="solidFill"?function(r,s,l){const h=new vs,[m,x]=io(r.color);return h.beginFill(m,x),h.drawRect(0,0,s,l),h.endFill(),h}(o,n,e):o.fillType==="gradientFill"?function(r,s,l){let h=null;const m=new Ci;if(r.stopList.sort((b,w)=>b.pos-w.pos),!r.stopList.find(b=>b.pos===0)){const b=r.stopList[0];r.stopList.unshift({pos:0,color:b.color})}if(!r.stopList.find(b=>b.pos===1)){const b=r.stopList[r.stopList.length-1];r.stopList.push({pos:1,color:b.color})}const x=b=>{const w=[];for(let R=0,U=b.length;R<U-1;R++){const B=b[R],j=b[R+1],K=B.pos+.5*(j.pos-B.pos),ut=Yc(B.color,j.color,.5),gt=2*R;w[gt]=B,w[gt+1]={color:ut,pos:K},w[gt+2]=j}return w};if(r.stopList=x(r.stopList),r.stopList=x(r.stopList),r.line?h=function(b,w,R){const U=w/2,B=R/2,j={x:-U,y:B},K={x:-U,y:-B},ut={x:U,y:B},gt={x:U,y:-B},Rt=Qs.fromPointSlope({x:-U,y:0},Math.PI/2),Le=Qs.fromPointSlope({x:0,y:B},0),en=Qs.fromPointSlope({x:U,y:0},Math.PI/2),At=Qs.fromPointSlope({x:0,y:-B},0),oe=[j,K,ut,gt],qt=[Rt,Le,en,At],ne=[],Je=b.stopList.slice(1,b.stopList.length-1).map(He=>{var cn,Be;const me=2*Math.PI;let sn=(Be=(cn=b.line)===null||cn===void 0?void 0:cn.ang)!==null&&Be!==void 0?Be:0;for(;sn>me;)sn-=me;for(;sn<0;)sn+=me;const Bn={x:0,y:0};Ks(sn,Math.PI/2)?(Bn.x=0,Bn.y=R/2-He.pos*R):Ks(sn,0)?(Bn.x=He.pos*w-w/2,Bn.y=0):(Bn.x=He.pos*w-w/2,Bn.y=R/2-He.pos*R),sn>Math.PI/2&&sn<=Math.PI&&(Bn.x*=-1),sn>Math.PI&&sn<=2*Math.PI&&(Bn.y*=-1);const tr=Qs.fromPointSlope(Bn,Math.PI/2-b.line.ang),br=qt.map(gr=>tr.crossPoint(gr)).filter(gr=>gr&&gr.x<=U&&gr.x>=-U&&gr.y<=B&&gr.y>=-B).map(gr=>({point:gr,color:He.color})).sort((gr,Qr)=>Qr.point.y-gr.point.y);ne.push(...br);let nr=Math.abs(br[1].point.x-br[0].point.x)/10;for(let gr=20;gr--;){const Qr=gr%2==0?1:-1,qr=Bn.x+Qr*nr,Zr=tr.resolveY(qr);qr<=U&&qr>=-U&&Zr<=B&&Zr>=-B&&ne.push({point:{x:qr,y:Zr},color:He.color}),nr+=nr}return tr});let Pe=[],$t=[];t:for(let He=0;He<oe.length;He++){const cn=oe[He];for(let tr=0;tr<Je.length-1;tr++){const br=Je[tr],nr=Je[tr+1],gr=br.distanceToLinearEquation(nr),Qr=br.distanceToPoint(cn),qr=nr.distanceToPoint(cn);if(Qr<gr&&qr<gr){const Zr=b.stopList.slice(1,b.stopList.length-1)[tr],Vi=b.stopList.slice(1,b.stopList.length-1)[tr+1],Jn=Yc(Zr.color,Vi.color,Qr/gr);ne.splice(tr+1,0,{point:cn,color:Jn});continue t}}const Be=Je[0],me=Je[Je.length-1],sn=Be.distanceToPoint(cn),Bn=me.distanceToPoint(cn);sn<=Bn?Pe.push({point:cn,dis:sn}):$t.push({point:cn,dis:Bn})}Pe=Pe.sort((He,cn)=>cn.dis-He.dis);const Ee=Pe.map((He,cn)=>{if(cn===0)return{point:He.point,color:b.stopList[0].color};{const Be=b.stopList[0].color,me=b.stopList[1].color;return{point:He.point,color:Yc(Be,me,1-(Pe[0].dis===0?1:He.dis/Pe[0].dis))}}}).sort((He,cn)=>cn.point.y-He.point.y);$t=$t.sort((He,cn)=>cn.dis-He.dis);const hn=$t.map((He,cn)=>{if(cn===0)return{point:He.point,color:b.stopList[b.stopList.length-1].color};{const Be=b.stopList[b.stopList.length-2].color,me=b.stopList[b.stopList.length-1].color;return{point:He.point,color:Yc(Be,me,$t[0].dis===0?0:He.dis/$t[0].dis)}}}).sort((He,cn)=>cn.point.y-He.point.y),Ve=Ee.concat(...ne).concat(hn);for(let He=0;He<Ve.length;He++)Ve[He].point.x+=U,Ve[He].point.y=-Ve[He].point.y+B;return{points:Ve,position:{x:0,y:0}}}(r,s,l):r.path&&(h=function(b,w,R){var U;const B=[],j={x:0,y:0};if(((U=b.path)===null||U===void 0?void 0:U.path)==="circle"){const K=w/2,ut=R/2,gt=Math.sqrt(K*K+ut*ut);b.stopList.forEach(Rt=>{if(Rt.pos===0)B.push({point:{x:0,y:0},color:Rt.color});else{const Le=gt*Rt.pos,en=new dl.Path;en.absellipse(0,0,Le,Le,0,2*Math.PI,!1,0),en.getPoints(50).forEach(At=>{B.push({point:{x:At.x,y:At.y},color:Rt.color})})}j.x=K,j.y=ut})}return{points:B,position:j}}(r,s,l)),h){const b=[],w=[],{position:R,points:U}=h,B=va.from(U,Rt=>Rt.point.x,Rt=>Rt.point.y);for(let Rt=0;Rt<B.triangles.length;Rt+=3)b.push(U[B.triangles[Rt]].point.x,U[B.triangles[Rt]].point.y),b.push(U[B.triangles[Rt+1]].point.x,U[B.triangles[Rt+1]].point.y),b.push(U[B.triangles[Rt+2]].point.x,U[B.triangles[Rt+2]].point.y),w.push(...Ro(U[B.triangles[Rt]].color)),w.push(...Ro(U[B.triangles[Rt+1]].color)),w.push(...Ro(U[B.triangles[Rt+2]].color));const j=new Ca;j.addAttribute("aVertexPosition",b,2),j.addAttribute("aColor",w,4);const K=Oa.from(`
        precision mediump float;
        attribute vec2 aVertexPosition;
        attribute vec4 aColor;
        uniform mat3 translationMatrix;
        uniform mat3 projectionMatrix;
        varying vec4 vColor;
        void main() {
            vColor = aColor;
            gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
        }`,`precision mediump float;    
        varying vec4 vColor;
        void main() {
            float alpha = vColor.a;
            vec4 color = vColor;
            color.a = 1.0;
            gl_FragColor = color * alpha;
        }
    `),ut=new vs;ut.drawRect(0,0,s+1,l+1),m.mask=ut,m.addChild(ut);const gt=new Bs(j,K);gt.position.x=R.x,gt.position.y=R.y,m.addChild(gt)}return m}(o,n,e):null}const ac=[`
vec3 rgb2hsl(vec3 rgb) {
    float cMax = max(max(rgb.r, rgb.g), rgb.b);
    float cMin = min(min(rgb.r, rgb.g), rgb.b);
    float delta = cMax - cMin;
    
    float h = 0.0;
    if (delta == 0.0) {
        h = 0.0;
    } else if (cMax == rgb.r) {
        h = 60.0 * mod(((rgb.g - rgb.b) / delta), 6.0);
    } else if (cMax == rgb.g ) {
        h = 60.0 * ((rgb.b - rgb.r) / delta + 2.0);
    } else if (cMax == rgb.b) {
        h = 60.0 * ((rgb.r - rgb.g) / delta + 4.0);
    }
    
    float l = (cMax + cMin) / 2.0;
    
    float s = 0.0;
    if (delta == 0.0) {
        s = 0.0;
    } else {
        s = delta / (1.0 - abs(2.0 * l - 1.0));
    }
    
    return vec3(h, s, l);
}
`],id={biLevel:`
vec4 transform(vec4 texColor, float arg) {
    vec3 hsl = rgb2hsl(texColor.rgb);
    mat3 rgb2yuv = mat3(
        0.2126, 0.7152, 0.0722,
        -0.09991, -0.33609, 0.43600,
        0.615, -0.5586, -0.05639
    );
    vec3 yuv = texColor.rgb * rgb2yuv;
    if (yuv.x >= 0.49 || texColor.a < 0.9) {
        return vec4(1.0, 1.0, 1.0, 1.0);
    } else {
        return vec4(0.0, 0.0, 0.0, 1.0);
    }
}
`};class Wp extends ro{constructor(n,e){var r;super(void 0,(r=id[n],`
varying vec2 vTextureCoord;

uniform float arg;
uniform sampler2D uSampler;

${ac.map(s=>s+`
`).join(`
`)}

${r}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg);
}
`),{arg:e})}}class od{constructor(n,e){this.renderContainers=[],this.renderTextures=[],this.textures=Object.create(null),this.fillStyles=[],this.renderer=n,this.spriteTextures=e}addTexture(n,e){this.textures[n]=e}render(n){const{items:e,width:r,height:s}=n,l=new Ci;e.forEach(x=>{if(x.item.blipFillObject)x.item.blipFillObject.position.x+=x.x+2,x.item.blipFillObject.position.y+=x.y+2,l.addChild(x.item.blipFillObject);else{const b=sc(x.item.fill,x.width-2,x.height-2);if(b)b.position.x+=x.x+2,b.position.y+=x.y+2,l.addChild(b);else{const w=new vs;w.drawRect(0,0,x.width-4,x.height-4),l.addChild(w)}}if(x.item.name){const b=new Oc(x.item.name,{fontFamily:"Arial",fontSize:12,fill:16715792,align:"center"});b.position.x=x.x+2,b.position.y=x.y+2,l.addChild(b)}});const h=new vs;h.drawRect(0,0,Math.ceil(r),Math.ceil(s)),l.addChild(h);const m=Ri.create({width:r,height:s});this.renderTextures.push(m),this.renderContainers.push(l),this.renderer.render(l,{renderTexture:m}),e.forEach(x=>{this.textures[x.item.id]=new Dn(m.baseTexture,new dr(x.x+2,x.y+2,x.width-4,x.height-4))})}getTexture(n){return this.textures[n]||this.spriteTextures.getTexture(n)||null}getGifFrames(n){return this.spriteTextures.getGifFrames(n)}addFill(n,e,r,s){const l=JSON.stringify(n)+e+r,h=nc()(l);if(this.textures[h]||this.fillStyles.findIndex(m=>m.id===h)>=0)return h;if(n.fillType!=="blipFill")this.fillStyles.push({fill:n,width:e,height:r,id:h,name:s});else{const m=this.spriteTextures.getTexture(n.src);if(m){const x=new li;x.texture=m,n.filters.length>0&&(x.filters=function(b){const w=[];return b.forEach(R=>{R.type==="biLevel"?w.push(new Wp("biLevel",R.args[0])):R.type}),w}(n.filters)),this.fillStyles.push({fill:n,width:m.width,height:m.height,id:h,blipFillObject:x})}}return h}pack(){const n=this.fillStyles.filter(r=>!(!r.fill.fillType||r.fill.fillType==="noFill"||r.width===0||r.height===0)||(this.textures[r.id]=null,!1));n.forEach(r=>{r.width+=4,r.height+=4});const e=yf(n);for(let r=0,s=e.length;r<s;r++){const l=e[r];this.render(l)}}destroy(){this.textures=Object.create(null),this.fillStyles=[],this.renderTextures.forEach(n=>n.destroy(!0)),this.renderContainers.forEach(n=>n.destroy({children:!0})),this.spriteTextures.destroy()}}function uc(o,n,e){let r,s,l=n,h=e;l===0&&(l=h/1e4),h===0&&(h=l/1e4);const m=o%360;if(m%180==0)r=Math.cos(m*(Math.PI/180))*l,s=0;else if(m%90==0)r=0,s=-Math.sin(m*(Math.PI/180))*h;else{const x=Math.tan(m*Math.PI/180);r=l*h/Math.sqrt(Math.pow(h,2)+Math.pow(l*x,2)),(m>90&&m<270||m<-90&&m>-270)&&(r=-r),s=-x*r}return{x:r,y:s}}function sd(o,n,e,r,s,l,h){const m={x:0,y:0},x=-l,b=uc((s=-s)/Math.PI*180,e,r),w=o.x-b.x,R=o.y-b.y;for(let U=0;U<51;U++){const B=uc((s+U/50*x)/Math.PI*180,e,r);B.x+=w,B.y+=R,U/50==1&&(m.x=B.x,m.y=B.y),B.x=B.x/9525*n.x,B.y=B.y/9525*n.y,h.lineTo(B.x,B.y)}return m}class bf{constructor(n){this.renderContainers=[],this.renderTextures=[],this.idTidMap=Object.create(null),this.textures=Object.create(null),this.graphics=[],this.renderer=n}render(n){const{items:e,width:r,height:s}=n,l=Ri.create({width:r,height:s});this.renderTextures.push(l);const h=new Ci;e.forEach(x=>{const b=new li;b.texture=x.item.texture,b.x=x.x+2,b.y=x.y+2,h.addChild(b)});const m=new vs;m.drawRect(0,0,r,s),h.addChild(m),this.renderer.render(h,{renderTexture:l}),this.renderContainers.push(h),e.forEach(x=>{const b=x.item.padding;this.textures[x.item.id]={texture:new Dn(l.baseTexture,new dr(x.x+2+b,x.y+2+b,x.width-4-2*b,x.height-4-2*b)),pivot:x.item.pivot}})}getGraphicsData(n){const e=this.idTidMap[n]||"";return this.textures[e]||null}addGraphics(n,e,r,s,l,h,m,x){const b=x||Jf(),w=nc()(e+((h==null?void 0:h.width)||1).toString()+m);if(this.idTidMap[b]=w,this.graphics.findIndex(R=>R.id===w)<0){const{texture:R,pivot:U,padding:B}=function(j,K,ut,gt,Rt,Le=!0){var en,At,oe,qt,ne,Je,Pe;const $t={x:Math.abs(Rt.x),y:Math.abs(Rt.y)},Ee=window.devicePixelRatio,hn=document.createElement("canvas"),Ve=hn.getContext("2d");if(!Ve)throw new Error("ctx");Ve.lineCap=(gt==null?void 0:gt.cap)||"butt",Ve.lineJoin=(gt==null?void 0:gt.join)||"miter";let He=0,cn=0,Be=0,me=0,sn=0,Bn="none",tr="none";return Le?(He=K,cn=ut,sn=0,tr="#ffffff"):(Bn="#ff0000",sn=(en=gt==null?void 0:gt.width)!==null&&en!==void 0?en:1,Be=.5*((At=gt==null?void 0:gt.width)!==null&&At!==void 0?At:1),me=.5*((oe=gt==null?void 0:gt.width)!==null&&oe!==void 0?oe:1),He=K+((qt=gt==null?void 0:gt.width)!==null&&qt!==void 0?qt:1),cn=ut+((ne=gt==null?void 0:gt.width)!==null&&ne!==void 0?ne:1),$t.x+=.5*((Je=gt==null?void 0:gt.width)!==null&&Je!==void 0?Je:1),$t.y+=.5*((Pe=gt==null?void 0:gt.width)!==null&&Pe!==void 0?Pe:1)),He+=Math.abs(Rt.x),cn+=Math.abs(Rt.y),Be+=Math.abs(Rt.x),me+=Math.abs(Rt.y),He+=4,cn+=4,Be+=2,me+=2,Be*=Ee,me*=Ee,He=Math.ceil(He*Ee),cn=Math.ceil(cn*Ee),hn.width=He,hn.height=cn,Ve.transform(Ee,0,0,Ee,Be,me),j.forEach(br=>{Ve.lineWidth=sn,Ve.strokeStyle=Bn,br.fill!=="none"&&(Ve.fillStyle=tr),(gt==null?void 0:gt.dash)&&Ve.setLineDash(gt.dash.split(",").map(qr=>Number(qr.trim()))),Ve.beginPath();const{scale:nr}=br,gr=br.path.trim().split(" ");let Qr={x:0,y:0};for(let qr=0;qr<gr.length;qr+=2){const Zr=gr[qr],Vi=gr[qr+1];if(Zr==="M"){let[Jn,ti]=Vi.split(",").map(Wr=>Number(Wr));Qr={x:Jn,y:ti},Jn=Jn/9525*nr.x,ti=ti/9525*nr.y,Ve.moveTo(Jn,ti)}else if(Zr==="A"){const[Jn,ti,Wr,ir]=Vi.split(",").map(Yn=>Number(Yn));Qr=sd(Qr,nr,Jn,ti,Wr,ir,Ve)}else if(Zr==="L"){let[Jn,ti]=Vi.split(",").map(Wr=>Number(Wr));Qr={x:Jn,y:ti},Jn=Jn/9525*nr.x,ti=ti/9525*nr.y,Ve.lineTo(Jn,ti)}else if(Zr==="QB"){let[Jn,ti,Wr,ir]=Vi.split(",").map(Yn=>Number(Yn));Qr={x:Wr,y:ir},Jn=Jn/9525*nr.x,ti=ti/9525*nr.y,Wr=Wr/9525*nr.x,ir=ir/9525*nr.y,Ve.quadraticCurveTo(Jn,ti,Wr,ir)}else if(Zr==="CB"){let[Jn,ti,Wr,ir,Yn,Wi]=Vi.split(",").map(Ta=>Number(Ta));Qr={x:Yn,y:Wi},Jn=Jn/9525*nr.x,ti=ti/9525*nr.y,Wr=Wr/9525*nr.x,ir=ir/9525*nr.y,Yn=Yn/9525*nr.x,Wi=Wi/9525*nr.y,Ve.bezierCurveTo(Jn,ti,Wr,ir,Yn,Wi)}else Zr==="C"&&Ve.closePath()}br.hasStroke&&sn>0&&Ve.stroke(),br.fill!=="none"&&Le&&Ve.fill("nonzero")}),{texture:new Dn(new fr(hn,{width:hn.width/2,height:hn.height/2,resolution:Ee})),pivot:$t,padding:2}}(n,s,l,h,r,m);this.graphics.push({id:w,texture:R,pivot:U,width:R.width,height:R.height,padding:B})}return b}pack(){this.graphics.forEach(n=>{n.width+=4,n.height+=4}),yf(this.graphics).forEach(n=>{this.render(n)}),this.graphics.forEach(n=>{n.texture.destroy(!0)}),this.graphics=[]}destroy(){Object.keys(this.textures).forEach(n=>{var e;(e=this.textures[n])===null||e===void 0||e.texture.destroy()}),this.textures=Object.create(null),this.graphics=[],this.renderContainers.forEach(n=>n.destroy({children:!0,baseTexture:!0,texture:!0})),this.renderTextures.forEach(n=>n.destroy(!0))}}var Qf=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class wf{constructor(n){this.gifs=Object.create(null),this.textures=Object.create(null),this.spriteSheets=[],this.isLoaded=!1,this.loader=n}getTexture(n){return this.textures[n]||null}getGifFrames(n){return this.gifs[n]?this.gifs[n].filter(e=>!!e):[]}loadSpriteSheetItem(n,e,r){return Qf(this,void 0,void 0,function*(){const s=yield this.loader.fetchJson(`${n}/${e}/jsonOutput/${r}.json`),l=yield this.loader.fetchPng(`${n}/${e}/jsonOutput/${r}.png`),h=document.createElement("img");h.src=l,yield new Promise((b,w)=>{h.onload=()=>b(""),h.onerror=()=>w()});const m=new fr(h),x=new kd(m,s);yield new Promise(b=>{x.parse(()=>b(""))}),this.spriteSheets.push(x),Object.keys(x.textures).forEach(b=>{const w=b.match(/^(.+)_gif_(\d+)$/);if(w&&w[1]&&w[2]){const R=w[1];this.gifs[R]||(this.gifs[R]=[]);const U=parseInt(w[2],10);this.gifs[R][U]=x.textures[b]}else this.textures[b]=x.textures[b]})})}loadSpriteSheets(n,e,r){return this.isLoaded?Promise.resolve([]):(this.isLoaded=!0,Promise.all(n.map(s=>this.loadSpriteSheetItem(e,r,s))))}destroy(){this.isLoaded=!1,this.spriteSheets.forEach(n=>n.destroy(!0))}}class ad{constructor(){this.prevTime=-1,this.times=10,this.dur=0,this.valeList=[],this.value=0,this.calcFps()}calcFps(){requestAnimationFrame(n=>{const e=n-this.prevTime;this.dur+=e,this.times-=1,this.times===0&&(this.valeList.push(1e4/this.dur),this.times=10,this.dur=0,this.valeList.length>10&&(this.value=Math.round(this.valeList.reduce((r,s)=>r+s)/this.valeList.length),this.valeList=[])),this.prevTime=n,this.calcFps()})}}var sp=T(9),Xp=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};class Tf{constructor(n){this.useCache=!1,this.useCache=n}bindTask(n){this.taskId=n,this.useCache&&(this.cache=sp.createInstance({name:"_slide_local_cache_",storeName:this.taskId,driver:sp.INDEXEDDB,version:1}),this.cache.clear().catch(()=>{}))}fetchJson(n){var e,r;return Xp(this,void 0,void 0,function*(){let s=yield(e=this.cache)===null||e===void 0?void 0:e.getItem(n);return s&&this.useCache||(s=yield(yield fetch(n)).json(),this.useCache&&(yield(r=this.cache)===null||r===void 0?void 0:r.setItem(n,s))),s})}fetchPng(n){var e,r;return Xp(this,void 0,void 0,function*(){let s=yield(e=this.cache)===null||e===void 0?void 0:e.getItem(n);if(s&&this.useCache)return s;if(s=yield fetch(n).then(l=>l.blob()).then(l=>new Promise((h,m)=>{const x=new FileReader;x.onload=()=>{h(x.result)},x.onerror=()=>{m(new Error(`fetch ${n} failed`))},x.readAsDataURL(l)})),this.useCache&&(yield(r=this.cache)===null||r===void 0?void 0:r.setItem(n,s)),!s)throw new Error(`fetch ${n} failed`);return s})}destroy(){var n;(n=this.cache)===null||n===void 0||n.clear().catch(()=>{})}}var ml=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})};window.PIXI=G,J.skipHello();const Yp={randomBar:"RandomLines",circle:"Shape",ripple:"Ripples",wipe:"Erase",dissolve:"Dissolve",morph:"Smooth",fade:"FadeInOut",push:"Push",split:"Separation",reveal:"Display",pull:"Uncover",cover:"Cover",flash:"Flash",checker:"Checkerboard",blinds:"WindowShades",curtains:"Curtain",fallOver:"Fall",drape:"Suspension",wheel:"Clock",comb:"Combing",warp:"Scale",peelOff:"PeelOff",flip:"Flip"};class Sf{constructor(n){this.eventHub=n,this.targets=Object.create(null)}addTarget(n,e){this.targets[n]=e}getTargetById(n){return this.targets[n]}getTarget(n,e,r={type:"el",index:0,id:""}){var s,l;let h=this.targets[n.id];return n.type!=="shape"?h:(n.type==="shape"&&n.txEl&&(h=(s=h==null?void 0:h.getTextElement(n.txEl.type,n.txEl.range))!==null&&s!==void 0?s:null),n.type==="shape"&&n.bg&&r.index===0&&(e=!1,h=(l=h==null?void 0:h.getBgElement())!==null&&l!==void 0?l:null,this.eventHub.emit("IterateTimeNodeEnd",r.id)),e&&h?h.getIterateEntry(r.type,r.index,r.id):h)}clearTargets(){this.targets=Object.create(null)}}const _a={prev:"gotoPrev",next:"gotoNext",goto:"gotoSlide"},xr={mainSeqStepChange:"mainSeqStepChange",mainSeqStateChange:"mainSeqStateChange",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",slideChange:"slideChange",renderStart:"renderStart",renderEnd:"renderEnd",hyperlinkTrigger:"hyperlinkTrigger",interactiveAnimTrigger:"interactiveAnimTrigger",animateStart:"animateStart",animateEnd:"animateEnd",mediaSeek:"mediaSeek",mediaPlay:"mediaPlay",mediaPause:"mediaPause"};class Pm extends Z.a{constructor(n,e={}){super(),this.loader=new Tf(!1),this.transactionPlayer=new mt.TransactionPlayer,this.transactionSprite=new li,this.isForward=!0,this.dynamicResolution=1,this.drawCall=0,this.fps=new ad,this.width=0,this.height=0,this.currentIndex=0,this.slideCount=0,this.frameList=[],this.runtime={drawCall:0,fps:0},this.handlePrevSlide=()=>ml(this,void 0,void 0,function*(){const l=this.currentIndex-1;l>=1&&(this.isForward=!1,yield this.renderSlide(l))}),this.handleNextSlide=()=>ml(this,void 0,void 0,function*(){const l=this.currentIndex+1;l<=this.slideCount&&(this.isForward=!0,yield this.renderSlide(l))}),this.handleGotoSlide=l=>{l<=this.slideCount&&l>=1&&this.renderSlide(l)},this.mode=n,this.config={minFPS:Object(W.isUndefined)(e.minFPS)?45:e.minFPS,maxFPS:Object(W.isUndefined)(e.maxFPS)?50:e.maxFPS,resolution:Object(W.isUndefined)(e.resolution)?window.devicePixelRatio:e.resolution,autoResolution:!Object(W.isUndefined)(e.autoResolution)&&e.autoResolution,minResolution:Object(W.isUndefined)(e.minResolution)?1:e.minResolution,autoFPS:!Object(W.isUndefined)(e.autoFPS)&&e.autoFPS},this.app=new Yu({antialias:!0,autoDensity:!0,backgroundColor:16777215}),this.updateConfig(this.config),this.app.view.style.zIndex="1",this.app.stage.sortableChildren=!0;const r=this.app.renderer,{drawElements:s}=r.gl;r.gl.drawElements=(...l)=>{s.call(r.gl,...l),this.drawCall+=1},this.app.ticker.add(l=>{this.runtime.drawCall=this.drawCall,this.drawCall=0;const h=1e3/(l/(ie.TARGET_FPMS||.06));if(this.frameList.push(h),this.frameList.length>50){const m=this.frameList.reduce((x,b)=>x+b)/this.frameList.length;if(this.runtime.fps=Math.floor(m),this.fps.value<this.config.minFPS)this.dynamicResolution=this.app.renderer.resolution-.1,this.dynamicResolution=Math.max(this.config.minResolution,this.dynamicResolution),this.dynamicResolution<=this.config.minResolution&&this.config.autoFPS&&(this.app.ticker.minFPS-=2,this.app.ticker.maxFPS-=2);else if(this.fps.value>1.08*this.config.minFPS&&this.fps.value<=this.config.maxFPS){const x=Math.min(this.app.ticker.minFPS+2,this.config.minFPS),b=Math.min(this.app.ticker.maxFPS+2,this.config.maxFPS);x<=this.config.minFPS&&(this.app.ticker.minFPS=x),b<=this.config.maxFPS&&(this.app.ticker.maxFPS=b),x>=this.config.minFPS&&b>=this.config.maxFPS&&(this.dynamicResolution+=.1,this.dynamicResolution=Math.max(this.config.minResolution,this.dynamicResolution))}this.config.autoResolution&&this.dynamicResolution!==this.app.renderer.resolution&&this.app.ticker.addOnce(()=>{const x=Math.min(this.dynamicResolution,this.config.resolution);this.app.renderer.resolution=x,this.app.renderer.plugins.interaction.resolution=this.app.renderer.resolution,this.app.renderer.resize(this.width,this.height)},No.HIGH),this.frameList=[]}},null,No.LOW)}get view(){return this.app.view}clearForward(){this.isForward=!0}updateConfig(n){Object(W.isUndefined)(n.minFPS)||(this.config.minFPS=n.minFPS,this.app.ticker.minFPS=n.minFPS),Object(W.isUndefined)(n.maxFPS)||(this.config.maxFPS=n.maxFPS,this.app.ticker.maxFPS=n.maxFPS),Object(W.isUndefined)(n.resolution)||(this.config.resolution=n.resolution,this.app.ticker.addOnce(()=>{this.app.renderer.resolution=n.resolution||window.devicePixelRatio,this.app.renderer.plugins.interaction.resolution=this.app.renderer.resolution,this.app.renderer.resize(this.width,this.height)},No.HIGH)),Object(W.isUndefined)(n.autoResolution)||(this.config.autoResolution=n.autoResolution),Object(W.isUndefined)(n.autoFPS)||(this.config.autoFPS=n.autoFPS),Object(W.isUndefined)(n.minResolution)||(this.config.minResolution=n.minResolution)}preload(n){return ml(this,void 0,void 0,function*(){if(n<1||n>this.slideCount||!this.loader.cache)return;const e=yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/slide-${n}.json`),{sheets:r}=e;for(const s of r)yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/${s}.json`),yield this.loader.fetchPng(`${this.url}/${this.taskId}/jsonOutput/${s}.png`)})}setResourceData(n,e){this.taskId=n,this.url=e,this.loader.bindTask(n)}setInteractive(n){this.app.stage.interactive=n,this.app.stage.interactiveChildren=n}loadSlide(n){return ml(this,void 0,void 0,function*(){const e=new wf(this.loader),r=new Z.a,s={mode:this.mode,renderer:this.app.renderer,graphicsTexture:new bf(this.app.renderer),fillTexture:new od(this.app.renderer,e),stageWidth:0,stageHeight:0,ticker:this.app.ticker,timingTargets:new Sf(r),eventHub:r,view:this.app.view,medias:Object.create(null)},l=yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/slide-${n}.json`),{width:h,height:m,sheets:x}=l;yield e.loadSpriteSheets(x,this.url,this.taskId),s.stageWidth=h,s.stageHeight=m;const b=new Am(l,s,{x:0,y:0});return s.eventHub.on(_a.prev,this.handlePrevSlide),s.eventHub.on(_a.next,this.handleNextSlide),s.eventHub.on(_a.goto,this.handleGotoSlide),this.translateEvent(s.eventHub,[xr.mainSeqStepChange,xr.mainSeqStateChange,xr.hyperlinkTrigger,xr.interactiveAnimTrigger,xr.mainSeqStepStart,xr.mainSeqStepEnd,xr.animateStart,xr.animateEnd,xr.mediaPlay,xr.mediaPause,xr.mediaSeek]),b.preRender(),s.fillTexture.pack(),s.graphicsTexture.pack(),{stage:b,json:l}})}translateEvent(n,e){e.forEach(r=>{n.on(r,(...s)=>{this.emit(r,...s)})})}renderSlide(n){return ml(this,void 0,void 0,function*(){this.emit(xr.renderStart,n),this.currentIndex=Number(n);const e=yield this.loadSlide(n),{width:r,height:s,slideCount:l}=e.json;let h;this.slideCount=l,this.app.view.style.width=r+"px",this.app.view.style.height=s+"px",this.app.renderer.resize(r,s),this.width=r,this.height=s,this.currentStage&&(e.json.transition&&e.json.transition.type&&(h=this.getBase64(this.currentStage)),this.prevStage=this.currentStage),this.currentStage=e,yield e.stage.render(),e.stage.createTiming(),e.stage.container.visible=!0,e.stage.collectMainSeqStartValue(),this.isForward?e.stage.setMainSeqStep(0,"start"):e.stage.setMainSeqStep(-1,"end");const m=this.getBase64(this.currentStage);e.stage.container.visible=!1,this.app.stage.addChild(e.stage.container),h&&m&&e.json.transition&&e.json.transition.type&&(yield this.playTransaction(h,m,e.json.transition)),this.prevStage&&(this.app.stage.removeChild(this.prevStage.stage.container),this.prevStage.stage.destroy(),this.prevStage=void 0),this.isForward?e.stage.startTiming():e.stage.setMainSeqApplied(),e.stage.container.visible=!0,this.emit(xr.renderEnd,n),this.emit(xr.slideChange,n),this.preload(n+1).catch(()=>{}),this.preload(n-1).catch(()=>{})})}getBase64(n){const{width:e,height:r}=n.json,s=Ri.create({width:e,height:r});return this.app.renderer.render(n.stage.container,{renderTexture:s}),this.app.renderer.plugins.extract.base64(s,"image/jpeg")}playTransaction(n,e,r){return ml(this,void 0,void 0,function*(){const s=this.app.view.parentElement;if(n&&e&&s&&Yp[r.type]){this.transactionSprite.zIndex=999,this.app.stage.addChild(this.transactionSprite);const l=this.transactionPlayer.renderer.domElement,h=Dn.from(l),m=()=>h.update();this.app.ticker.add(m),this.transactionSprite.texture=h;const{width:x,height:b}=this.currentStage.json;return new Promise(w=>{var R,U;this.transactionPlayer.play({reverse:!this.isForward,prevTextureUrl:n,nextTextureUrl:e,textureWidth:x,textureHeight:b,presetType:Yp[r.type],stageWidth:x,stageHeight:b,duration:(U=(R=this.currentStage)===null||R===void 0?void 0:R.json.transition)===null||U===void 0?void 0:U.dur,delay:0,onTransactionEnd:()=>{w(),this.app.stage.removeChild(this.transactionSprite),this.app.ticker.remove(m)}})})}return Promise.resolve()})}nextStep(){var n;(n=this.currentStage)===null||n===void 0||n.stage.nextStep()}prevStep(){var n;(n=this.currentStage)===null||n===void 0||n.stage.prevStep()}mainSeqLength(){var n,e;return(e=(n=this.currentStage)===null||n===void 0?void 0:n.stage.mainSeqLength())!==null&&e!==void 0?e:0}mainSeqStep(){var n,e;return(e=(n=this.currentStage)===null||n===void 0?void 0:n.stage.mainSeqStep())!==null&&e!==void 0?e:0}setMainSeqStep(n,e){var r;(r=this.currentStage)===null||r===void 0||r.stage.setMainSeqStep(n,e)}mainSeqState(){var n,e;return(e=(n=this.currentStage)===null||n===void 0?void 0:n.stage.mainSeqState())!==null&&e!==void 0?e:null}mainSeqHasNextStep(){var n,e;return(e=(n=this.currentStage)===null||n===void 0?void 0:n.stage.mainSeqHasNextStep())!==null&&e!==void 0&&e}mainSeqHasPrevStep(){var n,e;return(e=(n=this.currentStage)===null||n===void 0?void 0:n.stage.mainSeqHasPrevStep())!==null&&e!==void 0&&e}nextTick(n){this.app.ticker.addOnce(()=>{n()},No.LOW)}applyInteractiveAction(n){var e;(e=this.currentStage)===null||e===void 0||e.stage.applyInteractiveAction(n)}seekInteractiveSeqToEnd(n){var e;(e=this.currentStage)===null||e===void 0||e.stage.seekInteractiveSeqToEnd(n)}setMediaState(n,e){var r;return ml(this,void 0,void 0,function*(){yield(r=this.currentStage)===null||r===void 0?void 0:r.stage.setMediaState(n,e)})}setMediaCurrentTime(n,e){var r;(r=this.currentStage)===null||r===void 0||r.stage.setMediaCurrentTime(n,e)}pause(){this.app.ticker.stop()}resume(){this.app.ticker.start()}destroy(){this.prevStage&&this.prevStage.stage.destroy(),this.currentStage&&this.currentStage.stage.destroy(),this.loader.destroy()}}var Kr,bs=[],Ef="ResizeObserver loop completed with undelivered notifications.";(function(o){o.BORDER_BOX="border-box",o.CONTENT_BOX="content-box",o.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(Kr||(Kr={}));var ap,ah=function(o){return Object.freeze(o)},qa=function(o,n){this.inlineSize=o,this.blockSize=n,ah(this)},uh=function(){function o(n,e,r,s){return this.x=n,this.y=e,this.width=r,this.height=s,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,ah(this)}return o.prototype.toJSON=function(){var n=this;return{x:n.x,y:n.y,top:n.top,right:n.right,bottom:n.bottom,left:n.left,width:n.width,height:n.height}},o.fromRect=function(n){return new o(n.x,n.y,n.width,n.height)},o}(),up=function(o){return o instanceof SVGElement&&"getBBox"in o},ud=function(o){if(up(o)){var n=o.getBBox(),e=n.width,r=n.height;return!e&&!r}var s=o,l=s.offsetWidth,h=s.offsetHeight;return!(l||h||o.getClientRects().length)},Mf=function(o){var n,e;if(o instanceof Element)return!0;var r=(e=(n=o)===null||n===void 0?void 0:n.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(r&&o instanceof r.Element)},Nu=typeof window!="undefined"?window:{},Fu=new WeakMap,ld=/auto|scroll/,lp=/^tb|vertical/,Cm=/msie|trident/i.test(Nu.navigator&&Nu.navigator.userAgent),rs=function(o){return parseFloat(o||"0")},lh=function(o,n,e){return o===void 0&&(o=0),n===void 0&&(n=0),e===void 0&&(e=!1),new qa((e?n:o)||0,(e?o:n)||0)},Af=ah({devicePixelContentBoxSize:lh(),borderBoxSize:lh(),contentBoxSize:lh(),contentRect:new uh(0,0,0,0)}),jo=function(o,n){if(n===void 0&&(n=!1),Fu.has(o)&&!n)return Fu.get(o);if(ud(o))return Fu.set(o,Af),Af;var e=getComputedStyle(o),r=up(o)&&o.ownerSVGElement&&o.getBBox(),s=!Cm&&e.boxSizing==="border-box",l=lp.test(e.writingMode||""),h=!r&&ld.test(e.overflowY||""),m=!r&&ld.test(e.overflowX||""),x=r?0:rs(e.paddingTop),b=r?0:rs(e.paddingRight),w=r?0:rs(e.paddingBottom),R=r?0:rs(e.paddingLeft),U=r?0:rs(e.borderTopWidth),B=r?0:rs(e.borderRightWidth),j=r?0:rs(e.borderBottomWidth),K=R+b,ut=x+w,gt=(r?0:rs(e.borderLeftWidth))+B,Rt=U+j,Le=m?o.offsetHeight-Rt-o.clientHeight:0,en=h?o.offsetWidth-gt-o.clientWidth:0,At=s?K+gt:0,oe=s?ut+Rt:0,qt=r?r.width:rs(e.width)-At-en,ne=r?r.height:rs(e.height)-oe-Le,Je=qt+K+en+gt,Pe=ne+ut+Le+Rt,$t=ah({devicePixelContentBoxSize:lh(Math.round(qt*devicePixelRatio),Math.round(ne*devicePixelRatio),l),borderBoxSize:lh(Je,Pe,l),contentBoxSize:lh(qt,ne,l),contentRect:new uh(R,x,qt,ne)});return Fu.set(o,$t),$t},ya=function(o,n,e){var r=jo(o,e),s=r.borderBoxSize,l=r.contentBoxSize,h=r.devicePixelContentBoxSize;switch(n){case Kr.DEVICE_PIXEL_CONTENT_BOX:return h;case Kr.BORDER_BOX:return s;default:return l}},Za=function(o){var n=jo(o);this.target=o,this.contentRect=n.contentRect,this.borderBoxSize=ah([n.borderBoxSize]),this.contentBoxSize=ah([n.contentBoxSize]),this.devicePixelContentBoxSize=ah([n.devicePixelContentBoxSize])},tm=function(o){if(ud(o))return 1/0;for(var n=0,e=o.parentNode;e;)n+=1,e=e.parentNode;return n},Rm=function(){var o=1/0,n=[];bs.forEach(function(s){if(s.activeTargets.length!==0){var l=[];s.activeTargets.forEach(function(h){var m=new Za(h.target),x=tm(h.target);l.push(m),h.lastReportedSize=ya(h.target,h.observedBox),x<o&&(o=x)}),n.push(function(){s.callback.call(s.observer,l,s.observer)}),s.activeTargets.splice(0,s.activeTargets.length)}});for(var e=0,r=n;e<r.length;e++)(0,r[e])();return o},hd=function(o){bs.forEach(function(n){n.activeTargets.splice(0,n.activeTargets.length),n.skippedTargets.splice(0,n.skippedTargets.length),n.observationTargets.forEach(function(e){e.isActive()&&(tm(e.target)>o?n.activeTargets.push(e):n.skippedTargets.push(e))})})},em=function(){var o,n=0;for(hd(n);bs.some(function(e){return e.activeTargets.length>0});)n=Rm(),hd(n);return bs.some(function(e){return e.skippedTargets.length>0})&&(typeof ErrorEvent=="function"?o=new ErrorEvent("error",{message:Ef}):((o=document.createEvent("Event")).initEvent("error",!1,!1),o.message=Ef),window.dispatchEvent(o)),n>0},Pf=[],nm=function(o){if(!ap){var n=0,e=document.createTextNode("");new MutationObserver(function(){return Pf.splice(0).forEach(function(r){return r()})}).observe(e,{characterData:!0}),ap=function(){e.textContent=""+(n?n--:n++)}}Pf.push(o),ap()},qp=0,hp={attributes:!0,characterData:!0,childList:!0,subtree:!0},gl=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],xa=function(o){return o===void 0&&(o=0),Date.now()+o},cp=!1,Zp=new(function(){function o(){var n=this;this.stopped=!0,this.listener=function(){return n.schedule()}}return o.prototype.run=function(n){var e=this;if(n===void 0&&(n=250),!cp){cp=!0;var r,s=xa(n);r=function(){var l=!1;try{l=em()}finally{if(cp=!1,n=s-xa(),!qp)return;l?e.run(1e3):n>0?e.run(n):e.start()}},nm(function(){requestAnimationFrame(r)})}},o.prototype.schedule=function(){this.stop(),this.run()},o.prototype.observe=function(){var n=this,e=function(){return n.observer&&n.observer.observe(document.body,hp)};document.body?e():Nu.addEventListener("DOMContentLoaded",e)},o.prototype.start=function(){var n=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),gl.forEach(function(e){return Nu.addEventListener(e,n.listener,!0)}))},o.prototype.stop=function(){var n=this;this.stopped||(this.observer&&this.observer.disconnect(),gl.forEach(function(e){return Nu.removeEventListener(e,n.listener,!0)}),this.stopped=!0)},o}()),Cf=function(o){!qp&&o>0&&Zp.start(),!(qp+=o)&&Zp.stop()},rm=function(){function o(n,e){this.target=n,this.observedBox=e||Kr.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return o.prototype.isActive=function(){var n,e=ya(this.target,this.observedBox,!0);return n=this.target,up(n)||function(r){switch(r.tagName){case"INPUT":if(r.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(n)||getComputedStyle(n).display!=="inline"||(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},o}(),Rf=function(o,n){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=o,this.callback=n},dp=new WeakMap,Jp=function(o,n){for(var e=0;e<o.length;e+=1)if(o[e].target===n)return e;return-1},pp=function(){function o(){}return o.connect=function(n,e){var r=new Rf(n,e);dp.set(n,r)},o.observe=function(n,e,r){var s=dp.get(n),l=s.observationTargets.length===0;Jp(s.observationTargets,e)<0&&(l&&bs.push(s),s.observationTargets.push(new rm(e,r&&r.box)),Cf(1),Zp.schedule())},o.unobserve=function(n,e){var r=dp.get(n),s=Jp(r.observationTargets,e),l=r.observationTargets.length===1;s>=0&&(l&&bs.splice(bs.indexOf(r),1),r.observationTargets.splice(s,1),Cf(-1))},o.disconnect=function(n){var e=this,r=dp.get(n);r.observationTargets.slice().forEach(function(s){return e.unobserve(n,s.target)}),r.activeTargets.splice(0,r.activeTargets.length)},o}(),fp=function(){function o(n){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof n!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");pp.connect(this,n)}return o.prototype.observe=function(n,e){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Mf(n))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");pp.observe(this,n,e)},o.prototype.unobserve=function(n){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Mf(n))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");pp.unobserve(this,n)},o.prototype.disconnect=function(){pp.disconnect(this)},o.toString=function(){return"function ResizeObserver () { [polyfill code] }"},o}(),If=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})},im=function(o,n){var e,r,s,l,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function m(x){return function(b){return function(w){if(e)throw new TypeError("Generator is already executing.");for(;h;)try{if(e=1,r&&(s=2&w[0]?r.return:w[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,w[1])).done)return s;switch(r=0,s&&(w=[2&w[0],s.value]),w[0]){case 0:case 1:s=w;break;case 4:return h.label++,{value:w[1],done:!1};case 5:h.label++,r=w[1],w=[0];continue;case 7:w=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!((s=s.length>0&&s[s.length-1])||w[0]!==6&&w[0]!==2)){h=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){h.label=w[1];break}if(w[0]===6&&h.label<s[1]){h.label=s[1],s=w;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(w);break}s[2]&&h.ops.pop(),h.trys.pop();continue}w=n.call(o,h)}catch(R){w=[6,R],r=0}finally{e=s=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([x,b])}}},Lf=function(){function o(n,e,r,s){this.state="idle",this.index=-1,this.slideIndex=-1,this.fn=r,this.index=n,this.slideIndex=e,this.eventHub=s}return o.prototype.apply=function(){return If(this,void 0,void 0,function(){var n;return im(this,function(e){switch(e.label){case 0:this.eventHub.emit("task-start",this),e.label=1;case 1:return e.trys.push([1,3,,4]),this.state="start",[4,this.fn()];case 2:return e.sent(),this.state="end",this.eventHub.emit("task-end",this),[3,4];case 3:return n=e.sent(),this.eventHub.emit("task-error",{task:this,error:n}),[3,4];case 4:return[2]}})})},o}(),mp=function(){function o(){var n=this;this.eventHub=new Z.a,this.tasks=[],this.index=0,this.eventHub.on("task-end",function(e){var r,s=n.tasks.findIndex(function(h){return h.index===e.index}),l=s+1;l>=0&&((r=n.tasks[l])===null||r===void 0||r.apply()),s>=0&&(n.tasks.splice(s,1),n.replaceIdleTask())}),this.eventHub.on("task-error",function(e){var r=e.task,s=n.tasks.findIndex(function(l){return l.index===r.index});s>=0&&(n.tasks.splice(s,1),n.replaceIdleTask())})}return o.prototype.replaceIdleTask=function(){for(var n,e=this,r=new Set,s=0,l=this.tasks.length;s<l;s++)this.tasks[s].state==="idle"&&((n=this.tasks[s+1])===null||n===void 0?void 0:n.state)==="idle"&&r.add(s);Array.from(r).forEach(function(h){e.tasks.splice(h,1)})},o.prototype.addTask=function(n,e){var r=new Lf(this.index++,e,n,this.eventHub);this.tasks.push(r),this.tasks.sort(function(s,l){return s.index-l.index}),this.replaceIdleTask(),this.tasks.length===1&&r.apply()},o.prototype.hasStartTask=function(){return this.tasks.some(function(n){return n.state==="start"})},o}(),om=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})},Of=function(o,n){var e,r,s,l,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function m(x){return function(b){return function(w){if(e)throw new TypeError("Generator is already executing.");for(;h;)try{if(e=1,r&&(s=2&w[0]?r.return:w[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,w[1])).done)return s;switch(r=0,s&&(w=[2&w[0],s.value]),w[0]){case 0:case 1:s=w;break;case 4:return h.label++,{value:w[1],done:!1};case 5:h.label++,r=w[1],w=[0];continue;case 7:w=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!((s=s.length>0&&s[s.length-1])||w[0]!==6&&w[0]!==2)){h=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){h.label=w[1];break}if(w[0]===6&&h.label<s[1]){h.label=s[1],s=w;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(w);break}s[2]&&h.ops.pop(),h.trys.pop();continue}w=n.call(o,h)}catch(R){w=[6,R],r=0}finally{e=s=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([x,b])}}};function Df(o,n){return om(this,void 0,void 0,function(){var e;return Of(this,function(r){switch(r.label){case 0:e=Date.now(),r.label=1;case 1:return!o()&&Date.now()-e<n?[4,(s=50,new Promise(function(l){return setTimeout(l,s)}))]:[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}var s})})}function hh(o,n){var e=o.__state.conversionName.toString(),r=Math.round(o.r),s=Math.round(o.g),l=Math.round(o.b),h=o.a,m=Math.round(o.h),x=o.s.toFixed(1),b=o.v.toFixed(1);if(n||e==="THREE_CHAR_HEX"||e==="SIX_CHAR_HEX"){for(var w=o.hex.toString(16);w.length<6;)w="0"+w;return"#"+w}return e==="CSS_RGB"?"rgb("+r+","+s+","+l+")":e==="CSS_RGBA"?"rgba("+r+","+s+","+l+","+h+")":e==="HEX"?"0x"+o.hex.toString(16):e==="RGB_ARRAY"?"["+r+","+s+","+l+"]":e==="RGBA_ARRAY"?"["+r+","+s+","+l+","+h+"]":e==="RGB_OBJ"?"{r:"+r+",g:"+s+",b:"+l+"}":e==="RGBA_OBJ"?"{r:"+r+",g:"+s+",b:"+l+",a:"+h+"}":e==="HSV_OBJ"?"{h:"+m+",s:"+x+",v:"+b+"}":e==="HSVA_OBJ"?"{h:"+m+",s:"+x+",v:"+b+",a:"+h+"}":"unknown format"}var $p=Array.prototype.forEach,vl=Array.prototype.slice,Re={BREAK:{},extend:function(o){return this.each(vl.call(arguments,1),function(n){(this.isObject(n)?Object.keys(n):[]).forEach(function(e){this.isUndefined(n[e])||(o[e]=n[e])}.bind(this))},this),o},defaults:function(o){return this.each(vl.call(arguments,1),function(n){(this.isObject(n)?Object.keys(n):[]).forEach(function(e){this.isUndefined(o[e])&&(o[e]=n[e])}.bind(this))},this),o},compose:function(){var o=vl.call(arguments);return function(){for(var n=vl.call(arguments),e=o.length-1;e>=0;e--)n=[o[e].apply(this,n)];return n[0]}},each:function(o,n,e){if(o){if($p&&o.forEach&&o.forEach===$p)o.forEach(n,e);else if(o.length===o.length+0){var r,s=void 0;for(s=0,r=o.length;s<r;s++)if(s in o&&n.call(e,o[s],s)===this.BREAK)return}else for(var l in o)if(n.call(e,o[l],l)===this.BREAK)return}},defer:function(o){setTimeout(o,0)},debounce:function(o,n,e){var r=void 0;return function(){var s=this,l=arguments;function h(){r=null,e||o.apply(s,l)}var m=e||!r;clearTimeout(r),r=setTimeout(h,n),m&&o.apply(s,l)}},toArray:function(o){return o.toArray?o.toArray():vl.call(o)},isUndefined:function(o){return o===void 0},isNull:function(o){return o===null},isNaN:function(o){function n(e){return o.apply(this,arguments)}return n.toString=function(){return o.toString()},n}(function(o){return isNaN(o)}),isArray:Array.isArray||function(o){return o.constructor===Array},isObject:function(o){return o===Object(o)},isNumber:function(o){return o===o+0},isString:function(o){return o===o+""},isBoolean:function(o){return o===!1||o===!0},isFunction:function(o){return o instanceof Function}},Kp=[{litmus:Re.isString,conversions:{THREE_CHAR_HEX:{read:function(o){var n=o.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return n!==null&&{space:"HEX",hex:parseInt("0x"+n[1].toString()+n[1].toString()+n[2].toString()+n[2].toString()+n[3].toString()+n[3].toString(),0)}},write:hh},SIX_CHAR_HEX:{read:function(o){var n=o.match(/^#([A-F0-9]{6})$/i);return n!==null&&{space:"HEX",hex:parseInt("0x"+n[1].toString(),0)}},write:hh},CSS_RGB:{read:function(o){var n=o.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return n!==null&&{space:"RGB",r:parseFloat(n[1]),g:parseFloat(n[2]),b:parseFloat(n[3])}},write:hh},CSS_RGBA:{read:function(o){var n=o.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return n!==null&&{space:"RGB",r:parseFloat(n[1]),g:parseFloat(n[2]),b:parseFloat(n[3]),a:parseFloat(n[4])}},write:hh}}},{litmus:Re.isNumber,conversions:{HEX:{read:function(o){return{space:"HEX",hex:o,conversionName:"HEX"}},write:function(o){return o.hex}}}},{litmus:Re.isArray,conversions:{RGB_ARRAY:{read:function(o){return o.length===3&&{space:"RGB",r:o[0],g:o[1],b:o[2]}},write:function(o){return[o.r,o.g,o.b]}},RGBA_ARRAY:{read:function(o){return o.length===4&&{space:"RGB",r:o[0],g:o[1],b:o[2],a:o[3]}},write:function(o){return[o.r,o.g,o.b,o.a]}}}},{litmus:Re.isObject,conversions:{RGBA_OBJ:{read:function(o){return!!(Re.isNumber(o.r)&&Re.isNumber(o.g)&&Re.isNumber(o.b)&&Re.isNumber(o.a))&&{space:"RGB",r:o.r,g:o.g,b:o.b,a:o.a}},write:function(o){return{r:o.r,g:o.g,b:o.b,a:o.a}}},RGB_OBJ:{read:function(o){return!!(Re.isNumber(o.r)&&Re.isNumber(o.g)&&Re.isNumber(o.b))&&{space:"RGB",r:o.r,g:o.g,b:o.b}},write:function(o){return{r:o.r,g:o.g,b:o.b}}},HSVA_OBJ:{read:function(o){return!!(Re.isNumber(o.h)&&Re.isNumber(o.s)&&Re.isNumber(o.v)&&Re.isNumber(o.a))&&{space:"HSV",h:o.h,s:o.s,v:o.v,a:o.a}},write:function(o){return{h:o.h,s:o.s,v:o.v,a:o.a}}},HSV_OBJ:{read:function(o){return!!(Re.isNumber(o.h)&&Re.isNumber(o.s)&&Re.isNumber(o.v))&&{space:"HSV",h:o.h,s:o.s,v:o.v}},write:function(o){return{h:o.h,s:o.s,v:o.v}}}}}],lc=void 0,cd=void 0,Qp=function(){cd=!1;var o=arguments.length>1?Re.toArray(arguments):arguments[0];return Re.each(Kp,function(n){if(n.litmus(o))return Re.each(n.conversions,function(e,r){if(lc=e.read(o),cd===!1&&lc!==!1)return cd=lc,lc.conversionName=r,lc.conversion=e,Re.BREAK}),Re.BREAK}),cd},sm=void 0,tf={hsv_to_rgb:function(o,n,e){var r=Math.floor(o/60)%6,s=o/60-Math.floor(o/60),l=e*(1-n),h=e*(1-s*n),m=e*(1-(1-s)*n),x=[[e,m,l],[h,e,l],[l,e,m],[l,h,e],[m,l,e],[e,l,h]][r];return{r:255*x[0],g:255*x[1],b:255*x[2]}},rgb_to_hsv:function(o,n,e){var r=Math.min(o,n,e),s=Math.max(o,n,e),l=s-r,h=void 0;return s===0?{h:NaN,s:0,v:0}:(h=o===s?(n-e)/l:n===s?2+(e-o)/l:4+(o-n)/l,(h/=6)<0&&(h+=1),{h:360*h,s:l/s,v:s/255})},rgb_to_hex:function(o,n,e){var r=this.hex_with_component(0,2,o);return r=this.hex_with_component(r,1,n),r=this.hex_with_component(r,0,e)},component_from_hex:function(o,n){return o>>8*n&255},hex_with_component:function(o,n,e){return e<<(sm=8*n)|o&~(255<<sm)}},am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},ba=function(o,n){if(!(o instanceof n))throw new TypeError("Cannot call a class as a function")},wa=function(){function o(n,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}return function(n,e,r){return e&&o(n.prototype,e),r&&o(n,r),n}}(),_l=function o(n,e,r){n===null&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,e);if(s===void 0){var l=Object.getPrototypeOf(n);return l===null?void 0:o(l,e,r)}if("value"in s)return s.value;var h=s.get;return h!==void 0?h.call(r):void 0},Bu=function(o,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(o,n):o.__proto__=n)},ch=function(o,n){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||typeof n!="object"&&typeof n!="function"?o:n},Io=function(){function o(){if(ba(this,o),this.__state=Qp.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return wa(o,[{key:"toString",value:function(){return hh(this)}},{key:"toHexString",value:function(){return hh(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),o}();function dd(o,n,e){Object.defineProperty(o,n,{get:function(){return this.__state.space==="RGB"||Io.recalculateRGB(this,n,e),this.__state[n]},set:function(r){this.__state.space!=="RGB"&&(Io.recalculateRGB(this,n,e),this.__state.space="RGB"),this.__state[n]=r}})}function gp(o,n){Object.defineProperty(o,n,{get:function(){return this.__state.space==="HSV"||Io.recalculateHSV(this),this.__state[n]},set:function(e){this.__state.space!=="HSV"&&(Io.recalculateHSV(this),this.__state.space="HSV"),this.__state[n]=e}})}Io.recalculateRGB=function(o,n,e){if(o.__state.space==="HEX")o.__state[n]=tf.component_from_hex(o.__state.hex,e);else{if(o.__state.space!=="HSV")throw new Error("Corrupted color state");Re.extend(o.__state,tf.hsv_to_rgb(o.__state.h,o.__state.s,o.__state.v))}},Io.recalculateHSV=function(o){var n=tf.rgb_to_hsv(o.r,o.g,o.b);Re.extend(o.__state,{s:n.s,v:n.v}),Re.isNaN(n.h)?Re.isUndefined(o.__state.h)&&(o.__state.h=0):o.__state.h=n.h},Io.COMPONENTS=["r","g","b","h","s","v","hex","a"],dd(Io.prototype,"r",2),dd(Io.prototype,"g",1),dd(Io.prototype,"b",0),gp(Io.prototype,"h"),gp(Io.prototype,"s"),gp(Io.prototype,"v"),Object.defineProperty(Io.prototype,"a",{get:function(){return this.__state.a},set:function(o){this.__state.a=o}}),Object.defineProperty(Io.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=tf.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(o){this.__state.space="HEX",this.__state.hex=o}});var dh=function(){function o(n,e){ba(this,o),this.initialValue=n[e],this.domElement=document.createElement("div"),this.object=n,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0}return wa(o,[{key:"onChange",value:function(n){return this.__onChange=n,this}},{key:"onFinishChange",value:function(n){return this.__onFinishChange=n,this}},{key:"setValue",value:function(n){return this.object[this.property]=n,this.__onChange&&this.__onChange.call(this,n),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),o}(),Nf={};Re.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(o,n){Re.each(o,function(e){Nf[e]=n})});var um=/(\d+(\.\d+)?)px/;function Ja(o){if(o==="0"||Re.isUndefined(o))return 0;var n=o.match(um);return Re.isNull(n)?0:parseFloat(n[1])}var Wt={makeSelectable:function(o,n){o!==void 0&&o.style!==void 0&&(o.onselectstart=n?function(){return!1}:function(){},o.style.MozUserSelect=n?"auto":"none",o.style.KhtmlUserSelect=n?"auto":"none",o.unselectable=n?"on":"off")},makeFullscreen:function(o,n,e){var r=e,s=n;Re.isUndefined(s)&&(s=!0),Re.isUndefined(r)&&(r=!0),o.style.position="absolute",s&&(o.style.left=0,o.style.right=0),r&&(o.style.top=0,o.style.bottom=0)},fakeEvent:function(o,n,e,r){var s=e||{},l=Nf[n];if(!l)throw new Error("Event type "+n+" not supported.");var h=document.createEvent(l);switch(l){case"MouseEvents":var m=s.x||s.clientX||0,x=s.y||s.clientY||0;h.initMouseEvent(n,s.bubbles||!1,s.cancelable||!0,window,s.clickCount||1,0,0,m,x,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var b=h.initKeyboardEvent||h.initKeyEvent;Re.defaults(s,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),b(n,s.bubbles||!1,s.cancelable,window,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.keyCode,s.charCode);break;default:h.initEvent(n,s.bubbles||!1,s.cancelable||!0)}Re.defaults(h,r),o.dispatchEvent(h)},bind:function(o,n,e,r){var s=r||!1;return o.addEventListener?o.addEventListener(n,e,s):o.attachEvent&&o.attachEvent("on"+n,e),Wt},unbind:function(o,n,e,r){var s=r||!1;return o.removeEventListener?o.removeEventListener(n,e,s):o.detachEvent&&o.detachEvent("on"+n,e),Wt},addClass:function(o,n){if(o.className===void 0)o.className=n;else if(o.className!==n){var e=o.className.split(/ +/);e.indexOf(n)===-1&&(e.push(n),o.className=e.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return Wt},removeClass:function(o,n){if(n)if(o.className===n)o.removeAttribute("class");else{var e=o.className.split(/ +/),r=e.indexOf(n);r!==-1&&(e.splice(r,1),o.className=e.join(" "))}else o.className=void 0;return Wt},hasClass:function(o,n){return new RegExp("(?:^|\\s+)"+n+"(?:\\s+|$)").test(o.className)||!1},getWidth:function(o){var n=getComputedStyle(o);return Ja(n["border-left-width"])+Ja(n["border-right-width"])+Ja(n["padding-left"])+Ja(n["padding-right"])+Ja(n.width)},getHeight:function(o){var n=getComputedStyle(o);return Ja(n["border-top-width"])+Ja(n["border-bottom-width"])+Ja(n["padding-top"])+Ja(n["padding-bottom"])+Ja(n.height)},getOffset:function(o){var n=o,e={left:0,top:0};if(n.offsetParent)do e.left+=n.offsetLeft,e.top+=n.offsetTop,n=n.offsetParent;while(n);return e},isActive:function(o){return o===document.activeElement&&(o.type||o.href)}},lm=function(o){function n(e,r){ba(this,n);var s=ch(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),l=s;return s.__prev=s.getValue(),s.__checkbox=document.createElement("input"),s.__checkbox.setAttribute("type","checkbox"),Wt.bind(s.__checkbox,"change",function(){l.setValue(!l.__prev)},!1),s.domElement.appendChild(s.__checkbox),s.updateDisplay(),s}return Bu(n,o),wa(n,[{key:"setValue",value:function(e){var r=_l(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),_l(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"updateDisplay",this).call(this)}}]),n}(dh),hm=function(o){function n(e,r,s){ba(this,n);var l=ch(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),h=s,m=l;if(l.__select=document.createElement("select"),Re.isArray(h)){var x={};Re.each(h,function(b){x[b]=b}),h=x}return Re.each(h,function(b,w){var R=document.createElement("option");R.innerHTML=w,R.setAttribute("value",b),m.__select.appendChild(R)}),l.updateDisplay(),Wt.bind(l.__select,"change",function(){var b=this.options[this.selectedIndex].value;m.setValue(b)}),l.domElement.appendChild(l.__select),l}return Bu(n,o),wa(n,[{key:"setValue",value:function(e){var r=_l(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return Wt.isActive(this.__select)?this:(this.__select.value=this.getValue(),_l(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"updateDisplay",this).call(this))}}]),n}(dh),cm=function(o){function n(e,r){ba(this,n);var s=ch(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),l=s;function h(){l.setValue(l.__input.value)}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),Wt.bind(s.__input,"keyup",h),Wt.bind(s.__input,"change",h),Wt.bind(s.__input,"blur",function(){l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}),Wt.bind(s.__input,"keydown",function(m){m.keyCode===13&&this.blur()}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return Bu(n,o),wa(n,[{key:"updateDisplay",value:function(){return Wt.isActive(this.__input)||(this.__input.value=this.getValue()),_l(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"updateDisplay",this).call(this)}}]),n}(dh);function ph(o){var n=o.toString();return n.indexOf(".")>-1?n.length-n.indexOf(".")-1:0}var Ff=function(o){function n(e,r,s){ba(this,n);var l=ch(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),h=s||{};return l.__min=h.min,l.__max=h.max,l.__step=h.step,Re.isUndefined(l.__step)?l.initialValue===0?l.__impliedStep=1:l.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(l.initialValue))/Math.LN10))/10:l.__impliedStep=l.__step,l.__precision=ph(l.__impliedStep),l}return Bu(n,o),wa(n,[{key:"setValue",value:function(e){var r=e;return this.__min!==void 0&&r<this.__min?r=this.__min:this.__max!==void 0&&r>this.__max&&(r=this.__max),this.__step!==void 0&&r%this.__step!=0&&(r=Math.round(r/this.__step)*this.__step),_l(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=ph(e),this}}]),n}(dh),ef=function(o){function n(e,r,s){ba(this,n);var l=ch(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r,s));l.__truncationSuspended=!1;var h=l,m=void 0;function x(){h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function b(R){var U=m-R.clientY;h.setValue(h.getValue()+U*h.__impliedStep),m=R.clientY}function w(){Wt.unbind(window,"mousemove",b),Wt.unbind(window,"mouseup",w),x()}return l.__input=document.createElement("input"),l.__input.setAttribute("type","text"),Wt.bind(l.__input,"change",function(){var R=parseFloat(h.__input.value);Re.isNaN(R)||h.setValue(R)}),Wt.bind(l.__input,"blur",function(){x()}),Wt.bind(l.__input,"mousedown",function(R){Wt.bind(window,"mousemove",b),Wt.bind(window,"mouseup",w),m=R.clientY}),Wt.bind(l.__input,"keydown",function(R){R.keyCode===13&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1,x())}),l.updateDisplay(),l.domElement.appendChild(l.__input),l}return Bu(n,o),wa(n,[{key:"updateDisplay",value:function(){var e,r,s;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),r=this.__precision,s=Math.pow(10,r),Math.round(e*s)/s),_l(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"updateDisplay",this).call(this)}}]),n}(Ff);function fh(o,n,e,r,s){return r+(o-n)/(e-n)*(s-r)}var Bf=function(o){function n(e,r,s,l,h){ba(this,n);var m=ch(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r,{min:s,max:l,step:h})),x=m;function b(B){B.preventDefault();var j=x.__background.getBoundingClientRect();return x.setValue(fh(B.clientX,j.left,j.right,x.__min,x.__max)),!1}function w(){Wt.unbind(window,"mousemove",b),Wt.unbind(window,"mouseup",w),x.__onFinishChange&&x.__onFinishChange.call(x,x.getValue())}function R(B){var j=B.touches[0].clientX,K=x.__background.getBoundingClientRect();x.setValue(fh(j,K.left,K.right,x.__min,x.__max))}function U(){Wt.unbind(window,"touchmove",R),Wt.unbind(window,"touchend",U),x.__onFinishChange&&x.__onFinishChange.call(x,x.getValue())}return m.__background=document.createElement("div"),m.__foreground=document.createElement("div"),Wt.bind(m.__background,"mousedown",function(B){document.activeElement.blur(),Wt.bind(window,"mousemove",b),Wt.bind(window,"mouseup",w),b(B)}),Wt.bind(m.__background,"touchstart",function(B){B.touches.length===1&&(Wt.bind(window,"touchmove",R),Wt.bind(window,"touchend",U),R(B))}),Wt.addClass(m.__background,"slider"),Wt.addClass(m.__foreground,"slider-fg"),m.updateDisplay(),m.__background.appendChild(m.__foreground),m.domElement.appendChild(m.__background),m}return Bu(n,o),wa(n,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",_l(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"updateDisplay",this).call(this)}}]),n}(Ff),nf=function(o){function n(e,r,s){ba(this,n);var l=ch(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r)),h=l;return l.__button=document.createElement("div"),l.__button.innerHTML=s===void 0?"Fire":s,Wt.bind(l.__button,"click",function(m){return m.preventDefault(),h.fire(),!1}),Wt.addClass(l.__button,"button"),l.domElement.appendChild(l.__button),l}return Bu(n,o),wa(n,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),n}(dh),yl=function(o){function n(e,r){ba(this,n);var s=ch(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,r));s.__color=new Io(s.getValue()),s.__temp=new Io(0);var l=s;s.domElement=document.createElement("div"),Wt.makeSelectable(s.domElement,!1),s.__selector=document.createElement("div"),s.__selector.className="selector",s.__saturation_field=document.createElement("div"),s.__saturation_field.className="saturation-field",s.__field_knob=document.createElement("div"),s.__field_knob.className="field-knob",s.__field_knob_border="2px solid ",s.__hue_knob=document.createElement("div"),s.__hue_knob.className="hue-knob",s.__hue_field=document.createElement("div"),s.__hue_field.className="hue-field",s.__input=document.createElement("input"),s.__input.type="text",s.__input_textShadow="0 1px 1px ",Wt.bind(s.__input,"keydown",function(ut){ut.keyCode===13&&U.call(this)}),Wt.bind(s.__input,"blur",U),Wt.bind(s.__selector,"mousedown",function(){Wt.addClass(this,"drag").bind(window,"mouseup",function(){Wt.removeClass(l.__selector,"drag")})}),Wt.bind(s.__selector,"touchstart",function(){Wt.addClass(this,"drag").bind(window,"touchend",function(){Wt.removeClass(l.__selector,"drag")})});var h,m=document.createElement("div");function x(ut){j(ut),Wt.bind(window,"mousemove",j),Wt.bind(window,"touchmove",j),Wt.bind(window,"mouseup",w),Wt.bind(window,"touchend",w)}function b(ut){K(ut),Wt.bind(window,"mousemove",K),Wt.bind(window,"touchmove",K),Wt.bind(window,"mouseup",R),Wt.bind(window,"touchend",R)}function w(){Wt.unbind(window,"mousemove",j),Wt.unbind(window,"touchmove",j),Wt.unbind(window,"mouseup",w),Wt.unbind(window,"touchend",w),B()}function R(){Wt.unbind(window,"mousemove",K),Wt.unbind(window,"touchmove",K),Wt.unbind(window,"mouseup",R),Wt.unbind(window,"touchend",R),B()}function U(){var ut=Qp(this.value);ut!==!1?(l.__color.__state=ut,l.setValue(l.__color.toOriginal())):this.value=l.__color.toString()}function B(){l.__onFinishChange&&l.__onFinishChange.call(l,l.__color.toOriginal())}function j(ut){ut.type.indexOf("touch")===-1&&ut.preventDefault();var gt=l.__saturation_field.getBoundingClientRect(),Rt=ut.touches&&ut.touches[0]||ut,Le=Rt.clientX,en=Rt.clientY,At=(Le-gt.left)/(gt.right-gt.left),oe=1-(en-gt.top)/(gt.bottom-gt.top);return oe>1?oe=1:oe<0&&(oe=0),At>1?At=1:At<0&&(At=0),l.__color.v=oe,l.__color.s=At,l.setValue(l.__color.toOriginal()),!1}function K(ut){ut.type.indexOf("touch")===-1&&ut.preventDefault();var gt=l.__hue_field.getBoundingClientRect(),Rt=1-((ut.touches&&ut.touches[0]||ut).clientY-gt.top)/(gt.bottom-gt.top);return Rt>1?Rt=1:Rt<0&&(Rt=0),l.__color.h=360*Rt,l.setValue(l.__color.toOriginal()),!1}return Re.extend(s.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Re.extend(s.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:s.__field_knob_border+(s.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Re.extend(s.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Re.extend(s.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Re.extend(m.style,{width:"100%",height:"100%",background:"none"}),pm(m,"top","rgba(0,0,0,0)","#000"),Re.extend(s.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(h=s.__hue_field).style.background="",h.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",h.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",h.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",h.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",h.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Re.extend(s.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:s.__input_textShadow+"rgba(0,0,0,0.7)"}),Wt.bind(s.__saturation_field,"mousedown",x),Wt.bind(s.__saturation_field,"touchstart",x),Wt.bind(s.__field_knob,"mousedown",x),Wt.bind(s.__field_knob,"touchstart",x),Wt.bind(s.__hue_field,"mousedown",b),Wt.bind(s.__hue_field,"touchstart",b),s.__saturation_field.appendChild(m),s.__selector.appendChild(s.__field_knob),s.__selector.appendChild(s.__saturation_field),s.__selector.appendChild(s.__hue_field),s.__hue_field.appendChild(s.__hue_knob),s.domElement.appendChild(s.__input),s.domElement.appendChild(s.__selector),s.updateDisplay(),s}return Bu(n,o),wa(n,[{key:"updateDisplay",value:function(){var e=Qp(this.getValue());if(e!==!1){var r=!1;Re.each(Io.COMPONENTS,function(h){if(!Re.isUndefined(e[h])&&!Re.isUndefined(this.__color.__state[h])&&e[h]!==this.__color.__state[h])return r=!0,{}},this),r&&Re.extend(this.__color.__state,e)}Re.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,l=255-s;Re.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,pm(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Re.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+l+","+l+","+l+",.7)"})}}]),n}(dh),dm=["-moz-","-o-","-webkit-","-ms-",""];function pm(o,n,e,r){o.style.background="",Re.each(dm,function(s){o.style.cssText+="background: "+s+"linear-gradient("+n+", "+e+" 0%, "+r+" 100%); "})}var hc=function(o,n){var e=n||document,r=document.createElement("style");r.type="text/css",r.innerHTML=o;var s=e.getElementsByTagName("head")[0];try{s.appendChild(r)}catch{}},Im=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,fm=function(o,n){var e=o[n];return Re.isArray(arguments[2])||Re.isObject(arguments[2])?new hm(o,n,arguments[2]):Re.isNumber(e)?Re.isNumber(arguments[2])&&Re.isNumber(arguments[3])?Re.isNumber(arguments[4])?new Bf(o,n,arguments[2],arguments[3],arguments[4]):new Bf(o,n,arguments[2],arguments[3]):Re.isNumber(arguments[4])?new ef(o,n,{min:arguments[2],max:arguments[3],step:arguments[4]}):new ef(o,n,{min:arguments[2],max:arguments[3]}):Re.isString(e)?new cm(o,n):Re.isFunction(e)?new nf(o,n,""):Re.isBoolean(e)?new lm(o,n):null},mm=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(o){setTimeout(o,1e3/60)},Lm=function(){function o(){ba(this,o),this.backgroundElement=document.createElement("div"),Re.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),Wt.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Re.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;Wt.bind(this.backgroundElement,"click",function(){n.hide()})}return wa(o,[{key:"show",value:function(){var n=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Re.defer(function(){n.backgroundElement.style.opacity=1,n.domElement.style.opacity=1,n.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var n=this,e=function r(){n.domElement.style.display="none",n.backgroundElement.style.display="none",Wt.unbind(n.domElement,"webkitTransitionEnd",r),Wt.unbind(n.domElement,"transitionend",r),Wt.unbind(n.domElement,"oTransitionEnd",r)};Wt.bind(this.domElement,"webkitTransitionEnd",e),Wt.bind(this.domElement,"transitionend",e),Wt.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-Wt.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-Wt.getHeight(this.domElement)/2+"px"}}]),o}();hc(function(o){if(o&&typeof window!="undefined"){var n=document.createElement("style");return n.setAttribute("type","text/css"),n.innerHTML=o,document.head.appendChild(n),o}}(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`));var vp=function(){try{return!!window.localStorage}catch{return!1}}(),rf=void 0,gm=!0,pd=void 0,Uf=!1,vm=[],fi=function o(n){var e=this,r=n||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Wt.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=Re.defaults(r,{closeOnTop:!1,autoPlace:!0,width:o.DEFAULT_WIDTH}),r=Re.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),Re.isUndefined(r.load)?r.load={preset:"Default"}:r.preset&&(r.load.preset=r.preset),Re.isUndefined(r.parent)&&r.hideable&&vm.push(this),r.resizable=Re.isUndefined(r.parent)&&r.resizable,r.autoPlace&&Re.isUndefined(r.scrollable)&&(r.scrollable=!0);var s,l=vp&&localStorage.getItem(cc(this,"isLocal"))==="true",h=void 0,m=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return e.parent?e.getRoot().preset:r.load.preset},set:function(w){e.parent?e.getRoot().preset=w:r.load.preset=w,function(R){for(var U=0;U<R.__preset_select.length;U++)R.__preset_select[U].value===R.preset&&(R.__preset_select.selectedIndex=U)}(this),e.revert()}},width:{get:function(){return r.width},set:function(w){r.width=w,jf(e,w)}},name:{get:function(){return r.name},set:function(w){r.name=w,m&&(m.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(w){r.closed=w,r.closed?Wt.addClass(e.__ul,o.CLASS_CLOSED):Wt.removeClass(e.__ul,o.CLASS_CLOSED),this.onResize(),e.__closeButton&&(e.__closeButton.innerHTML=w?o.TEXT_OPEN:o.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return l},set:function(w){vp&&(l=w,w?Wt.bind(window,"unload",h):Wt.unbind(window,"unload",h),localStorage.setItem(cc(e,"isLocal"),w))}}}),Re.isUndefined(r.parent)){if(this.closed=r.closed||!1,Wt.addClass(this.domElement,o.CLASS_MAIN),Wt.makeSelectable(this.domElement,!1),vp&&l){e.useLocalStorage=!0;var x=localStorage.getItem(cc(this,"gui"));x&&(r.load=JSON.parse(x))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=o.TEXT_CLOSED,Wt.addClass(this.__closeButton,o.CLASS_CLOSE_BUTTON),r.closeOnTop?(Wt.addClass(this.__closeButton,o.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(Wt.addClass(this.__closeButton,o.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),Wt.bind(this.__closeButton,"click",function(){e.closed=!e.closed})}else{r.closed===void 0&&(r.closed=!0);var b=document.createTextNode(r.name);Wt.addClass(b,"controller-name"),m=Or(e,b),Wt.addClass(this.__ul,o.CLASS_CLOSED),Wt.addClass(m,"title"),Wt.bind(m,"click",function(w){return w.preventDefault(),e.closed=!e.closed,!1}),r.closed||(this.closed=!1)}r.autoPlace&&(Re.isUndefined(r.parent)&&(gm&&(pd=document.createElement("div"),Wt.addClass(pd,"dg"),Wt.addClass(pd,o.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(pd),gm=!1),pd.appendChild(this.domElement),Wt.addClass(this.domElement,o.CLASS_AUTO_PLACE)),this.parent||jf(e,r.width)),this.__resizeHandler=function(){e.onResizeDebounced()},Wt.bind(window,"resize",this.__resizeHandler),Wt.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Wt.bind(this.__ul,"transitionend",this.__resizeHandler),Wt.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&zf(this),h=function(){vp&&localStorage.getItem(cc(e,"isLocal"))==="true"&&localStorage.setItem(cc(e,"gui"),JSON.stringify(e.getSaveObject()))},this.saveToLocalStorageIfPossible=h,r.parent||((s=e.getRoot()).width+=1,Re.defer(function(){s.width-=1}))};function Or(o,n,e){var r=document.createElement("li");return n&&r.appendChild(n),e?o.__ul.insertBefore(r,e):o.__ul.appendChild(r),o.onResize(),r}function kf(o){Wt.unbind(window,"resize",o.__resizeHandler),o.saveToLocalStorageIfPossible&&Wt.unbind(window,"unload",o.saveToLocalStorageIfPossible)}function Gf(o,n){var e=o.__preset_select[o.__preset_select.selectedIndex];e.innerHTML=n?e.value+"*":e.value}function Hf(o,n){var e=o.getRoot(),r=e.__rememberedObjects.indexOf(n.object);if(r!==-1){var s=e.__rememberedObjectIndecesToControllers[r];if(s===void 0&&(s={},e.__rememberedObjectIndecesToControllers[r]=s),s[n.property]=n,e.load&&e.load.remembered){var l=e.load.remembered,h=void 0;if(l[o.preset])h=l[o.preset];else{if(!l.Default)return;h=l.Default}if(h[r]&&h[r][n.property]!==void 0){var m=h[r][n.property];n.initialValue=m,n.setValue(m)}}}}function mh(o,n,e,r){if(n[e]===void 0)throw new Error('Object "'+n+'" has no property "'+e+'"');var s=void 0;if(r.color)s=new yl(n,e);else{var l=[n,e].concat(r.factoryArgs);s=fm.apply(o,l)}r.before instanceof dh&&(r.before=r.before.__li),Hf(o,s),Wt.addClass(s.domElement,"c");var h=document.createElement("span");Wt.addClass(h,"property-name"),h.innerHTML=s.property;var m=document.createElement("div");m.appendChild(h),m.appendChild(s.domElement);var x=Or(o,m,r.before);return Wt.addClass(x,fi.CLASS_CONTROLLER_ROW),s instanceof yl?Wt.addClass(x,"color"):Wt.addClass(x,am(s.getValue())),function(b,w,R){if(R.__li=w,R.__gui=b,Re.extend(R,{options:function(j){if(arguments.length>1){var K=R.__li.nextElementSibling;return R.remove(),mh(b,R.object,R.property,{before:K,factoryArgs:[Re.toArray(arguments)]})}if(Re.isArray(j)||Re.isObject(j)){var ut=R.__li.nextElementSibling;return R.remove(),mh(b,R.object,R.property,{before:ut,factoryArgs:[j]})}},name:function(j){return R.__li.firstElementChild.firstElementChild.innerHTML=j,R},listen:function(){return R.__gui.listen(R),R},remove:function(){return R.__gui.remove(R),R}}),R instanceof Bf){var U=new ef(R.object,R.property,{min:R.__min,max:R.__max,step:R.__step});Re.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(j){var K=R[j],ut=U[j];R[j]=U[j]=function(){var gt=Array.prototype.slice.call(arguments);return ut.apply(U,gt),K.apply(R,gt)}}),Wt.addClass(w,"has-slider"),R.domElement.insertBefore(U.domElement,R.domElement.firstElementChild)}else if(R instanceof ef){var B=function(j){if(Re.isNumber(R.__min)&&Re.isNumber(R.__max)){var K=R.__li.firstElementChild.firstElementChild.innerHTML,ut=R.__gui.__listening.indexOf(R)>-1;R.remove();var gt=mh(b,R.object,R.property,{before:R.__li.nextElementSibling,factoryArgs:[R.__min,R.__max,R.__step]});return gt.name(K),ut&&gt.listen(),gt}return j};R.min=Re.compose(B,R.min),R.max=Re.compose(B,R.max)}else R instanceof lm?(Wt.bind(w,"click",function(){Wt.fakeEvent(R.__checkbox,"click")}),Wt.bind(R.__checkbox,"click",function(j){j.stopPropagation()})):R instanceof nf?(Wt.bind(w,"click",function(){Wt.fakeEvent(R.__button,"click")}),Wt.bind(w,"mouseover",function(){Wt.addClass(R.__button,"hover")}),Wt.bind(w,"mouseout",function(){Wt.removeClass(R.__button,"hover")})):R instanceof yl&&(Wt.addClass(w,"color"),R.updateDisplay=Re.compose(function(j){return w.style.borderLeftColor=R.__color.toString(),j},R.updateDisplay),R.updateDisplay());R.setValue=Re.compose(function(j){return b.getRoot().__preset_select&&R.isModified()&&Gf(b.getRoot(),!0),j},R.setValue)}(o,x,s),o.__controllers.push(s),s}function cc(o,n){return document.location.href+"."+n}function of(o,n,e){var r=document.createElement("option");r.innerHTML=n,r.value=n,o.__preset_select.appendChild(r),e&&(o.__preset_select.selectedIndex=o.__preset_select.length-1)}function _m(o,n){n.style.display=o.useLocalStorage?"block":"none"}function ym(o){var n=o.__save_row=document.createElement("li");Wt.addClass(o.domElement,"has-save"),o.__ul.insertBefore(n,o.__ul.firstChild),Wt.addClass(n,"save-row");var e=document.createElement("span");e.innerHTML="&nbsp;",Wt.addClass(e,"button gears");var r=document.createElement("span");r.innerHTML="Save",Wt.addClass(r,"button"),Wt.addClass(r,"save");var s=document.createElement("span");s.innerHTML="New",Wt.addClass(s,"button"),Wt.addClass(s,"save-as");var l=document.createElement("span");l.innerHTML="Revert",Wt.addClass(l,"button"),Wt.addClass(l,"revert");var h=o.__preset_select=document.createElement("select");if(o.load&&o.load.remembered?Re.each(o.load.remembered,function(w,R){of(o,R,R===o.preset)}):of(o,"Default",!1),Wt.bind(h,"change",function(){for(var w=0;w<o.__preset_select.length;w++)o.__preset_select[w].innerHTML=o.__preset_select[w].value;o.preset=this.value}),n.appendChild(h),n.appendChild(e),n.appendChild(r),n.appendChild(s),n.appendChild(l),vp){var m=document.getElementById("dg-local-explain"),x=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block",localStorage.getItem(cc(0,"isLocal"))==="true"&&x.setAttribute("checked","checked"),_m(o,m),Wt.bind(x,"change",function(){o.useLocalStorage=!o.useLocalStorage,_m(o,m)})}var b=document.getElementById("dg-new-constructor");Wt.bind(b,"keydown",function(w){!w.metaKey||w.which!==67&&w.keyCode!==67||rf.hide()}),Wt.bind(e,"click",function(){b.innerHTML=JSON.stringify(o.getSaveObject(),void 0,2),rf.show(),b.focus(),b.select()}),Wt.bind(r,"click",function(){o.save()}),Wt.bind(s,"click",function(){var w=prompt("Enter a new preset name.");w&&o.saveAs(w)}),Wt.bind(l,"click",function(){o.revert()})}function zf(o){var n=void 0;function e(l){return l.preventDefault(),o.width+=n-l.clientX,o.onResize(),n=l.clientX,!1}function r(){Wt.removeClass(o.__closeButton,fi.CLASS_DRAG),Wt.unbind(window,"mousemove",e),Wt.unbind(window,"mouseup",r)}function s(l){return l.preventDefault(),n=l.clientX,Wt.addClass(o.__closeButton,fi.CLASS_DRAG),Wt.bind(window,"mousemove",e),Wt.bind(window,"mouseup",r),!1}o.__resize_handle=document.createElement("div"),Re.extend(o.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),Wt.bind(o.__resize_handle,"mousedown",s),Wt.bind(o.__closeButton,"mousedown",s),o.domElement.insertBefore(o.__resize_handle,o.domElement.firstElementChild)}function jf(o,n){o.domElement.style.width=n+"px",o.__save_row&&o.autoPlace&&(o.__save_row.style.width=n+"px"),o.__closeButton&&(o.__closeButton.style.width=n+"px")}function sf(o,n){var e={};return Re.each(o.__rememberedObjects,function(r,s){var l={},h=o.__rememberedObjectIndecesToControllers[s];Re.each(h,function(m,x){l[x]=n?m.initialValue:m.getValue()}),e[s]=l}),e}fi.toggleHide=function(){Uf=!Uf,Re.each(vm,function(o){o.domElement.style.display=Uf?"none":""})},fi.CLASS_AUTO_PLACE="a",fi.CLASS_AUTO_PLACE_CONTAINER="ac",fi.CLASS_MAIN="main",fi.CLASS_CONTROLLER_ROW="cr",fi.CLASS_TOO_TALL="taller-than-window",fi.CLASS_CLOSED="closed",fi.CLASS_CLOSE_BUTTON="close-button",fi.CLASS_CLOSE_TOP="close-top",fi.CLASS_CLOSE_BOTTOM="close-bottom",fi.CLASS_DRAG="drag",fi.DEFAULT_WIDTH=245,fi.TEXT_CLOSED="Close Controls",fi.TEXT_OPEN="Open Controls",fi._keydownHandler=function(o){document.activeElement.type==="text"||o.which!==72&&o.keyCode!==72||fi.toggleHide()},Wt.bind(window,"keydown",fi._keydownHandler,!1),Re.extend(fi.prototype,{add:function(o,n){return mh(this,o,n,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(o,n){return mh(this,o,n,{color:!0})},remove:function(o){this.__ul.removeChild(o.__li),this.__controllers.splice(this.__controllers.indexOf(o),1);var n=this;Re.defer(function(){n.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&pd.removeChild(this.domElement);var o=this;Re.each(this.__folders,function(n){o.removeFolder(n)}),Wt.unbind(window,"keydown",fi._keydownHandler,!1),kf(this)},addFolder:function(o){if(this.__folders[o]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+o+'"');var n={name:o,parent:this};n.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[o]&&(n.closed=this.load.folders[o].closed,n.load=this.load.folders[o]);var e=new fi(n);this.__folders[o]=e;var r=Or(this,e.domElement);return Wt.addClass(r,"folder"),e},removeFolder:function(o){this.__ul.removeChild(o.domElement.parentElement),delete this.__folders[o.name],this.load&&this.load.folders&&this.load.folders[o.name]&&delete this.load.folders[o.name],kf(o);var n=this;Re.each(o.__folders,function(e){o.removeFolder(e)}),Re.defer(function(){n.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var o=this.getRoot();if(o.scrollable){var n=Wt.getOffset(o.__ul).top,e=0;Re.each(o.__ul.childNodes,function(r){o.autoPlace&&r===o.__save_row||(e+=Wt.getHeight(r))}),window.innerHeight-n-20<e?(Wt.addClass(o.domElement,fi.CLASS_TOO_TALL),o.__ul.style.height=window.innerHeight-n-20+"px"):(Wt.removeClass(o.domElement,fi.CLASS_TOO_TALL),o.__ul.style.height="auto")}o.__resize_handle&&Re.defer(function(){o.__resize_handle.style.height=o.__ul.offsetHeight+"px"}),o.__closeButton&&(o.__closeButton.style.width=o.width+"px")},onResizeDebounced:Re.debounce(function(){this.onResize()},50),remember:function(){if(Re.isUndefined(rf)&&((rf=new Lm).domElement.innerHTML=Im),this.parent)throw new Error("You can only call remember on a top level GUI.");var o=this;Re.each(Array.prototype.slice.call(arguments),function(n){o.__rememberedObjects.length===0&&ym(o),o.__rememberedObjects.indexOf(n)===-1&&o.__rememberedObjects.push(n)}),this.autoPlace&&jf(this,this.width)},getRoot:function(){for(var o=this;o.parent;)o=o.parent;return o},getSaveObject:function(){var o=this.load;return o.closed=this.closed,this.__rememberedObjects.length>0&&(o.preset=this.preset,o.remembered||(o.remembered={}),o.remembered[this.preset]=sf(this)),o.folders={},Re.each(this.__folders,function(n,e){o.folders[e]=n.getSaveObject()}),o},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=sf(this),Gf(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(o){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=sf(this,!0)),this.load.remembered[o]=sf(this),this.preset=o,of(this,o,!0),this.saveToLocalStorageIfPossible()},revert:function(o){Re.each(this.__controllers,function(n){this.getRoot().load.remembered?Hf(o||this.getRoot(),n):n.setValue(n.initialValue),n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())},this),Re.each(this.__folders,function(n){n.revert(n)}),o||Gf(this.getRoot(),!1)},listen:function(o){var n=this.__listening.length===0;this.__listening.push(o),n&&function e(r){r.length!==0&&mm.call(window,function(){e(r)}),Re.each(r,function(s){s.updateDisplay()})}(this.__listening)},updateDisplay:function(){Re.each(this.__controllers,function(o){o.updateDisplay()}),Re.each(this.__folders,function(o){o.updateDisplay()})}});var xm=fi,fd=function(){function o(n){this.runTime={fps:0,resolution:""},this.target=n.target,this.data=n.params,this.player=n.player,this.gui=this.createControllerGUI(),this.createStats(),this.addEventListener()}return o.prototype.createStats=function(){var n=this;setInterval(function(){n.controller.runTimeFps.setValue(n.player.runtime.fps),n.controller.runTimeResolution.setValue(n.player.view.width+"*"+n.player.view.height)},500)},o.prototype.createControllerGUI=function(){var n,e,r,s,l,h,m=new xm({autoPlace:!0,closed:!0});return m.domElement.style.opacity=".6",m.domElement.style.transformOrigin="100% 0",m.domElement.style.transform="scale(1.4)",this.target.appendChild(m.domElement),m.domElement.style.position="absolute",m.domElement.style.right="0",m.domElement.style.top="0",m.domElement.style.zIndex="2",this.controller={runTimeFps:m.add({FPS:0},"FPS",0),runTimeResolution:m.add({\u5206\u8FA8\u7387:""},"\u5206\u8FA8\u7387",""),autoFps:m.add({\u81EA\u52A8fps:(n=this.data.autoFPS)===null||n===void 0||n},"\u81EA\u52A8fps",!0),autoResolution:m.add({\u81EA\u52A8\u5206\u8FA8\u7387:(e=this.data.autoResolution)!==null&&e!==void 0&&e},"\u81EA\u52A8\u5206\u8FA8\u7387",!0),moreCalculation:m.add({\u989D\u5916\u8BA1\u7B97:0},"\u989D\u5916\u8BA1\u7B97",0,100),minFPS:m.add({\u6700\u4F4Efps:(r=this.data.minFPS)!==null&&r!==void 0?r:40},"\u6700\u4F4Efps",0,60),maxFPS:m.add({\u6700\u9AD8fps:(s=this.data.maxFPS)!==null&&s!==void 0?s:50},"\u6700\u9AD8fps",0,60),resolution:m.add({\u76EE\u6807\u5206\u8FA8\u500D\u7387:(l=this.data.resolution)!==null&&l!==void 0?l:window.devicePixelRatio},"\u76EE\u6807\u5206\u8FA8\u500D\u7387",.5,4),minResolution:m.add({\u6700\u5C0F\u5206\u8FA8\u500D\u7387:(h=this.data.minResolution)!==null&&h!==void 0?h:1},"\u6700\u5C0F\u5206\u8FA8\u500D\u7387",.5,4)},this.controller.runTimeFps.disabled=!0,this.controller.runTimeResolution.disabled=!0,m},o.prototype.addEventListener=function(){var n,e=this;this.controller.autoFps.onChange(function(r){e.data.autoFPS=r,e.player.updateConfig(e.data)}),this.controller.maxFPS.onChange(function(r){e.data.maxFPS=r,e.player.updateConfig(e.data)}),this.controller.minFPS.onChange(function(r){e.data.minFPS=r,e.player.updateConfig(e.data)}),this.controller.autoResolution.onChange(function(r){e.data.autoResolution=r,e.player.updateConfig(e.data)}),this.controller.minResolution.onChange(function(r){e.data.minResolution=r,e.player.updateConfig(e.data)}),this.controller.resolution.onChange(function(r){e.data.resolution=r,e.player.updateConfig(e.data)}),this.controller.moreCalculation.onChange(function(r){n&&e.player.app.ticker.remove(n),r>0&&(n=function(){for(var s="";s.length<r;)s+=Math.random().toString(32).substr(2);nc()(s)},e.player.app.ticker.add(n))})},o}(),bm=function(){var o=function(n,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(r[l]=s[l])})(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}o(n,e),n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),_p=function(o,n,e,r){return new(e||(e=Promise))(function(s,l){function h(b){try{x(r.next(b))}catch(w){l(w)}}function m(b){try{x(r.throw(b))}catch(w){l(w)}}function x(b){var w;b.done?s(b.value):(w=b.value,w instanceof e?w:new e(function(R){R(w)})).then(h,m)}x((r=r.apply(o,n||[])).next())})},Vf=function(o,n){var e,r,s,l,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function m(x){return function(b){return function(w){if(e)throw new TypeError("Generator is already executing.");for(;h;)try{if(e=1,r&&(s=2&w[0]?r.return:w[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,w[1])).done)return s;switch(r=0,s&&(w=[2&w[0],s.value]),w[0]){case 0:case 1:s=w;break;case 4:return h.label++,{value:w[1],done:!1};case 5:h.label++,r=w[1],w=[0];continue;case 7:w=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!((s=s.length>0&&s[s.length-1])||w[0]!==6&&w[0]!==2)){h=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){h.label=w[1];break}if(w[0]===6&&h.label<s[1]){h.label=s[1],s=w;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(w);break}s[2]&&h.ops.pop(),h.trys.pop();continue}w=n.call(o,h)}catch(R){w=[6,R],r=0}finally{e=s=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([x,b])}}},wm=window.ResizeObserver||fp,ki={syncDispatch:"syncDispatch",syncReceive:"syncReceive",renderStart:"renderStart",renderEnd:"renderEnd",renderError:"renderError",slideChange:"slideChange",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",animateStart:"animateStart",animateEnd:"animateEnd",stateChange:"stateChange"},Om=function(o){function n(e){var r=o.call(this)||this;return r.__slideState={taskId:"",url:"",currentSlideIndex:-1,mainSeqStep:-1,mainSeqState:null,appliedInteractiveSeqIds:[],mediaState:Object.create(null)},r.resize=!1,r.isAnimating=!1,r.renderingTaskManager=new mp,r.isLoading=!1,r.interactive=!0,r.frameWidth=1,r.frameHeight=1,r.frame=document.createElement("div"),r.medianController=document.createElement("div"),r.frameResizeObserver=new wm(function(s){return r.frameResizeHandler(s)}),r.timestamp=function(){return Date.now()},r.mode="local",e.timestamp&&(r.timestamp=e.timestamp),r.mode=e.mode,r.anchor=e.anchor,r.resize=e.resize||!1,r.interactive=e.interactive,r.player=new Pm(r.mode),r.player.setInteractive(r.interactive),r.player.updateConfig(e.renderOptions||{}),r.frame.style.cssText="width:100%;height:100%;display:flex;justify-content:center;align-items:center",r.frame.appendChild(r.player.view),r.setMedianControllerAttribute(),r.frame.appendChild(r.medianController),r.anchor.appendChild(r.frame),(e==null?void 0:e.controller)&&new fd({player:r.player,params:e.renderOptions||{},target:r.frame}),r.frameResizeObserver.observe(r.frame),r.player.on(xr.renderStart,function(s){r.isLoading=!0,r.emit(ki.renderStart,s)}),r.player.on(xr.renderEnd,function(s){r.isLoading=!1,r.emit(ki.renderEnd,s)}),r.player.on(xr.slideChange,function(s){r.__slideState.currentSlideIndex=s,r.emit(ki.slideChange,s)}),r.player.on(xr.mainSeqStateChange,function(s){r.__slideState.mainSeqState=s,r.emitStateChange()}),r.player.on(xr.mainSeqStepChange,function(s){r.__slideState.mainSeqStep=s,r.emitStateChange()}),r.player.on(xr.animateStart,function(){r.isAnimating!==!0&&(r.isAnimating=!0,r.emit(ki.animateStart))}),r.player.on(xr.animateEnd,function(){r.isAnimating!==!1&&(r.isAnimating=!1,r.emit(ki.animateEnd))}),r.player.on(xr.interactiveAnimTrigger,function(s){var l=s.action,h=s.seqId;r.__slideState.appliedInteractiveSeqIds.push(h),r.emit(ki.syncDispatch,{type:"interactiveAnim",action:l}),r.emitStateChange()}),r.player.on(xr.mainSeqStepStart,Object(W.throttle)(function(s){r.emit(ki.mainSeqStepStart)},100)),r.player.on(xr.mainSeqStepEnd,Object(W.throttle)(function(s){r.emit(ki.mainSeqStepEnd)},100)),r.player.on(xr.mediaPlay,function(s){var l={type:"play",time:r.timestamp()-1e3*s.time};r.__slideState.mediaState[s.id]=l,r.emit(ki.syncDispatch,{type:"mediaPlay",id:s.id,state:l}),r.emitStateChange()}),r.player.on(xr.mediaPause,function(s){var l={type:"pause",time:s.time};r.__slideState.mediaState[s.id]=l,r.emit(ki.syncDispatch,{type:"mediaPause",id:s.id,state:l}),r.emitStateChange()}),r.player.on(xr.mediaSeek,function(s){var l={type:"pause",time:0};s.isPlaying?(l.type="play",r.__slideState.mediaState[s.id]?l.time=r.__slideState.mediaState[s.id].time-1e3*s.time:l.time=r.timestamp()-1e3*s.time,r.__slideState.mediaState[s.id]=l):(l.type="pause",l.time=s.time,r.__slideState.mediaState[s.id]=l),r.emit(ki.syncDispatch,{type:"mediaSeek",id:s.id,time:s.time,state:l}),r.emitStateChange()}),r.on(ki.syncReceive,r.receiveSyncHandler),r.renderingTaskManager.eventHub.on("task-error",function(s){var l=s.error,h=s.task;r.emit(ki.renderError,{error:l,index:h.slideIndex})}),r}return bm(n,o),n.prototype.setMedianControllerAttribute=function(){this.medianController.id="median-container",this.medianController.style.position="absolute",this.medianController.style.left="0",this.medianController.style.top="0",this.medianController.style.zIndex="2"},n.prototype.frameResizeHandler=function(e){var r=e[0].contentRect,s=r.width,l=r.height;this.frameWidth=s,this.frameHeight=l,this.resizeView()},n.prototype.resizeView=function(){var e=this,r=this.width,s=this.height;if(r>0&&s>0){var l=this.frameWidth/r,h=l*s;if(h>this.frameHeight&&(l*=this.frameHeight/h),this.resize){var m=this.player.app;m.ticker.addOnce(function(){var x=l*(e.player.config.resolution||window.devicePixelRatio);m.renderer.resolution=x,m.renderer.plugins.interaction.resolution=m.renderer.resolution,m.renderer.resize(e.width,e.height)})}this.view.style.transform="scale("+l+")",this.medianController.style.transform="scale("+l+")",this.medianController.style.top=(this.frameHeight-s*l)/2+"px"}},n.prototype.receiveSyncHandler=function(e){var r=this;e.type==="nextStep"?this.mainSeqStep===e.next-1||this.mainSeqStep+1===this.mainSeqLength?this.doNextStep():(this.setMainSeqStep(e.next,"start"),this.player.nextTick(function(){r.doNextStep()})):e.type==="prevStep"?this.mainSeqStep===0&&this.mainSeqState==="idle"||this.mainSeqStep===e.next+1||this.mainSeqStep+1===this.mainSeqLength?this.doPrevStep():(this.setMainSeqStep(e.next+1,"start"),this.player.nextTick(function(){r.doPrevStep()})):e.type==="interactiveAnim"?this.player.applyInteractiveAction(e.action):e.type==="renderSlide"?this.doRenderSlide(e.index):e.type==="mediaPlay"?(this.player.setMediaState(e.id,!0),this.__slideState.mediaState[e.id]=e.state):e.type==="mediaPause"?(this.player.setMediaState(e.id,!1),this.__slideState.mediaState[e.id]=e.state):e.type==="mediaSeek"&&(this.player.setMediaCurrentTime(e.id,e.time),this.__slideState.mediaState[e.id]=e.state)},n.prototype.setSlideState=function(e){return _p(this,void 0,void 0,function(){var r,s=this;return Vf(this,function(l){switch(l.label){case 0:return e.taskId&&e.taskId!==this.__slideState.taskId&&(this.__slideState.taskId=e.taskId,this.player.setResourceData(e.taskId,this.__slideState.url)),e.url&&e.url!==this.__slideState.url&&(this.__slideState.url=e.url,this.player.setResourceData(this.__slideState.taskId,e.url)),Number.isInteger(e.currentSlideIndex)&&e.currentSlideIndex!==this.__slideState.currentSlideIndex?(this.__slideState.currentSlideIndex=e.currentSlideIndex,[4,this.doRenderSlide(e.currentSlideIndex)]):[3,2];case 1:l.sent(),l.label=2;case 2:return[4,Df(function(){return s.player.currentIndex===e.currentSlideIndex&&s.player.currentStage},3e3)];case 3:return l.sent(),r=!1,Number.isInteger(e.mainSeqStep)&&e.mainSeqStep!==this.__slideState.mainSeqStep&&(r=!0,this.__slideState.mainSeqStep=e.mainSeqStep),e.mainSeqState&&e.mainSeqState!==this.__slideState.mainSeqState&&(r=!0,this.__slideState.mainSeqState=e.mainSeqState),r&&this.setMainSeqStep(this.__slideState.mainSeqStep,this.__slideState.mainSeqState==="idle"?"start":"end"),e.appliedInteractiveSeqIds&&e.appliedInteractiveSeqIds.length>0&&(this.__slideState.appliedInteractiveSeqIds=e.appliedInteractiveSeqIds,e.appliedInteractiveSeqIds.forEach(function(h){s.player.seekInteractiveSeqToEnd(h)})),e.mediaState&&(this.initMedia(e),this.__slideState.mediaState=e.mediaState),[2]}})})},n.prototype.initMedia=function(e){var r=this,s=function(m){var x=e.mediaState[m],b=l.__slideState.mediaState[m];if(b&&x.type===b.type&&x.time===b.time)return"continue";x.type==="play"?l.player.setMediaState(m,!0).then(function(){var w=r.timestamp();r.player.setMediaCurrentTime(m,(w-x.time)/1e3)}):l.player.setMediaState(m,!1).then(function(){r.player.setMediaCurrentTime(m,x.time)})},l=this;for(var h in e.mediaState)s(h)},Object.defineProperty(n.prototype,"slideCount",{get:function(){return this.player.slideCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"slideState",{get:function(){return this.__slideState.mainSeqState=this.mainSeqState,this.__slideState.mainSeqStep=this.mainSeqStep,JSON.parse(JSON.stringify(this.__slideState))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mainSeqLength",{get:function(){return this.player.mainSeqLength()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mainSeqStep",{get:function(){return this.player.mainSeqStep()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mainSeqState",{get:function(){return this.player.mainSeqState()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"renderOptions",{get:function(){return this.player.config},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"drawCall",{get:function(){return this.player.runtime.drawCall},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"renderFps",{get:function(){return this.player.runtime.fps},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"runtimeFps",{get:function(){return this.player.fps.value},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"view",{get:function(){return this.player.view},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.player.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.player.height},enumerable:!1,configurable:!0}),n.prototype.updateRenderOption=function(e){this.player.updateConfig(e)},n.prototype.setResource=function(e,r){this.player.setResourceData(e,r),this.__slideState.taskId=e,this.__slideState.url=r,this.emit(ki.syncDispatch,{type:"setResource",taskId:e,url:r})},n.prototype._renderSlide=function(e){return _p(this,void 0,void 0,function(){return Vf(this,function(r){switch(r.label){case 0:return this.isLoading=!0,[4,this.player.renderSlide(e)];case 1:return r.sent(),this.__slideState.currentSlideIndex=e,this.isLoading=!1,this.resizeView(),this.emitStateChange(),[2]}})})},n.prototype.renderSlide=function(e){var r=Number(e);(r!==this.player.currentIndex||this.renderingTaskManager.hasStartTask())&&(r>this.slideCount&&this.slideCount>0||(this.mode==="interactive"?this.emit(ki.syncDispatch,{type:"renderSlide",index:r}):this.mode==="sync"?(this.doRenderSlide(r),this.emit(ki.syncDispatch,{type:"renderSlide",index:r})):this.doRenderSlide(r)))},n.prototype.doRenderSlide=function(e){var r=this;this.player.clearForward(),this.renderingTaskManager.addTask(function(){return r._renderSlide(e)},e)},n.prototype.nextStep=function(){this.isLoading||(this.mode==="interactive"?this.emit(ki.syncDispatch,{type:"nextStep",next:this.player.mainSeqStep()+1}):this.mode==="sync"?(this.doNextStep(),this.emit(ki.syncDispatch,{type:"nextStep",next:this.player.mainSeqStep()})):this.doNextStep())},n.prototype.doNextStep=function(){this.player.nextStep();var e=this.player.mainSeqStep();this.__slideState.mainSeqStep=e,this.emitStateChange()},n.prototype.prevStep=function(){this.isLoading||(this.mode==="interactive"?this.emit(ki.syncDispatch,{type:"prevStep",next:this.player.mainSeqStep()-1}):this.mode==="sync"?(this.doPrevStep(),this.emit(ki.syncDispatch,{type:"prevStep",next:this.player.mainSeqStep()})):this.doPrevStep())},n.prototype.doPrevStep=function(){this.player.prevStep();var e=this.player.mainSeqStep();this.__slideState.mainSeqStep=e,this.emitStateChange()},n.prototype.emitStateChange=function(){this.mode!=="local"&&this.emit(ki.stateChange,this.slideState)},n.prototype.setMainSeqStep=function(e,r){this.player.setMainSeqStep(e,r)},n.prototype.setInteractive=function(e){this.interactive=e,this.player.setInteractive(e)},n.prototype.pause=function(){this.player.pause()},n.prototype.resume=function(){this.player.resume()},n.prototype.destroy=function(){this.frameResizeObserver.disconnect(),this.player.removeAllListeners(),this.player.destroy(),this.player.removeAllListeners();try{this.anchor.removeChild(this.player.view)}catch{}},n}(Z.a)}]);function Ng(Ie,C,T){return Math.min(Math.max(Ie,C),T)}function Fg(Ie){return typeof Ie=="object"&&Ie!==null}function Bg(Ie){return new Promise(C=>setTimeout(C,Ie))}function Ug(Ie,C,T){const J=C.slideState.currentSlideIndex;if(J==null)return;const G=[T,J].join("/");if(Ie.scenePathType(G)==="none"){Ie.removeScenes(T);const lt=C.slideCount,Z=[];for(let W=1;W<=lt;++W)Z.push({name:`${W}`});Ie.putScenes(T,Z)}Ie.setScenePath(G)}function kg(Ie){const{width:C,height:T,slideCount:J,slideState:G}=Ie,{taskId:lt,url:Z}=G,W=[];for(let mt=1;mt<=J;++mt)W.push({width:C,height:T,thumbnail:`${Z}/${lt}/preview/${mt}.png`,src:"ppt"});return W}class Gg{constructor(C,T,J,G,lt,Z,W,mt){this.slide=C,this.onPageChanged=T,this.onTransitionStart=J,this.onTransitionEnd=G,this.onDispatchSyncEvent=lt,this.onStateChange=Z,this.initialState=W,this.initialPage=mt,this.ready=new Promise((et,nt)=>{this.resolveReady=et,this.reject=nt}),this.onRenderError=({error:et})=>{console.warn("[Slide] render error",et)},this.pollCount=0,this.pollReadyState=()=>{this.isReady()?this.resolveReady(this):this.pollCount<60?(this.pollCount++,setTimeout(this.pollReadyState,500)):this.reject(new Error("slide init time out (30s)"))},this.targetingPage=-1,this.resetTargetingPage=()=>{this.targetingPage=-1},C.on(Ea.SLIDE_EVENTS.slideChange,T),C.on(Ea.SLIDE_EVENTS.slideChange,this.resetTargetingPage),C.on(Ea.SLIDE_EVENTS.renderStart,J),C.on(Ea.SLIDE_EVENTS.renderEnd,G),C.on(Ea.SLIDE_EVENTS.mainSeqStepStart,J),C.on(Ea.SLIDE_EVENTS.mainSeqStepEnd,G),C.on(Ea.SLIDE_EVENTS.syncDispatch,lt),C.on(Ea.SLIDE_EVENTS.renderError,G),C.on(Ea.SLIDE_EVENTS.renderError,this.onRenderError),C.on(Ea.SLIDE_EVENTS.stateChange,Z),this.pollReadyState()}initialize(){this.initialState?this.slide.setSlideState(this.initialState):this.slide.renderSlide(this.initialPage)}receiveSyncEvent(C){this.slide.emit(Ea.SLIDE_EVENTS.syncReceive,C)}isReady(){return this.slide.slideCount>0}jumpToPage(C){!this.isReady()||(C=Ng(C,1,this.slide.slideCount),C!==this.targetingPage&&(this.targetingPage=C,this.slide.renderSlide(C)))}destroy(){this.slide.destroy()}}function Hg(Ie,C,T,J,G,lt,Z,W,mt,et,nt,ct){const Nt=new Ea.Slide({anchor:Ie,interactive:!0,mode:"interactive",resize:!1,controller:J,timestamp:ct});return Nt.setResource(C,T),new Gg(Nt,Z,W,mt,et,nt,G,lt)}function zg(Ie){const C="http://www.w3.org/2000/svg",T=document.createElementNS(C,"svg");T.setAttribute("class",`${Ie}-footer-icon-sidebar`),T.setAttribute("viewBox","0 0 64 64");const J=document.createElementNS(C,"path");return J.setAttribute("fill","currentColor"),J.setAttribute("d","M50 8H14c-3.309 0-6 2.691-6 6v36c0 3.309 2.691 6 6 6h36c3.309 0 6-2.691 6-6V14c0-3.309-2.691-6-6-6zM12 50V14c0-1.103.897-2 2-2h8v40h-8c-1.103 0-2-.897-2-2zm40 0c0 1.103-.897 2-2 2H26V12h24c1.103 0 2 .897 2 2z"),T.appendChild(J),T}function jg(Ie){const C="http://www.w3.org/2000/svg",T=document.createElementNS(C,"svg");T.setAttribute("class",`${Ie}-footer-icon-arrow-left`),T.setAttribute("viewBox","0 0 500 500");const J=document.createElementNS(C,"path");return J.setAttribute("fill","currentColor"),J.setAttribute("d","M177.81 249.959L337.473 90.295c2.722-2.865 2.651-7.378-.143-10.1-2.793-2.65-7.163-2.65-9.956 0l-164.75 164.75c-2.793 2.793-2.793 7.306 0 10.1l164.75 164.75c2.865 2.722 7.378 2.65 10.099-.143 2.651-2.794 2.651-7.163 0-9.957L177.809 249.959z"),T.appendChild(J),T}function Vg(Ie){const C="http://www.w3.org/2000/svg",T=document.createElementNS(C,"svg");T.setAttribute("class",`${Ie}-footer-icon-arrow-right`),T.setAttribute("viewBox","0 0 500 500");const J=document.createElementNS(C,"path");return J.setAttribute("fill","currentColor"),J.setAttribute("d","M322.19 250.041L162.527 409.705c-2.722 2.865-2.651 7.378.143 10.1 2.793 2.65 7.163 2.65 9.956 0l164.75-164.75c2.793-2.793 2.793-7.306 0-10.1l-164.75-164.75c-2.865-2.722-7.378-2.65-10.099.143-2.651 2.794-2.651 7.163 0 9.957l159.664 159.736z"),T.appendChild(J),T}function Wg(Ie){const C="http://www.w3.org/2000/svg",T=document.createElementNS(C,"svg");T.setAttribute("class",`${Ie}-footer-icon-play`),T.setAttribute("viewBox","0 0 500 500");const J=document.createElementNS(C,"path");return J.setAttribute("fill","currentColor"),J.setAttribute("d","M418.158 257.419L174.663 413.33c-6.017 3.919-15.708 3.772-21.291-.29-2.791-2.018-4.295-4.483-4.295-7.084V94.109c0-5.65 6.883-10.289 15.271-10.289 4.298 0 8.391 1.307 11.181 3.332l242.629 155.484c6.016 3.917 6.451 10.292.649 14.491-.216.154-.432.154-.649.292zM170.621 391.288l223.116-141.301L170.71 107.753l-.089 283.535z"),T.appendChild(J),T}function Xg(Ie){const C="http://www.w3.org/2000/svg",T=document.createElementNS(C,"svg");T.setAttribute("class",`${Ie}-footer-icon-pause`),T.setAttribute("viewBox","0 0 500 500");const J=document.createElementNS(C,"path");return J.setAttribute("fill","currentColor"),J.setAttribute("d","M312.491 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261zM165.257 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261z"),T.appendChild(J),T}class Yg{constructor({readonly:C,box:T,onNewPageIndex:J,onPlay:G}){this._pages=[],this.pageIndex=0,this.setPaused=()=>{this.$btnPlay.classList.toggle(this.wrapClassName("footer-btn-playing"),!1)},this.setPlaying=()=>{this.$btnPlay.classList.toggle(this.wrapClassName("footer-btn-playing"),!0)},this.namespace="netless-app-slide",this.isShowPreview=!1,this.isSmallBox=!1,this.sideEffect=new Fm,this.readonly=C,this.box=T,this.onNewPageIndex=J,this.onPlay=G,this.render()}set pages(C){this._pages=C,this.refreshPreview(),this.refreshTotalPage(),this.refreshBtnSidebar()}get pages(){return this._pages}mount(){this.box.mountContent(this.$content),this.box.mountFooter(this.$footer)}unmount(){this.$content.remove(),this.$footer.remove()}setReadonly(C){this.readonly!==C&&(this.readonly=C,this.$content.classList.toggle(this.wrapClassName("readonly"),C),this.$footer.classList.toggle(this.wrapClassName("readonly"),C),this.$pageNumberInput.disabled=C)}destroy(){this.sideEffect.flushAll(),this.unmount()}setPageIndex(C){Number.isNaN(C)||(this.pageIndex=C,this.$pageNumberInput.value=String(C+1))}refreshTotalPage(){this.pages.length?this.$totalPage.textContent=" / "+this.pages.length:this.$totalPage.textContent=""}setSmallBox(C){this.isSmallBox!==C&&(this.isSmallBox=C,this.$footer.classList.toggle(this.wrapClassName("float-footer"),C))}render(){return this.renderContent(),this.renderFooter(),this.$content}renderContent(){if(!this.$content){const C=document.createElement("div");C.className=this.wrapClassName("content"),this.$content=C,this.readonly&&C.classList.add(this.wrapClassName("readonly")),C.appendChild(this.renderPreviewMask()),C.appendChild(this.renderPreview())}return this.$content}renderPreview(){if(!this.$preview){const C=document.createElement("div");C.className=this.wrapClassName("preview")+" tele-fancy-scrollbar",this.$preview=C,this.refreshPreview(),this.sideEffect.addEventListener(C,"click",T=>{var G;if(this.readonly)return;const J=(G=T.target.dataset)==null?void 0:G.pageIndex;J&&(T.preventDefault(),T.stopPropagation(),T.stopImmediatePropagation(),this.onNewPageIndex(Number(J)),this.togglePreview(!1))})}return this.$preview}refreshPreview(){const{$preview:C}=this,T=this.wrapClassName("preview-page"),J=this.wrapClassName("preview-page-name");for(;C.firstChild;)C.firstChild.remove();this.pages.forEach((G,lt)=>{var ct;const Z=(ct=G.thumbnail)!=null?ct:G.src.startsWith("ppt")?void 0:G.src;if(!Z)return;const W=String(lt),mt=document.createElement("a");mt.className=T+" "+this.wrapClassName(`preview-page-${lt}`),mt.setAttribute("href","#"),mt.dataset.pageIndex=W;const et=document.createElement("span");et.className=J,et.textContent=String(lt+1),et.dataset.pageIndex=W;const nt=document.createElement("img");nt.width=G.width,nt.height=G.height,nt.dataset.src=Z,nt.dataset.pageIndex=W,mt.appendChild(nt),mt.appendChild(et),C.appendChild(mt)}),this.sideEffect.add(()=>{const G=new Og({container:this.$preview,elements_selector:`.${this.wrapClassName("preview-page>img")}`});return()=>G.destroy()},"preview-lazyload")}renderPreviewMask(){return this.$previewMask||(this.$previewMask=document.createElement("div"),this.$previewMask.className=this.wrapClassName("preview-mask"),this.sideEffect.addEventListener(this.$previewMask,"click",C=>{this.readonly||C.target===this.$previewMask&&this.togglePreview(!1)})),this.$previewMask}refreshBtnSidebar(){this.$btnSidebar.style.display=this.pages.length>0?"":"none"}renderFooter(){if(!this.$footer){const C=document.createElement("div");C.className=this.wrapClassName("footer"),this.$footer=C,this.readonly&&C.classList.add(this.wrapClassName("readonly")),this.isSmallBox&&C.classList.add(this.wrapClassName("float-footer"));const T=this.renderFooterBtn("btn-sidebar",zg(this.namespace));this.sideEffect.addEventListener(T,"click",()=>{this.readonly||this.togglePreview()}),this.$btnSidebar=T,this.$btnSidebar.style.display="none",this.$footer.appendChild(T);const J=document.createElement("div");J.className=this.wrapClassName("page-jumps");const G=this.renderFooterBtn("btn-page-back",jg(this.namespace));if(this.sideEffect.addEventListener(G,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex-1)}),J.appendChild(G),this.onPlay){const et=this.renderFooterBtn("btn-page-play",Wg(this.namespace),Xg(this.namespace));this.$btnPlay=et,this.sideEffect.addEventListener(et,"click",()=>{this.readonly||(this.setPlaying(),this.onPlay&&this.onPlay())}),J.appendChild(et)}const lt=this.renderFooterBtn("btn-page-next",Vg(this.namespace));this.sideEffect.addEventListener(lt,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex+1)}),J.appendChild(lt);const Z=document.createElement("div");Z.className=this.wrapClassName("page-number");const W=document.createElement("input");W.className=this.wrapClassName("page-number-input"),W.value=String(this.pageIndex+1),this.readonly&&(W.disabled=!0),this.$pageNumberInput=W,this.sideEffect.addEventListener(W,"change",()=>{this.readonly||W.value&&this.onNewPageIndex(Number(W.value)-1)});const mt=document.createElement("span");this.$totalPage=mt,Z.appendChild(W),Z.appendChild(mt),this.$footer.appendChild(J),this.$footer.appendChild(Z)}return this.$footer}renderFooterBtn(C,T,J){const G=document.createElement("button");return G.className=this.wrapClassName("footer-btn")+" "+this.wrapClassName(C),G.appendChild(T),J&&G.appendChild(J),G}togglePreview(C){if(this.isShowPreview=C!=null?C:!this.isShowPreview,this.$content.classList.toggle(this.wrapClassName("preview-active"),this.isShowPreview),this.isShowPreview){const T=this.$preview.querySelector("."+this.wrapClassName(`preview-page-${this.pageIndex}`));T&&this.$preview.scrollTo({top:T.offsetTop-16})}}wrapClassName(C){return`${this.namespace}-${C}`}}const qg=new Set(["clicker","selector"]);class Zg{constructor({box:C,view:T,mountSlideController:J,mountWhiteboard:G}){this.scaleDocsToFit=()=>{if(this.slideController){const{width:lt,height:Z}=this.slideController.slide;this.whiteboardView.moveCameraToContain({originX:-lt/2,originY:-Z/2,width:lt,height:Z,animationMode:"immediately"})}},this.onPlay=()=>{this.slideController&&this.slideController.slide.nextStep()},this.onNewPageIndex=lt=>{this.slideController&&this.slideController.jumpToPage(lt+1)},this.sideEffect=new Fm,this.namespace="netless-app-slide",this.box=C,this.whiteboardView=T,this.mountSlideController=J,this.mountWhiteboard=G,this.viewer=new Yg({box:C,readonly:C.readonly,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlay}),this.render()}render(){this.viewer.$content.appendChild(this.renderSlideContainer()),this.viewer.$content.appendChild(this.renderWhiteboardView()),this.sideEffect.addEventListener(window,"keydown",C=>{if(this.box.focus&&this.slideController)switch(C.key){case"ArrowUp":case"ArrowLeft":{this.slideController.slide.prevStep();break}case"ArrowRight":case"ArrowDown":{this.slideController.slide.nextStep();break}}})}renderSlideContainer(){if(!this.$slide){const C=document.createElement("div");C.className=this.wrapClassName("slide"),C.dataset.appKind="Slide",this.$slide=C}return this.$slide}renderWhiteboardView(){return this.$whiteboardView||(this.$whiteboardView=document.createElement("div"),this.$whiteboardView.className=this.wrapClassName("wb-view"),this.mountWhiteboard(this.$whiteboardView)),this.$whiteboardView}async mount(){return this.viewer.mount(),this.slideController=await this.mountSlideController(this.$slide),this.viewer.pages=kg(this.slideController.slide),this.viewer.setPageIndex(this.getPageIndex(this.slideController.slide)),this.scaleDocsToFit(),this.sideEffect.add(()=>(this.whiteboardView.callbacks.on("onSizeUpdated",this.scaleDocsToFit),()=>this.whiteboardView.callbacks.off("onSizeUpdated",this.scaleDocsToFit))),this}getPageIndex(C){return(C.slideState.currentSlideIndex||1)-1}unmount(){return this.slideController&&(this.slideController.destroy(),this.slideController=void 0),this.viewer.unmount(),this}setReadonly(C){this.viewer.setReadonly(C)}destroy(){this.sideEffect.flushAll(),this.unmount(),this.viewer.destroy()}toggleClickThrough(C){this.$whiteboardView.style.pointerEvents=!C||qg.has(C)?"none":"auto"}wrapClassName(C){return`${this.namespace}-${C}`}}var Jg=`.netless-app-slide-content{position:relative;height:100%;overflow:hidden}.netless-app-slide-preview-mask{display:none;position:absolute;z-index:200;top:0;left:0;width:100%;height:100%}.netless-app-slide-preview{display:flex;flex-direction:column;align-items:center;position:absolute;z-index:300;top:0;left:0;width:33%;max-width:200px;height:100%;padding-top:10px;transform:translate(-100%);background:rgba(237,237,240,.9);box-shadow:inset -1px 0 #0000001c;transition:transform .4s}.netless-app-slide-preview-active .netless-app-slide-preview-mask{display:block}.netless-app-slide-preview-active .netless-app-slide-preview{transform:translate(0)}.netless-app-slide-preview-page{position:relative;display:block;width:55%;margin-bottom:10px;font-size:0;color:transparent;outline:none;border:7px solid transparent;border-radius:4px;transition:border-color .3s;user-select:none}.netless-app-slide-preview-page:hover,.netless-app-slide-preview-page.netless-app-slide-preview-page-active{border-color:#444e601a}.netless-app-slide-preview-page>img{width:100%;height:auto;box-sizing:border-box;border:1px solid rgba(0,0,0,.5);border-radius:1px;background-color:#fff;box-shadow:0 2px 8px #0000004d}.netless-app-slide-preview-page-name{position:absolute;top:1px;left:-10px;transform:translate(-100%);text-align:right;font-size:12px;color:#5f5f5f;user-select:none}.netless-app-slide-footer{box-sizing:border-box;height:26px;display:flex;align-items:center;padding:0 16px;border-top:1px solid #eeeef7;color:#191919}.netless-app-slide-float-footer{width:100%;min-height:26px;position:absolute;left:0;bottom:0;z-index:2000;background:rgba(249,249,252,.9);transition:opacity .4s}.netless-app-slide-footer-btn{box-sizing:border-box;width:26px;height:26px;font-size:0;margin:0;padding:3px;border:none;border-radius:1px;outline:none;color:currentColor;background:transparent;transition:background .4s;cursor:pointer;user-select:none}.netless-app-slide-footer-btn:hover{background:rgba(237,237,240,.9)}.netless-app-slide-footer-btn>svg{width:100%;height:100%}.netless-app-slide-footer-btn>svg:nth-of-type(2){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(1){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(2){display:initial}.netless-app-slide-footer-btn~.netless-app-slide-footer-btn{margin-left:15px}.netless-app-slide-page-jumps{flex:1;display:flex;justify-content:center;align-items:center}.netless-app-slide-page-number{margin-left:auto;font-size:13px;user-select:none;white-space:nowrap;word-break:keep-all}.netless-app-slide-page-number-input{border:none;outline:none;width:1.5em;text-align:right;border-radius:2px;color:currentColor;background:transparent;transition:background .4s;user-select:text}.netless-app-slide-page-number-input:hover,.netless-app-slide-page-number-input:focus,.netless-app-slide-page-number-input:active{background:#fff;box-shadow:#63636333 0 2px 8px}.netless-app-slide-readonly .netless-app-slide-footer-btn{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-footer-btn:hover{background:transparent}.netless-app-slide-readonly .netless-app-slide-page-number-input{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-page-number-input:hover,.netless-app-slide-readonly .netless-app-slide-page-number-input:focus,.netless-app-slide-readonly .netless-app-slide-page-number-input:active{background:transparent;box-shadow:none}.netless-app-slide-readonly .netless-app-slide-page-number-input:disabled{color:inherit}.netless-app-slide-readonly.netless-app-slide-float-footer{display:none}.netless-app-slide-wb-view{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;overflow:hidden}.netless-app-slide-slide{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.netless-app-slide-slide canvas{transform:scale(var(--netless-app-slide-scale, 1))}
`;const ev={kind:"Slide",async setup(Ie){var k;const C=Ie.getBox(),T=Ie.getView(),J=Ie.getRoom(),G=Ie.getDisplayer(),lt=Dg(Ie,{taskId:"",url:"",state:null});if(!lt.taskId)throw new Error("[Slide] no taskId");if(!T)throw new Error("[Slide] no view, please set scenePath on addApp()");if(!lt.state&&!Ie.isAddApp)for(let X=0;X<15&&(await Bg(200),!lt.state);++X);C.mountStyles(Jg);const Z=new Fm,W=Ie.getInitScenePath(),mt=(k=Ie.getAppOptions())==null?void 0:k.debug,et=`channel-${Ie.appId}`;let nt;const ct=()=>J?J.calibrationTimestamp:G.beginTimestamp+G.progressTime,Nt=X=>{console.log("[Slide] page to",X),Ie.getIsWritable()&&J&&nt&&(Ug(J,nt.slide,W),rt.viewer.setPageIndex(X-1))},Xt=()=>{rt.viewer.setPlaying()},Gt=()=>{rt.viewer.setPaused()},L=X=>{Ie.getIsWritable()&&nt&&J&&J.dispatchMagixEvent(et,{type:Ea.SLIDE_EVENTS.syncDispatch,payload:X})},F=X=>{Ie.updateAttributes(["state"],X)};Z.add(()=>{const X=async tt=>{if(nt&&tt.event===et&&Fg(tt.payload)){const{type:ht,payload:ue}=tt.payload;ht===Ea.SLIDE_EVENTS.syncDispatch&&nt.receiveSyncEvent(ue)}};return G.addMagixEventListener(et,X),()=>G.removeMagixEventListener(et,X)});const z=async X=>(nt=Hg(X,lt.taskId,lt.url||"https://convertcdn.netless.link/dynamicConvert",mt,JSON.parse(JSON.stringify(lt.state)),G.state.sceneState.index+1,Nt,Xt,Gt,L,F,ct),nt.initialize(),await nt.ready,nt),rt=new Zg({box:C,view:T,mountSlideController:z,mountWhiteboard:X=>Ie.mountView(X)});try{await rt.mount()}catch(X){console.warn(X),console.log("[Slide]: destroy by error"),Z.flushAll(),rt.destroy();return}J&&(rt.toggleClickThrough(J.state.memberState.currentApplianceName),Z.add(()=>{const X=tt=>{tt.memberState&&rt.toggleClickThrough(tt.memberState.currentApplianceName)};return J.callbacks.on("onRoomStateChanged",X),()=>J.callbacks.off("onRoomStateChanged",X)})),Ie.emitter.on("writableChange",()=>{rt.setReadonly(!Ie.getIsWritable())}),Ie.emitter.on("destroy",()=>{console.log("[Slide]: destroy"),Z.flushAll(),rt.destroy()})}};export{ev as default};
