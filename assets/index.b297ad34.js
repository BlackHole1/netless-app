import{S as B,i as U,s as A,e as c,t as C,n as h,c as l,d as g,C as R,g as E,h as i,H as v,p as y,j as S,F as L,m as j,v as q,I as x}from"./vendor.914a2cfa.js";function z(e){let s,t,r,o,d,a,m,f,w,n,u,_,k;return{c(){s=c("div"),t=c("div"),r=c("span"),o=C(e[2]),d=h(),a=c("input"),m=h(),f=c("button"),f.textContent="GO",w=h(),n=c("iframe"),l(r,"class","netless-app-browser-status"),g(r,"loading",e[2]==="Loading"),g(r,"ready",e[2]==="Ready"),l(a,"class","netless-app-browser-url"),l(a,"autocomplete","off"),l(a,"spellcheck","false"),l(f,"class","netless-app-browser-go"),l(t,"class","netless-app-browser-omnibox"),l(n,"title","Netless App Browser"),l(n,"class","netless-app-browser-content"),l(n,"frameborder","0"),R(n.src,u=e[0])||l(n,"src",u),l(s,"class","netless-app-browser"),l(s,"data-kind","browser")},m(p,b){E(p,s,b),i(s,t),i(t,r),i(r,o),i(t,d),i(t,a),v(a,e[1]),i(t,m),i(t,f),i(s,w),i(s,n),_||(k=[y(a,"input",e[5]),y(a,"keypress",e[6]),y(f,"click",e[4]),y(n,"load",e[3])],_=!0)},p(p,[b]){b&4&&S(o,p[2]),b&4&&g(r,"loading",p[2]==="Loading"),b&4&&g(r,"ready",p[2]==="Ready"),b&2&&a.value!==p[1]&&v(a,p[1]),b&1&&!R(n.src,u=p[0])&&l(n,"src",u)},i:L,o:L,d(p){p&&j(s),_=!1,q(k)}}}function D(e,s,t){const r=x();let{url:o="about:blank"}=s,{dummyURL:d=o}=s,a="Ready";function m(){t(2,a="Ready")}function f(){t(0,o=d),t(2,a="Loading")}function w(){d=this.value,t(1,d)}const n=u=>u.key==="Enter"&&f();return e.$$set=u=>{"url"in u&&t(0,o=u.url),"dummyURL"in u&&t(1,d=u.dummyURL)},e.$$.update=()=>{e.$$.dirty&1&&r("update",o)},[o,d,a,m,f,w,n]}class F extends B{constructor(s){super();U(this,s,D,z,A,{url:0,dummyURL:1})}}var G=`.netless-app-browser{width:100%;height:100%;display:flex;flex-flow:column nowrap}.netless-app-browser-omnibox{padding:2px 4px;display:flex;align-items:center;gap:4px}.netless-app-browser-status{width:5em;font-size:x-small;text-align:center}.netless-app-browser-status.loading{color:gray}.netless-app-browser-status.ready{color:green}.netless-app-browser-url{flex-grow:1}.netless-app-browser-go{padding:1px 12px}.netless-app-browser-content{display:block;flex-grow:1}
`;const I={kind:"Browser",setup(e){let s=e.getAttributes();if((s==null?void 0:s.url)||(e.setAttributes({url:"about:blank"}),s=e.getAttributes()),!s)throw new Error("[Browser]: Missing attributes");const t=e.getBox();t.mountStyles(G);const r=new F({target:t.$content,props:{url:s.url}});r.$on("update",({detail:o})=>{e.updateAttributes(["url"],o)}),e.mobxUtils.autorun(()=>{r.$set({url:s.url,dummyURL:s.url})}),e.emitter.on("destroy",()=>{console.log("[Browser]: destroy"),r.$destroy()})}};export{I as default};
