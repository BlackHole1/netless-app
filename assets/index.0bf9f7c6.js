import{S as t,i as e,s,e as l,b as n,G as i,d as o,g as a,p as r,l as c,n as p,H as d,t as u,h as g,c as m,E as b,C as f,I as v}from"./vendor.878c767b.js";function h(t,e,s){const l=t.slice();return l[16]=e[s],l[17]=e,l[18]=s,l}function x(t){let e,s,p,d,u,g;return{c(){e=l("button"),s=l("img"),n(s,"draggable","false"),i(s.src,p="assets/plus.4b34cdbf.svg")||n(s,"src","assets/plus.4b34cdbf.svg"),n(s,"alt","add"),n(e,"title","Add"),e.disabled=d=t[1].length>=20},m(l,n){o(l,e,n),a(e,s),u||(g=r(e,"click",t[7]),u=!0)},p(t,s){2&s&&d!==(d=t[1].length>=20)&&(e.disabled=d)},d(t){t&&c(e),u=!1,g()}}}function y(t){let e,s,p,d,u;return{c(){e=l("button"),s=l("img"),n(s,"draggable","false"),i(s.src,p=t[4]?"assets/pencil-off.f49ce2a4.svg":"assets/pencil.614cc8ea.svg")||n(s,"src",p),n(s,"alt","edit"),n(e,"title","Edit")},m(l,n){o(l,e,n),a(e,s),d||(u=r(e,"click",t[5]),d=!0)},p(t,e){16&e&&!i(s.src,p=t[4]?"assets/pencil-off.f49ce2a4.svg":"assets/pencil.614cc8ea.svg")&&n(s,"src",p)},d(t){t&&c(e),d=!1,u()}}}function w(t){let e,s,d,m,b,f,v,h,x,y,w=(t[2][t[18]]||0)+"";function $(){return t[12](t[18])}return{c(){e=l("span"),s=u("("),d=u(w),m=u(")"),b=p(),f=l("button"),v=l("img"),n(e,"class","netless-app-vote-count"),n(v,"draggable","false"),i(v.src,h="assets/up.c9e084a4.svg")||n(v,"src","assets/up.c9e084a4.svg"),n(v,"alt","vote"),n(f,"title","Vote")},m(t,l){o(t,e,l),a(e,s),a(e,d),a(e,m),o(t,b,l),o(t,f,l),a(f,v),x||(y=r(f,"click",$),x=!0)},p(e,s){t=e,4&s&&w!==(w=(t[2][t[18]]||0)+"")&&g(d,w)},d(t){t&&c(e),t&&c(b),t&&c(f),x=!1,y()}}}function $(t){let e,s,p,d,u;function g(){return t[13](t[18])}return{c(){e=l("button"),s=l("img"),n(s,"draggable","false"),i(s.src,p="assets/close.c4eb3b01.svg")||n(s,"src","assets/close.c4eb3b01.svg"),n(s,"alt","delete"),n(e,"title","Delete")},m(t,l){o(t,e,l),a(e,s),d||(u=r(e,"click",g),d=!0)},p(e,s){t=e},d(t){t&&c(e),d=!1,u()}}}function A(t){let e,s,i,u,g,m,b,f;function v(){t[11].call(s,t[17],t[18])}let h=!t[4]&&w(t),x=t[4]&&$(t);return{c(){e=l("li"),s=l("input"),u=p(),h&&h.c(),g=p(),x&&x.c(),m=p(),n(s,"class","netless-app-vote-item"),s.readOnly=i=!t[4]},m(l,n){o(l,e,n),a(e,s),d(s,t[16]),a(e,u),h&&h.m(e,null),a(e,g),x&&x.m(e,null),a(e,m),b||(f=r(s,"input",v),b=!0)},p(l,n){t=l,16&n&&i!==(i=!t[4])&&(s.readOnly=i),2&n&&s.value!==t[16]&&d(s,t[16]),t[4]?h&&(h.d(1),h=null):h?h.p(t,n):(h=w(t),h.c(),h.m(e,g)),t[4]?x?x.p(t,n):(x=$(t),x.c(),x.m(e,m)):x&&(x.d(1),x=null)},d(t){t&&c(e),h&&h.d(),x&&x.d(),b=!1,f()}}}function k(t){let e,s,i,d,v,w,$,k,E,C,I,U=(t[0]||"what to eat")+"",V=t[4]&&x(t),N=t[3]&&y(t),O=t[1],S=[];for(let l=0;l<O.length;l+=1)S[l]=A(h(t,O,l));return{c(){e=l("div"),s=l("div"),V&&V.c(),i=p(),N&&N.c(),d=p(),v=l("div"),w=l("h2"),$=u(U),k=p(),E=l("ul");for(let t=0;t<S.length;t+=1)S[t].c();n(s,"class","netless-app-vote-controls"),n(w,"contenteditable",t[4]),m(w,"editing",t[4]),n(v,"class","netless-app-vote-title"),n(E,"class","netless-app-vote-items"),n(e,"class","netless-app-vote"),n(e,"data-kind","vote")},m(l,n){o(l,e,n),a(e,s),V&&V.m(s,null),a(s,i),N&&N.m(s,null),a(e,d),a(e,v),a(v,w),a(w,$),a(e,k),a(e,E);for(let t=0;t<S.length;t+=1)S[t].m(E,null);C||(I=r(w,"input",t[6]),C=!0)},p(t,[e]){if(t[4]?V?V.p(t,e):(V=x(t),V.c(),V.m(s,i)):V&&(V.d(1),V=null),t[3]?N?N.p(t,e):(N=y(t),N.c(),N.m(s,null)):N&&(N.d(1),N=null),1&e&&U!==(U=(t[0]||"what to eat")+"")&&g($,U),16&e&&n(w,"contenteditable",t[4]),16&e&&m(w,"editing",t[4]),790&e){let s;for(O=t[1],s=0;s<O.length;s+=1){const l=h(t,O,s);S[s]?S[s].p(l,e):(S[s]=A(l),S[s].c(),S[s].m(E,null))}for(;s<S.length;s+=1)S[s].d(1);S.length=O.length}},i:b,o:b,d(t){t&&c(e),V&&V.d(),N&&N.d(),f(S,t),C=!1,I()}}}function E(t,e,s){let l;const n=v();let{writable:i=!1}=e,{title:o=""}=e,{items:a=["lorem","ipsum","dolo","sit","amet"]}=e,{votes:r=[0,0,0,0,0]}=e,c="vote";function p(t){s(1,a=a.slice(0,t).concat(a.slice(t+1)))}function d(t){i&&n("update",{votes:[t,r[t]+1]})}return t.$$set=t=>{"writable"in t&&s(3,i=t.writable),"title"in t&&s(0,o=t.title),"items"in t&&s(1,a=t.items),"votes"in t&&s(2,r=t.votes)},t.$$.update=()=>{1024&t.$$.dirty&&s(4,l="edit"===c)},[o,a,r,i,l,function(){s(10,c=l?"vote":"edit"),"vote"===c&&(s(2,r=Array(a.length).fill(0)),i&&(r.forEach(((t,e)=>{n("update",{votes:[e,t]})})),n("update",{title:o,items:a})))},function(t){s(0,o=t.target.textContent||"")},function(){s(1,a=a.concat([""]))},p,d,c,function(t,e){t[e]=this.value,s(1,a)},t=>d(t),t=>p(t)]}class C extends t{constructor(t){super(),e(this,t,E,k,s,{writable:3,title:0,items:1,votes:2})}}const I={kind:"Vote",setup(t){const e=t.getBox();let s=t.getAttributes();if(s||(t.setAttributes({title:"",items:[]}),s=t.getAttributes()),!s)return void t.emitter.emit("destroy",{error:new Error("[NetlessAppVote] No attributes")});null==s.title&&t.updateAttributes(["title"],""),s.items||t.updateAttributes(["items"],[]),e.mountStyles(".netless-app-vote{width:100%;height:100%;background-color:#fff;display:flex;flex-flow:column nowrap}.netless-app-vote [contenteditable=true]{border-bottom:1px dashed #ccc}.netless-app-vote button{height:25px;gap:4px;background-color:transparent;border:2px solid transparent;border-radius:4px}.netless-app-vote button:hover{border-color:#ccc}.netless-app-vote button:active{background-color:#ccc}.netless-app-vote button img{width:16px;height:16px}.netless-app-vote-controls{position:absolute;top:8px;right:8px}.netless-app-vote-title{padding:8px}.netless-app-vote-title h2{margin:0;padding:2px 8px;display:inline-block;line-height:1.1;color:#333;border-bottom:1px dashed transparent}.netless-app-vote-items{flex-grow:1;margin:0;padding:0 8px 12px;list-style-type:none;overflow-y:auto}.netless-app-vote-items li{display:flex;align-items:center;gap:5px;line-height:1.5;padding-bottom:4px}.netless-app-vote-items li button{display:inline-block}.netless-app-vote-item{display:block;font-size:16px;line-height:1.5;font-family:Arial,sans-serif;flex-grow:1;border:1px solid #eee;border-radius:4px;padding:2px 8px}.netless-app-vote-item[readonly]{border-color:transparent}.netless-app-vote-count{padding-right:8px}\n");const l=new C({target:e.$content,props:{writable:t.getIsWritable()}});t.emitter.on("writableChange",(()=>{l.$set({writable:t.getIsWritable()})})),l.$on("update",(({detail:e})=>{if("title"in e&&t.updateAttributes(["title"],e.title),"items"in e&&t.updateAttributes(["items"],e.items),Array.isArray(e.votes)){const[s,l]=e.votes;t.updateAttributes([`item-${s}`],l)}}));const n=[t.mobxUtils.autorun((()=>{l.$set({title:s.title})})),t.mobxUtils.autorun((()=>{s.items&&l.$set({items:[...s.items]})})),t.mobxUtils.autorun((()=>{s.items&&l.$set({votes:s.items.map(((t,e)=>s[`item-${e}`]||0))})}))];t.emitter.on("destroy",(()=>{n.forEach((t=>t())),l.$destroy()}))}};export{I as default};
