var e,t=Object.defineProperty,n=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(e,n,o)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,c=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&s(e,n,t[n]);if(r)for(var n of r(t))i.call(t,n)&&s(e,n,t[n]);return e},l=("undefined"!=typeof require&&require,(e,t)=>{var n={};for(var o in e)a.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&r)for(var o of r(e))t.indexOf(o)<0&&i.call(e,o)&&(n[o]=e[o]);return n});import{M as d,w as u,f as p,S as m,i as f,s as g,a as h,e as y,t as b,b as w,c as v,d as k,g as O,h as T,j as _,k as N,l as E,m as S,n as x,o as j,p as P,q as A,r as I,u as M,v as D,x as R,y as V,z as C,A as L,B as Y,C as z,D as W,E as K}from"./vendor.9fbfd044.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Z={},$=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`${e}`)in Z)return;Z[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),t?new Promise(((e,t)=>{o.addEventListener("load",e),o.addEventListener("error",t)})):void 0}))).then((()=>e())):e()},J=console.log.bind(console),U=console.debug.bind(console),q={"../../app-browser/playground.ts":()=>$((()=>import("./playground.bb0cc4f7.js")),["assets/playground.bb0cc4f7.js","assets/vendor.9fbfd044.js"]),"../../app-docs-viewer/playground.ts":()=>$((()=>import("./playground.e121f7bc.js").then((function(e){return e.p}))),[]),"../../app-hello-world/playground.ts":()=>$((()=>import("./playground.7e6e2397.js")),[]),"../../app-media-player/playground.ts":()=>$((()=>import("./playground.39284834.js")),["assets/playground.39284834.js","assets/vendor.9fbfd044.js"]),"../../app-monaco/playground.ts":()=>$((()=>import("./playground.fc27c9f2.js").then((function(e){return e.p}))),[]),"../../app-vote/playground.ts":()=>$((()=>import("./playground.71d7bff9.js")),["assets/playground.71d7bff9.js","assets/vendor.9fbfd044.js"])};document.querySelector.bind(document);const F=sessionStorage,G=localStorage,Q={VITE_APPID:"ss4WoMf_EeqfCXcv33LmiA/izfIC88inXYJKw",VITE_ROOM_TOKEN:"NETLESSROOM_YWs9VWtNUk92M1JIN2I2Z284dCZub25jZT0xNjMxNTg3NTU0NDc5MDAmcm9sZT0wJnNpZz01ODUyNDJjZGYwOGNhY2Y4ZWFjMzNlYjk1ZGU1YWZlNWUwMWY0OWQ5MTNkODhmNzY2ZjQyMDNhZGYzNjViYzcwJnV1aWQ9ZTE1YmMzYjAxNTA1MTFlY2E5Y2M5NzQ1Mzc2M2M0MmM",VITE_ROOM_UUID:"e15bc3b0150511eca9cc97453763c42c",BASE_URL:"",MODE:"production",DEV:!1,PROD:!0},X=(e,t)=>fetch(`https://api.netless.link/v5/${e}`,{method:"POST",headers:{token:Q.VITE_TOKEN,region:"cn-hz","Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.json()));async function B(){const{uuid:e}=await X("rooms",{name:"test1",limit:0});J("uuid = %O",e);const t=await X(`tokens/rooms/${e}`,{lifespan:0,role:"admin"});J("roomToken = %O",t);const n=JSON.parse(G.getItem("rooms")||"[]"),o={uuid:e,roomToken:t};return n.unshift(o),G.setItem("rooms",JSON.stringify(n)),o}function H(e){return"object"==typeof e&&null!==e&&"uuid"in e&&(e=`uuid=${e.uuid}&roomToken=${e.roomToken}`),location.origin+location.pathname+"?"+e.toString()}function ee(e){e||(e=location.origin+location.pathname),history.replaceState({url:e},"",e)}const te=new u.WhiteWebSdk({appIdentifier:Q.VITE_APPID,useMobXState:!0,deviceType:u.DeviceType.Surface});async function ne(e){const t=await te.joinRoom((r=c({},e),a={invisiblePlugins:[d],useMultiViews:!0,disableNewPencil:!1,floatBar:!0,userPayload:{cursorName:p.name.firstName()}},n(r,o(a))));var r,a;window.room=t;const i=F.getItem("currentApplianceName");return i&&t.setMemberState({currentApplianceName:i}),ee(location.origin+location.pathname),t}function oe(e){room.setScenePath("/init"),d.mount({room:room,container:e,chessboard:!1}),window.manager=room.getInvisiblePlugin(d.kind),manager.switchMainViewToWriter()}const re=Object.values(u.ApplianceNames),{window:ae}=R;function ie(e){h(e,"svelte-fgakyb",".tip.svelte-fgakyb{position:fixed;bottom:1em;right:1em;color:#fff;background-color:#0074d9;padding:1em;border-radius:4px;box-shadow:0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12),\n      0 2px 4px -1px rgba(0, 0, 0, 0.2);z-index:9999;font-family:Arial, sans-serif;font-size:small}.tip.error.svelte-fgakyb{background-color:#ff4136}")}function se(e,t,n){const o=e.slice();return o[12]=t[n].kind,o[13]=t[n].configs,o}function ce(e,t,n){const o=e.slice();return o[16]=t[n],o[18]=n,o}function le(e,t,n){const o=e.slice();return o[19]=t[n],o}function de(e){let t,n,o,r,a,i,s,c,l,d,u,p=re,m=[];for(let h=0;h<p.length;h+=1)m[h]=ge(le(e,p,h));let f=e[1],g=[];for(let h=0;h<f.length;h+=1)g[h]=ye(se(e,f,h));return{c(){t=y("div");for(let e=0;e<m.length;e+=1)m[e].c();n=S(),o=S(),r=y("button"),r.textContent="RESET",a=S(),i=y("div"),s=y("div");for(let e=0;e<g.length;e+=1)g[e].c();c=S(),l=y("div"),w(r,"class","reset-btn"),w(r,"title","remove all apps, reset camera\npress ctrl/meta to reload page\npress shift to clear screen"),w(t,"id","tools"),w(s,"id","actions"),w(l,"id","whiteboard"),w(i,"class","two-side")},m(p,f){k(p,t,f);for(let e=0;e<m.length;e+=1)m[e].m(t,null);O(t,n),O(t,o),O(t,r),k(p,a,f),k(p,i,f),O(i,s);for(let e=0;e<g.length;e+=1)g[e].m(s,null);O(i,c),O(i,l),d||(u=[j(r,"click",ke),j(t,"click",e[5]),j(s,"click",e[6]),z(oe.call(null,l))],d=!0)},p(e,o){if(4&o){let r;for(p=re,r=0;r<p.length;r+=1){const a=le(e,p,r);m[r]?m[r].p(a,o):(m[r]=ge(a),m[r].c(),m[r].m(t,n))}for(;r<m.length;r+=1)m[r].d(1);m.length=p.length}if(2&o){let t;for(f=e[1],t=0;t<f.length;t+=1){const n=se(e,f,t);g[t]?g[t].p(n,o):(g[t]=ye(n),g[t].c(),g[t].m(s,null))}for(;t<g.length;t+=1)g[t].d(1);g.length=f.length}},d(e){e&&E(t),Y(m,e),e&&E(a),e&&E(i),Y(g,e),d=!1,M(u)}}}function ue(e){let t;return{c(){t=y("div"),t.textContent="Joining Room..."},m(e,n){k(e,t,n)},p:W,d(e){e&&E(t)}}}function pe(e){let t;return{c(){t=y("div"),t.textContent="Registering Apps..."},m(e,n){k(e,t,n)},p:W,d(e){e&&E(t)}}}function me(e){let t;return{c(){t=y("div"),t.textContent="404 Not Found Room."},m(e,n){k(e,t,n)},p:W,d(e){e&&E(t)}}}function fe(e){let t;return{c(){t=y("div"),t.textContent="Preparing..."},m(e,n){k(e,t,n)},p:W,d(e){e&&E(t)}}}function ge(e){let t,n,o,r=e[19]+"";return{c(){t=y("button"),n=b(r),w(t,"data-tool",o=e[19]),v(t,"active",e[19]===e[2])},m(e,o){k(e,t,o),O(t,n)},p(e,n){4&n&&v(t,"active",e[19]===e[2])},d(e){e&&E(t)}}}function he(e){var t;let n,o,r,a,i,s=((null==(t=e[16].options)?void 0:t.title)||`${e[16].kind} ${e[18]+1}`)+"";return{c(){n=y("button"),o=b(s),r=S(),w(n,"data-app-kind",a=e[12]),w(n,"data-app-index",i=e[18])},m(e,t){k(e,n,t),O(n,o),O(n,r)},p(e,t){var r;2&t&&s!==(s=((null==(r=e[16].options)?void 0:r.title)||`${e[16].kind} ${e[18]+1}`)+"")&&T(o,s),2&t&&a!==(a=e[12])&&w(n,"data-app-kind",a)},d(e){e&&E(n)}}}function ye(e){let t,n,o,r,a=e[12]+"",i=e[13],s=[];for(let c=0;c<i.length;c+=1)s[c]=he(ce(e,i,c));return{c(){t=y("strong"),n=b(a),o=S();for(let e=0;e<s.length;e+=1)s[e].c();r=x()},m(e,a){k(e,t,a),O(t,n),k(e,o,a);for(let t=0;t<s.length;t+=1)s[t].m(e,a);k(e,r,a)},p(e,t){if(2&t&&a!==(a=e[12]+"")&&T(n,a),2&t){let n;for(i=e[13],n=0;n<i.length;n+=1){const o=ce(e,i,n);s[n]?s[n].p(o,t):(s[n]=he(o),s[n].c(),s[n].m(r.parentNode,r))}for(;n<s.length;n+=1)s[n].d(1);s.length=i.length}},d(e){e&&E(t),e&&E(o),Y(s,e),e&&E(r)}}}function be(e){let t,n,o,r,a;return{c(){t=y("div"),n=b(e[4]),w(t,"class","tip svelte-fgakyb"),v(t,"error",e[4].includes("Failed"))},m(e,o){k(e,t,o),O(t,n),a=!0},p(e,o){(!a||16&o)&&T(n,e[4]),16&o&&v(t,"error",e[4].includes("Failed"))},i(e){a||(_((()=>{r&&r.end(1),o=V(t,K,{x:200}),o.start()})),a=!0)},o(e){o&&o.invalidate(),r=N(t,C,{}),a=!1},d(e){e&&E(t),e&&r&&r.end()}}}function we(e){let t,n,o,r,a;function i(e,t){return"prepare"===e[0]?fe:"404"===e[0]?me:"register-apps"===e[0]?pe:"join-room"===e[0]?ue:de}let s=i(e),c=s(e),l=e[4]&&be(e);return{c(){c.c(),t=S(),l&&l.c(),n=x()},m(i,s){c.m(i,s),k(i,t,s),l&&l.m(i,s),k(i,n,s),o=!0,r||(a=[j(ae,"keydown",e[7]),j(ae,"keyup",e[8])],r=!0)},p(e,[o]){s===(s=i(e))&&c?c.p(e,o):(c.d(1),c=s(e),c&&(c.c(),c.m(t.parentNode,t))),e[4]?l?(l.p(e,o),16&o&&P(l,1)):(l=be(e),l.c(),P(l,1),l.m(n.parentNode,n)):l&&(L(),A(l,1,1,(()=>{l=null})),I())},i(e){o||(P(l),o=!0)},o(e){A(l),o=!1},d(e){c.d(e),e&&E(t),l&&l.d(e),e&&E(n),r=!1,M(a)}}}let ve=0;function ke(e){!async function({manager:e=window.manager,room:t=window.room,clearScreen:n=!1,reload:o=!1}={}){await Promise.all(Object.keys(e.apps||{}).map((t=>e.closeApp(t)))),Object.keys(e.attributes).forEach((t=>{/-[-_a-zA-Z0-9]{8}$/.test(t)?e.updateAttributes([t],void 0):"apps"===t&&e.updateAttributes([t],{})})),e.mainView.moveCamera({centerX:0,centerY:0,scale:1}),n&&t.cleanCurrentScene(),o&&location.reload()}({clearScreen:e.shiftKey,reload:e.ctrlKey||e.metaKey})}function Oe(e,t,n){let o,r,a,i="prepare",s="share",u="";function p(e){n(4,u=e),clearTimeout(ve),ve=window.setTimeout((()=>{ve=0,n(4,u="")}),3e3)}return D((async()=>{const e=await async function(){let e,t;const n=new URLSearchParams(location.search);if(n.has("uuid")&&n.has("roomToken")&&(e=n.get("uuid"),t=n.get("roomToken")),!e||!t){const n=JSON.parse(G.getItem("rooms")||"[]");n[0]&&({uuid:e,roomToken:t}=n[0])}e&&t||window.confirm("Not found uuid/roomToken both in query and localStorage, create a new one?")&&(({uuid:e,roomToken:t}=await B()),location.reload());if(e&&t)return{uuid:e,roomToken:t}}();e?(n(0,i="register-apps"),n(1,o=await async function(){const e=await Promise.all(Object.values(q).map((e=>e()))),t=[];for(let{default:n}of e){Array.isArray(n)||(n=[n]),U("[register]",n[0].kind);const e={kind:n[0].kind,configs:[]};for(const t of n){const n=t,{kind:o,src:r}=n,a=l(n,["kind","src"]),i=async()=>{if("function"==typeof r){const e=await r();return"default"in e?e.default:e}return r};d.register({kind:o,src:i}),e.configs.push(c({kind:o},a))}t.push(e)}return window.apps=t,t}()),n(0,i="join-room"),r=await ne(e),n(2,a=r.state.memberState.currentApplianceName),r.callbacks.on("onRoomStateChanged",(e=>{e.memberState&&n(2,a=e.memberState.currentApplianceName)})),n(0,i="main")):n(0,i="404")})),[i,o,a,s,u,function(e){var t;const n=e.target;if(null==(t=null==n?void 0:n.dataset)?void 0:t.tool){const e=n.dataset.tool;r.setMemberState({currentApplianceName:e}),F.setItem("currentApplianceName",e)}},function(e){var t,n;const r=e.target;if((null==(t=null==r?void 0:r.dataset)?void 0:t.appKind)&&(null==(n=null==r?void 0:r.dataset)?void 0:n.appIndex)){const e=r.dataset.appKind,t=+r.dataset.appIndex,{configs:n}=o.find((t=>t.kind===e));window.manager.addApp(n[t])}},function(e){"Shift"===e.key&&e.shiftKey&&n(3,s="new-room")},function(e){"Shift"!==e.key||e.shiftKey||n(3,s="share")},async function(e){if("share"===s){const{uuid:t,roomToken:n}=r,o=new URLSearchParams;o.set("uuid",t),o.set("roomToken",n);const a=H(o);ee(e.ctrlKey||e.metaKey?"":a);try{await async function(e){var t;try{return await(null==(t=window.navigator.clipboard)?void 0:t.writeText(e))}catch{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();const n=document.execCommand("copy");return t.remove(),n?Promise.resolve():Promise.reject()}}(a),p("Copied share url.")}catch{p("Failed to write clipboard.")}}if("new-room"===s){const e=H(await B());window.open(e,"_blank"),n(3,s="share")}}]}window.app=new class extends m{constructor(e){super(),f(this,e,Oe,we,g,{},ie)}}({target:document.querySelector("#app")}),null==(e=navigator.serviceWorker)||e.getRegistrations().then((e=>{for(const t of e)t.unregister()})).catch((()=>{}));export{$ as _};
