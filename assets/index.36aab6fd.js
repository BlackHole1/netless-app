import{S as t,i as e,s,e as l,b as i,F as n,d as o,g as a,o as r,l as c,m as p,G as d,t as u,h as m,c as g,D as b,B as f,H as v}from"./vendor.9fbfd044.js";function h(t,e,s){const l=t.slice();return l[16]=e[s],l[17]=e,l[18]=s,l}function x(t){let e,s,p,d,u,m;return{c(){e=l("button"),s=l("img"),i(s,"draggable","false"),n(s.src,p="assets/plus.4b34cdbf.svg")||i(s,"src","assets/plus.4b34cdbf.svg"),i(s,"alt","add"),i(e,"title","Add"),e.disabled=d=t[1].length>=20},m(l,i){o(l,e,i),a(e,s),u||(m=r(e,"click",t[7]),u=!0)},p(t,s){2&s&&d!==(d=t[1].length>=20)&&(e.disabled=d)},d(t){t&&c(e),u=!1,m()}}}function y(t){let e,s,p,d,u;return{c(){e=l("button"),s=l("img"),i(s,"draggable","false"),n(s.src,p=t[4]?"assets/pencil-off.f49ce2a4.svg":"assets/pencil.614cc8ea.svg")||i(s,"src",p),i(s,"alt","edit"),i(e,"title","Edit")},m(l,i){o(l,e,i),a(e,s),d||(u=r(e,"click",t[5]),d=!0)},p(t,e){16&e&&!n(s.src,p=t[4]?"assets/pencil-off.f49ce2a4.svg":"assets/pencil.614cc8ea.svg")&&i(s,"src",p)},d(t){t&&c(e),d=!1,u()}}}function w(t){let e,s,d,g,b,f,v,h,x,y,w=(t[2][t[18]]||0)+"";function $(){return t[12](t[18])}return{c(){e=l("span"),s=u("("),d=u(w),g=u(")"),b=p(),f=l("button"),v=l("img"),i(e,"class","netless-app-vote-count"),i(v,"draggable","false"),n(v.src,h="assets/up.c9e084a4.svg")||i(v,"src","assets/up.c9e084a4.svg"),i(v,"alt","vote"),i(f,"title","Vote")},m(t,l){o(t,e,l),a(e,s),a(e,d),a(e,g),o(t,b,l),o(t,f,l),a(f,v),x||(y=r(f,"click",$),x=!0)},p(e,s){t=e,4&s&&w!==(w=(t[2][t[18]]||0)+"")&&m(d,w)},d(t){t&&c(e),t&&c(b),t&&c(f),x=!1,y()}}}function $(t){let e,s,p,d,u;function m(){return t[13](t[18])}return{c(){e=l("button"),s=l("img"),i(s,"draggable","false"),n(s.src,p="assets/close.c4eb3b01.svg")||i(s,"src","assets/close.c4eb3b01.svg"),i(s,"alt","delete"),i(e,"title","Delete")},m(t,l){o(t,e,l),a(e,s),d||(u=r(e,"click",m),d=!0)},p(e,s){t=e},d(t){t&&c(e),d=!1,u()}}}function A(t){let e,s,n,u,m,g,b,f;function v(){t[11].call(s,t[17],t[18])}let h=!t[4]&&w(t),x=t[4]&&$(t);return{c(){e=l("li"),s=l("input"),u=p(),h&&h.c(),m=p(),x&&x.c(),g=p(),i(s,"class","netless-app-vote-item"),s.readOnly=n=!t[4]},m(l,i){o(l,e,i),a(e,s),d(s,t[16]),a(e,u),h&&h.m(e,null),a(e,m),x&&x.m(e,null),a(e,g),b||(f=r(s,"input",v),b=!0)},p(l,i){t=l,16&i&&n!==(n=!t[4])&&(s.readOnly=n),2&i&&s.value!==t[16]&&d(s,t[16]),t[4]?h&&(h.d(1),h=null):h?h.p(t,i):(h=w(t),h.c(),h.m(e,m)),t[4]?x?x.p(t,i):(x=$(t),x.c(),x.m(e,g)):x&&(x.d(1),x=null)},d(t){t&&c(e),h&&h.d(),x&&x.d(),b=!1,f()}}}function k(t){let e,s,n,d,v,w,$,k,E,U,V,B=(t[0]||"what to eat")+"",C=t[4]&&x(t),D=t[3]&&y(t),I=t[1],N=[];for(let l=0;l<I.length;l+=1)N[l]=A(h(t,I,l));return{c(){e=l("div"),s=l("div"),C&&C.c(),n=p(),D&&D.c(),d=p(),v=l("div"),w=l("h2"),$=u(B),k=p(),E=l("ul");for(let t=0;t<N.length;t+=1)N[t].c();i(s,"class","netless-app-vote-controls"),i(w,"contenteditable",t[4]),g(w,"editing",t[4]),i(v,"class","netless-app-vote-title"),i(E,"class","netless-app-vote-items"),i(e,"class","netless-app-vote"),i(e,"data-kind","vote")},m(l,i){o(l,e,i),a(e,s),C&&C.m(s,null),a(s,n),D&&D.m(s,null),a(e,d),a(e,v),a(v,w),a(w,$),a(e,k),a(e,E);for(let t=0;t<N.length;t+=1)N[t].m(E,null);U||(V=r(w,"input",t[6]),U=!0)},p(t,[e]){if(t[4]?C?C.p(t,e):(C=x(t),C.c(),C.m(s,n)):C&&(C.d(1),C=null),t[3]?D?D.p(t,e):(D=y(t),D.c(),D.m(s,null)):D&&(D.d(1),D=null),1&e&&B!==(B=(t[0]||"what to eat")+"")&&m($,B),16&e&&i(w,"contenteditable",t[4]),16&e&&g(w,"editing",t[4]),790&e){let s;for(I=t[1],s=0;s<I.length;s+=1){const l=h(t,I,s);N[s]?N[s].p(l,e):(N[s]=A(l),N[s].c(),N[s].m(E,null))}for(;s<N.length;s+=1)N[s].d(1);N.length=I.length}},i:b,o:b,d(t){t&&c(e),C&&C.d(),D&&D.d(),f(N,t),U=!1,V()}}}function E(t,e,s){let l;const i=v();let{writable:n=!1}=e,{title:o=""}=e,{items:a=["lorem","ipsum","dolo","sit","amet"]}=e,{votes:r=[0,0,0,0,0]}=e,c="vote";function p(t){s(1,a=a.slice(0,t).concat(a.slice(t+1)))}function d(t){n&&i("update",{votes:[t,r[t]+1]})}return t.$$set=t=>{"writable"in t&&s(3,n=t.writable),"title"in t&&s(0,o=t.title),"items"in t&&s(1,a=t.items),"votes"in t&&s(2,r=t.votes)},t.$$.update=()=>{1024&t.$$.dirty&&s(4,l="edit"===c)},[o,a,r,n,l,function(){s(10,c=l?"vote":"edit"),"vote"===c&&(s(2,r=Array(a.length).fill(0)),n&&(r.forEach(((t,e)=>{i("update",{votes:[e,t]})})),i("update",{title:o,items:a})))},function(t){s(0,o=t.target.textContent||"")},function(){s(1,a=a.concat([""]))},p,d,c,function(t,e){t[e]=this.value,s(1,a)},t=>d(t),t=>p(t)]}class U extends t{constructor(t){super(),e(this,t,E,k,s,{writable:3,title:0,items:1,votes:2})}}const V={kind:"Vote",setup(t){const e=t.getBox();let s=t.getAttributes();if(s||(t.setAttributes({title:"",items:[]}),s=t.getAttributes()),!s)return void t.emitter.emit("destroy",{error:new Error("[NetlessAppVote] No attributes")});null==s.title&&t.updateAttributes(["title"],""),s.items||t.updateAttributes(["items"],[]),e.mountStyles(".netless-app-vote{width:100%;height:100%;background-color:#fff;display:flex;flex-flow:column nowrap}.netless-app-vote [contenteditable=true]{border-bottom:1px dashed #ccc}.netless-app-vote button{height:25px;gap:4px;background-color:transparent;border:2px solid transparent;border-radius:4px}.netless-app-vote button:hover{border-color:#ccc}.netless-app-vote button:active{background-color:#ccc}.netless-app-vote button img{width:16px;height:16px}.netless-app-vote-controls{position:absolute;top:8px;right:8px}.netless-app-vote-title{padding:8px}.netless-app-vote-title h2{margin:0;padding:2px 8px;display:inline-block;line-height:1.1;color:#333;border-bottom:1px dashed transparent}.netless-app-vote-items{flex-grow:1;margin:0;padding:0 8px 12px;list-style-type:none;overflow-y:auto}.netless-app-vote-items li{display:flex;align-items:center;gap:5px;line-height:1.5;padding-bottom:4px}.netless-app-vote-items li button{display:inline-block}.netless-app-vote-item{display:block;font-size:16px;line-height:1.5;font-family:Arial,sans-serif;flex-grow:1;border:1px solid #eee;border-radius:4px;padding:2px 8px}.netless-app-vote-item[readonly]{border-color:transparent}.netless-app-vote-count{padding-right:8px}\n");const l=new U({target:e.$content,props:{writable:t.getIsWritable()}});t.emitter.on("writableChange",(()=>{l.$set({writable:t.getIsWritable()})})),l.$on("update",(({detail:e})=>{if("title"in e&&t.updateAttributes(["title"],e.title),"items"in e&&t.updateAttributes(["items"],e.items),Array.isArray(e.votes)){const[s,l]=e.votes;t.updateAttributes([`item-${s}`],l)}}));const i=[t.mobxUtils.autorun((()=>{l.$set({title:s.title})})),t.mobxUtils.autorun((()=>{s.items&&l.$set({items:[...s.items]})})),t.mobxUtils.autorun((()=>{s.items&&l.$set({votes:s.items.map(((t,e)=>s[`item-${e}`]||0))})}))];t.emitter.on("destroy",(()=>{i.forEach((t=>t())),l.$destroy()}))}};export{V as default};
